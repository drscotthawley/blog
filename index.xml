<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Scott H. Hawley</title>
<link>https://drscotthawley.github.io/blog/index.html</link>
<atom:link href="https://drscotthawley.github.io/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>My blog about code, physics, and ideas</description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Thu, 27 Nov 2025 06:00:00 GMT</lastBuildDate>
<item>
  <title>Flow Where You Want</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/FlowWhereYouWant.html</link>
  <description><![CDATA[ 




<!--- *by "Flo Guida" aka [Scott H. Hawley](https://bsky.app/profile/drscotthawley.bsky.social), Oct/Nov. 2025* -->
<div style="text-align: right; margin: 0;">
<p><a href="https://colab.research.google.com/github/drscotthawley/DLAIE/blob/main/2025/Guidance_for_Flows.ipynb" target="_"> <img src="https://drscotthawley.github.io/blog/posts/https:/colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" style="display: inline-block;"></a></p>
</div>
<section id="abstract" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Abstract</h1>
<p>This tutorial demonstrates how to add inference-time controls to pretrained flow-based generative models to make them perform tasks they weren’t trained to do. We take an unconditional flow model trained on MNIST digits and apply two types of guidance: classifier guidance to generate specific digits, and inpainting to fill in missing pixels. Both approaches work by adding velocity corrections during the sampling process to steer the model toward desired outcomes. Since modern generative models operate in compressed latent spaces, we examine guidance methods that work directly in latent space as well as those that decode to pixel space. We also explore PnP-Flow, which satisfies constraints by iteratively projecting samples backward and forward in time rather than correcting flow velocities. The approaches demonstrated here work with other flow models and control tasks, so you can guide flows where you want them to go.</p>
<blockquote class="blockquote">
<p><em>“When we put bits into the mouths of horses to make them obey us, we can turn the whole animal. Or take ships as an example. Although they are so large and are driven by strong winds, they are steered by a very small rudder wherever the pilot wants to go.”</em> <br> – James 3:3-4 (NIV)</p>
</blockquote>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>In this tutorial, we’ll explore inference-time “plugin” methods for flow matching and rectified flow generative models like FLUX or Stable Audio Open Small. Unlike classifier-free guidance (CFG) <span class="citation" data-cites="cfg">[1]</span>, which requires training the model with your desired conditioning signal, these plugin guidance methods let you add controls at inference time—even for conditions the model never saw during training.</p>
<p>This tutorial assumes familiarity with flow-based generative models, by which we mean “flow matching” <span class="citation" data-cites="lipman2023flow">[2]</span> and/or “rectified flows” <span class="citation" data-cites="rectified_flow">[3]</span>. See the blog post <a href="https://drscotthawley.github.io/blog/posts/FlowModels.html">“Flow With What You Know”</a> <span class="citation" data-cites="hawley2025flowwithwhat">[4]</span> for an overview, and/or my IJCNN 2025 tutorial <span class="citation" data-cites="hawley_practical">[5]</span> for further detail. The key insight is that flow models generate samples through iterative integration, and at each step we can add small velocity corrections to steer toward specific goals. This works for various objectives: generating specific classes, filling in missing regions, or satisfying other desired constraints.</p>
<p>Our discussion will bring us up to date on guidance methods for latent-space rectified flow models. While there’s an extensive literature on guidance for diffusion models <span class="citation" data-cites="daras2024survey">[7]</span> – see Sander Dieleman’s excellent blog post <span class="citation" data-cites="dieleman2022guidance">[8]</span> for an overview — flow matching allows us to cast these in a more accessible and intuitive way. There’s some recent work unifying guidance for diffusion and flows <span class="citation" data-cites="zander_greedy">[9]</span>, but in this tutorial we’ll focus on a simplified treatment for flows only.</p>
<p>The paradigm of latent generative models is covered in another superb Dieleman post <span class="citation" data-cites="dieleman2025latents">[10]</span>, and combining latent-space models with flow-based guidance gives us powerful, flexible tools for adding flexible controls to efficient generation.</p>
<p>Let’s review the picture for flow-based generative modeling in latent space…</p>
<section id="the-latent-flow-matching-setup" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-latent-flow-matching-setup"><span class="header-section-number">2.1</span> The Latent Flow-Matching Setup</h2>
<p>The following diagram illustrates the three key concepts:</p>
<p><strong>a)</strong> A VAE compresses pixel-space images into compact latent representations.</p>
<style>
img {
    display: block;
    margin: 0 auto;
    transition: transform 0.4s ease;
    position: relative;
    z-index: 0;
}
img:hover {
    -webkit-transform: scale(1.3);
    transform: scale(1.3);
    z-index: 1;
}

.cell-output-display {
    overflow: visible !important;
}
.cell-output {
    overflow: visible !important;
}
</style>
<p><img src="https://drscotthawley.github.io/blog/posts/images/vae_flow_diag-VAE.svg" class="img-fluid"></p>
<p><strong>b)</strong> The flow model operates in this latent space, transforming noise (“Source”, t=0) into structured data (“Target”, t=1) through iterative integration. The decoder then converts the final latents back to pixels.</p>
<p><img src="https://drscotthawley.github.io/blog/posts/images/vae_flow_diag-Generation.drawio.svg" class="img-fluid"></p>
<p><strong>c)</strong> While general flows can follow curved trajectories, some of our methods will focus on flows with nearly straight trajectories which allows for estimating endpoints without many integration steps:</p>
<p><img src="https://drscotthawley.github.io/blog/posts/images/vae_flow_diag-FlowTypes.drawio.svg" class="img-fluid"></p>
<p>These (nearly) straight trajectories can be obtained by “ReFlow” distillation of another model (covered in <span class="citation" data-cites="rectified_flow">[4]</span>) or by insisting during training that the models yield paths agreeing with Optimal Transport such as the “minibatch OT” method of Tong et al <span class="citation" data-cites="tong2024improving">[11]</span>. Even if the model’s trajectories aren’t super-straight, we’ll see that the guidance methods we use can be applied fairly generally anyway.</p>
</section>
</section>
<section id="projecting-and-correcting" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Projecting and Correcting</h1>
<p>Intuitively, guidance amounts to “steering” during the integration of the flow model in order to end up at a desired end point. The <a href="https://bsky.app/profile/drscotthawley.bsky.social/post/3m3df2idqrc2g">following video</a> provides a useful metaphor:</p>
<div class="cell" data-hide_input="true">
<div class="cell-output cell-output-display">

<div style="display: flex; justify-content: center;">
<blockquote class="bluesky-embed blockquote" data-bluesky-uri="at://did:plc:sw457c7pedt3n57ci6qlrws6/app.bsky.feed.post/3m3df2idqrc2g" data-bluesky-cid="bafyreig53ufqtdsyf6np5xhoc75wdbd7pwlgxwbqeg4gatq5atvigdk54e" data-bluesky-embed-color-mode="system"><p lang="en">Been working on a tutorial on Guidance for (latent) flow-based generative models, and happened upon a great metaphor today while taking a little "me" time. :-)<br><br><a href="https://bsky.app/profile/did:plc:sw457c7pedt3n57ci6qlrws6/post/3m3df2idqrc2g?ref_src=embed">[image or embed]</a></p>— Scott H. Hawley (<a href="https://bsky.app/profile/did:plc:sw457c7pedt3n57ci6qlrws6?ref_src=embed">@drscotthawley.bsky.social</a>) <a href="https://bsky.app/profile/did:plc:sw457c7pedt3n57ci6qlrws6/post/3m3df2idqrc2g?ref_src=embed">Oct 16, 2025 at 1:26 PM</a></blockquote><script async="" src="https://embed.bsky.app/static/embed.js" charset="utf-8"></script>
</div>
</div>
</div>
<p>Ok, the analogy’s not quite right: you can’t just steer, you are going to have to paddle a little bit. In other words, you’re going to have to provide a bit of a <em>extra velocity</em> to correct where the “current” flow is taking you.</p>
<p>In flow matching, we go from a source data (distribution) at time <img src="https://latex.codecogs.com/png.latex?t=0"> to target data at <img src="https://latex.codecogs.com/png.latex?t=1">. Since this tutorial applies to latent space, we’ll use the letter <img src="https://latex.codecogs.com/png.latex?z"> for position, such as <img src="https://latex.codecogs.com/png.latex?z_t"> being the position at time <img src="https://latex.codecogs.com/png.latex?t">.</p>
<p>When you’re “looking ahead” to estimate where you’ll end up, you project linearly along the current velocity <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bv_t%7D"> for a duration of the remaining time. Let’s call this estimate <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D">, your projected endpoint :</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cwidehat%7Bz_1%7D%20=%20z_t%20+%20(1-t)%5Cvec%7Bv_t%7D%20%5Ctag%7B1%7D%20"></p>
<p>…but perhaps that’s not where you want to go. Where you want to go is a distance <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Cwidehat%7Bz_1%7D"> from <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D">, and to get there you’ll have to make a “course correction” <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Chat%7Bv%7D">, as shown in the following diagram:</p>
<p><img src="https://drscotthawley.github.io/blog/posts/images/guidance_vectors.png" class="img1 img-fluid"></p>
<p>By similar triangles, <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Cwidehat%7Bz_1%7D%20=%20(1-t)%5CDelta%20%5Cvec%7Bv%7D">, which means the course correction you want is</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5CDelta%20%5Cvec%7Bv%7D%20=%20%7B%20%5CDelta%20%5Cwidehat%7Bz_1%7D%20%5Cover%201-t%20%7D%20%5Ctag%7B2%7D%20"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Details
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since you’re going to see more math once you try to read the scholarly literature on these topics, let’s go a bit further into the math…</p>
<p>So <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Cwidehat%7Bz_1%7D"> is a measure of the <em>deviation</em> from the desired endpoint. Now, in practical application we won’t actually use the “distance” <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Cwidehat%7Bz_1%7D">, but we’ll use something that functions <em>like</em> a distance, such as a K-L divergence or Mean Squared Error (MSE).</p>
<p>When doing inference, this deviation serves as a “loss” – something we minimize via gradient descent, except we’ll vary the flow positions <img src="https://latex.codecogs.com/png.latex?z"> instead of the model weights. More specifically, we’ll consider the “likelihood” <img src="https://latex.codecogs.com/png.latex?p(%20%5Cwidehat%7Bz_1%7D%20%7C%20y%20)"> of getting a <img src="https://latex.codecogs.com/png.latex?z_1"> that matches a given control <img src="https://latex.codecogs.com/png.latex?y">, and we’ll seek to maximize that likelihood, or equivalently to <em>minimize the negative</em> log-likelihood.</p>
<p>The expression <img src="https://latex.codecogs.com/png.latex?-%5Cnabla_%7B%5Cwidehat%7Bz_1%7D%7D%20%5Clog%20p(%20%5Cwidehat%7Bz_1%7D%20%7C%20y%20)"> essentially answers the question, “In which direction should I adjust <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> so as to make <img src="https://latex.codecogs.com/png.latex?p(%20%5Cwidehat%7Bz_1%7D%20%7C%20y%20)"> more likely?” This gives us a direction and a magnitude, which we then multiply by a <del>learning rate</del> “guidance strength” <img src="https://latex.codecogs.com/png.latex?%5Ceta"> to turn it into a step size.</p>
</div>
</div>
<p>Applying this gradient-based approach, our expression for <img src="https://latex.codecogs.com/png.latex?%5CDelta%20v"> will involve replacing <img src="https://latex.codecogs.com/png.latex?%5CDelta%20%5Cwidehat%7Bz_1%7D"> in (2) with <img src="https://latex.codecogs.com/png.latex?-%20%5Ceta%20%5Cnabla_%7B%5Cwidehat%7Bz_1%7D%7D%20%5Clog%20p(%20%5Cwidehat%7Bz_1%7D%20%7C%20y">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5CDelta%20%5Cvec%7Bv%7D%20=%20%20-%20%5Ceta%20%7B1%20%5Cover%201-t%20%7D%20%5Cnabla_%7Bz_t%7D%20%5Clog%20p(%20%5Cwidehat%7Bz_1%7D%20%7C%20y%20)%20%5Ctag%7B3%7D%20"></p>
<p>where we used the fact that <img src="https://latex.codecogs.com/png.latex?%5Cnabla_%7B%5Cwidehat%7Bz_1%7D%7D%20=%20%5Cnabla_%7Bz_t%7D"> (since <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D%20%5Cpropto%20z_t">). The factor of <img src="https://latex.codecogs.com/png.latex?1/(1-t)"> means small corrections suffice early on, but later times require larger adjustments—though other time scalings are possible, as we’ll see.</p>
<p>Now let’s apply this to a concrete example.</p>
</section>
<section id="classifier-guidance" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Classifier Guidance</h1>
<p>If we want our model to generate a member of a particular class, we can use an external classifier to examine the generated samples. The constraint to minimize will be the difference between the desired class and the <code>argmax</code> of the classifier output (or some similar relationship that enforces the class compliance).</p>
<p>For our flow model, let’s use <a href="https://www.linkedin.com/in/marcocassar/">Marco Cassar</a>’s <a href="https://github.com/Ocrabit/dl_class_projects/blob/main/dl_experimentation/submissions/marco_submission.py">winning submission</a> from the <a href="https://2025-dlaie-leaderboard.streamlit.app/">2025 DLAIE Leaderboard Contest</a> on unconditional latent flow matching of MNIST digits. For the classifier, we’ll use the <a href="https://github.com/DLAIE/2025-LeaderboardContest/blob/main/evaluate_submission.py">official evaluation classifier</a> from the same contest.</p>
<section id="setup-the-flow-model-and-classifier" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="setup-the-flow-model-and-classifier"><span class="header-section-number">4.1</span> Setup the Flow Model and Classifier</h2>
<p>Let’s generate and draw some sample images.</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> make_grid</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate some samples</span></span>
<span id="cb1-5">n_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-6">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sub.generate_samples(n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_samples)</span>
<span id="cb1-7">x1.shape</span>
<span id="cb1-8"></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show_grid(x1, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb1-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(x1.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>: x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x1.unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add channels dim</span></span>
<span id="cb1-12">    grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_grid(x1, nrow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-13">    plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-14">    plt.imshow(grid.permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).cpu(), cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>)</span>
<span id="cb1-15">    plt.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'off'</span>)</span>
<span id="cb1-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> title: plt.title(title)</span>
<span id="cb1-17">    plt.tight_layout()</span>
<span id="cb1-18">    plt.show()</span>
<span id="cb1-19"></span>
<span id="cb1-20">show_grid(x1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample generated images"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now let’s setup the (pretrained) classifier we’ll use for the guidance:</p>
<p>Let’s make a plot showing the classifier’s output probabilities (aka likelihoods) across all classes, for all 10 samples. The samples will be the rows, and the class-likelihoods outputs from the classifier will be the columns, where brightness is correlated with likelihood.</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show_probs(probs, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb2-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""show probs as colormap intensities via imshow.</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    have each row be a sample and each column be a class probability"""</span></span>
<span id="cb2-4">    ncols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-5">    fig, axs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ncols, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb2-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> ncols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: axs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [axs]</span>
<span id="cb2-7"></span>
<span id="cb2-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show a little version of the x image for each row</span></span>
<span id="cb2-9">        axs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(make_grid(x.unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).cpu(), nrow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>).permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).cpu(), cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>)</span>
<span id="cb2-10">        axs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'off'</span>)</span>
<span id="cb2-11"></span>
<span id="cb2-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show probabilities as an intensity map</span></span>
<span id="cb2-13">    im <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> axs[ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(probs.cpu(), cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>)</span>
<span id="cb2-14">    axs[ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class"</span>)</span>
<span id="cb2-15">    axs[ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample #"</span>)</span>
<span id="cb2-16">    plt.colorbar(im, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axs[ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-17">    plt.tight_layout()</span>
<span id="cb2-18"></span>
<span id="cb2-19">show_probs(probs, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the “random” distribution of generated digits, we see that this is an <em>unconditional</em> generative model: there’s nothing determining the classes of the outputs – until we add guidance, below! ;-) In a short while, we’ll reproduce that diagram, but we’ll use guidance to get one class per sample, in order, along the diagonal.</p>
<p>To do that, we’re going to have to “break open” the <code>generate_samples</code> routine and even the <code>integrate_path</code> routine to allow us to <em>add a correction</em> to the velocity <img src="https://latex.codecogs.com/png.latex?v_t"> generated by the flow model at time <img src="https://latex.codecogs.com/png.latex?t">. That correction <img src="https://latex.codecogs.com/png.latex?%5CDelta%20v"> will be based on the classifier’s output using the <em>projected estimate</em> <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bx_1%7D"> of the final data, which we’ll obtain via <em>linear extrapolation</em>.</p>
<p>In our latent space model, we flow with latents <img src="https://latex.codecogs.com/png.latex?z"> which must be <em>decoded</em> using the VAE’s decoder <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%7BD%7D"> :</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cwidehat%7Bz_1%7D%20=%20z_t%20+%20(1-t)%20v_t%20"> <img src="https://latex.codecogs.com/png.latex?%20%5Cwidehat%7Bx_1%7D%20=%20%5Cmathscr%7BD%7D(%5Cwidehat%7Bz_1%7D)%20"></p>
<p>The correction <img src="https://latex.codecogs.com/png.latex?%5CDelta%20v"> will generated from a constraint which in this case is just like regular “classifier loss” function in a supervised learning problem. The desired class label is the “target” and the classifier output of the projected estimate is the “prediction”.</p>
<p>Our code will follow this general layout:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb3-2"></span>
<span id="cb3-3">v_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flow_model(z_t, t)</span>
<span id="cb3-4">z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v_t               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># projected destination</span></span>
<span id="cb3-5">x1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sub.vae.decoder(z1_hat)       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># decode it to pixel space</span></span>
<span id="cb3-6">probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classify(classifier, x1_hat)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># classifer operates in pixel space</span></span>
<span id="cb3-7">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(probs, target)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "supervised learning"</span></span>
<span id="cb3-8">delta_v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> magic_function(loss,...???)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;--- here's the part we need to work out</span></span>
<span id="cb3-9">v_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> delta_v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> guidance_strength  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can set the strength of the correction</span></span></code></pre></div>
<p>So what magic function will turn that <code>loss</code> into a <em>velocity</em>? Well, we can turn to good old Gradient Descent! Except instead of taking the gradient with respect to the model weights like we used to, we’re going to take the gradient with respect to the flow coordinates <img src="https://latex.codecogs.com/png.latex?z"> in the latent space, thereby generating a vector in the latent space.</p>
<p>The insight is that PyTorch lets us compute the gradient with respect to anything. We just need to tell it what we want. And we need to be careful to make sure that the VAE and flow models stay frozen, so the only thing that’s allowed to change are the latents <img src="https://latex.codecogs.com/png.latex?z">.</p>
<p>The cleanest way to pull this off, code-wise, is to create a function called <code>compute_v()</code> which for starters will just call the flow model, but then we’ll add to it with guidance info:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wherever we used to just call flow_model(), we'll now call compute_v() instead</span></span>
<span id="cb4-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb4-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute_v(flow_model, z, t, guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb4-4">    v_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flow_model(z, t)</span>
<span id="cb4-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> guidance_dict <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb4-6">        v_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> compute_dv(v_t, z, t, guidance_dict, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb4-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> v_t</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.enable_grad</span>()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;-- later, this will be a key for getting guidance</span></span>
<span id="cb4-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute_dv(v_t, z, t, g:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb4-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"placeholder for now, will add guidance math later"</span></span>
<span id="cb4-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.zeros_like(v_t).detach() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># no correction yet; no gradients returned</span></span></code></pre></div>
</div>
<p>We’ll to use our usual “boilerplate” flow integration code, except we’ll add “<code>**kwargs</code>” everywhere so we can pass controls “all the way in” to the <code>compute_dv()</code> guidance routine, and pair <code>flow_model()</code> as an arg to <code>compute_v()</code> via <code>functools.partial</code>.</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># flow integration routines, slightly modified from "flow with what you know" blog</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> partial  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use partial to package flow_model with compute_v</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb5-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> rk4_step(f, y, t, dt, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># regular rk4, + kwargs passthrough</span></span>
<span id="cb5-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># f: callable (y, t) -&gt; dy/dt</span></span>
<span id="cb5-8">    k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(y, t, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-9">    k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k1, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-10">    k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k2, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-11">    k4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k3, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k4)</span>
<span id="cb5-13"></span>
<span id="cb5-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb5-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> warp_time(t, dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>):</span>
<span id="cb5-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Parametric Time Warping: s = slope in the middle.</span></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        s=1 is linear time, s &lt; 1 goes slower near the middle, s&gt;1 goes slower near the ends</span></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        s = 1.5 gets very close to the "cosine schedule", i.e. (1-cos(pi*t))/2, i.e. sin^2(pi/2*x)"""</span></span>
<span id="cb5-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"s=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> is out of bounds."</span>)</span>
<span id="cb5-20">    tw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t</span>
<span id="cb5-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> dt:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># warped time-step requested; use derivative</span></span>
<span id="cb5-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> tw, dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s)</span>
<span id="cb5-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> tw</span>
<span id="cb5-24"></span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb5-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> integrate_path(model, initial_points, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, latent_2d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, prog_bar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb5-28">    p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters())</span>
<span id="cb5-29">    device, model_dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.device, p.dtype</span>
<span id="cb5-30">    current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_points.to(device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>device, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model_dtype).clone()</span>
<span id="cb5-31">    model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb5-32">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(t0, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_steps, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>device, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model_dtype)</span>
<span id="cb5-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> warp_fn: ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_fn(ts)</span>
<span id="cb5-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> latent_2d: t_batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty((current_points.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>device, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model_dtype)</span>
<span id="cb5-35">    vel_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> partial(compute_v, model)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># here's the secret sauce</span></span>
<span id="cb5-36">    iterator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> prog_bar: iterator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(iterator, desc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Integrating Path"</span>)</span>
<span id="cb5-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> iterator:</span>
<span id="cb5-39">        t, dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ts[i], ts[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ts[i]</span>
<span id="cb5-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> latent_2d: t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t_batch.fill_(t.item())</span>
<span id="cb5-41">        current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step_fn(vel_model, current_points, t, dt, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> current_points</span>
<span id="cb5-43"></span>
<span id="cb5-44"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate_samples(sub, n_samples: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, z0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb5-45">    z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn([n_samples, sub.latent_dim]).to(sub.device) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> z0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> z0</span>
<span id="cb5-46">    z1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(sub.flow_model, z0, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_steps, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t0, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb5-47">    gen_xhat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.sigmoid(sub.decode(z1).view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>))</span>
<span id="cb5-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> gen_xhat</span></code></pre></div>
</details>
</div>
<p>Now that we know that works, let’s “supe up” <code>compute_dv()</code> to include the guidance correction. We’ll use the <code>torch.autograd.grad()</code> function to compute the gradient of the loss.<br>
First we have the <code>guidance_dict</code> that we’ll use to pass through our intentions through the various layers of routines to get to <code>compute_dv()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">guidance_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'classifier'</span>: classifier,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the classifier model to use</span></span>
<span id="cb6-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>: sub.decode,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how to decode to pixel space for classifier</span></span>
<span id="cb6-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss_fn'</span>: torch.nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't sum over batch dim</span></span>
<span id="cb6-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target'</span>: torch.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).to(device),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># desired class outcomes</span></span>
<span id="cb6-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>,              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "guidance strength", you may vary this</span></span>
<span id="cb6-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># t range to apply guidance, may vary these</span></span>
<span id="cb6-8">    }</span></code></pre></div>
</div>
<p>Next we have the fully-equipped <code>compute_dv()</code>. This code is overly-commented to make it easy to follow each step. (We replaced <code>guidance_dict</code> with <code>g</code> locally for brevity.) No other changes to any preceding code are necessary. We’ll be ready to do guided inference after this definition!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.enable_grad</span>()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;-- Needed to compute gradients if calling code has @torch.no_grad()</span></span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute_dv(v_t, z, t, g:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb7-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"Compute the guidance correction to the flow velocity"</span></span>
<span id="cb7-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>]: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.zeros_like(v_t).detach()</span>
<span id="cb7-5">    z.requires_grad_(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># need to enable gradient tracking for z</span></span>
<span id="cb7-6">    z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v_t               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear projection to estimated endpoint</span></span>
<span id="cb7-7"></span>
<span id="cb7-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Decoding to pixel space (if decoder provided)</span></span>
<span id="cb7-9">    x1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z1_hat <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> F.sigmoid(g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>](z1_hat)).view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)</span>
<span id="cb7-10"></span>
<span id="cb7-11">    logits, probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classify(g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'classifier'</span>], x1_hat)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run classifier</span></span>
<span id="cb7-12">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss_fn'</span>](logits, g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target'</span>][:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(logits)])     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loss &lt;-&gt; "negative log likelihood"</span></span>
<span id="cb7-13"></span>
<span id="cb7-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute grad wrt z. "grad_outputs=": don't sum over over batch, keep unique to each datum</span></span>
<span id="cb7-15">    grad_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.autograd.grad(loss, z, grad_outputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.ones_like(loss), retain_graph<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb7-16">    dv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>grad_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> eps)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># - minimizes, (1-t) makes it velocity, eps helps stability</span></span>
<span id="cb7-17"></span>
<span id="cb7-18">    z.requires_grad_(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cleanup (z is a tensor so local changes could propagate)</span></span>
<span id="cb7-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dv.detach()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># detach so no gradients returned</span></span></code></pre></div>
</div>
<p>Let’s go!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility as we change other things</span></span>
<span id="cb8-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb8-3">   x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_samples(sub, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>guidance_dict, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb8-4">   logits, probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classify(classifier, x1)</span>
<span id="cb8-5">show_probs(probs, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x1)</span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a2536149bb494ffa97b647bb65b47f98","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>BLAM! Our desired goal: in order, along the diagonal. We see that guidance isn’t perfect, but that’s partially a function of the VAE and the flow model too.</p>
<p>To get a better survey of the capabilities, let’s make a 10x10 grid of outputs with classes along each column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).repeat(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).to(device) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  [0,1,2,..9, 0,1,2,..9, ...]</span></span>
<span id="cb9-2">guidance_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target</span>
<span id="cb9-3">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (optional) for reproducibility</span></span>
<span id="cb9-4">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_samples(sub, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(target), guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>guidance_dict)</span>
<span id="cb9-5">show_grid(x1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Guided samples"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8ab7e6ebd1184195beb8688f3a08e687","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>That worked fine, and on a GPU it’s pretty fast, but on a CPU, it’s <em>painfully</em> slow. So instead, let’s…</p>
</section>
<section id="train-a-latent-classifier" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="train-a-latent-classifier"><span class="header-section-number">4.2</span> Train a Latent Classifier</h2>
<p>We’ll train a model <code>z_classifier</code> that looks only in latent space, so we can use it as a guidance signal. This can be a very simple model consisting of a few <code>Linear</code> layers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> LatentClassNet(nn.Module):</span>
<span id="cb10-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, latent_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, hidden_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, n_classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb10-3">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb10-4">        dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [latent_dim, hidden_dim, hidden_dim, latent_dim, n_classes]</span>
<span id="cb10-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.ModuleList([nn.Linear(in_d, out_d) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> in_d, out_d <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(dims[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], dims[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:])])   </span>
<span id="cb10-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, z):</span>
<span id="cb10-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> layer <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers: z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.leaky_relu(layer(z))</span>
<span id="cb10-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> z</span>
<span id="cb10-9"></span>
<span id="cb10-10">z_classifier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LatentClassNet().to(device)</span></code></pre></div>
</div>
<p>It will operate on latent encodings of the MNIST dataset. So let’s save the encoded latents to disk and load them into memory. These will be our training and test data.</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># You can probably skip this code block. It just runs MNIST</span></span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># through the VAE's encoder and saves it to disk. </span></span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader, TensorDataset, Subset</span>
<span id="cb11-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MNIST</span>
<span id="cb11-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ToTensor</span>
<span id="cb11-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> glob <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> glob </span>
<span id="cb11-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math </span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb11-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encode_dataset(vae, dataset, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, chunk_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, tag<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train"</span>):</span>
<span id="cb11-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Encode dataset into VAE latents (z = mu), saving progress in temp chunk files.</span></span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    We use temp chunks in case execution gets interrupted, we can try again &amp; resume. </span></span>
<span id="cb11-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb11-15">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(vae.parameters()).device</span>
<span id="cb11-16">    total_chunks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.ceil(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataset) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> chunk_size) </span>
<span id="cb11-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check for existing chunk files </span></span>
<span id="cb11-18">    basename <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"tmp_chunk_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-19">    chunk_files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> glob(basename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*.pt'</span>) </span>
<span id="cb11-20">    existing_chunks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(chunk_files)</span>
<span id="cb11-21">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: Found </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>existing_chunks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> of </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>total_chunks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> expected chunks. Generating remaining..."</span>)</span>
<span id="cb11-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> c <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(existing_chunks, total_chunks): </span>
<span id="cb11-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"chunk </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>total_chunks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span>,end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb11-24">        indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>chunk_size, (c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>chunk_size ))</span>
<span id="cb11-25">        data_subset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Subset(dataset, indices)        </span>
<span id="cb11-26">        loader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(data_subset, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb11-27">        all_latents, all_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [], []</span>
<span id="cb11-28">        must_flatten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb11-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb11-30">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> data, labels <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> loader:</span>
<span id="cb11-31">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"="</span>,end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dumb progress bar </span></span>
<span id="cb11-32">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.to(device)</span>
<span id="cb11-33">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># next bit is so it should work with linear layers or conv</span></span>
<span id="cb11-34">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> must_flatten <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> must_flatten<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>:</span>
<span id="cb11-35">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>: z, must_flatten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vae.encoder(x), <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb11-36">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">RuntimeError</span>:</span>
<span id="cb11-37">                        z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vae.encoder(x.view(x.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb11-38">                        must_flatten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb11-39">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>: z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vae.encoder(x.view(x.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb11-40">                mu, logvar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z</span>
<span id="cb11-41">                all_latents.append(mu.cpu())</span>
<span id="cb11-42">                all_labels.append(labels)</span>
<span id="cb11-43">        chunk_latents, chunk_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat(all_latents), torch.cat(all_labels)</span>
<span id="cb11-44">        tmp_filename <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>basename<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pt"</span></span>
<span id="cb11-45">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"|  Saving chunk to </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tmp_filename<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb11-46">        torch.save({ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'latents'</span>:chunk_latents, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'labels'</span>:chunk_labels }, tmp_filename)</span>
<span id="cb11-47">    </span>
<span id="cb11-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assemble all the chunks from files and return tensors.</span></span>
<span id="cb11-49">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Assembling"</span>, basename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*.pt ...'</span>)</span>
<span id="cb11-50">    all_latents, all_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [], []</span>
<span id="cb11-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> chunk_file <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> glob(basename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*.pt'</span>): </span>
<span id="cb11-52">        chunk_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(chunk_file, weights_only<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb11-53">        all_latents.append(chunk_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'latents'</span>])</span>
<span id="cb11-54">        all_labels.append(chunk_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'labels'</span>]) </span>
<span id="cb11-55">    latents, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat(all_latents), torch.cat(all_labels)</span>
<span id="cb11-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for f in glob(tmp_file_base+'*.pt'): os.remove(f)   # clean up </span></span>
<span id="cb11-57">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> latents, labels </span>
<span id="cb11-58"></span>
<span id="cb11-59"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encode_mnist(vae, filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>):</span>
<span id="cb11-60">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acquiring train &amp; test MNIST image datasets..."</span>)</span>
<span id="cb11-61">    train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MNIST(root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./data'</span>, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,  download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor())</span>
<span id="cb11-62">    test_ds  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MNIST(root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./data'</span>, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor())</span>
<span id="cb11-63">    </span>
<span id="cb11-64">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Encoding dataset to latents..."</span>)</span>
<span id="cb11-65">    train_latents, train_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode_dataset(vae, train_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, tag<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train'</span>)</span>
<span id="cb11-66">    test_latents, test_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode_dataset(vae, test_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, tag<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test'</span>)</span>
<span id="cb11-67">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> glob(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tmp_chunk_t*_c*.pt'</span>): os.remove(f)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clean up</span></span>
<span id="cb11-68"></span>
<span id="cb11-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> filename <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb11-70">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving to </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>filename<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ..."</span>)</span>
<span id="cb11-71">        torch.save({ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_z'</span>: train_latents,     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test_z'</span>: test_latents,</span>
<span id="cb11-72">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_labels'</span>: train_labels, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test_labels'</span>: test_labels }, filename)</span>
<span id="cb11-73">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> train_latents, train_labels</span>
<span id="cb11-74"></span>
<span id="cb11-75"></span>
<span id="cb11-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encode the dataset</span></span>
<span id="cb11-77">latent_data_filename <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mnist_latents.pt'</span></span>
<span id="cb11-78"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> os.path.exists(latent_data_filename):</span>
<span id="cb11-79">    train_latents, train_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode_mnist(sub.vae, filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>latent_data_filename)</span>
<span id="cb11-80"></span>
<span id="cb11-81"></span>
<span id="cb11-82"></span>
<span id="cb11-83"></span>
<span id="cb11-84"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> load_data(filename):</span>
<span id="cb11-85">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MyDrive'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> filename:</span>
<span id="cb11-86">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> google.colab <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> drive</span>
<span id="cb11-87">        drive.mount(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/content/drive'</span>)</span>
<span id="cb11-88">    data_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(filename, weights_only<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb11-89">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> data_dict</span>
<span id="cb11-90"></span>
<span id="cb11-91">data_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_data(latent_data_filename)</span>
<span id="cb11-92">train_z, test_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_z'</span>], data_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test_z'</span>]</span>
<span id="cb11-93">train_z.shape, test_z.shape</span>
<span id="cb11-94"></span>
<span id="cb11-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create datasets from the latent tensors</span></span>
<span id="cb11-96">train_latent_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(train_z, data_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_labels'</span>][:train_z.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])</span>
<span id="cb11-97">test_latent_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(test_z, data_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test_labels'</span>])</span>
<span id="cb11-98"></span>
<span id="cb11-99">batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span></span>
<span id="cb11-100">train_latent_dl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(train_latent_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb11-101">test_latent_dl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(test_latent_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb11-102"></span>
<span id="cb11-103"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Train batches: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_latent_dl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, Test batches: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(test_latent_dl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb11-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print single latent size</span></span>
<span id="cb11-105"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Latent size: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>train_latent_ds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train batches: 118, Test batches: 20
Latent size: torch.Size([16])</code></pre>
</div>
</div>
<p>Then we’ll run the training loop…</p>
<details>
<summary>
Training Loop Code and Execution
</summary>
<div class="cell" data-hide_input="true">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Latent classifier training loop</span></span>
<span id="cb13-2">optimizer  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam(z_classifier.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>, weight_decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>)</span>
<span id="cb13-3">criterion  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.CrossEntropyLoss()</span>
<span id="cb13-4">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb13-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(epochs):</span>
<span id="cb13-6">    z_classifier.train()</span>
<span id="cb13-7">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(train_latent_dl, desc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, leave<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb13-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> latents, labels <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> pbar:</span>
<span id="cb13-9">        optimizer.zero_grad()</span>
<span id="cb13-10">        logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z_classifier(latents.to(device))</span>
<span id="cb13-11">        loss   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> criterion(logits, labels.to(device))</span>
<span id="cb13-12">        pbar.set_postfix({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_loss'</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>})</span>
<span id="cb13-13">        loss.backward()</span>
<span id="cb13-14">        optimizer.step()</span>
<span id="cb13-15">    </span>
<span id="cb13-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Validation</span></span>
<span id="cb13-17">    z_classifier.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb13-18">    val_latents, val_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>(test_latent_dl))</span>
<span id="cb13-19">    val_logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z_classifier(val_latents.to(device))</span>
<span id="cb13-20">    val_loss   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> criterion(val_logits, val_labels.to(device))</span>
<span id="cb13-21">    val_acc    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (val_logits.cpu().argmax(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> val_labels).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span>
<span id="cb13-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: train_loss=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, val_loss=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>val_loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, val_acc=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>val_acc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fdb2c9acef1b4265a1e90a5caa8ec257","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/8: train_loss=0.9673, val_loss=1.1017, val_acc=0.6211
Epoch 2/8: train_loss=0.1901, val_loss=0.1919, val_acc=0.9375
Epoch 3/8: train_loss=0.0512, val_loss=0.1205, val_acc=0.9570
Epoch 4/8: train_loss=0.1193, val_loss=0.1022, val_acc=0.9668
Epoch 5/8: train_loss=0.0810, val_loss=0.0948, val_acc=0.9648
Epoch 6/8: train_loss=0.1569, val_loss=0.0815, val_acc=0.9707
Epoch 7/8: train_loss=0.0504, val_loss=0.0841, val_acc=0.9629
Epoch 8/8: train_loss=0.0408, val_loss=0.0792, val_acc=0.9746</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3dd3701c663e4306bc0445c104952934","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dc0708eb2260462bb8217f522b7fe057","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1aec0c9482984581ab4418886b21ba9e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a6db95ee00a046619dabc17e8bd48799","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3539bf9f9b354f09b905acaad338a9a7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1693b4abbb7542c5b044106028de047a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cb31008f9d9a451c96e5fede9590b4a3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</details>
<p>Let’s test our newly-trained latent classifier, to make sure it works before trying to use it for guidance. We’ll pull up data samples with known ground-truth “target” labels, and compare these to the predictions from the classifier. If the targets and predictions match up, we’re good to go:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">z, L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_latent_ds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>]</span>
<span id="cb15-2">z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z.to(device) </span>
<span id="cb15-3">show_grid(F.sigmoid(sub.decode(z)).view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>))</span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb15-5">    pred_class <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classify(z_classifier, z, use_argmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb15-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Target labels:   "</span>,L)</span>
<span id="cb15-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted labels:"</span>, pred_class.cpu())</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Target labels:    tensor([9, 6, 6, 5, 4, 0, 7, 4, 0, 1])
Predicted labels: tensor([9, 6, 6, 5, 4, 0, 7, 4, 0, 1])</code></pre>
</div>
</div>
<p>Good! They match up. Let’s move on…</p>
</section>
<section id="latents-only-guidance" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="latents-only-guidance"><span class="header-section-number">4.3</span> Latents-Only Guidance</h2>
<p>Now that we have a trained classifier that operates in latent space, we can run basically the same code as before, only it will execute wayyyyy faster…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">guidance_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'classifier'</span>: z_classifier,</span>
<span id="cb17-2">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># no decoding, latent space only</span></span>
<span id="cb17-3">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss_fn'</span>: torch.nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't sum across batch dim</span></span>
<span id="cb17-4">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target'</span>: torch.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).repeat(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).to(device),</span>
<span id="cb17-5">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "guidance strength"</span></span>
<span id="cb17-6">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, }</span>
<span id="cb17-7"></span>
<span id="cb17-8">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove for new samples each time</span></span>
<span id="cb17-9">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_samples(sub, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(guidance_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target'</span>]), guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>guidance_dict)</span>
<span id="cb17-10">show_grid(x1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latent-Only Guidance"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"98e80ad3c0c84fb9b7aeae8cf8f01e61","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Was that fast or WHAT?!</p>
<p>Since we no longer have to propagate gradients through the much larger VAE decoder model and pixel-space classifer, we can get answers a lot faster via our small latents-only classifier.</p>
<p>Let’s move on to another application of guidance, for which our guidance signal doesn’t depend on a separate trained (classifier) model at all: inpainting.</p>
</section>
</section>
<section id="inpainting" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Inpainting</h1>
<p>When inpainting, we have some “mask” inside which some of the data have been removed, and we want to use the model to fill in the missing part in a way that matches with the surrounding pixels. Let’s take a look at an example from MNIST, where we show an original image, the mask and the masked-out image:</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Demo what inpainting looks like</span></span>
<span id="cb18-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MNIST</span>
<span id="cb18-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ToTensor</span>
<span id="cb18-4"></span>
<span id="cb18-5">test_ds  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MNIST(root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./data'</span>, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor())</span>
<span id="cb18-6">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_ds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb18-7">H, W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:]</span>
<span id="cb18-8">M <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.ones([H,W], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x.dtype, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x.device)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1 = keep pixels</span></span>
<span id="cb18-9">M[H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, W<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>W<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 0 = mask out</span></span>
<span id="cb18-10">x_masked <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x</span>
<span id="cb18-11">show_grid( torch.cat([x, M.unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), x_masked],dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"      Original      |      Mask      |  Masked Image"</span> )</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Another example would be a picture of a face where you’ve blocked out the nose and you want the model to fill in a nose.</p>
<p>Now, some of the “filling in” you can get “for free” because the model has only been exposed to data that satisfies the manifold or probability distribution of the training data – e.g.&nbsp;If it was trained on faces, then it only ever saw faces with noses and hence can only generate faces with noses – but the real trick is to do it “well” and have it be “good” in the end. ;-)</p>
<p>There’s a wealth of information on guidance as it was originally applied to diffusion models. Sander Dieleman’s blog post, <a href="https://sander.ai/2022/05/26/guidance.html">“Guidance: a cheat code for diffusion models”</a><span class="citation" data-cites="dieleman2022guidance">[8]</span>, is a classic and should (eventually) be read by all. Yet because of the stochastic/random nature of the diffusion path, there are several “complicating” aspects of diffusion guidance that we’re going to gloss over in this tutorial because in the case of deterministic, smooth flow-model trajectories, things become a lot more intuitive.</p>
<p>We’ll follow a method outlined in the paper <a href="https://arxiv.org/abs/2310.04432">“Training-free Linear Image Inverses via Flows”</a><span class="citation" data-cites="pokle2024trainingfree">[12]</span> by Pokle et al, a method that applies to general linear inverse problems of which inpainting is a particular case, and we’ll simplify their method to adapt it for <em>just inpainting.</em></p>
<p>The method will be to try to generate an <em>entire</em> new image <img src="https://latex.codecogs.com/png.latex?x_1"> that everywhere <em>outside the mask matches up</em> with the pixels in user-supplied (masked) image <img src="https://latex.codecogs.com/png.latex?y">. So the constraint will be, given a 2D mask <img src="https://latex.codecogs.com/png.latex?M"> (where <img src="https://latex.codecogs.com/png.latex?M">=1 means there’s an original pixel there, and <img src="https://latex.codecogs.com/png.latex?M">=0 is the masked-out region), to require that our estimate image <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bx_1%7D"> (i.e.&nbsp;the decoded/pixel version of the estimated latents <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> ) satisfies <img src="https://latex.codecogs.com/png.latex?M*%5Cwidehat%7Bx_1%7D%20=%20M*%20y%5C,"><sup>1</sup> , or in a “residual form”, we’ll just compute the Mean Squared Error (MSE) of <img src="https://latex.codecogs.com/png.latex?M*(%5Cwidehat%7Bx_1%7D-y)">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%7B%5Crm%20Constraint:%7D%20=%20M%5E2%20*%20(%5Cwidehat%7Bx_1%7D-y)%5E2%20"> (and if we want, we can use the fact that <img src="https://latex.codecogs.com/png.latex?M"> being a binary mask means <img src="https://latex.codecogs.com/png.latex?M%5E2%20=%20M">).</p>
<p>If we want to do latent-only inpainting (which will be the fastest), then the same constraint applies just with the simplification <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bx_1%7D%20=%20%5Cwidehat%7Bz_1%7D"></p>
<p>The authors of the paper recommend only doing guidance from <img src="https://latex.codecogs.com/png.latex?t=0.2"> onward because prior to that, it’s hard to make any meaningful estimate.. In fact, they don’t even integrate before <img src="https://latex.codecogs.com/png.latex?t%20=%200.2">. They just interpolate between the source and the target data to get their starting point at <img src="https://latex.codecogs.com/png.latex?t%20=%200.2">.</p>
<p>To use our constraint in the guidance equation (3) for computing <img src="https://latex.codecogs.com/png.latex?%5CDelta%20v%5C,">, we’ll need to turn our constraint into a likelihood by raising it to an exponential power – so we get a Gaussian! But the guidance equation includes a logarithm that immediately <em>undoes</em> our exponentiation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5CDelta%20v%20=%20-%20%7B%5Ceta%20%5Cover%201-t%7D%20%5Cnabla_%7Bz_t%7D%20%5C%20%5C,%7B%5Ccolor%7Bred%7D%7B%5Ctext%7Bl%CC%B8o%CC%B8g%CC%B8%7D%5C,%5Ctext%7Be%CC%B8x%CC%B8p%CC%B8%7D%7D%7D%0A%5Cleft(%20%20M%5E2%20*%20(%5Cwidehat%7Bx_1%7D-y)%5E2%20%5Cright)%20."></p>
<p>The gradient part is <img src="https://latex.codecogs.com/png.latex?%20%5Cnabla_%7Bz_t%7D%20M%5E2%20*(%5Cwidehat%7Bx_1%7D-y)%5E2%20=%202M%5E2*(%5Cwidehat%7Bx_1%7D-y)%20%7B%5Cpartial%20%5Cwidehat%7Bx_1%7D%20%5Cover%20%5Cpartial%20z_t%20%7D%20"></p>
<p>If we’re inpainting in latent space and not using the decoder for the constraint, then <img src="https://latex.codecogs.com/png.latex?%7B%5Cpartial%20%5Cwidehat%7Bx_1%7D%20/%20%5Cpartial%20z_t%20%7D%20=%201">. Otherwise that term will require evaluation via PyTorch’s <code>autograd</code> (=slow).</p>
<p>Our earlier time scaling was <img src="https://latex.codecogs.com/png.latex?1/(1-t)">; turns out that doesn’t work very well in practice when it comes to inpainting. Instead, we’ll use a different time scaling that delivers good (albeit not perfect) results: <img src="https://latex.codecogs.com/png.latex?(1-t)/t">. Thus our full equation for the velocity correction will be:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5CDelta%20%5Cvec%7Bv%7D%20=%20-%5Ceta%20%7B1-t%5Cover%20t%7D%20M%5E2%20*(%5Cwidehat%7Bx_1%7D%20-%20y)%7B%5Cpartial%5Cwidehat%7Bx_1%7D%5Cover%5Cpartial%7Bz_t%7D%7D,%20%20"> where we absorbed the factor of 2 into <img src="https://latex.codecogs.com/png.latex?%5Ceta">, and the last partial derivative term can be one if we do latent-only inpainting.</p>
<p>Let’s implement this in code, using two different versions of the gradient calculation, depending on whether we can do it all in latent space or if we need to propagate gradients through the decoder:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gradients computed analytically!</span></span>
<span id="cb19-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ip_latents_grad(v_t, z, t, g:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb19-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"inpainting gradients for latent-only guidance, fast"</span></span>
<span id="cb19-4">    z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v_t</span>
<span id="cb19-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  x1_hat = z1_hat, dz1_hat/dz_t=1</span></span>
<span id="cb19-6"></span>
<span id="cb19-7"></span>
<span id="cb19-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.enable_grad</span>()</span>
<span id="cb19-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> ip_pixels_grad(v_t, z, t, g:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, img_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb19-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"inpainting gradients for pixel-space guidance. needs decoder &amp; tracks via autograd, = slow"</span></span>
<span id="cb19-11">    z.requires_grad_(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb19-12">    z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v_t</span>
<span id="cb19-13">    x1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.sigmoid(g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>](z1_hat)).view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>img_size) </span>
<span id="cb19-14">    grad_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (x1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>])</span>
<span id="cb19-15">    grad_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.autograd.grad(x1_hat, z, grad_outputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>grad_x,retain_graph<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mults grad_x by dx1_hat/dz1_hat</span></span>
<span id="cb19-16">    z.requires_grad_(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb19-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> grad_z.detach()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't send gradients onward</span></span>
<span id="cb19-18"></span>
<span id="cb19-19"></span>
<span id="cb19-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> t_timescale(t, choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mine'</span>):</span>
<span id="cb19-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"our choice for adaptive time scale"</span></span>
<span id="cb19-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> choice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'simple'</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># our earlier scale; doesn't work</span></span>
<span id="cb19-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pokle'</span>: </span>
<span id="cb19-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from pokle et al; can't get it to work</span></span>
<span id="cb19-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> choice<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'constant'</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or any constant. The 4 is from Pokle et al</span></span>
<span id="cb19-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>t        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Works pretty well! Strong guidance at start, zero at end</span></span>
<span id="cb19-27"></span>
<span id="cb19-28"></span>
<span id="cb19-29"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute_dv_inpainting(v_t, z, t, g:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb19-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"wrapper to call appropriate gradient-computation routine"</span></span>
<span id="cb19-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>]: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.zeros_like(v_t)</span>
<span id="cb19-32">    grad_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ip_latents_grad <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> ip_pixels_grad</span>
<span id="cb19-33">    grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grad_fn(v_t, z, t, g, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb19-34">    dv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>g[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t_timescale(t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad</span>
<span id="cb19-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dv.detach()</span></code></pre></div>
</details>
</div>
<section id="do-the-inpainting" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="do-the-inpainting"><span class="header-section-number">5.1</span> Do the Inpainting</h2>
<p>Start with masked images <img src="https://latex.codecogs.com/png.latex?y">…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setup the data</span></span>
<span id="cb20-2">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([test_ds[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)])</span>
<span id="cb20-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(y.shape)</span>
<span id="cb20-4">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>y</span>
<span id="cb20-5">show_grid(y.squeeze(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masked Images"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([50, 1, 28, 28])</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>And now we run the inpainting code</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">compute_dv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> compute_dv_inpainting  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># register our new guidance routine</span></span>
<span id="cb22-2"></span>
<span id="cb22-3">inpainting_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>: sub.decode,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how to decode to pixel space for classifier</span></span>
<span id="cb22-4">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>: (M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).to(device),</span>
<span id="cb22-5">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: y.to(device),</span>
<span id="cb22-6">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "guidance strength", you may vary this</span></span>
<span id="cb22-7">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.999</span>} <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># t range to apply guidance, may vary these</span></span>
<span id="cb22-8"></span>
<span id="cb22-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb22-10">    torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility as we change other things</span></span>
<span id="cb22-11">    t0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starting time as per Pokle et al</span></span>
<span id="cb22-12">    z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn([<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y), sub.latent_dim]).to(sub.device)</span>
<span id="cb22-13">    zy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sub.encode(y.to(device))   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># encoded version of masked image</span></span>
<span id="cb22-14">    z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> zy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t0      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># interpolation init</span></span>
<span id="cb22-15">    inpainting_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t0</span>
<span id="cb22-16">    x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_samples(sub, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y), t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t0, z0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z0, guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inpainting_dict, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb22-17"></span>
<span id="cb22-18">show_grid(y.squeeze(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masked Images"</span>)</span>
<span id="cb22-19">show_grid(x1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Inpainted Images"</span>) </span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f1e8bfa1795f49f09e0879643742c148","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-24-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>We see that the generated images generally look great, although in some cases, the in-painting code has changed pixels even where the mask is 1. We can disallow this by just resetting those values to the pixels in <img src="https://latex.codecogs.com/png.latex?y">.</p>
<p>Turning up the guidance strength would also enforce our constraint better, but turning up too high causes the whole thing to diverge and we get garbage out.</p>
<p>In order to experiment with other methods more easily, we should do inpainting only in latent space, and for that we will need a model that supports spatial latents….</p>
</section>
<section id="latent-only-inpainting" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="latent-only-inpainting"><span class="header-section-number">5.2</span> Latent-Only Inpainting</h2>
<p>To do inpainting in latent space, we’ll need to switch models to one where the latents preserve the spatial structure of the original images.</p>
<details>
<summary>
Get the spatial-latents model
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get Spatial VAE &amp; FLow DiT Model</span></span>
<span id="cb23-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>wget <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>no<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>clobber<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>off https:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>raw.githubusercontent.com<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dlaieburner<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>leaderboard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>refs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>heads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>sample_submission_dit.py</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb23-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">del</span> SubmissionInterface <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove Marco's from earlier; make it reload</span></span>
<span id="cb23-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">NameError</span>:</span>
<span id="cb23-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># nevermind</span></span>
<span id="cb23-8"></span>
<span id="cb23-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sample_submission_dit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SubmissionInterface</span>
<span id="cb23-10"></span>
<span id="cb23-11">sub <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SubmissionInterface().to(device)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>device = mps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading...
From: https://drive.google.com/uc?id=1kPK3ZPadOUEfH8ZycrG3k27pl9-lGUeL
To: /Users/shawley/github/blog/posts/downloaded_vae.safetensors
100%|████████████████████████████████████████████████████████████████████████████████| 12.6M/12.6M [00:00&lt;00:00, 13.5MB/s]
Downloading...
From: https://drive.google.com/uc?id=1q9Iguf--2_MqUjsosS7iAGGzYtVfJ3UF
To: /Users/shawley/github/blog/posts/downloaded_flow.safetensors
100%|████████████████████████████████████████████████████████████████████████████████| 34.1M/34.1M [00:02&lt;00:00, 16.7MB/s]
  0%|          | 0.00/12.6M [00:00&lt;?, ?B/s]  4%|▍         | 524k/12.6M [00:00&lt;00:02, 4.41MB/s] 25%|██▌       | 3.15M/12.6M [00:00&lt;00:00, 16.1MB/s] 46%|████▌     | 5.77M/12.6M [00:00&lt;00:00, 18.5MB/s] 79%|███████▉  | 9.96M/12.6M [00:00&lt;00:00, 26.8MB/s]100%|██████████| 12.6M/12.6M [00:00&lt;00:00, 24.0MB/s]
Downloading...
From: https://drive.google.com/uc?id=1q9Iguf--2_MqUjsosS7iAGGzYtVfJ3UF
To: /Users/shawley/github/blog/posts/downloaded_flow.safetensors
  0%|          | 0.00/34.1M [00:00&lt;?, ?B/s]  2%|▏         | 524k/34.1M [00:00&lt;00:08, 4.17MB/s] 11%|█         | 3.67M/34.1M [00:00&lt;00:01, 17.3MB/s] 22%|██▏       | 7.34M/34.1M [00:00&lt;00:01, 24.7MB/s] 29%|██▉       | 9.96M/34.1M [00:00&lt;00:01, 23.2MB/s] 42%|████▏     | 14.2M/34.1M [00:00&lt;00:00, 29.2MB/s] 52%|█████▏    | 17.8M/34.1M [00:00&lt;00:00, 30.8MB/s] 63%|██████▎   | 21.5M/34.1M [00:00&lt;00:00, 31.3MB/s] 74%|███████▍  | 25.2M/34.1M [00:00&lt;00:00, 30.3MB/s] 85%|████████▍ | 28.8M/34.1M [00:01&lt;00:00, 31.0MB/s] 95%|█████████▌| 32.5M/34.1M [00:01&lt;00:00, 32.1MB/s]100%|██████████| 34.1M/34.1M [00:01&lt;00:00, 28.7MB/s]</code></pre>
</div>
</div>
</details>
<p>Let’s take a look at the images and their spatial-latent representations:</p>
<div class="cell" data-hide_input="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># viz images and spatial latents</span></span>
<span id="cb26-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MNIST</span>
<span id="cb26-3">test_ds  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MNIST(root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./data'</span>, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor())</span>
<span id="cb26-4"></span>
<span id="cb26-5">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([test_ds[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)])</span>
<span id="cb26-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(x.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>: x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb26-7">show_grid(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Images"</span>)</span>
<span id="cb26-8">z1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sub.encode(x)</span>
<span id="cb26-9">show_grid((z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>z1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>())<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(z1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>z1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>()), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latents"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> prepare_latent_mask(image, mask, encoder):</span>
<span id="cb27-2">    z_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encoder(image.to(device))</span>
<span id="cb27-3">    M_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.interpolate(mask[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>], size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z_y.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:], mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bilinear'</span>, align_corners<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>).to(device)</span>
<span id="cb27-4">    M_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (M_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>()    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># binarize it</span></span>
<span id="cb27-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> z_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> M_z, M_z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb27-6"></span>
<span id="cb27-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb27-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> latents_only_inpaint(sub, inpainting_dict, n_samples, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb27-9">    z_y, M_sq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prepare_latent_mask(y, M, sub.encode)   </span>
<span id="cb27-10">    inpainting_dict.update({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>: M_sq, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: z_y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: t0})</span>
<span id="cb27-11">    z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(z_y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t0         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize via interpolation</span></span>
<span id="cb27-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> generate_samples(sub, n_samples, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t0, z0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z0,  guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inpainting_dict, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_fn)</span>
<span id="cb27-13"></span>
<span id="cb27-14">inpainting_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decode'</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now we're latents-only</span></span>
<span id="cb27-15">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "guidance strength", you may vary this</span></span>
<span id="cb27-16">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.999</span>} <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># t range to apply guidance, may vary these</span></span>
<span id="cb27-17"></span>
<span id="cb27-18">show_grid(y.squeeze(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pixel y's"</span>)</span>
<span id="cb27-19">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> latents_only_inpaint(sub, inpainting_dict, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb27-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>()</span>
<span id="cb27-21">show_grid(x1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inpainted images"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c1515ec1a7bd4e46b9b3e37dae18a61f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-27-output-4.png" class="img-fluid"></p>
</div>
</div>
<p>Notice the execution speed!</p>
<p>There are some limitations to what’s being produced. The problem is due to the low resolution of our latents. Inpainting algorithms typically assume higher resolution in order to work accurately. But this lesson was designed to run quickly on CPUs and thus there is a trade-off.</p>
<p>Now, if we want to enforce the original pixels where the mask is one, we can do that at every stage of the integration process. We just need to modify the integration process to overwrite <img src="https://latex.codecogs.com/png.latex?z"> wherever <code>Mz</code> is 1.</p>
<p>Let’s move on and try a different method that can achieve similar results, albiet differently…</p>
</section>
</section>
<section id="pnp-flow-guidance-by-another-name" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> PnP-Flow: Guidance By Another Name</h1>
<p>The term ‘guidance’ typically refers to velocity modifications, but PnP-Flow by Martin et al<span class="citation" data-cites="pnp_flow">[13]</span> achieves similar results by adjusting latent positions <img src="https://latex.codecogs.com/png.latex?z"> directly.<sup>2</sup><img src="https://latex.codecogs.com/png.latex?%5E,"><sup>3</sup></p>
<p>PnP-Flow assumes straight-line trajectories, making the forward projection trivial: <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> is reached by simple linear extrapolation. Instead of incrementally moving <img src="https://latex.codecogs.com/png.latex?z"> from <img src="https://latex.codecogs.com/png.latex?t=0"> to <img src="https://latex.codecogs.com/png.latex?t=1">, PnP-Flow projects forward to <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> and iterates on that estimate through a series of correction and projection steps. The first step applies our gradient correction:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B%5Crm%20Step%5C%201.%7D%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20z_1%5E*%20:=%20%5Cwidehat%7Bz_1%7D%20-%20%5Ceta%5C,%5Cgamma_t%20%5Cnabla%20F(%5Cwidehat%7Bz_1%7D,y)"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?z_1%5E*"> (my notation) is our goal i.e.&nbsp;the endpoint of our projected course correction, and <img src="https://latex.codecogs.com/png.latex?F(%5Cwidehat%7Bz_1%7D,y)"> is our (log-exp probability) constraint. For the time scaling, the PnP-Flow authors recommend <img src="https://latex.codecogs.com/png.latex?%5Cgamma_t%20=%20(1-t)%5E%5Calpha"> with <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5B0,1%5D"> is a hyperparameter chosen according to the task – e.g., they use <img src="https://latex.codecogs.com/png.latex?%5Calpha">’s as large as 0.8 for denoising tasks, 0.5 for box inpainting, and 0.01 for random inpainting. This choice of <img src="https://latex.codecogs.com/png.latex?%5Cgamma_t"> is a bit different from our earlier one of <img src="https://latex.codecogs.com/png.latex?(1-t)/t">. Both go to zero as <img src="https://latex.codecogs.com/png.latex?t%20%5Crightarrow%201">, but approach it differently and have different asymptotics as <img src="https://latex.codecogs.com/png.latex?t%5Crightarrow%200">.</p>
<p>In the graph below, we show our earlier choice of <img src="https://latex.codecogs.com/png.latex?(1%20-%20t)/t"> in green and <img src="https://latex.codecogs.com/png.latex?(1%20-%20t)%5E%5Calpha"> in purple for various choices of <img src="https://latex.codecogs.com/png.latex?%5Calpha">:</p>
<div class="cell">
<div class="cell-output cell-output-display">

<iframe src="https://www.desmos.com/calculator/bcp2wiyyid?embed" width="220" height="300" style="border: 1px solid #ccc; display: block; margin: 0 auto;" frameborder="0"></iframe>
</div>
</div>
<p>…where for “box inpainting” as we did above, they use <img src="https://latex.codecogs.com/png.latex?%5Calpha">=0.5.</p>
<p>But PnP-Flow doesn’t stop there! Two other key steps remain. We then project backward to <em>overwrite</em> <img src="https://latex.codecogs.com/png.latex?z_t"> with a corrected value:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B%5Crm%20Step%5C%202.%7D%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%20%5C%20%5C%20%5C%20%5C%20%20%5C%20%5C%20z_t%20:=%20(1-t)%5C,z_0%20+%20t%5C,%20z_1%5E*%20"></p>
<p>We then compute a new projected estimate, same as we have before:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B%5Crm%20Step%5C%20%203.%7D%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%20%20%5Cwidehat%7Bz_1%7D%20:=%20z_t%20+%20(1-t)%5C,v_t(z,t)"></p>
<p>….and loop over Steps 1 to 3 for each value of <img src="https://latex.codecogs.com/png.latex?t"> in our set of (discrete) integration steps, i.e.&nbsp;after Step 3, we let <img src="https://latex.codecogs.com/png.latex?t%20:=%20t+%5CDelta%5C,t"> and go back to Step 1. Our final value of <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> will be the output.</p>
<p>This image from the PnP-Flow paper may prove instructive, showing 3 different instances of the 3 PNP steps:</p>
<style>
.img3 {
    /*transform-origin: top left;*/
    /*width:140px;*/
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img3:hover {
    -webkit-transform:scale(1.35);
    transform:scale(1.35);
    z-index:1;
}
</style>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/pnp_flow_diag_mod.png" class="img3 img-fluid figure-img"></p>
<figcaption class="figure-caption">Image from PnP-Flow paper [12], slightly re-annotated by me.</figcaption>
</figure>
</div>
<p>This has a superficial resemblance to the “<a href="https://github.com/Stability-AI/stable-audio-tools/blob/31932349d98c550c48711e7a5a40b24aa3d7c509/stable_audio_tools/inference/sampling.py#L221">ping pong</a>” integration method used by Stable Audio Open Small (SAOS) <span class="citation" data-cites="sao_small">[14]</span>, with a key distinction: SAOS maintains and updates the time-integrated latent variable <img src="https://latex.codecogs.com/png.latex?z"> (called “<img src="https://latex.codecogs.com/png.latex?x">” in SAOS), whereas for PnP-Flow it is the projection <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D"> (called <a href="https://github.com/Stability-AI/stable-audio-tools/blob/31932349d98c550c48711e7a5a40b24aa3d7c509/stable_audio_tools/inference/sampling.py#L242">“denoised”</a>) in SAOS) that is the primary variable that is maintained between steps. This is a subtle distinction but worth noting.<sup>4</sup></p>
<p>To implement PnP-Flow in code, let’s replace our “integrator” with something specific to PnP-Flow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb29-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sample_pnpflow(model, z0, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, n_avg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: x, guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb29-3">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_fn(torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_steps, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z0.device, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z0.dtype))  </span>
<span id="cb29-4">    z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z0</span>
<span id="cb29-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]:</span>
<span id="cb29-6">        grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> guidance_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> guidance_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>])</span>
<span id="cb29-7">        gamma_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> alpha</span>
<span id="cb29-8">        z1_star <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> guidance_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> gamma_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad        </span>
<span id="cb29-9">        projections <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Average multiple noisy projections</span></span>
<span id="cb29-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_avg):</span>
<span id="cb29-11">            z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z1_star  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.randn_like(z1_star) </span>
<span id="cb29-12">            projections.append(z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> model(z, t))</span>
<span id="cb29-13">        z1_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(projections).mean(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb29-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> z1_hat</span></code></pre></div>
</div>
<p>The model we used earlier for latents-only inpainting was trained to have straight trajectories, so we should be able to use it again here, just calling <code>sample_pnpflow</code> (instead of <code>integrate_path</code>). The results are as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb30-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> pnp_flow_inpaint(sub, inpainting_dict, n_samples, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, t0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb30-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Inpaint using PnP-Flow method"""</span></span>
<span id="cb30-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> seed <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: torch.manual_seed(seed)</span>
<span id="cb30-5">    z_y, M_sq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prepare_latent_mask(y, M, sub.encode)</span>
<span id="cb30-6">    inpainting_dict.update({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M_sq'</span>: M_sq, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: z_y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: t0})</span>
<span id="cb30-7">    z0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(z_y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t0</span>
<span id="cb30-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sample_pnpflow(sub.flow_model, z0, guidance_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inpainting_dict, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb30-9"></span>
<span id="cb30-10"></span>
<span id="cb30-11">inpainting_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_min'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t_max'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.999</span>}</span>
<span id="cb30-12"></span>
<span id="cb30-13">show_grid(y,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masked pixel images (y)"</span>)</span>
<span id="cb30-14"></span>
<span id="cb30-15">z1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pnp_flow_inpaint(sub, inpainting_dict, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb30-16">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.sigmoid(sub.decode(z1)).cpu()   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert latents to pixels</span></span>
<span id="cb30-17">show_grid(x1, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Inpainted images (alpha=0.5, strength=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>inpainting_dict[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'strength'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowWhereYouWant_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>…So that works, though it also seems to “take some liberties”: most of the letters in the second group look like “boldface” versions of the top ones. This could be because of the low spatial resolution of the latents, e.g.&nbsp;that they are encoding information about curvature or other aspects of the shape.</p>
<p>The results are similar to the previous inpainting method of Pokle et al, just a different way of doing it that may prove worthwhile.</p>
<p>PnP-Flow is a general guidance method not limited to inpainting or even “linear” image degradations. I recommend looking into it further for other tasks and datasets — and let me know what sort of results you find!</p>
</section>
<section id="summary" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Summary</h1>
<p>Training new models is expensive—lots of data, electricity, compute time. So what if you could take a pretrained model and add controls at inference time instead? That’s what this tutorial explored. While similar ideas are emerging for steering autoregressive models <span class="citation" data-cites="zhao2025steeringautoregressive">[16]</span>, here we focused on pretrained flow models.</p>
<p>The key idea is simple: at each integration step, you project forward to estimate where you’ll end up (<img src="https://latex.codecogs.com/png.latex?%5C,%5Cwidehat%7Bz_1%7D%5C,">) , check how far that is from where you want to be, and add a small velocity correction to steer toward your goal. We applied this to an unconditional MNIST flow model for two tasks: generating specific digit classes via classifier guidance, and filling in masked-out regions via inpainting.</p>
<p>We looked at four approaches. First, standard classifier guidance in pixel space—it works but it’s slow because you’re propagating gradients through the VAE decoder. Second, we trained a simple latent-space classifier and did the same thing much faster. Third, we implemented the linear inpainting method from Pokle et al, which operates directly on latents. Fourth, we tried PnP-Flow, which achieves guidance not by correcting velocities but by iteratively projecting samples forward and backward in time.</p>
<p>The math here is much simpler than the corresponding diffusion methods because flow trajectories are smooth and deterministic. We’ve glossed over a lot of detail compared to the research papers, but hopefully this gives you enough to experiment with your own controls. There are limits to the effectiveness of guidance: small models that don’t generalize well won’t suddenly work miracles if you try to push them too far outside their training distribution. Nevertheless, these plugin methods are worth exploring as accessible ways to steer generative flows where you want them to go.</p>
</section>
<section id="acknowledgements" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Acknowledgements</h1>
<p>This work was supported by <a href="https://www.hyperstate.ai/">Hyperstate Music, Inc.</a> who are awesome and you should invest in them! ;-) For providing feedback on early drafts of this tutorial: thanks to <a href="https://www.linkedin.com/in/raymond-fan-4398671ba/">Raymond Fan</a>, <a href="https://www.linkedin.com/in/alan-lockett-6a30207/?skipRedirect=true">Alan Lockett</a>, and my amazing students in PHY/DSC/BSA 4420, “<a href="https://github.com/drscotthawley/dlaie">Deep Learning and AI Ethics</a>”! Also thanks to <a href="https://www.linkedin.com/in/danilocomminiello/?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base%3BnLS%2FbYvrQkmiW1%2B5PgIj7w%3D%3D">Danilo Comminiello</a> and the signal processing group at Sapienza University of Rome for encouraging me to present a preceding lecture <span class="citation" data-cites="hawley_practical">[5]</span> at <a href="https://2025.ijcnn.org/program/tutorials#session-7-125">IJCNN 2025</a> – this blog post is the missing piece!</p>
<p>This document was partially prepared using the <a href="https://solve.it.com/">SolveIt</a> platform of Answer.ai and via many discussions with Claude.ai; still overwhelmingly authored by the hands of <em>this here human</em>.</p>
</section>
<section id="references" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-cfg" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">J. Ho, <span>“Classifier-free diffusion guidance,”</span> <em>ArXiv</em>, vol. abs/2207.12598, 2022, Available: <a href="https://arxiv.org/abs/2207.12598">https://arxiv.org/abs/2207.12598</a></div>
</div>
<div id="ref-lipman2023flow" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Y. Lipman, R. T. Q. Chen, H. Ben-Hamu, M. Nickel, and M. Le, <span>“Flow matching for generative modeling,”</span> in <em><span class="nocase">The Eleventh International Conference on Learning Representations (ICLR)</span></em>, 2023. Available: <a href="https://openreview.net/forum?id=PqvMRDCJT9t">https://openreview.net/forum?id=PqvMRDCJT9t</a></div>
</div>
<div id="ref-rectified_flow" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">X. Liu, C. Gong, and Q. Liu, <span>“Flow straight and fast: Learning to generate and transfer data with rectified flow,”</span> in <em>11th <span>I</span>nternational <span>C</span>onference on <span>L</span>earning <span>R</span>epresentations (ICLR)</em>, 2023. Available: <a href="https://openreview.net/forum?id=XVjTT1nw5z">https://openreview.net/forum?id=XVjTT1nw5z</a></div>
</div>
<div id="ref-hawley2025flowwithwhat" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">S. H. Hawley, <span>“Flow with what you know,”</span> in <em>The <span>F</span>ourth <span>B</span>logpost <span>T</span>rack at ICLR</em>, 2025. Available: <a href="https://iclr-blogposts.github.io/2025/blog/flow-with-what-you-know/">https://iclr-blogposts.github.io/2025/blog/flow-with-what-you-know/</a></div>
</div>
<div id="ref-hawley_practical" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">S. H. Hawley, <span>“Practical guide to developing flow-based generative models,”</span> in <em><span>I</span>nternational <span>J</span>oint <span>C</span>onference on <span>N</span>eural <span>N</span>etworks (<span>IJCNN</span>)</em>, 2025. Available: <a href="https://hedges.belmont.edu/IJCNN_Practical_Flow_Dev.pdf">https://hedges.belmont.edu/IJCNN_Practical_Flow_Dev.pdf</a></div>
</div>
<div id="ref-daras2024survey" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">G. Daras <em>et al.</em>, <span>“A survey on diffusion models for inverse problems.”</span> 2024. Available: <a href="https://arxiv.org/abs/2410.00083">https://arxiv.org/abs/2410.00083</a></div>
</div>
<div id="ref-ye2024tfg" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">H. Ye <em>et al.</em>, <span>“<span>TFG</span>: Unified training-free guidance for diffusion models,”</span> <em>Advances in Neural Information Processing Systems</em>, vol. 37, pp. 22370–22417, 2024, Available: <a href="https://arxiv.org/abs/2409.15761">https://arxiv.org/abs/2409.15761</a></div>
</div>
<div id="ref-dieleman2022guidance" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">S. Dieleman, <span>“Guidance: A cheat code for diffusion models.”</span> 2022. Available: <a href="https://benanne.github.io/2022/05/26/guidance.html">https://benanne.github.io/2022/05/26/guidance.html</a></div>
</div>
<div id="ref-zander_greedy" class="csl-entry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">Z. W. Blasingame and C. Liu, <span>“Greed is good: Guided generation from a greedy perspective,”</span> in <em>Frontiers in probabilistic inference: Learning meets sampling</em>, 2025. Available: <a href="https://openreview.net/forum?id=o4yQzZ5qCW">https://openreview.net/forum?id=o4yQzZ5qCW</a></div>
</div>
<div id="ref-dieleman2025latents" class="csl-entry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">S. Dieleman, <span>“Generative modelling in latent space.”</span> 2025. Available: <a href="https://sander.ai/2025/04/15/latents.html">https://sander.ai/2025/04/15/latents.html</a></div>
</div>
<div id="ref-tong2024improving" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">A. Tong <em>et al.</em>, <span>“Improving and generalizing flow-based generative models with minibatch optimal transport,”</span> <em>Transactions on Machine Learning Research</em>, 2024, Available: <a href="https://openreview.net/forum?id=CD9Snc73AW">https://openreview.net/forum?id=CD9Snc73AW</a></div>
</div>
<div id="ref-pokle2024trainingfree" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">A. Pokle, M. J. Muckley, R. T. Q. Chen, and B. Karrer, <span>“Training-free linear image inverses via flows,”</span> <em>Transactions on Machine Learning Research</em>, 2024, Available: <a href="https://openreview.net/forum?id=PLIt3a4yTm">https://openreview.net/forum?id=PLIt3a4yTm</a></div>
</div>
<div id="ref-pnp_flow" class="csl-entry">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">S. Martin, A. Gagneux, P. Hagemann, and G. Steidl, <span>“PnP-flow: Plug-and-play image restoration with flow matching.”</span> 2024. Available: <a href="https://arxiv.org/abs/2410.02423">https://arxiv.org/abs/2410.02423</a></div>
</div>
<div id="ref-sao_small" class="csl-entry">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">Z. Novack <em>et al.</em>, <span>“Fast text-to-audio generation with adversarial post-training,”</span> in <em>IEEE workshop on applications of signal processing to audio and acoustics (WASPAA)</em>, 2025.</div>
</div>
<div id="ref-ditto" class="csl-entry">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">Z. Novack, J. McAuley, T. Berg-Kirkpatrick, and N. J. Bryan, <span>“<span class="nocase">DITTO: Diffusion inference-time T-optimization for music generation</span>,”</span> in <em>ICML</em>, 2024.</div>
</div>
<div id="ref-zhao2025steeringautoregressive" class="csl-entry">
<div class="csl-left-margin">[16] </div><div class="csl-right-inline">D. Zhao, D. Beaglehole, T. Berg-Kirkpatrick, J. McAuley, and Z. Novack, <span>“Steering autoregressive music generation with recursive feature machines.”</span> 2025. Available: <a href="https://arxiv.org/abs/2510.19127">https://arxiv.org/abs/2510.19127</a></div>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>where “<img src="https://latex.codecogs.com/png.latex?*">” denotes the elementwise or Hadamard product↩︎</p></li>
<li id="fn2"><p>The paper by Pokle et al we cited earlier also included a related method, however the PnP-Flow method is a bit more general <em>and</em> the PnP-Flow paper is <em>muuuch</em> more readable than Pokle et al! (The <a href="https://openreview.net/forum?id=PLIt3a4yTm">reviewer comments</a> of the latter are extensive – glad it wasn’t just me who struggled!) ;-) Plus, Anne Gagneux provided <a href="https://github.com/annegnx/PnP-Flow">code</a> for PnP-Flow! Gagneux’s repo even provides code for the position-only (non-velocity) algorithm from Pokle et al aka “OT-ODE”.↩︎</p></li>
<li id="fn3"><p>Differences between our variables and those in the PnP-Flow paper: For us, <img src="https://latex.codecogs.com/png.latex?z"> are integrated flow latent variables between <img src="https://latex.codecogs.com/png.latex?z_0"> (source) and <img src="https://latex.codecogs.com/png.latex?z_1"> (target), whereas <img src="https://latex.codecogs.com/png.latex?x"> are the pixel-space representations via our VAE’s decoder <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%7BD%7D"> such that <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%7BD%7D(z)=x">. In PnP-Flow, <img src="https://latex.codecogs.com/png.latex?x"> is the integrated flow variable, <img src="https://latex.codecogs.com/png.latex?z"> is used only for their interpolation/overwrite step, and <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%7BD%7D"> is the “denoiser” aka their flow model.↩︎</p></li>
<li id="fn4"><p>In keeping with the “Zack Novack” theme: the trivial nature of integration for near-OT paths of flow models means that one can implement a flow version of DITTO <span class="citation" data-cites="ditto">[15]</span> that avoids the expensive back-integration needed for diffusion models. The result is also superficially similar to PnP-Flow, but with gradients computed with respect to <img src="https://latex.codecogs.com/png.latex?z"> instead of <img src="https://latex.codecogs.com/png.latex?%5Cwidehat%7Bz_1%7D">.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>generative</category>
  <category>flows</category>
  <category>guidance</category>
  <category>diffusion</category>
  <guid>https://drscotthawley.github.io/blog/posts/FlowWhereYouWant.html</guid>
  <pubDate>Thu, 27 Nov 2025 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/fwyw_kayak.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>Flow With What You Know</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/FlowModels.html</link>
  <description><![CDATA[ 




<style>
figcaption {
  margin: auto;
  text-align: center;
</style>
<section id="update-jan-22-2025-im-trilled-to-share-that-this-piece-has-been-accepted-for-iclr-2025s-blog-posts-track-citation-info-at-the-end." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="update-jan-22-2025-im-trilled-to-share-that-this-piece-has-been-accepted-for-iclr-2025s-blog-posts-track-citation-info-at-the-end."><em>Update Jan 22, 2025: I’m trilled to share that this piece has been accepted for <strong><a href="https://iclr-blogposts.github.io/2025/about/">ICLR 2025’s Blog Posts</a></strong> track! Citation info at the end.</em></h4>
</section>
<section id="update-mar-24-2025-this-was-selected-as-best-blog-post-of-iclr-2025" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="update-mar-24-2025-this-was-selected-as-best-blog-post-of-iclr-2025"><em>Update Mar 24, 2025: This was selected as “<strong>Best Blog Post</strong>” of ICLR 2025!</em></h4>
<div style="text-align: right;">
<p><a href="https://colab.research.google.com/github/drscotthawley/blog/blob/main/extra/FlowModels_colab.ipynb"> <img src="https://drscotthawley.github.io/blog/posts/https:/colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"> </a></p>
</div>
</section>
<section id="abstract" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="abstract">Abstract</h3>
<p>In this tutorial post, we provide an accessible introduction to flow-matching and rectified flow models, which are increasingly at the forefront of generative AI applications. Typical descriptions of them are usually laden with extensive probability-math equations, which can form barriers to the dissemination and understanding of these models. Fortunately, before they were couched in probabilities, the mechanisms underlying these models were grounded in basic physics, which provides an alternative and highly accessible (yet functionally equivalent) representation of the processes involved. Let’s flow.</p>
</section>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Flow-based generative AI models <span class="citation" data-cites="lipman2023flow">[1]</span>,<span class="citation" data-cites="rectified_flow">[2]</span> have been gaining significant traction as alternatives or improvements to traditional diffusion approaches in image and audio synthesis. These flow models excel at learning optimal trajectories for transforming probability distributions, offering a mathematically elegant framework for data generation. The approach has seen renewed momentum following <a href="https://blackforestlabs.ai/announcing-black-forest-labs/">Black Forest Labs</a>’ success with their FLUX models that grew out of the work on Stable Diffusion 3 <span class="citation" data-cites="sd3_paper">[3]</span>, spurring fresh interest in the theoretical foundations laid by earlier work on Rectified Flows <span class="citation" data-cites="rectified_flow">[2]</span> in ICLR 2023. Improvements such as <span class="citation" data-cites="improving_rf">[4]</span> have even reached the level of state-of-the-art generative models for one or two-step generation.</p>
<p>Intuitively, these models operate akin to the fluid processes that transform the shapes of clouds in the sky. While recent expositions <span class="citation" data-cites="mathieu2024flow jia_bin">[5], [6]</span> have attempted to make these concepts more accessible through probability theory, the underlying physical principles may offer a more direct path to understanding for many readers. By returning to the basic physical picture of flows that inspired these generative models, we can build both intuition and deep understanding - insights that may even guide the development of new approaches.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/mj-bw.gif" height="300" class="figure-img"></p>
<figcaption class="figure-caption">Source: Face-morphing example from Michael Jackson’s “Black Or White” (1991). <br>While technically not a flow-based generative model <span class="citation" data-cites="mj_siggraph">[7]</span>, it’s similar enough to use for an intro image. ;-)</figcaption>
</figure>
</div>
<section id="whats-a-flow" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="whats-a-flow"><span class="header-section-number">1.1</span> What’s a Flow?</h2>
<p>In the real world, things typically follow curved paths - like water flowing in a river, or crowds of people navigating around obstacles. Here’s a map of wind provided by the WW2010 atmospheric science project at UIUC: at every point in space, the wind has a velocity vector, and the air moves along “streamlines” or “trajectories” parallel to the velocity vectors…</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/3wndhght.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Wind flow map image from the <a href="http://ww2010.atmos.uiuc.edu/(Gh)/guides/maps/upa/wndvct.rxml">University of Illinois WW2010 Project</a></figcaption>
</figure>
</div>
<p>Notice that the streamlines never cross. If the streams were to cross… “it would be bad.” That would imply that the velocity at some point is undefined.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/gb-dont-cross-streams.gif" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Non-Crossing == Invertible">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-Crossing == Invertible
</div>
</div>
<div class="callout-body-container callout-body">
<p>This non-crossing property is what allows these flows to be invertible (i.e., reversible), a property you sometimes hear in isolation when reading more formal descriptions of flow models. (This is in contrast to diffusion models, whose random walks don’t allow for invertibility.)</p>
</div>
</div>
<p>So, at every point in space there’s a velocity vector telling the little bits of fluid where to go. And just like water or wind flows may depend not only on spatial position but also time, so too can our velocity vector field depend on position and time.</p>
<p>Flow matching learns these natural paths by focusing on the <em>velocity</em> at each point - essentially asking, “Which way should each data point be moving at this moment?”</p>
<div class="callout callout-style-default callout-note callout-titled" title="Terminology: &quot;FM/RF&quot;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology: “FM/RF”
</div>
</div>
<div class="callout-body-container callout-body">
<p>It may seem confusing to sometimes see “flow matching” and “rectified flows” being used interchangeably, but this is because they are <em>the same</em> <span class="citation" data-cites="tanishq_same">[8]</span>. In this blog post, we’ll use the collective term “FM/RF” models.<br>
Also note that there is no explicit “rectification” mechanism in rectified flows; rather any “rectification” is a description of the effect of flow-matching, i.e.&nbsp;transforming crossing trajectories to non-crossing ones. The addition of “Reflow” to the rectified flow paper <span class="citation" data-cites="rectified_flow">[2]</span> is a powerful extension we will cover further below.</p>
</div>
</div>
</section>
</section>
<section id="how-do-fmrf-models-work" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> How Do FM/RF Models Work?</h1>
<p>To gain a deep understanding of how models work, having an executable toy model is often a key instructional tool. This tutorial is written as an <a href="https://colab.research.google.com/github/drscotthawley/blog/blob/main/extra/FlowModels_colab.ipynb">executable Jupyter notebook</a>, though you can make sense of it without the code, so we will typically collapse or hide the code. But if you want to see it, you can expand the drop-down arrows.</p>
<p>For instance, the code starts with importing packages…</p>
<div class="cell">
<details>
<summary>Installs &amp; imports</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uncomment to install any missing packages:</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#%pip install torch numpy matplotlib tqdm </span></span>
<span id="cb1-3">    </span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline  </span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTML, display, clear_output</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tqdm.notebook <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm</span></code></pre></div>
</details>
</div>
<p><strong>Choose Your Own Data Shapes</strong></p>
<p>The <a href="https://colab.research.google.com/github/drscotthawley/blog/blob/main/extra/FlowModels_colab.ipynb">executable version of this lesson</a> lets you choose various shapes to “morph” between. For this reading, we’ll go from a Gaussian to a Spiral:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Options are: 'Gaussian', 'Square', 'Heart', 'Spiral', 'Two Gaussians', 'Smiley'</span></span>
<span id="cb2-2">source_data_choice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Gaussian'</span></span>
<span id="cb2-3">target_data_choice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spiral'</span>       </span></code></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Flow models don’t require gaussian prior distributions. You can choose whatever you want.</p>
</div>
</div>
<p>With the imports in place and the choice of starting and ending distributions made, we’re ready to define some utilities to generate and visualize our data. Let’s take a look:</p>
<div class="cell">
<details>
<summary>Utility code: styles, functions, generators, visualization</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for accessibility: Wong's color pallette: cf. https://davidmathlogic.com/colorblind</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#wong_black = [0/255, 0/255, 0/255]          # #000000</span></span>
<span id="cb3-3">wong_amber <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">230</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">159</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #E69F00</span></span>
<span id="cb3-4">wong_cyan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">86</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">233</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #56B4E9</span></span>
<span id="cb3-5">wong_green <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">158</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">115</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #009E73</span></span>
<span id="cb3-6">wong_yellow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">240</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">228</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">66</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #F0E442</span></span>
<span id="cb3-7">wong_navy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">114</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #0072B2</span></span>
<span id="cb3-8">wong_red <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">213</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">94</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #D55E00</span></span>
<span id="cb3-9">wong_pink <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">204</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">167</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>]     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #CC79A7</span></span>
<span id="cb3-10">wong_cmap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [wong_amber, wong_cyan, wong_green, wong_yellow, wong_navy, wong_red, wong_pink]</span>
<span id="cb3-11"></span>
<span id="cb3-12">source_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wong_navy</span>
<span id="cb3-13">target_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wong_red</span>
<span id="cb3-14">pred_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wong_green</span>
<span id="cb3-15">line_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wong_yellow</span>
<span id="cb3-16">bg_theme <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  'black', 'white', 'dark', 'light'</span></span>
<span id="cb3-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> bg_theme <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]:</span>
<span id="cb3-18">    plt.style.use(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark_background'</span>)</span>
<span id="cb3-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb3-20">    plt.rcdefaults()</span>
<span id="cb3-21">    </span>
<span id="cb3-22"></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A few different data distributions</span></span>
<span id="cb3-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_gaussian_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>):</span>
<span id="cb3-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create a 2D Gaussian distribution"""</span></span>
<span id="cb3-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.randn(n_points, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale</span>
<span id="cb3-27"></span>
<span id="cb3-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_square_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3 is set by the spread of the gaussian and spiral </span></span>
<span id="cb3-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create points uniformly distributed in a square"""</span></span>
<span id="cb3-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate uniform points in a square</span></span>
<span id="cb3-31">    points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (torch.rand(n_points, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale</span>
<span id="cb3-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> points</span>
<span id="cb3-33"> </span>
<span id="cb3-34"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_spiral_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb3-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create a spiral distribution. i like this one more"""</span></span>
<span id="cb3-36">    noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>scale </span>
<span id="cb3-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#theta = torch.linspace(0, 6*np.pi, n_points) # preferred order? no way</span></span>
<span id="cb3-38">    theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.rand(n_points)</span>
<span id="cb3-39">    r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale</span>
<span id="cb3-40">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.cos(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.randn(n_points)</span>
<span id="cb3-41">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.sin(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.randn(n_points)</span>
<span id="cb3-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.stack([x, y], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-43"></span>
<span id="cb3-44"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_heart_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>):</span>
<span id="cb3-45">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create a heart-shaped distribution of points"""</span></span>
<span id="cb3-46">    square_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_square_data(n_points, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>)</span>
<span id="cb3-47">    </span>
<span id="cb3-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the heart-shaped condition for each point</span></span>
<span id="cb3-49">    x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> square_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], square_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-50">    heart_condition <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> torch.sqrt(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-51">    </span>
<span id="cb3-52">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out points that don't satisfy the heart-shaped condition</span></span>
<span id="cb3-53">    heart_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> square_points[heart_condition]</span>
<span id="cb3-54">    </span>
<span id="cb3-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If we don't have enough points, generate more</span></span>
<span id="cb3-56">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(heart_points) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n_points:</span>
<span id="cb3-57">        new_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_square_data(n_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(heart_points), scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-58">        x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], new_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-59">        new_heart_condition <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> torch.sqrt(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-60">        new_heart_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_points[new_heart_condition]</span>
<span id="cb3-61">        heart_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([heart_points, new_heart_points], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-62"></span>
<span id="cb3-63">    heart_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> scale </span>
<span id="cb3-64">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> heart_points[:n_points]</span>
<span id="cb3-65"></span>
<span id="cb3-66"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_two_gaussians_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>):</span>
<span id="cb3-67">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create a 2D Gaussian distribution"""</span></span>
<span id="cb3-68">    g  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(n_points, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale</span>
<span id="cb3-69">    g[:n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> shift</span>
<span id="cb3-70">    g[n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> shift</span>
<span id="cb3-71">    indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randperm(n_points)</span>
<span id="cb3-72">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> g[indices]</span>
<span id="cb3-73"></span>
<span id="cb3-74"></span>
<span id="cb3-75"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_smiley_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>):</span>
<span id="cb3-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"make a smiley face"</span></span>
<span id="cb3-77">    points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb3-78">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Face circle -- Meh, IDK if the outer circle adds much TBH</span></span>
<span id="cb3-79">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#angles = 2 * np.pi * torch.rand(n_points//2+20)</span></span>
<span id="cb3-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#r = scale + (scale/10)*torch.sqrt(torch.rand(n_points//2+20)) </span></span>
<span id="cb3-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#points.append(torch.stack([r * torch.cos(angles), r * torch.sin(angles)], dim=1))</span></span>
<span id="cb3-82">    </span>
<span id="cb3-83">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eyes (small circles at fixed positions)</span></span>
<span id="cb3-84">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> eye_pos <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>]]:</span>
<span id="cb3-85">        eye <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> torch.tensor(eye_pos) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb3-86">        points.append(eye)</span>
<span id="cb3-87">        </span>
<span id="cb3-88">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Smile (arc in polar coordinates)</span></span>
<span id="cb3-89">    theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>torch.rand(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) </span>
<span id="cb3-90">    r_smile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.rand_like(theta)</span>
<span id="cb3-91">    points.append(torch.stack([r_smile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.cos(theta), r_smile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> torch.sin(theta)], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-92">    </span>
<span id="cb3-93">    points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat(points, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># concatenate first</span></span>
<span id="cb3-94">    points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> points[torch.randperm(points.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># then shuffle</span></span>
<span id="cb3-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> points[:n_points,:]</span>
<span id="cb3-96">    </span>
<span id="cb3-97"></span>
<span id="cb3-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize generator functions</span></span>
<span id="cb3-99">source_gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-100">target_gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-101"></span>
<span id="cb3-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign generator functions based on user choices</span></span>
<span id="cb3-103"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> gen_choice, gen_fn_name <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>([source_data_choice, target_data_choice], [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'source_gen_fn'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'target_gen_fn'</span>]):</span>
<span id="cb3-104">    gen_choice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_choice.lower()</span>
<span id="cb3-105">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'two gaussians'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> gen_choice:</span>
<span id="cb3-106">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_two_gaussians_data</span>
<span id="cb3-107">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'heart'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> gen_choice:</span>
<span id="cb3-108">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_heart_data</span>
<span id="cb3-109">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'spiral'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> gen_choice:</span>
<span id="cb3-110">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_spiral_data</span>
<span id="cb3-111">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'square'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> gen_choice:</span>
<span id="cb3-112">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_square_data</span>
<span id="cb3-113">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'smiley'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> gen_choice:</span>
<span id="cb3-114">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_smiley_data</span>
<span id="cb3-115">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb3-116">        gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_gaussian_data</span>
<span id="cb3-117">    </span>
<span id="cb3-118">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> gen_fn_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'source_gen_fn'</span>:</span>
<span id="cb3-119">        source_gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_fn</span>
<span id="cb3-120">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb3-121">        target_gen_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_fn</span>
<span id="cb3-122">        </span>
<span id="cb3-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A couple aliases so we can easily switch distributions without affecting later code </span></span>
<span id="cb3-124"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_source_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, hshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hshift can make it a bit easier to see trajectories later</span></span>
<span id="cb3-125">    g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source_gen_fn(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_points)</span>
<span id="cb3-126">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> hshift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: g[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> hshift</span>
<span id="cb3-127">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> g</span>
<span id="cb3-128">    </span>
<span id="cb3-129"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_target_data(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, hshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>):</span>
<span id="cb3-130">    g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target_gen_fn(n_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_points)</span>
<span id="cb3-131">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> hshift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: g[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> hshift</span>
<span id="cb3-132">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> g</span>
<span id="cb3-133"></span>
<span id="cb3-134"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_distributions(dist1, dist2, title1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution 1"</span>, title2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution 2"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>):</span>
<span id="cb3-135">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Plot two distributions side by side"""</span></span>
<span id="cb3-136">    plt.close(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'all'</span>)</span>
<span id="cb3-137">    fig, (ax1, ax2) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb3-138">    </span>
<span id="cb3-139">    ax1.scatter(dist1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dist1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>source_color)</span>
<span id="cb3-140">    ax2.scatter(dist2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dist2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>target_color)</span>
<span id="cb3-141">    </span>
<span id="cb3-142">    ax1.set_title(title1)</span>
<span id="cb3-143">    ax2.set_title(title2)</span>
<span id="cb3-144">    </span>
<span id="cb3-145">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set same scale for both plots</span></span>
<span id="cb3-146">    max_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(</span>
<span id="cb3-147">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(dist1).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item(),</span>
<span id="cb3-148">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(dist2).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item()</span>
<span id="cb3-149">    )</span>
<span id="cb3-150">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [ax1, ax2]:</span>
<span id="cb3-151">        ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range)</span>
<span id="cb3-152">        ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range)</span>
<span id="cb3-153">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb3-154">        </span>
<span id="cb3-155">    plt.tight_layout()</span>
<span id="cb3-156">    plt.show()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Explicitly show the plot</span></span>
<span id="cb3-157">    plt.close()</span>
<span id="cb3-158"></span>
<span id="cb3-159"></span>
<span id="cb3-160"></span>
<span id="cb3-161"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> interpolate_color(t, start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>):</span>
<span id="cb3-162">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Interpolate from start color to end color"""</span></span>
<span id="cb3-163">    start_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.cm.colors.to_rgb(start)</span>
<span id="cb3-164">    end_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.cm.colors.to_rgb(end)</span>
<span id="cb3-165">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.array(start_color) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.array(end_color)</span>
<span id="cb3-166"></span>
<span id="cb3-167"></span>
<span id="cb3-168"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show_flow_sequence(start_dist, end_dist, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, c_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>source_color, c_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>target_color):</span>
<span id="cb3-169">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Show the flow as a sequence of static plots"""</span></span>
<span id="cb3-170">    fig, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_steps, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_steps, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb3-171">    </span>
<span id="cb3-172">    max_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(</span>
<span id="cb3-173">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(start_dist).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item(),</span>
<span id="cb3-174">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(end_dist).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item()</span>
<span id="cb3-175">    )</span>
<span id="cb3-176">    </span>
<span id="cb3-177">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(axes):</span>
<span id="cb3-178">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (n_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-179">        current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> start_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> end_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t</span>
<span id="cb3-180">        </span>
<span id="cb3-181">        color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> interpolate_color(t, start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>c_start, end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>c_end)</span>
<span id="cb3-182">        ax.scatter(current[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], current[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb3-183">                  alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb3-184">                  c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[color])</span>
<span id="cb3-185">        </span>
<span id="cb3-186">        ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range)</span>
<span id="cb3-187">        ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range)</span>
<span id="cb3-188">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb3-189">        ax.set_title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f't = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-190">    </span>
<span id="cb3-191">    plt.tight_layout()</span>
<span id="cb3-192">    plt.show()</span>
<span id="cb3-193">    plt.close()</span>
<span id="cb3-194"></span>
<span id="cb3-195"></span>
<span id="cb3-196"></span>
<span id="cb3-197"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create our distributions and look at them</span></span>
<span id="cb3-198">n_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb3-199">source, target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_source_data(n_points), create_target_data(n_points)</span>
<span id="cb3-200"></span>
<span id="cb3-201">plot_distributions(source, target, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Starting Distribution"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Target Distribution"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The process of transition from the starting “source” to the final “target” might include snapshots like these:</p>
<div class="cell">
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>(Note the colors aren’t meaningful, they’re just added to make it easier to distinguish what we’re looking at. Our data are just points in 2-D space.)</p>
<!---Here's an animation with no colors, showing the points moving. ... --->
<p>So, how do we get the points from the source distribution to fit with the target distribution? The simplest way (though not the only way) is to assume points move in straight lines from source to target. Even though our network might learn more complex paths later, this gives us a starting point for training.</p>
<section id="the-starting-setup" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-starting-setup"><span class="header-section-number">2.1</span> The Starting Setup</h2>
<p>The training setup for flow matching models is as follows:</p>
<ol type="1">
<li>We start by <em>randomly pairing</em> points from the source &amp; the target – yes, really. 🤣</li>
<li>We move the points along straight trajectories, and the speed of each point is constant.</li>
</ol>
<div class="cell">
<details>
<summary>Code for 2D flow-matching diagram with crossing lines</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os </span>
<span id="cb4-2"></span>
<span id="cb4-3">source_L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source.clone()</span>
<span id="cb4-4">shift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-5">source_L[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> shift</span>
<span id="cb4-6">target_R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target.clone()</span>
<span id="cb4-7">target_R[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> shift  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: fixed the indexing here from [:0] to [:,0]</span></span>
<span id="cb4-8"></span>
<span id="cb4-9">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show the whole distribution</span></span>
<span id="cb4-11">ax.scatter(source_L[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], source_L[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>source_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-12">ax.scatter(target_R[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], target_R[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>target_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw lines connecting points, with source &amp; target points outlined</span></span>
<span id="cb4-15">n_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb4-16">ax.scatter(source_L[:n_lines,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], source_L[:n_lines,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>source_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb4-17">           facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color,)</span>
<span id="cb4-18">ax.scatter(target_R[:n_lines,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], target_R[:n_lines,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>target_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-19">           facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color,)</span>
<span id="cb4-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_lines):</span>
<span id="cb4-21">    ax.plot([source_L[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], target_R[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], </span>
<span id="cb4-22">        [source_L[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], target_R[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], </span>
<span id="cb4-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.9</span>], </span>
<span id="cb4-24">        linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or lw=2</span></span>
<span id="cb4-25"></span>
<span id="cb4-26">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb4-27">ax.set_xticks([])</span>
<span id="cb4-28">ax.set_yticks([])</span>
<span id="cb4-29">ax.spines[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb4-30">ax.spines[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb4-31">ax.spines[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb4-32">ax.spines[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb4-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> [x, label] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>shift,shift], [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Source'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Target'</span>]):</span>
<span id="cb4-34">    ax.text(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, label, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,  va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,)</span>
<span id="cb4-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plt.show()</span></span>
<span id="cb4-36">os.makedirs(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images'</span>, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>) </span>
<span id="cb4-37">save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images/gaussian_to_spiral_crossing_lines.png'</span></span>
<span id="cb4-38">plt.savefig(save_file)</span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plt.show()</span></span>
<span id="cb4-40">plt.close()</span>
<span id="cb4-41"></span>
<span id="cb4-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#HTML(f"""&lt;center&gt;&lt;img src="{save_file}" width="600"&gt;&lt;/center&gt;""") </span></span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/gaussian_to_spiral_crossing_lines.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Actually, that diagram may be a bit confusing because time &amp; space are mixed together. Let’s turn it into a 3D plot to more clearly separate the time from the spatial dimensions:</p>
<div class="cell">
<details>
<summary>Code for 3D plot of source &amp; target distributions connected by ‘lines’ in time</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.express <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> px</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb5-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb5-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotly.offline <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb5-8">init_notebook_mode(connected<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> rgb_to_plotly(rgb):</span>
<span id="cb5-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert [r, g, b] where r,g,b are 0-1 to 'rgb(r,g,b)' where r,g,b are 0-255</span></span>
<span id="cb5-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'rgb(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span></span>
<span id="cb5-13"></span>
<span id="cb5-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_3d_lines():</span>
<span id="cb5-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set theme based on bg_theme</span></span>
<span id="cb5-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> bg_theme <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]:</span>
<span id="cb5-17">        template <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plotly_dark"</span></span>
<span id="cb5-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb5-19">        template <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plotly_white"</span></span>
<span id="cb5-20">    </span>
<span id="cb5-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert source and target to DataFrames for Plotly Express</span></span>
<span id="cb5-22">    source_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb5-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>: source[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].numpy(),</span>
<span id="cb5-24">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: source[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].numpy(),</span>
<span id="cb5-25">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'z'</span>: np.zeros(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(source)),</span>
<span id="cb5-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distribution'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Source'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(source)</span>
<span id="cb5-27">    })</span>
<span id="cb5-28">    </span>
<span id="cb5-29">    target_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb5-30">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>: target[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].numpy(),</span>
<span id="cb5-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: target[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].numpy(),</span>
<span id="cb5-32">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'z'</span>: np.ones(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(target)),</span>
<span id="cb5-33">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distribution'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Target'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(target)</span>
<span id="cb5-34">    })</span>
<span id="cb5-35">    </span>
<span id="cb5-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine dataframes</span></span>
<span id="cb5-37">    points_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.concat([source_df, target_df], ignore_index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-38">    </span>
<span id="cb5-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create scatter plot for source and target points</span></span>
<span id="cb5-40">    fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> px.scatter_3d(</span>
<span id="cb5-41">        points_df,</span>
<span id="cb5-42">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>,</span>
<span id="cb5-43">        y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>,</span>
<span id="cb5-44">        z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'z'</span>,</span>
<span id="cb5-45">        color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distribution'</span>,</span>
<span id="cb5-46">        color_discrete_map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{</span>
<span id="cb5-47">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Source'</span>: rgb_to_plotly(source_color),</span>
<span id="cb5-48">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Target'</span>: rgb_to_plotly(target_color)</span>
<span id="cb5-49">        },</span>
<span id="cb5-50">        opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-51">        size_max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb5-52">    )</span>
<span id="cb5-53">    </span>
<span id="cb5-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create trajectory lines</span></span>
<span id="cb5-55">    points_per_traj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb5-56">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, points_per_traj)</span>
<span id="cb5-57">    </span>
<span id="cb5-58">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_lines):</span>
<span id="cb5-59">        source_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source[i,:]</span>
<span id="cb5-60">        target_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[i,:]</span>
<span id="cb5-61">        </span>
<span id="cb5-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manual linear interpolation</span></span>
<span id="cb5-63">        x_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ts) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ts</span>
<span id="cb5-64">        y_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ts) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ts</span>
<span id="cb5-65">        </span>
<span id="cb5-66">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add trajectory line</span></span>
<span id="cb5-67">        fig.add_trace(go.Scatter3d(</span>
<span id="cb5-68">            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x_vals.numpy(),</span>
<span id="cb5-69">            y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_vals.numpy(),</span>
<span id="cb5-70">            z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ts.numpy(),</span>
<span id="cb5-71">            mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lines'</span>,</span>
<span id="cb5-72">            line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rgb_to_plotly(line_color), width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb5-73">            opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb5-74">            showlegend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-75">        ))</span>
<span id="cb5-76">        </span>
<span id="cb5-77">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add highlighted source and target points</span></span>
<span id="cb5-78">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Source point highlight</span></span>
<span id="cb5-79">        fig.add_trace(go.Scatter3d(</span>
<span id="cb5-80">            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[source_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].item()],</span>
<span id="cb5-81">            y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[source_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].item()],</span>
<span id="cb5-82">            z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb5-83">            mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>,</span>
<span id="cb5-84">            marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb5-85">                color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rgb_to_plotly(line_color), </span>
<span id="cb5-86">                size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb5-87">                line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rgb_to_plotly(line_color), width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-88">            ),</span>
<span id="cb5-89">            showlegend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-90">        ))</span>
<span id="cb5-91">        </span>
<span id="cb5-92">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Target point highlight</span></span>
<span id="cb5-93">        fig.add_trace(go.Scatter3d(</span>
<span id="cb5-94">            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[target_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].item()],</span>
<span id="cb5-95">            y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[target_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].item()],</span>
<span id="cb5-96">            z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb5-97">            mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>,</span>
<span id="cb5-98">            marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb5-99">                color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rgb_to_plotly(line_color), </span>
<span id="cb5-100">                size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb5-101">                line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rgb_to_plotly(line_color), width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-102">            ),</span>
<span id="cb5-103">            showlegend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-104">        ))</span>
<span id="cb5-105">    </span>
<span id="cb5-106">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update layout</span></span>
<span id="cb5-107">    fig.update_layout(</span>
<span id="cb5-108">        scene<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb5-109">            xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>,</span>
<span id="cb5-110">            yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb5-111">            zaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time"</span>,</span>
<span id="cb5-112">            aspectmode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span>,</span>
<span id="cb5-113">            aspectratio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb5-114">            camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb5-115">                eye<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-116">            )</span>
<span id="cb5-117">        ),</span>
<span id="cb5-118">        template<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>template,</span>
<span id="cb5-119">        margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>),</span>
<span id="cb5-120">        legend_title_text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Distribution'</span></span>
<span id="cb5-121">    )</span>
<span id="cb5-122">    </span>
<span id="cb5-123">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> fig </span>
<span id="cb5-124"></span>
<span id="cb5-125">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plot_3d_lines()</span>
<span id="cb5-126">fig.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="8f48029a-7ec5-4017-a7e2-6a1346ed0c7d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8f48029a-7ec5-4017-a7e2-6a1346ed0c7d")) {                    Plotly.newPlot(                        "8f48029a-7ec5-4017-a7e2-6a1346ed0c7d",                        [{"hovertemplate":"distribution=Source\u003cbr\u003ex=%{x}\u003cbr\u003ey=%{y}\u003cbr\u003ez=%{z}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Source","marker":{"color":"rgb(0,114,178)","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"Source","scene":"scene","showlegend":true,"x":[0.0577133484184742,-0.4394192397594452,0.6270624399185181,-0.39554065465927124,0.6127780079841614,0.9925490021705627,1.016144037246704,-0.972781240940094,-0.5424747467041016,-0.20524655282497406,0.6354976892471313,2.152486562728882,1.0426770448684692,-0.40034565329551697,0.048506543040275574,0.5665698647499084,0.09752479940652847,0.5688274502754211,-0.12818047404289246,-1.0869460105895996,-0.17892715334892273,1.0296586751937866,-2.470364809036255,0.01431348267942667,-0.3707438111305237,0.048536043614149094,1.2074333429336548,-1.341979742050171,-0.002635048469528556,-1.1116398572921753,1.2636884450912476,-1.2625541687011719,-0.8711326122283936,0.5696580410003662,0.1039554700255394,-0.6280278563499451,-1.6772276163101196,-0.2927938401699066,0.09809520095586777,0.18701431155204773,1.1394984722137451,-0.05750150606036186,-1.0187500715255737,-1.1550737619400024,0.20355632901191711,-0.10954862087965012,-0.9071602821350098,0.5317493081092834,-0.4541993737220764,0.4966558516025543,-0.3113918602466583,1.9313009977340698,-0.9392696022987366,-0.4225490391254425,-0.16183394193649292,0.9669771194458008,-1.7777674198150635,-0.4290708303451538,1.6334307193756104,-0.29122376441955566,1.0589796304702759,0.42099714279174805,-0.10901044309139252,0.8585843443870544,1.315956711769104,-1.5474205017089844,0.49034884572029114,2.4906070232391357,1.1493961811065674,0.937363862991333,-0.942976176738739,-0.10357639193534851,-0.8659597635269165,1.0107696056365967,-1.1626983880996704,-1.1815561056137085,-1.9095395803451538,-1.4950482845306396,-1.2740005254745483,0.4420521855354309,-0.14090359210968018,0.5080375075340271,-0.6597528457641602,-0.16883228719234467,1.1695210933685303,0.5504458546638489,0.27035948634147644,0.35400593280792236,-1.1505348682403564,-0.1985587179660797,0.6144688725471497,0.2802727520465851,0.7741925120353699,-0.29797041416168213,-1.643066167831421,-0.9056059718132019,-0.9039249420166016,0.2704089879989624,-0.793447732925415,-1.3851910829544067,-0.12506961822509766,0.9747957587242126,0.561900794506073,0.6907729506492615,0.14776059985160828,-0.4993796944618225,0.1157107949256897,1.1216169595718384,0.05833778902888298,-2.0767364501953125,-2.0048813819885254,-1.7086658477783203,0.7121766805648804,0.6517053842544556,1.3274766206741333,1.2690179347991943,-0.23132620751857758,-0.5891776084899902,0.4974050223827362,-0.7002006769180298,0.9003419876098633,-0.17731676995754242,0.8449817895889282,-0.9662370085716248,0.1346970796585083,-0.16290265321731567,-0.002109942026436329,0.0007721121073700488,1.6317778825759888,0.9498541355133057,-0.9603562951087952,-0.32018306851387024,0.037923894822597504,0.39545440673828125,-0.9689462780952454,-0.7609198689460754,0.2593326270580292,-0.13232247531414032,0.29156559705734253,-1.002129077911377,-0.4380194842815399,-1.4145536422729492,-0.9503405094146729,-0.4219229221343994,0.311018705368042,-1.5978962182998657,0.8219603896141052,-0.8169133067131042,0.3219287395477295,-0.6135465502738953,-2.2379064559936523,0.565104067325592,1.3531898260116577,-0.5026549696922302,-0.30066177248954773,0.16122478246688843,1.1905803680419922,0.7346489429473877,0.6637865900993347,0.1421143263578415,0.9032649993896484,-2.2189741134643555,0.5111755132675171,0.47133877873420715,0.4389621317386627,-0.362751305103302,-0.7405939102172852,-0.24832358956336975,0.7632091641426086,1.6924400329589844,0.23057851195335388,0.6807013750076294,-0.5933387875556946,0.20003916323184967,0.8477242588996887,1.0632238388061523,0.7706214189529419,-0.3765092194080353,-0.11697178333997726,0.8422033786773682,0.3828199803829193,-0.7475402355194092,1.7287534475326538,-1.3832119703292847,-1.3096034526824951,-1.5805515050888062,0.795849621295929,-0.4295163154602051,0.6935994029045105,-1.4072275161743164,0.2593437731266022,0.9135485291481018,-1.6539069414138794,-0.46757972240448,-1.2151105403900146,0.0510619580745697,0.38023632764816284,0.061183199286460876,-1.2725423574447632,-1.0327547788619995,-1.1999666690826416,-0.22610971331596375,1.435201644897461,0.38370224833488464,0.027371281757950783,-2.245537519454956,-0.322945237159729,-1.0552090406417847,1.1570321321487427,0.24983692169189453,-0.43225201964378357,-0.39918380975723267,-0.1434066891670227,0.13134215772151947,0.9242595434188843,-0.4918082654476166,-1.4957060813903809,-1.38056480884552,-0.5627310276031494,-1.2528949975967407,-0.29748019576072693,-0.9081212282180786,0.1509057730436325,0.18319924175739288,0.31942880153656006,0.17362724244594574,-0.030890069901943207,-0.7951504588127136,1.5578570365905762,1.765551209449768,2.4909441471099854,-0.35676127672195435,-0.4328097403049469,0.22203543782234192,-0.5346354842185974,0.794700026512146,-1.0299688577651978,0.48161581158638,-1.678580403327942,0.24752137064933777,-0.39435839653015137,2.1495707035064697,-0.5291082859039307,1.9414488077163696,-0.35776659846305847,-0.633268415927887,-0.22735346853733063,0.6956638693809509,-0.026188194751739502,0.05901655927300453,3.0972237586975098,1.2614301443099976,-0.24277275800704956,0.7228706479072571,1.1355738639831543,1.1712939739227295,1.7645714282989502,0.9176055788993835,1.7998844385147095,-0.5013599395751953,0.16931693255901337,0.8129339814186096,0.44557875394821167,1.5843037366867065,-0.8554537892341614,-2.506497859954834,0.09906777739524841,1.7846394777297974,-0.3847563862800598,1.6084269285202026,0.3470020294189453,0.33234918117523193,-0.5308487415313721,-1.7560069561004639,0.35546231269836426,-1.3056021928787231,-0.7544496655464172,0.08331584185361862,-0.8739414215087891,-1.9436814785003662,0.07005501538515091,-0.8820160627365112,-0.6676753163337708,2.0319132804870605,0.28083837032318115,0.3479912281036377,-0.6066161394119263,-0.9337015151977539,-0.1598830223083496,-0.13926509022712708,0.3499322533607483,-0.12419646233320236,-0.17471519112586975,-2.6499056816101074,1.6735557317733765,0.8206474781036377,0.37735995650291443,0.8520005941390991,-0.5616033673286438,0.09583539515733719,-0.15947584807872772,-0.9860337376594543,1.1439038515090942,1.7836965322494507,1.9151380062103271,0.24204190075397491,-0.11468145251274109,-0.8841013312339783,1.4191339015960693,-0.06915782392024994,-1.4226000308990479,0.634006917476654,-0.37346121668815613,-0.12122266739606857,-1.2780184745788574,0.5372608304023743,0.7566431760787964,-1.354351282119751,1.78536057472229,-1.0838216543197632,-1.3891552686691284,-0.3314320743083954,-0.6491008996963501,-0.6507546305656433,1.9637749195098877,-1.3724727630615234,-0.8888059258460999,-0.664212167263031,0.33705323934555054,1.0638214349746704,1.4619921445846558,0.7322165369987488,-1.0015760660171509,0.5075605511665344,-0.45568984746932983,-0.11732024699449539,0.48788121342658997,-0.27626755833625793,0.7485553622245789,-1.0542466640472412,-1.2674002647399902,-1.0964900255203247,0.41389086842536926,1.2295671701431274,-0.49485254287719727,-2.1628384590148926,0.6774842739105225,0.8528937697410583,-1.4811874628067017,0.28447896242141724,0.5095140933990479,-0.6977308988571167,-0.30072176456451416,1.2660481929779053,0.6826445460319519,-0.14632199704647064,-1.2183454036712646,-0.2363848090171814,1.2833651304244995,0.04421202838420868,0.21150632202625275,0.8073039650917053,-0.11706473678350449,-1.8605260848999023,0.8604826927185059,-0.8114197850227356,-0.27901557087898254,0.6755531430244446,0.42650747299194336,-1.1505848169326782,0.4708232283592224,-0.9026405811309814,-0.9630907773971558,-0.7489901781082153,-0.03299373760819435,-0.1363227814435959,1.756600022315979,-0.2956075370311737,-0.4180781841278076,0.1042717769742012,-0.6221715211868286,-1.4422019720077515,0.20599576830863953,-0.8355833888053894,2.4472341537475586,0.9845752716064453,-1.739962100982666,-1.113468885421753,0.21272936463356018,0.07993203401565552,1.1869503259658813,0.5100061297416687,1.9716424942016602,-0.6497935056686401,-0.215802863240242,0.8218691945075989,1.027015209197998,0.45244818925857544,0.36135971546173096,-0.50492924451828,1.63922119140625,0.5752139687538147,1.181146264076233,-0.45045405626296997,-1.3279037475585938,-0.24022625386714935,-0.04883970692753792,-1.1185823678970337,-0.06715576350688934,0.9225360751152039,-0.5002506971359253,0.314893901348114,-1.3746604919433594,-1.0543419122695923,0.8467743992805481,-0.6788672804832458,0.05571833997964859,2.318208694458008,0.5582336783409119,2.5503618717193604,1.9893646240234375,0.06543948501348495,-0.6871715784072876,0.16329646110534668,0.34873008728027344,1.3128013610839844,-0.4278397858142853,1.2281968593597412,0.9011797904968262,0.20866501331329346,0.17886121571063995,-0.8215710520744324,0.564797580242157,1.795278549194336,0.5840047597885132,-0.825115978717804,0.7954806685447693,-0.024951886385679245,-0.15384794771671295,0.45017141103744507,0.4720003008842468,-0.49531447887420654,-1.45805025100708,1.3280138969421387,0.10835003852844238,0.22538155317306519,-0.2512225806713104,-0.34766918420791626,-1.8409743309020996,-0.7626797556877136,0.5654743909835815,1.5545005798339844,2.2045652866363525,0.854522168636322,-1.3874810934066772,-0.6888659000396729,0.147862508893013,-0.5428217649459839,1.3469090461730957,-1.576866626739502,-0.42288222908973694,2.3390777111053467,-0.2706151604652405,-0.42781051993370056,-0.14366713166236877,1.1849353313446045,2.3727166652679443,-0.5381197333335876,1.2684893608093262,-1.0170481204986572,0.35738545656204224,-0.5726451277732849,-0.541693925857544,0.28487303853034973,0.5673425197601318,-0.42217281460762024,0.7493019104003906,-1.3325575590133667,-1.4379929304122925,0.35062870383262634,0.4411569833755493,-2.485419273376465,0.9327083230018616,-0.33364465832710266,-0.10513443499803543,-0.6842570900917053,-0.3403453826904297,0.14106233417987823,-1.849846363067627,0.8511704206466675,-0.9483994841575623,1.5159612894058228,0.201047882437706,-1.5465549230575562,0.014158547855913639,-0.052958231419324875,0.03834350034594536,-1.7946147918701172,0.2400965541601181,1.8784854412078857,0.397579550743103,-0.4794750511646271,-1.2329210042953491,-1.5108882188796997,-0.16893096268177032,0.2266748696565628,-1.3122953176498413,1.821818470954895,0.15366990864276886,0.1366502195596695,1.625637173652649,-1.249537706375122,-0.4893190264701843,-0.44389188289642334,-0.01723329722881317,0.20425216853618622,-3.1615607738494873,1.6239162683486938,-1.0581732988357544,-1.4495612382888794,-0.6942225098609924,0.9036184549331665,0.5013524293899536,-0.5025022029876709,0.2647480070590973,0.21303224563598633,-0.7045468688011169,0.5673729181289673,-1.7882267236709595,-0.5171971321105957,-0.18668515980243683,0.26858019828796387,-2.384000539779663,1.6355884075164795,-1.0323476791381836,-0.9181897640228271,-0.11622906476259232,-0.581409752368927,0.6582474708557129,0.48652201890945435,0.9242093563079834,-0.4754965007305145,-1.3061621189117432,0.8539700508117676,0.0008798379567451775,-0.44812366366386414,0.7135407328605652,1.3815048933029175,-0.8421415686607361,-0.8884201645851135,-1.597130298614502,0.3401939868927002,1.215585470199585,0.4899022579193115,1.1305925846099854,0.5149314999580383,-0.7449644207954407,1.1699180603027344,0.2458360642194748,2.902317523956299,-0.7566255331039429,-0.5113473534584045,1.014689326286316,0.689210057258606,-1.6888625621795654,-0.2100592851638794,1.4163081645965576,1.4058281183242798,0.2486526370048523,1.9945064783096313,0.8369652628898621,-0.46709996461868286,0.8033798336982727,0.23941779136657715,-0.9236963391304016,-0.5713845491409302,-0.7313433289527893,-0.4182356297969818,0.5610600113868713,-0.6767496466636658,-0.6113350987434387,0.6245085597038269,-0.04092688113451004,-0.14419794082641602,-1.131056308746338,-0.03617718815803528,-0.8476106524467468,-1.6435035467147827,0.1660865694284439,-0.33911144733428955,0.6872545480728149,1.7237447500228882,0.06276889890432358,-1.180474042892456,-1.029008150100708,-0.2107837200164795,0.3633957505226135,-1.4564019441604614,-0.18850646913051605,0.11834441870450974,-0.9596900343894958,1.228634238243103,-1.1150952577590942,-0.10638628154993057,0.16256661713123322,1.7209011316299438,-0.24404039978981018,-0.5951389074325562,0.37390121817588806,-1.2191511392593384,-0.4289110004901886,-1.2334468364715576,-0.5530511140823364,0.44968941807746887,0.09285616874694824,-1.742808222770691,-0.4157332479953766,0.4506547749042511,-0.2961243987083435,-0.21225382387638092,1.1362686157226562,0.6219406127929688,-1.4485225677490234,-1.9578180313110352,-1.1499536037445068,0.26090359687805176,0.28926023840904236,-0.9634597301483154,1.1517035961151123,1.430751919746399,-1.1868963241577148,0.436784952878952,-1.1792091131210327,0.7716339230537415,0.18165920674800873,1.0454179048538208,-0.9717033505439758,1.3628956079483032,1.1043709516525269,1.2274121046066284,0.9398455023765564,-0.5468398332595825,0.7828554511070251,0.5917397141456604,-2.316397190093994,0.0026652656961232424,0.912083089351654,0.5903102159500122,1.309287190437317,-0.477609246969223,-0.9100362658500671,-0.8603857755661011,0.09006806463003159,0.9751297831535339,-0.8082531094551086,-1.3602406978607178,1.4114869832992554,0.4662110209465027,-0.5042088627815247,0.7535496354103088,-0.08153124898672104,0.7915513515472412,-0.9312659502029419,-1.1648379564285278,-1.2036768198013306,-1.0673011541366577,0.10631948709487915,-1.0728058815002441,1.120316982269287,0.30063706636428833,1.1418538093566895,0.5342525243759155,0.5403953790664673,2.5813562870025635,1.1146925687789917,-2.1061439514160156,0.305442750453949,0.2536655068397522,-0.08436695486307144,-1.2885805368423462,-1.13346529006958,-0.8958544731140137,0.1725068986415863,-0.2835758924484253,1.3305450677871704,0.3395576775074005,2.509908676147461,-1.0000405311584473,-0.3117215931415558,-1.9029743671417236,0.6865682601928711,-0.32845884561538696,1.0369200706481934,1.1254174709320068,1.0718351602554321,1.8081955909729004,0.03837808966636658,-0.6537508964538574,-0.6933403611183167,0.04814869537949562,-1.1483031511306763,-0.9591445326805115,0.7237877249717712,-0.164249449968338,-0.8442465662956238,0.3202805817127228,1.2710973024368286,0.562242329120636,1.7294789552688599,-0.44081977009773254,-1.2819117307662964,-0.6474978923797607,0.5698897838592529,0.08555001765489578,0.9060352444648743,-0.5464531183242798,-0.8164456486701965,-0.543567955493927,1.0071085691452026,-0.08696568757295609,0.34779003262519836,-0.3793710768222809,0.5012586116790771,0.08537599444389343,1.482497215270996,-0.8549114465713501,-0.005541070830076933,-1.39411461353302,0.48652786016464233,0.8630488514900208,-0.25622352957725525,-1.0168259143829346,0.21208555996418,0.2846440076828003,-0.1123521476984024,-0.46499913930892944,-0.6739160418510437,-2.188944101333618,-0.3666205406188965,0.12204276770353317,-0.24707631766796112,0.8309613466262817,0.5391704440116882,-0.7840607762336731,1.3253756761550903,-0.8267688155174255,-2.7986600399017334,0.6261110901832581,0.24159245193004608,-0.12229915708303452,2.512075424194336,-1.1461132764816284,-0.04794895648956299,0.28804081678390503,-0.610016942024231,1.9602382183074951,-0.3964654207229614,-0.2601644992828369,-0.9965453147888184,1.1254996061325073,-1.5655899047851562,1.3100029230117798,-0.12594299018383026,-1.0344295501708984,2.34053111076355,-0.9103532433509827,-1.093001365661621,1.2678874731063843,-0.10326072573661804,1.1228383779525757,0.025827370584011078,0.8150821328163147,0.21682202816009521,-3.1538784503936768,-0.2624431550502777,-0.04579223319888115,-1.6296981573104858,-0.3869674503803253,-0.07173144072294235,-0.430735319852829,-2.5705950260162354,-1.8033206462860107,-0.39485472440719604,-0.4996235966682434,-0.051161788403987885,-0.050689712166786194,-0.5540193319320679,-0.13610999286174774,0.5120574235916138,0.9710870385169983,0.9669435024261475,0.32041606307029724,1.3260366916656494,2.0325965881347656,-0.868536651134491,-1.1481178998947144,0.2284867763519287,-0.05513644590973854,0.7832801342010498,-0.4001096487045288,-1.5765323638916016,-1.8802841901779175,-0.7056211829185486,0.2769237160682678,0.6877973079681396,0.9630568027496338,-2.7596869468688965,-0.3612190783023834,2.592008113861084,-1.4160420894622803,-2.4369072914123535,-1.1406092643737793,-0.6337721347808838,2.243647813796997,0.8783193826675415,-0.24487844109535217,1.8060005903244019,0.14985202252864838,-0.3878898024559021,0.06162377819418907,0.5585294961929321,-0.20060057938098907,-1.6129792928695679,0.10656321793794632,-2.2817764282226562,-1.1058939695358276,-0.6178532242774963,0.20686152577400208,0.2721954882144928,-0.6496183276176453,-1.3033686876296997,0.5257776975631714,-0.41990262269973755,0.1327987164258957,0.9503220319747925,-1.5253684520721436,-0.6931438446044922,-0.29061251878738403,0.9099366664886475,-0.8021409511566162,-0.13124845921993256,-1.7661428451538086,0.625590980052948,0.2986847758293152,-0.49853160977363586,-0.03170803189277649,-0.032880958169698715,0.9292863607406616,1.3536262512207031,-1.1764801740646362,0.9057393074035645,-0.142449751496315,-0.8181511163711548,-0.9750688672065735,1.3397032022476196,-0.43658962845802307,0.802777886390686,0.19772782921791077,0.04231761395931244,-0.5019327998161316,-0.010603879578411579,0.06891857087612152,-1.9586910009384155,1.0569669008255005,2.076951265335083,0.989723265171051,-1.4472943544387817,0.5061509013175964,0.46242573857307434,1.4648207426071167,-0.20126712322235107,0.6720241904258728,-0.9468995332717896,-0.38347122073173523,-0.07995634526014328,0.5027543902397156,-2.0206098556518555,-1.112752079963684,-0.22541770339012146,-1.1378792524337769,0.06933813542127609,-0.6623704433441162,0.8463616967201233,0.641794741153717,1.1416939496994019,-0.12192434817552567,-1.9515960216522217,0.6712774634361267,-0.5456207394599915,-1.1883174180984497,0.22444112598896027,0.94339519739151,-0.38135796785354614,1.3578952550888062,-0.7486417889595032,1.107980728149414,0.834586501121521,-0.14407682418823242,-0.2756870687007904,1.5074670314788818,1.119205117225647,-0.574053943157196,0.5772682428359985,0.6864314079284668,-0.6683465838432312,1.674981713294983,1.6485399007797241,0.5251728892326355,-3.3124709129333496,1.3437117338180542,0.03202247619628906,0.42460599541664124,-0.32990914583206177,-0.19991816580295563,-0.19384242594242096,1.503381371498108,0.49426496028900146,1.1304569244384766,-0.6452115774154663,-1.0577287673950195,-0.4077686071395874,-0.35184651613235474,0.16697265207767487,0.5340467691421509,-1.014021396636963,1.0629491806030273,0.48575398325920105,-0.008113531395792961,-0.4008183777332306,0.6510839462280273,0.9286701083183289,0.1454344093799591,-0.04954594373703003,1.7518199682235718,-1.3926609754562378,1.5520099401474,-1.070892095565796,0.5466634035110474,-1.981238842010498,-1.0188757181167603,0.5430919528007507,-0.3779703378677368,-1.181227207183838,0.7849668264389038,-0.04865359142422676,-1.3588215112686157,0.010618867352604866,0.2034578025341034,0.12196451425552368,-0.48674944043159485,0.205782949924469,-0.15336482226848602,-0.40936708450317383,0.2915075719356537,0.8288401365280151,-0.032109130173921585,-0.2637603282928467,0.729180097579956,1.8051815032958984,0.7182309627532959,1.7043782472610474,-0.04989384487271309,0.6353307366371155,1.50297212600708,-0.1325615495443344,0.2460036724805832,0.8380444049835205,1.0152612924575806,-1.3400126695632935,-0.9040577411651611,-0.2937883734703064,0.37403833866119385,0.14710673689842224,1.035684585571289,-1.4432882070541382,0.7467394471168518,0.8464546203613281,1.6265746355056763,1.3180263042449951,-0.939477264881134,-0.21605908870697021,1.4633418321609497,0.09427942335605621,-0.5633180141448975,-0.7550598978996277,0.4694191515445709,-0.6737056970596313,1.0785231590270996,1.3489763736724854,-0.09514833241701126,0.10590095818042755,-2.060948610305786,1.4894001483917236,0.9913459420204163,0.14966407418251038,-1.3629908561706543,2.2641165256500244,0.6231821775436401,0.091224305331707,0.2302793562412262],"y":[1.3817541599273682,-0.06048274412751198,-0.25931912660598755,-0.6379141807556152,0.4451395273208618,-1.2472175359725952,-0.034546054899692535,0.6813279986381531,0.0066142999567091465,1.0058348178863525,-0.9606501460075378,0.8838965892791748,0.18115070462226868,-1.7931370735168457,0.2843315601348877,0.18411022424697876,1.211578607559204,-0.21068286895751953,-1.5786244869232178,-0.237795889377594,-2.1547915935516357,0.6765152812004089,0.16655340790748596,-0.2677080035209656,0.45481646060943604,-0.6964871883392334,0.934829831123352,2.237659454345703,0.18310438096523285,-1.015689730644226,-0.387837678194046,-1.3419439792633057,0.10905620455741882,-1.5223453044891357,-1.220949411392212,-0.46034789085388184,0.0635630190372467,0.6938378214836121,-1.777707576751709,0.08121605962514877,-0.21112632751464844,0.42912164330482483,0.3244865834712982,-0.04483187571167946,-0.7839659452438354,-0.838965654373169,0.4283296465873718,2.548248052597046,1.1018481254577637,2.344259738922119,1.2921593189239502,0.8854397535324097,0.23071444034576416,-0.6545702815055847,1.6168440580368042,0.6357821822166443,0.9122055172920227,0.8371541500091553,1.4460766315460205,0.8201666474342346,0.27536308765411377,1.8393393754959106,-0.21198752522468567,0.6171653270721436,0.41666150093078613,-0.5087305307388306,2.365734815597534,-0.8374345898628235,1.520195484161377,-1.5135935544967651,1.3221068382263184,0.22695264220237732,-1.4034528732299805,-0.5258989334106445,-1.2389110326766968,1.7916460037231445,0.6689034700393677,1.2424678802490234,-0.1931925266981125,0.9426607489585876,0.5643536448478699,-1.2620469331741333,-0.03308705985546112,-0.751228392124176,-0.36996230483055115,0.406362920999527,0.6886794567108154,0.701114296913147,0.14821527898311615,0.3994268774986267,1.020855188369751,0.6064258813858032,-1.0938313007354736,0.4915119707584381,-0.465208500623703,-0.44506868720054626,-1.433969497680664,-0.08786185830831528,0.5657047629356384,0.7320330142974854,-0.5891516208648682,-0.6228328347206116,-0.8193103075027466,-1.2182015180587769,1.3079017400741577,-0.04606816545128822,-0.16797229647636414,0.6355665326118469,0.1444000005722046,-0.0662064328789711,0.4275648891925812,-0.7851188778877258,-0.22578339278697968,1.2100945711135864,0.5615509748458862,1.3793271780014038,-1.527941107749939,0.0821790099143982,1.3230479955673218,1.041507363319397,1.9671645164489746,-1.9420262575149536,-1.0360163450241089,0.14568129181861877,-0.8833970427513123,-0.6503910422325134,-0.037290059030056,-0.4507538974285126,-0.7587400078773499,1.2838068008422852,0.7349660396575928,-1.1362899541854858,0.6356224417686462,-0.489274263381958,0.0059141479432582855,-0.43889960646629333,-1.463732361793518,1.2986829280853271,1.440407156944275,-0.4207049012184143,-1.5638350248336792,1.30161714553833,2.183820962905884,-1.086011528968811,1.0481730699539185,0.27783605456352234,0.2664695084095001,-0.07837686687707901,-0.1765693575143814,-0.17866583168506622,1.5796409845352173,-1.6140178442001343,-2.4093220233917236,-0.16357892751693726,-0.5831347703933716,-1.1765440702438354,0.4837600290775299,-1.2978261709213257,-0.8484118580818176,0.7977950572967529,-1.1797796487808228,-0.893849790096283,1.8748598098754883,1.5249321460723877,-0.2937334477901459,0.3491930663585663,1.972770094871521,1.000966191291809,-1.6005218029022217,0.13088499009609222,0.5057975649833679,-0.9299812912940979,-0.13585810363292694,-0.0038840058259665966,1.0293537378311157,-0.4490455389022827,0.005409894045442343,-1.9769091606140137,1.3825626373291016,-1.3964831829071045,0.1676637977361679,0.6488620042800903,-1.2958005666732788,0.29502803087234497,1.8306732177734375,-0.6151683926582336,-0.17450445890426636,-1.2367569208145142,2.267075538635254,0.22442789375782013,-1.7929679155349731,-0.611891508102417,-1.1794798374176025,-0.5293278694152832,-0.0698181614279747,-0.8955751657485962,0.3219538629055023,-0.5442231893539429,1.479596495628357,-0.2986573874950409,1.9259566068649292,1.2912935018539429,-0.04359889030456543,-0.9221481084823608,-1.0575841665267944,0.985291063785553,0.8288293480873108,0.6144081950187683,-0.6817734837532043,-1.190193772315979,-0.6053818464279175,1.9316725730895996,0.617077648639679,0.039441101253032684,0.22893193364143372,0.9047179818153381,0.0991925597190857,-1.220948576927185,-1.1627323627471924,-1.079868197441101,0.570975124835968,0.09909113496541977,-2.6061697006225586,-2.042189359664917,0.42948830127716064,1.6562150716781616,0.2711470127105713,0.4441000819206238,0.18349768221378326,-0.12422896176576614,2.0885677337646484,-0.018898284062743187,0.26368868350982666,0.6368442177772522,0.8427076935768127,-0.7524645924568176,1.0897313356399536,0.4232717752456665,0.405719131231308,-1.6927711963653564,0.30327606201171875,-0.8224626183509827,-1.4381612539291382,-2.067783832550049,1.0215506553649902,1.9014118909835815,-1.0090980529785156,0.9705113172531128,0.5204799175262451,2.231787919998169,0.774791419506073,-0.6606916189193726,0.2501428425312042,3.573528528213501,1.2707265615463257,1.1142135858535767,-0.6068835258483887,-1.6205121278762817,-0.1541067659854889,-0.4975883662700653,-2.034842014312744,0.45538216829299927,0.36454617977142334,-0.9353324174880981,0.7272417545318604,-1.134644865989685,1.2754555940628052,-1.2779896259307861,-1.1909716129302979,-0.5885018706321716,-1.708465576171875,-0.694840669631958,-0.40171170234680176,-1.2524316310882568,-1.1952223777770996,0.8215879201889038,0.8594529032707214,-1.4783265590667725,0.524083137512207,-0.5688927173614502,-0.9185233116149902,0.9340468645095825,-0.24647168815135956,-0.8385451436042786,1.7419683933258057,-0.8598365783691406,-1.3355215787887573,-0.7770817279815674,0.6747747659683228,0.6504784822463989,0.6040762066841125,0.14523018896579742,-0.023433256894350052,-0.26955074071884155,0.7932949066162109,0.13861612975597382,-1.041914939880371,-0.2947261929512024,0.4029385447502136,0.8996906280517578,-1.0232454538345337,0.27902087569236755,0.28091731667518616,-0.5422963500022888,0.8786892294883728,0.4882485568523407,0.411701500415802,0.8741638660430908,-0.08779500424861908,0.6925113201141357,1.0432288646697998,-1.9554163217544556,-1.0505605936050415,0.14828389883041382,-0.35117992758750916,-0.8815059661865234,0.03612510487437248,0.16401086747646332,1.4580693244934082,1.3336341381072998,-0.48008596897125244,-0.22117039561271667,-0.130618616938591,1.3436378240585327,-0.9181779026985168,1.7105709314346313,-0.5000879168510437,0.29144448041915894,-0.32630860805511475,0.1397547423839569,0.6359012126922607,-0.481771320104599,0.1336274892091751,0.40368518233299255,-0.4845598340034485,0.026122326031327248,0.012052533216774464,-1.1934888362884521,-0.20327042043209076,0.9706771969795227,-0.15719883143901825,-1.5733121633529663,1.6951502561569214,0.5826705098152161,-0.5231118202209473,-0.9557649493217468,1.1445280313491821,-1.1283321380615234,-0.6901640892028809,1.2882611751556396,0.25962281227111816,-1.4036426544189453,0.5783007740974426,0.8662372827529907,-1.3551268577575684,-1.2534854412078857,0.06550471484661102,-2.1203370094299316,0.8091608285903931,0.6223137974739075,0.6940302848815918,0.3475396931171417,-0.17166166007518768,-2.123264789581299,-0.3050323724746704,0.5994036793708801,-0.7332468628883362,1.0023616552352905,-1.0088117122650146,0.2636505365371704,-1.205103874206543,1.1242979764938354,-0.21142539381980896,0.8775908350944519,-0.25289008021354675,-0.22462494671344757,-0.6621274352073669,0.5162017941474915,0.1430099904537201,0.06503180414438248,0.9041893482208252,-0.6630685925483704,-0.5517259240150452,0.5165008306503296,-0.362280011177063,-0.7903794646263123,-0.537797212600708,-0.26608532667160034,-0.6616470813751221,-0.9766343235969543,-0.27416613698005676,1.548372507095337,-0.44383248686790466,1.1366832256317139,-0.3657520115375519,0.311263769865036,0.41975921392440796,0.3597497045993805,0.3905084729194641,0.07998386025428772,0.5243756175041199,-0.6667916774749756,0.37256255745887756,0.12325157970190048,-0.7669855356216431,-1.0510450601577759,-0.6322839260101318,0.5602971315383911,-0.43793967366218567,-1.3077900409698486,-0.35193052887916565,1.3835517168045044,-0.13964223861694336,-1.2464519739151,0.8930662870407104,-0.6251654028892517,0.5566945672035217,0.19569934904575348,-0.18800725042819977,0.2120809555053711,-1.5349396467208862,-0.7133722901344299,2.464059591293335,-0.5615140199661255,2.211174964904785,0.7595018148422241,0.9880367517471313,0.7718623280525208,-0.7580191493034363,-0.6586782932281494,-1.5975569486618042,-1.6035369634628296,0.8526524305343628,1.0646986961364746,-0.5693551898002625,0.41788506507873535,-0.4955041706562042,-1.8833781480789185,-1.5278363227844238,1.4860389232635498,0.09197717159986496,-1.3777961730957031,0.3097659945487976,0.8244153261184692,0.05958227068185806,-0.11041615158319473,-0.7653236389160156,-0.7628469467163086,0.20563223958015442,-0.5802913308143616,-0.166946679353714,1.9463601112365723,-0.7000377774238586,-1.055454969406128,-0.13132333755493164,-0.9417359232902527,-0.7753951549530029,-1.1821361780166626,0.055934738367795944,0.06357734650373459,0.8394591808319092,0.6819280982017517,0.03285432606935501,2.1421902179718018,0.5477743744850159,0.632135272026062,-0.18107719719409943,1.2591931819915771,-0.7490665316581726,0.5964046716690063,-0.18280956149101257,-0.4697909951210022,-0.8745036721229553,0.6061215996742249,-1.5420299768447876,-0.22889074683189392,-0.527807354927063,-0.3116045296192169,-0.6810779571533203,0.23439770936965942,-1.8311827182769775,-0.12140275537967682,-1.4743226766586304,-0.11854629963636398,-0.6244230270385742,-0.45797836780548096,2.215695858001709,-1.4747217893600464,-0.16317512094974518,0.44875574111938477,1.4121184349060059,-1.303842306137085,-0.22419527173042297,-1.5077015161514282,-0.8904706835746765,0.34937530755996704,2.0615336894989014,0.8062279224395752,-1.4677460193634033,0.8231180906295776,-0.4816562235355377,-0.09462030977010727,0.5292273163795471,0.18144358694553375,-0.34511393308639526,1.0195647478103638,0.7967413067817688,0.2175615429878235,1.265563726425171,1.1162554025650024,0.8034419417381287,0.9144891500473022,-0.5125278830528259,-1.3689686059951782,-0.8155261874198914,0.9575939178466797,0.8965113759040833,1.3005112409591675,-0.5656406283378601,-1.5630954504013062,0.5096460580825806,-1.2811486721038818,-0.02266225405037403,-0.8997489809989929,-0.33184170722961426,0.17335672676563263,-0.24582184851169586,-0.3662755489349365,0.13635922968387604,-1.2782052755355835,1.662458896636963,0.43378520011901855,-2.1698596477508545,1.3901338577270508,-0.35938048362731934,0.2031479775905609,-0.4726690948009491,0.33501628041267395,-1.558603286743164,0.3386390507221222,0.14809270203113556,-0.3092350661754608,-0.6818200945854187,0.8093611001968384,0.771484911441803,-0.15793614089488983,0.5453912615776062,0.4970790147781372,0.5982298851013184,-0.6783618330955505,-1.7939445972442627,-0.36601245403289795,-0.9794899821281433,-1.4024404287338257,-0.3439558744430542,0.864138126373291,0.26908475160598755,-0.009684906341135502,1.5778350830078125,0.023448558524250984,0.3333011269569397,-2.030256509780884,-0.21279574930667877,0.20642976462841034,1.3939268589019775,0.14834041893482208,0.13473480939865112,-1.042467474937439,-0.33986955881118774,0.1869935244321823,0.5558291673660278,-0.48851698637008667,-1.2171224355697632,0.3675349950790405,0.6092401742935181,2.031770706176758,0.9707925319671631,-0.8113060593605042,0.17829269170761108,-1.3714244365692139,-1.844806432723999,1.4303761720657349,-0.21473929286003113,0.38650116324424744,1.868904709815979,1.6970576047897339,-0.4075063169002533,-0.9360116720199585,-0.6994307637214661,0.8461276888847351,-0.4741167724132538,-1.0415507555007935,-1.7269701957702637,0.7909528017044067,-0.11126291006803513,0.1125027984380722,1.4704445600509644,-0.7215023040771484,-0.09566985815763474,-1.596283197402954,0.11639026552438736,-1.436697244644165,0.3276047706604004,1.8003854751586914,-1.210714340209961,1.0268770456314087,-0.1943066567182541,-1.636988878250122,0.07073045521974564,1.1146926879882812,-0.588812530040741,-0.6709330677986145,1.1441044807434082,-0.7643972039222717,0.29045116901397705,0.5085468292236328,-0.7520846724510193,0.12492554634809494,-1.6369807720184326,0.46513718366622925,-0.5556268692016602,1.696569800376892,0.2664324939250946,-0.8937248587608337,-0.691547691822052,-0.45315176248550415,-0.40767228603363037,-0.32433217763900757,0.2086019217967987,0.9196426272392273,-1.4215364456176758,-0.9395154118537903,1.2851178646087646,0.4622112512588501,-1.309516429901123,-0.8744221329689026,-0.8787192106246948,0.47261807322502136,-0.4076288938522339,1.0791054964065552,-0.7208074331283569,0.5671685934066772,0.49695441126823425,-1.797569990158081,0.5906295776367188,-1.8047584295272827,-0.8669630885124207,-1.5320000648498535,0.8516149520874023,0.42053017020225525,-0.09141258150339127,-1.0087465047836304,1.5324335098266602,0.41177377104759216,0.05985872820019722,-0.6380733251571655,0.021517962217330933,0.07545767724514008,0.6848489046096802,-0.7716400623321533,1.175674557685852,0.16227030754089355,-0.12097202986478806,-0.2869721055030823,-0.14481647312641144,0.7173633575439453,0.9645601511001587,0.6063143610954285,0.14027078449726105,0.11149260401725769,0.17227201163768768,-0.005563455633819103,0.19542548060417175,-1.1571240425109863,-0.17908480763435364,0.6703577637672424,-0.4751640856266022,0.9415570497512817,0.31717973947525024,-1.124966025352478,0.4072883427143097,0.022449582815170288,-0.9382705092430115,-0.3210696578025818,0.27611517906188965,0.795809805393219,-0.5659841895103455,-1.4451487064361572,-0.6704270839691162,-0.3363308906555176,-0.24505487084388733,-1.568866491317749,0.17930662631988525,-0.795642077922821,0.6029762029647827,-0.5031673908233643,-0.2512175440788269,-1.0655871629714966,-0.7406376004219055,-0.026262817904353142,-0.18673549592494965,-0.7927876114845276,0.5741645097732544,-0.2508719563484192,-1.6364045143127441,0.8184697031974792,0.12237925827503204,0.2480294108390808,-0.7993141412734985,1.5886118412017822,-0.7044653296470642,-0.5972799062728882,2.010443687438965,1.4501514434814453,1.7765638828277588,0.21555595099925995,0.9028770327568054,-0.8785366415977478,-1.7430729866027832,-0.2920621335506439,0.5237665176391602,0.3924506604671478,0.7842452526092529,-0.31586650013923645,-1.2554373741149902,-0.06295590847730637,2.003046751022339,-1.7386938333511353,0.9779382944107056,-0.42928558588027954,1.0933754444122314,2.4200456142425537,1.0923469066619873,0.6236995458602905,-1.3265020847320557,0.08973272889852524,-1.3850219249725342,1.7426743507385254,-0.5416969656944275,-1.7778738737106323,-0.22195641696453094,1.381365180015564,0.3772014081478119,0.14093460142612457,1.5041083097457886,-1.2235288619995117,-0.4154486656188965,0.4986370801925659,-1.4509233236312866,0.8557390570640564,-0.6624080538749695,1.0793966054916382,-0.4298321604728699,-0.23000049591064453,-0.4479743242263794,-1.1774239540100098,0.7157060503959656,0.22920653223991394,0.0731784999370575,0.9276754856109619,-0.17938943207263947,-0.050375375896692276,1.9937703609466553,0.3944387435913086,0.7131796479225159,-1.3409595489501953,0.048602133989334106,-0.2343483865261078,-1.7696117162704468,-1.1281119585037231,0.7154346704483032,0.14555317163467407,1.2400388717651367,-1.061661720275879,-0.3540703058242798,-1.2466825246810913,-0.46045181155204773,-1.872248888015747,-1.1570777893066406,-0.2979627251625061,-0.33545035123825073,0.6343512535095215,-0.3986513018608093,0.7638266086578369,-0.6418182253837585,-1.3779817819595337,-1.6836920976638794,1.2209941148757935,-1.5354409217834473,2.3152356147766113,-0.532312273979187,0.09416110813617706,0.23770472407341003,-0.6884058713912964,1.275566816329956,0.11072880029678345,0.17113430798053741,-0.09858587384223938,0.17686285078525543,-0.5905905961990356,-0.3230079114437103,1.3251491785049438,1.5943907499313354,0.5786315202713013,0.7115240693092346,1.296621561050415,0.8875318169593811,0.17004990577697754,-0.08342210948467255,0.026756759732961655,-0.1632716804742813,0.4209910035133362,-0.6944385766983032,0.5924248695373535,0.20833337306976318,-0.2151186615228653,0.31168678402900696,1.0039118528366089,0.5306075811386108,-0.6839437484741211,0.2510855197906494,0.14636926352977753,0.47909316420555115,-0.1673232764005661,-1.0240858793258667,0.7615096569061279,0.2382216453552246,-1.768748164176941,-1.0289374589920044,0.33713406324386597,0.20214860141277313,-0.23409976065158844,1.513882040977478,-0.48744431138038635,-0.6325681805610657,-1.2571821212768555,0.9157639741897583,0.7197352051734924,-0.4254070818424225,0.693564236164093,0.3180942237377167,0.11711835116147995,0.05044127255678177,1.0687942504882812,-1.0674304962158203,0.4300932288169861,2.0497477054595947,0.15365944802761078,0.5752019286155701,0.23489587008953094,0.6386800408363342,1.6140198707580566,0.9244977235794067,-0.5188841223716736,-1.8211348056793213,-0.02447565831243992,0.3601987659931183,0.014648471027612686,-0.41160687804222107,-1.0185939073562622,-1.5205004215240479,-0.38773927092552185,0.7633658051490784,-0.20698581635951996,-0.2935832142829895,0.2456420660018921,1.5422208309173584,1.4973894357681274,0.11339318752288818,-0.4839114844799042,-0.7510221600532532,-0.11454983800649643,1.2483906745910645,0.8474575281143188,-0.6185668110847473,-0.30360040068626404,0.3491629660129547,-0.9044002890586853,0.3809184432029724,0.5574154853820801,0.9604948163032532,1.8440780639648438,0.23342739045619965,0.1515698879957199,0.053535886108875275,-0.22403183579444885,-0.04448733478784561,-1.6361018419265747,2.20686411857605,0.7015618085861206,-0.5026695728302002,-1.2469784021377563,-0.6484240889549255,-1.9319558143615723,0.10645980387926102,0.7337033748626709,1.1903718709945679,-1.419320821762085,-0.5982570648193359,-1.2525966167449951,0.3315613567829132,0.3001176118850708,1.463780403137207,-0.5173739790916443,1.0632438659667969,0.93776535987854,0.2424549162387848,-0.9509195685386658,0.41241583228111267,-0.7369645833969116,1.3383874893188477,0.06617604196071625,0.6791524291038513,-0.6881633400917053,0.7582622766494751,-0.7564893960952759,1.226672649383545,-0.3320017158985138,-2.185584783554077,-0.4475760757923126,-0.6805410981178284,-0.9987898468971252,-0.12274279445409775,1.3180705308914185,-1.3984938859939575,-0.6579681634902954,1.159117579460144,-1.0140585899353027,1.8883686065673828,0.9109665751457214,-1.2644782066345215,-0.431782990694046,-1.2870508432388306,0.37692946195602417,-0.81472247838974,1.0991623401641846,-0.034242622554302216,0.5094813704490662,-0.959406852722168,0.932287335395813,-0.860126256942749,1.027028203010559,-0.5457189083099365,1.2772626876831055,-1.488947868347168,-1.9700994491577148,-0.3743674159049988,-0.9861887097358704,-0.7955275177955627,-0.5326131582260132,1.2200089693069458,-0.019446562975645065,0.791301429271698,-0.3355630934238434,-0.5523922443389893,0.39071545004844666,-1.4749739170074463,0.8966578245162964,-2.27585506439209,-0.6433234810829163,1.649081826210022,-0.05850435048341751,-0.24419884383678436,0.8697981238365173,-0.758193850517273,0.24437731504440308,2.0907645225524902,-1.1232715845108032,-0.9760673642158508,0.4628285765647888,0.7010985612869263,1.0358450412750244,0.22267696261405945,0.5177647471427917,0.248504638671875,-1.0886476039886475,0.9112378358840942,2.2315468788146973,-1.0083372592926025,1.195393681526184,-0.3819039463996887,0.8087679743766785,0.11268041282892227,-0.42406538128852844,-1.2445402145385742,0.9585925936698914,1.6832300424575806,1.1265045404434204,1.1403701305389404,0.10678383708000183,-0.29384905099868774,0.030227217823266983,-1.9896451234817505,1.2842012643814087,-1.3817435503005981,1.0804694890975952,0.41047412157058716,0.5086087584495544,1.3820340633392334,-0.9261199235916138],"z":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"type":"scatter3d"},{"hovertemplate":"distribution=Target\u003cbr\u003ex=%{x}\u003cbr\u003ey=%{y}\u003cbr\u003ez=%{z}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Target","marker":{"color":"rgb(213,94,0)","opacity":0.5,"symbol":"circle"},"mode":"markers","name":"Target","scene":"scene","showlegend":true,"x":[1.9229854345321655,2.573446035385132,-0.6984995603561401,-2.2849626541137695,0.4302046298980713,1.9292025566101074,-0.49411287903785706,0.10401111841201782,0.458461195230484,0.09029687941074371,0.7642569541931152,0.4565570056438446,-1.277702808380127,-0.04024733603000641,-0.3953099548816681,-0.975579023361206,0.9453121423721313,-1.8522199392318726,1.5885837078094482,1.9124176502227783,-1.4464218616485596,-2.5900423526763916,-1.5501198768615723,-2.4922051429748535,-0.4477660059928894,-1.1256557703018188,1.8992290496826172,-0.30426251888275146,0.3913862705230713,-2.103416919708252,-2.1963186264038086,0.8877146244049072,-0.4162444770336151,-1.3719443082809448,1.9656916856765747,0.23509635031223297,-0.1791435182094574,-2.2175490856170654,-1.0969910621643066,-1.1008310317993164,-0.8513429164886475,-0.8821616172790527,0.7660462260246277,0.6289433240890503,1.5231274366378784,-0.32443368434906006,-2.3586299419403076,-1.147444248199463,0.34997522830963135,-1.3914588689804077,1.6877845525741577,1.4607070684432983,0.7108334898948669,-2.460744857788086,0.08863680809736252,-1.37484872341156,2.882300853729248,0.5563735961914062,0.9838243722915649,-0.1434866189956665,0.09483133256435394,-0.25865742564201355,2.0199925899505615,-0.16358767449855804,-1.247344732284546,0.8510866761207581,1.0391172170639038,-0.03045385703444481,-2.634824275970459,0.09678885340690613,2.609917640686035,0.06679502129554749,-0.9336698651313782,-0.09306218475103378,-0.6229138970375061,-0.7438948750495911,-0.0016571581363677979,2.476715326309204,0.6634063124656677,-1.2961797714233398,1.559196949005127,0.1782377064228058,-2.3967771530151367,-1.0276055335998535,0.6392912268638611,-0.044798921793699265,0.6710494756698608,-1.3904927968978882,-0.40239009261131287,-1.6206603050231934,0.5233621001243591,0.6459152698516846,1.02872896194458,0.03760446980595589,0.7152597308158875,3.042846918106079,-0.07340387254953384,-0.2849998474121094,-1.7904300689697266,-1.6650002002716064,0.8687677979469299,0.6830534934997559,-0.4661789536476135,-2.0801749229431152,1.9926363229751587,0.041974492371082306,0.5185163021087646,0.6399137377738953,-0.6574739217758179,1.2200580835342407,2.436471462249756,0.5882299542427063,-0.6970871686935425,0.22803685069084167,-1.5019240379333496,1.3889615535736084,-0.07644952088594437,0.8345183730125427,-0.3175453841686249,0.011025495827198029,1.002784252166748,1.0806409120559692,2.1085193157196045,-2.294607639312744,-0.34163182973861694,0.08275309205055237,2.7435426712036133,-0.2840968370437622,-1.5834951400756836,-0.5932179093360901,0.47012844681739807,0.04059815779328346,2.305903673171997,1.8100398778915405,-1.4324709177017212,-0.6984542012214661,0.3578595817089081,1.891753077507019,1.51887047290802,-0.28205955028533936,0.9606375098228455,-0.4621680974960327,-0.3570088744163513,0.4645436108112335,-2.4793689250946045,1.0228544473648071,-0.11182136833667755,-1.8951612710952759,-0.3392704725265503,-1.4248868227005005,-2.3081247806549072,-0.6983510255813599,-0.22095438838005066,0.7606803774833679,-0.1217789575457573,-0.7500946521759033,2.028085708618164,-0.26041245460510254,-1.240087628364563,-1.0636622905731201,-0.8569207787513733,-0.1546444296836853,-2.5457990169525146,-1.4276071786880493,0.8937469720840454,-2.545008659362793,0.8515479564666748,-1.1456185579299927,-0.06424866616725922,0.011282511055469513,-1.3966277837753296,0.1018570065498352,0.515338659286499,1.4280447959899902,-2.315674066543579,2.906775712966919,0.3008206784725189,-0.11760235577821732,-1.6541824340820312,-0.4964929521083832,0.2811914086341858,0.7254295945167542,0.5153645873069763,0.8391811847686768,0.7859362959861755,-1.2703144550323486,0.6636958718299866,1.201471209526062,1.3538845777511597,-1.8542776107788086,1.651174545288086,-0.37994733452796936,0.9267306923866272,0.9730217456817627,0.06009160354733467,-0.40428197383880615,-1.0749807357788086,1.3987270593643188,0.8066987991333008,0.4543916881084442,0.20161202549934387,1.5916472673416138,0.03261725604534149,0.07129304111003876,-2.5486819744110107,0.532637357711792,1.7102501392364502,-1.2670799493789673,0.8058851957321167,0.19609564542770386,1.3125003576278687,-2.518667459487915,2.0277950763702393,0.7976372838020325,-0.5786411762237549,2.613243579864502,2.5368878841400146,0.543684720993042,-0.7383454442024231,-0.3867741525173187,-0.7491058707237244,-0.34441766142845154,0.6178174018859863,1.0195890665054321,-0.034862320870161057,-1.0422812700271606,1.6078059673309326,1.4827349185943604,0.9358838796615601,0.16682329773902893,0.8262346982955933,1.3594926595687866,0.05986378341913223,1.0129811763763428,0.594352126121521,-2.3676204681396484,2.0301921367645264,-1.3606170415878296,-1.751028299331665,1.4707887172698975,-2.0379371643066406,1.4429467916488647,-0.02805013582110405,-1.376527190208435,-2.2279300689697266,-0.16519184410572052,0.0043864622712135315,1.6931730508804321,-0.9581071138381958,-0.180938258767128,-0.4450206458568573,-0.016702400520443916,-0.033788323402404785,-1.5093508958816528,-0.43837064504623413,0.41398462653160095,-1.5947717428207397,0.7815124988555908,0.9008955955505371,0.0010245740413665771,-0.70730060338974,-1.5332638025283813,-0.37498024106025696,-0.8366122841835022,0.8019139170646667,-0.3329154849052429,0.9953821897506714,2.7327396869659424,0.43774113059043884,0.03458398953080177,-2.017839193344116,-1.4572322368621826,0.9262719750404358,1.6289716958999634,0.0062797293066978455,-2.0268383026123047,-0.3731551468372345,2.1777963638305664,-0.31708428263664246,0.17901533842086792,-1.8039859533309937,1.0740609169006348,-0.07366330921649933,1.0411241054534912,1.1777423620224,-0.25960075855255127,-0.01964975893497467,2.992335319519043,-0.18615570664405823,-0.19273287057876587,1.8681652545928955,1.5546118021011353,0.6487962603569031,1.7100623846054077,-0.08356557786464691,-0.2988165616989136,1.6052006483078003,-0.5583410859107971,1.9370965957641602,0.5452669262886047,-1.528266191482544,-0.04764062911272049,0.2352602779865265,0.7585789561271667,-0.5945491194725037,0.8893911838531494,1.6293818950653076,-1.5191740989685059,2.1477646827697754,-0.5491939783096313,0.13492554426193237,-0.4650675356388092,1.054669737815857,-2.4952354431152344,-0.2076110541820526,0.8655328154563904,0.021106287837028503,2.72373104095459,0.0987248420715332,-0.5124622583389282,-1.3958841562271118,-2.6192516088485718e-05,-1.6828434467315674,2.1639342308044434,-1.600014328956604,0.04814554378390312,-0.014763303101062775,-0.4205905795097351,1.6520118713378906,0.016525857150554657,-0.05540596321225166,-0.494191437959671,-1.6641837358474731,0.7288548350334167,2.245393991470337,0.5406506657600403,-0.5557877421379089,-0.20249925553798676,-2.001899242401123,0.008025333285331726,0.9833487272262573,1.3333131074905396,-0.46449682116508484,2.278602123260498,-0.6384685635566711,-0.49005499482154846,1.6578128337860107,-1.444974422454834,-0.33939510583877563,0.8424768447875977,-1.579770565032959,0.14219269156455994,-1.6525572538375854,-0.30976641178131104,-2.402345657348633,-1.0382342338562012,-0.3867424726486206,-1.3670194149017334,0.001842789351940155,0.20170632004737854,0.200913667678833,-1.5233112573623657,-0.4751557409763336,-0.870940625667572,1.1142672300338745,-2.385690450668335,-1.5995250940322876,-0.5095648169517517,-0.4220268130302429,-0.28470978140830994,0.1608593761920929,-0.37347841262817383,0.6551980972290039,-0.060084760189056396,0.5465517640113831,2.7659075260162354,-2.1778652667999268,0.6110885143280029,-1.4833483695983887,-0.9757587313652039,-0.14476743340492249,0.005333632230758667,-0.520006537437439,-1.4561021327972412,-1.3213337659835815,-0.021656036376953125,-1.5982712507247925,1.634793996810913,2.0886521339416504,-0.3773271143436432,-0.01031244546175003,-2.436997652053833,0.946509063243866,-1.0386559963226318,1.1192628145217896,-0.01026315987110138,1.5732203722000122,1.5450351238250732,-0.19178064167499542,1.9036369323730469,-0.3607119917869568,0.020965375006198883,0.013648845255374908,-0.9590853452682495,-1.4364644289016724,0.8165289163589478,0.02100205421447754,0.9629110097885132,-0.30660900473594666,1.7282178401947021,1.8352731466293335,2.158325433731079,1.4329006671905518,-1.691459059715271,-0.5661994218826294,-0.1205407902598381,0.6539450287818909,-0.5731220841407776,-0.5712001323699951,0.05095991864800453,2.0423715114593506,0.38125330209732056,1.9378645420074463,-1.3993757963180542,1.4109892845153809,-2.4587597846984863,-0.4475579261779785,1.6143956184387207,-1.1402835845947266,0.9724528789520264,0.8885104060173035,1.5575019121170044,-0.2761189043521881,1.239516019821167,-0.6677144765853882,-0.4108859896659851,0.8688536882400513,-1.1501388549804688,-1.0860329866409302,-0.6139317154884338,1.2461745738983154,0.7906427383422852,-2.405863046646118,0.127155601978302,1.0032368898391724,-1.2945197820663452,-2.5587680339813232,0.6089898347854614,-0.2387799620628357,1.9555363655090332,0.7444103956222534,0.813501238822937,0.6290771961212158,-1.165251612663269,0.6123824119567871,2.188509464263916,-0.5424339175224304,-0.2954089641571045,0.7950116395950317,-1.8452855348587036,-0.3790944516658783,1.3366310596466064,-1.2921125888824463,-0.3657657504081726,2.5310144424438477,-1.9800058603286743,-0.5018585920333862,0.14926594495773315,1.8033162355422974,-0.7877825498580933,-0.004381299018859863,0.32616040110588074,-0.09555365145206451,-0.09374295175075531,0.7925513982772827,-1.3531585931777954,-0.4713245928287506,-0.48813679814338684,-0.7477452754974365,-2.460991621017456,-1.7850091457366943,-0.3225319981575012,-2.3705689907073975,-0.3200221657752991,-0.36131054162979126,-0.5355932116508484,1.1413637399673462,0.32335788011550903,-0.09524578601121902,-0.39127999544143677,-1.3772929906845093,-0.6936095356941223,-1.8690463304519653,-0.06434047222137451,1.9537557363510132,-0.1767522543668747,-0.01337489765137434,-0.1414746344089508,-2.264939546585083,-0.37733668088912964,1.6682674884796143,-0.4536476731300354,-0.6687151193618774,1.1967006921768188,1.005483627319336,-0.058183081448078156,1.8832348585128784,1.7223488092422485,-0.40172407031059265,-0.9758274555206299,-0.06300292164087296,-2.027567148208618,0.004602450877428055,0.260885089635849,1.815115213394165,-0.35805127024650574,0.2111460417509079,-0.3251613974571228,2.922044038772583,0.9523003697395325,-2.2097795009613037,0.8502432107925415,-0.6950479745864868,0.23683729767799377,-1.2142055034637451,-0.03469989076256752,-1.4386756420135498,0.8846384882926941,-2.6294569969177246,-0.018067359924316406,0.11535103619098663,-0.14724572002887726,1.8469092845916748,1.4564385414123535,-0.23062855005264282,1.9643882513046265,-2.3059751987457275,-0.3032143712043762,-1.3987425565719604,1.805775761604309,2.8039045333862305,-0.9532835483551025,0.7999639511108398,-0.21749310195446014,-0.39535021781921387,0.6247507929801941,-2.3510234355926514,1.3111817836761475,0.22463278472423553,-0.3320663273334503,-1.412358045578003,2.8182642459869385,0.39596450328826904,2.445380926132202,1.1066138744354248,0.690233051776886,1.660901665687561,-0.22331923246383667,0.9031577706336975,0.018245786428451538,0.2009146809577942,1.5687092542648315,0.8498587608337402,-0.0837310329079628,-0.48910096287727356,-0.6369547247886658,-1.9339619874954224,-0.2996274530887604,-0.5019517540931702,-1.4117695093154907,1.8573561906814575,-0.2837202250957489,-0.18218863010406494,1.5799651145935059,1.5491167306900024,-1.3623266220092773,0.8198941946029663,1.017279863357544,0.08621226251125336,0.16159683465957642,0.478173166513443,0.8910671472549438,0.9972532987594604,-0.30747222900390625,-2.3779397010803223,-0.04194531962275505,0.30507171154022217,0.2396588772535324,-0.3729651868343353,-0.4939008355140686,0.7073845267295837,1.9290015697479248,-0.9882659912109375,0.011642872355878353,-1.7097498178482056,-0.3837873935699463,1.4267305135726929,-1.5075043439865112,-0.1983310431241989,2.7994346618652344,-0.4834953546524048,-0.37280943989753723,2.003049373626709,-0.5393979549407959,-1.0221363306045532,0.12067259848117828,-0.36427682638168335,0.08768972754478455,0.03235555812716484,-0.37485557794570923,-0.37145179510116577,1.9505815505981445,-0.951181173324585,0.7521990537643433,-2.086987257003784,-1.379414677619934,2.0997908115386963,0.839573860168457,0.10394204407930374,-0.5885030031204224,1.192958950996399,0.7119176387786865,1.84805428981781,0.7315765023231506,1.311316967010498,-1.6599478721618652,2.6602792739868164,-0.29265064001083374,-0.11378845572471619,0.567734956741333,0.15943536162376404,-1.3325096368789673,1.2633167505264282,1.9513061046600342,-0.11041715741157532,0.027194101363420486,-0.9260401129722595,-0.3649362027645111,1.4248086214065552,-0.396601140499115,-1.8219335079193115,-0.48996758460998535,0.4266393780708313,-1.662294864654541,0.78507000207901,-0.383097380399704,-1.579393744468689,-0.31262534856796265,-0.8343873620033264,1.9968016147613525,0.5807502269744873,-1.2649052143096924,-0.13179917633533478,-0.46810635924339294,-0.8450524210929871,1.052431583404541,1.9365077018737793,-0.3728716969490051,-2.1104962825775146,-1.4143105745315552,-0.17815108597278595,-0.4031027555465698,-1.406724452972412,-0.14152592420578003,-0.3965875804424286,0.8544918298721313,-0.22390124201774597,1.7546617984771729,-2.524064540863037,-0.12168415635824203,1.72520112991333,-0.36630120873451233,1.998971700668335,-0.10273588448762894,-0.48702213168144226,1.0751067399978638,0.7608767151832581,-1.3371360301971436,-0.25173473358154297,-0.8647938370704651,-1.3411369323730469,1.4637607336044312,1.5088379383087158,-0.055655740201473236,0.883362889289856,-0.44151127338409424,-0.6562598347663879,1.1116374731063843,0.42977771162986755,0.3317493200302124,-1.3598504066467285,1.008320689201355,-0.4957427978515625,0.44261908531188965,0.5508614182472229,2.6454315185546875,0.9131600260734558,-0.14649337530136108,0.24749504029750824,-0.6113909482955933,1.446945309638977,1.501922607421875,-2.216355800628662,-0.46273863315582275,-0.8104454874992371,0.02528933435678482,1.5564327239990234,-1.1977839469909668,0.7801035046577454,-0.4936448931694031,0.38604477047920227,0.1029292568564415,-1.2991523742675781,-0.06422491371631622,-0.4361880123615265,2.313429832458496,-1.5986264944076538,-1.53512704372406,-1.4792011976242065,0.5797448754310608,-1.4663095474243164,0.6713206171989441,1.0565240383148193,-0.09879662096500397,0.2651638984680176,-0.277993381023407,-0.43504685163497925,-1.520772933959961,0.04513131082057953,-0.8419883847236633,-0.6766636371612549,-0.3849286437034607,-1.313266634941101,0.30963587760925293,3.125427484512329,1.9534411430358887,1.8524060249328613,-0.17734666168689728,-2.3778154850006104,-2.626157283782959,-0.47735312581062317,0.17038533091545105,-0.2112090140581131,0.47797536849975586,-0.47356948256492615,-0.3374648094177246,-0.5062642693519592,1.5955923795700073,-0.5523454546928406,0.11657094955444336,0.1951196789741516,0.491081565618515,-0.5377005338668823,-0.2499934732913971,2.662400245666504,-0.07385508716106415,-2.405226469039917,0.101538747549057,-0.30840229988098145,-1.6982660293579102,-0.38351842761039734,0.6283450722694397,0.7431655526161194,-0.09782086312770844,1.5028753280639648,-0.38169175386428833,-0.09405389428138733,-0.1088162511587143,0.15571561455726624,0.22484613955020905,-1.5982909202575684,0.18738651275634766,0.0025702565908432007,0.46201807260513306,-1.9751834869384766,0.10636065900325775,0.9987006187438965,-1.7714709043502808,1.7571955919265747,0.0680694580078125,1.8535047769546509,0.8943962454795837,-1.5677740573883057,1.9214861392974854,-0.4820007085800171,-0.40084579586982727,-1.7295753955841064,0.18036192655563354,0.04843095690011978,2.2678167819976807,-0.008797451853752136,-0.2664526104927063,-0.4339534640312195,-1.6302707195281982,-0.3436647057533264,-1.3756372928619385,0.22453193366527557,-1.1833487749099731,0.5311591625213623,1.0050923824310303,-0.25051695108413696,1.0256640911102295,0.6734443306922913,-0.8605755567550659,3.1440188884735107,-0.7681989073753357,-0.035679373890161514,0.08956480026245117,-2.5534117221832275,0.9120140075683594,-0.4505227208137512,0.5325013995170593,-2.4988276958465576,-0.29081669449806213,-1.4924670457839966,-1.40274977684021,-0.8759710192680359,-1.9753475189208984,2.8161518573760986,-0.6780188679695129,1.3816752433776855,0.00368296355009079,-1.0131932497024536,0.07012832164764404,-1.1838678121566772,1.6183654069900513,1.2112929821014404,-0.05499955639243126,-0.44270509481430054,1.5713272094726562,1.0495855808258057,0.5132300853729248,1.7601263523101807,0.21425405144691467,2.18349289894104,0.1321142315864563,2.11816668510437,0.8197923898696899,-0.5669131278991699,0.669991672039032,-0.06203244999051094,-1.4381123781204224,-0.25992220640182495,0.8314154148101807,-1.4758580923080444,-0.48517876863479614,-1.429248332977295,1.432076096534729,2.8646140098571777,-0.9919000864028931,0.5770532488822937,-0.12243551015853882,2.445693016052246,0.004160769283771515,1.7357710599899292,-1.3775622844696045,0.04845641180872917,1.7660868167877197,-0.7974591851234436,1.372443675994873,1.6183661222457886,0.5558443665504456,-1.438005805015564,-1.2376283407211304,-1.4167695045471191,-0.6524654626846313,-0.2748299837112427,0.8757859468460083,0.6473286747932434,-0.08119011670351028,-2.441802978515625,0.07002481818199158,0.9556007385253906,-1.0222396850585938,-1.1820158958435059,-0.8244845867156982,1.3220117092132568,0.6608147025108337,-2.173051357269287,1.7768341302871704,-1.9436156749725342,2.537879228591919,0.8167306184768677,-0.5060099959373474,0.47574350237846375,0.5128108263015747,-0.4045465886592865,0.037983957678079605,2.093036413192749,0.19851523637771606,0.17659375071525574,-0.1498253047466278,-0.3974827229976654,0.3486476540565491,0.8793073296546936,-2.480400800704956,1.029520034790039,1.792951226234436,0.14024809002876282,0.6062203645706177,0.3277101218700409,-0.47492432594299316,0.20474398136138916,-1.1508023738861084,1.2781354188919067,-0.4997803270816803,0.12607887387275696,-1.9163237810134888,0.48231279850006104,-0.052087828516960144,-2.4388840198516846,1.004562258720398,-0.10763567686080933,0.010286463424563408,0.01369570940732956,-1.9993209838867188,0.9424369931221008,-0.38546693325042725,0.16151639819145203,-0.9141311049461365,0.6132068634033203,0.36942043900489807,1.3564192056655884,-0.49937957525253296,-0.13157817721366882,0.0563233345746994,0.43909981846809387,-0.029508650302886963,-0.5184793472290039,-1.2907401323318481,0.034546613693237305,2.1322970390319824,0.23498974740505219,1.8041642904281616,-1.5679994821548462,1.6808345317840576,-0.04815518483519554,-1.2703722715377808,1.766532063484192,-2.3854761123657227,0.8876541256904602,-0.2712134122848511,1.2321112155914307,-0.4301137626171112,-2.034419536590576,0.0193231962621212,1.9773792028427124,0.23567433655261993,-0.43965673446655273,0.9085198640823364,-0.8631870150566101,0.25290238857269287,0.013113364577293396,0.15406624972820282,-1.4767762422561646,-0.5921233892440796,-1.3240798711776733,-0.9047586917877197,-2.0978007316589355,0.6720263361930847,-0.5667442083358765,0.22983665764331818,-2.288668394088745,-2.4585154056549072,-0.8383695483207703,-1.4731389284133911,-2.6570026874542236,-1.667356014251709,-1.3835663795471191,-0.6669774055480957,0.7367761135101318,1.6606651544570923,0.785908579826355,-0.04933421313762665,0.1318267583847046,0.9263360500335693,-0.3555016815662384,0.7509424090385437,-2.140606164932251,-1.7112083435058594,-0.05896782875061035,0.6607531905174255,0.7812551259994507,2.0964572429656982,0.5007189512252808,0.03525736182928085,-1.5170387029647827,1.959370493888855,0.4929450452327728,1.3360270261764526,0.08183228969573975,-0.40097200870513916,0.8901945948600769,-0.33631858229637146,-0.4397275447845459,-0.31621408462524414,2.0843448638916016,2.6009769439697266,0.2601128816604614,0.1618635207414627],"y":[0.6971567273139954,-1.3357306718826294,0.9205255508422852,1.1133230924606323,1.299261450767517,0.5913468599319458,0.14696182310581207,1.115126371383667,-0.6860694289207458,0.1040763407945633,-0.4330286979675293,-0.7259331941604614,-2.5308046340942383,0.14134415984153748,0.11262037605047226,-2.529059410095215,0.607295036315918,1.4209978580474854,-0.7921993732452393,0.12943723797798157,-2.2616257667541504,-0.3082273602485657,-2.137019634246826,-0.13923363387584686,0.010355740785598755,-2.6805167198181152,-0.0627346932888031,-0.3324878215789795,-2.7263612747192383,1.3438383340835571,1.0140029191970825,0.5584564208984375,0.13796554505825043,-0.7628608345985413,0.9207147359848022,-0.8441382646560669,0.18854686617851257,-0.754001259803772,-0.8009380102157593,-2.466923713684082,-1.7275793552398682,1.9940632581710815,2.0491724014282227,0.9528111219406128,0.9112615585327148,-1.8407330513000488,-0.21349819004535675,0.7119871377944946,0.9493697881698608,0.6091722846031189,1.5243858098983765,1.5081053972244263,-0.28085532784461975,0.02935543656349182,0.08630276471376419,0.31065553426742554,-0.42130333185195923,2.070543050765991,1.9126237630844116,2.351804733276367,0.18425682187080383,-0.6127024292945862,-0.03153594955801964,-1.763211965560913,0.9311010837554932,-0.26453202962875366,0.031151846051216125,-1.6280030012130737,-0.42811211943626404,-0.09055699408054352,-1.3099077939987183,-2.6569836139678955,-1.4168957471847534,-0.6151067018508911,-0.1890777200460434,-1.596471905708313,1.3147343397140503,-1.5965301990509033,-1.544427514076233,0.38988637924194336,-1.0571731328964233,-1.7578208446502686,-0.687155544757843,-1.2309902906417847,-0.6958786845207214,-0.7960918545722961,-1.6295080184936523,-0.30392986536026,1.2863489389419556,0.07662627100944519,-2.7386703491210938,-0.5641244649887085,-1.6420611143112183,0.1800025850534439,-0.6766208410263062,-0.2231561243534088,0.05536864697933197,-0.6224250793457031,-1.9178152084350586,-0.8199959397315979,0.5455846190452576,-1.5730103254318237,0.26682427525520325,-1.5366148948669434,0.5527247786521912,1.2420493364334106,1.1175203323364258,-2.7484514713287354,-1.562504768371582,-1.382474660873413,-1.53835928440094,-0.6202061772346497,2.228577136993408,-1.7059414386749268,0.42649972438812256,-1.3055682182312012,-0.8294066786766052,-0.33689525723457336,-0.37338000535964966,-0.7251683473587036,-0.2651059925556183,-0.16290441155433655,-2.0316123962402344,0.2906927764415741,0.39690786600112915,-0.8416849374771118,-0.956335723400116,0.3541516065597534,0.1212104931473732,1.0306416749954224,2.1582159996032715,0.14063160121440887,-1.8904213905334473,-0.08739951997995377,-0.24369163811206818,-1.533732295036316,-0.8761259317398071,0.12114783376455307,-1.2107386589050293,0.16982057690620422,0.4387562572956085,-0.1867397427558899,0.22185735404491425,-0.7724543213844299,-0.38273969292640686,0.6911633610725403,1.3018980026245117,1.550790786743164,0.19459132850170135,0.5228710770606995,0.9813641905784607,2.1259565353393555,-1.730135202407837,-0.44377627968788147,0.07907596230506897,-1.4551794528961182,-0.17202535271644592,1.1828409433364868,-2.3884434700012207,-1.1858071088790894,-2.6821796894073486,1.146389365196228,-0.39557790756225586,-1.0239366292953491,-1.511938452720642,-0.9240122437477112,0.48120319843292236,-1.2475364208221436,1.1538549661636353,0.07722789794206619,-0.4243912100791931,0.05231693014502525,2.1545205116271973,-2.4604954719543457,0.361287921667099,-0.0893009677529335,2.3185184001922607,2.305678129196167,-0.5796660780906677,-0.2734764814376831,-2.8295061588287354,-0.4560105800628662,0.9742685556411743,0.6270306706428528,-1.6480625867843628,-0.7627862691879272,-0.5415475368499756,1.6314042806625366,-1.4630688428878784,1.4431592226028442,1.1764613389968872,0.2421061247587204,0.6020093560218811,-0.19901229441165924,0.19651681184768677,-0.1991257667541504,-2.4356043338775635,1.469380259513855,-0.34984681010246277,-0.667499840259552,1.3100688457489014,-1.0503685474395752,-0.8054895997047424,0.054619476199150085,-0.7297959923744202,-1.759648323059082,-0.7376517057418823,-0.9524298906326294,-0.2741861045360565,-0.8019874095916748,-1.0470936298370361,0.35581010580062866,0.5029953122138977,-0.46631303429603577,-0.3614058196544647,-1.3758820295333862,-1.199587106704712,-0.7338622212409973,-0.023427879437804222,0.01048559695482254,-1.479135513305664,-1.606712818145752,-2.6189229488372803,0.66407310962677,-0.04666609317064285,-1.2567895650863647,1.4033528566360474,-2.399583578109741,0.8369868397712708,-0.693579912185669,1.8388299942016602,1.7892110347747803,-1.8698197603225708,0.34546399116516113,-0.6220695972442627,-0.7712657451629639,0.32935217022895813,-0.8655990958213806,-2.2230329513549805,-2.4700818061828613,1.3452175855636597,1.2298575639724731,0.3366782069206238,1.9201319217681885,-1.3787994384765625,-0.8213194012641907,0.004152888432145119,-2.46466064453125,0.9533296823501587,2.2164032459259033,-0.14338335394859314,0.0682293102145195,-1.8313974142074585,-2.2902448177337646,-0.26203179359436035,0.8105863928794861,1.7933392524719238,0.22480326890945435,0.3157694339752197,-0.042074814438819885,-1.794783353805542,1.8990131616592407,2.299067735671997,-1.2616591453552246,-0.3904341459274292,-0.5690078139305115,-0.39550477266311646,-0.6737684011459351,1.2765543460845947,0.31532013416290283,0.9676221013069153,0.021753773093223572,-2.729283094406128,-2.2339205741882324,0.12607786059379578,1.5211756229400635,-1.569231390953064,-1.6864029169082642,1.17512845993042,1.0687482357025146,-2.0215487480163574,0.4643007218837738,-2.4849512577056885,-0.3428651988506317,-1.3296115398406982,-1.6415519714355469,-0.7453321218490601,-0.10513851791620255,-1.9024964570999146,1.310775876045227,-0.3036893904209137,1.1308799982070923,-2.6546597480773926,1.154543161392212,0.2280583679676056,-2.501647472381592,1.513567328453064,-0.2437029480934143,0.25300389528274536,-0.836972713470459,-0.014009572565555573,0.2827102541923523,-1.775544285774231,-0.4600938856601715,2.163665294647217,-0.6856659054756165,-1.2506146430969238,0.33710139989852905,-2.0355405807495117,-1.4545924663543701,0.39955973625183105,0.21308140456676483,-0.004982605576515198,-0.2309660166501999,2.2862043380737305,0.5933871865272522,-0.01749328523874283,-0.9430909156799316,-0.7906364798545837,-2.801304578781128,1.696875810623169,0.36310848593711853,-1.9311827421188354,-1.9585151672363281,-0.43462780117988586,1.2306796312332153,-0.7252697944641113,0.08752908557653427,-1.0250909328460693,2.278386116027832,-0.7307122945785522,-0.03903190419077873,-1.886779546737671,-0.10631164908409119,-1.7743767499923706,-0.6372386813163757,1.1902233362197876,1.1528326272964478,-1.7463645935058594,-0.7994517087936401,-0.29624417424201965,-1.4244277477264404,-0.08692138642072678,-1.7002339363098145,-0.045857347548007965,1.0679713487625122,-2.4452319145202637,-0.8871116638183594,-0.705323338508606,-0.4899212419986725,-0.4295777678489685,0.311658650636673,-0.47102075815200806,1.1068236827850342,0.5353188514709473,-1.1951642036437988,-0.3740854561328888,0.6208044290542603,-0.649989128112793,-0.04289920628070831,-2.794153928756714,0.10606694221496582,-2.713432550430298,-1.4362390041351318,-1.4184043407440186,0.25952813029289246,-0.2666292190551758,0.14899805188179016,-0.45166096091270447,0.22276896238327026,0.13777771592140198,-0.4206807613372803,-0.25937557220458984,0.23900306224822998,-0.7317007780075073,-1.1184258460998535,-1.3129727840423584,-1.7600804567337036,-0.21804803609848022,2.0200493335723877,0.28689756989479065,2.2619810104370117,-2.5058417320251465,0.4854636490345001,0.643839955329895,-1.8725486993789673,1.5602569580078125,1.1936848163604736,0.05728994309902191,1.2766404151916504,0.18628858029842377,0.4533687233924866,0.8525710701942444,-2.415008068084717,0.23478473722934723,-0.774638831615448,-2.3043413162231445,-1.0338134765625,-1.7157469987869263,-2.060372829437256,0.21734124422073364,0.07199234515428543,0.04344479739665985,-1.5445404052734375,0.40514594316482544,-1.740476369857788,0.08302485942840576,0.4843519330024719,-1.789027214050293,-0.7687265276908875,-0.6544545888900757,-1.8721507787704468,1.502463459968567,-0.3788057863712311,0.05892236903309822,2.320979118347168,-0.3906424045562744,1.2166372537612915,1.281217336654663,0.21184539794921875,0.4951515793800354,-0.8431298136711121,-0.6397781372070312,-2.272361993789673,-0.9705957174301147,0.5829744935035706,0.3415924310684204,-1.2342137098312378,0.676935613155365,-0.21716070175170898,-0.5112906098365784,-1.2769173383712769,2.4245152473449707,-1.1339221000671387,1.2826800346374512,-0.3068903088569641,0.21400749683380127,0.6988327503204346,-1.5017813444137573,1.124405026435852,-2.598245143890381,-0.6017303466796875,0.10544095188379288,-0.8690513968467712,0.38390517234802246,-0.9210125803947449,-0.29729360342025757,0.8351434469223022,0.28090739250183105,0.7514373660087585,-0.5795228481292725,-0.42538443207740784,1.1223185062408447,-2.5865418910980225,-1.7483257055282593,0.2619621157646179,-0.3223332464694977,-0.31145167350769043,-0.36208558082580566,-1.933228611946106,-0.6822477579116821,-1.428537368774414,0.46087801456451416,-0.6040788888931274,-1.3099061250686646,-1.799109697341919,2.240471839904785,-0.744104266166687,1.025614857673645,-1.393713116645813,0.1631823182106018,2.271404981613159,0.10691030323505402,0.1240387111902237,0.17213153839111328,0.1793433427810669,1.253220558166504,0.09752025455236435,0.2995370030403137,-0.8465431928634644,-1.6017570495605469,-1.7768253087997437,-0.2820233702659607,1.4096509218215942,2.2927849292755127,-0.11905355751514435,-0.08696338534355164,-2.786078453063965,0.16215477883815765,-0.1571856588125229,-0.48499175906181335,2.354022979736328,1.4080133438110352,-2.832707405090332,-0.6206066608428955,2.221477508544922,0.16343353688716888,1.3299580812454224,0.527772843837738,-0.2773808538913727,-1.1369013786315918,1.3696348667144775,-0.05715234577655792,-1.4633623361587524,-0.23296883702278137,0.17290978133678436,0.9475210309028625,-2.1395795345306396,-0.790256142616272,-1.4199427366256714,0.49277061223983765,-1.4616254568099976,0.24928323924541473,1.0513266324996948,-2.094670534133911,-1.5010159015655518,0.22117552161216736,0.055728450417518616,-0.8097598552703857,0.029455065727233887,-1.4954031705856323,0.6782153844833374,-2.5092556476593018,0.13608630001544952,0.6830045580863953,0.336637020111084,-2.309756278991699,0.8291776180267334,-0.5975157618522644,0.19121792912483215,1.1859703063964844,0.5693500638008118,0.3191053867340088,-2.5485587120056152,2.43709397315979,-0.20983974635601044,-1.1692639589309692,0.17042988538742065,0.5082638263702393,1.1976248025894165,-0.8906770944595337,1.0878061056137085,0.8982598185539246,0.43161696195602417,2.3959667682647705,-2.870539903640747,-1.187863826751709,1.6441802978515625,0.2704435884952545,0.16413655877113342,1.7231930494308472,-0.030367624014616013,1.0095317363739014,-1.3800009489059448,0.18842704594135284,-2.4644775390625,-2.3363559246063232,-0.6088076233863831,0.042709264904260635,0.15527817606925964,0.19509129226207733,1.4421590566635132,0.7034654021263123,-0.7174901366233826,-0.09219671785831451,-0.06679659336805344,1.1475342512130737,0.10766837745904922,-0.42147502303123474,1.9861061573028564,-2.238703489303589,0.1916053295135498,0.49859943985939026,-2.391347646713257,1.3820487260818481,0.5811901092529297,-0.24017176032066345,1.968064785003662,-1.6782983541488647,2.149498701095581,1.0008920431137085,-1.5374704599380493,0.3692812919616699,-0.5542431473731995,-1.0314021110534668,1.131119728088379,-1.8219925165176392,-1.6264863014221191,-0.7098215818405151,1.0935782194137573,0.713604211807251,-2.1044418811798096,1.959092617034912,-0.10124285519123077,1.652198314666748,0.2672756016254425,1.354913353919983,0.3310002088546753,0.3498249650001526,-0.7245701551437378,-0.10873826593160629,-2.7700576782226562,0.010604873299598694,-1.441382884979248,1.1182929277420044,-2.75630259513855,-0.6445515155792236,-0.13071563839912415,-0.7620832920074463,0.20221254229545593,0.00727153941988945,1.0479201078414917,-2.5037992000579834,-0.6050825119018555,-1.668541431427002,-0.43220511078834534,-0.1260875016450882,0.1381818652153015,-1.665130853652954,0.09376974403858185,-0.14742273092269897,-0.4992661774158478,-0.4360523819923401,-0.5647405385971069,-1.2905983924865723,-1.9836127758026123,-0.7336016893386841,-2.6612260341644287,0.1822577565908432,-0.8805532455444336,1.0111666917800903,1.9964390993118286,1.6694520711898804,-0.5074544548988342,-0.7289943099021912,1.402512550354004,-1.5669907331466675,0.2612570524215698,-1.333457350730896,2.1214189529418945,1.8640413284301758,-0.2278745323419571,-0.7312461137771606,1.5268341302871704,-0.4147452712059021,-1.7274123430252075,-0.45281100273132324,-1.4808471202850342,1.1230854988098145,-0.10964842140674591,1.1655995845794678,-0.9407520294189453,0.3884541690349579,-0.5729493498802185,-2.641270875930786,0.559503436088562,-0.5245025753974915,0.34251466393470764,1.2838773727416992,0.5774711966514587,-2.7063095569610596,0.24134868383407593,0.11389291286468506,-0.7033606767654419,-0.00023507967125624418,0.018630243837833405,-1.7674158811569214,-2.1141364574432373,-0.42504021525382996,0.010885968804359436,-0.8432976603507996,-0.37291425466537476,-0.43432676792144775,-0.01587142050266266,-0.6372579336166382,1.7062008380889893,1.9942445755004883,-0.6390776634216309,-0.7232581973075867,1.1322568655014038,1.9252055883407593,1.437382698059082,-1.0810127258300781,0.22719989717006683,0.4283343553543091,1.2753487825393677,1.2246229648590088,-2.624429225921631,2.3218228816986084,1.338240385055542,-1.260683298110962,-1.4681380987167358,0.12252191454172134,1.083832859992981,2.293208599090576,-1.2670021057128906,0.4026297926902771,0.39549529552459717,-2.843226909637451,1.2891700267791748,-1.1120452880859375,-1.085036039352417,0.5358198285102844,-0.5020260810852051,0.9789234399795532,-0.7111372947692871,-2.4201648235321045,-2.4423930644989014,-0.41772517561912537,-0.11834749579429626,2.4392149448394775,0.004376530647277832,-2.30500864982605,0.0909423902630806,0.023478170856833458,-1.7450274229049683,1.8387439250946045,-0.23295852541923523,1.7686196565628052,-0.5722205638885498,-0.34432750940322876,-1.845205307006836,-1.8099437952041626,0.3348439037799835,-0.752284824848175,0.21658460795879364,1.2711204290390015,-2.2001137733459473,0.16420309245586395,-1.5270369052886963,-0.16162985563278198,0.1429305374622345,-0.9177089929580688,-2.024069309234619,-0.12231367826461792,-0.3330308794975281,0.9347957372665405,1.1464569568634033,-0.7587376832962036,-0.8995351195335388,-0.24927666783332825,-0.7051352858543396,-0.45608794689178467,1.153043508529663,1.0825574398040771,-0.6348509788513184,-0.0018422524444758892,-1.0632755756378174,-0.1505611538887024,2.1398191452026367,-0.7591217160224915,-0.7693864107131958,-0.04700346291065216,-0.6213467717170715,-1.5095036029815674,-0.5698639750480652,-1.0250412225723267,0.3240906596183777,-0.1395568996667862,-2.1240439414978027,0.32819730043411255,2.1399810314178467,-0.5007555484771729,0.1908567249774933,-2.5520033836364746,0.12751340866088867,0.27747663855552673,-0.6897038221359253,0.06979607790708542,1.302781581878662,0.38786932826042175,0.014777081087231636,1.2850033044815063,-1.7654030323028564,1.1262637376785278,2.309476375579834,-1.6848158836364746,-1.9276829957962036,-2.158111810684204,0.009010134264826775,-0.6668914556503296,0.5767275094985962,-0.6341910362243652,0.6597865223884583,0.11266138404607773,0.23694190382957458,-2.002793073654175,0.010516390204429626,0.20336167514324188,-1.9229263067245483,0.19560861587524414,0.18207192420959473,-0.4853818118572235,-2.077225923538208,0.028357401490211487,1.9488904476165771,0.08964602649211884,-1.2759130001068115,-0.6888812184333801,0.11431914567947388,1.3148386478424072,1.694584846496582,0.8479243516921997,-1.6231720447540283,-0.6454315185546875,1.01189124584198,-2.8353724479675293,-0.01930452324450016,-0.5830060243606567,-0.43337225914001465,1.2639565467834473,-0.6826430559158325,0.08613506704568863,-0.5459896922111511,-0.3119467794895172,-0.7495105266571045,-2.448812484741211,1.2623772621154785,-0.6806449294090271,0.1832767128944397,1.617382287979126,0.20284873247146606,-1.1427876949310303,1.3121341466903687,0.6944441199302673,1.149347186088562,-1.409430980682373,0.20417524874210358,-0.5463165640830994,1.347316861152649,-1.452783226966858,-1.7848745584487915,-0.9299874305725098,0.17850063741207123,0.11670920252799988,0.06504277884960175,-0.126556396484375,0.5794205665588379,-0.19786149263381958,0.8990766406059265,-2.8669753074645996,2.022404670715332,-1.5224295854568481,0.6355195045471191,1.72563898563385,-1.6036953926086426,-0.24881069362163544,-2.3652141094207764,-0.6290259957313538,-2.525339365005493,2.15512752532959,0.19536328315734863,-1.585007667541504,0.2384740263223648,-2.191974401473999,0.3026237189769745,0.020513461902737617,-2.0261967182159424,0.9783320426940918,-2.499202013015747,-0.9907515048980713,-2.671008586883545,-0.4451158046722412,-0.6224026083946228,-2.281700611114502,0.09526181221008301,0.159113347530365,0.814845621585846,-1.6441394090652466,2.2395105361938477,0.35315993428230286,-0.9183144569396973,1.8529661893844604,0.7989947199821472,0.9032735824584961,1.1226094961166382,1.45425283908844,-0.7672277092933655,0.890767514705658,-0.9039888978004456,-2.097524881362915,-1.5012232065200806,1.0094528198242188,0.054582010954618454,1.1979625225067139,2.1229026317596436,0.15587812662124634,0.2089877724647522,0.37496477365493774,-0.6114166378974915,-1.8635038137435913,-0.7262195348739624,-0.7393763661384583,1.0917450189590454,-0.2722221612930298,-0.49803176522254944,-1.6665514707565308,-2.103496551513672,1.2252682447433472,2.2466464042663574,1.2345997095108032,-0.6427605152130127,1.1454600095748901,0.9122896194458008,1.7265949249267578,1.1571893692016602,0.13379128277301788,-1.683337688446045,-1.6829229593276978,-0.8362274765968323,-0.6140647530555725,0.01806461066007614,-1.5895828008651733,0.358737051486969,-0.0038932114839553833,-1.6339921951293945,-0.4368150532245636,0.27041324973106384,2.0477588176727295,-1.2771785259246826,0.9606184363365173,-2.755566120147705,-1.341294765472412,-0.11849221587181091,0.28448110818862915,2.177420139312744,1.0622576475143433,0.11041684448719025,-0.24202264845371246,-0.9457927942276001,0.01985529065132141,-1.7743206024169922,-0.6776070594787598,-0.9446107149124146,-2.218012571334839,1.2971575260162354,-0.7061673402786255,-0.4977128803730011,0.9790393114089966,-0.9745877385139465,-1.608903408050537,-0.7448965907096863,0.3948982059955597,1.116498351097107,-1.7111766338348389,-0.6881445050239563,-0.33063387870788574,-0.02105075865983963,0.018704049289226532,-0.3223716616630554,0.9648739695549011,1.1030141115188599,2.264279365539551,2.279209852218628,-0.41792261600494385,-1.5391521453857422,0.4854494631290436,1.112598180770874,1.250717282295227,0.8685832619667053,-0.42469605803489685,1.3633965253829956,-1.3679567575454712,-1.3574187755584717,1.0964008569717407,-0.6044456958770752,-0.0816286951303482,-0.19069717824459076,1.882174015045166,-0.39865368604660034,-0.5588399171829224,1.3151367902755737,0.649157702922821,0.08915013819932938,-0.7356617450714111,-0.07572069019079208,1.2257643938064575,-0.18007704615592957,1.2647732496261597,-1.9848335981369019,0.0094200000166893,-0.4074038863182068,-0.34288981556892395,0.6869348883628845,2.133648157119751,-0.012221023440361023,-0.022550523281097412,0.34672659635543823,-2.8304665088653564,-1.2110902070999146,1.1272107362747192,-0.2479398548603058,-1.6534525156021118,2.293245553970337,-0.09714332222938538,0.2870689332485199,0.333468496799469,-1.447056531906128,1.094048023223877,1.136849045753479],"z":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.0577133484184742,0.06520440429449081,0.07269545644521713,0.08018650859594345,0.08767755329608917,0.09516860544681549,0.1026596650481224,0.11015070974826813,0.11764176189899445,0.12513282895088196,0.13262388110160828,0.1401149332523346,0.1476059854030609,0.15509703755378723,0.16258808970451355,0.17007912695407867,0.177570179104805,0.1850612461566925,0.19255229830741882,0.20004333555698395,0.20753440260887146,0.21502543985843658,0.2225165069103241,0.23000754415988922,0.23749861121177673,0.24498964846134186,0.25248071551322937,0.2599717378616333,0.267462819814682,0.2749538719654083,0.28244492411613464,0.28993597626686096,0.2974270284175873,0.3049180805683136,0.3124091327190399,0.31990015506744385,0.32739123702049255,0.33488228917121887,0.3423733413219452,0.3498643636703491,0.3573554456233978,0.36484649777412415,0.3723375201225281,0.3798285722732544,0.3873196542263031,0.3948107361793518,0.40230172872543335,0.40979278087615967,0.4172838628292084,0.4247749447822571,0.4322659373283386,0.43975698947906494,0.44724807143211365,0.45473915338516235,0.4622301459312439,0.4697211980819702,0.4772122800350189,0.4847033619880676,0.49219438433647156,0.4996854066848755,0.5071764588356018,0.5146675705909729,0.5221586227416992,0.5296496152877808,0.5371406674385071,0.5446317195892334,0.5521228313446045,0.559613823890686,0.5671048760414124,0.5745959877967834,0.582086980342865,0.5895780324935913,0.5970691442489624,0.6045601963996887,0.612051248550415,0.6195422410964966,0.6270332932472229,0.634524405002594,0.6420153975486755,0.6495064496994019,0.656997561454773,0.6644886136054993,0.6719796657562256,0.6794706583023071,0.6869617104530334,0.6944528222084045,0.7019438147544861,0.7094348669052124,0.7169259786605835,0.7244170308113098,0.7319080829620361,0.7393990755081177,0.746890127658844,0.7543812394142151,0.7618722319602966,0.769363284111023,0.776854395866394,0.7843454480171204,0.7918365001678467,0.7993274927139282,0.8068185448646545,0.8143095970153809,0.8218006491661072,0.8292917013168335,0.8367828130722046,0.8442738652229309,0.8517649173736572,0.8592559695243835,0.8667469620704651,0.8742380142211914,0.8817290663719177,0.889220118522644,0.8967112302780151,0.9042022824287415,0.9116933345794678,0.9191843867301941,0.9266754388809204,0.934166431427002,0.9416574835777283,0.9491485357284546,0.9566396474838257,0.964130699634552,0.9716217517852783,0.9791128039360046,0.986603856086731,0.994094967842102,1.0015859603881836,1.0090770721435547,1.0165680646896362,1.0240591764450073,1.0315502882003784,1.03904128074646,1.0465322732925415,1.0540233850479126,1.0615143775939941,1.0690054893493652,1.0764966011047363,1.0839875936508179,1.0914785861968994,1.0989696979522705,1.106460690498352,1.1139518022537231,1.1214429140090942,1.1289337873458862,1.1364248991012573,1.1439160108566284,1.1514071226119995,1.158898115158081,1.1663891077041626,1.1738802194595337,1.1813712120056152,1.1888623237609863,1.1963534355163574,1.203844428062439,1.2113354206085205,1.2188265323638916,1.2263175249099731,1.2338086366653442,1.2412997484207153,1.2487906217575073,1.2562817335128784,1.2637728452682495,1.2712639570236206,1.2787549495697021,1.2862459421157837,1.2937370538711548,1.3012280464172363,1.3087191581726074,1.3162102699279785,1.32370126247406,1.3311922550201416,1.3386834859848022,1.3461743593215942,1.3536654710769653,1.3611565828323364,1.3686474561691284,1.3761385679244995,1.3836296796798706,1.3911207914352417,1.3986117839813232,1.4061028957366943,1.4135937690734863,1.4210848808288574,1.4285759925842285,1.4360671043395996,1.4435580968856812,1.4510490894317627,1.4585403203964233,1.4660311937332153,1.4735223054885864,1.4810134172439575,1.4885042905807495,1.4959954023361206,1.5034865140914917,1.5109776258468628,1.5184686183929443,1.5259597301483154,1.5334506034851074,1.5409417152404785,1.5484328269958496,1.5559238195419312,1.5634149312973022,1.5709059238433838,1.5783971548080444,1.5858880281448364,1.593379259109497,1.6008702516555786,1.6083611249923706,1.6158522367477417,1.6233433485031128,1.6308344602584839,1.6383254528045654,1.6458165645599365,1.6533074378967285,1.6607986688613892,1.6682896614074707,1.6757806539535522,1.6832717657089233,1.6907627582550049,1.698253870010376,1.7057448625564575,1.7132360935211182,1.7207270860671997,1.7282180786132812,1.7357091903686523,1.7432001829147339,1.7506911754608154,1.7581822872161865,1.7656733989715576,1.7731642723083496,1.7806555032730103,1.7881464958190918,1.7956374883651733,1.8031286001205444,1.810619592666626,1.818110704421997,1.8256016969680786,1.8330929279327393,1.8405838012695312,1.8480749130249023,1.8555660247802734,1.863057017326355,1.8705480098724365,1.8780391216278076,1.8855302333831787,1.8930211067199707,1.9005123376846313,1.908003330230713,1.915494441986084,1.9229854345321655],"y":[1.3817541599273682,1.3790048360824585,1.3762552738189697,1.3735060691833496,1.3707566261291504,1.3680071830749512,1.3652578592300415,1.3625085353851318,1.3597590923309326,1.357009768486023,1.3542602062225342,1.3515108823776245,1.3487615585327148,1.3460121154785156,1.343262791633606,1.3405133485794067,1.3377639055252075,1.3350145816802979,1.3322652578353882,1.329515814781189,1.3267663717269897,1.32401704788208,1.3212676048278809,1.3185182809829712,1.315768837928772,1.3130195140838623,1.310270071029663,1.3075206279754639,1.3047713041305542,1.3020219802856445,1.2992725372314453,1.296523094177246,1.2937737703323364,1.2910243272781372,1.2882750034332275,1.2855255603790283,1.282776117324829,1.2800267934799194,1.2772774696350098,1.2745281457901,1.2717787027359009,1.269029140472412,1.2662798166275024,1.2635306119918823,1.260781168937683,1.2580317258834839,1.2552824020385742,1.252532958984375,1.2497836351394653,1.2470343112945557,1.244284749031067,1.2415354251861572,1.238785982131958,1.2360366582870483,1.2332873344421387,1.2305378913879395,1.2277884483337402,1.2250391244888306,1.2222896814346313,1.2195403575897217,1.216791033744812,1.2140414714813232,1.2112921476364136,1.208542823791504,1.2057933807373047,1.203044056892395,1.2002946138381958,1.1975451707839966,1.194795846939087,1.1920464038848877,1.189297080039978,1.1865477561950684,1.1837983131408691,1.18104887008667,1.1782995462417603,1.175550103187561,1.1728007793426514,1.1700513362884521,1.1673020124435425,1.1645525693893433,1.1618032455444336,1.1590538024902344,1.1563043594360352,1.1535550355911255,1.1508055925369263,1.1480562686920166,1.1453068256378174,1.1425575017929077,1.1398080587387085,1.1370586156845093,1.1343092918395996,1.1315598487854004,1.1288105249404907,1.126061201095581,1.1233117580413818,1.1205623149871826,1.117812991142273,1.1150636672973633,1.112314224243164,1.1095649003982544,1.1068153381347656,1.104066014289856,1.1013166904449463,1.0985673666000366,1.0958179235458374,1.0930684804916382,1.0903191566467285,1.0875697135925293,1.0848203897476196,1.0820709466934204,1.0793216228485107,1.0765721797943115,1.0738227367401123,1.0710734128952026,1.068324089050293,1.0655746459960938,1.0628252029418945,1.0600758790969849,1.0573264360427856,1.054577112197876,1.0518276691436768,1.0490782260894775,1.0463289022445679,1.0435795783996582,1.040830135345459,1.0380806922912598,1.03533136844635,1.0325820446014404,1.0298326015472412,1.027083158493042,1.0243337154388428,1.021584391593933,1.0188350677490234,1.0160856246948242,1.013336181640625,1.0105868577957153,1.0078375339508057,1.0050880908966064,1.0023386478424072,0.9995893239974976,0.9968398809432983,0.9940905570983887,0.9913411140441895,0.9885917901992798,0.9858424663543701,0.9830929636955261,0.9803435802459717,0.9775941967964172,0.9748448729515076,0.9720954895019531,0.9693460464477539,0.9665967226028442,0.963847279548645,0.9610979557037354,0.9583485126495361,0.9555991291999817,0.9528497457504272,0.9501003623008728,0.9473509788513184,0.9446015954017639,0.9418522119522095,0.9391027688980103,0.9363533854484558,0.9336040019989014,0.9308546781539917,0.9281052350997925,0.925355851650238,0.9226064682006836,0.9198570847511292,0.9171077013015747,0.9143583178520203,0.9116089344024658,0.9088595509529114,0.9061101675033569,0.9033607244491577,0.900611400604248,0.8978620171546936,0.8951126337051392,0.8923631906509399,0.8896138072013855,0.886864423751831,0.8841150999069214,0.8813656568527222,0.8786163330078125,0.8758668899536133,0.8731175661087036,0.8703681230545044,0.8676186800003052,0.8648693561553955,0.8621199131011963,0.8593705892562866,0.8566211462020874,0.8538718223571777,0.8511223793029785,0.8483730554580688,0.8456236124038696,0.84287428855896,0.8401249051094055,0.8373754024505615,0.8346260786056519,0.8318766355514526,0.829127311706543,0.8263779282569885,0.8236285448074341,0.8208791613578796,0.8181297779083252,0.8153803944587708,0.8126310110092163,0.8098816275596619,0.8071322441101074,0.8043828010559082,0.8016334176063538,0.7988840341567993,0.7961346507072449,0.7933852672576904,0.790635883808136,0.7878865003585815,0.7851371169090271,0.7823877334594727,0.7796383500099182,0.7768889665603638,0.7741395235061646,0.7713901400566101,0.7686407566070557,0.7658913731575012,0.7631419897079468,0.7603926658630371,0.7576432228088379,0.7548938989639282,0.7521445155143738,0.7493951320648193,0.7466457486152649,0.7438962459564209,0.7411469221115112,0.7383975386619568,0.7356481552124023,0.7328987717628479,0.7301493883132935,0.727400004863739,0.7246506214141846,0.7219012379646301,0.7191518545150757,0.7164024710655212,0.713653028011322,0.7109036445617676,0.7081543207168579,0.7054048776626587,0.7026554942131042,0.6999061107635498,0.6971567273139954],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.0577133484184742],"y":[1.3817541599273682],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[1.9229854345321655],"y":[0.6971567273139954],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.4394192397594452,-0.42731940746307373,-0.4152195155620575,-0.40311965346336365,-0.3910197913646698,-0.37891992926597595,-0.3668200969696045,-0.35472023487091064,-0.3426203429698944,-0.33052051067352295,-0.3184206485748291,-0.30632078647613525,-0.2942209243774414,-0.28212106227874756,-0.2700212001800537,-0.25792133808135986,-0.2458214908838272,-0.23372161388397217,-0.22162175178527832,-0.20952190458774567,-0.19742201268672943,-0.18532218039035797,-0.17322233319282532,-0.16112244129180908,-0.14902259409427643,-0.13692274689674377,-0.12482285499572754,-0.11272302269935608,-0.10062319040298462,-0.08852329850196838,-0.07642343640327454,-0.06432357430458069,-0.05222371220588684,-0.04012385010719299,-0.028023988008499146,-0.015924155712127686,-0.00382426381111145,0.008275598287582397,0.020375460386276245,0.03247526288032532,0.04457515478134155,0.056675076484680176,0.06877487897872925,0.08087471127510071,0.09297460317611694,0.10507449507713318,0.11717429757118225,0.1292741894721985,0.14137405157089233,0.1534738838672638,0.16557380557060242,0.1776736080646515,0.18977349996566772,0.20187339186668396,0.21397319436073303,0.2260729968547821,0.23817291855812073,0.25027281045913696,0.26237261295318604,0.27447250485420227,0.2865723669528961,0.29867225885391235,0.3107720911502838,0.3228719234466553,0.3349717855453491,0.34707167744636536,0.3591715693473816,0.37127137184143066,0.3833712935447693,0.39547115564346313,0.40757089853286743,0.41967079043388367,0.4317706823348999,0.44387057423591614,0.4559704661369324,0.46807026863098145,0.4801701307296753,0.49226999282836914,0.5043697953224182,0.5164697170257568,0.5285695791244507,0.5406694412231445,0.5527693033218384,0.5648691058158875,0.5769690275192261,0.5890688896179199,0.601168692111969,0.6132685542106628,0.6253684759140015,0.6374683380126953,0.6495682001113892,0.6616679430007935,0.6737678647041321,0.6858677864074707,0.697967529296875,0.7100675106048584,0.7221673727035522,0.7342672348022461,0.7463670969009399,0.7584668397903442,0.7705668210983276,0.7826666831970215,0.7947664260864258,0.8068662881851196,0.818966269493103,0.8310660719871521,0.8431659936904907,0.8552658557891846,0.8673655986785889,0.8794655799865723,0.8915652632713318,0.9036652445793152,0.9157650470733643,0.9278649687767029,0.9399648308753967,0.9520646333694458,0.9641644954681396,0.9762644171714783,0.9883642196655273,1.0004640817642212,1.012563943862915,1.0246638059616089,1.0367637872695923,1.048863410949707,1.0609633922576904,1.0730634927749634,1.0851633548736572,1.097262978553772,1.1093628406524658,1.1214628219604492,1.1335628032684326,1.145662546157837,1.1577624082565308,1.169862151145935,1.1819621324539185,1.1940619945526123,1.2061619758605957,1.21826171875,1.2303615808486938,1.2424615621566772,1.254561185836792,1.266661286354065,1.2787610292434692,1.2908607721328735,1.3029606342315674,1.3150606155395508,1.3271604776382446,1.3392603397369385,1.3513602018356323,1.3634599447250366,1.37555992603302,1.3876597881317139,1.3997596502304077,1.4118595123291016,1.4239592552185059,1.4360592365264893,1.4481589794158936,1.460258960723877,1.4723587036132812,1.484458565711975,1.496558427810669,1.5086582899093628,1.5207582712173462,1.53285813331604,1.5449578762054443,1.5570577383041382,1.5691577196121216,1.5812574625015259,1.5933574438095093,1.6054573059082031,1.6175569295883179,1.6296569108963013,1.6417567729949951,1.6538567543029785,1.6659564971923828,1.6780563592910767,1.690156102180481,1.7022560834884644,1.7143560647964478,1.7264559268951416,1.738555669784546,1.7506555318832397,1.7627555131912231,1.774855136871338,1.7869552373886108,1.7990549802780151,1.8111547231674194,1.8232547044754028,1.8353545665740967,1.84745454788208,1.8595542907714844,1.8716541528701782,1.8837538957595825,1.895853877067566,1.9079537391662598,1.9200537204742432,1.932153344154358,1.9442533254623413,1.9563531875610352,1.9684529304504395,1.9805529117584229,1.9926528930664062,2.0047526359558105,2.016852378845215,2.0289523601531982,2.0410523414611816,2.053152084350586,2.0652518272399902,2.0773518085479736,2.089451551437378,2.1015515327453613,2.1136512756347656,2.125751256942749,2.1378509998321533,2.1499509811401367,2.162050724029541,2.1741507053375244,2.1862504482269287,2.198350429534912,2.2104504108428955,2.2225501537323,2.234650135040283,2.2467496395111084,2.258849620819092,2.270949602127075,2.2830493450164795,2.295149326324463,2.3072493076324463,2.3193488121032715,2.331448793411255,2.3435487747192383,2.3556485176086426,2.367748498916626,2.3798484802246094,2.3919479846954346,2.404047966003418,2.4161477088928223,2.4282476902008057,2.440347671508789,2.4524474143981934,2.4645471572875977,2.476647138595581,2.4887468814849854,2.5008468627929688,2.512946844100952,2.5250465869903564,2.5371463298797607,2.549246311187744,2.5613462924957275,2.573446035385132],"y":[-0.06048274412751198,-0.06560422480106354,-0.0707256942987442,-0.07584717869758606,-0.08096864819526672,-0.08609013259410858,-0.09121160954236984,-0.0963330864906311,-0.10145456343889236,-0.10657604038715363,-0.11169751733541489,-0.11681899428367615,-0.121940478682518,-0.12706194818019867,-0.13218343257904053,-0.1373049020767212,-0.14242637157440186,-0.1475478559732437,-0.15266934037208557,-0.15779080986976624,-0.1629122942686081,-0.16803377866744995,-0.17315524816513062,-0.17827671766281128,-0.18339820206165314,-0.188519686460495,-0.19364115595817566,-0.19876262545585632,-0.20388412475585938,-0.20900559425354004,-0.2141270637512207,-0.21924854815006256,-0.22437001764774323,-0.22949150204658508,-0.23461297154426575,-0.2397344410419464,-0.24485592544078827,-0.24997740983963013,-0.2550988793373108,-0.26022034883499146,-0.2653418481349945,-0.27046331763267517,-0.27558478713035583,-0.2807062864303589,-0.28582775592803955,-0.2909492254257202,-0.29607072472572327,-0.30119216442108154,-0.3063136637210846,-0.31143516302108765,-0.3165566027164459,-0.321678102016449,-0.32679957151412964,-0.3319210708141327,-0.33704251050949097,-0.34216398000717163,-0.34728550910949707,-0.35240697860717773,-0.3575284481048584,-0.3626498878002167,-0.3677713871002197,-0.3728928864002228,-0.37801435589790344,-0.3831357955932617,-0.38825729489326477,-0.39337876439094543,-0.3985002636909485,-0.40362173318862915,-0.4087432026863098,-0.4138646721839905,-0.41898614168167114,-0.4241076409816742,-0.42922911047935486,-0.4343506097793579,-0.4394720792770386,-0.44459354877471924,-0.4497150182723999,-0.45483651757240295,-0.45995795726776123,-0.4650794565677643,-0.47020095586776733,-0.475322425365448,-0.48044389486312866,-0.4855653643608093,-0.4906868636608124,-0.49580833315849304,-0.5009297728538513,-0.5060513019561768,-0.5111727714538574,-0.5162942409515381,-0.5214157104492188,-0.5265371799468994,-0.5316586494445801,-0.5367801785469055,-0.5419016480445862,-0.5470230579376221,-0.5521445870399475,-0.5572660565376282,-0.5623875856399536,-0.5675089955329895,-0.5726304650306702,-0.5777519941329956,-0.5828734636306763,-0.5879949331283569,-0.5931164026260376,-0.5982378721237183,-0.6033594012260437,-0.6084808707237244,-0.6136022806167603,-0.6187238097190857,-0.6238452196121216,-0.628966748714447,-0.6340882182121277,-0.6392096877098083,-0.6443312168121338,-0.6494526267051697,-0.6545740962028503,-0.6596956253051758,-0.6648170351982117,-0.6699385643005371,-0.6750600337982178,-0.6801815032958984,-0.6853030323982239,-0.6904244422912598,-0.6955459713935852,-0.7006675004959106,-0.7057889699935913,-0.7109103798866272,-0.7160318493843079,-0.7211533784866333,-0.7262749075889587,-0.7313963770866394,-0.7365177869796753,-0.741639256477356,-0.7467607855796814,-0.7518821954727173,-0.7570037841796875,-0.7621251940727234,-0.7672466039657593,-0.7723681926727295,-0.7774896025657654,-0.7826111912727356,-0.7877326011657715,-0.7928540110588074,-0.797975480556488,-0.8030970096588135,-0.8082185983657837,-0.8133399486541748,-0.8184614181518555,-0.8235828876495361,-0.8287044167518616,-0.8338258266448975,-0.8389473557472229,-0.8440688252449036,-0.8491902947425842,-0.8543118238449097,-0.8594332337379456,-0.864554762840271,-0.8696762323379517,-0.8747977018356323,-0.8799191117286682,-0.8850406408309937,-0.8901621699333191,-0.8952836394309998,-0.9004050493240356,-0.9055265188217163,-0.9106480479240417,-0.9157695174217224,-0.9208910465240479,-0.9260124564170837,-0.9311339259147644,-0.9362554550170898,-0.9413769245147705,-0.9464983940124512,-0.9516198635101318,-0.9567413330078125,-0.9618628025054932,-0.9669842720031738,-0.9721058011054993,-0.9772272706031799,-0.9823487401008606,-0.9874702095985413,-0.9925916790962219,-0.9977131485939026,-1.002834677696228,-1.0079561471939087,-1.0130776166915894,-1.01819908618927,-1.0233204364776611,-1.0284420251846313,-1.033563494682312,-1.0386849641799927,-1.0438064336776733,-1.048927903175354,-1.0540494918823242,-1.0591708421707153,-1.0642924308776855,-1.0694137811660767,-1.0745352506637573,-1.0796568393707275,-1.0847783088684082,-1.0898997783660889,-1.0950212478637695,-1.1001427173614502,-1.1052641868591309,-1.1103856563568115,-1.1155071258544922,-1.1206285953521729,-1.1257500648498535,-1.1308716535568237,-1.1359931230545044,-1.1411144733428955,-1.1462360620498657,-1.1513574123382568,-1.156479001045227,-1.1616004705429077,-1.1667219400405884,-1.171843409538269,-1.1769648790359497,-1.1820863485336304,-1.187207818031311,-1.1923292875289917,-1.197450876235962,-1.202572226524353,-1.2076936960220337,-1.212815284729004,-1.217936635017395,-1.2230582237243652,-1.228179693222046,-1.233301043510437,-1.2384226322174072,-1.243544101715088,-1.2486655712127686,-1.2537870407104492,-1.2589085102081299,-1.2640300989151,-1.2691514492034912,-1.2742729187011719,-1.279394507408142,-1.2845158576965332,-1.2896374464035034,-1.294758915901184,-1.2998802661895752,-1.3050018548965454,-1.310123324394226,-1.3152446746826172,-1.3203662633895874,-1.3254876136779785,-1.3306093215942383,-1.3357306718826294],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.4394192397594452],"y":[-0.06048274412751198],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[2.573446035385132],"y":[-1.3357306718826294],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.6270624399185181,0.6217389106750488,0.6164153218269348,0.6110918521881104,0.6057682633399963,0.6004447340965271,0.5951211452484131,0.5897976756095886,0.5844740867614746,0.5791505575180054,0.5738269686698914,0.5685034990310669,0.5631799697875977,0.5578563809394836,0.5525328516960144,0.5472092628479004,0.5418857932090759,0.5365622639656067,0.5312386751174927,0.5259151458740234,0.5205916166305542,0.515268087387085,0.509944498538971,0.5046209096908569,0.4992974102497101,0.49397391080856323,0.4886503219604492,0.48332682251930237,0.47800329327583313,0.4726797342300415,0.46735620498657227,0.46203261613845825,0.4567091166973114,0.4513855278491974,0.44606202840805054,0.4407384395599365,0.4354149401187897,0.43009135127067566,0.4247678518295288,0.41944432258605957,0.41412076354026794,0.40879717469215393,0.4034736752510071,0.39815014600753784,0.392826646566391,0.387503057718277,0.3821795582771301,0.3768559694290161,0.3715323805809021,0.36620888113975525,0.3608853220939636,0.3555617928504944,0.35023826360702515,0.34491467475891113,0.33959120512008667,0.33426764607429504,0.3289440870285034,0.3236204981803894,0.31829699873924255,0.3129734694957733,0.3076499402523041,0.30232638120651245,0.2970028519630432,0.2916792631149292,0.28635576367378235,0.2810322046279907,0.2757086753845215,0.27038514614105225,0.26506155729293823,0.259738028049469,0.25441452860832214,0.2490909844636917,0.2437674105167389,0.23844385147094727,0.23312030732631683,0.22779680788516998,0.22247324883937836,0.21714970469474792,0.2118261754512787,0.20650263130664825,0.20117907226085663,0.19585555791854858,0.19053196907043457,0.18520846962928772,0.1798848956823349,0.17456136643886566,0.16923783719539642,0.16391432285308838,0.15859074890613556,0.15326716005802155,0.1479436457157135,0.14262014627456665,0.13729658722877502,0.131972998380661,0.12664949893951416,0.12132593989372253,0.1160024106502533,0.11067888140678406,0.10535532236099243,0.1000317931175232,0.09470823407173157,0.08938467502593994,0.08406117558479309,0.07873764634132385,0.07341408729553223,0.06809049844741821,0.06276696920394897,0.057443439960479736,0.052119940519332886,0.04679635167121887,0.04147285223007202,0.03614926338195801,0.030825763940811157,0.02550220489501953,0.020178616046905518,0.014855116605758667,0.009531527757644653,0.004208028316497803,-0.0011154711246490479,-0.006439030170440674,-0.011762619018554688,-0.017086148262023926,-0.022409707307815552,-0.027733206748962402,-0.03305676579475403,-0.03838038444519043,-0.04370391368865967,-0.04902741312980652,-0.05435094237327576,-0.05967450141906738,-0.06499812006950378,-0.07032164931297302,-0.07564514875411987,-0.08096864819526672,-0.08629223704338074,-0.09161573648452759,-0.09693935513496399,-0.10226288437843323,-0.10758638381958008,-0.11290997266769409,-0.11823347210884094,-0.12355706095695496,-0.1288805603981018,-0.13420408964157104,-0.1395275890827179,-0.1448512077331543,-0.15017476677894592,-0.15549829602241516,-0.160821795463562,-0.16614532470703125,-0.17146892845630646,-0.1767924427986145,-0.18211601674556732,-0.18743953108787537,-0.1927630454301834,-0.19808661937713623,-0.20341013371944427,-0.20873373746871948,-0.21405725181102753,-0.21938076615333557,-0.22470428049564362,-0.23002785444259644,-0.23535147309303284,-0.2406749725341797,-0.24599848687648773,-0.2513220012187958,-0.2566455900669098,-0.26196908950805664,-0.26729270815849304,-0.2726162075996399,-0.27793973684310913,-0.28326332569122314,-0.28858682513237,-0.2939103841781616,-0.29923391342163086,-0.3045574426651001,-0.30988094210624695,-0.31520456075668335,-0.320528119802475,-0.3258516788482666,-0.33117514848709106,-0.3364986777305603,-0.3418222665786743,-0.3471457362174988,-0.35246938467025757,-0.35779285430908203,-0.36311641335487366,-0.3684399724006653,-0.37376347184181213,-0.37908706068992615,-0.3844106197357178,-0.38973408937454224,-0.3950576186180115,-0.4003812074661255,-0.4057047963142395,-0.41102832555770874,-0.4163517951965332,-0.42167535424232483,-0.42699891328811646,-0.4323224723339081,-0.4376460313796997,-0.44296953082084656,-0.4482930898666382,-0.4536166489124298,-0.45894014835357666,-0.46426376700401306,-0.4695872664451599,-0.47491079568862915,-0.4802342653274536,-0.4855578541755676,-0.4908815026283264,-0.4962049722671509,-0.5015285015106201,-0.5068520307540894,-0.5121755599975586,-0.5174991488456726,-0.5228227376937866,-0.5281462669372559,-0.5334697365760803,-0.5387933254241943,-0.5441168546676636,-0.5494404435157776,-0.554763913154602,-0.5600874423980713,-0.5654110312461853,-0.5707345604896545,-0.576058030128479,-0.581381618976593,-0.586705207824707,-0.5920286774635315,-0.5973523259162903,-0.6026757955551147,-0.6079993844032288,-0.613322913646698,-0.6186463832855225,-0.6239699721336365,-0.6292935013771057,-0.6346170902252197,-0.639940619468689,-0.6452640891075134,-0.6505876779556274,-0.6559112071990967,-0.6612347364425659,-0.6665583252906799,-0.6718818545341492,-0.6772053837776184,-0.6825289726257324,-0.6878524422645569,-0.6931760311126709,-0.6984995603561401],"y":[-0.25931912660598755,-0.2545807957649231,-0.24984246492385864,-0.2451041340827942,-0.24036580324172974,-0.23562747240066528,-0.23088914155960083,-0.22615081071853638,-0.22141247987747192,-0.21667414903640747,-0.21193580329418182,-0.20719747245311737,-0.20245914161205292,-0.19772081077098846,-0.192982479929924,-0.18824414908885956,-0.1835058182477951,-0.17876748740673065,-0.1740291565656662,-0.16929082572460175,-0.1645524799823761,-0.15981414914131165,-0.1550758183002472,-0.15033748745918274,-0.1455991566181183,-0.14086082577705383,-0.13612249493598938,-0.13138416409492493,-0.12664583325386047,-0.12190750241279602,-0.11716917157173157,-0.11243082582950592,-0.10769250988960266,-0.10295417159795761,-0.09821584820747375,-0.0934775173664093,-0.08873917162418365,-0.0840008407831192,-0.07926252484321594,-0.07452419400215149,-0.06978584825992584,-0.0650475025177002,-0.060309186577796936,-0.05557087063789368,-0.05083252489566803,-0.04609419405460358,-0.041355863213539124,-0.03661751747131348,-0.03187920153141022,-0.02714085578918457,-0.022402524948120117,-0.017664209008216858,-0.012925863265991211,-0.008187532424926758,-0.0034492164850234985,0.0012891143560409546,0.0060274600982666016,0.010765805840492249,0.015504136681556702,0.020242437720298767,0.024980783462524414,0.029719114303588867,0.03445744514465332,0.03919579088687897,0.04393410682678223,0.048672452569007874,0.05341079831123352,0.058149099349975586,0.06288744509220123,0.06762577593326569,0.07236409187316895,0.0771024227142334,0.08184075355529785,0.08657912909984589,0.09131745994091034,0.09605574607849121,0.10079407691955566,0.1055324524641037,0.11027073860168457,0.11500908434391022,0.11974743008613586,0.12448576092720032,0.12922410666942596,0.13396239280700684,0.13870076835155487,0.14343909919261932,0.1481773853302002,0.15291574597358704,0.1576540768146515,0.16239242255687714,0.1671307533979416,0.17186906933784485,0.1766074001789093,0.18134574592113495,0.1860840618610382,0.19082240760326385,0.1955607384443283,0.20029905438423157,0.2050374299287796,0.20977571606636047,0.21451406180858612,0.21925239264965057,0.22399070858955383,0.2287290394306183,0.23346738517284393,0.23820574581623077,0.24294407665729523,0.2476823627948761,0.25242069363594055,0.2571590542793274,0.26189735531806946,0.2666357159614563,0.27137404680252075,0.2761123776435852,0.28085070848464966,0.2855890095233917,0.29032737016677856,0.295065701007843,0.2998040020465851,0.3045423626899719,0.3092806935310364,0.31401902437210083,0.3187573552131653,0.32349568605422974,0.3282340168952942,0.3329724371433258,0.33771073818206787,0.3424490690231323,0.347187340259552,0.35192573070526123,0.35666409134864807,0.3614024221897125,0.3661407232284546,0.37087899446487427,0.3756174147129059,0.38035571575164795,0.3850940763950348,0.38983237743377686,0.39457064867019653,0.39930903911590576,0.4040473997592926,0.40878576040267944,0.4135240614414215,0.4182623624801636,0.42300063371658325,0.4277390241622925,0.4324773848056793,0.43721574544906616,0.4419540464878082,0.4466923475265503,0.45143070816993713,0.4561690092086792,0.46090736985206604,0.4656456708908081,0.47038400173187256,0.4751223921775818,0.47986069321632385,0.4845990538597107,0.48933735489845276,0.4940756559371948,0.4988139867782593,0.5035523772239685,0.5082907676696777,0.5130290389060974,0.5177673101425171,0.5225056409835815,0.527243971824646,0.5319823026657104,0.5367207527160645,0.5414590239524841,0.5461972951889038,0.550935685634613,0.5556739568710327,0.5604123473167419,0.5651506185531616,0.5698890089988708,0.5746272802352905,0.5793656706809998,0.584104061126709,0.5888423323631287,0.5935806035995483,0.5983189344406128,0.6030573844909668,0.6077956557273865,0.6125340461730957,0.6172723174095154,0.6220105886459351,0.6267489790916443,0.631487250328064,0.636225700378418,0.6409639716148376,0.6457023024559021,0.6504405736923218,0.655178964138031,0.6599173545837402,0.6646556258201599,0.6693939566612244,0.6741322875022888,0.6788706183433533,0.6836089491844177,0.688347339630127,0.6930856108665466,0.6978238821029663,0.7025623321533203,0.70730060338974,0.7120389938354492,0.7167773246765137,0.7215155959129333,0.726253867149353,0.7309922575950623,0.7357306480407715,0.7404689788818359,0.7452072501182556,0.7499455809593201,0.7546839714050293,0.759422242641449,0.7641606330871582,0.7688989043235779,0.7736372351646423,0.7783756256103516,0.7831138968467712,0.7878522872924805,0.7925906181335449,0.7973288893699646,0.8020672798156738,0.8068056106567383,0.811543881893158,0.8162822723388672,0.8210205435752869,0.8257588744163513,0.8304972648620605,0.8352355360984802,0.8399739861488342,0.8447122573852539,0.8494505286216736,0.8541889190673828,0.8589271903038025,0.8636655807495117,0.8684039115905762,0.8731422424316406,0.8778806328773499,0.8826189041137695,0.8873571753501892,0.8920955657958984,0.8968338370323181,0.9015721678733826,0.9063106179237366,0.9110488891601562,0.9157872796058655,0.9205255508422852],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.6270624399185181],"y":[-0.25931912660598755],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.6984995603561401],"y":[0.9205255508422852],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.39554065465927124,-0.4031287133693695,-0.410716712474823,-0.41830477118492126,-0.42589282989501953,-0.4334808588027954,-0.4410689175128937,-0.44865691661834717,-0.45624497532844543,-0.4638330042362213,-0.4714210629463196,-0.47900909185409546,-0.4865971505641937,-0.4941851794719696,-0.5017732381820679,-0.5093612670898438,-0.5169492959976196,-0.5245373249053955,-0.5321253538131714,-0.5397133827209473,-0.5473014116287231,-0.5548895001411438,-0.5624775290489197,-0.5700655579566956,-0.5776535868644714,-0.5852416753768921,-0.592829704284668,-0.6004177331924438,-0.6080057621002197,-0.6155937910079956,-0.6231818199157715,-0.6307698488235474,-0.638357937335968,-0.6459460258483887,-0.6535340547561646,-0.6611220240592957,-0.6687101125717163,-0.6762981414794922,-0.6838861703872681,-0.691474199295044,-0.6990622282028198,-0.7066502571105957,-0.7142382860183716,-0.7218263149261475,-0.7294144034385681,-0.7370024919509888,-0.7445905208587646,-0.7521784901618958,-0.7597665786743164,-0.7673546075820923,-0.7749426364898682,-0.782530665397644,-0.7901186943054199,-0.7977067828178406,-0.8052948117256165,-0.8128829002380371,-0.820470929145813,-0.8280588984489441,-0.8356469869613647,-0.8432350158691406,-0.8508230447769165,-0.8584111332893372,-0.8659991025924683,-0.8735871315002441,-0.8811752796173096,-0.8887633085250854,-0.8963513374328613,-0.9039392471313477,-0.9115273952484131,-0.919115424156189,-0.9267033934593201,-0.9342914819717407,-0.9418795108795166,-0.9494675397872925,-0.9570556879043579,-0.9646435976028442,-0.9722316861152649,-0.9798197746276855,-0.9874077439308167,-0.9949957728385925,-1.0025838613510132,-1.010171890258789,-1.017759919166565,-1.0253479480743408,-1.0329359769821167,-1.0405240058898926,-1.0481120347976685,-1.0557000637054443,-1.0632882118225098,-1.0708762407302856,-1.0784642696380615,-1.0860522985458374,-1.0936403274536133,-1.1012283563613892,-1.108816385269165,-1.116404414176941,-1.1239924430847168,-1.1315805912017822,-1.1391685009002686,-1.146756649017334,-1.1543446779251099,-1.1619327068328857,-1.1695207357406616,-1.1771087646484375,-1.1846967935562134,-1.1922848224639893,-1.1998729705810547,-1.207460880279541,-1.2150490283966064,-1.2226369380950928,-1.2302250862121582,-1.2378129959106445,-1.24540114402771,-1.2529892921447754,-1.2605772018432617,-1.268165111541748,-1.2757532596588135,-1.283341407775879,-1.2909293174743652,-1.2985174655914307,-1.306105375289917,-1.3136935234069824,-1.3212815523147583,-1.3288695812225342,-1.33645761013031,-1.3440457582473755,-1.3516337871551514,-1.3592216968536377,-1.3668098449707031,-1.374397873878479,-1.3819860219955444,-1.3895739316940308,-1.3971619606018066,-1.404749870300293,-1.412338137626648,-1.4199261665344238,-1.4275141954421997,-1.4351022243499756,-1.442690134048462,-1.4502782821655273,-1.4578663110733032,-1.4654544591903687,-1.473042368888855,-1.4806303977966309,-1.4882184267044067,-1.4958064556121826,-1.503394603729248,-1.510982632637024,-1.5185706615447998,-1.5261585712432861,-1.5337467193603516,-1.541334629058838,-1.5489228963851929,-1.5565109252929688,-1.564098834991455,-1.5716869831085205,-1.5792748928070068,-1.5868630409240723,-1.5944509506225586,-1.602039098739624,-1.6096271276474,-1.6172151565551758,-1.6248033046722412,-1.6323912143707275,-1.6399792432785034,-1.6475671529769897,-1.6551554203033447,-1.662743330001831,-1.6703314781188965,-1.6779193878173828,-1.6855074167251587,-1.6930956840515137,-1.70068359375,-1.7082717418670654,-1.7158596515655518,-1.7234476804733276,-1.7310357093811035,-1.7386237382888794,-1.7462118864059448,-1.7537999153137207,-1.7613879442214966,-1.768975853919983,-1.7765640020370483,-1.7841519117355347,-1.7917401790618896,-1.799328088760376,-1.8069161176681519,-1.8145041465759277,-1.8220921754837036,-1.8296802043914795,-1.837268352508545,-1.8448563814163208,-1.8524442911148071,-1.8600324392318726,-1.8676204681396484,-1.8752084970474243,-1.8827965259552002,-1.890384554862976,-1.8979727029800415,-1.9055606126785278,-1.9131487607955933,-1.9207366704940796,-1.9283246994018555,-1.935912847518921,-1.9435008764266968,-1.9510889053344727,-1.9586769342422485,-1.9662649631500244,-1.9738528728485107,-1.9814411401748657,-1.9890291690826416,-1.9966171979904175,-2.0042052268981934,-2.0117931365966797,-2.019381284713745,-2.0269694328308105,-2.034557342529297,-2.0421454906463623,-2.0497331619262695,-2.057321548461914,-2.0649094581604004,-2.072497606277466,-2.080085515975952,-2.0876736640930176,-2.095261812210083,-2.1028497219085693,-2.1104378700256348,-2.118025779724121,-2.1256136894226074,-2.1332015991210938,-2.1407899856567383,-2.1483778953552246,-2.15596604347229,-2.1635541915893555,-2.171142101287842,-2.178730010986328,-2.1863179206848145,-2.193906307220459,-2.2014942169189453,-2.2090821266174316,-2.216670274734497,-2.2242584228515625,-2.231846332550049,-2.2394344806671143,-2.2470226287841797,-2.254610538482666,-2.2621984481811523,-2.2697863578796387,-2.277374744415283,-2.2849626541137695],"y":[-0.6379141807556152,-0.630881130695343,-0.623848021030426,-0.616814911365509,-0.609781801700592,-0.6027487516403198,-0.5957157015800476,-0.5886825919151306,-0.5816495418548584,-0.5746164917945862,-0.5675833821296692,-0.5605502724647522,-0.55351722240448,-0.546484112739563,-0.539451003074646,-0.532417893409729,-0.5253849029541016,-0.5183518528938293,-0.5113187432289124,-0.5042856335639954,-0.49725252389907837,-0.49021947383880615,-0.48318636417388916,-0.47615325450897217,-0.46912023425102234,-0.4620871841907501,-0.45505407452583313,-0.44802096486091614,-0.4409879446029663,-0.4339548349380493,-0.4269217848777771,-0.4198886752128601,-0.4128555655479431,-0.4058225154876709,-0.3987894058227539,-0.3917563259601593,-0.3847232162952423,-0.3776901662349701,-0.37065714597702026,-0.36362403631210327,-0.3565909266471863,-0.3495578169822693,-0.34252476692199707,-0.33549168705940247,-0.32845860719680786,-0.32142549753189087,-0.31439247727394104,-0.30735939741134644,-0.30032628774642944,-0.2932932376861572,-0.28626012802124023,-0.27922701835632324,-0.27219390869140625,-0.26516085863113403,-0.2581278085708618,-0.2510947287082672,-0.24406161904335022,-0.23702850937843323,-0.2299954891204834,-0.2229624092578888,-0.2159293293952942,-0.2088962197303772,-0.2018631398677826,-0.194830060005188,-0.18779700994491577,-0.18076393008232117,-0.17373082041740417,-0.16669777035713196,-0.15966463088989258,-0.15263155102729797,-0.14559850096702576,-0.13856545090675354,-0.13153234124183655,-0.12449923157691956,-0.11746615171432495,-0.11043310165405273,-0.10340002179145813,-0.09636691212654114,-0.08933386206626892,-0.08230075240135193,-0.07526770234107971,-0.06823462247848511,-0.061201512813568115,-0.0541684627532959,-0.047135353088378906,-0.0401022732257843,-0.03306925296783447,-0.026036173105239868,-0.01900303363800049,-0.011969923973083496,-0.004936844110488892,0.002096205949783325,0.00912928581237793,0.016162395477294922,0.02319541573524475,0.030228525400161743,0.03726160526275635,0.04429468512535095,0.051327794790267944,0.05836084485054016,0.06539395451545715,0.07242703437805176,0.07946005463600159,0.08649313449859619,0.09352624416351318,0.10055935382843018,0.10759246349334717,0.114625483751297,0.1216585636138916,0.12869170308113098,0.1357247233390808,0.1427578330039978,0.1497909128665924,0.156823992729187,0.163857102394104,0.17089012265205383,0.17792323231697083,0.18495634198188782,0.19198936223983765,0.19902244210243225,0.20605555176734924,0.21308866143226624,0.22012174129486084,0.22715482115745544,0.23418787121772766,0.2412211000919342,0.24825409054756165,0.25528717041015625,0.2623201906681061,0.26935335993766785,0.27638646960258484,0.28341954946517944,0.2904525697231293,0.2974856197834015,0.30451878905296326,0.3115518093109131,0.31858497858047485,0.3256179988384247,0.3326510787010193,0.3396841883659363,0.3467172384262085,0.3537503778934479,0.3607834279537201,0.3678164482116699,0.3748495280742645,0.3818826377391815,0.3889158070087433,0.3959488272666931,0.40298187732696533,0.41001489758491516,0.41704806685447693,0.42408108711242676,0.4311142563819885,0.43814733624458313,0.44518035650253296,0.4522135257720947,0.45924651622772217,0.46627968549728394,0.47331270575523376,0.48034578561782837,0.4873787760734558,0.4944119453430176,0.5014450550079346,0.5084781646728516,0.515511155128479,0.522544264793396,0.529577374458313,0.5366104245185852,0.5436435341835022,0.5506765842437744,0.5577096343040466,0.5647428035736084,0.5717757940292358,0.5788089632987976,0.5858420133590698,0.592875063419342,0.5999081134796143,0.6069412231445312,0.613974392414093,0.6210074424743652,0.6280404925346375,0.6350735425949097,0.6421066522598267,0.6491397023200989,0.6561728715896606,0.6632058620452881,0.6702389717102051,0.6772720813751221,0.6843051314353943,0.691338300704956,0.6983712911605835,0.7054043412208557,0.7124373912811279,0.7194705605506897,0.7265036702156067,0.7335367798805237,0.7405697703361511,0.7476028203964233,0.7546359300613403,0.7616690397262573,0.7687021493911743,0.7757351994514465,0.7827682495117188,0.7898014187812805,0.796834409236908,0.8038675785064697,0.8109005689620972,0.8179336786270142,0.8249666690826416,0.8319998383522034,0.8390330076217651,0.8460660576820374,0.8530991077423096,0.860132098197937,0.8671652674674988,0.874198317527771,0.8812314867973328,0.8882644772529602,0.8952975273132324,0.9023306369781494,0.9093637466430664,0.9163968563079834,0.9234299063682556,0.9304629564285278,0.9374960660934448,0.944529116153717,0.9515621662139893,0.9585952758789062,0.9656283855438232,0.9726614356040955,0.9796945452690125,0.9867276549339294,0.9937607645988464,1.0007938146591187,1.0078269243240356,1.0148600339889526,1.02189302444458,1.028926134109497,1.035959243774414,1.0429922342300415,1.050025463104248,1.0570584535598755,1.064091444015503,1.07112455368042,1.078157663345337,1.085190773010254,1.092223882675171,1.0992568731307983,1.1062899827957153,1.1133230924606323],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.39554065465927124],"y":[-0.6379141807556152],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-2.2849626541137695],"y":[1.1133230924606323],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.6127780079841614,0.6120447516441345,0.6113115549087524,0.6105782985687256,0.6098451018333435,0.6091118454933167,0.6083786487579346,0.6076453924179077,0.6069121956825256,0.6061789393424988,0.6054457426071167,0.6047124862670898,0.6039792895317078,0.6032460331916809,0.6025128364562988,0.601779580116272,0.6010463833808899,0.600313127040863,0.599579930305481,0.5988466739654541,0.598113477230072,0.5973802208900452,0.5966470241546631,0.5959137678146362,0.5951805710792542,0.5944473743438721,0.5937141180038452,0.5929808616638184,0.592247724533081,0.5915144085884094,0.5907812714576721,0.5900479555130005,0.5893147587776184,0.5885815620422363,0.5878483057022095,0.5871151089668274,0.5863818526268005,0.5856485962867737,0.5849154591560364,0.5841822028160095,0.5834490060806274,0.5827156901359558,0.5819824934005737,0.5812492966651917,0.5805160999298096,0.5797828435897827,0.5790495872497559,0.578316330909729,0.5775831341743469,0.5768499374389648,0.576116681098938,0.5753834843635559,0.574650228023529,0.573917031288147,0.5731837749481201,0.572450578212738,0.5717173218727112,0.5709840655326843,0.5702508687973022,0.5695176720619202,0.5687844157218933,0.5680512189865112,0.5673179626464844,0.5665847063064575,0.5658515095710754,0.5651183128356934,0.5643850564956665,0.5636518597602844,0.5629186034202576,0.5621854066848755,0.5614521503448486,0.5607189536094666,0.5599856972694397,0.5592524409294128,0.5585192441940308,0.5577859878540039,0.5570528507232666,0.5563195943832397,0.5555863380432129,0.554853081703186,0.554119884967804,0.5533866882324219,0.552653431892395,0.5519201755523682,0.5511869788169861,0.550453782081604,0.5497205257415771,0.5489873290061951,0.5482540726661682,0.5475208759307861,0.5467876195907593,0.5460544228553772,0.5453212261199951,0.5445879697799683,0.5438547134399414,0.5431214570999146,0.5423883199691772,0.5416550636291504,0.5409218072891235,0.5401886105537415,0.5394553542137146,0.5387221574783325,0.5379889011383057,0.5372557044029236,0.5365224480628967,0.5357892513275146,0.5350559949874878,0.5343227982521057,0.5335896015167236,0.5328563451766968,0.5321230888366699,0.5313898921012878,0.530656635761261,0.5299234390258789,0.529190182685852,0.52845698595047,0.5277237296104431,0.526990532875061,0.5262572765350342,0.5255240797996521,0.5247908234596252,0.5240576267242432,0.5233243703842163,0.5225911140441895,0.5218579769134521,0.5211247205734253,0.5203914642333984,0.5196582674980164,0.5189250111579895,0.5181918144226074,0.5174585580825806,0.5167253017425537,0.5159921050071716,0.5152589082717896,0.5145256519317627,0.5137924551963806,0.5130591988563538,0.5123260021209717,0.5115927457809448,0.5108595490455627,0.5101262927055359,0.5093930959701538,0.508659839630127,0.5079265832901001,0.5071934461593628,0.5064601898193359,0.5057269334793091,0.5049936771392822,0.5042604804039001,0.5035272836685181,0.5027940273284912,0.5020608305931091,0.5013275742530823,0.5005943775177002,0.4998611509799957,0.49912789463996887,0.4983946681022644,0.49766144156455994,0.49692821502685547,0.4961950182914734,0.49546176195144653,0.49472856521606445,0.4939953088760376,0.4932621121406555,0.49252888560295105,0.4917956590652466,0.4910624027252197,0.49032920598983765,0.4895959496498108,0.4888627529144287,0.48812949657440186,0.4873962998390198,0.4866630733013153,0.48592984676361084,0.48519662022590637,0.4844633936882019,0.48373016715049744,0.48299694061279297,0.4822636842727661,0.48153048753738403,0.4807972311973572,0.4800640344619751,0.47933080792427063,0.47859758138656616,0.4778643548488617,0.4771311283111572,0.47639787197113037,0.4756646752357483,0.47493141889572144,0.47419822216033936,0.4734649658203125,0.4727317690849304,0.47199854254722595,0.4712653160095215,0.47053205966949463,0.46979883313179016,0.4690656065940857,0.4683324098587036,0.46759915351867676,0.4668659567832947,0.4661327004432678,0.46539950370788574,0.4646662771701813,0.4639330506324768,0.46319982409477234,0.4624665677547455,0.4617333710193634,0.46100014448165894,0.46026691794395447,0.45953369140625,0.45880043506622314,0.45806723833084106,0.4573340117931366,0.45660078525543213,0.45586755871772766,0.4551343321800232,0.4544011056423187,0.45366787910461426,0.4529346227645874,0.4522014260292053,0.45146819949150085,0.4507349729537964,0.4500017464160919,0.44926851987838745,0.448535293340683,0.4478020668029785,0.44706884026527405,0.4463356137275696,0.4456023871898651,0.44486916065216064,0.4441359341144562,0.4434027075767517,0.44266948103904724,0.4419362545013428,0.4412030279636383,0.44046980142593384,0.43973657488822937,0.4390033483505249,0.43827012181282043,0.43753689527511597,0.4368036687374115,0.43607044219970703,0.43533721566200256,0.4346039891242981,0.43387076258659363,0.43313753604888916,0.4324043095111847,0.4316710829734802,0.43093785643577576,0.4302046298980713],"y":[0.4451395273208618,0.44856974482536316,0.4519999623298645,0.45543015003204346,0.4588603377342224,0.46229055523872375,0.4657207727432251,0.46915099024772644,0.4725812077522278,0.47601139545440674,0.4794415831565857,0.4828718304634094,0.48630204796791077,0.4897322356700897,0.49316245317459106,0.49659264087677,0.5000228881835938,0.5034530758857727,0.5068832635879517,0.5103135108947754,0.5137436389923096,0.5171738862991333,0.520604133605957,0.524034321308136,0.5274645090103149,0.5308947563171387,0.5343249440193176,0.5377551317214966,0.5411853790283203,0.5446155667304993,0.548045814037323,0.551476001739502,0.5549061894416809,0.5583364367485046,0.5617666244506836,0.5651968121528625,0.5686269998550415,0.5720572471618652,0.5754874348640442,0.5789176821708679,0.5823478698730469,0.5857780575752258,0.5892082452774048,0.5926384925842285,0.5960687398910522,0.5994989275932312,0.6029291152954102,0.6063593029975891,0.6097894906997681,0.6132197380065918,0.6166499853134155,0.6200801134109497,0.6235103607177734,0.6269406080245972,0.6303707957267761,0.6338009834289551,0.6372312307357788,0.6406614184379578,0.6440916061401367,0.6475217938423157,0.6509520411491394,0.6543822288513184,0.6578124761581421,0.6612426042556763,0.6646728515625,0.6681030988693237,0.6715332865715027,0.6749634742736816,0.6783937215805054,0.6818239688873291,0.6852540969848633,0.688684344291687,0.692114531993866,0.6955447196960449,0.6989749670028687,0.7024050951004028,0.7058353424072266,0.7092655897140503,0.7126957774162292,0.7161259651184082,0.7195562124252319,0.7229864597320557,0.7264165878295898,0.7298468351364136,0.7332770228385925,0.7367072701454163,0.7401374578475952,0.7435676455497742,0.7469978332519531,0.7504280805587769,0.7538583278656006,0.7572884559631348,0.7607187032699585,0.7641489505767822,0.7675790786743164,0.7710093259811401,0.7744395732879639,0.777869701385498,0.7812999486923218,0.7847301363945007,0.7881603837013245,0.7915905714035034,0.7950207591056824,0.7984510064125061,0.8018811941146851,0.805311381816864,0.8087416887283325,0.8121718168258667,0.8156020641326904,0.8190322518348694,0.8224624395370483,0.8258926868438721,0.829322874546051,0.83275306224823,0.8361833095550537,0.8396134376525879,0.8430436849594116,0.8464739322662354,0.8499040603637695,0.853334367275238,0.856764554977417,0.8601946830749512,0.8636249899864197,0.8670551180839539,0.8704854249954224,0.8739156126976013,0.877345860004425,0.8807759881019592,0.8842061758041382,0.8876364231109619,0.8910666704177856,0.8944969177246094,0.8979270458221436,0.9013572931289673,0.904787540435791,0.9082176685333252,0.9116479158401489,0.9150781035423279,0.9185082912445068,0.9219385385513306,0.9253687262535095,0.9287989735603333,0.9322291612625122,0.9356592893600464,0.9390895366668701,0.9425197839736938,0.9459500312805176,0.9493802189826965,0.9528104066848755,0.9562405943870544,0.9596708416938782,0.9631009697914124,0.9665312170982361,0.9699614644050598,0.9733916521072388,0.9768218994140625,0.9802520275115967,0.9836822748184204,0.9871125221252441,0.9905426502227783,0.993972897529602,0.9974031448364258,1.0008333921432495,1.0042635202407837,1.0076937675476074,1.0111238956451416,1.0145541429519653,1.017984390258789,1.0214145183563232,1.024844765663147,1.0282750129699707,1.0317052602767944,1.0351353883743286,1.0385656356811523,1.041995882987976,1.0454260110855103,1.048856258392334,1.0522863864898682,1.0557167530059814,1.0591468811035156,1.0625770092010498,1.0660072565078735,1.0694375038146973,1.0728676319122314,1.0762978792190552,1.079728126525879,1.0831583738327026,1.0865886211395264,1.0900187492370605,1.0934489965438843,1.0968791246414185,1.1003093719482422,1.1037395000457764,1.1071697473526,1.1105999946594238,1.1140302419662476,1.1174604892730713,1.120890498161316,1.1243208646774292,1.127751111984253,1.131181240081787,1.1346114873886108,1.138041615486145,1.1414718627929688,1.1449021100997925,1.1483323574066162,1.1517624855041504,1.1551926136016846,1.1586228609085083,1.162053108215332,1.1654833555221558,1.1689136028289795,1.1723437309265137,1.1757738590240479,1.1792042255401611,1.1826343536376953,1.186064600944519,1.1894947290420532,1.192924976348877,1.1963552236557007,1.1997853517532349,1.2032157182693481,1.2066457271575928,1.2100759744644165,1.2135063409805298,1.2169363498687744,1.2203665971755981,1.2237968444824219,1.2272270917892456,1.2306572198867798,1.2340874671936035,1.2375177145004272,1.240947961807251,1.2443780899047852,1.2478083372116089,1.251238465309143,1.2546687126159668,1.25809907913208,1.2615290880203247,1.2649593353271484,1.2683895826339722,1.2718197107315063,1.27524995803833,1.2786802053451538,1.2821104526519775,1.2855405807495117,1.2889708280563354,1.2924010753631592,1.2958312034606934,1.299261450767517],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.6127780079841614],"y":[0.4451395273208618],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.4302046298980713],"y":[1.299261450767517],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.9925490021705627,0.9963107109069824,1.0000723600387573,1.0038340091705322,1.0075956583023071,1.011357307434082,1.015118956565857,1.0188806056976318,1.0226422548294067,1.0264039039611816,1.0301655530929565,1.0339272022247314,1.037688970565796,1.0414505004882812,1.0452122688293457,1.0489739179611206,1.0527355670928955,1.05649733543396,1.0602588653564453,1.0640206336975098,1.0677821636199951,1.0715439319610596,1.0753055810928345,1.0790672302246094,1.0828288793563843,1.0865905284881592,1.090352177619934,1.094113826751709,1.0978755950927734,1.1016371250152588,1.1053988933563232,1.1091604232788086,1.112922191619873,1.116683840751648,1.1204454898834229,1.1242071390151978,1.1279687881469727,1.1317304372787476,1.1354920864105225,1.1392537355422974,1.1430153846740723,1.1467770338058472,1.1505388021469116,1.1543004512786865,1.1580621004104614,1.1618237495422363,1.1655853986740112,1.1693470478057861,1.173108696937561,1.1768704652786255,1.1806319952011108,1.1843936443328857,1.1881552934646606,1.191917061805725,1.1956787109375,1.199440360069275,1.2032020092010498,1.2069636583328247,1.2107253074645996,1.2144869565963745,1.2182486057281494,1.2220103740692139,1.2257719039916992,1.2295335531234741,1.233295202255249,1.2370569705963135,1.2408186197280884,1.2445802688598633,1.2483417987823486,1.252103567123413,1.2558653354644775,1.2596269845962524,1.2633886337280273,1.2671501636505127,1.2709119319915771,1.274673581123352,1.278435230255127,1.2821968793869019,1.2859585285186768,1.2897201776504517,1.2934818267822266,1.297243595123291,1.3010051250457764,1.3047668933868408,1.3085284233093262,1.3122901916503906,1.316051721572876,1.3198134899139404,1.3235751390457153,1.3273367881774902,1.3310984373092651,1.33486008644104,1.3386218547821045,1.3423833847045898,1.3461451530456543,1.3499066829681396,1.353668451309204,1.3574302196502686,1.361191749572754,1.3649535179138184,1.3687150478363037,1.3724768161773682,1.3762383460998535,1.380000114440918,1.3837616443634033,1.3875234127044678,1.3912850618362427,1.3950467109680176,1.398808479309082,1.4025700092315674,1.4063316583633423,1.4100933074951172,1.4138550758361816,1.4176167249679565,1.4213783740997314,1.4251399040222168,1.4289016723632812,1.4326633214950562,1.436424970626831,1.440186619758606,1.4439482688903809,1.4477099180221558,1.4514715671539307,1.4552332162857056,1.45899498462677,1.462756633758545,1.4665182828903198,1.4702799320220947,1.4740415811538696,1.4778032302856445,1.481564998626709,1.4853266477584839,1.4890882968902588,1.4928499460220337,1.4966115951538086,1.500373125076294,1.5041348934173584,1.5078965425491333,1.5116581916809082,1.5154199600219727,1.519181489944458,1.5229432582855225,1.5267049074172974,1.5304664373397827,1.5342280864715576,1.537989854812622,1.541751503944397,1.5455131530761719,1.5492748022079468,1.5530364513397217,1.5567982196807861,1.560559868812561,1.5643213987350464,1.5680830478668213,1.5718446969985962,1.5756064653396606,1.5793681144714355,1.5831297636032104,1.5868914127349854,1.5906530618667603,1.5944147109985352,1.5981764793395996,1.601938009262085,1.6056997776031494,1.6094613075256348,1.6132230758666992,1.6169847249984741,1.620746374130249,1.6245081424713135,1.6282696723937988,1.6320314407348633,1.6357929706573486,1.6395546197891235,1.643316388130188,1.647078037261963,1.6508396863937378,1.6546013355255127,1.6583629846572876,1.662124752998352,1.665886402130127,1.6696479320526123,1.6734095811843872,1.677171230316162,1.680932879447937,1.6846946477890015,1.6884562969207764,1.6922179460525513,1.6959795951843262,1.699741244316101,1.703502893447876,1.7072645425796509,1.7110261917114258,1.7147878408432007,1.7185494899749756,1.72231125831604,1.726072907447815,1.7298345565795898,1.7335962057113647,1.7373579740524292,1.7411195039749146,1.7448811531066895,1.7486428022384644,1.7524044513702393,1.7561662197113037,1.7599278688430786,1.7636895179748535,1.7674511671066284,1.7712128162384033,1.7749743461608887,1.7787361145019531,1.782497763633728,1.786259412765503,1.7900210618972778,1.7937827110290527,1.7975444793701172,1.801306128501892,1.805067777633667,1.8088293075561523,1.8125909566879272,1.8163527250289917,1.8201143741607666,1.823876142501831,1.8276376724243164,1.8313994407653809,1.8351610898971558,1.8389227390289307,1.8426843881607056,1.8464460372924805,1.8502076864242554,1.8539693355560303,1.8577309846878052,1.86149263381958,1.8652544021606445,1.8690160512924194,1.8727777004241943,1.8765393495559692,1.8803008794784546,1.884062647819519,1.887824296951294,1.8915859460830688,1.8953475952148438,1.8991092443466187,1.9028708934783936,1.906632661819458,1.910394310951233,1.9141558408737183,1.9179174900054932,1.921679139137268,1.9254409074783325,1.9292025566101074],"y":[-1.2472175359725952,-1.2398337125778198,-1.2324498891830444,-1.2250661849975586,-1.2176823616027832,-1.2102985382080078,-1.202914834022522,-1.1955310106277466,-1.1881471872329712,-1.1807634830474854,-1.1733795404434204,-1.1659958362579346,-1.1586120128631592,-1.1512281894683838,-1.143844485282898,-1.1364606618881226,-1.1290768384933472,-1.1216931343078613,-1.1143091917037964,-1.1069254875183105,-1.0995416641235352,-1.0921578407287598,-1.084774136543274,-1.0773903131484985,-1.0700064897537231,-1.0626227855682373,-1.0552388429641724,-1.0478551387786865,-1.0404713153839111,-1.0330874919891357,-1.02570378780365,-1.0183199644088745,-1.0109361410140991,-1.0035524368286133,-0.9961684942245483,-0.9887847900390625,-0.9814009666442871,-0.9740171432495117,-0.9666334390640259,-0.9592496156692505,-0.9518657922744751,-0.9444819688796997,-0.9370982646942139,-0.9297144412994385,-0.9223307371139526,-0.9149467945098877,-0.9075630903244019,-0.9001792669296265,-0.8927954435348511,-0.8854117393493652,-0.8780279159545898,-0.8706440925598145,-0.8632602691650391,-0.8558765649795532,-0.8484927415847778,-0.841109037399292,-0.8337252140045166,-0.8263412714004517,-0.8189575672149658,-0.8115738034248352,-0.8041900396347046,-0.7968062162399292,-0.7894223928451538,-0.7820386290550232,-0.7746548652648926,-0.7672710418701172,-0.7598872184753418,-0.7525034546852112,-0.7451196312904358,-0.7377358675003052,-0.7303521037101746,-0.722968339920044,-0.7155845165252686,-0.7082005739212036,-0.7008168697357178,-0.6934331059455872,-0.6860493421554565,-0.6786655187606812,-0.6712817549705505,-0.6638979315757751,-0.6565141677856445,-0.6491304039955139,-0.6417465209960938,-0.6343627572059631,-0.6269789338111877,-0.6195951700210571,-0.6122114062309265,-0.6048276424407959,-0.5974438190460205,-0.5900599956512451,-0.5826762318611145,-0.5752924084663391,-0.5679086446762085,-0.5605248212814331,-0.5531410574913025,-0.5457572340965271,-0.5383734703063965,-0.5309897065162659,-0.5236058831214905,-0.5162221193313599,-0.5088382363319397,-0.5014544725418091,-0.49407070875167847,-0.48668694496154785,-0.47930312156677246,-0.47191929817199707,-0.46453553438186646,-0.45715177059173584,-0.4497680068016052,-0.44238412380218506,-0.43500036001205444,-0.42761653661727905,-0.42023277282714844,-0.4128490090370178,-0.40546518564224243,-0.3980814218521118,-0.39069753885269165,-0.38331377506256104,-0.3759300410747528,-0.3685462474822998,-0.3611624240875244,-0.353778600692749,-0.3463948369026184,-0.3390110731124878,-0.3316273093223572,-0.32424333691596985,-0.3168596029281616,-0.309475839138031,-0.3020920753479004,-0.294708251953125,-0.2873243987560272,-0.2799406349658966,-0.2725569009780884,-0.26517313718795776,-0.2577892541885376,-0.250405490398407,-0.2430216372013092,-0.23563790321350098,-0.22825413942337036,-0.22087031602859497,-0.21348655223846436,-0.2061026394367218,-0.19871890544891357,-0.19133514165878296,-0.18395140767097473,-0.17656755447387695,-0.16918370127677917,-0.16179996728897095,-0.15441620349884033,-0.1470324695110321,-0.13964858651161194,-0.13226482272148132,-0.12488096952438354,-0.11749720573425293,-0.1101134717464447,-0.10272961854934692,-0.09534585475921631,-0.08796200156211853,-0.08057823777198792,-0.07319450378417969,-0.06581073999404907,-0.058426856994628906,-0.051043033599853516,-0.0436592698097229,-0.03627553582191467,-0.028891772031784058,-0.02150788903236389,-0.014124155044555664,-0.006740301847457886,0.0006434619426727295,0.008027225732803345,0.015411078929901123,0.02279481291770935,0.030178695917129517,0.03756245970726013,0.04494619369506836,0.052329957485198975,0.059713780879974365,0.06709766387939453,0.07448142766952515,0.08186516165733337,0.08924892544746399,0.09663277864456177,0.10401654243469238,0.11140039563179016,0.11878412961959839,0.126167893409729,0.13355174660682678,0.1409355103969574,0.14831936359405518,0.1557030975818634,0.16308686137199402,0.17047059535980225,0.1778544783592224,0.18523836135864258,0.1926220953464508,0.20000585913658142,0.20738959312438965,0.21477344632148743,0.22215721011161804,0.22954106330871582,0.23692482709884644,0.24430856108665466,0.25169241428375244,0.25907617807388306,0.26646003127098083,0.27384379506111145,0.28122755885124207,0.2886112928390503,0.29599517583847046,0.30337899923324585,0.31076282262802124,0.3181465268135071,0.3255302906036377,0.3329141139984131,0.3402978777885437,0.34768176078796387,0.3550654649734497,0.3624492287635803,0.3698330819606781,0.3772168457508087,0.38460075855255127,0.3919844627380371,0.3993682265281677,0.4067520499229431,0.41413581371307373,0.42151957750320435,0.4289034307003021,0.43628719449043274,0.44367095828056335,0.45105481147766113,0.45843857526779175,0.46582239866256714,0.47320616245269775,0.48058992624282837,0.48797377943992615,0.49535754323005676,0.5027413964271545,0.5101251602172852,0.5175089240074158,0.5248927474021912,0.5322765111923218,0.5396602749824524,0.5470440983772278,0.5544278621673584,0.561811625957489,0.5691955089569092,0.5765792727470398,0.5839630961418152,0.5913468599319458],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.9925490021705627],"y":[-1.2472175359725952],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[1.9292025566101074],"y":[0.5913468599319458],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[1.016144037246704,1.01007878780365,1.0040134191513062,0.997948169708252,0.991882860660553,0.985817551612854,0.9797523021697998,0.9736869931221008,0.9676217436790466,0.9615564346313477,0.9554911255836487,0.9494258761405945,0.9433606266975403,0.9372952580451965,0.9312300086021423,0.9251646995544434,0.9190994501113892,0.9130341410636902,0.9069688320159912,0.900903582572937,0.894838273525238,0.8887729644775391,0.8827077150344849,0.8766424059867859,0.8705770969390869,0.8645118474960327,0.858446478843689,0.8523812890052795,0.8463159799575806,0.8402506709098816,0.8341853618621826,0.8281200528144836,0.8220548033714294,0.8159895539283752,0.8099241852760315,0.8038589358329773,0.7977936267852783,0.7917283773422241,0.7856630682945251,0.779597818851471,0.773532509803772,0.7674671411514282,0.761401891708374,0.7553366422653198,0.7492713928222656,0.7432060241699219,0.7371407747268677,0.7310754060745239,0.7250102162361145,0.7189449071884155,0.7128795981407166,0.7068142890930176,0.7007490396499634,0.6946837306022644,0.6886184811592102,0.6825531721115112,0.6764878630638123,0.6704225540161133,0.6643573045730591,0.6582919955253601,0.6522267460823059,0.6461614370346069,0.6400961875915527,0.634030818939209,0.6279655694961548,0.6219003200531006,0.6158349514007568,0.6097697019577026,0.6037043333053589,0.5976391434669495,0.5915738344192505,0.5855085849761963,0.5794432163238525,0.5733779668807983,0.5673126578330994,0.5612474083900452,0.5551820993423462,0.549116849899292,0.543051540851593,0.536986231803894,0.5309209227561951,0.5248557329177856,0.5187903642654419,0.5127251148223877,0.506659746170044,0.5005944967269897,0.49452924728393555,0.48846396803855896,0.4823986291885376,0.47633329033851624,0.4702680706977844,0.46420279145240784,0.45813751220703125,0.4520721435546875,0.4460069537162781,0.4399416148662567,0.4338763356208801,0.42781102657318115,0.42174577713012695,0.415680468082428,0.409615159034729,0.40354984998703003,0.3974846601486206,0.39141935110092163,0.38535401225090027,0.3792886734008789,0.3732234537601471,0.3671581745147705,0.3610928952693939,0.35502755641937256,0.34896233677864075,0.3428969979286194,0.3368317186832428,0.3307664394378662,0.32470107078552246,0.31863588094711304,0.3125705122947693,0.3065052628517151,0.3004399836063385,0.2943747639656067,0.28830939531326294,0.28224408626556396,0.276178777217865,0.27011358737945557,0.2640482783317566,0.25798285007476807,0.2519175708293915,0.24585235118865967,0.23978710174560547,0.23372173309326172,0.22765642404556274,0.22159114480018616,0.21552589535713196,0.20946064591407776,0.2033953070640564,0.1973300278186798,0.19126471877098083,0.18519943952560425,0.17913419008255005,0.1730688512325287,0.1670035719871521,0.16093823313713074,0.15487298369407654,0.14880773425102234,0.14274245500564575,0.13667714595794678,0.13061177730560303,0.12454652786254883,0.11848127841949463,0.11241602897644043,0.10635066032409668,0.10028544068336487,0.09422007203102112,0.08815482258796692,0.08208957314491272,0.07602423429489136,0.06995895504951477,0.0638936460018158,0.05782836675643921,0.05176311731338501,0.04569786787033081,0.03963252902030945,0.0335671603679657,0.027501940727233887,0.0214366614818573,0.0153714120388031,0.009306073188781738,0.0032407939434051514,-0.002824544906616211,-0.00888979434967041,-0.01495504379272461,-0.02102041244506836,-0.02708563208580017,-0.03315100073814392,-0.03921625018119812,-0.04528149962425232,-0.05134674906730652,-0.05741211771965027,-0.06347742676734924,-0.06954270601272583,-0.07560795545578003,-0.08167320489883423,-0.08773854374885559,-0.09380382299423218,-0.09986913204193115,-0.10593441128730774,-0.11199966073036194,-0.1180649995803833,-0.1241302639245987,-0.13019561767578125,-0.13626085221767426,-0.14232611656188965,-0.14839138090610504,-0.1544567048549652,-0.16052205860614777,-0.16658732295036316,-0.17265255749225616,-0.17871782183647156,-0.1847831755876541,-0.19084841012954712,-0.19691376388072968,-0.20297902822494507,-0.20904426276683807,-0.21510961651802063,-0.22117488086223602,-0.2272402048110962,-0.23330546915531158,-0.23937073349952698,-0.24543599784374237,-0.25150132179260254,-0.2575666904449463,-0.2636319398880005,-0.2696971893310547,-0.2757624387741089,-0.28182780742645264,-0.28789305686950684,-0.2939583957195282,-0.3000236749649048,-0.3060888946056366,-0.31215423345565796,-0.31821951270103455,-0.3242848515510559,-0.3303501009941101,-0.3364153504371643,-0.34248068928718567,-0.34854596853256226,-0.35461121797561646,-0.36067652702331543,-0.366741806268692,-0.3728070855140686,-0.3788723945617676,-0.38493767380714417,-0.3910030126571655,-0.3970682621002197,-0.4031335115432739,-0.4091988801956177,-0.4152640998363495,-0.42132946848869324,-0.42739471793174744,-0.43345996737480164,-0.439525306224823,-0.4455905854701996,-0.4516558051109314,-0.45772117376327515,-0.46378642320632935,-0.46985167264938354,-0.4759170114994049,-0.4819822907447815,-0.48804759979248047,-0.49411287903785706],"y":[-0.034546054899692535,-0.033817108720541,-0.03308815881609917,-0.03235921636223793,-0.0316302664577961,-0.030901316553354263,-0.030172372236847878,-0.029443422332406044,-0.028714478015899658,-0.027985531836748123,-0.02725658193230629,-0.026527633890509605,-0.02579868771135807,-0.025069739669561386,-0.02434079349040985,-0.023611843585968018,-0.022882899269461632,-0.022153951227664948,-0.021425005048513412,-0.02069605514407158,-0.019967107102274895,-0.01923816092312336,-0.018509216606616974,-0.01778026670217514,-0.017051320523023605,-0.01632237434387207,-0.015593425370752811,-0.014864478260278702,-0.014135532081127167,-0.013406584039330482,-0.012677637860178947,-0.011948689818382263,-0.011219741776585579,-0.010490795597434044,-0.00976184755563736,-0.009032901376485825,-0.00830395333468914,-0.007575005292892456,-0.006846059113740921,-0.006117114797234535,-0.005388164892792702,-0.004659213125705719,-0.003930268809199333,-0.003201322630047798,-0.002472374588251114,-0.0017434265464544296,-0.0010144803673028946,-0.00028553232550621033,0.0004434138536453247,0.001172361895442009,0.0019013099372386932,0.002630254253745079,0.0033592041581869125,0.004088152199983597,0.004817096516489983,0.005546044558286667,0.006274992600083351,0.007003942504525185,0.0077328868210315704,0.008461833000183105,0.00919078104197979,0.009919730946421623,0.01064867340028286,0.011377623304724693,0.012106571346521378,0.012835517525672913,0.013564467430114746,0.014293411746621132,0.015022359788417816,0.0157513078302145,0.016480250284075737,0.01720919832587242,0.017938148230314255,0.018667098134756088,0.019396044313907623,0.02012498863041401,0.020853934809565544,0.021582884714007378,0.022311829030513763,0.023040777072310448,0.023769725114107132,0.024498676881194115,0.0252276249229908,0.025956569239497185,0.026685519143939018,0.027414465323090553,0.02814340963959694,0.028872357681393623,0.029601305723190308,0.03033025562763214,0.031059203669428825,0.03178814798593521,0.032517094165086746,0.03324604034423828,0.033974986523389816,0.03470393642783165,0.035432882606983185,0.03616183251142502,0.03689078241586685,0.03761972486972809,0.03834867477416992,0.03907762095332146,0.039806563407182693,0.04053550958633423,0.04126445949077606,0.041993409395217896,0.04272235929965973,0.043451305478811264,0.0441802479326725,0.04490920156240463,0.04563814401626587,0.046367090195417404,0.047096043825149536,0.04782498627901077,0.048553936183452606,0.04928288236260414,0.050011828541755676,0.05074077844619751,0.051469720900058746,0.05219866335391998,0.05292762070894241,0.05365656316280365,0.05438551306724548,0.05511445924639702,0.05584340542554855,0.056572362780570984,0.05730130895972252,0.058030255138874054,0.05875919759273529,0.059488147497177124,0.060217104852199554,0.06094604730606079,0.06167498975992203,0.062403932213783264,0.0631328821182251,0.06386183202266693,0.06459078192710876,0.06531972438097,0.06604866683483124,0.06677762418985367,0.0675065666437149,0.06823551654815674,0.06896446645259857,0.06969340890645981,0.07042235136032104,0.07115130126476288,0.0718802660703659,0.07260920107364655,0.07333814352750778,0.07406708598136902,0.07479604333639145,0.07552498579025269,0.07625394314527512,0.07698288559913635,0.07771182060241699,0.07844078540802002,0.07916972786188126,0.07989868521690369,0.08062762767076492,0.08135657012462616,0.0820855051279068,0.08281446993350983,0.08354341983795166,0.0842723622918129,0.08500130474567413,0.08573024719953537,0.0864592045545578,0.08718814700841904,0.08791709691286087,0.0886460393667221,0.08937498927116394,0.09010393917560577,0.09083288162946701,0.09156183898448944,0.09229078143835068,0.09301972389221191,0.09374866634607315,0.09447762370109558,0.09520657360553741,0.09593551605939865,0.09666445851325989,0.09739340096712112,0.09812235832214355,0.09885130077600479,0.09958025813102722,0.10030920058488846,0.1010381430387497,0.10176709294319153,0.10249603539705276,0.1032249927520752,0.10395393520593643,0.10468287765979767,0.1054118201136589,0.10614077746868134,0.10686972737312317,0.1075986698269844,0.10832761228084564,0.10905656218528748,0.10978551208972931,0.11051445454359055,0.11124341189861298,0.11197235435247421,0.11270129680633545,0.11343024671077728,0.11415918916463852,0.11488814651966095,0.11561708897352219,0.11634603142738342,0.11707497388124466,0.11780393123626709,0.11853288859128952,0.11926182359457016,0.11999078094959259,0.12071972340345383,0.12144866585731506,0.1221776083111763,0.12290657311677933,0.12363551557064056,0.1243644580245018,0.12509340047836304,0.12582235038280487,0.1265513002872467,0.12728025019168854,0.12800920009613037,0.128738135099411,0.12946708500385284,0.13019603490829468,0.1309249848127365,0.13165393471717834,0.13238286972045898,0.13311181962490082,0.13384076952934265,0.13456971943378448,0.13529866933822632,0.13602761924266815,0.1367565542459488,0.13748550415039062,0.13821446895599365,0.1389434039592743,0.13967235386371613,0.14040128886699677,0.1411302387714386,0.14185918867588043,0.14258813858032227,0.1433170884847641,0.14404602348804474,0.14477497339248657,0.1455039232969284,0.14623287320137024,0.14696182310581207],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[1.016144037246704],"y":[-0.034546054899692535],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.49411287903785706],"y":[0.14696182310581207],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.972781240940094,-0.9684568047523499,-0.9641323089599609,-0.9598078727722168,-0.9554833769798279,-0.951158881187439,-0.9468344449996948,-0.9425099492073059,-0.9381855130195618,-0.9338610768318176,-0.9295365810394287,-0.9252121448516846,-0.9208876490592957,-0.9165631532669067,-0.9122387170791626,-0.9079141616821289,-0.9035897254943848,-0.8992652893066406,-0.8949407935142517,-0.8906163573265076,-0.8862918615341187,-0.8819674253463745,-0.8776429891586304,-0.8733184933662415,-0.8689940571784973,-0.8646695613861084,-0.8603450655937195,-0.8560206294059753,-0.8516961932182312,-0.8473716974258423,-0.8430472612380981,-0.8387227654457092,-0.8343983292579651,-0.830073893070221,-0.825749397277832,-0.8214249014854431,-0.8171003460884094,-0.8127759099006653,-0.8084514737129211,-0.804127037525177,-0.7998025417327881,-0.7954780459403992,-0.791153609752655,-0.7868291735649109,-0.7825047373771667,-0.7781801819801331,-0.7738557457923889,-0.76953125,-0.7652068138122559,-0.7608823776245117,-0.7565578818321228,-0.7522334456443787,-0.7479089498519897,-0.7435845136642456,-0.7392600774765015,-0.7349356412887573,-0.7306110858917236,-0.7262865304946899,-0.7219620943069458,-0.7176376581192017,-0.7133132219314575,-0.7089887261390686,-0.7046642899513245,-0.7003397941589355,-0.6960153579711914,-0.6916908621788025,-0.6873663663864136,-0.6830419301986694,-0.6787174344062805,-0.6743929982185364,-0.6700685620307922,-0.6657441258430481,-0.6614196300506592,-0.6570951342582703,-0.6527706980705261,-0.6484462022781372,-0.6441217660903931,-0.6397972702980042,-0.63547283411026,-0.6311483383178711,-0.6268238425254822,-0.622499406337738,-0.6181749105453491,-0.613850474357605,-0.6095259785652161,-0.6052014827728271,-0.600877046585083,-0.5965526103973389,-0.59222811460495,-0.587903618812561,-0.5835791826248169,-0.5792547464370728,-0.5749303102493286,-0.5706058144569397,-0.5662813782691956,-0.5619568824768066,-0.5576323866844177,-0.5533079504966736,-0.5489834547042847,-0.5446590185165405,-0.5403345227241516,-0.5360100865364075,-0.5316855907440186,-0.5273611545562744,-0.5230366587638855,-0.5187121629714966,-0.5143876671791077,-0.5100632309913635,-0.5057387948036194,-0.5014142990112305,-0.49708986282348633,-0.4927653670310974,-0.48844093084335327,-0.48411646485328674,-0.4797919690608978,-0.4754675328731537,-0.47114303708076477,-0.46681857109069824,-0.4624941349029541,-0.45816969871520996,-0.45384520292282104,-0.44952070713043213,-0.4451962113380432,-0.4408717751502991,-0.43654733896255493,-0.43222278356552124,-0.4278983473777771,-0.42357391119003296,-0.41924944519996643,-0.4149249494075775,-0.4106004536151886,-0.40627598762512207,-0.40195155143737793,-0.3976270854473114,-0.3933025896549225,-0.38897815346717834,-0.38465362787246704,-0.3803291916847229,-0.37600475549697876,-0.37168025970458984,-0.3673558235168457,-0.3630313277244568,-0.35870683193206787,-0.35438239574432373,-0.3500579595565796,-0.3457334637641907,-0.34140896797180176,-0.33708450198173523,-0.3327600657939911,-0.32843562960624695,-0.32411113381385803,-0.3197866976261139,-0.3154621720314026,-0.31113770604133606,-0.3068132698535919,-0.302488774061203,-0.29816433787345886,-0.29383981227874756,-0.2895153760910034,-0.2851909399032593,-0.28086650371551514,-0.2765420079231262,-0.2722174823284149,-0.2678930461406708,-0.26356860995292664,-0.2592441439628601,-0.2549196481704712,-0.25059521198272705,-0.24627068638801575,-0.2419462502002716,-0.23762181401252747,-0.23329730331897736,-0.22897286713123322,-0.2246483564376831,-0.22032392024993896,-0.21599948406219482,-0.2116750180721283,-0.20735050737857819,-0.20302599668502808,-0.19870156049728394,-0.1943771243095398,-0.19005268812179565,-0.18572817742824554,-0.1814037263393402,-0.1770792305469513,-0.17275479435920715,-0.16843032836914062,-0.1641058325767517,-0.15978139638900757,-0.15545688569545746,-0.15113243460655212,-0.14680799841880798,-0.14248354732990265,-0.13815903663635254,-0.13383454084396362,-0.12951010465621948,-0.12518563866615295,-0.12086120247840881,-0.1165366992354393,-0.11221225559711456,-0.10788775235414505,-0.10356329381465912,-0.09923885762691498,-0.09491435438394547,-0.09058991074562073,-0.08626540750265121,-0.08194096386432648,-0.07761651277542114,-0.0732920691370964,-0.06896756589412689,-0.06464306265115738,-0.06031861901283264,-0.0559941828250885,-0.05166972428560257,-0.04734522104263306,-0.04302077740430832,-0.038696274161338806,-0.034371837973594666,-0.03004738688468933,-0.025722883641719818,-0.021398432552814484,-0.01707392930984497,-0.01274949312210083,-0.008425042033195496,-0.004100538790225983,0.0002239122986793518,0.004548348486423492,0.008872859179973602,0.01319730281829834,0.017521746456623077,0.02184624969959259,0.026170693337917328,0.030495204031467438,0.03481964021921158,0.03914409130811691,0.043468594551086426,0.047793034464120865,0.052117545157670975,0.056441985070705414,0.06076643243432045,0.06509093940258026,0.069415383040905,0.07373982667922974,0.07806432992219925,0.08238877356052399,0.08671321719884872,0.09103772789239883,0.09536216408014297,0.09968668222427368,0.10401111841201782],"y":[0.6813279986381531,0.6830701231956482,0.6848123073577881,0.686554491519928,0.6882966756820679,0.690038800239563,0.6917809844017029,0.693523108959198,0.6952652931213379,0.6970074772834778,0.6987496018409729,0.7004917860031128,0.7022339701652527,0.7039760947227478,0.7057182788848877,0.7074604034423828,0.7092026472091675,0.7109447717666626,0.7126868963241577,0.7144290804862976,0.7161712050437927,0.7179133892059326,0.7196555733680725,0.7213976979255676,0.7231398820877075,0.7248820662498474,0.7266242504119873,0.7283663749694824,0.7301085591316223,0.7318506836891174,0.7335928678512573,0.7353349924087524,0.7370771765708923,0.7388193607330322,0.7405615448951721,0.7423036694526672,0.7440458536148071,0.7457879781723022,0.7475301623344421,0.749272346496582,0.7510144710540771,0.752756655216217,0.7544987797737122,0.756240963935852,0.7579831480979919,0.7597252726554871,0.761467456817627,0.7632095813751221,0.764951765537262,0.7666939496994019,0.768436074256897,0.7701783180236816,0.771920382976532,0.7736625671386719,0.7754047513008118,0.7771469354629517,0.7788890600204468,0.7806311845779419,0.7823734283447266,0.7841155529022217,0.7858577370643616,0.7875999212265015,0.7893420457839966,0.7910841703414917,0.7928264141082764,0.7945685386657715,0.7963107228279114,0.7980529069900513,0.7997950315475464,0.8015371561050415,0.8032793402671814,0.8050215244293213,0.8067636489868164,0.8085057735443115,0.8102480173110962,0.8119901418685913,0.8137323260307312,0.8154745101928711,0.8172166347503662,0.8189587593078613,0.8207009434700012,0.8224431276321411,0.824185311794281,0.8259274959564209,0.827669620513916,0.8294117450714111,0.831153929233551,0.8328961133956909,0.834638237953186,0.8363803625106812,0.8381226062774658,0.8398647308349609,0.8416069149971008,0.8433490991592407,0.8450912237167358,0.846833348274231,0.8485755920410156,0.8503177165985107,0.8520599007606506,0.8538020253181458,0.8555442094802856,0.8572863936424255,0.8590285778045654,0.8607707023620605,0.8625128269195557,0.8642550110816956,0.8659971952438354,0.8677393198013306,0.8694815635681152,0.8712236881256104,0.8729658126831055,0.8747079372406006,0.8764501810073853,0.8781923651695251,0.8799344301223755,0.8816766142845154,0.8834187984466553,0.8851609230041504,0.8869031071662903,0.8886452913284302,0.8903874158859253,0.8921296000480652,0.8938717842102051,0.8956139087677002,0.8973561525344849,0.89909827709198,0.9008404612541199,0.9025826454162598,0.9043247699737549,0.9060669541358948,0.9078091382980347,0.9095512628555298,0.9112933874130249,0.9130355715751648,0.9147777557373047,0.9165198802947998,0.9182620644569397,0.9200042486190796,0.9217463731765747,0.9234885573387146,0.9252307415008545,0.9269728660583496,0.9287149906158447,0.9304571747779846,0.9321993589401245,0.9339414834976196,0.9356836676597595,0.9374258518218994,0.9391679763793945,0.9409101009368896,0.9426523447036743,0.9443944692611694,0.9461366534233093,0.9478787779808044,0.9496209621429443,0.9513630867004395,0.9531052708625793,0.9548474550247192,0.9565895795822144,0.9583317637443542,0.9600738883018494,0.961816132068634,0.9635583162307739,0.965300440788269,0.9670426249504089,0.968784749507904,0.970526933670044,0.9722690582275391,0.9740113019943237,0.9757534265518188,0.977495551109314,0.9792377352714539,0.9809799194335938,0.9827220439910889,0.9844642281532288,0.9862064123153687,0.9879485368728638,0.9896907210350037,0.9914329051971436,0.9931750297546387,0.9949171543121338,0.9966593384742737,0.9984015226364136,1.0001436471939087,1.0018858909606934,1.0036280155181885,1.0053701400756836,1.0071122646331787,1.0088545083999634,1.0105966329574585,1.0123387575149536,1.0140810012817383,1.0158231258392334,1.0175652503967285,1.0193074941635132,1.0210496187210083,1.022791862487793,1.0245338678359985,1.0262761116027832,1.0280182361602783,1.029760479927063,1.031502604484558,1.0332447290420532,1.034986972808838,1.036729097366333,1.0384712219238281,1.0402134656906128,1.041955590248108,1.043697714805603,1.0454398393630981,1.0471820831298828,1.048924207687378,1.050666332244873,1.0524085760116577,1.0541507005691528,1.055892825126648,1.0576350688934326,1.0593771934509277,1.0611193180084229,1.062861442565918,1.0646036863327026,1.0663458108901978,1.0680879354476929,1.0698301792144775,1.0715724229812622,1.0733144283294678,1.0750566720962524,1.0767987966537476,1.0785409212112427,1.0802831649780273,1.0820252895355225,1.0837674140930176,1.0855095386505127,1.0872517824172974,1.0889939069747925,1.0907360315322876,1.0924782752990723,1.0942203998565674,1.0959625244140625,1.0977047681808472,1.0994468927383423,1.1011890172958374,1.102931261062622,1.1046733856201172,1.1064155101776123,1.108157753944397,1.109899878501892,1.1116420030593872,1.1133842468261719,1.115126371383667],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.972781240940094],"y":[0.6813279986381531],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.10401111841201782],"y":[1.115126371383667],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.5424747467041016,-0.5384549498558044,-0.5344350934028625,-0.5304152965545654,-0.5263954401016235,-0.5223756432533264,-0.5183558464050293,-0.5143359303474426,-0.5103161334991455,-0.5062963962554932,-0.5022764801979065,-0.4982566833496094,-0.49423685669898987,-0.49021703004837036,-0.48619723320007324,-0.48217740654945374,-0.47815757989883423,-0.4741377532482147,-0.4701179563999176,-0.4660981297492981,-0.4620782732963562,-0.4580584764480591,-0.4540386497974396,-0.45001882314682007,-0.44599899649620056,-0.44197916984558105,-0.43795934319496155,-0.43393954634666443,-0.4299197196960449,-0.425899863243103,-0.4218800663948059,-0.417860209941864,-0.4138404130935669,-0.4098206162452698,-0.4058007597923279,-0.4017809331417084,-0.39776110649108887,-0.39374130964279175,-0.38972148299217224,-0.38570165634155273,-0.3816818296909332,-0.3776620030403137,-0.3736421763896942,-0.3696223497390747,-0.3656025528907776,-0.3615826964378357,-0.3575628995895386,-0.3535430431365967,-0.34952324628829956,-0.34550344944000244,-0.34148359298706055,-0.33746376633644104,-0.33344393968582153,-0.3294241428375244,-0.3254043161869049,-0.3213844895362854,-0.3173646926879883,-0.3133448362350464,-0.3093250095844269,-0.3053051829338074,-0.30128538608551025,-0.29726555943489075,-0.29324573278427124,-0.28922587633132935,-0.2852060794830322,-0.2811862826347351,-0.2771664261817932,-0.2731466293334961,-0.2691267728805542,-0.2651069760322571,-0.26108717918395996,-0.25706732273101807,-0.25304746627807617,-0.24902766942977905,-0.24500784277915955,-0.24098803102970123,-0.23696820437908173,-0.2329483926296234,-0.2289285808801651,-0.2249087244272232,-0.2208888977766037,-0.21686911582946777,-0.21284925937652588,-0.20882944762706757,-0.20480960607528687,-0.20078977942466736,-0.19676999747753143,-0.19275017082691193,-0.18873032927513123,-0.18471047282218933,-0.1806906759738922,-0.1766708642244339,-0.17265105247497559,-0.1686311960220337,-0.16461141407489777,-0.16059157252311707,-0.15657174587249756,-0.15255191922187805,-0.14853209257125854,-0.14451229572296143,-0.14049243927001953,-0.13647261261940002,-0.1324528306722641,-0.1284330189228058,-0.12441316246986389,-0.120393306016922,-0.11637352406978607,-0.11235371232032776,-0.10833388566970825,-0.10431402921676636,-0.10029426217079163,-0.09627440571784973,-0.09225457906723022,-0.08823475241661072,-0.08421491086483002,-0.08019512891769409,-0.0761752724647522,-0.07215544581413269,-0.06813564896583557,-0.06411585211753845,-0.06009599566459656,-0.05607615411281586,-0.05205632746219635,-0.048036545515060425,-0.04401671886444092,-0.03999681770801544,-0.03597700595855713,-0.031957224011421204,-0.02793741226196289,-0.023917555809020996,-0.019897684454917908,-0.015877902507781982,-0.011858105659484863,-0.00783829391002655,-0.003818422555923462,0.00020137429237365723,0.004221245646476746,0.008241027593612671,0.012260809540748596,0.01628069579601288,0.020300492644309998,0.024320334196090698,0.028340160846710205,0.03235994279384613,0.03637976944446564,0.04039961099624634,0.04441946744918823,0.048439279198646545,0.052459076046943665,0.05647885799407959,0.06049874424934387,0.0645185261964798,0.06853838264942169,0.07255819439888,0.07657799124717712,0.08059786260128021,0.08461765944957733,0.08863750100135803,0.09265732765197754,0.09667710959911346,0.10069693624973297,0.10471677780151367,0.10873663425445557,0.11275646090507507,0.116776242852211,0.12079602479934692,0.1248159110546112,0.12883570790290833,0.13285554945468903,0.13687537610530853,0.14089515805244446,0.14491501450538635,0.14893482625484467,0.15295468270778656,0.15697449445724487,0.160994291305542,0.16501407325267792,0.1690339595079422,0.1730538010597229,0.17707359790802002,0.18109340965747833,0.18511320650577545,0.18913304805755615,0.19315287470817566,0.19717271625995636,0.20119254291057587,0.2052123248577118,0.2092321813106537,0.213251993060112,0.2172718495130539,0.22129163146018982,0.22531145811080933,0.22933125495910645,0.23335112631320953,0.23737096786499023,0.24139076471328735,0.24541059136390686,0.24943037331104279,0.2534502148628235,0.257470041513443,0.2614898979663849,0.2655096650123596,0.2695294916629791,0.273549348115921,0.2775691747665405,0.2815890312194824,0.28560882806777954,0.28962862491607666,0.2936484217643738,0.2976682782173157,0.30168813467025757,0.3057079315185547,0.3097277283668518,0.3137475550174713,0.3177673816680908,0.3217872083187103,0.3258070647716522,0.32982686161994934,0.33384668827056885,0.33786651492118835,0.3418863117694855,0.34590619802474976,0.3499259948730469,0.353945791721344,0.3579656481742859,0.361985445022583,0.3660052418708801,0.370025098323822,0.37404489517211914,0.37806472182273865,0.38208457827568054,0.3861043453216553,0.39012423157691956,0.3941440284252167,0.3981638550758362,0.4021836817264557,0.4062034785747528,0.4102233648300171,0.4142431616783142,0.41826292872428894,0.4222828149795532,0.42630261182785034,0.43032240867614746,0.43434226512908936,0.4383620619773865,0.442381888628006,0.4464017450809479,0.4504215121269226,0.4544413983821869,0.458461195230484],"y":[0.0066142999567091465,0.0038324380293488503,0.0010505756363272667,-0.0017312872223556042,-0.0045131491497159,-0.007295011542737484,-0.010076873935759068,-0.012858735397458076,-0.01564059779047966,-0.018422460183501244,-0.021204322576522827,-0.02398618496954441,-0.026768047362565994,-0.029549911618232727,-0.03233176842331886,-0.035113632678985596,-0.03789549320936203,-0.04067735746502876,-0.043459221720695496,-0.04624108225107193,-0.04902294650673866,-0.0518048070371151,-0.05458667129278183,-0.05736853554844856,-0.060150396078825,-0.06293226033449173,-0.06571412086486816,-0.0684959813952446,-0.07127784192562103,-0.07405970245599747,-0.0768415629863739,-0.07962343096733093,-0.08240529149770737,-0.0851871594786644,-0.08796901255846024,-0.09075087308883667,-0.0935327410697937,-0.09631460905075073,-0.09909646958112717,-0.101878322660923,-0.10466019064188004,-0.10744205117225647,-0.1102239191532135,-0.11300577223300934,-0.11578764021396637,-0.1185695081949234,-0.12135136872529984,-0.12413321435451508,-0.1269150972366333,-0.12969695031642914,-0.13247881829738617,-0.135260671377182,-0.13804253935813904,-0.14082440733909607,-0.1436062753200531,-0.14638811349868774,-0.14916998147964478,-0.151951864361763,-0.15473370254039764,-0.15751557052135468,-0.1602974236011505,-0.16307930648326874,-0.16586115956306458,-0.1686430126428604,-0.17142488062381744,-0.17420676350593567,-0.1769886165857315,-0.17977046966552734,-0.18255233764648438,-0.1853341907262802,-0.18811604380607605,-0.19089791178703308,-0.1936797797679901,-0.19646164774894714,-0.19924351572990417,-0.2020253688097,-0.20480723679065704,-0.20758908987045288,-0.21037094295024872,-0.21315282583236694,-0.21593467891216278,-0.2187165468931198,-0.22149841487407684,-0.2242802530527115,-0.2270621359348297,-0.22984400391578674,-0.2326258420944214,-0.23540771007537842,-0.23818957805633545,-0.24097144603729248,-0.2437533140182495,-0.24653515219688416,-0.24931703507900238,-0.2520988881587982,-0.25488072633743286,-0.2576625943183899,-0.2604444921016693,-0.26322633028030396,-0.266008198261261,-0.268790066242218,-0.27157193422317505,-0.2743537724018097,-0.2771356403827667,-0.27991750836372375,-0.2826993763446808,-0.2854812443256378,-0.28826311230659485,-0.2910449504852295,-0.2938268482685089,-0.29660868644714355,-0.2993905246257782,-0.3021724224090576,-0.30495426058769226,-0.3077361285686493,-0.3105180263519287,-0.31329986453056335,-0.316081702709198,-0.3188636004924774,-0.32164543867111206,-0.3244273066520691,-0.3272091746330261,-0.32999104261398315,-0.3327729105949402,-0.33555474877357483,-0.33833661675453186,-0.3411185145378113,-0.3439003527164459,-0.34668222069740295,-0.3494640588760376,-0.352245956659317,-0.35502785444259644,-0.3578096926212311,-0.3605915307998657,-0.36337339878082275,-0.3661552667617798,-0.36893710494041443,-0.37171903252601624,-0.3745008707046509,-0.37728267908096313,-0.38006460666656494,-0.3828464448451996,-0.3856283128261566,-0.38841018080711365,-0.3911920189857483,-0.39397385716438293,-0.39675575494766235,-0.3995376527309418,-0.4023194909095764,-0.40510135889053345,-0.4078831970691681,-0.4106650650501251,-0.41344690322875977,-0.4162288010120392,-0.41901063919067383,-0.42179247736930847,-0.4245744049549103,-0.4273562431335449,-0.43013811111450195,-0.432919979095459,-0.43570181727409363,-0.43848365545272827,-0.4412655532360077,-0.4440474510192871,-0.44682928919792175,-0.4496111273765564,-0.45239296555519104,-0.45517486333847046,-0.4579567313194275,-0.4607385993003845,-0.46352043747901917,-0.4663023054599762,-0.4690841734409332,-0.47186601161956787,-0.4746479392051697,-0.4774297773838043,-0.48021161556243896,-0.482993483543396,-0.485775351524353,-0.48855721950531006,-0.4913390576839447,-0.49412092566490173,-0.4969027638435364,-0.4996846616268158,-0.5024664998054504,-0.5052483677864075,-0.5080302357673645,-0.5108120441436768,-0.5135939717292786,-0.5163758397102356,-0.5191577076911926,-0.5219395756721497,-0.5247214436531067,-0.527503252029419,-0.530285120010376,-0.5330670475959778,-0.53584885597229,-0.5386307239532471,-0.5414125919342041,-0.5441944599151611,-0.5469763278961182,-0.5497581958770752,-0.5525400042533875,-0.5553218722343445,-0.5581037998199463,-0.5608856081962585,-0.5636675357818604,-0.5664494037628174,-0.5692312121391296,-0.5720130801200867,-0.5747949481010437,-0.5775768160820007,-0.5803586840629578,-0.5831405520439148,-0.585922360420227,-0.5887042880058289,-0.5914861559867859,-0.5942679643630981,-0.5970498323440552,-0.5998317003250122,-0.6026135683059692,-0.6053954362869263,-0.6081773638725281,-0.6109591722488403,-0.6137410402297974,-0.6165228486061096,-0.6193047165870667,-0.6220865845680237,-0.6248684525489807,-0.6276503205299377,-0.6304321885108948,-0.633213996887207,-0.6359958648681641,-0.6387777924537659,-0.6415596008300781,-0.6443414688110352,-0.647123396396637,-0.6499052047729492,-0.6526870727539062,-0.6554689407348633,-0.6582507491111755,-0.6610326766967773,-0.6638145446777344,-0.6665963530540466,-0.6693782806396484,-0.6721601486206055,-0.6749419569969177,-0.6777238249778748,-0.6805056929588318,-0.6832875609397888,-0.6860694289207458],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.5424747467041016],"y":[0.0066142999567091465],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.458461195230484],"y":[-0.6860694289207458],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.20524655282497406,-0.2040596455335617,-0.20287270843982697,-0.20168578624725342,-0.20049886405467987,-0.19931194186210632,-0.19812503457069397,-0.19693809747695923,-0.19575117528438568,-0.19456426799297333,-0.19337734580039978,-0.19219040870666504,-0.19100350141525269,-0.18981657922267914,-0.1886296570301056,-0.18744273483753204,-0.1862558126449585,-0.18506889045238495,-0.1838819682598114,-0.18269504606723785,-0.1815081089735031,-0.18032120168209076,-0.1791342794895172,-0.17794735729694366,-0.17676043510437012,-0.17557351291179657,-0.17438659071922302,-0.17319968342781067,-0.17201276123523712,-0.17082582414150238,-0.16963891685009003,-0.16845197975635529,-0.16726507246494293,-0.16607815027236938,-0.16489121317863464,-0.1637043058872223,-0.16251738369464874,-0.1613304615020752,-0.16014353930950165,-0.1589566320180893,-0.15776969492435455,-0.156582772731781,-0.15539585053920746,-0.1542089283466339,-0.15302202105522156,-0.151835098862648,-0.15064817667007446,-0.14946123957633972,-0.14827433228492737,-0.14708741009235382,-0.14590048789978027,-0.14471356570720673,-0.14352662861347198,-0.14233972132205963,-0.14115279912948608,-0.13996589183807373,-0.138778954744339,-0.13759203255176544,-0.1364051103591919,-0.13521820306777954,-0.1340312659740448,-0.13284434378147125,-0.1316574364900589,-0.13047051429748535,-0.1292835772037506,-0.12809666991233826,-0.12690973281860352,-0.12572282552719116,-0.12453589588403702,-0.12334896624088287,-0.12216205894947052,-0.12097515165805817,-0.11978820711374283,-0.11860127747058868,-0.11741437017917633,-0.11622744798660278,-0.11504053324460983,-0.11385361105203629,-0.11266668140888214,-0.1114797592163086,-0.11029285192489624,-0.1091059222817421,-0.10791899263858795,-0.1067320853471756,-0.10554514825344086,-0.1043582335114479,-0.10317132622003555,-0.10198439657688141,-0.10079747438430786,-0.09961055219173431,-0.09842362254858017,-0.09723670780658722,-0.09604978561401367,-0.09486286342144012,-0.09367595613002777,-0.09248902648687363,-0.09130209684371948,-0.09011518955230713,-0.08892825245857239,-0.08774133771657944,-0.08655440807342529,-0.08536749333143234,-0.08418057858943939,-0.08299365639686584,-0.0818067342042923,-0.08061979711055756,-0.0794328898191452,-0.07824596762657166,-0.0770590528845787,-0.07587212324142456,-0.07468520849943161,-0.07349827885627747,-0.07231135666370392,-0.07112444937229156,-0.06993751227855682,-0.06875059008598328,-0.06756366789340973,-0.06637674570083618,-0.06518983840942383,-0.06400291621685028,-0.06281599402427673,-0.06162906065583229,-0.06044214218854904,-0.05925522744655609,-0.05806830897927284,-0.056881360709667206,-0.055694445967674255,-0.054507531225681305,-0.053320612758398056,-0.05213368311524391,-0.050946757197380066,-0.04975983873009682,-0.04857292398810387,-0.047386009246110916,-0.04619907960295677,-0.04501216113567352,-0.04382522776722908,-0.04263831675052643,-0.04145140200853348,-0.04026446491479874,-0.039077550172805786,-0.03789062052965164,-0.03670370206236839,-0.03551678732037544,-0.03432988002896309,-0.03314294293522835,-0.031956013292074203,-0.030769098550081253,-0.029582180082798004,-0.028395265340805054,-0.02720833569765091,-0.02602142095565796,-0.024834483861923218,-0.023647576570510864,-0.022460658103227615,-0.021273721009492874,-0.02008681371808052,-0.01889987662434578,-0.01771296188235283,-0.01652604341506958,-0.015339136123657227,-0.014152199029922485,-0.012965269386768341,-0.01177835464477539,-0.01059143990278244,-0.009404521435499191,-0.008217595517635345,-0.0070306770503520966,-0.005843747407197952,-0.004656832665205002,-0.0034699179232120514,-0.00228298082947731,-0.0010960698127746582,9.086728096008301e-05,0.001277778297662735,0.0024646930396556854,0.003651607781648636,0.004838541150093079,0.006025470793247223,0.007212385535240173,0.008399300277233124,0.009586218744516373,0.010773152112960815,0.011960066854953766,0.013147000223398209,0.01433391124010086,0.015520825982093811,0.016707759350538254,0.017894674092531204,0.019081607460975647,0.0202685184776783,0.02145543321967125,0.022642355412244797,0.023829277604818344,0.025016210973262787,0.026203133165836334,0.027390047907829285,0.028576958924531937,0.02976389229297638,0.03095080703496933,0.03213774040341377,0.033324651420116425,0.034511566162109375,0.03569849953055382,0.03688541427254677,0.03807234391570091,0.03925925865769386,0.04044618085026741,0.04163309186697006,0.042820025235414505,0.04400695860385895,0.0451938733458519,0.04638078808784485,0.0475676991045475,0.04875463247299194,0.049941547214984894,0.05112847685813904,0.05231539160013199,0.053502313792705536,0.05468924716114998,0.05587615817785263,0.05706309527158737,0.058250006288290024,0.059436917304992676,0.06062385439872742,0.06181076541543007,0.06299768388271332,0.06418461352586746,0.06537152826786041,0.06655845046043396,0.06774537265300751,0.06893229484558105,0.0701192244887352,0.07130613923072815,0.0724930539727211,0.07367998361587524,0.0748668983578682,0.07605383545160294,0.07724074274301529,0.07842765748500824,0.07961459457874298,0.08080150187015533,0.08198842406272888,0.08317535370588303,0.08436227589845657,0.08554918318986893,0.08673612028360367,0.08792303502559662,0.08910996466875076,0.09029687941074371],"y":[1.0058348178863525,1.0022132396697998,0.9985917806625366,0.9949702620506287,0.9913486838340759,0.987727165222168,0.9841057062149048,0.980484127998352,0.9768626689910889,0.9732411503791809,0.969619631767273,0.9659980535507202,0.962376594543457,0.9587550163269043,0.9551335573196411,0.9515119791030884,0.9478905200958252,0.9442690014839172,0.9406474232673645,0.9370259046554565,0.9334043860435486,0.9297828674316406,0.9261614084243774,0.9225398302078247,0.9189183712005615,0.9152967929840088,0.9116752743721008,0.9080537557601929,0.9044322967529297,0.900810718536377,0.8971892595291138,0.893567681312561,0.8899462223052979,0.8863246440887451,0.8827031254768372,0.8790816068649292,0.8754600882530212,0.8718385696411133,0.8682171106338501,0.8645955920219421,0.8609740138053894,0.8573524355888367,0.8537309765815735,0.8501094579696655,0.8464879989624023,0.8428664207458496,0.8392449617385864,0.8356233239173889,0.8320018649101257,0.8283803462982178,0.8247588276863098,0.8211373090744019,0.8175157904624939,0.8138942718505859,0.810272753238678,0.80665123462677,0.8030297160148621,0.7994081377983093,0.7957866787910461,0.7921651601791382,0.788543701171875,0.7849220633506775,0.7813006043434143,0.7776790261268616,0.7740575671195984,0.7704360485076904,0.7668145298957825,0.7631930112838745,0.7595714330673218,0.7559499144554138,0.7523284554481506,0.7487069368362427,0.7450854182243347,0.741463840007782,0.7378423810005188,0.7342208027839661,0.7305993437767029,0.7269777655601501,0.723356306552887,0.7197347283363342,0.716113269329071,0.7124917507171631,0.7088701725006104,0.7052486538887024,0.7016271352767944,0.6980056166648865,0.6943840980529785,0.6907626390457153,0.6871411204338074,0.6835194826126099,0.6798980236053467,0.6762765049934387,0.6726549863815308,0.6690334677696228,0.6654119491577148,0.6617904305458069,0.6581689119338989,0.654547393321991,0.650925874710083,0.647304356098175,0.6436828374862671,0.6400613188743591,0.6364398002624512,0.632818341255188,0.6291967034339905,0.6255751848220825,0.6219536662101746,0.6183322072029114,0.6147106885910034,0.6110891699790955,0.6074676513671875,0.6038460731506348,0.6002245545387268,0.5966030955314636,0.5929815173149109,0.5893600583076477,0.585738480091095,0.5821170210838318,0.578495442867279,0.5748739838600159,0.5712524056434631,0.5676308870315552,0.5640093684196472,0.560387909412384,0.5567663908004761,0.5531447529792786,0.5495232939720154,0.5459017753601074,0.5422802567481995,0.5386587381362915,0.5350371599197388,0.5314156413078308,0.5277941823005676,0.5241726636886597,0.5205510854721069,0.5169296264648438,0.513308048248291,0.5096865296363831,0.5060650706291199,0.5024434924125671,0.49882203340530396,0.4952004551887512,0.49157896637916565,0.4879574775695801,0.4843359589576721,0.4807144105434418,0.4770928621292114,0.47347137331962585,0.4698498249053955,0.4662283658981323,0.4626067876815796,0.4589853286743164,0.45536375045776367,0.4517422318458557,0.44812077283859253,0.4444991946220398,0.44087767601013184,0.4372561573982239,0.4336346387863159,0.43001312017440796,0.4263916313648224,0.42277008295059204,0.4191485047340393,0.4155270457267761,0.41190552711486816,0.4082840383052826,0.40466248989105225,0.4010409712791443,0.39741945266723633,0.393797904253006,0.3901764154434204,0.38655489683151245,0.3829333782196045,0.37931180000305176,0.3756903111934662,0.3720688223838806,0.36844733357429504,0.3648257553577423,0.36120420694351196,0.3575827181339264,0.35396119952201843,0.35033971071243286,0.3467181622982025,0.34309667348861694,0.3394750952720642,0.33585360646247864,0.33223211765289307,0.32861053943634033,0.32498905062675476,0.3213675022125244,0.31774601340293884,0.31412452459335327,0.3105030059814453,0.3068814277648926,0.3032599091529846,0.29963839054107666,0.2960169017314911,0.2923954129219055,0.2887738347053528,0.2851523458957672,0.28153079748153687,0.2779092788696289,0.27428779006004333,0.270666241645813,0.26704472303390503,0.26342320442199707,0.2598016858100891,0.25618019700050354,0.2525586783885956,0.24893712997436523,0.2453155815601349,0.24169407784938812,0.23807257413864136,0.2344510853290558,0.23082953691482544,0.22720801830291748,0.22358648478984833,0.21996498107910156,0.2163434624671936,0.21272191405296326,0.20910042524337769,0.20547887682914734,0.20185735821723938,0.1982358694076538,0.19461432099342346,0.1909928172826767,0.18737131357192993,0.18374976515769958,0.180128276348114,0.17650675773620605,0.1728852093219757,0.16926372051239014,0.1656421571969986,0.16202065348625183,0.15839916467666626,0.15477760136127472,0.15115609765052795,0.1475345492362976,0.14391306042671204,0.14029155671596527,0.13666999340057373,0.13304850459098816,0.1294270008802414,0.12580543756484985,0.12218394875526428,0.11856244504451752,0.11494088917970657,0.1113193929195404,0.10769783705472946,0.1040763407945633],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.20524655282497406],"y":[1.0058348178863525],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.09029687941074371],"y":[0.1040763407945633],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.6354976892471313,0.6360147595405579,0.6365318894386292,0.6370490193367004,0.637566089630127,0.6380832195281982,0.6386002898216248,0.639117419719696,0.6396345496177673,0.6401516795158386,0.6406687498092651,0.6411858201026917,0.6417030096054077,0.6422200202941895,0.6427371501922607,0.643254280090332,0.6437713503837585,0.6442885398864746,0.6448055505752563,0.6453226804733276,0.6458398103713989,0.6463568806648254,0.6468740701675415,0.6473910808563232,0.6479082107543945,0.6484253406524658,0.6489424109458923,0.6494595408439636,0.6499766707420349,0.6504937410354614,0.6510108709335327,0.6515279412269592,0.6520450115203857,0.6525622010231018,0.6530792713165283,0.6535964012145996,0.6541134715080261,0.6546306014060974,0.6551477313041687,0.6556648015975952,0.6561819314956665,0.656699001789093,0.6572160720825195,0.6577332615852356,0.6582503318786621,0.6587674617767334,0.6592845320701599,0.6598016023635864,0.6603187918663025,0.660835862159729,0.6613529920578003,0.6618700623512268,0.6623871326446533,0.6629042625427246,0.6634213924407959,0.6639385223388672,0.6644555926322937,0.6649726629257202,0.6654897928237915,0.6660069227218628,0.6665240526199341,0.6670411229133606,0.6675582528114319,0.6680753231048584,0.6685924530029297,0.669109582901001,0.6696266531944275,0.6701437830924988,0.6706608533859253,0.6711779832839966,0.6716950535774231,0.6722121834754944,0.6727293133735657,0.6732463836669922,0.6737635135650635,0.67428058385849,0.6747977137565613,0.6753147840499878,0.6758319139480591,0.6763489842414856,0.6768661141395569,0.6773832440376282,0.6779003143310547,0.678417444229126,0.6789345741271973,0.6794517040252686,0.6799687147140503,0.6804858446121216,0.6810029745101929,0.6815201044082642,0.6820371747016907,0.6825542449951172,0.6830713748931885,0.6835885047912598,0.684105634689331,0.6846226453781128,0.6851397752761841,0.6856569051742554,0.6861740350723267,0.6866911053657532,0.6872081756591797,0.687725305557251,0.6882424354553223,0.6887595653533936,0.6892766356468201,0.6897937059402466,0.6903108358383179,0.6908279657363892,0.6913450956344604,0.6918622255325317,0.6923792958259583,0.6928963661193848,0.693413496017456,0.6939306259155273,0.6944477558135986,0.6949648261070251,0.6954818964004517,0.695999026298523,0.6965161561965942,0.6970332860946655,0.697550356388092,0.6980674266815186,0.6985845565795898,0.6991016864776611,0.6996188163757324,0.7001358866691589,0.7006529569625854,0.7011700868606567,0.701687216758728,0.7022042870521545,0.7027214169502258,0.7032384872436523,0.7037556171417236,0.7042727470397949,0.7047898173332214,0.705306887626648,0.7058240175247192,0.7063411474227905,0.706858217716217,0.7073753476142883,0.7078924179077148,0.7084095478057861,0.7089266777038574,0.7094438076019287,0.7099608778953552,0.7104780077934265,0.710995078086853,0.7115122079849243,0.7120293378829956,0.7125464081764221,0.7130635380744934,0.7135806083679199,0.7140977382659912,0.7146148681640625,0.715131938457489,0.7156490683555603,0.7161661386489868,0.7166832685470581,0.7172003388404846,0.7177174687385559,0.7182345390319824,0.7187516689300537,0.719268798828125,0.7197859287261963,0.7203029990196228,0.7208201289176941,0.7213371992111206,0.7218543291091919,0.7223714590072632,0.7228885293006897,0.7234055995941162,0.7239227294921875,0.7244398593902588,0.7249569892883301,0.7254740595817566,0.7259911298751831,0.7265082597732544,0.7270253896713257,0.727542519569397,0.7280595898628235,0.72857666015625,0.7290937900543213,0.7296109199523926,0.7301279902458191,0.7306451201438904,0.7311621904373169,0.7316793203353882,0.7321964502334595,0.732713520526886,0.7332306504249573,0.7337477207183838,0.7342648506164551,0.7347819209098816,0.7352990508079529,0.7358161807060242,0.7363332509994507,0.736850380897522,0.7373674511909485,0.7378845810890198,0.7384016513824463,0.7389187812805176,0.7394359111785889,0.7399529814720154,0.7404701113700867,0.7409871816635132,0.7415043115615845,0.742021381855011,0.7425385117530823,0.7430555820465088,0.7435727119445801,0.7440898418426514,0.7446069121360779,0.7451240420341492,0.7456411719322205,0.746158242225647,0.7466753125190735,0.7471924424171448,0.7477095723152161,0.7482267022132874,0.7487437725067139,0.7492609024047852,0.7497779726982117,0.7502951622009277,0.7508122324943542,0.7513293027877808,0.751846432685852,0.7523635625839233,0.7528806924819946,0.7533977627754211,0.7539148330688477,0.754431962966919,0.7549490928649902,0.7554661631584167,0.755983293056488,0.7565003633499146,0.7570174932479858,0.7575346231460571,0.7580516934394836,0.7585688233375549,0.7590858936309814,0.7596030235290527,0.7601200938224792,0.7606372237205505,0.7611543536186218,0.7616714239120483,0.7621885538101196,0.7627056241035461,0.7632227540016174,0.7637398838996887,0.7642569541931152],"y":[-0.9606501460075378,-0.9585312008857727,-0.9564122557640076,-0.9542932510375977,-0.9521742463111877,-0.9500553607940674,-0.9479364156723022,-0.9458173513412476,-0.9436984658241272,-0.9415795207023621,-0.9394605159759521,-0.937341570854187,-0.9352226257324219,-0.933103621006012,-0.9309847354888916,-0.9288657307624817,-0.9267467260360718,-0.9246278405189514,-0.9225088357925415,-0.9203898906707764,-0.9182708859443665,-0.9161519408226013,-0.9140329957008362,-0.911914050579071,-0.9097950458526611,-0.907676100730896,-0.9055571556091309,-0.9034382104873657,-0.9013192653656006,-0.8992002606391907,-0.8970813155174255,-0.8949623107910156,-0.8928434252738953,-0.8907244205474854,-0.8886054158210754,-0.8864865303039551,-0.8843675255775452,-0.8822485208511353,-0.8801296353340149,-0.8780106902122498,-0.8758916854858398,-0.8737727403640747,-0.8716537356376648,-0.8695347905158997,-0.8674158453941345,-0.8652969002723694,-0.8631778955459595,-0.8610588908195496,-0.8589400053024292,-0.8568210601806641,-0.8547019958496094,-0.852583110332489,-0.8504641056060791,-0.848345160484314,-0.8462262749671936,-0.8441072702407837,-0.8419882655143738,-0.8398693203926086,-0.8377503752708435,-0.8356313705444336,-0.8335124850273132,-0.8313934803009033,-0.8292745351791382,-0.827155590057373,-0.8250365853309631,-0.822917640209198,-0.8207986950874329,-0.818679690361023,-0.816560685634613,-0.8144418001174927,-0.8123228549957275,-0.8102039098739624,-0.8080849647521973,-0.8059659004211426,-0.8038469552993774,-0.8017280697822571,-0.7996090650558472,-0.7974900603294373,-0.7953711748123169,-0.793252170085907,-0.7911331653594971,-0.7890143394470215,-0.7868952751159668,-0.7847763299942017,-0.7826573848724365,-0.7805384397506714,-0.7784194350242615,-0.7763005495071411,-0.7741815447807312,-0.7720625400543213,-0.7699435949325562,-0.767824649810791,-0.7657057046890259,-0.7635867595672607,-0.7614677548408508,-0.7593487501144409,-0.7572298645973206,-0.7551109194755554,-0.7529919147491455,-0.7508729696273804,-0.7487539649009705,-0.7466350197792053,-0.744516134262085,-0.742397129535675,-0.7402781248092651,-0.7381591796875,-0.7360402345657349,-0.733921229839325,-0.7318023443222046,-0.7296833395957947,-0.7275643348693848,-0.7254453897476196,-0.7233264446258545,-0.7212074995040894,-0.7190885543823242,-0.7169696092605591,-0.7148505449295044,-0.712731659412384,-0.7106127142906189,-0.708493709564209,-0.7063747644424438,-0.7042557597160339,-0.7021368145942688,-0.7000178694725037,-0.6978989839553833,-0.6957799196243286,-0.6936609745025635,-0.6915420293807983,-0.6894230842590332,-0.6873040795326233,-0.6851851344108582,-0.6830661296844482,-0.6809471845626831,-0.678828239440918,-0.6767092943191528,-0.6745903491973877,-0.6724713444709778,-0.6703523993492126,-0.6682334542274475,-0.6661144495010376,-0.6639955043792725,-0.6618765592575073,-0.6597576141357422,-0.6576386094093323,-0.6555197238922119,-0.653400719165802,-0.6512817144393921,-0.649162769317627,-0.6470438241958618,-0.6449248790740967,-0.6428059339523315,-0.6406869292259216,-0.6385679244995117,-0.6364489793777466,-0.6343300342559814,-0.6322110891342163,-0.6300921440124512,-0.6279731392860413,-0.6258541941642761,-0.623735249042511,-0.6216162443161011,-0.6194972991943359,-0.6173783540725708,-0.6152594089508057,-0.6131404638290405,-0.6110215187072754,-0.6089024543762207,-0.6067835688591003,-0.6046645641326904,-0.6025456190109253,-0.6004266738891602,-0.598307728767395,-0.5961887240409851,-0.5940697193145752,-0.5919508337974548,-0.5898318290710449,-0.5877128839492798,-0.5855939388275146,-0.5834749341011047,-0.5813559889793396,-0.5792371034622192,-0.5771180987358093,-0.5749990940093994,-0.5728801488876343,-0.5707612037658691,-0.568642258644104,-0.5665233135223389,-0.564404308795929,-0.5622853636741638,-0.5601663589477539,-0.5580474138259888,-0.5559284687042236,-0.5538095235824585,-0.5516905784606934,-0.5495715737342834,-0.5474526286125183,-0.5453336238861084,-0.5432146787643433,-0.5410957336425781,-0.538976788520813,-0.5368578433990479,-0.5347388386726379,-0.5326198935508728,-0.5305008888244629,-0.5283820033073425,-0.5262629985809326,-0.5241440534591675,-0.5220251083374023,-0.5199061632156372,-0.5177871584892273,-0.5156681537628174,-0.5135492086410522,-0.5114302635192871,-0.509311318397522,-0.5071923732757568,-0.5050733685493469,-0.5029544234275818,-0.5008354783058167,-0.4987165331840515,-0.4965975284576416,-0.49447858333587646,-0.49235957860946655,-0.4902406632900238,-0.48812171816825867,-0.48600274324417114,-0.4838837683200836,-0.4817648231983185,-0.47964584827423096,-0.4775269031524658,-0.4754079580307007,-0.47328895330429077,-0.47117000818252563,-0.4690510332584381,-0.4669320583343506,-0.46481314301490784,-0.4626941680908203,-0.4605751931667328,-0.45845621824264526,-0.4563372731208801,-0.4542182981967926,-0.4520993232727051,-0.44998040795326233,-0.4478614330291748,-0.4457424581050873,-0.44362351298332214,-0.4415045380592346,-0.4393855631351471,-0.43726664781570435,-0.43514764308929443,-0.4330286979675293],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.6354976892471313],"y":[-0.9606501460075378],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.7642569541931152],"y":[-0.4330286979675293],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[2.152486562728882,2.1456756591796875,2.138864517211914,2.132053852081299,2.1252427101135254,2.118431806564331,2.1116209030151367,2.1048097610473633,2.097998857498169,2.0911879539489746,2.084376811981201,2.077566146850586,2.0707550048828125,2.063944101333618,2.0571329593658447,2.0503220558166504,2.043511152267456,2.0367002487182617,2.0298891067504883,2.023078203201294,2.0162672996520996,2.0094563961029053,2.002645492553711,1.995834469795227,1.9890234470367432,1.9822125434875488,1.975401520729065,1.9685906171798706,1.9617797136306763,1.9549686908721924,1.948157787322998,1.9413466453552246,1.9345357418060303,1.927724838256836,1.920913815498352,1.9141029119491577,1.9072918891906738,1.90048086643219,1.8936699628829956,1.8868590593338013,1.8800480365753174,1.8732370138168335,1.8664261102676392,1.8596152067184448,1.85280442237854,1.8459932804107666,1.8391823768615723,1.8323713541030884,1.825560450553894,1.8187495470046997,1.8119385242462158,1.805127501487732,1.798316478729248,1.7915055751800537,1.7846946716308594,1.777883768081665,1.7710727453231812,1.7642616033554077,1.7574506998062134,1.750639796257019,1.7438288927078247,1.7370178699493408,1.7302069664001465,1.7233959436416626,1.7165850400924683,1.7097740173339844,1.7029629945755005,1.6961520910263062,1.6893410682678223,1.682530164718628,1.6757192611694336,1.6689083576202393,1.6620972156524658,1.6552863121032715,1.6484754085540771,1.6416645050048828,1.6348536014556885,1.6280425786972046,1.6212315559387207,1.6144205331802368,1.6076096296310425,1.6007987260818481,1.5939877033233643,1.58717679977417,1.5803656578063965,1.5735547542572021,1.5667438507080078,1.5599329471588135,1.5531219244003296,1.5463109016418457,1.5394999980926514,1.532689094543457,1.5258780717849731,1.5190670490264893,1.512256145477295,1.505445122718811,1.4986342191696167,1.4918233156204224,1.4850122928619385,1.4782012701034546,1.4713902473449707,1.4645793437957764,1.457768440246582,1.4509575366973877,1.4441466331481934,1.43733549118042,1.4305245876312256,1.4237136840820312,1.416902780532837,1.410091757774353,1.4032808542251587,1.3964697122573853,1.389658808708191,1.3828479051589966,1.3760368824005127,1.3692259788513184,1.3624149560928345,1.3556040525436401,1.3487931489944458,1.341982126235962,1.335171103477478,1.3283600807189941,1.3215491771697998,1.3147382736206055,1.3079273700714111,1.3011162281036377,1.2943053245544434,1.287494421005249,1.2806833982467651,1.2738724946975708,1.267061471939087,1.260250449180603,1.2534395456314087,1.2466286420822144,1.2398176193237305,1.2330067157745361,1.2261955738067627,1.2193846702575684,1.212573766708374,1.2057628631591797,1.1989518404006958,1.192140817642212,1.1853299140930176,1.1785190105438232,1.171708106994629,1.164897084236145,1.1580859422683716,1.1512750387191772,1.144464135169983,1.1376532316207886,1.1308422088623047,1.1240313053131104,1.1172202825546265,1.1104092597961426,1.1035983562469482,1.096787452697754,1.0899765491485596,1.0831654071807861,1.0763545036315918,1.0695436000823975,1.0627326965332031,1.0559216737747192,1.0491106510162354,1.0422996282577515,1.0354887247085571,1.0286778211593628,1.021866798400879,1.0150558948516846,1.0082448720932007,1.0014339685440063,0.994623064994812,0.9878119826316833,0.981001079082489,0.9741899967193604,0.967379093170166,0.9605681896209717,0.9537572860717773,0.9469462633132935,0.9401352405548096,0.9333243370056152,0.9265133142471313,0.919702410697937,0.9128914475440979,0.9060805439949036,0.8992694616317749,0.8924585580825806,0.8856476545333862,0.8788366317749023,0.8720256686210632,0.8652147054672241,0.8584036827087402,0.8515927791595459,0.8447818756103516,0.8379708528518677,0.8311598300933838,0.8243489265441895,0.8175380229949951,0.810727059841156,0.8039160370826721,0.7971051335334778,0.7902941107749939,0.7834831476211548,0.7766722440719604,0.7698612213134766,0.7630503177642822,0.7562392950057983,0.7494283318519592,0.7426174283027649,0.7358065247535706,0.7289954423904419,0.722184419631958,0.7153735160827637,0.7085626125335693,0.701751708984375,0.6949406862258911,0.688129723072052,0.6813187003135681,0.6745077967643738,0.6676968336105347,0.6608858108520508,0.6540749073028564,0.6472638845443726,0.6404529809951782,0.6336420178413391,0.6268309950828552,0.6200200915336609,0.6132091283798218,0.6063981056213379,0.5995872020721436,0.5927762985229492,0.5859652757644653,0.579154372215271,0.5723433494567871,0.565532386302948,0.5587214827537537,0.5519104599952698,0.5450994968414307,0.5382884740829468,0.5314775705337524,0.5246666669845581,0.5178556442260742,0.5110446810722351,0.5042337775230408,0.4974227547645569,0.49061182141304016,0.48380088806152344,0.47698989510536194,0.4701789319515228,0.46336790919303894,0.4565570056438446],"y":[0.8838965892791748,0.8774314522743225,0.8709662556648254,0.8645010590553284,0.8580358028411865,0.8515706658363342,0.8451055288314819,0.8386403322219849,0.8321751356124878,0.8257099986076355,0.8192448019981384,0.8127796053886414,0.8063144683837891,0.7998492121696472,0.7933840751647949,0.7869188785552979,0.7804537415504456,0.7739886045455933,0.7675232887268066,0.7610581517219543,0.7545929551124573,0.748127818107605,0.7416626811027527,0.7351974248886108,0.7287322878837585,0.7222670912742615,0.7158018946647644,0.7093367576599121,0.702871561050415,0.696406364440918,0.6899412274360657,0.6834760308265686,0.6770108342170715,0.6705456376075745,0.6640804409980774,0.6576153039932251,0.651150107383728,0.644684910774231,0.6382198333740234,0.6317545771598816,0.6252893805503845,0.6188241839408875,0.6123590469360352,0.6058938503265381,0.5994287133216858,0.5929635167121887,0.5864983201026917,0.5800331234931946,0.5735679864883423,0.5671027898788452,0.5606375932693481,0.5541724562644958,0.5477072596549988,0.5412420630455017,0.5347768664360046,0.5283117294311523,0.5218465328216553,0.5153813362121582,0.5089161396026611,0.5024510025978088,0.49598580598831177,0.4895206093788147,0.4830554723739624,0.47659024596214294,0.47012507915496826,0.46365994215011597,0.4571947455406189,0.4507296085357666,0.44426432251930237,0.4377991557121277,0.4313340187072754,0.4248688817024231,0.418403685092926,0.41193845868110657,0.4054732918739319,0.3990080952644348,0.3925429582595825,0.38607773184776306,0.37961262464523315,0.3731473684310913,0.366682231426239,0.3602170944213867,0.3537518084049225,0.3472866714000702,0.34082144498825073,0.33435630798339844,0.32789117097854614,0.32142603397369385,0.3149608075618744,0.30849558115005493,0.30203038454055786,0.29556524753570557,0.2891000807285309,0.2826348841190338,0.2761697471141815,0.26970452070236206,0.263239324092865,0.2567741572856903,0.25030896067619324,0.24384382367134094,0.23737859725952148,0.2309134602546692,0.2244483232498169,0.21798309683799744,0.21151790022850037,0.2050526738166809,0.19858750700950623,0.19212239980697632,0.18565723299980164,0.1791919767856598,0.17272686958312988,0.16626164317131042,0.15979644656181335,0.15333130955696106,0.1468660831451416,0.1404009461402893,0.13393571972846985,0.12747055292129517,0.12100541591644287,0.11454024910926819,0.10807502269744873,0.10160982608795166,0.09514465928077698,0.0886794924736023,0.08221435546875,0.07574903964996338,0.06928390264511108,0.0628187358379364,0.056353598833084106,0.04988837242126465,0.0434231162071228,0.03695797920227051,0.030492842197418213,0.024027705192565918,0.017562448978424072,0.011097311973571777,0.004632055759429932,-0.0018330514430999756,-0.008298218250274658,-0.014763474464416504,-0.02122858166694641,-0.027693837881088257,-0.03415900468826294,-0.04062411189079285,-0.04708927869796753,-0.053554534912109375,-0.06001976132392883,-0.06648489832878113,-0.07295006513595581,-0.07941517233848572,-0.08588042855262756,-0.09234556555747986,-0.0988108217716217,-0.105275958776474,-0.1117410957813263,-0.11820632219314575,-0.12467148900032043,-0.1311367154121399,-0.1376018524169922,-0.14406701922416687,-0.15053215622901917,-0.15699738264083862,-0.16346260905265808,-0.16992777585983276,-0.17639291286468506,-0.18285804986953735,-0.1893233060836792,-0.1957884430885315,-0.20225366950035095,-0.20871880650520325,-0.21518397331237793,-0.2216491997241974,-0.22811436653137207,-0.23457956314086914,-0.24104472994804382,-0.24750986695289612,-0.2539750337600708,-0.26044028997421265,-0.2669054865837097,-0.273370623588562,-0.2798357605934143,-0.286300927400589,-0.29276618361473083,-0.2992313504219055,-0.3056965470314026,-0.3121616840362549,-0.3186268210411072,-0.325092077255249,-0.3315572440624237,-0.3380224406719208,-0.34448760747909546,-0.35095274448394775,-0.35741788148880005,-0.3638831377029419,-0.37034839391708374,-0.37681347131729126,-0.38327863812446594,-0.3897438049316406,-0.39620906114578247,-0.40267419815063477,-0.4091394543647766,-0.41560453176498413,-0.4220696985721588,-0.42853495478630066,-0.43500012159347534,-0.4414653778076172,-0.4479305148124695,-0.454395592212677,-0.4608607292175293,-0.46732598543167114,-0.4737912714481354,-0.48025640845298767,-0.48672157526016235,-0.4931866526603699,-0.4996519088745117,-0.506117045879364,-0.5125823020935059,-0.5190474987030029,-0.5255126357078552,-0.5319778323173523,-0.5384429693222046,-0.5449082255363464,-0.5513733625411987,-0.557838499546051,-0.5643036961555481,-0.5707688927650452,-0.5772340297698975,-0.5836992859840393,-0.5901644229888916,-0.5966295599937439,-0.603094756603241,-0.6095598936080933,-0.6160252094268799,-0.6224903464317322,-0.6289554834365845,-0.6354206800460815,-0.6418858170509338,-0.6483510732650757,-0.654816210269928,-0.661281406879425,-0.6677466034889221,-0.6742117404937744,-0.6806768774986267,-0.6871421337127686,-0.6936072707176208,-0.7000724077224731,-0.706537663936615,-0.7130028009414673,-0.7194680571556091,-0.7259331941604614],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[2.152486562728882],"y":[0.8838965892791748],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.4565570056438446],"y":[-0.7259331941604614],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[1.0426770448684692,1.0333582162857056,1.024039387702942,1.0147206783294678,1.005401849746704,0.9960830211639404,0.9867642521858215,0.9774454236030579,0.968126654624939,0.9588079452514648,0.9494890570640564,0.9401702880859375,0.9308515787124634,0.9215326905250549,0.912213921546936,0.9028950929641724,0.8935763239860535,0.8842575550079346,0.8749387264251709,0.865619957447052,0.8563011288642883,0.8469823598861694,0.8376635909080505,0.8283447623252869,0.819025993347168,0.8097071647644043,0.8003883957862854,0.7910696268081665,0.7817508578300476,0.7724319696426392,0.763113260269165,0.7537943720817566,0.7444756627082825,0.7351568341255188,0.7258380651473999,0.7165192365646362,0.7072004079818726,0.6978816390037537,0.6885628700256348,0.6792441010475159,0.669925332069397,0.6606064438819885,0.6512876749038696,0.6419689059257507,0.6326501369476318,0.6233313083648682,0.6140125393867493,0.6046937108039856,0.5953749418258667,0.586056113243103,0.5767372846603394,0.5674185752868652,0.5580996870994568,0.5487809181213379,0.539462149143219,0.5301433801651001,0.5208245515823364,0.5115057229995728,0.5021868944168091,0.49286821484565735,0.4835493862628937,0.4742305874824524,0.4649117887020111,0.4555929899215698,0.44627419114112854,0.43695545196533203,0.4276365637779236,0.41831785440444946,0.4089989960193634,0.3996802270412445,0.3903614580631256,0.3810427188873291,0.37172383069992065,0.36240503191947937,0.3530862331390381,0.3437674939632416,0.3344486951828003,0.325129896402359,0.3158111274242401,0.30649229884147644,0.29717350006103516,0.28785473108291626,0.2785358726978302,0.2692171633243561,0.25989827513694763,0.2505795359611511,0.24126076698303223,0.23194202780723572,0.22262313961982727,0.213304340839386,0.20398551225662231,0.1946668028831482,0.1853480041027069,0.17602917551994324,0.16671040654182434,0.15739160776138306,0.14807280898094177,0.13875404000282288,0.12943518161773682,0.1201164722442627,0.11079758405685425,0.10147875547409058,0.09216004610061646,0.08284133672714233,0.07352244853973389,0.06420356035232544,0.05488485097885132,0.045566022396087646,0.036247313022613525,0.026928424835205078,0.017609715461730957,0.00829082727432251,-0.0010278820991516113,-0.010346710681915283,-0.019665539264678955,-0.02898430824279785,-0.03830313682556152,-0.04762190580368042,-0.05694061517715454,-0.06625944375991821,-0.07557827234268188,-0.08489710092544556,-0.09421586990356445,-0.10353463888168335,-0.11285340785980225,-0.12217241525650024,-0.13149112462997437,-0.14080989360809326,-0.15012860298156738,-0.15944749116897583,-0.16876640915870667,-0.17808514833450317,-0.18740388751029968,-0.1967226266860962,-0.20604148507118225,-0.21536022424697876,-0.2246791422367096,-0.2339978814125061,-0.2433166205883026,-0.25263547897338867,-0.2619542181491852,-0.27127307653427124,-0.28059181571006775,-0.28991061449050903,-0.29922935366630554,-0.3085482120513916,-0.31786707043647766,-0.32718580961227417,-0.3365045487880707,-0.3458232879638672,-0.355142205953598,-0.36446094512939453,-0.3737798035144806,-0.3830985426902771,-0.3924172818660736,-0.40173619985580444,-0.41105493903160095,-0.420373797416687,-0.4296925365924835,-0.43901127576828003,-0.44833001494407654,-0.4576489329338074,-0.46696779131889343,-0.47628653049468994,-0.48560526967048645,-0.49492400884628296,-0.5042428970336914,-0.5135616064071655,-0.5228805541992188,-0.5321992635726929,-0.541517972946167,-0.5508368611335754,-0.5601556301116943,-0.5694745779037476,-0.5787932872772217,-0.5881119966506958,-0.5974307060241699,-0.6067496538162231,-0.6160685420036316,-0.6253873109817505,-0.6347060203552246,-0.6440247297286987,-0.6533436179161072,-0.6626623868942261,-0.6719812154769897,-0.6813000440597534,-0.6906187534332275,-0.6999375820159912,-0.7092563509941101,-0.7185752391815186,-0.7278939485549927,-0.7372126579284668,-0.7465314269065857,-0.7558503150939941,-0.7651692032814026,-0.7744879722595215,-0.7838066816329956,-0.7931255102157593,-0.802444338798523,-0.8117630481719971,-0.8210819959640503,-0.8304007053375244,-0.8397194743156433,-0.8490383625030518,-0.8583570122718811,-0.8676759004592896,-0.8769946694374084,-0.8863134384155273,-0.8956321477890015,-0.9049509763717651,-0.9142698645591736,-0.9235886931419373,-0.9329073429107666,-0.9422261714935303,-0.951545000076294,-0.9608638286590576,-0.9701826572418213,-0.9795013666152954,-0.9888201355934143,-0.9981390237808228,-1.0074578523635864,-1.01677668094635,-1.0260953903198242,-1.0354140996932983,-1.0447330474853516,-1.0540517568588257,-1.0633704662322998,-1.0726892948150635,-1.0820081233978271,-1.0913268327713013,-1.100645661354065,-1.1099644899368286,-1.1192833185195923,-1.128602147102356,-1.13792085647583,-1.1472396850585938,-1.1565585136413574,-1.165877342224121,-1.1751961708068848,-1.1845147609710693,-1.1938337087631226,-1.2031524181365967,-1.2124711275100708,-1.221790075302124,-1.2311087846755981,-1.2404276132583618,-1.2497464418411255,-1.2590651512145996,-1.2683839797973633,-1.277702808380127],"y":[0.18115070462226868,0.17025932669639587,0.15936793386936188,0.14847654104232788,0.13758514821529388,0.12669377028942108,0.11580239236354828,0.10491099953651428,0.09401962161064148,0.08312822878360748,0.07223683595657349,0.061345458030700684,0.05045408010482788,0.039562687277793884,0.028671294450759888,0.01777990162372589,0.006888523697853088,-0.004002854228019714,-0.014894247055053711,-0.025785639882087708,-0.036677032709121704,-0.04756841063499451,-0.05845978856086731,-0.0693511813879013,-0.08024255931377411,-0.0911339521408081,-0.1020253449678421,-0.1129167228937149,-0.12380810081958771,-0.1346994936466217,-0.1455908864736557,-0.1564822793006897,-0.1673736572265625,-0.1782650649547577,-0.1891564279794693,-0.2000478208065033,-0.2109392136335373,-0.22183062136173248,-0.2327219694852829,-0.2436133474111557,-0.2545047402381897,-0.2653961777687073,-0.2762875258922577,-0.2871789038181305,-0.2980702817440033,-0.3089616894721985,-0.3198530673980713,-0.3307444453239441,-0.3416358232498169,-0.3525272607803345,-0.3634186089038849,-0.3743099570274353,-0.3852013945579529,-0.39609280228614807,-0.4069841504096985,-0.4178754985332489,-0.4287669062614441,-0.43965834379196167,-0.4505497217178345,-0.4614410400390625,-0.4723324775695801,-0.48322388529777527,-0.4941152334213257,-0.5050066113471985,-0.5158979892730713,-0.5267894268035889,-0.5376808643341064,-0.5485721230506897,-0.5594635605812073,-0.5703549981117249,-0.5812463164329529,-0.5921376943588257,-0.6030291318893433,-0.6139205098152161,-0.6248119473457336,-0.6357032060623169,-0.6465946435928345,-0.657486081123352,-0.6683773994445801,-0.6792687773704529,-0.6901602149009705,-0.7010515928268433,-0.7119430303573608,-0.7228343486785889,-0.7337257266044617,-0.7446171641349792,-0.755508542060852,-0.7663999199867249,-0.7772912979125977,-0.7881827354431152,-0.799074113368988,-0.8099654912948608,-0.8208568096160889,-0.8317482471466064,-0.8426396250724792,-0.853531002998352,-0.8644223809242249,-0.8753137588500977,-0.8862051963806152,-0.8970965147018433,-0.9079879522323608,-0.9188793301582336,-0.9297706484794617,-0.9406620264053345,-0.951553463935852,-0.9624449014663696,-0.9733362793922424,-0.9842275977134705,-0.9951189756393433,-1.0060104131698608,-1.0169017314910889,-1.0277931690216064,-1.038684606552124,-1.049575924873352,-1.0604673624038696,-1.0713586807250977,-1.0822501182556152,-1.0931415557861328,-1.1040327548980713,-1.1149241924285889,-1.1258156299591064,-1.136707067489624,-1.1475985050201416,-1.1584898233413696,-1.1693811416625977,-1.1802726984024048,-1.1911641359329224,-1.2020554542541504,-1.2129467725753784,-1.2238383293151855,-1.2347297668457031,-1.2456210851669312,-1.2565124034881592,-1.2674037218093872,-1.2782952785491943,-1.2891864776611328,-1.30007803440094,-1.310969352722168,-1.321860671043396,-1.3327522277832031,-1.3436435461044312,-1.3545348644256592,-1.3654263019561768,-1.3763176202774048,-1.3872089385986328,-1.39810049533844,-1.4089919328689575,-1.4198832511901855,-1.4307745695114136,-1.4416658878326416,-1.4525574445724487,-1.4634487628936768,-1.4743402004241943,-1.4852315187454224,-1.4961228370666504,-1.5070143938064575,-1.5179057121276855,-1.5287971496582031,-1.5396884679794312,-1.5505797863006592,-1.5614711046218872,-1.5723626613616943,-1.583254098892212,-1.5941455364227295,-1.605036735534668,-1.615928053855896,-1.6268196105957031,-1.6377109289169312,-1.6486024856567383,-1.6594936847686768,-1.6703850030899048,-1.681276559829712,-1.69216787815094,-1.7030593156814575,-1.7139506340026855,-1.7248419523239136,-1.7357332706451416,-1.7466248273849487,-1.7575162649154663,-1.7684077024459839,-1.7792989015579224,-1.7901902198791504,-1.8010817766189575,-1.8119730949401855,-1.8228646516799927,-1.8337559700012207,-1.8446471691131592,-1.8555387258529663,-1.8664300441741943,-1.8773216009140015,-1.8882129192352295,-1.899104118347168,-1.909995436668396,-1.9208869934082031,-1.9317784309387207,-1.9426698684692383,-1.9535611867904663,-1.9644523859024048,-1.975343942642212,-1.98623526096344,-1.997126817703247,-2.0080180168151855,-2.018909454345703,-2.0298008918762207,-2.0406923294067383,-2.051583766937256,-2.0624749660491943,-2.073366403579712,-2.0842576026916504,-2.095149278640747,-2.1060407161712646,-2.116931915283203,-2.1278233528137207,-2.138714551925659,-2.149606227874756,-2.1604974269866943,-2.171388864517212,-2.1822803020477295,-2.193171501159668,-2.2040631771087646,-2.214954376220703,-2.2258460521698,-2.2367372512817383,-2.2476284503936768,-2.2585201263427734,-2.269411325454712,-2.2803027629852295,-2.291194200515747,-2.3020853996276855,-2.312976837158203,-2.3238682746887207,-2.3347597122192383,-2.345651149749756,-2.3565423488616943,-2.367433786392212,-2.3783252239227295,-2.389216661453247,-2.4001080989837646,-2.410999298095703,-2.4218907356262207,-2.4327821731567383,-2.443673610687256,-2.4545648097991943,-2.465456485748291,-2.4763476848602295,-2.487238883972168,-2.4981305599212646,-2.509021759033203,-2.5199134349823,-2.5308046340942383],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[1.0426770448684692],"y":[0.18115070462226868],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-1.277702808380127],"y":[-2.5308046340942383],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[-0.40034565329551697,-0.39889949560165405,-0.39745327830314636,-0.39600712060928345,-0.39456090331077576,-0.39311477541923523,-0.3916686177253723,-0.3902224004268646,-0.3887762427330017,-0.3873300552368164,-0.3858838677406311,-0.3844377100467682,-0.3829915225505829,-0.3815453350543976,-0.3800991475582123,-0.37865298986434937,-0.37720683217048645,-0.37576064467430115,-0.37431445717811584,-0.37286826968193054,-0.37142208218574524,-0.3699759244918823,-0.368529736995697,-0.3670835494995117,-0.3656373620033264,-0.3641912043094635,-0.3627450466156006,-0.3612988591194153,-0.35985270142555237,-0.3584064841270447,-0.35696032643318176,-0.35551413893699646,-0.35406795144081116,-0.35262179374694824,-0.35117557644844055,-0.34972941875457764,-0.3482832610607147,-0.3468370735645294,-0.3453909158706665,-0.3439447283744812,-0.3424985408782959,-0.3410523533821106,-0.3396061658859253,-0.3381600081920624,-0.3367138206958771,-0.3352676331996918,-0.33382147550582886,-0.33237528800964355,-0.33092913031578064,-0.32948294281959534,-0.32803675532341003,-0.3265905976295471,-0.32514438033103943,-0.3236982226371765,-0.3222520351409912,-0.3208058774471283,-0.319359689950943,-0.3179135024547577,-0.3164673447608948,-0.3150211572647095,-0.31357499957084656,-0.31212881207466125,-0.31068262457847595,-0.30923643708229065,-0.30779024958610535,-0.30634409189224243,-0.30489790439605713,-0.3034517168998718,-0.3020055592060089,-0.3005593717098236,-0.2991132140159607,-0.2976670563220978,-0.2962208390235901,-0.2947746515274048,-0.2933284640312195,-0.29188230633735657,-0.29043614864349365,-0.28898993134498596,-0.28754377365112305,-0.28609758615493774,-0.28465142846107483,-0.2832052707672119,-0.2817590534687042,-0.2803128957748413,-0.2788666784763336,-0.2774205207824707,-0.2759743630886078,-0.2745281755924225,-0.2730819880962372,-0.2716358006000519,-0.27018964290618896,-0.26874348521232605,-0.26729729771614075,-0.26585111021995544,-0.26440492272377014,-0.26295873522758484,-0.2615125775337219,-0.2600663900375366,-0.2586202025413513,-0.2571740448474884,-0.2557278275489807,-0.2542816698551178,-0.2528355121612549,-0.25138935446739197,-0.24994315207004547,-0.24849694967269897,-0.24705077707767487,-0.24560460448265076,-0.24415846168994904,-0.24271225929260254,-0.24126608669757843,-0.23981988430023193,-0.23837372660636902,-0.2369275689125061,-0.2354813665151596,-0.2340351939201355,-0.232588991522789,-0.2311428189277649,-0.22969667613506317,-0.22825050354003906,-0.22680430114269257,-0.22535809874534607,-0.22391194105148315,-0.22246578335762024,-0.22101961076259613,-0.21957337856292725,-0.21812720596790314,-0.21668106317520142,-0.2152348905801773,-0.2137886881828308,-0.21234248578548431,-0.2108963131904602,-0.2094501554965973,-0.20800399780273438,-0.20655779540538788,-0.20511162281036377,-0.20366542041301727,-0.20221927762031555,-0.20077310502529144,-0.19932690262794495,-0.19788073003292084,-0.19643452763557434,-0.19498838484287262,-0.1935422122478485,-0.1920960396528244,-0.1906498372554779,-0.1892036497592926,-0.1877574920654297,-0.18631131947040558,-0.18486514687538147,-0.18341894447803497,-0.18197277188301086,-0.18052659928798676,-0.17908042669296265,-0.17763425409793854,-0.17618805170059204,-0.17474187910556793,-0.17329570651054382,-0.17184953391551971,-0.1704033613204956,-0.1689571887254715,-0.167510986328125,-0.1660648137331009,-0.16461864113807678,-0.16317246854305267,-0.16172629594802856,-0.16028009355068207,-0.15883392095565796,-0.15738774836063385,-0.15594157576560974,-0.15449540317058563,-0.15304920077323914,-0.15160304307937622,-0.15015684068202972,-0.14871066808700562,-0.1472645103931427,-0.1458183377981186,-0.1443721503019333,-0.1429259479045868,-0.14147979021072388,-0.14003361761569977,-0.13858744502067566,-0.13714125752449036,-0.13569508492946625,-0.13424888253211975,-0.13280272483825684,-0.13135655224323273,-0.12991036474704742,-0.12846419215202332,-0.127018004655838,-0.1255718320608139,-0.12412566691637039,-0.12267949432134628,-0.12123329937458038,-0.11978710442781448,-0.11834093928337097,-0.11689476668834686,-0.11544860154390335,-0.11400240659713745,-0.11255624145269394,-0.11111004650592804,-0.10966388136148453,-0.10821770876646042,-0.10677151381969452,-0.10532534867525101,-0.10387915372848511,-0.1024329885840416,-0.10098681598901749,-0.09954065084457397,-0.09809445589780807,-0.09664826095104218,-0.09520208835601807,-0.09375591576099396,-0.09230975806713104,-0.09086355566978455,-0.08941739797592163,-0.08797119557857513,-0.08652502298355103,-0.08507886528968811,-0.08363266289234161,-0.0821865051984787,-0.0807403028011322,-0.0792941302061081,-0.07784797251224518,-0.07640177011489868,-0.07495561242103577,-0.07350943982601166,-0.07206325232982635,-0.07061707973480225,-0.06917090713977814,-0.06772471219301224,-0.06627854704856873,-0.06483235210180283,-0.06338617950677872,-0.061940014362335205,-0.060493819415569305,-0.059047650545835495,-0.057601459324359894,-0.05615529045462608,-0.05470912158489227,-0.05326293036341667,-0.05181676149368286,-0.05037058889865875,-0.04892439767718315,-0.04747822880744934,-0.04603205621242523,-0.04458586871623993,-0.04313969612121582,-0.04169350489974022,-0.04024733603000641],"y":[-1.7931370735168457,-1.7853680849075317,-1.7775989770889282,-1.7698301076889038,-1.7620609998703003,-1.7542920112609863,-1.7465230226516724,-1.7387540340423584,-1.7309850454330444,-1.7232160568237305,-1.715446949005127,-1.7076780796051025,-1.6999090909957886,-1.6921401023864746,-1.6843711137771606,-1.6766020059585571,-1.6688331365585327,-1.6610641479492188,-1.6532950401306152,-1.6455260515213013,-1.6377570629119873,-1.6299880743026733,-1.6222190856933594,-1.6144499778747559,-1.6066811084747314,-1.5989121198654175,-1.591143012046814,-1.5833740234375,-1.575605034828186,-1.567836046218872,-1.560067057609558,-1.5522979497909546,-1.5445289611816406,-1.5367600917816162,-1.5289911031723022,-1.5212221145629883,-1.5134530067443848,-1.5056841373443604,-1.4979151487350464,-1.4901461601257324,-1.482377052307129,-1.4746079444885254,-1.466839075088501,-1.459070086479187,-1.451301097869873,-1.4435319900512695,-1.4357631206512451,-1.4279940128326416,-1.4202250242233276,-1.4124560356140137,-1.4046869277954102,-1.3969180583953857,-1.3891489505767822,-1.3813799619674683,-1.3736109733581543,-1.3658421039581299,-1.3580729961395264,-1.3503040075302124,-1.3425350189208984,-1.334766149520874,-1.32699716091156,-1.3192280530929565,-1.3114590644836426,-1.303689956665039,-1.2959210872650146,-1.2881520986557007,-1.2803829908370972,-1.2726140022277832,-1.2648450136184692,-1.2570760250091553,-1.2493070363998413,-1.2415380477905273,-1.2337690591812134,-1.2259999513626099,-1.218230962753296,-1.210461974143982,-1.202692985534668,-1.194923996925354,-1.18715500831604,-1.179386019706726,-1.171617031097412,-1.1638481616973877,-1.1560790538787842,-1.1483100652694702,-1.1405409574508667,-1.1327720880508423,-1.1250030994415283,-1.1172341108322144,-1.1094650030136108,-1.1016958951950073,-1.093927025794983,-1.086158037185669,-1.078389048576355,-1.0706199407577515,-1.062851071357727,-1.0550819635391235,-1.0473129749298096,-1.0395439863204956,-1.0317749977111816,-1.0240060091018677,-1.0162369012832642,-1.0084679126739502,-1.0006990432739258,-0.992929995059967,-0.9851610660552979,-0.9773919582366943,-0.9696230292320251,-0.9618540406227112,-0.954085111618042,-0.9463160037994385,-0.9385470747947693,-0.9307779669761658,-0.9230090379714966,-0.9152400493621826,-0.9074709415435791,-0.8997020125389099,-0.8919329047203064,-0.8841639757156372,-0.8763949871063232,-0.868626058101654,-0.8608570098876953,-0.8530879616737366,-0.8453189730644226,-0.8375500440597534,-0.8297810554504395,-0.8220118284225464,-0.8142428994178772,-0.8064739108085632,-0.798704981803894,-0.7909358739852905,-0.7831668853759766,-0.7753978967666626,-0.7676289677619934,-0.7598599791526794,-0.7520909309387207,-0.7443219423294067,-0.7365528345108032,-0.728783905506134,-0.7210149765014648,-0.7132458686828613,-0.7054768800735474,-0.6977078914642334,-0.6899389028549194,-0.6821699738502502,-0.6744009852409363,-0.6666319370269775,-0.658862829208374,-0.6510938405990601,-0.6433249115943909,-0.6355559825897217,-0.6277868747711182,-0.6200178861618042,-0.6122488975524902,-0.6044799089431763,-0.5967109799385071,-0.5889418721199036,-0.5811729431152344,-0.5734038352966309,-0.5656349062919617,-0.5578659176826477,-0.5500969886779785,-0.542327880859375,-0.5345587730407715,-0.5267898440361023,-0.5190209150314331,-0.5112519860267639,-0.5034828782081604,-0.4957139492034912,-0.4879448413848877,-0.4801758825778961,-0.47240692377090454,-0.4646378457546234,-0.45686888694763184,-0.4490998089313507,-0.44133085012435913,-0.43356189131736755,-0.425792932510376,-0.4180239140987396,-0.4102548360824585,-0.40248584747314453,-0.39471691846847534,-0.3869479298591614,-0.37917885184288025,-0.37140989303588867,-0.36364084482192993,-0.35587188601493835,-0.3481029272079468,-0.34033384919166565,-0.3325648903846741,-0.32479584217071533,-0.31702688336372375,-0.3092579245567322,-0.3014889657497406,-0.2937198877334595,-0.28595080971717834,-0.27818185091018677,-0.2704128921031952,-0.2626439332962036,-0.2548748552799225,-0.2471058964729309,-0.23933684825897217,-0.2315678894519806,-0.223798930644989,-0.2160298377275467,-0.20826087892055511,-0.2004917860031128,-0.1927228420972824,-0.18495391309261322,-0.17718495428562164,-0.16941586136817932,-0.1616467833518982,-0.15387782454490662,-0.14610886573791504,-0.13833990693092346,-0.13057085871696472,-0.12280189245939255,-0.11503282189369202,-0.10726386308670044,-0.09949490427970886,-0.09172583371400833,-0.08395687490701675,-0.07618780434131622,-0.06841884553432465,-0.06064988672733307,-0.052880823612213135,-0.04511186480522156,-0.03734290599822998,-0.02957381308078766,-0.021804869174957275,-0.014035910367965698,-0.00626683235168457,0.0015021264553070068,0.009271197021007538,0.01704014092683792,0.0248090997338295,0.032578177750110626,0.0403471365571022,0.048116207122802734,0.05588516592979431,0.06365411728620529,0.07142320275306702,0.0791921615600586,0.08696112036705017,0.0947301834821701,0.10249914228916168,0.11026810109615326,0.11803717911243439,0.12580613791942596,0.1335752010345459,0.14134415984153748],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.40034565329551697],"y":[-1.7931370735168457],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.04024733603000641],"y":[0.14134415984153748],"z":[1],"type":"scatter3d"},{"line":{"color":"rgb(240,228,66)","width":2},"mode":"lines","opacity":0.7,"showlegend":false,"x":[0.048506543040275574,0.04672415181994438,0.044941749423742294,0.0431593582034111,0.04137695953249931,0.03959456831216812,0.03781216964125633,0.03602977469563484,0.03424737975001335,0.03246498480439186,0.030682586133480072,0.02890019305050373,0.02711779810488224,0.0253354012966156,0.02355300821363926,0.02177061140537262,0.01998821459710598,0.01820582151412964,0.016423424705863,0.01464102789759636,0.01285862922668457,0.011076238006353378,0.00929383933544159,0.007511444389820099,0.005729053169488907,0.003946654498577118,0.0021642595529556274,0.00038186460733413696,-0.001400526612997055,-0.0031829290091991425,-0.0049653202295303345,-0.006747718900442123,-0.008530113846063614,-0.010312512516975403,-0.012094903737306595,-0.013877294957637787,-0.015659697353839874,-0.017442092299461365,-0.019224483519792557,-0.021006878465414047,-0.022789280861616135,-0.024571679532527924,-0.026354067027568817,-0.02813645824790001,-0.029918860644102097,-0.031701259315013885,-0.03348365053534508,-0.03526604175567627,-0.03704843670129776,-0.038830842822790146,-0.04061323404312134,-0.04239562153816223,-0.04417802020907402,-0.045960426330566406,-0.0477428138256073,-0.04952520504593849,-0.05130760371685028,-0.05309000983834267,-0.05487239733338356,-0.05665478855371475,-0.05843718349933624,-0.06021958217024803,-0.06200198084115982,-0.06378437578678131,-0.0655667632818222,-0.06734916567802429,-0.06913156807422638,-0.07091395556926727,-0.07269635051488876,-0.07447874546051025,-0.07626113295555115,-0.07804353535175323,-0.07982593029737473,-0.08160833269357681,-0.0833907276391983,-0.0851731151342392,-0.08695551753044128,-0.08873791247606277,-0.09052029997110367,-0.09230269491672516,-0.09408510476350784,-0.09586749225854874,-0.09764990210533142,-0.09943227469921112,-0.10121467709541321,-0.1029970794916153,-0.10477945953607559,-0.10656186193227768,-0.10834427177906036,-0.11012665927410126,-0.11190906167030334,-0.11369143426418304,-0.11547384411096573,-0.11725624650716782,-0.11903862655162811,-0.1208210289478302,-0.1226034164428711,-0.12438581883907318,-0.12616822123527527,-0.12795060873031616,-0.12973301112651825,-0.13151541352272034,-0.13329778611660004,-0.13508018851280212,-0.13686257600784302,-0.1386449933052063,-0.1404273957014084,-0.14220976829528809,-0.14399217069149017,-0.14577455818653107,-0.14755696058273315,-0.14933936297893524,-0.15112175047397614,-0.15290415287017822,-0.1546865552663803,-0.15646892786026,-0.1582513451576233,-0.16003373265266418,-0.16181612014770508,-0.16359852254390717,-0.16538091003894806,-0.16716331243515015,-0.16894571483135223,-0.17072810232639313,-0.17251050472259521,-0.1742929220199585,-0.1760753095149994,-0.17785769701004028,-0.17964008450508118,-0.18142250180244446,-0.18320490419864655,-0.18498729169368744,-0.18676967918872833,-0.18855205178260803,-0.1903344839811325,-0.1921168565750122,-0.1938992738723755,-0.19568166136741638,-0.19746403396129608,-0.19924646615982056,-0.20102885365486145,-0.20281125605106354,-0.20459364354610443,-0.20637601613998413,-0.20815840363502502,-0.2099408209323883,-0.2117232382297516,-0.21350562572479248,-0.21528799831867218,-0.21707038581371307,-0.21885280311107635,-0.22063517570495605,-0.22241760790348053,-0.22419999539852142,-0.22598236799240112,-0.2277647852897644,-0.2295471578836441,-0.23132959008216858,-0.23311197757720947,-0.23489435017108917,-0.23667675256729126,-0.23845915496349335,-0.24024155735969543,-0.24202394485473633,-0.24380634725093842,-0.24558871984481812,-0.2473711222410202,-0.2491535246372223,-0.25093594193458557,-0.2527182996273041,-0.25450071692466736,-0.25628310441970825,-0.25806549191474915,-0.2598479092121124,-0.2616302967071533,-0.2634126842021942,-0.2651950716972351,-0.2669774889945984,-0.26875990629196167,-0.2705422639846802,-0.27232468128204346,-0.27410703897476196,-0.27588945627212524,-0.27767184376716614,-0.2794542610645294,-0.2812366485595703,-0.2830190360546112,-0.2848014533519745,-0.286583811044693,-0.2883662283420563,-0.29014864563941956,-0.29193100333213806,-0.29371339082717896,-0.29549580812454224,-0.2972782254219055,-0.299060583114624,-0.3008430004119873,-0.3026253879070282,-0.3044077754020691,-0.3061901926994324,-0.30797258019447327,-0.30975496768951416,-0.31153738498687744,-0.31331977248191833,-0.31510215997695923,-0.3168845474720001,-0.3186669647693634,-0.3204493224620819,-0.3222317099571228,-0.32401415705680847,-0.32579654455184937,-0.32757893204689026,-0.32936131954193115,-0.33114370703697205,-0.3329261243343353,-0.3347085118293762,-0.3364909291267395,-0.338273286819458,-0.3400556743144989,-0.34183812141418457,-0.3436204791069031,-0.34540289640426636,-0.34718528389930725,-0.34896767139434814,-0.35075005888938904,-0.3525324761867523,-0.3543148636817932,-0.3560972511768341,-0.3578796684741974,-0.3596620261669159,-0.3614444434642792,-0.3632268011569977,-0.36500924825668335,-0.36679163575172424,-0.36857399344444275,-0.3703564405441284,-0.3721387982368469,-0.3739212155342102,-0.3757036328315735,-0.377485990524292,-0.3792684078216553,-0.38105079531669617,-0.38283318281173706,-0.38461560010910034,-0.38639795780181885,-0.38818037509918213,-0.389962762594223,-0.3917451500892639,-0.3935275673866272,-0.3953099548816681],"y":[0.2843315601348877,0.2836419641971588,0.28295236825942993,0.28226274251937866,0.2815731167793274,0.2808835506439209,0.280193954706192,0.27950432896614075,0.27881473302841187,0.278125137090683,0.2774355411529541,0.2767459452152252,0.27605631947517395,0.27536672353744507,0.2746771275997162,0.2739875018596649,0.27329790592193604,0.27260830998420715,0.2719186842441559,0.2712291181087494,0.2705394923686981,0.26984986662864685,0.26916030049324036,0.2684706747531891,0.2677811086177826,0.2670914828777313,0.26640185713768005,0.26571229100227356,0.2650226950645447,0.2643330693244934,0.2636434733867645,0.26295387744903564,0.2622642517089844,0.2615746557712555,0.2608850598335266,0.26019543409347534,0.25950583815574646,0.2588162422180176,0.2581266462802887,0.2574370503425598,0.25674742460250854,0.25605782866477966,0.2553682327270508,0.2546786367893219,0.253989040851593,0.25329941511154175,0.25260981917381287,0.2519201934337616,0.2512306272983551,0.25054100155830383,0.24985140562057495,0.24916179478168488,0.2484721839427948,0.2477826029062271,0.24709299206733704,0.24640339612960815,0.24571378529071808,0.245024174451828,0.24433456361293793,0.24364498257637024,0.24295538663864136,0.2422657608985901,0.2415761649608612,0.24088655412197113,0.24019697308540344,0.23950736224651337,0.2388177514076233,0.2381281554698944,0.23743852972984314,0.23674893379211426,0.23605935275554657,0.2353697419166565,0.23468013107776642,0.23399052023887634,0.23330092430114746,0.23261132836341858,0.2319217324256897,0.23123212158679962,0.23054251074790955,0.22985289990901947,0.2291633039712906,0.2284737229347229,0.22778409719467163,0.22709450125694275,0.22640489041805267,0.2257152795791626,0.2250256985425949,0.22433610260486603,0.22364649176597595,0.22295686602592468,0.2222672700881958,0.22157767415046692,0.22088807821273804,0.22019846737384796,0.21950887143611908,0.218819260597229,0.21812964975833893,0.21744006872177124,0.21675045788288116,0.2160608470439911,0.215371236205101,0.21468164026737213,0.21399205923080444,0.21330244839191437,0.2126128375530243,0.21192322671413422,0.21123361587524414,0.21054401993751526,0.20985443890094757,0.2091648280620575,0.20847521722316742,0.20778560638427734,0.20709601044654846,0.20640641450881958,0.2057168036699295,0.20502720773220062,0.20433759689331055,0.20364798605442047,0.2029583901166916,0.2022688090801239,0.20157918334007263,0.20088957250118256,0.20019997656345367,0.1995103657245636,0.1988207846879959,0.19813114404678345,0.19744156301021576,0.19675195217132568,0.1960623562335968,0.19537274539470673,0.19468313455581665,0.19399355351924896,0.1933039426803589,0.19261434674263,0.19192473590373993,0.19123512506484985,0.19054551422595978,0.1898559331893921,0.18916632235050201,0.18847671151161194,0.18778711557388306,0.18709751963615417,0.1864079087972641,0.18571831285953522,0.18502870202064514,0.18433910608291626,0.18364949524402618,0.1829598844051361,0.18227028846740723,0.18158069252967834,0.18089108169078827,0.1802014857530594,0.1795118749141693,0.17882227897644043,0.17813268303871155,0.17744305729866028,0.1767534613609314,0.17606386542320251,0.17537426948547363,0.17468465864658356,0.17399506270885468,0.1733054518699646,0.17261584103107452,0.17192624509334564,0.17123663425445557,0.17054703831672668,0.1698574423789978,0.16916783154010773,0.16847822070121765,0.16778862476348877,0.1670990288257599,0.1664094179868698,0.16571980714797974,0.16503021121025085,0.16434061527252197,0.1636510044336319,0.1629614233970642,0.16227179765701294,0.16158218681812286,0.16089260578155518,0.1602029949426651,0.15951339900493622,0.15882378816604614,0.15813419222831726,0.157444566488266,0.1567549705505371,0.15606537461280823,0.15537576377391815,0.15468616783618927,0.1539965569972992,0.1533069610595703,0.15261736512184143,0.15192776918411255,0.15123814344406128,0.1505485475063324,0.14985893666744232,0.14916934072971344,0.14847974479198456,0.14779013395309448,0.1471005380153656,0.14641092717647552,0.14572133123874664,0.14503172039985657,0.14434212446212769,0.1436525136232376,0.14296290278434753,0.14227330684661865,0.14158371090888977,0.1408941149711609,0.1402045041322708,0.13951489329338074,0.13882529735565186,0.13813568651676178,0.1374460905790329,0.13675647974014282,0.13606688380241394,0.13537727296352386,0.13468767702579498,0.1339980810880661,0.13330847024917603,0.13261887431144714,0.13192926347255707,0.13123966753482819,0.1305500566959381,0.12986044585704803,0.12917084991931915,0.12848125398159027,0.1277916431427002,0.1271020472049713,0.12641245126724243,0.12572282552719116,0.12503322958946228,0.1243436262011528,0.12365402281284332,0.12296442687511444,0.12227481603622437,0.12158521264791489,0.12089560925960541,0.12020600587129593,0.11951641738414764,0.11882680654525757,0.11813720315694809,0.11744760721921921,0.11675799638032913,0.11606839299201965,0.11537879705429077,0.1146891862154007,0.11399958282709122,0.11330997943878174,0.11262037605047226],"z":[0.0,0.00401606410741806,0.00803212821483612,0.012048192322254181,0.01606425642967224,0.0200803205370903,0.024096384644508362,0.028112448751926422,0.03212851285934448,0.03614457696676254,0.0401606410741806,0.04417670518159866,0.048192769289016724,0.052208833396434784,0.056224897503852844,0.060240961611270905,0.06425702571868896,0.06827308982610703,0.07228915393352509,0.07630521804094315,0.0803212821483612,0.08433734625577927,0.08835341036319733,0.09236947447061539,0.09638553857803345,0.10040160268545151,0.10441766679286957,0.10843373090028763,0.11244979500770569,0.11646585911512375,0.12048192322254181,0.12449798732995987,0.12851405143737793,0.1325301229953766,0.13654617965221405,0.1405622363090515,0.14457830786705017,0.14859437942504883,0.1526104360818863,0.15662649273872375,0.1606425642967224,0.16465863585472107,0.16867469251155853,0.172690749168396,0.17670682072639465,0.1807228922843933,0.18473894894123077,0.18875500559806824,0.1927710771560669,0.19678714871406555,0.20080320537090302,0.20481926202774048,0.20883533358573914,0.2128514051437378,0.21686746180057526,0.22088351845741272,0.22489959001541138,0.22891566157341003,0.2329317182302475,0.23694777488708496,0.24096384644508362,0.24497991800308228,0.24899597465991974,0.2530120313167572,0.25702810287475586,0.2610441744327545,0.2650602459907532,0.26907628774642944,0.2730923593044281,0.27710843086242676,0.281124472618103,0.2851405441761017,0.28915661573410034,0.293172687292099,0.29718875885009766,0.3012048006057739,0.3052208721637726,0.30923694372177124,0.3132529854774475,0.31726905703544617,0.3212851285934448,0.3253012001514435,0.32931727170944214,0.3333333134651184,0.33734938502311707,0.3413654565811157,0.345381498336792,0.34939756989479065,0.3534136414527893,0.35742971301078796,0.3614457845687866,0.3654618263244629,0.36947789788246155,0.3734939694404602,0.3775100111961365,0.38152608275413513,0.3855421543121338,0.38955822587013245,0.3935742974281311,0.3975903391838074,0.40160641074180603,0.4056224822998047,0.40963852405548096,0.4136545956134796,0.41767066717147827,0.42168673872947693,0.4257028102874756,0.42971885204315186,0.4337349236011505,0.43775099515914917,0.44176703691482544,0.4457831084728241,0.44979918003082275,0.4538152515888214,0.45783132314682007,0.46184736490249634,0.465863436460495,0.46987950801849365,0.4738955497741699,0.4779116213321686,0.48192769289016724,0.4859437644481659,0.48995983600616455,0.4939758777618408,0.4979919493198395,0.5020080804824829,0.5060241222381592,0.5100401639938354,0.5140562057495117,0.5180723071098328,0.5220884084701538,0.5261044502258301,0.5301204919815063,0.5341365337371826,0.5381526350975037,0.5421686768531799,0.546184778213501,0.5502008199691772,0.5542168617248535,0.5582329630851746,0.5622490048408508,0.5662651062011719,0.5702811479568481,0.5742971897125244,0.5783132314682007,0.5823293328285217,0.5863454341888428,0.590361475944519,0.5943775177001953,0.5983935594558716,0.6024096608161926,0.6064257025718689,0.6104418039321899,0.6144578456878662,0.6184738874435425,0.6224899888038635,0.6265060305595398,0.6305221319198608,0.6345381736755371,0.6385542154312134,0.6425702571868896,0.6465863585472107,0.6506024599075317,0.654618501663208,0.6586345434188843,0.6626505851745605,0.6666666865348816,0.6706827282905579,0.6746988296508789,0.6787148714065552,0.6827309131622314,0.6867470145225525,0.6907630562782288,0.6947791576385498,0.6987951993942261,0.7028112411499023,0.7068272829055786,0.7108433842658997,0.7148594856262207,0.718875527381897,0.7228915691375732,0.7269076108932495,0.7309237122535706,0.7349397540092468,0.7389558553695679,0.7429718971252441,0.7469879388809204,0.7510040402412415,0.7550200819969177,0.7590361833572388,0.763052225112915,0.7670682668685913,0.7710843086242676,0.7751004099845886,0.7791165113449097,0.7831325531005859,0.7871485948562622,0.7911646366119385,0.7951807379722595,0.7991967797279358,0.8032128810882568,0.8072289228439331,0.8112449645996094,0.8152610659599304,0.8192771077156067,0.8232932090759277,0.827309250831604,0.8313252925872803,0.8353413343429565,0.8393574357032776,0.8433735370635986,0.8473895788192749,0.8514056205749512,0.8554216623306274,0.8594377636909485,0.8634538054466248,0.8674699068069458,0.8714859485626221,0.8755019903182983,0.8795180916786194,0.8835341334342957,0.8875502347946167,0.891566276550293,0.8955823183059692,0.8995984196662903,0.9036144614219666,0.9076305031776428,0.9116466045379639,0.9156626462936401,0.9196786880493164,0.9236947894096375,0.9277108311653137,0.9317269325256348,0.935742974281311,0.9397590160369873,0.9437751173973083,0.9477911591529846,0.9518072605133057,0.9558233022689819,0.9598393440246582,0.9638554453849792,0.9678714871406555,0.9718875288963318,0.9759036302566528,0.9799196720123291,0.9839357137680054,0.9879518151283264,0.9919678568840027,0.9959839582443237,1.0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[0.048506543040275574],"y":[0.2843315601348877],"z":[0],"type":"scatter3d"},{"marker":{"color":"rgb(240,228,66)","line":{"color":"rgb(240,228,66)","width":2},"size":4},"mode":"markers","showlegend":false,"x":[-0.3953099548816681],"y":[0.11262037605047226],"z":[1],"type":"scatter3d"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"xaxis":{"title":{"text":"X"}},"yaxis":{"title":{"text":"Y"}},"zaxis":{"title":{"text":"Time"}},"aspectratio":{"x":1,"y":1,"z":0.5},"camera":{"eye":{"x":1.5,"y":1.5,"z":1}},"aspectmode":"manual"},"legend":{"title":{"text":"Distribution"},"tracegroupgap":0},"margin":{"t":30,"l":0,"r":0,"b":0}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8f48029a-7ec5-4017-a7e2-6a1346ed0c7d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Straight Trajectories == Linear Interpolation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The idea of guessing straight trajectories at constant speed is <em>identical</em> to simple linear interpolation between source and target data points.<sup>1</sup></p>
</div>
</div>
<p>There are big issues with doing this: The random pairing results in lots of trajectories that cross each other. But this is a <em>starting point</em> for Flow Matching. So in other words, when training a Flow Matching model…</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/gb-well-cross-streams.gif" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>…well, ok not quite: we’re going to allow the <em>trajectories of individual points</em> to cross as we train the model. This <em>is</em> a bit “confusing” for the model, which will be trying to learn a velocity field, and that isn’t defined where trajectories cross. Eventually, however, the model will learn to estimate the <em>aggregated motion</em> of many particles, which will sort of average out to arrive at the “bulk motion” of the flow. This is similar to how the Brownian motion <span class="citation" data-cites="brownian_motion">[9]</span> of many air or water particles averages out on the macroscopic level, giving us streamlines that don’t cross.<sup>2</sup></p>
<p>This is why flow matching is about transforming <em>distributions</em>, not individual points. The learned velocity field might not exactly match any of our training trajectories, but it captures the statistical flow needed to transform one distribution into another.</p>
<p>Here’s a visualization from the code we’ll execute later in the lesson. We’ll plot…</p>
<ol type="1">
<li>Our naive training trajectories (with crossings)</li>
<li>The actual learned flow field (i.e., the velocity vector field)</li>
<li>The paths (aka “trajectories”) that data points follow when flowing with the learned field</li>
</ol>
<p><img src="https://drscotthawley.github.io/blog/posts/images/cross_uncross_plot.png" class="img-fluid"> Left: Training data uses simple straight lines (with many crossings). Middle: The learned flow (velocity vector) field is smooth and continuous. Right: Actual trajectories following the flow field don’t cross.</p>
</section>
<section id="how-are-flows-learned" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="how-are-flows-learned"><span class="header-section-number">2.2</span> How Are Flows “Learned”?</h2>
<p>The goal of the machine learning system is as follows: for any point in space and any time t between 0 and 1, we want to learn the correct <em>velocity</em> (direction and speed) that point should move. It’s like learning the “wind map” that will blow the starting distribution cloud into the shape of the target distribution cloud.</p>
<p>Since neural networks are such useful engines for approximation and interpolation, we’ll let a neural network “learn” to estimate the mapping between locations and times (as inputs), and velocities (as outputs).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Terminology: &quot;Simulation Free&quot;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology: “Simulation Free”
</div>
</div>
<div class="callout-body-container callout-body">
<p>You’ll sometimes see flow-maching models being referred to as “simulation free.” This is just an indication that the flow we arrive at is not the result of any explicit simulation of any process (physical or otherwise). The flow obtained arises simply from the aggregation (or “averaging out”) of many particles moving along imagined straight lines and crossing paths.</p>
</div>
</div>
<section id="the-neural-networks-job" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="the-neural-networks-job"><span class="header-section-number">2.2.1</span> The Neural Network’s Job</h3>
<p>The neural network has one job: given a position in space and a time, to output a velocity vector. <em>That’s all it does.</em> Below is the code for this model that will “learn” to estimate velocity vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> nn</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn.functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> F</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> VelocityNet(nn.Module):</span>
<span id="cb6-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, input_dim, h_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>):</span>
<span id="cb6-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb6-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc_in  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(input_dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, h_dim)</span>
<span id="cb6-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc2    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(h_dim, h_dim)</span>
<span id="cb6-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc3    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(h_dim, h_dim)</span>
<span id="cb6-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc_out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(h_dim, input_dim)</span>
<span id="cb6-11">    </span>
<span id="cb6-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x, t, act<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>F.gelu):</span>
<span id="cb6-13">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t.expand(x.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure t has the correct dimensions</span></span>
<span id="cb6-14">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([x, t], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-15">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> act(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc_in(x))</span>
<span id="cb6-16">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> act(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc2(x))</span>
<span id="cb6-17">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> act(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc3(x))</span>
<span id="cb6-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.fc_out(x)</span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instantiate the model</span></span>
<span id="cb6-21">input_dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-22">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> VelocityNet(input_dim)</span></code></pre></div>
</div>
<p>…That’s it! Looks pretty simple, right? That’s because to make the system work we’ll need more than just the velocity field model.</p>
<p>Apart from the velocity model (i.e., the neural network, for us), the rest of the software system then uses these generated velocities to move points around. The model’s velocities are then used in a differential equation describing the small change to each particle’s position <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Br%7D"> over a short time <img src="https://latex.codecogs.com/png.latex?dt">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20d%5Cvec%7Br%7D%20=%20%5Cvec%7Bv%7D(%5Cvec%7Br%7D,t)%20dt"></p>
<p>That equation is integrated by some (totally separate) numerical integration routine. A popular choice in the machine learning world is the “forward Euler” method, which is simple to implement, but will need to be upgraded (see further below) to get good results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> fwd_euler_step(model, current_points, current_t, dt):</span>
<span id="cb7-3">    velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current_points, current_t)</span>
<span id="cb7-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt </span></code></pre></div>
</div>
<div class="cell">
<details>
<summary>Integrator code: generate/predict samples using the trained model</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb8-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> integrate_path(model, initial_points, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fwd_euler_step, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb8-3">                   save_trajectories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb8-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""this 'sampling' routine is primarily used for visualization."""</span></span>
<span id="cb8-5">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb8-6">    current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_points.clone()</span>
<span id="cb8-7">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,n_steps).to(device)</span>
<span id="cb8-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> warp_fn: ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_fn(ts)</span>
<span id="cb8-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> save_trajectories: trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [current_points]    </span>
<span id="cb8-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb8-11">        current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step_fn(model, current_points, ts[i], ts[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ts[i])</span>
<span id="cb8-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> save_trajectories: trajectories.append(current_points)</span>
<span id="cb8-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> save_trajectories: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> current_points, torch.stack(trajectories).cpu()</span>
<span id="cb8-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> current_points </span>
<span id="cb8-15"></span>
<span id="cb8-16">generate_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just lil' alias for the probability / diffusion model crowd ;-) </span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="training-code" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="training-code"><span class="header-section-number">2.3</span> Training Code</h2>
<p>The goal of the training code is twofold:</p>
<ol type="1">
<li>to expose the model to as many locations and times as possible – at least for those times &amp; locations that “matter most”. This exposure is what I’ll refer to as “coverage”.</li>
<li>to force the model to learn to generate (approximately) correct velocities at those times and locations.</li>
</ol>
<p>That’s it. The training code doesn’t actually do any integration or “solving,” but we’ll typically execute the integration on some validation data during training just to visualize “how we’re doing” as the training progresses.</p>
<div class="cell">
<details>
<summary>Viz code: calls integrator to calc motion given v field, makes pictures</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> viz(val_points, target_samples, trained_model, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,):</span>
<span id="cb9-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate and visualize new samples</span></span>
<span id="cb9-3">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(trained_model.parameters()).device</span>
<span id="cb9-4">    generated_samples, trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(trained_model, val_points.to(device), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_steps, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_fn, save_trajectories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb9-5"></span>
<span id="cb9-6">    n_viz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(trajectories[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of trajectories to visualize</span></span>
<span id="cb9-7">    </span>
<span id="cb9-8">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb9-9">    data_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [val_points.cpu(), generated_samples.cpu(), target_samples.cpu()] </span>
<span id="cb9-10">    label_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Initial Points'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Generated Samples'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Target Data'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Trajectories'</span>]</span>
<span id="cb9-11">    color_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [source_color, pred_color, target_color]</span>
<span id="cb9-12">    global_max <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>( torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(torch.cat(data_list)),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],  torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(torch.cat(data_list)),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] )</span>
<span id="cb9-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(label_list)):</span>
<span id="cb9-14">        ax[i].set_title(label_list[i]) </span>
<span id="cb9-15">        ax[i].set_xlim([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>global_max, global_max]) </span>
<span id="cb9-16">        ax[i].set_ylim([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>global_max, global_max])</span>
<span id="cb9-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># non-trajectory plots</span></span>
<span id="cb9-18">            ax[i].scatter( data_list[i][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data_list[i][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>size, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, </span>
<span id="cb9-19">                          label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label_list[i], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color_list[i])</span>
<span id="cb9-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb9-21">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot trajectory paths first</span></span>
<span id="cb9-22">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_viz):</span>
<span id="cb9-23">                path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trajectories[:, j]</span>
<span id="cb9-24">                ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>].plot(path[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], path[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-25">            </span>
<span id="cb9-26">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then plot start and end points for the SAME trajectories</span></span>
<span id="cb9-27">            start_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trajectories[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :n_viz]</span>
<span id="cb9-28">            end_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trajectories[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :n_viz]  </span>
<span id="cb9-29">            ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>].scatter(start_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], start_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>source_color, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>size, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Source Points'</span>)</span>
<span id="cb9-30">            ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>].scatter(end_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], end_points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pred_color, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>size, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Current Endpoints'</span>)</span>
<span id="cb9-31">            ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>].legend()</span>
<span id="cb9-32"></span>
<span id="cb9-33">    plt.show()</span>
<span id="cb9-34">    plt.close()</span>
<span id="cb9-35"></span>
<span id="cb9-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the data</span></span>
<span id="cb9-37">n_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb9-38">source_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_source_data(n_samples)</span>
<span id="cb9-39">target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_target_data(n_samples)</span>
<span id="cb9-40">val_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_source_data(n_samples)</span>
<span id="cb9-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Testing visualization routines (before training):"</span>) </span>
<span id="cb9-42">viz(val_points, target_samples,  model) </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Testing visualization routines (before training):</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The clever part about flow matching is how we train this network. For each training step:</p>
<ol type="1">
<li>Sample random points from our source and target distributions, and pair the points</li>
<li>Sample random times between 0 and 1</li>
<li>Calculate the locations where these points <em>would</em> be at those times if they were moving at constant velocity from source to target locations</li>
<li>Calculate what velocity they <em>would</em> have at those locations if they were moving at constant velocity</li>
<li>Train the network to <em>predict</em> these velocities – which will end up “seeking the mean” when the network has to do the same for many, many points.</li>
</ol>
<p>Some readers may be skeptical: “Could such a scheme even work?” Theoretical assurances to that effect are where the pages probability-math come in. However, machine learning is also an experimental science, as in “Try it and find out!” ;-)</p>
<p>Here we run the training code…</p>
<div class="cell">
<details>
<summary>Code for train_model() training loop</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.optim <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> optim</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train_model(model, n_epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.003</span>, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>, status_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, viz_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb11-4">    optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> optim.Adam(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lr)</span>
<span id="cb11-5">    loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.MSELoss()</span>
<span id="cb11-6">    step, n_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb11-7">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb11-8">    </span>
<span id="cb11-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_epochs):</span>
<span id="cb11-10">        model.train()</span>
<span id="cb11-11">        pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_steps), leave<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb11-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> pbar:</span>
<span id="cb11-13">            step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-14">            optimizer.zero_grad()</span>
<span id="cb11-15">    </span>
<span id="cb11-16">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by randomly generating new data each step, we prevent the model from merely memorizing</span></span>
<span id="cb11-17">            source_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_source_data(batch_size).to(device)</span>
<span id="cb11-18">            target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_target_data(batch_size).to(device)</span>
<span id="cb11-19">            </span>
<span id="cb11-20">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(source_samples.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).to(device)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random times for traning</span></span>
<span id="cb11-21">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> warp_fn: t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_fn(t)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time warp is good for coverage but not as helpful for training as it is during integration/sampling</span></span>
<span id="cb11-22">            interpolated_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t</span>
<span id="cb11-23">            line_directions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> source_samples</span>
<span id="cb11-24">            </span>
<span id="cb11-25">            drift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(interpolated_samples, t)</span>
<span id="cb11-26">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(drift, line_directions)</span>
<span id="cb11-27">            </span>
<span id="cb11-28">            loss.backward()</span>
<span id="cb11-29">            optimizer.step()</span>
<span id="cb11-30"></span>
<span id="cb11-31">            status_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Epoch [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">], Loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb11-32">            pbar.set_description(status_str)</span>
<span id="cb11-33">        </span>
<span id="cb11-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> viz_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb11-35">            model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb11-36">            clear_output(wait<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clear previous plots</span></span>
<span id="cb11-37">            viz(val_points, target_samples[:val_points.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], model)</span>
<span id="cb11-38">            plt.show()</span>
<span id="cb11-39">            plt.close()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the figure to free memory</span></span>
<span id="cb11-40">            model.train()</span>
<span id="cb11-41">            </span>
<span id="cb11-42">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>n_epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(status_str)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep last status from being cleared</span></span>
<span id="cb11-43">    </span>
<span id="cb11-44">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> model</span>
<span id="cb11-45"></span>
<span id="cb11-46"></span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">fm_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_model(model, n_epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this will take a couple minutes</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [100/100], Loss: 1.8458</code></pre>
</div>
</div>
<p>Here’s an animation of integrating points along our model’s flow from start to finish:</p>
<div class="cell">
<details>
<summary>Code for animating points in flow</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.animation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> animation</span>
<span id="cb14-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTML, display, clear_output</span>
<span id="cb14-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rc</span>
<span id="cb14-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb14-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_flow_animation(start_dist, models, titles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, n_frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb14-8">                         step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fwd_euler_step, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>):</span>
<span id="cb14-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb14-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Create an animation showing multiple distribution flows</span></span>
<span id="cb14-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb14-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb14-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        start_dist: Starting distribution</span></span>
<span id="cb14-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        models: List of models to animate</span></span>
<span id="cb14-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        titles: List of titles for each subplot (optional)</span></span>
<span id="cb14-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        figsize: Figure size (optional)</span></span>
<span id="cb14-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        n_frames: Number of animation frames</span></span>
<span id="cb14-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        integrator: Integration function to use</span></span>
<span id="cb14-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        jitter: Amount of jitter to add</span></span>
<span id="cb14-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        save_file: Path to save animation (optional)</span></span>
<span id="cb14-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        height: Height of each subplot</span></span>
<span id="cb14-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb14-23">    plt.close(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'all'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close all open figures</span></span>
<span id="cb14-24">    </span>
<span id="cb14-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(models, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>): models <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [models]</span>
<span id="cb14-26">    n_plots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(models)</span>
<span id="cb14-27">    </span>
<span id="cb14-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> titles <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb14-29">        titles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Flow </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_plots)]</span>
<span id="cb14-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(titles) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> n_plots:</span>
<span id="cb14-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of titles (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(titles)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) must match number of models (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_plots<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>)</span>
<span id="cb14-32">    </span>
<span id="cb14-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate figure size</span></span>
<span id="cb14-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> figsize <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb14-35">        figsize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_plots, height]</span>
<span id="cb14-36">    </span>
<span id="cb14-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create subplots</span></span>
<span id="cb14-38">    fig, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_plots, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>figsize)</span>
<span id="cb14-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> n_plots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb14-40">        axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [axes]</span>
<span id="cb14-41">    plt.close()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the figure immediately</span></span>
<span id="cb14-42"></span>
<span id="cb14-43">    </span>
<span id="cb14-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize scatters and trajectories</span></span>
<span id="cb14-45">    scatters <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-46">    all_trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-47">    </span>
<span id="cb14-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate trajectories for each model</span></span>
<span id="cb14-49">    max_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(start_dist).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item()</span>
<span id="cb14-50">    </span>
<span id="cb14-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, model <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(models):</span>
<span id="cb14-52">        device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb14-53">        end_dist, trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(model, start_dist.clone().to(device), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_frames,  </span>
<span id="cb14-54">                                          step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>step_fn, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_fn, save_trajectories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb14-55">        all_trajectories.append(trajectories.cpu())</span>
<span id="cb14-56">        scatters.append(axes[i].scatter([], [], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wong_pink))</span>
<span id="cb14-57">        </span>
<span id="cb14-58">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update max range</span></span>
<span id="cb14-59">        max_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(max_range, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(end_dist.cpu()).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item())</span>
<span id="cb14-60">    </span>
<span id="cb14-61">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up axes</span></span>
<span id="cb14-62">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(axes):</span>
<span id="cb14-63">        ax.set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb14-64">        ax.set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb14-65">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb14-66">        ax.set_xticks([])</span>
<span id="cb14-67">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> spine <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>]:</span>
<span id="cb14-68">            ax.spines[spine].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb14-69">        ax.set_title(titles[i])</span>
<span id="cb14-70">    </span>
<span id="cb14-71">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> init():</span>
<span id="cb14-72">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Initialize animation"""</span></span>
<span id="cb14-73">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> scatter <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> scatters:</span>
<span id="cb14-74">            scatter.set_offsets(np.c_[[], []])</span>
<span id="cb14-75">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(scatters)</span>
<span id="cb14-76">    </span>
<span id="cb14-77">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> animate(frame):</span>
<span id="cb14-78">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Update animation frame"""</span></span>
<span id="cb14-79">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update axis limits (in case they need to be adjusted)</span></span>
<span id="cb14-80">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> axes:</span>
<span id="cb14-81">            ax.set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb14-82">            ax.set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb14-83">        </span>
<span id="cb14-84">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update scatter positions</span></span>
<span id="cb14-85">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> scatter, trajectories <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(scatters, all_trajectories):</span>
<span id="cb14-86">            scatter.set_offsets(trajectories[frame].numpy())</span>
<span id="cb14-87">        </span>
<span id="cb14-88">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(scatters)</span>
<span id="cb14-89">    </span>
<span id="cb14-90">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create animation</span></span>
<span id="cb14-91">    anim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> animation.FuncAnimation(fig, animate, init_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>init,</span>
<span id="cb14-92">                                 frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_frames, interval<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, blit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb14-93">    </span>
<span id="cb14-94">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle saving or displaying</span></span>
<span id="cb14-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> save_file:</span>
<span id="cb14-96">        os.makedirs(os.path.dirname(save_file), exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb14-97">        anim.save(save_file, writer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ffmpeg'</span>, fps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb14-98">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> HTML(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""&lt;center&gt;&lt;video height="350" controls loop&gt;&lt;source src="</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>anim_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">" type="video/mp4"&gt;</span></span>
<span id="cb14-99"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">              Your browser does not support the video tag. &lt;/video&gt;&lt;/center&gt;"""</span>)</span>
<span id="cb14-100">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># direct matplotlib anim offers better controls but makes ipynb file size huge</span></span>
<span id="cb14-101">        rc(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'animation'</span>, html<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'jshtml'</span>)</span>
<span id="cb14-102">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> HTML(anim.to_jshtml())</span>
<span id="cb14-103">    plt.close()</span>
<span id="cb14-104"></span>
<span id="cb14-105"></span>
<span id="cb14-106"></span>
<span id="cb14-107">anim_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images/particles_fm.mp4'</span></span>
<span id="cb14-108">create_flow_animation(val_points.clone(), models<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[fm_model], titles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Flow Matching'</span>],</span>
<span id="cb14-109">                      n_frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>anim_file)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<center><video height="350" controls="" loop=""><source src="images/particles_fm.mp4" type="video/mp4">
              Your browser does not support the video tag. </video></center>
</div>
</div>
<p>So, even though we trained using trajectories that crossed, the model learned smooth and non-crossing (but curvy!) trajectories. Here’s a static plot of these:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb15-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_training_trajectories_vs_learned_flow(model):</span>
<span id="cb15-3">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Compare training trajectories with learned flow field"""</span></span>
<span id="cb15-4">   plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb15-5">   </span>
<span id="cb15-6">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Plot some training trajectories</span></span>
<span id="cb15-7">   plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">131</span>)</span>
<span id="cb15-8">   n_trajs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of trajectories to show</span></span>
<span id="cb15-9">   device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb15-10">   source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_gaussian_data(n_trajs)</span>
<span id="cb15-11">   target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_square_data(n_trajs)</span>
<span id="cb15-12">   current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source.clone().to(device)</span>
<span id="cb15-13"></span>
<span id="cb15-14">   </span>
<span id="cb15-15">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot straight-line trajectories from source to target</span></span>
<span id="cb15-16">   times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb15-17">   <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_trajs):</span>
<span id="cb15-18">       traj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source[i:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> times.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target[i:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> times.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb15-19">       plt.plot(traj[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], traj[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b-'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb15-20">   plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Training Trajectories</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(with crossings)'</span>)</span>
<span id="cb15-21">   plt.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb15-22">   </span>
<span id="cb15-23">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Plot learned flow field</span></span>
<span id="cb15-24">   plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">132</span>)</span>
<span id="cb15-25">   x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb15-26">   y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb15-27">   X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.meshgrid(x, y, indexing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ij'</span>)</span>
<span id="cb15-28">   points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([X.flatten(), Y.flatten()], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).to(device)</span>
<span id="cb15-29">   </span>
<span id="cb15-30">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with torch.no_grad():</span></span>
<span id="cb15-31">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     t =  0.5  # Show flow field at t=0.5</span></span>
<span id="cb15-32">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     ones = torch.ones(points.size(0), 1)</span></span>
<span id="cb15-33"></span>
<span id="cb15-34">   ones <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.ones(points.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).to(device)</span>
<span id="cb15-35">   t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ones <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb15-36">   velocities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(points, t).cpu()</span>
<span id="cb15-37">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print("points.shape, ones.shape = ",points.shape, ones.shape) </span></span>
<span id="cb15-38">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#velocities = model(points, t*ones)</span></span>
<span id="cb15-39">   points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> points.cpu()</span>
<span id="cb15-40">   plt.quiver(points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb15-41">             velocities[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], velocities[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb15-42">             alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb15-43">   plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Learned Flow Field</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">at t=0.5'</span>)</span>
<span id="cb15-44">   plt.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb15-45">   </span>
<span id="cb15-46">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Plot actual paths taken using learned flow</span></span>
<span id="cb15-47">   plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">133</span>)</span>
<span id="cb15-48">   source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_gaussian_data(n_trajs)</span>
<span id="cb15-49">   </span>
<span id="cb15-50">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use RK4 to follow the learned flow</span></span>
<span id="cb15-51">   paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-52">   n_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb15-53">   dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_steps</span>
<span id="cb15-54">   </span>
<span id="cb15-55">   <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb15-56">       ones <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.ones(current_points.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).to(device)</span>
<span id="cb15-57">       <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_steps):</span>
<span id="cb15-58">           paths.append(current_points.clone())</span>
<span id="cb15-59">           </span>
<span id="cb15-60">           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RK4 step</span></span>
<span id="cb15-61">           t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ones <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt)</span>
<span id="cb15-62">           k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current_points, t)</span>
<span id="cb15-63">           k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-64">           k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-65">           k4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt)</span>
<span id="cb15-66">           </span>
<span id="cb15-67">           current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k4) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb15-68">   </span>
<span id="cb15-69">   paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(paths).cpu()</span>
<span id="cb15-70">   </span>
<span id="cb15-71">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the actual paths</span></span>
<span id="cb15-72">   <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_trajs):</span>
<span id="cb15-73">       traj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paths[:, i, :]</span>
<span id="cb15-74">       plt.plot(traj[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], traj[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb15-75">   plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual Paths</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Following Learned Flow'</span>)</span>
<span id="cb15-76">   plt.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb15-77">   </span>
<span id="cb15-78">   plt.tight_layout()</span>
<span id="cb15-79">   plt.savefig(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images/cross_uncross_plot.png'</span>)</span>
<span id="cb15-80">   plt.show()</span>
<span id="cb15-81">   plt.close()</span>
<span id="cb15-82"></span>
<span id="cb15-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the visualization</span></span>
<span id="cb15-84">plot_training_trajectories_vs_learned_flow(fm_model)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Even though the trajectories on the right are smooth and non-crossing, their curviness means that we need to integrate slowly and carefully to avoid accruing significant error. Good news: the “Rectified Flow” paper of Liu et al <span class="citation" data-cites="rectified_flow">[2]</span> offers a powerful way to speed up the integration by “straightening” the curved trajectories, a method they call “Reflow.”</p>
</section>
</section>
<section id="reflow-to-go-straighter-faster" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> “Reflow” to Go Straighter &amp; Faster</h1>
<p>The Reflow idea is that, instead of randomly pairing source and target points when choosing straight trajectories, we use “simulated target points” by integrating the source points forward using the learned flow model. Then we use those endpoints as the targets and assume linear motion as before.</p>
<p><img src="https://drscotthawley.github.io/blog/posts/images/reflow_diagram.png" class="img-fluid"></p>
<p>This has the effect of straightening out the curved trajectory of the flow matching model, making the new “reflowed” trajectories much easier and faster to integrate!</p>
<p>Essentially, Reflow is a “teacher-student” paradigm in which the (pre-)trained flow-matching model is the teacher, and the new Reflowed model is the student. One can also think of this as a kind of distillation, akin to “consistency models” <span class="citation" data-cites="consistency_models">[10]</span>.</p>
<p>Before we can rely on those integrated endpoints, we should make a couple of improvements to how we use the model we just trained.</p>
<section id="upgrading-our-gear-first" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="upgrading-our-gear-first"><span class="header-section-number">3.1</span> Upgrading Our Gear First</h2>
<p>Neither of these upgrades require retraining the velocity model. They just help to make more efficient, accurate use of it while integrating (i.e., while moving data points along the flow) so we’ll have an effective “teacher” for the “student” Reflow model we’ll train below.</p>
<section id="more-points-where-needed-via-time-warping" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="more-points-where-needed-via-time-warping"><span class="header-section-number">3.1.1</span> More Points Where Needed (via Time Warping)</h3>
<p>You’ll notice that many of the trajectories are sharply curved in the middle but are straight near the start and end. Just as you’d slow down when driving around a sharp turn, we should take smaller integration steps in these curved regions for the sake of accuracy.</p>
<p>The idea of non-uniform temporal sampling appears throughout generative models. Esser et al.’s Stable Diffusion 3 paper <span class="citation" data-cites="sd3_paper">[3]</span> specifically designs their sampling distribution to concentrate points in the middle of the integration where accuracy is most crucial. The same principle applies here:</p>
<ul>
<li>during <strong>training,</strong> we need good “coverage” to expose the model to significant places and times where it needs to learn to approximate the correct velocities, and</li>
<li>during <strong>inference (i.e., integration),</strong> high-curvature segments will require shorter time steps to maintain accuracy (i.e., to keep from missing the intended destination).</li>
</ul>
<p>One handy S-shaped time-warping function is this polynomial that lets us vary the concentration of points<sup>3</sup>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20f(t)%20=%20%204(1-s)t%5E3%20+%206(s-1)%20t%5E2%20+%20(3-2s)t,%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%20t%5Cin%5B0,1%5D,%20%5C%20%5C%20%5C%20s%5Cin%5B0,3/2%5D%20"></p>
<div class="cell">
<div class="cell-output cell-output-display">

<center>
<a href="https://www.desmos.com/calculator/g6ffbljlng">
<iframe src="https://www.desmos.com/calculator/hfjxlwycmz?embed" width="225" height="225" style="border: 1px solid #ccc" frameborder="0"></iframe>
<br>Interactive Desmos Graph Link</a>
<br><br>
</center></div>
</div>
<p>The parameter <img src="https://latex.codecogs.com/png.latex?s"> is the slope at t=1/2, and controls where points concentrate: values between 0 and 1 give us more points in the middle, which is exactly what we want for these curved trajectories. The value <img src="https://latex.codecogs.com/png.latex?s=0.5"> is a good choice, as we’ll see shortly.</p>
<p>This approach can improve accuracy and/or require fewer total integration steps. Let’s look at the results of different amounts of time-warping around a simple parabola:</p>
<div class="cell">
<details>
<summary>Show the code: warp_time function</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> warp_time(t, dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>):</span>
<span id="cb16-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Parametric Time Warping: s = slope in the middle. </span></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        s=1 is linear time, s &lt; 1 goes slower near the middle, s&gt;1 goes slower near the ends</span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        s = 1.5 gets very close to the "cosine schedule", i.e. (1-cos(pi*t))/2, i.e. sin^2(pi/2*x)"""</span></span>
<span id="cb16-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"s=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> is out of bounds."</span>)</span>
<span id="cb16-6">    tw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>s)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t </span>
<span id="cb16-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> dt:                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># warped time-step requested; use derivative</span></span>
<span id="cb16-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> tw,  dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>s)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s) </span>
<span id="cb16-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> tw</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>viz code for parabolic path / variable dot-spacing figure</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> partial </span>
<span id="cb17-2"></span>
<span id="cb17-3">parab   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># curve shape</span></span>
<span id="cb17-4">d_parab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># derivative</span></span>
<span id="cb17-5">ds      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: torch.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> d_parab(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># differential arc length</span></span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> calculate_total_arc_length(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>):</span>
<span id="cb17-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Calculate the total arc length of the parabola y = 4(x - 0.5)**2 from x=0 to x=1"""</span></span>
<span id="cb17-9">    x_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n)</span>
<span id="cb17-10">    arc_length_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds(x_values)</span>
<span id="cb17-11">    total_arc_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.trapz(arc_length_values, x_values)</span>
<span id="cb17-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> total_arc_length</span>
<span id="cb17-13"></span>
<span id="cb17-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> fake_velocity_model(loc, t, speed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>):</span>
<span id="cb17-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""For demo purposes only: Follow a parabolic path and move at unit speed</span></span>
<span id="cb17-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Compute the x and y components of the velocity along the parabola y = 4(x - 0.5)^2"""</span></span>
<span id="cb17-17">    x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loc[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], loc[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]    </span>
<span id="cb17-18">    slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d_parab(x)</span>
<span id="cb17-19">    direction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([torch.ones_like(slope), slope], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)    </span>
<span id="cb17-20">    magnitude <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.norm(direction, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb17-21">    unit_velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> direction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> magnitude    </span>
<span id="cb17-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> unit_velocity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>speed</span>
<span id="cb17-23"></span>
<span id="cb17-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb17-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> integrate_motion_along_parabola(</span>
<span id="cb17-26">        model, initial_points, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fwd_euler_step, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,):</span>
<span id="cb17-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""one-off integrator used only for this one visualization figure. don't use for anything else"""</span></span>
<span id="cb17-28">    current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_points.clone()</span>
<span id="cb17-29">    trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [current_points.cpu().clone()]</span>
<span id="cb17-30">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, n_steps) </span>
<span id="cb17-31">    ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_time(ts, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>s)                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># here's the time worpage</span></span>
<span id="cb17-32">    speed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calculate_total_arc_length()   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Total travel time is 1.0 so speed "=" distance</span></span>
<span id="cb17-33">    scaled_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> partial(model, speed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>speed)</span>
<span id="cb17-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb17-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb17-36">            current_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step_fn( scaled_model , current_points.clone(), ts[i],  ts[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ts[i])</span>
<span id="cb17-37">            trajectories.append(current_points.cpu().clone())</span>
<span id="cb17-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.stack(trajectories)</span>
<span id="cb17-39"></span>
<span id="cb17-40"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb17-41"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> viz_parabola_with_steps(step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fwd_euler_step, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>):</span>
<span id="cb17-42">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""varies warp parameter s and integrates along a parabola"""</span></span>
<span id="cb17-43">    plt.close()</span>
<span id="cb17-44">    t_curve <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb17-45"></span>
<span id="cb17-46">    n_t_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_steps <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 28 if step_fn==fwd_euler_step else 6</span></span>
<span id="cb17-47">    t_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,n_t_points)</span>
<span id="cb17-48"></span>
<span id="cb17-49">    n_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of different s values to show</span></span>
<span id="cb17-50">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_s, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb17-51">    plt.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Integration scheme = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>step_fn<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>)</span>
<span id="cb17-52">    initial_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]])                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one point in the top left</span></span>
<span id="cb17-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, s <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(torch.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, n_s)):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># warp time by different amounts via s parameter</span></span>
<span id="cb17-54">        ax[i].plot(t_curve, parab(t_curve))    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># solid line showing path</span></span>
<span id="cb17-55">        traj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_motion_along_parabola(fake_velocity_model, initial_points, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_t_points, </span>
<span id="cb17-56">                    s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>s, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>step_fn).squeeze() </span>
<span id="cb17-57">        err_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">error=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>F<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mse_loss(parab(traj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]),traj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb17-58">        ax[i].scatter(traj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], traj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f's = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}{</span>err_str<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(wong_cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)[i])</span>
<span id="cb17-59"></span>
<span id="cb17-60">        legend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[i].legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper center'</span>, frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, markerscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, handlelength<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb17-61">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> text <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> legend.get_texts():</span>
<span id="cb17-62">            text.set_ha(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb17-63"></span>
<span id="cb17-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>: ax[i].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Even Spacing'</span>) </span>
<span id="cb17-65">            </span>
<span id="cb17-66">    ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'More Points in Middle'</span>)</span>
<span id="cb17-67">    ax[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'More Points at Ends'</span>)</span>
<span id="cb17-68">    plt.show()</span>
<span id="cb17-69">    plt.close()</span>
<span id="cb17-70"></span>
<span id="cb17-71">viz_parabola_with_steps() </span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>While the results for <img src="https://latex.codecogs.com/png.latex?s=0.5"> are better than the others, we see that <em>none</em> of these examples make it all the way around the parabola (to the point (1,1))! If we’re going to be using the endpoints integrated from the flow matching model as proxies for the true target data, we should have some confidence that those endpoints are actually “reaching” the target data. We could add more (smaller) steps to the integration, but there’s another way: upgrade the integration (i.e.&nbsp;sampling) operation to a higher order of accuracy.</p>
</section>
<section id="better-integration-sampling" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="better-integration-sampling"><span class="header-section-number">3.1.2</span> Better Integration / Sampling</h3>
<p>While forward Euler is surprisingly popular in ML circles, those with simulation backgrounds eye it with suspicion: despite being fast (<em>per step</em>) and easy to implement, it’s also highly inaccurate and can lead to instabilities. The poor accuracy may not be an issue when everything’s an approximation anyway, but we can do a lot better.</p>
<p>People who work with diffusion models know this, e.g.&nbsp;<a href="https://github.com/crowsonkb/k-diffusion">Katherine Crowson’s k-diffusion package</a> offers a bevy of integration choices. For now, we’ll just implement the popular 4th-order Runge-Kutta (RK4) scheme. Per step, it’s more “expensive” than forward Euler in that each RK4 step requires 4 function evaluations instead of forward Euler’s single evaluation, and RK4 requires some extra storage, but the advantages you gain in accuracy are seriously worth it (e.g., because you can take much longer steps in time). Even with just a handful of RK4 steps, we can totally smoke the earlier forward Euler results:</p>
<div class="cell">
<details>
<summary>Code for 4th-order Runge-Kutta integration</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> rk4_step(f, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function that takes (y,t) and returns dy/dt, i.e. velocity</span></span>
<span id="cb18-2">             y, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># current location</span></span>
<span id="cb18-3">             t, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># current t value</span></span>
<span id="cb18-4">             dt, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># requested time step size </span></span>
<span id="cb18-5">             ):</span>
<span id="cb18-6">    k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  f(y, t)</span>
<span id="cb18-7">    k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span>
<span id="cb18-8">    k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span>
<span id="cb18-9">    k4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  f(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k3, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dt) </span>
<span id="cb18-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(k1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k4)</span>
<span id="cb18-11"></span>
<span id="cb18-12">viz_parabola_with_steps(step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) </span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>It’s cool how the RK4 results, despite showing much less error than the Euler results, actually involve <em>less computational cost</em> in terms of total number of function evaluations, although the RK4 scheme needs 4 times the storage compared to forward Euler. (The good news is that no PyTorch gradients need to be stored; the integrator is only ever used when the model is in “eval” mode.)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’re only going to use the RK4-powered integrator to run inference on the flow matching model to provide the “simulated target data” while we train the Reflow model. Once we have the Reflow model trained, the new trajectories we get from it will be so straight that even forward Euler should be “good enough”!</p>
</div>
</div>
</section>
</section>
<section id="learning-to-reflow" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="learning-to-reflow"><span class="header-section-number">3.2</span> Learning to “Reflow”</h2>
<p>When we train the “Reflowed” model, aka the student model, note that the “target data” will no longer be supplied by the true target data anymore. Rather, we will be using the trajectory endpoints integrated/generated using the teacher model, i.e.&nbsp;the pretrained flow matching model.</p>
<p>So we might ask, “How close of an approximation are those learned flow endpoints to the real thing?” We’re going to be approximating an approximation, but how good is the first approximation?</p>
<p>Let’s take a brief look…</p>
<div class="cell">
<details>
<summary>quick check of how our flow endpoints are looking</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">pretrained_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fm_model </span>
<span id="cb19-2">pretrained_model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb19-3">reflow_targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(pretrained_model, val_points.to(device), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_time).cpu()</span>
<span id="cb19-4"></span>
<span id="cb19-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb19-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, [data, color, label] <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>([val_points,   reflow_targets, target_samples], </span>
<span id="cb19-7">                                             [source_color, pred_color,     target_color],</span>
<span id="cb19-8">                                             [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Source Data'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Learned Flow Endpoints'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'True Target Data'</span>])):</span>
<span id="cb19-9">    ax[i].scatter(data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span>
<span id="cb19-10">    ax[i].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb19-11">    ax[i].set_title(label)</span>
<span id="cb19-12">plt.show()</span>
<span id="cb19-13">plt.close()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>….ok, so we see the learned outputs are a bit different from the true data, but they’re not bad. Let’s now train the “reflow” model.</p>
<section id="train-the-reflowed-model" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="train-the-reflowed-model"><span class="header-section-number">3.2.1</span> Train the Reflowed Model</h3>
<p>There’s one small but crucial change from the previous training code to this one, namely what we use as target data:</p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##  target_samples = create_target_data(batch_size)           # Previous "random pairing"</span></span>
<span id="cb20-2">target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrator(pretrained_model, source_samples) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reflow!</span></span></code></pre></div>
<div class="cell">
<details>
<summary>Code for the new training loop w/ ReFlowed targets</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train_reflow_model(model, pretrained_model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, </span>
<span id="cb21-2">                          n_epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>, </span>
<span id="cb21-3">                          status_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, viz_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in epochs</span></span>
<span id="cb21-4">                          new_points_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in steps </span></span>
<span id="cb21-5">                          warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_time, </span>
<span id="cb21-6">                          step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rk4 so we get high-quality outputs while reflowing</span></span>
<span id="cb21-7">                          ):</span>
<span id="cb21-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""This is almost IDENTICAL to the previous training routine. </span></span>
<span id="cb21-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The difference is the change in "target_samples" via what the RF authors call "ReFlow": </span></span>
<span id="cb21-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Instead of (randomly) paring source points with points in the "true target distribution", </span></span>
<span id="cb21-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        we use the pretrained/teacher model to integrate the source points to their (predicted) flow endpoints </span></span>
<span id="cb21-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        and use THOSE as the "target" values.</span></span>
<span id="cb21-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb21-14">    optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> optim.Adam(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lr)</span>
<span id="cb21-15">    loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.MSELoss()</span>
<span id="cb21-16">    step, n_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb21-17">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb21-18">    </span>
<span id="cb21-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_epochs):</span>
<span id="cb21-20">        model.train()</span>
<span id="cb21-21">        pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_steps), leave<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb21-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> pbar:</span>
<span id="cb21-23">            step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb21-24">            optimizer.zero_grad()</span>
<span id="cb21-25"></span>
<span id="cb21-26">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> new_points_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># you could in theory not draw new points with each step, though we will. </span></span>
<span id="cb21-27">                source_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_source_data(batch_size).to(device)</span>
<span id="cb21-28">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> pretrained_model:   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HERE is the ReFlow operation...</span></span>
<span id="cb21-29">                    target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(pretrained_model, source_samples, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rk4_step, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_time, n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)  </span>
<span id="cb21-30">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb21-31">                    target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_target_data(batch_size) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this function also supports fm models from scratch</span></span>
<span id="cb21-32">                    </span>
<span id="cb21-33">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(source_samples.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).to(device) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random times for training</span></span>
<span id="cb21-34">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> warp_fn: t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_fn(t)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time warp here (different from use in integrator!) helps focus "coverage" i.e. sampling the space</span></span>
<span id="cb21-35">                </span>
<span id="cb21-36">            interpolated_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> source_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t            </span>
<span id="cb21-37">            v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(interpolated_samples, t)</span>
<span id="cb21-38">            line_directions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> source_samples </span>
<span id="cb21-39">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(v, line_directions)</span>
<span id="cb21-40">            </span>
<span id="cb21-41">            loss.backward()</span>
<span id="cb21-42">            optimizer.step()</span>
<span id="cb21-43">            </span>
<span id="cb21-44">            pbar.set_description(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Epoch [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">], Loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb21-45">        </span>
<span id="cb21-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> viz_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb21-47">            model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb21-48">            clear_output(wait<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clear previous plots</span></span>
<span id="cb21-49">            viz(val_points, target_samples[:val_points.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], model)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't need rk4 for reflow'd model viz b/c paths r straight</span></span>
<span id="cb21-50">            plt.show()</span>
<span id="cb21-51">            plt.close()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the figure to free memory</span></span>
<span id="cb21-52">            model.train()</span>
<span id="cb21-53">    </span>
<span id="cb21-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> model</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note that the student/reflow model could have a simpler architecture </span></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># than the teacher/pretrained model, but... we'll just keep 'em the same :shrug:</span></span>
<span id="cb22-5">reflowed_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(pretrained_model) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># no need to start from scratch, use teacher's weights</span></span>
<span id="cb22-6">reflowed_model.train()               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure we have gradients turned on</span></span>
<span id="cb22-7"></span>
<span id="cb22-8">reflowed_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_reflow_model(reflowed_model, pretrained_model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pretrained_model)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/FlowModels_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Oooo, look how straight the trajectories are now! Let’s compare animations of the original flow matching model with the “Reflowed” model:</p>
<div class="cell">
<details>
<summary>Making movie for particle animation comparison</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">rect_eval <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> reflowed_model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb23-2"></span>
<span id="cb23-3">anim_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/particles_fm_vs_rf.mp4"</span></span>
<span id="cb23-4">create_flow_animation(val_points.clone(), models<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[pretrained_model, reflowed_model], </span>
<span id="cb23-5">        n_frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, titles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Flow Matching'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Reflowed Flow'</span>], save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>anim_file)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<center><video height="350" controls="" loop=""><source src="images/particles_fm_vs_rf.mp4" type="video/mp4">
              Your browser does not support the video tag. </video></center>
</div>
</div>
<p>Notice how the flow matching trajectories on the left have the data moving inward a ways and then back out, whereas the reflowed trajectories move directly from start to finish with no backtracking.</p>
<p>The next movie shows an animation of “streamlines” with arrows for the local vector field. Note how the shapes on the right change very little over time compared to those on the left. We’ll say a bit more about that below.</p>
<div class="cell">
<details>
<summary>Code for streamline animation</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb24-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_streamline_animation(start_dist, model, model2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, n_frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, show_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, titles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, </span>
<span id="cb24-3">                                step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fwd_euler_step,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># euler's ok for reflowed model bc/paths are straight</span></span>
<span id="cb24-4">                                save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, </span>
<span id="cb24-5">                               ):</span>
<span id="cb24-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Create an animation showing distribution flow with streamplot background"""</span></span>
<span id="cb24-7">    device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(model.parameters()).device</span>
<span id="cb24-8">    figsize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb24-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> titles <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: </span>
<span id="cb24-10">        titles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Flow Matching'</span>]</span>
<span id="cb24-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2: titles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Reflowed Model'</span>]</span>
<span id="cb24-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2: </span>
<span id="cb24-13">        figsize[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb24-14">    n_plots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (model2 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb24-15">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_plots, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>figsize)</span>
<span id="cb24-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> n_plots<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ax]</span>
<span id="cb24-17">    plt.close()</span>
<span id="cb24-18"></span>
<span id="cb24-19">    end_dist, trajectories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(model, start_dist.clone().to(device), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_frames, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>step_fn, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_time, save_trajectories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb24-20">    scatter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].scatter([], [], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wong_pink, zorder<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2: </span>
<span id="cb24-22">        _, trajectories2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> integrate_path(model2, start_dist.clone().to(device), n_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_frames, step_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>step_fn, warp_fn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warp_time, save_trajectories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb24-23">        scatter2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].scatter([], [], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wong_pink, zorder<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-24">        </span>
<span id="cb24-25">    max_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>( <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(start_dist).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item(), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(end_dist).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().item() )</span>
<span id="cb24-26">    </span>
<span id="cb24-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ax)):</span>
<span id="cb24-28">        ax[i].set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-29">        ax[i].set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-30">        ax[i].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb24-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> titles: ax[i].set_title(titles[i])</span>
<span id="cb24-32"></span>
<span id="cb24-33"></span>
<span id="cb24-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create grid for streamplot</span></span>
<span id="cb24-35">    grid_dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb24-36">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range, grid_dim)</span>
<span id="cb24-37">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range, grid_dim)</span>
<span id="cb24-38">    X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x, y)</span>
<span id="cb24-39"></span>
<span id="cb24-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert grid to torch tensor for model input</span></span>
<span id="cb24-41">    grid_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor(np.stack([X.flatten(), Y.flatten()], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.float32).to(device)</span>
<span id="cb24-42">    color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wong_pink <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_points <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) </span>
<span id="cb24-43"></span>
<span id="cb24-44">    dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_frames </span>
<span id="cb24-45">    </span>
<span id="cb24-46">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> init():</span>
<span id="cb24-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ax)):</span>
<span id="cb24-48">            ax[i].clear()</span>
<span id="cb24-49">            ax[i].set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-50">            ax[i].set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-51">        scatter.set_offsets(np.c_[[], []])</span>
<span id="cb24-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2:</span>
<span id="cb24-53">                scatter.set_offsets(np.c_[[], []])</span>
<span id="cb24-54">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (scatter,scatter2)</span>
<span id="cb24-55">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (scatter,)</span>
<span id="cb24-56">    </span>
<span id="cb24-57">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> animate(frame):</span>
<span id="cb24-58">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ax)):</span>
<span id="cb24-59">            ax[i].clear()</span>
<span id="cb24-60">            ax[i].set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-61">            ax[i].set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range))</span>
<span id="cb24-62">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> titles: ax[i].set_title(titles[i])</span>
<span id="cb24-63">            ax[i].set_xticks([])</span>
<span id="cb24-64">            ax[i].set_yticks([])</span>
<span id="cb24-65">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> spine <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>]:</span>
<span id="cb24-66">                ax[i].spines[spine].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb24-67"></span>
<span id="cb24-68">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update scatter plot</span></span>
<span id="cb24-69">        current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trajectories[frame]</span>
<span id="cb24-70">        scatter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].scatter(current[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], current[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color, zorder<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-71">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2:</span>
<span id="cb24-72">            current2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trajectories2[frame]</span>
<span id="cb24-73">            scatter2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[i].scatter(current2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], current2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color, zorder<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-74"></span>
<span id="cb24-75">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate vector field for current time</span></span>
<span id="cb24-76">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.ones(grid_points.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (frame <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt)</span>
<span id="cb24-77">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_time(t).to(device) </span>
<span id="cb24-78">        velocities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(grid_points, t).cpu()</span>
<span id="cb24-79">        U <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> velocities[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].reshape(X.shape)</span>
<span id="cb24-80">        V <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> velocities[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].reshape(X.shape)</span>
<span id="cb24-81"></span>
<span id="cb24-82">        x_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb24-83">        y_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_range, max_range, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb24-84">        X_arrows, Y_arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x_points, y_points)</span>
<span id="cb24-85">        start_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.column_stack((X_arrows.ravel(), Y_arrows.ravel()))</span>
<span id="cb24-86">        ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].streamplot(X, Y, U.numpy(), V.numpy(),</span>
<span id="cb24-87">             density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Controls line spacing</span></span>
<span id="cb24-88">             color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (0, 0, 1, 0.7),</span></span>
<span id="cb24-89">             linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, maxlength<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>,</span>
<span id="cb24-90">             start_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>start_points,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This should give more arrows along paths</span></span>
<span id="cb24-91">             arrowsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb24-92">             arrowstyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-&gt;'</span>)  </span>
<span id="cb24-93">        </span>
<span id="cb24-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2: </span>
<span id="cb24-95">            velocities2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model2(grid_points, t).cpu()</span>
<span id="cb24-96">            U2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> velocities2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].reshape(X.shape)</span>
<span id="cb24-97">            V2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> velocities2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].reshape(X.shape)</span>
<span id="cb24-98">            start_points2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.column_stack((X_arrows.ravel(), Y_arrows.ravel()))</span>
<span id="cb24-99">            ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].streamplot(X, Y, U2.numpy(), V2.numpy(),</span>
<span id="cb24-100">                 density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Controls line spacing</span></span>
<span id="cb24-101">                 color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>line_color, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (0, 0, 1, 0.7),</span></span>
<span id="cb24-102">                 linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, maxlength<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>,</span>
<span id="cb24-103">                 start_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>start_points2,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This should give more arrows along paths</span></span>
<span id="cb24-104">                 arrowsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb24-105">                 arrowstyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-&gt;'</span>) </span>
<span id="cb24-106"></span>
<span id="cb24-107"></span>
<span id="cb24-108">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update particle positions</span></span>
<span id="cb24-109">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.ones(current.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (frame <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt)</span>
<span id="cb24-110">        t, dtw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> warp_time(t, dt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dt)</span>
<span id="cb24-111">        velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(current.to(device), t.to(device)).cpu()</span>
<span id="cb24-112">        current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> velocity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dtw</span>
<span id="cb24-113">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> model2: </span>
<span id="cb24-114">            velocity2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model2(current2.to(device), t.to(device)).cpu()</span>
<span id="cb24-115">            current2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> current2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> velocity2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dtw</span>
<span id="cb24-116">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (scatter, scatter2,)</span>
<span id="cb24-117">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (scatter,)</span>
<span id="cb24-118">    </span>
<span id="cb24-119">    anim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> animation.FuncAnimation(fig, animate, init_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>init,</span>
<span id="cb24-120">                                 frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_frames, interval<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, blit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb24-121"></span>
<span id="cb24-122">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> save_file:</span>
<span id="cb24-123">        anim.save(save_file, writer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ffmpeg'</span>, fps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb24-124">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> HTML(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""&lt;center&gt;&lt;video height="350" controls loop&gt;&lt;source src="</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>save_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">" type="video/mp4"&gt;</span></span>
<span id="cb24-125"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                      Your browser does not support the video tag.&lt;/video&gt;&lt;/center&gt;"""</span>)</span>
<span id="cb24-126">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb24-127">        rc(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'animation'</span>, html<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'jshtml'</span>)</span>
<span id="cb24-128">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> HTML(anim.to_jshtml())</span>
<span id="cb24-129"></span>
<span id="cb24-130"></span>
<span id="cb24-131">save_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images/fm_vs_rf_streamvecs.mp4'</span></span>
<span id="cb24-132">create_streamline_animation(val_points, fm_model, model2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>reflowed_model, n_frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, save_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>save_file)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#, show_points=True)</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<center><video height="350" controls="" loop=""><source src="images/fm_vs_rf_streamvecs.mp4" type="video/mp4">
                      Your browser does not support the video tag.</video></center>
</div>
</div>
</section>
</section>
</section>
<section id="connecting-with-other-models" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Connecting with Other Models</h1>
<section id="from-dots-to-images-audio-etc.." class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="from-dots-to-images-audio-etc.."><span class="header-section-number">4.1</span> From Dots to Images, Audio, etc..</h2>
<p>How to move on from 2D dots to things like images, text, audio,…etc? We need only consider that the dimensionality of the velocity model is the same as that of the data itself. Put differently, one can regard the velocity model as supplying a tiny “change” to the data, whatever form that data is in. And the “straight line” trajectory used during training? That’s just linear interpolation between the (initially randomly-paired) source data and the target data. So for images, we will get a “velocity image”, which will tell us how to change the R,G,B values of every pixel in an image. This is where U-Nets and Attention come into play, to efficiently compute the “image-to-image” task of supplying a “velocity image” given an input image distribution (which may just be noise). For audio, regardless of the representation, the velocity model will tell us how to slightly change the component values in that representation. We then just integrate all the little changes as we did with the dots.</p>
<ul>
<li>I recommend checking out an MNIST image example such as Tadao Yamaoka’s <span class="citation" data-cites="rf_mnist_example">[11]</span></li>
</ul>
</section>
<section id="diffusion-models" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="diffusion-models"><span class="header-section-number">4.2</span> Diffusion Models</h2>
<p>Diffusion models, aka “score-based models” are similar to flow models in that the former also learn a vector field (the “score function”) that serves to differentially transform the points in the sample. The difference is that flow models are deterministic, whereas diffusion models are constantly injecting fresh noise, as if they are simulating actual Brownian motion <span class="citation" data-cites="brownian_motion">[9]</span> rather than the macroscopic flow. (This is also why diffusion models are not invertible, whereas flow models can operate in either direction.) To turn our flow model into a diffusion model, we could add “jitter,” i.e.&nbsp;inject noise at every step. The variance of that jitter as a function of time would correspond directly to the “noise schedule” of diffusion model<sup>4</sup>. There’s a lot more than can be said about the many connections between diffusion models and flow-based models that is probably being said elsewhere. ( <strong>UPDATE Dec 2, 2024:</strong> Indeed, check out this new post from a bunch of researchers at Google DeepMind! <span class="citation" data-cites="gao2025diffusionmeetsflow">[12]</span>. ) For brevity’s sake we’ll move on for now. ;-)</p>
</section>
<section id="optimal-transport" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="optimal-transport"><span class="header-section-number">4.3</span> Optimal Transport</h2>
<p>Interesting observation: See how the Reflowed streamlines in the last movie are approximately stationary (i.e., time-independent)? This connects nicely with Optimal Transport theory, where the Benamou-Brenier formulation <span class="citation" data-cites="bb_form">[13]</span> (which has a diffusion-esque equation as on objective) shows that optimal mass transport paths follow constant-velocity geodesics in the Wasserstein metric space. This time-independence property emerges naturally when minimizing transport costs in simple metric spaces, as particles following straight paths at constant speeds achieve optimal transport between distributions.</p>
</section>
<section id="normalizing-flows" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="normalizing-flows"><span class="header-section-number">4.4</span> Normalizing Flows</h2>
<p>Normalizing flows have the property that they preserve overall probability throughout the flow process. While this would seem to be a nice constraint to satisfy, it appears to be unnecessary for “getting the job done” yet it may even limit the expressiveness of the model compared to the kinds of flows we’ve been talking about in this post. Note: Since I’m pushing a “physics perspective,” a similar “conservation” property arises in the phase space flows of Hamiltonian mechanics, namely that they preserve areas and volumes via Liousville’s Theorem <span class="citation" data-cites="liouvilles_theorem">[14]</span>. The connection between normalizing flows and Hamiltonian systems was applied to generative modeling in the “Neural Hamiltonian Flows” paper of ICLR 2020 <span class="citation" data-cites="Toth2020Hamiltonian">[15]</span>, and continues in a recent NeurIPS 2024 poster-paper <span class="citation" data-cites="hamiltonian_flows">[16]</span>.<sup>5</sup> Despite these fascinating connections, the exciting thing about flow-matching and rectified flows is that they seem to be effective even in the absence of the explicit conservation properties of normalizing flows and their relatives, and can thus be implemented quickly and simply.</p>
</section>
</section>
<section id="summary" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Summary</h1>
<p>We’ve seen that flow matching and rectified flow models can be conceptualized and even developed using some simple ideas from basic physics. This simplicity, coupled with their power and flexibility have fueled their popularity and even rise to state-of-the-art levels.</p>
<p>Hopefully, after having read this, you will be better able to follow the rapid progress in flow-based generative AI in terms of both scholarly and industry output, as well as to have the confidence to expand on these ideas in your own investigations!</p>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-lipman2023flow" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Y. Lipman, R. T. Q. Chen, H. Ben-Hamu, M. Nickel, and M. Le, <span>“Flow matching for generative modeling,”</span> in <em><span class="nocase">The Eleventh International Conference on Learning Representations (ICLR)</span></em>, 2023. Available: <a href="https://openreview.net/forum?id=PqvMRDCJT9t">https://openreview.net/forum?id=PqvMRDCJT9t</a></div>
</div>
<div id="ref-rectified_flow" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">X. Liu, C. Gong, and Q. Liu, <span>“Flow straight and fast: Learning to generate and transfer data with rectified flow,”</span> in <em>11th <span>I</span>nternational <span>C</span>onference on <span>L</span>earning <span>R</span>epresentations (ICLR)</em>, 2023. Available: <a href="https://openreview.net/forum?id=XVjTT1nw5z">https://openreview.net/forum?id=XVjTT1nw5z</a></div>
</div>
<div id="ref-sd3_paper" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">P. Esser <em>et al.</em>, <span>“Scaling rectified flow transformers for high-resolution image synthesis,”</span> in <em>41st <span>I</span>nternational <span>C</span>onference on <span>M</span>achine <span>L</span>earning, <span>ICML</span></em>, Vienna, Austria, 2024. Available: <a href="https://openreview.net/forum?id=FPnUhsQJ5B">https://openreview.net/forum?id=FPnUhsQJ5B</a></div>
</div>
<div id="ref-improving_rf" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">S. Lee, Z. Lin, and G. Fanti, <span>“Improving the training of rectified flows.”</span> 2024. Available: <a href="https://arxiv.org/abs/2405.20320">https://arxiv.org/abs/2405.20320</a></div>
</div>
<div id="ref-mathieu2024flow" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">T. Fjelde, E. Mathieu, and V. Dutordoir, <span>“An introduction to flow matching,”</span> <em>https://mlg.eng.cam.ac.uk/blog/</em>. 2024. Available: <a href="https://mlg.eng.cam.ac.uk/blog/2024/01/20/flow-matching.html">https://mlg.eng.cam.ac.uk/blog/2024/01/20/flow-matching.html</a></div>
</div>
<div id="ref-jia_bin" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">J.-B. Huang, <span>“How <span>I</span> understand flow matching.”</span> YouTube, 2024. Available: <a href="https://www.youtube.com/watch?v=DDq_pIfHqLs">https://www.youtube.com/watch?v=DDq_pIfHqLs</a></div>
</div>
<div id="ref-mj_siggraph" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">T. Beier and S. Neely, <span>“Feature-based image metamorphosis,”</span> <em>ACM SIGGRAPH Comput. Graph.</em>, vol. 26, no. 2, pp. 35–42, Jul. 1992, doi: <a href="https://doi.org/10.1145/142920.134003">10.1145/142920.134003</a>.</div>
</div>
<div id="ref-tanishq_same" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">T. M. Abraham, <span>“"Flow matching and rectified flows are the same.”</span> X.com, 2024. Available: <a href="https://x.com/iScienceLuvr/status/1766700945243881889">https://x.com/iScienceLuvr/status/1766700945243881889</a></div>
</div>
<div id="ref-brownian_motion" class="csl-entry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline"><span>“<span>B</span>rownian motion - <span>W</span>ikipedia — en.wikipedia.org.”</span> <a href="https://en.wikipedia.org/wiki/Brownian_motion" class="uri">https://en.wikipedia.org/wiki/Brownian_motion</a>.</div>
</div>
<div id="ref-consistency_models" class="csl-entry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">Y. Song, P. Dhariwal, M. Chen, and I. Sutskever, <span>“Consistency models.”</span> 2023. Available: <a href="https://arxiv.org/abs/2303.01469">https://arxiv.org/abs/2303.01469</a></div>
</div>
<div id="ref-rf_mnist_example" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">T. Yamaoka, <span>“Image generation with rectified flow part 2 (learning MNIST using scratch implementation).”</span> 2024. Available: <a href="https://tadaoyamaoka.hatenablog.com/entry/2024/09/29/163801">https://tadaoyamaoka.hatenablog.com/entry/2024/09/29/163801</a></div>
</div>
<div id="ref-gao2025diffusionmeetsflow" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">R. Gao, E. Hoogeboom, J. Heek, V. D. Bortoli, K. P. Murphy, and T. Salimans, <span>“Diffusion meets flow matching: Two sides of the same coin,”</span> 2024. Available: <a href="https://diffusionflow.github.io/">https://diffusionflow.github.io/</a></div>
</div>
<div id="ref-bb_form" class="csl-entry">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">J.-D. Benamou and Y. Brenier, <span>“A computational fluid mechanics solution to the <span>M</span>onge-<span>K</span>antorovich mass transfer problem,”</span> <em>Numerische Mathematik</em>, vol. 84, pp. 375–393, 2000, Available: <a href="https://api.semanticscholar.org/CorpusID:1100384">https://api.semanticscholar.org/CorpusID:1100384</a></div>
</div>
<div id="ref-liouvilles_theorem" class="csl-entry">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">Wikipedia, <span>“<span class="nocase">Liouville’s theorem (Hamiltonian)</span> — <span>W</span>ikipedia<span>,</span> the free encyclopedia.”</span> <a href="http://en.wikipedia.org/w/index.php?title=Liouville's%20theorem%20(Hamiltonian)&amp;oldid=1233185478" class="uri">http://en.wikipedia.org/w/index.php?title=Liouville's%20theorem%20(Hamiltonian)&amp;oldid=1233185478</a>, 2024.</div>
</div>
<div id="ref-Toth2020Hamiltonian" class="csl-entry">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">P. Toth, D. J. Rezende, A. Jaegle, S. Racanière, A. Botev, and I. Higgins, <span>“Hamiltonian generative networks,”</span> in <em>International <span>C</span>onference on <span>L</span>earning <span>R</span>epresentations <span>(ICLR)</span></em>, 2020. Available: <a href="https://openreview.net/forum?id=HJenn6VFvB">https://openreview.net/forum?id=HJenn6VFvB</a></div>
</div>
<div id="ref-hamiltonian_flows" class="csl-entry">
<div class="csl-left-margin">[16] </div><div class="csl-right-inline">P. Holderrieth, Y. Xu, and T. Jaakkola, <span>“Hamiltonian score matching and generative flows.”</span> 2024. Available: <a href="https://arxiv.org/abs/2410.20470">https://arxiv.org/abs/2410.20470</a></div>
</div>
</div>
<hr>
<ol start="3" type="a">
<li>2024, 2025 Scott H. Hawley</li>
</ol>
<p>Did you use this work as a reference? Please cite it – now via its acceptance for ICLR!</p>
<pre><code>Scott H. Hawley, "Flow With What You Know", ICLR Blogposts, 2025.
</code></pre>
<p>BibTeX citation:</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode bibtex code-with-copy"><code class="sourceCode bibtex"><span id="cb26-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">@inproceedings</span>{<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">hawley2025flowwithwhat</span>,</span>
<span id="cb26-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">author</span> = {Scott H. Hawley},</span>
<span id="cb26-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span> = {Flow With What You Know},</span>
<span id="cb26-4">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">booktitle</span>={The Fourth Blogpost Track at ICLR 2025},</span>
<span id="cb26-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">year</span> = {2025},</span>
<span id="cb26-6">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">url</span>={https://openreview.net/forum?id=3XlPoJeDu4},</span>
<span id="cb26-7">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">note</span> = {https://d2jud02ci9yv69.cloudfront.net/2025-04-28-flow-with-what-you-know-38/blog/flow-with-what-you-know/},</span>
<span id="cb26-8">}</span></code></pre></div>
<p>Original citation:</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode bibtex code-with-copy"><code class="sourceCode bibtex"><span id="cb27-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">@misc</span>{<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">hawley2024flow</span>,</span>
<span id="cb27-2">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span>={Flow With What You Know}, </span>
<span id="cb27-3">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">author</span>={Scott H. Hawley},</span>
<span id="cb27-4">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">date</span>={Nov 14, 2024},</span>
<span id="cb27-5">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">url</span>={https://drscotthawley.github.io/blog/posts/FlowModels.html}</span>
<span id="cb27-6">}</span></code></pre></div>
<section id="acknowledgement" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="acknowledgement">Acknowledgement</h4>
<p>This work was graciously supported by Belmont University, Hyperstate Music AI, Razer Inc., and NVIDIA’s Inception program. Much of this tutorial was hashed out through “conversations” with Claude 3.5 Sonnet as “we” tried to figure things out “together.”<sup>6</sup></p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This is not the <em>only</em> choice for guessing trajectories. We could instead use a variance-preserving “cosine interpolation” scheme. It actually results in pretty straight learned flow trajectories that barely need any “Reflow”. ;-) (Source: <a href="https://colab.research.google.com/drive/1WU0QMFECzmOPwArad1R3S0QtHuPp1ZnL?usp=sharing">I just did it</a>! But this post is finished and I’m not gonna re-do all the figures now.)↩︎</p></li>
<li id="fn2"><p>A related example from science fiction: in the fictitous “psychohistory” theory of Isaac Asimov’s <em>Foundation</em> series, the choices and “trajectories” of individual people can’t be predicted, but the aggregated development of an entire society follows predictable paths.↩︎</p></li>
<li id="fn3"><p>Note: my <img src="https://latex.codecogs.com/png.latex?f(t)"> is a close approximation to the “mode function” Eq. 20 in <span class="citation" data-cites="sd3_paper">[3]</span>, with their <img src="https://latex.codecogs.com/png.latex?s"> being about (1.75 - <img src="https://latex.codecogs.com/png.latex?s_%7B%5Crm%20mine%7D">), and with <img src="https://latex.codecogs.com/png.latex?t%5Crightarrow%201-t">. My blue line is right underneath their purple line in the Desmos graph below – I didn’t plan that, just similar minds at work! Both our curves can do the Karras et al cosine schedule, shown in green in the the Desmos figure.↩︎</p></li>
<li id="fn4"><p>Technically, the trajectory and the (variance of the) jitter would be <em>the same quantity</em> for diffusion models, and the choice of constant velocity during training is akin to a choice of (constant-total-amplitude) noise schedule. However, diffusion models and flow models are not fully equivalent, and I am a bit hesitant to delineate 1-to-1 correspondences between them.↩︎</p></li>
<li id="fn5"><p>Check out <a href="https://yilun-xu.com/">Yilun Xu’s</a> work for more on physics-inspired generative models.↩︎</p></li>
<li id="fn6"><p>Almost all of this was (re)written by me and I have the typo-filled Grammarly logs to show ample evidence of imperfect human authorship. ;-)↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>generative</category>
  <category>flows</category>
  <category>diffusion</category>
  <guid>https://drscotthawley.github.io/blog/posts/FlowModels.html</guid>
  <pubDate>Wed, 13 Nov 2024 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/flow_gaussian_to_spiral.png" medium="image" type="image/png" height="67" width="144"/>
</item>
<item>
  <title>Understanding Transformers, Part 2: Wee Music Box</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/Transformers2-MusicBox.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/musicbox_prime.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Musicbox-Transformer image, via Stable Diffusion XL</figcaption>
</figure>
</div>
<div class="cell">
<div class="cell-output cell-output-display">
<style>
details > summary {
    color: #00966f;   /* the greenish tinge that appears in my blog */
    cursor: pointer; /* lil triangle thingy */
}
</style>
</div>
</div>
<section id="preface" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Preface</h1>
<p>This is a follow-up to an earlier lesson, <a href="https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html">“To Understand Transformers, Focus on Attention”</a>. If you haven’t read that yet, <em>do</em>. IMHO, it’s really good. ;-) In this lesson, we’ll fill in the “blanks” we left in the Transformer architecture last time, and go on to build a working example.</p>
<p>For that example, let’s do something different from the many other online lessons about working with text &amp; Natural Language Processing (NLP): Let’s make a “Generative Music Transformer.” To keep things “small,” we’ll work in terms of MIDI instead of raw audio. For ideas about trying raw audio, see “Further Study” in Section&nbsp;10.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The goal of this exercise is to build <em>some understanding</em>, not to build a killer MIDI-generating app. If you want the latter, check out <a href="https://magenta.tensorflow.org/music-transformer">Google Magenta’s paper</a> from 2018, or various extensions since then, such as 2023’s <a href="https://salu133445.github.io/mmt/">“Multitrack Music Transformer”</a> from a group at UCSD. If you just want to play around with a great MIDI model, check out <a href="https://huggingface.co/spaces/skytnt/midi-composer">SkyTNT’s HuggingFace Space</a>. By “some” understanding, I also mean that we’re going to largely ignore the many variants and improvements on Transformers made over the past several years – lately <a href="https://www.youtube.com/watch?v=ouF-H35atOY">“Mamba”</a> is generating considerable buzz. I find <a href="https://twitter.com/rasbt">Sebastian Raschka</a>’s posts to be informative about major updates on the Transformer “theme”. Even as improvements are made, the Transformer architecture will continue to form an important part of the conversation about neural network design.</p>
</div>
</div>
<section id="managing-expectations" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="managing-expectations"><span class="header-section-number">1.1</span> Managing Expectations</h2>
<p>What we’ll end up with is something akin to <a href="https://www.youtube.com/watch?v=kCc8FmEb1nY">producing garbled Shakespeare</a>, except it’s going to be musical. Garbled music seems much harder to tolerate than garbled Shakespeare, which is why I have delayed releasing this lesson for <em>multiple months</em> – I’ve kept <a href="https://wandb.ai/drscotthawley/musicbox-q?workspace=user-drscotthawley">trying</a> and <a href="https://wandb.ai/drscotthawley/musicbox-jsb?workspace=user-drscotthawley">trying</a> (and <a href="https://wandb.ai/drscotthawley/musicbox?workspace=user-drscotthawley">trying</a>) to get better results. At this point, I’m resigned to the fact that <em>this is a hard problem</em> (even for MIDI!), and my current outputs are about “as good as they’re going to get”:</p>
<blockquote class="twitter-tweet tw-align-center blockquote">
<p lang="en" dir="ltr">
It's way harder to train a simple MIDI transformer to sound OK than a next-character GPT-type transformer to create text that makes at least basic sense. MIDI tokenizer choice is a big deal here also.
</p>
— Mateusz Modrzejewski (@mamodrzejewski) <a href="https://twitter.com/mamodrzejewski/status/1728858756736557451?ref_src=twsrc%5Etfw">November 26, 2023</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>…and we’re going to keep the tokenizer simple.</p>
<p>– <a href="https://hedges.belmont.edu">Scott H. Hawley</a>, December 2023</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In what follows, I’ve often put sections and subsections in expandable “Details” blocks, to enable readers to pick and choose the level of depth they want to see. Enjoy!</p>
</div>
</div>
<hr>
</section>
</section>
<section id="intuiting-the-rest-of-the-transformer" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Intuiting the Rest of the Transformer</h1>
<p>The <a href="https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html">previous lesson</a> left some things out. In this section, we’ll build some intuitive understanding of these other components and a bit of code.</p>
<p>Below is a picture of the original Transformer model diagram, whose parts we will elucidate as we go on. It’s set up like the traditional <a href="https://tex.stackexchange.com/questions/374926/drawing-an-encoder-decoder-architecture-in-tikz">“encoder-decoder” architecture</a> one often sees in the form of an <a href="images/EncoderDecoder_feedback_large.png">“hourglass shape”</a>, although it may not be obvious from the Transformer diagram:</p>
<style>
.img1 {
    /*transform-origin: top left;*/
    width:450px;
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img1:hover {
    -webkit-transform:scale(1.7);
    transform:scale(1.7);
    z-index:1;
}
</style>
<div id="fig-trans-diag" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/TransformerSchematic_labeled.png" class="img1 img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;1<strong>.</strong> (Mouse-over or press to expand.) Original Transformer architecture illustration, blue and red annotations added by me. The “Encoder side” circled in red is often used for generating embeddings for analysis-based workflows such as classification tasks; of the most famous ‘encoder-only’ models was BERT (which stood Bidirectional Encoder Representations from Transformers). There’s already an <a href="https://pytorch.org/tutorials/beginner/transformer_tutorial.html">official PyTorch tutorial</a> for the Encoder side. For this lesson, we’ll implement just the Decoder side circled in blue.</figcaption>
</figure>
</div>
<p>For language translation tasks, both the Encoder (circled in red) and Decoder (circled in blue) are used. For purely “generative” systems like the GPT variants and what we’ll do today, we’ll use the Decoder side. Note however that even the Decoder can involve some encoding, as we combine an embedding of the words / MIDI / “tokens” with Positional Encoding information. PE is discussed below.</p>
<p>We’re going to go through the various components that make up the above diagram. But first, let’s point out something about the Attention mechanism that we skipped over in the previous lesson, namely the computational “cost” associated with making every part of a sequence interact with every other part.</p>
<section id="the-cost-of-attention" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-cost-of-attention"><span class="header-section-number">2.1</span> The Cost of Attention</h2>
<p>The attention mechanism <em>per se</em> that we covered in the previous post has a serious drawback: the computational cost scales like the sequence length squared, i.e.&nbsp;for a sequence length of <img src="https://latex.codecogs.com/png.latex?N">, the cost is <big>𝒪</big>(<img src="https://latex.codecogs.com/png.latex?N%5E2)">. This is one reason that Large Language Models can be “Large” – trying to model long sequences results in big matrices!</p>
<details>
<summary>
Details
</summary>
<p>Various schemes have been proposed to reduce this cost, such as only applying attention over nearby tokens (so-called “sliding window” attention) or other methods that fall under the general heading of “matrix sparsification”. Here’s a slide from a talk I gave a few years ago, illustrating a few of these schemes:</p>
<div id="fig-attn-cost" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/attention_cost.hawley.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;2<strong>.</strong> Various schemes for reducing the <big>𝒪</big>(<img src="https://latex.codecogs.com/png.latex?N%5E2)"> cost of Attention. Many such schemes involve replacing the <code>Linear</code> layers with convolution operations, such as with the local receptive fields shown in b) and c). (Source: S.H. Hawley, <a href="https://hedges.belmont.edu/AES_ML_2020/">“Learning Tunable Audio Effects via Neural Networks with Self-Attention”</a>, AES Virtual Symposium: Applications of Machine Learning in Audio, Sep 28, 2020.)</figcaption>
</figure>
</div>
<p>For this lesson, we’ll see how far we can get with the basic <img src="https://latex.codecogs.com/png.latex?N%5E2"> attention. Beyond that, I encourage you to check the literature for whatever the latest/hottest cost-reducing model might be. Popular candidates include <a href="https://arxiv.org/abs/2205.14135">FlashAttention</a> and <a href="https://arxiv.org/abs/2107.14795">PercieverIO</a>. Even sliding windows are <a href="https://twitter.com/hrishioa/status/1712199009308398079">still in use in ways that some people find significant</a>.</p>
</details></section>
<section id="positional-encoding-aka-positional-embeddings" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="positional-encoding-aka-positional-embeddings"><span class="header-section-number">2.2</span> Positional Encoding (aka Positional Embeddings)</h2>
<p>Ordinary Feed-Foward layers (and even convolutional layers) don’t come with (much of) a sense of position, but giving them one can improve performance on tasks where ordering and position matters. There are many ways people have endowed such models with position-awareness and… TBH there’s not necessarily a “silver bullet” solution, so a variety of approaches can end up performing about the same. In what follows we’ll describe various schemes for doing PEs.</p>
<details>
<summary>
Details on PE
</summary>
<section id="some-options-for-pe" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="some-options-for-pe"><span class="header-section-number">2.2.1</span> Some Options for PE</h3>
<ol type="1">
<li><p>You could just concatenate a “linear ramp” of values to provide some position values, but… you wouldn’t want to do that. See, you don’t just want the <em>values</em> of the PEs to contain positional information, you want the <em>gradients</em> of the PEs to convey positional info too. But a linear ramp has a constant gradient.</p></li>
<li><p>There’s the orignal positional encoding from the <a href="https://arxiv.org/abs/1706.03762">AIAYN</a> paper, which uses a set of sines &amp; cosines of expontially-increasing wavelength. They tweaked these wavelengths for their use case and ended up with the following equations: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0APE_%7B(pos,2i)%7D%20=%20%5Csin(pos%20/%2010000%5E%7B2i/d_%7Bmodel%7D%7D)%20%5C%5C%0APE_%7B(pos,2i+1)%7D%20=%20%5Ccos(pos%20/%2010000%5E%7B2i/d_%7Bmodel%7D%7D)%0A%5Cend%7Baligned%7D%0A"> But the authors of the Transformer paper said they tried a few different PE methods/equations – including letting the model learn the PEs – but found no significant impact on performance between them. Let’s add learned PEs to the list though:</p></li>
<li><p><strong>Let the positional embeddings be learned</strong> via some trainable mapping. <em>This</em> is the approach that Karpathy uses in his mini-GPT tutorial, and it’s the default approach we’ll use in this lesson.</p></li>
<li><p><a href="https://fleuret.org/francois/">Francois Fleuret</a> in his <a href="https://twitter.com/francoisfleuret/status/1262639062785105922">“AttentionToy1D”</a> demo, used a simplification of approach #2 by essentially turning it into a set of <a href="images/fleuret_binary.png">binary sequences</a> that correspond to the vertices of a hypercube.</p></li>
<li><p><a href="https://arxiv.org/abs/2108.12409">“ALiBi” (Attention with Linear Biases)</a> is a method whereby you don’t do positional encoding of the inputs, rather you insert the positional information into the attention calculation itself. It is <em>slightly</em> faster to execute than traditional PE and (probably?) offers less memory overhead, and yields comparable results. I tried it and the results were comparable to those obtained from Option #3 above, so <strong>I’ve included ALiBi as a configuration option in the code below.</strong></p></li>
<li><p>One scheme, “<a href="https://paperswithcode.com/method/relative-position-encodings">Relative Position Embeddings</a>,” was reported to make a big difference and it arose in the <a href="https://arxiv.org/abs/1809.04281">Music Transformer</a> paper itself. Should we do this? Yes, probably. Are going to do that in this notebook? …Uh….no, but that would be a great exercise for a student!</p></li>
<li><p>Rotary Encodings. If you view the PEs not as objects themselves but as a set of <em>transformations</em>, and then you require that these be <em>unitary</em> (i.e., magnitude-preserving) transformations,…one could imagine that might help a bit. Rotary encodings are becoming increasingly prevelent in SOTA models, but in our toy case I hypothesize that any gains from this scheme will be swamped by the error from other sources, and thus unnoticeable. Note that the sines &amp; cosines from the original AIAYN paper (Option #2 above) are reminiscent of the “components” of rotations.</p></li>
</ol>
</section>
<section id="pe-to-add-or-concatenate" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="pe-to-add-or-concatenate"><span class="header-section-number">2.2.2</span> PE: To Add or Concatenate?</h3>
<p>Here’s a design question: Should we add these PEs to our inputs or concatenate them? There are a variety of views on this, such as those <a href="https://www.youtube.com/watch?v=M2ToEXF6Olw">described in this video</a>.</p>
<p><strong>Here’s my opinion on this:</strong></p>
<p>Your token embeddings (for the words, or notes, or whatever) are already going to be very high-dimensional. Now, for low-dimensional spaces, adding things up can sort of “destroy” or “obscure” information, but when you’re upwards of 128, 256, 1028 dimensions, etc., then adding ends up being <em>akin</em> to a kind of concatenation anyway (just in some wonky subspace). If you were to concatenate, then sure, your positional info always stays separate from the content. But if you’re going to allow your overall (high-dimensional) embeddings to be <em>learned</em> anyway, then you might as well let the learning dynamic find useful ways to combine the position info with the content info. Otherwise you’re kind of “wasting space” (with concatenation) and doing more calculations than you’d need compared to the “compressed” representation gained by adding learned embeddings.</p>
<p>…But perhaps this is a matter of taste. I’m open to being convinced otherwise!</p>
<p>In the code that follows below, all our embeddigns will be learned and added together, and the position info be treated similarly. But I will add an option to use the “ALiBi” scheme that essentially just moves the PEs to inside the Attention computation.</p>
</section></details>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A great source of instruction about all things related to Positional Encodings is the YouTube channel, <a href="https://www.youtube.com/@AICoffeeBreak">“AI Coffee Break with Letitia”</a>.</p>
</div>
</div>
</section>
</section>
<section id="residual-connections" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="residual-connections"><span class="header-section-number">2.3</span> Residual Connections</h2>
<p>In the Transformer model diagram of Figure&nbsp;1, wherever you see arrows going <em>around</em> something and connecting to a yellow “Add &amp; Norm” block, that is indicative of a “skip residual” or just “residual” connection. Readers will likely have seen residual / skip connections in other contexts, so we’ll make this section “Details”-expandable for those who haven’t encountered them.</p>
<details>
<summary>
Details
</summary>
<p>This is a pretty simple idea that yields payoffs in many areas of numerical modeling: You model the <em>change</em> in something instead of modeling the whole thing. The following flowchart illustrates this:</p>
<div id="fig-resid" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div style="background-color:white; width: 65%; margin-left: auto; margin-right: auto;">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/mermaid.ink/svg/pako:eNo1j0EKg0AMRa8yBAQFewEXBaubQruxu5JNcGIVnIyMGUqR3r3TSnf_fR4kf4PeW4YKhtk_-5GCmkuHkmVG_WLsRI9ADqXOz7JELczhcDzljXcJ2DQjyYMLlNO3N01eW5uo3gml-YU273iNsxZQguPgaLLp3oZiDIKO7BihStHyQElDQHknlaL620t6qDRELiEulpTb_aN_yXZSH677hN-SEhaSu_dJGWhe-f0B3txJZw" class="figure-img"></p>
</div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;3<strong>.</strong> Flowchart of a residual connection</figcaption>
</figure>
</div>
<p>With neural networks, this residual scheme has the added benefit of allowing for efficient backpropagation. There are claims that “skip residual” connections also help smooth the loss surface, such as <a href="https://arxiv.org/abs/1712.09913">this figure in a N(eur)IPS paper from 2017</a>:</p>
<div id="fig-loss-landscape" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/miro.medium.com/v2/resize:fit:723/1*_Qd_txKxRlsMdfuH2J-k4g.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;4<strong>.</strong> Loss landscape picture purporting to show the “smoothing” effects of residual connections. (Source: <a href="https://arxiv.org/abs/1712.09913">Li et al</a>.)</figcaption>
</figure>
</div>
</details>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Modeling the <em>change</em> in something rather than the thing itself often yields significant payoffs in many areas of computational modeling. If you want another example of this, consider that diffusion models model the <em>noise added</em>, not the images or latent vectors themselves.</p>
</div>
</div>
</section>
<section id="multi-head-attention" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="multi-head-attention"><span class="header-section-number">2.4</span> Multi-Head Attention</h2>
<p>We already covered this in the <a href="https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html">previous lesson</a> so I suggest going there. However, I’ll add a recap as Details here:</p>
<details>
<summary>
Details
</summary>
<p>Multi-Head Attention simply involves allowing differently-weighted attention operators (called “heads”) to perform attention operations, allowing them to focus on different “senses” of phrases, parts of speech, or in our case, musical structures. The multiple heads are usually just extra dimensions of a big(ger) matrix multiplication, however they can also be implemented in the form of a loop over the heads to save precious GPU RAM.</p>
<style>
.img-mh {
    /*transform-origin: top left;*/
    width:250px;
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img-mh:hover {
    -webkit-transform:scale(1.7);
    transform:scale(1.7);
    z-index:1;
}
</style>
<div id="fig-mh-attn" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/machinelearningmastery.com/wp-content/uploads/2021/09/tour_4.png" class="img-mh img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;5<strong>.</strong> Diagram of Multi-Head Attention. The multiple attention “heads” are shown below as depthwise semi-transparent copies, which are then concatenated into “one big long thing” via the Concat operation, and then mapped into the the output for the module via the last Linear layer: (Source: <a href="https://arxiv.org/abs/1706.03762">AIAYN</a>.)</figcaption>
</figure>
</div>
</details></section>
<section id="layer-normalization" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="layer-normalization"><span class="header-section-number">2.5</span> Layer Normalization</h2>
<p>This is an alternative to <a href="https://paperswithcode.com/method/batch-normalization">Batch Normalization</a>. With BN, we perform elementwise operations where we subtract the mean across the batch dimension and divide by the variance. With LN, instead of doing this across the batch dimension, we do it across the feature dimension(s).</p>
<style>
.img-ln {
    /*transform-origin: top left;*/
    width:350px;
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img-ln:hover {
    -webkit-transform:scale(1.7);
    transform:scale(1.7);
    z-index:1;
}
</style>
<div id="fig-norm-types" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/production-media.paperswithcode.com/methods/Screen_Shot_2020-05-19_at_4.24.42_PM.png" class="img-ln img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;6<strong>.</strong> (Mouse-over or press to expand.) Batch normalization vs.&nbsp;Layer normalization. (Source: <a href="https://paperswithcode.com/method/layer-normalization">PapersWithCode</a>.)</figcaption>
</figure>
</div>
<p>One big advantage of doing our normalization across layers instead of batches is that <em>it allows for small batch sizes.</em> Language models are often <em>large</em>, so they take up a lot of memory, which means you might need very small batches. But small batches will not allow you to do very good batch normalization. So, LayerNorm helps us get good statistics for the mean and variance that we use to normalize.</p>
</section>
<section id="stacking-blocks-embeddings-of-embeddingsof-embeddings" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="stacking-blocks-embeddings-of-embeddingsof-embeddings"><span class="header-section-number">2.6</span> Stacking Blocks: Embeddings of Embeddings…of Embeddings</h2>
<p>By stacking layers of our transformers, i.e.&nbsp;feeding embeddings into layers that will render them as new embeddings, we will increase the representational power of our model. In terms of code, this is easy to do by looping over a list of layers.</p>
</section>

<section id="the-music-midi-dataset" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> The Music (MIDI) Dataset</h1>
<p>This section adopts a first-person perspective because I want to convey a personal tone: I confess that I’m “not a MIDI guy,” having always worked with raw audio exclusively. I vastly underestimated how difficult it would be to get decent results. Starting from Google’s well-known <a href="https://magenta.tensorflow.org/datasets/maestro">MAESTRO dataset</a> of solo piano performances – NOTE: <em>virtuoso</em> piano performances! –I kept downgrading the “difficulty” of the dataset until settling on <a href="https://github.com/czhuang/JSB-Chorales-dataset">Bach chorales</a>.</p>
<section id="learning-about-midi-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="learning-about-midi-data"><span class="header-section-number">3.1</span> Learning About MIDI Data</h2>
<details>
<summary>
Details
</summary>
<p>The MAESTRO data wasn’t overly challenging if I only focussed on modeling the pitches, but music is pitch + timing (+ more). What’s more, I’d only ever seen MIDI music “quantized” into a grid-based “piano roll” format with a known time-signature, not realizing that that’s not what MIDI data really is. For our purposes, it’s worth noting that MIDI encodes several pieces of information on a <em>per-note</em> basis:</p>
<ol type="1">
<li>What instrument played the note</li>
<li>What pitch was played – an integer between 0 and 127.</li>
<li>The start time of the note – in units of the “MIDI clock” which <em>usually</em> ticks at 50,000 times a second. This is typically rendered as a floating-point number when using Python MIDI-processing packages such as Colin Raffel’s <a href="https://craffel.github.io/pretty-midi/">pretty-midi</a> (which we will use)</li>
<li>The end time of the note - another float.</li>
<li>The “velocity” of the note – e.g.&nbsp;how hard a piano key was struck.</li>
</ol>
<p>So, no time signature, no quarter-note, half-note, etc. But fine, taking a lead from the <a href="https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/audio/music_generation.ipynb">Google Tensorflow Demo for RNN Modeling</a>, we can reduce each note to 3 numbers: 1. pitch 2. “step” in time since the previous note 3. duration of the note (i.e.&nbsp;end time minus start time).</p>
<p>…and focus on single-instrument work, and disregard the velocity.</p>
<p>EVEN THAT was too hard for the code below do with MAESTRO. I then noticed a <a href="https://arxiv.org/abs/1808.03715">paper by the Google team</a> pointed out that quantizing the time into bins of 8 milliseconds was an ok simplification to make, but even this proved too hard for my model. (I could do 16 ms, but that sounded weird.)</p>
<p>…so…. after surveying other things, I went with <a href="https://github.com/czhuang/JSB-Chorales-dataset">Bach Chorales</a>, which actually <em>are</em> presented in piano-roll format quantized to 16th note time intervals. Then I had to convert those from JSON to true MIDI, because by then the rest of my code expected MIDI.</p>
<p>I’ll spare you the details of that process, but note that the data link below is not the official dataset link, it’s <a href="https://drive.google.com/file/d/1MdJiNEgtkvCx9tnyQWcnEE5GPMY6ADUb/view?usp=sharing">my private stash</a> where I converted the JSON to .mid.</p>
</details></section>
<section id="install-and-import" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="install-and-import"><span class="header-section-number">3.2</span> Install and Import</h2>
<div class="cell">
<details>
<summary>Show the code for system-wide installs</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Somehow you need to install fluidsynth</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> platform</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> install_package(package_name):</span>
<span id="cb1-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"For installing system binaries on Linux (Ubuntu/Debia) or Mac (via Homebrew)"</span></span>
<span id="cb1-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> platform.system() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Darwin'</span>:</span>
<span id="cb1-9">        os.system(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'brew install </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>package_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> platform.system() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linux'</span>:</span>
<span id="cb1-11">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> getpass  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: colab doesn't need a password for sudo</span></span>
<span id="cb1-12">        password <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> getpass.getpass()</span>
<span id="cb1-13">        command <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"sudo -S apt-get install </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>package_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> </span>
<span id="cb1-14">        os.popen(command, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>).write(password<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb1-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unsupported Operating System"</span>)</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># commenting out b/c I keep re-running this notebook</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#install_package('fluidsynth')</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code for pip installs</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq gdown pyfluidsynth pretty_midi torch numpy pandas midi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>player multiprocess</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code for imports</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import (most of) what we'll need for the entire lesson</span></span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> collections</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> fluidsynth</span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> glob</span>
<span id="cb3-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb3-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pretty_midi</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb3-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nn, einsum</span>
<span id="cb3-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.nn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> F</span>
<span id="cb3-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Dataset, DataLoader</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional</span>
<span id="cb3-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> glob <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> glob</span>
<span id="cb3-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> multiprocess <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mp   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># multiprocess is a Jupyter-compatible fork of multiprocessing</span></span>
<span id="cb3-19"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> partial</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tqdm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note: Quarto blog won't print output from tqdm.notebook</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#from tqdm.contrib.concurrent import process_map  # process_map throws errors on Mac :'-( </span></span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb3-25"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb3-26"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pprint</span>
<span id="cb3-27"></span>
<span id="cb3-28"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> display, HTML</span></code></pre></div>
</details>
</div>
</section>
<section id="download-and-inspect-the-data" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="download-and-inspect-the-data"><span class="header-section-number">3.3</span> Download and Inspect the Data</h2>
<div class="cell">
<details>
<summary>Show the code for downloading the dataset</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the data</span></span>
<span id="cb4-2">data_source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'jsb_chorales_midi'</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: add options for MAESTRO, others</span></span>
<span id="cb4-4"></span>
<span id="cb4-5">data_dir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'midi_data'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generic name for whatever midi we might want</span></span>
<span id="cb4-6">REST_PITCH <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># special code  used to denote rests</span></span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>gdown <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>O {data_source}.tgz <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">MdJiNEgtkvCx9tnyQWcnEE5GPMY6ADUb</span></span>
<span id="cb4-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>tar zxf {data_source}.tgz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>rf midi_data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ln <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>s {data_source} midi_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get the list of MIDI filenames</span></span>
<span id="cb4-12">filenames <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(glob(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(data_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'**/*.mid*'</span>),recursive<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span>
<span id="cb4-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Number of files:'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(filenames))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading...
From: https://drive.google.com/uc?id=1MdJiNEgtkvCx9tnyQWcnEE5GPMY6ADUb
To: /Users/shawley/github/blog/posts/jsb_chorales_midi.tgz
100%|████████████████████████████████████████| 137k/137k [00:00&lt;00:00, 7.18MB/s]
Number of files: 382</code></pre>
</div>
</div>
<p>Let’s inspect one of the files – using the <a href="https://github.com/drscotthawley/midi-player"><code>MIDIPlayer</code></a> object created especially for this lesson!</p>
<div class="cell">
<details>
<summary>Show the code for MIDI player usage</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> midi_player <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MIDIPlayer</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> midi_player.stylers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> general, dark <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I like dark mode</span></span>
<span id="cb6-3"></span>
<span id="cb6-4">midi_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> filenames[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-5">MIDIPlayer(midi_file, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, styler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dark, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"midi_file = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>midi_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div id="fig-midi-play1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section984 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section984 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section984 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section984 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section984 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section984 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section984 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section984 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section984 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section984 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section984 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section984&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>midi_file = midi_data/test/jsb_chorale_test_0.mid<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhQDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIMnMEAANQAAQ0AARQAASECDJilAADAAAEFAAEMAAEVAAEgAhBApAAArQGorAAAtQGktAAAuQGouAAAwQABAQABBAABDQABFAGowAAAyQAA+QABAAGkyAAA0QAA+AGowQAA0AAA6QGkwAAA1QAA5QAA6AABDAABFQGo1AAA3QAA5AAA6QGo3AAA5QAA6AGk5AAA6QAA+QGo6AAA+AABAQABDQABFAGk6QGo5QAA6AGo3QAA5AGk1QAA3AABAAABBQABDAABFQGo0QAA1AGkyQAA0AAA8AAA+QGowQAAyAGouQAAwAABDQABFAGkrQAAuAGorAAAwQAA8QAA+AABAQABBAGk6QAA8AGopQAAwAAA5QAA6AABAAABBQABDAIMmJkAAKQAAOQAAPkAAQQAARUAATUBqJgAAKUAAPEAAPgBqKQAAK0AAOkAAPAAAQ0AARQAATEAATQBpKwAALUBqLQAALkAAQUAAQwAASkAATABpOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADVAADcAAD5AAEAAAEZAAEgAajIAADRAADUAADdAaTQAADVAADcAADlAADxAAD4AAEVAAEYAai1AADUAADkAai0AAC5AADpAADwAAD5AAENAAEUAaStAAC4ANTlAADoANSsAADBAADdAADkAADxAAD4AgVMpQAAwAAA3AAA5QABBQABDAIMmKQAAOQAAPAAAQQAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhQDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIMnMEAANQAAQ0AARQAASECDJilAADAAAEFAAEMAAEVAAEgAhBApAAArQGorAAAtQGktAAAuQGouAAAwQABAQABBAABDQABFAGowAAAyQAA+QABAAGkyAAA0QAA+AGowQAA0AAA6QGkwAAA1QAA5QAA6AABDAABFQGo1AAA3QAA5AAA6QGo3AAA5QAA6AGk5AAA6QAA+QGo6AAA+AABAQABDQABFAGk6QGo5QAA6AGo3QAA5AGk1QAA3AABAAABBQABDAABFQGo0QAA1AGkyQAA0AAA8AAA+QGowQAAyAGouQAAwAABDQABFAGkrQAAuAGorAAAwQAA8QAA+AABAQABBAGk6QAA8AGopQAAwAAA5QAA6AABAAABBQABDAIMmJkAAKQAAOQAAPkAAQQAARUAATUBqJgAAKUAAPEAAPgBqKQAAK0AAOkAAPAAAQ0AARQAATEAATQBpKwAALUBqLQAALkAAQUAAQwAASkAATABpOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADVAADcAAD5AAEAAAEZAAEgAajIAADRAADUAADdAaTQAADVAADcAADlAADxAAD4AAEVAAEYAai1AADUAADkAai0AAC5AADpAADwAAD5AAENAAEUAaStAAC4ANTlAADoANSsAADBAADdAADkAADxAAD4AgVMpQAAwAAA3AAA5QABBQABDAIMmKQAAOQAAPAAAQQAB/y8A sound-font visualizer=&quot;#section984 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhQDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIMnMEAANQAAQ0AARQAASECDJilAADAAAEFAAEMAAEVAAEgAhBApAAArQGorAAAtQGktAAAuQGouAAAwQABAQABBAABDQABFAGowAAAyQAA+QABAAGkyAAA0QAA+AGowQAA0AAA6QGkwAAA1QAA5QAA6AABDAABFQGo1AAA3QAA5AAA6QGo3AAA5QAA6AGk5AAA6QAA+QGo6AAA+AABAQABDQABFAGk6QGo5QAA6AGo3QAA5AGk1QAA3AABAAABBQABDAABFQGo0QAA1AGkyQAA0AAA8AAA+QGowQAAyAGouQAAwAABDQABFAGkrQAAuAGorAAAwQAA8QAA+AABAQABBAGk6QAA8AGopQAAwAAA5QAA6AABAAABBQABDAIMmJkAAKQAAOQAAPkAAQQAARUAATUBqJgAAKUAAPEAAPgBqKQAAK0AAOkAAPAAAQ0AARQAATEAATQBpKwAALUBqLQAALkAAQUAAQwAASkAATABpOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADVAADcAAD5AAEAAAEZAAEgAajIAADRAADUAADdAaTQAADVAADcAADlAADxAAD4AAEVAAEYAai1AADUAADkAai0AAC5AADpAADwAAD5AAENAAEUAaStAAC4ANTlAADoANSsAADBAADdAADkAADxAAD4AgVMpQAAwAAA3AAA5QABBQABDAIMmKQAAOQAAPAAAQQAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="360" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;7<strong>.</strong> Example of the first MIDI file on our list. (Press the play button to listen.) These particular notes really <em>were</em> arranged on a “grid,” however I converted them to a series of MIDI “notes,” occurring one after the other in the file, with simultaneously-starting notes sorted in ascending order of pitch.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sometimes the <code>MIDIPlayer</code>’s piano roll view will appear blank if the notes are below the bottom of the visible frame. Scroll downward inside the player to reveal all the notes. The piano roll also scrolls left &amp; right.</p>
</div>
</div>
<p>Let’s load a single file and convert it to a PyTorch tensor called <code>notes_tensor</code>, and we’ll go ahead and convert “start” and “end” times “step” and “duration” times. So, displaying the first several notes (using a <code>pandas</code> dataframe for style) we see…</p>
<div class="cell">
<details>
<summary>Show the code that made Table 1</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Now that the encoder uses rouding/nearest neighbors, we could save the time-quantization for later. </span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       That sets us up for vector quantization approaches</span></span>
<span id="cb7-3"></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> quantize_times(times, </span>
<span id="cb7-6">                   res_ms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># resolution in milliseconds. 8ms was deemed sufficient for MAESTRO.</span></span>
<span id="cb7-7">                   clamp_range_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span>]):</span>
<span id="cb7-8">    quant_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> res_ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000.0</span></span>
<span id="cb7-9">    q_times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> quant_step) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> quant_step</span>
<span id="cb7-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> clamp_range_s <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: </span>
<span id="cb7-11">        q_times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.clamp(q_times, clamp_range_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], clamp_range_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> q_times</span>
<span id="cb7-13"></span>
<span id="cb7-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> midi_file_to_tensor(filenames, i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, keep_start_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, rest_pitches<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[REST_PITCH]):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filenames could just be a single filename</span></span>
<span id="cb7-15">    midi_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> filenames <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(filenames)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> filenames[i]</span>
<span id="cb7-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"reads a single midi file and converts it to tensor with elements (pitch, step, duration)"</span></span>
<span id="cb7-17">    pm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pretty_midi.PrettyMIDI(midi_file) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># read in the whole file. this can be very slow for long MIDI files (e.g. in MAESTRO)</span></span>
<span id="cb7-18"></span>
<span id="cb7-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort the notes first by start time (and then by pitch if two notes start at the same time)</span></span>
<span id="cb7-20">    sorted_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(pm.instruments[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].notes, key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> note: (note.start, note.pitch))</span>
<span id="cb7-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#notes = torch.empty( (len(sorted_notes), 3 + 2*keep_start_end), dtype=torch.float32 ) # allocate storage</span></span>
<span id="cb7-22">    </span>
<span id="cb7-23">    prev_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_notes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].start</span>
<span id="cb7-24">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb7-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, note <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sorted_notes):</span>
<span id="cb7-26">        new_note <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  torch.empty( (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>keep_start_end) , dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.float32)</span>
<span id="cb7-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(note.pitch) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> rest_pitches: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">continue</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can actually delete the rests! </span></span>
<span id="cb7-28">        new_note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.pitch</span>
<span id="cb7-29">        new_note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prev_start  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># step, i.e. time since start of previous note</span></span>
<span id="cb7-30">        new_note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> note.start    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># duration</span></span>
<span id="cb7-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> keep_start_end:                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># might find it useful be able to keep these for easier analysis later</span></span>
<span id="cb7-32">            new_note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.start</span>
<span id="cb7-33">            new_note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.end</span>
<span id="cb7-34">        prev_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note.start</span>
<span id="cb7-35">        notes.append(new_note)</span>
<span id="cb7-36"></span>
<span id="cb7-37">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.vstack(notes)</span>
<span id="cb7-38">    notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> quantize_times(notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:])</span>
<span id="cb7-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> notes</span>
<span id="cb7-40"></span>
<span id="cb7-41">notes_tensor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> midi_file_to_tensor(midi_file)</span>
<span id="cb7-42">pd.set_option(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'display.notebook_repr_html'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb7-43">notes_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(notes_tensor, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pitch'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step (s)'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'duration (s)'</span>]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># actually df's look nicer</span></span>
<span id="cb7-44"></span>
<span id="cb7-45"></span>
<span id="cb7-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># making it look better in the blog: adjust width of pandas dataframes</span></span>
<span id="cb7-47">display(HTML(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb7-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;style&gt;</span></span>
<span id="cb7-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.dataframe {</span></span>
<span id="cb7-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    width: 40%; /* Adjust this value as needed */</span></span>
<span id="cb7-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    margin-left: auto;</span></span>
<span id="cb7-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    margin-right: auto;</span></span>
<span id="cb7-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.dataframe th, .dataframe td {</span></span>
<span id="cb7-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    text-align: center;</span></span>
<span id="cb7-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    width: auto !important;</span></span>
<span id="cb7-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-58"></span>
<span id="cb7-59"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">table {</span></span>
<span id="cb7-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    margin-left: auto;</span></span>
<span id="cb7-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    margin-right: auto;</span></span>
<span id="cb7-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">th, td {</span></span>
<span id="cb7-64"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    text-align: center;</span></span>
<span id="cb7-65"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    min-width: 100px; /* Or any other width */</span></span>
<span id="cb7-66"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/style&gt;</span></span>
<span id="cb7-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span>))</span>
<span id="cb7-69">HTML(notes_df[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>].to_html(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">


<style>
.dataframe {
    width: 40%; /* Adjust this value as needed */
    margin-left: auto;
    margin-right: auto;
}
.dataframe th, .dataframe td {
    text-align: center;
    width: auto !important;
}

table {
    margin-left: auto;
    margin-right: auto;
}
th, td {
    text-align: center;
    min-width: 100px; /* Or any other width */
}
</style>
</div>
<div class="cell-output cell-output-display">
<div id="tbl-firstnotes" class="anchored">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<caption>Table&nbsp;1<strong>.</strong> First 8 notes of <code>notes_tensor</code></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pitch</th>
<th data-quarto-table-cell-role="th">step (s)</th>
<th data-quarto-table-cell-role="th">duration (s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>53.0</td>
<td>0.00</td>
<td>0.48</td>
</tr>
<tr class="even">
<td>57.0</td>
<td>0.00</td>
<td>0.48</td>
</tr>
<tr class="odd">
<td>60.0</td>
<td>0.00</td>
<td>1.44</td>
</tr>
<tr class="even">
<td>65.0</td>
<td>0.00</td>
<td>0.48</td>
</tr>
<tr class="odd">
<td>52.0</td>
<td>0.48</td>
<td>0.48</td>
</tr>
<tr class="even">
<td>55.0</td>
<td>0.00</td>
<td>0.48</td>
</tr>
<tr class="odd">
<td>72.0</td>
<td>0.00</td>
<td>0.24</td>
</tr>
<tr class="even">
<td>70.0</td>
<td>0.24</td>
<td>0.24</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We’ll convert those floating point numbers to integer indices in “codebooks” via the “tokenizer” below.</p>
<p>Now we’ll load each song into an entry in a list called <code>notes_tensor_list</code>:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> files_to_tensor_list(filenames, keep_start_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, serial<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>):</span>
<span id="cb8-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"Reads MIDI files in parallel so should be reasonably fast. JSB Chorales are no prob but for MAESTRO you want this"</span></span>
<span id="cb8-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tensor_list = process_map(midi_file_to_tensor, filenames, max_workers=mp.cpu_count(), chunksize=1) # Doesn't work on Mac</span></span>
<span id="cb8-4">    tensor_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb8-5">    max_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(filenames)</span>
<span id="cb8-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> serial:</span>
<span id="cb8-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, filename <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(filenames)):</span>
<span id="cb8-8">            tensor_list.append(midi_file_to_tensor(filename,  keep_start_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>keep_start_end))</span>
<span id="cb8-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb8-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> mp.Pool(processes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mp.cpu_count()) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> p:</span>
<span id="cb8-11">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> tqdm(total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pbar:</span>
<span id="cb8-12">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> r <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> p.imap_unordered(partial(midi_file_to_tensor, filenames, keep_start_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>keep_start_end), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_)):</span>
<span id="cb8-13">                    tensor_list.append(r)</span>
<span id="cb8-14">                    pbar.update()</span>
<span id="cb8-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span>  tensor_list</span>
<span id="cb8-16"></span>
<span id="cb8-17"></span>
<span id="cb8-18"></span>
<span id="cb8-19"></span>
<span id="cb8-20">notes_tensor_list_filename <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>data_source<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_tensor_list.pt'</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we'll save the result to a file for easier re-reading next time</span></span>
<span id="cb8-21">read_all_midi_files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> os.path.exists(notes_tensor_list_filename) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check to see if it already exists</span></span>
<span id="cb8-22"></span>
<span id="cb8-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> read_all_midi_files:</span>
<span id="cb8-24">    notes_tensor_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> files_to_tensor_list(filenames, serial<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-25">    torch.save(notes_tensor_list, notes_tensor_list_filename) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for next time</span></span>
<span id="cb8-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb8-27">    notes_tensor_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(notes_tensor_list_filename) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just read from the last time we made one</span></span>
<span id="cb8-28">    </span>
<span id="cb8-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">len(notes_tensor_list) = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(notes_tensor_list)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████████████████████████████████████████████████████████████████████████████████████| 382/382 [00:02&lt;00:00, 148.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
len(notes_tensor_list) = 382</code></pre>
</div>
</div>
<p>Also, let’s make a single tensor <code>all_notes</code> out of all the notes. We’re only going to use this for analysis purposes; for everything else we’ll use the <code>notes_tensor_list</code>, which…I’m now going to abbreviate as <code>notes_tl</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">notes_tl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes_tensor_list</span>
<span id="cb11-2">all_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.vstack(notes_tl).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(torch.float32)</span>
<span id="cb11-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all_notes.shape = "</span>,all_notes.shape)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>all_notes.shape =  torch.Size([78349, 3])</code></pre>
</div>
</div>
</section>
<section id="making-a-tokenizer-codebooks" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="making-a-tokenizer-codebooks"><span class="header-section-number">3.4</span> Making a Tokenizer: Codebooks</h2>
Rather than try something sophisticated like calling <a href="https://github.com/Natooz/MidiTok">MidiTok</a>, we’re going to treat this like a “char-level RNN” and just regard each note as a “parallel” group of 3 tokens (i.e., one token each for pitch, step, and duration). This means that we will need 3 “codebooks” that can encode &amp; decode between real-world values and their indices in the codebooks.
<details>
<summary>
Details
</summary>
<p>For the pitch values, it’s pretty easy since there are up to 128 MIDI pitches. Probably they won’t all be used, so we <em>could</em> limit the range of pitches, however, I’m going to want to do some pitch-bending data augmentation, so the pitch tokens will just be <code>int</code> versions of their <code>floats</code>, i.e., indices in a 128-dimensional space.</p>
<p>For the timing – which I don’t plan to do any augmentation of – we’ll just write down what unique values are present. These will form the “vocabularies” that we often see used in NLP settings.</p>
<p>Oh, also: The timing values end up being <em>reaaalllly</em> long in some cases. Like, notes with 15 seconds in duration? I’m going to go ahead an clamp those to a maximum value of 4 seconds.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> make_codebooks(all_notes, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb13-2">    codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb13-3">    n_codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> all_notes.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># should be 3</span></span>
<span id="cb13-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_codebooks): </span>
<span id="cb13-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i=0 means pitch</span></span>
<span id="cb13-6">            cb_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just use all possible pitches. could limit to min/max range but...not gonna. </span></span>
<span id="cb13-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># i!=0 means timing</span></span>
<span id="cb13-8">            cb_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> all_notes[:,i].unique().sort()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] </span>
<span id="cb13-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> verbose: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">---</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">cb </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: cb_vals = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cb_vals<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb13-10">        codebooks.append(cb_vals)</span>
<span id="cb13-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> codebooks</span>
<span id="cb13-12">    </span>
<span id="cb13-13"></span>
<span id="cb13-14">all_notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> quantize_times(all_notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we should already be time-quantized so this should be unnecessary, but...just in case</span></span>
<span id="cb13-15">codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_codebooks(all_notes, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb13-16"></span>
<span id="cb13-17">vocab_sizes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cb) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> codebooks]</span>
<span id="cb13-18">display(HTML(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Codebook sizes = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>vocab_sizes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;br&gt;&lt;br&gt;"</span>))</span>
<span id="cb13-19"></span>
<span id="cb13-20"></span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">###--- From here down, it's just a nice way to display the codebooks in the blog post: </span></span>
<span id="cb13-23"></span>
<span id="cb13-24">df1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(codebooks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].numpy(), columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'steps (s)'</span>])</span>
<span id="cb13-25">df2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(codebooks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>].numpy(), columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'durations (s)'</span>])</span>
<span id="cb13-26">display(HTML(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Codebooks for steps &amp; durations are </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>equals(df2) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'not '</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">the same:"</span>))</span>
<span id="cb13-27"></span>
<span id="cb13-28">html1, html2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df1.to_html(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>),  df2.to_html(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb13-29"></span>
<span id="cb13-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine HTML strings with a space in between</span></span>
<span id="cb13-31">combined_html <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'''&lt;div style="width: 100%; text-align: center;"&gt;</span></span>
<span id="cb13-32"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">     &lt;table style="margin-left: auto; margin-right: auto;"&gt; &lt;tr&gt;</span></span>
<span id="cb13-33"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">     &lt;td style="vertical-align: top;"&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>html1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/td&gt;</span></span>
<span id="cb13-34"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">     &lt;td style="width: 50px;"&gt;&lt;/td&gt;</span></span>
<span id="cb13-35"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">     &lt;td style="vertical-align: top;"&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>html2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/td&gt;</span></span>
<span id="cb13-36"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">     &lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;'''</span></span>
<span id="cb13-37"></span>
<span id="cb13-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the combined HTML</span></span>
<span id="cb13-39">display(HTML(combined_html))</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
Codebook sizes = [128, 15, 28]<br><br>
</div>
<div class="cell-output cell-output-display">
Codebooks for steps &amp; durations are not the same:
</div>
<div class="cell-output cell-output-display">
<div style="width: 100%; text-align: center;">
     
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td style="vertical-align: top"><table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">steps (s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.00</td>
</tr>
<tr class="even">
<td>0.12</td>
</tr>
<tr class="odd">
<td>0.24</td>
</tr>
<tr class="even">
<td>0.36</td>
</tr>
<tr class="odd">
<td>0.48</td>
</tr>
<tr class="even">
<td>0.72</td>
</tr>
<tr class="odd">
<td>0.96</td>
</tr>
<tr class="even">
<td>1.20</td>
</tr>
<tr class="odd">
<td>1.44</td>
</tr>
<tr class="even">
<td>1.68</td>
</tr>
<tr class="odd">
<td>1.92</td>
</tr>
<tr class="even">
<td>2.40</td>
</tr>
<tr class="odd">
<td>2.88</td>
</tr>
<tr class="even">
<td>3.84</td>
</tr>
<tr class="odd">
<td>4.00</td>
</tr>
</tbody>
</table></td>
<td style="width: 50px"></td>
<td style="vertical-align: top"><table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">durations (s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.12</td>
</tr>
<tr class="even">
<td>0.24</td>
</tr>
<tr class="odd">
<td>0.36</td>
</tr>
<tr class="even">
<td>0.48</td>
</tr>
<tr class="odd">
<td>0.60</td>
</tr>
<tr class="even">
<td>0.72</td>
</tr>
<tr class="odd">
<td>0.84</td>
</tr>
<tr class="even">
<td>0.96</td>
</tr>
<tr class="odd">
<td>1.08</td>
</tr>
<tr class="even">
<td>1.20</td>
</tr>
<tr class="odd">
<td>1.32</td>
</tr>
<tr class="even">
<td>1.44</td>
</tr>
<tr class="odd">
<td>1.56</td>
</tr>
<tr class="even">
<td>1.68</td>
</tr>
<tr class="odd">
<td>1.80</td>
</tr>
<tr class="even">
<td>1.92</td>
</tr>
<tr class="odd">
<td>2.04</td>
</tr>
<tr class="even">
<td>2.16</td>
</tr>
<tr class="odd">
<td>2.40</td>
</tr>
<tr class="even">
<td>2.52</td>
</tr>
<tr class="odd">
<td>2.64</td>
</tr>
<tr class="even">
<td>2.88</td>
</tr>
<tr class="odd">
<td>3.12</td>
</tr>
<tr class="even">
<td>3.24</td>
</tr>
<tr class="odd">
<td>3.36</td>
</tr>
<tr class="even">
<td>3.60</td>
</tr>
<tr class="odd">
<td>3.84</td>
</tr>
<tr class="even">
<td>4.00</td>
</tr>
</tbody>
</table></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="encoding-and-decoding" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="encoding-and-decoding"><span class="header-section-number">3.4.1</span> Encoding and Decoding</h3>
<p>Now we need routines to encode and decode, i.e., to convert back and forth between real-world values and codebook indices.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since the quantities we’re tokenizing are numerical, we don’t need key-value pairs as you might see in NLP applications. (Thus we can avoid <code>KeyError</code>s. ;-) ) Rather, for encoding, we can use a simple “<code>argmin</code>” on the “distances” between new values and codebook values. Then decoding will simply be a matter of inserting the index into the array of codebook values. This is like <a href="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ.html">Vector Quantization</a>, except it’s only one dimension (so “scalar quantization”?). For codebooks in high-dimensional spaces, typically VQ methods will use (Approximate) Nearest Neighbors or Locality Sensitive Hashing, but since we’re just in 1-D, simple argmin is fine.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the (Token) Encoder/Decoder code (i.e., real-world values &lt;–&gt; codebook indices)</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encode_one_cb(seq:torch.Tensor, cb:torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>:</span>
<span id="cb14-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" Encodes one 'column' of note info (either pitches, steps, or durations)</span></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        given new value(s) and codebook, return argmin of the difference</span></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Difficulty: seq and cb may have different lengths &amp; may not broadcast, </span></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        thus I wrote a loop that broadcasts each note over all cb values</span></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb14-7">    sidx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty( seq.shape, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seq.device)</span>
<span id="cb14-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, note <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(seq):                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note: this is trivially parallel but jupyter mp hangs for me :'-(</span></span>
<span id="cb14-9">        sidx[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.argmin( ( note <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cb )<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> )   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># could use torch.abs() instead of ^2 since we're in 1-D, but I want this to be general</span></span>
<span id="cb14-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sidx</span>
<span id="cb14-11">    </span>
<span id="cb14-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> decode_one_cb(xi, cb:torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb14-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Decodes one 'column' of note-index info (either pitch_i, step_i, or duration_i)</span></span>
<span id="cb14-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    xi should be an int, a list of ints, or a tensor of ints"""</span></span>
<span id="cb14-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> cb[xi]</span>
<span id="cb14-16"></span>
<span id="cb14-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encode(seq:torch.Tensor, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebooks) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb14-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"Encodes a sequence of notes, where each note is (pitch, step, dur)"</span></span>
<span id="cb14-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(seq.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not set up for batch processing yet, but could be a fun exercise for a student ;-) "</span></span>
<span id="cb14-20">    encoded <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty( seq.shape, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seq.device)</span>
<span id="cb14-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(cbs):</span>
<span id="cb14-22">        encoded[:,i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode_one_cb( seq[:,i], cb)</span>
<span id="cb14-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> encoded</span>
<span id="cb14-24"></span>
<span id="cb14-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> decode(sidx:torch.Tensor, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebooks) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb14-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"Decodes a sequence of integer indices for notes (pitch_i, step_i, dur_i)"</span></span>
<span id="cb14-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sidx.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not set up for batch processing yet, but could be a fun exercise for a student ;-)"</span></span>
<span id="cb14-28">    decoded <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty( sidx.shape, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.float32, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sidx.device)</span>
<span id="cb14-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(cbs):</span>
<span id="cb14-30">        decoded[:,i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decode_one_cb( sidx[:,i], cb)</span>
<span id="cb14-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> decoded    </span>
<span id="cb14-32"></span>
<span id="cb14-33"></span>
<span id="cb14-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's do a little test to see if we get back what we encode</span></span>
<span id="cb14-35">midi_seq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> all_notes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>].clone()</span>
<span id="cb14-36"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Before encoding, midi_seq =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,midi_seq)</span>
<span id="cb14-37">token_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(midi_seq)</span>
<span id="cb14-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"After encoding, token_list =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,token_list)</span>
<span id="cb14-39">return_seq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decode(token_list)</span>
<span id="cb14-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"After decoding, return_seq =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,return_seq)</span>
<span id="cb14-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> torch.equal( midi_seq, return_seq), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Oops. midi_seq=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>midi_seq<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, but return_seq=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>return_seq<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">. Should be the same"</span></span>
<span id="cb14-42"></span>
<span id="cb14-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "safety" check re. values that exceed codebook range -- should get truncated to last cb entry</span></span>
<span id="cb14-44">midi_seq[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100.0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># give the last time a huge value to check that our mapper won't crash</span></span>
<span id="cb14-45">token_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(midi_seq, codebooks) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if it doesn't crash, we're good</span></span>
<span id="cb14-46"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> token_list[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(codebooks[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Big value (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>midi_seq[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) should have gotten the last spot in the last codebook (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(codebooks[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) but came back as </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>token_list[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb14-47"></span>
<span id="cb14-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Preliminary Encoding/Decoding checks pass! :-)"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Before encoding, midi_seq =
 tensor([[53.0000,  0.0000,  0.4800],
        [57.0000,  0.0000,  0.4800],
        [60.0000,  0.0000,  1.4400],
        [65.0000,  0.0000,  0.4800],
        [52.0000,  0.4800,  0.4800],
        [55.0000,  0.0000,  0.4800],
        [72.0000,  0.0000,  0.2400],
        [70.0000,  0.2400,  0.2400]])
After encoding, token_list =
 tensor([[53,  0,  3],
        [57,  0,  3],
        [60,  0, 11],
        [65,  0,  3],
        [52,  4,  3],
        [55,  0,  3],
        [72,  0,  1],
        [70,  2,  1]])
After decoding, return_seq =
 tensor([[53.0000,  0.0000,  0.4800],
        [57.0000,  0.0000,  0.4800],
        [60.0000,  0.0000,  1.4400],
        [65.0000,  0.0000,  0.4800],
        [52.0000,  0.4800,  0.4800],
        [55.0000,  0.0000,  0.4800],
        [72.0000,  0.0000,  0.2400],
        [70.0000,  0.2400,  0.2400]])
Preliminary Encoding/Decoding checks pass! :-)</code></pre>
</div>
</div>
</section>
<section id="checking-encoding-decoding-playing-tensors" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="checking-encoding-decoding-playing-tensors"><span class="header-section-number">3.4.2</span> Checking Encoding &amp; Decoding, ‘Playing’ Tensors</h3>
<p>Before moving on, it’s a good idea to double check: Can we really encode and decode an entire midi sequence? Let’s write some more utility files. Notably the <code>midiplayer()</code> routine which will allow us to play our PyTorch tensors directly in this notebook.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_start_end(notes:torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb16-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"integrates (step,duration) timing pairs to recover (start,end) info. concats them as new columns"</span></span>
<span id="cb16-3">    newnotes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty((<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(notes), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>notes.dtype, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>notes.device)</span>
<span id="cb16-4">    newnotes[:,:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes[:,:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb16-5">    prev_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb16-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, note <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(notes): </span>
<span id="cb16-7">        step, dur <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb16-8">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> prev_start </span>
<span id="cb16-9">        end   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dur</span>
<span id="cb16-10">        newnotes[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], newnotes[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> start, end</span>
<span id="cb16-11">        prev_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> start   </span>
<span id="cb16-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> newnotes</span>
<span id="cb16-13">    </span>
<span id="cb16-14"></span>
<span id="cb16-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> notes_to_midi(notes:torch.Tensor, </span>
<span id="cb16-16">                  time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, </span>
<span id="cb16-17">                  out_file: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,</span>
<span id="cb16-18">                  instrument_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Acoustic Grand Piano'</span>,</span>
<span id="cb16-19">                  velocity: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># default loudness for all notes</span></span>
<span id="cb16-20">                 ) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> pretty_midi.PrettyMIDI:</span>
<span id="cb16-21">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes.clone()       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just to avoid weird overwrites of memory addresses</span></span>
<span id="cb16-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> notes.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>:</span>
<span id="cb16-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WARNING: You have negative pitches, steps or durations. Setting them to zero"</span>)</span>
<span id="cb16-24">      notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ReLU on all quantities</span></span>
<span id="cb16-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> time_rescale <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># added because sometimes I want to slow/speed up</span></span>
<span id="cb16-26">        notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>time_rescale</span>
<span id="cb16-27">        </span>
<span id="cb16-28">    pm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pretty_midi.PrettyMIDI()</span>
<span id="cb16-29">    instrument <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pretty_midi.Instrument( program<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pretty_midi.instrument_name_to_program(instrument_name) )</span>
<span id="cb16-30">    </span>
<span id="cb16-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> notes.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>: notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_start_end(notes)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># figure out start,end times from step,dur, concat as new columns</span></span>
<span id="cb16-32">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes.cpu().numpy()</span>
<span id="cb16-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> note <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> notes: </span>
<span id="cb16-34">        midi_note <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pretty_midi.Note( velocity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>velocity, pitch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]), start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>note[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], )</span>
<span id="cb16-35">        instrument.notes.append(midi_note)</span>
<span id="cb16-36">        </span>
<span id="cb16-37">    pm.instruments.append(instrument)</span>
<span id="cb16-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> out_file: pm.write(out_file)</span>
<span id="cb16-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> pm</span>
<span id="cb16-40"></span>
<span id="cb16-41"></span>
<span id="cb16-42"></span>
<span id="cb16-43"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> midiplayer(notes_tensor, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, midi_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/tmp/tmp.mid"</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, styler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dark):</span>
<span id="cb16-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"MIDIplayer that writes input tensor to temporary file"</span></span>
<span id="cb16-45">    pm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes_to_midi(notes_tensor, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>time_rescale, out_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>midi_file)</span>
<span id="cb16-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> MIDIPlayer(midi_file, height, styler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dark, dl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title)</span></code></pre></div>
</details>
</div>
<p>We’re going to encode &amp; decode, and write to a MIDI file, and play that midi file. Using the same file as above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">midiplayer(decode(encode(midi_file_to_tensor(filenames[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))), title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Encode-Decode Test'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section113 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section113 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section113 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section113 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section113 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section113 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section113 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section113 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section113 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section113 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section113 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section113&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Encode-Decode Test<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhgDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIEwPACBdzBAADUAAENAAEUAAEhAgyYpQAAwAABBQABDAABFQABIAIQQKQAAK0BqKwAALUBpLQAALkBqLgAAMEAAQEAAQQAAQ0AARQBqMAAAMkAAPkAAQABpMgAANEAAPgBqMEAANAAAOkBpMAAANUAAOUAAOgAAQwAARUBqNQAAN0AAOQAAOkBqNwAAOUAAOgBpOQAAOkAAPkBqOgAAPgAAQEAAQ0AARQBpOkBqOUAAOgBqN0AAOQBpNUAANwAAQAAAQUAAQwAARUBqNEAANQBpMkAANAAAPkBqMEAAMgBqLkAAMAAAQ0AARQBpK0AALgBqKwAAMEAAPEAAPgAAQEAAQQBpOkAAPABqKUAAMAAAOUAAOgAAQAAAQUAAQwCDJiZAACkAADkAAD5AAEEAAEVAAE1AaiYAAClAADxAAD4AaikAACtAADpAADwAAENAAEUAAExAAE0AaSsAAC1Aai0AAC5AAEFAAEMAAEpAAEwAaTlAADoAai4AADBAADdAADkAAEBAAEEAAEhAAEoAgVMwAAAyQAA1QAA3AAA+QABAAABGQABIAGoyAAA0QAA1AAA3QGk0AAA1QAA3AAA5QAA8QAA+AABFQABGAGotQAA1AAA5AGotAAAuQAA6QAA8AAA+QABDQABFAGkrQAAuADU5QAA6ADUrAAAwQAA3QAA5AAA8QAA+AIFTKUAAMAAANwAAOUAAQUAAQwCDJikAADkAADwAAEEAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhgDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIEwPACBdzBAADUAAENAAEUAAEhAgyYpQAAwAABBQABDAABFQABIAIQQKQAAK0BqKwAALUBpLQAALkBqLgAAMEAAQEAAQQAAQ0AARQBqMAAAMkAAPkAAQABpMgAANEAAPgBqMEAANAAAOkBpMAAANUAAOUAAOgAAQwAARUBqNQAAN0AAOQAAOkBqNwAAOUAAOgBpOQAAOkAAPkBqOgAAPgAAQEAAQ0AARQBpOkBqOUAAOgBqN0AAOQBpNUAANwAAQAAAQUAAQwAARUBqNEAANQBpMkAANAAAPkBqMEAAMgBqLkAAMAAAQ0AARQBpK0AALgBqKwAAMEAAPEAAPgAAQEAAQQBpOkAAPABqKUAAMAAAOUAAOgAAQAAAQUAAQwCDJiZAACkAADkAAD5AAEEAAEVAAE1AaiYAAClAADxAAD4AaikAACtAADpAADwAAENAAEUAAExAAE0AaSsAAC1Aai0AAC5AAEFAAEMAAEpAAEwAaTlAADoAai4AADBAADdAADkAAEBAAEEAAEhAAEoAgVMwAAAyQAA1QAA3AAA+QABAAABGQABIAGoyAAA0QAA1AAA3QGk0AAA1QAA3AAA5QAA8QAA+AABFQABGAGotQAA1AAA5AGotAAAuQAA6QAA8AAA+QABDQABFAGkrQAAuADU5QAA6ADUrAAAwQAA3QAA5AAA8QAA+AIFTKUAAMAAANwAAOUAAQUAAQwCDJikAADkAADwAAEEAAf8vAA== sound-font visualizer=&quot;#section113 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAEhgDAAACQNUAAOUAAPEAAQUCBUzRAADUAADdAADkAAEEAAEhAakZAAEgAaTQAADVAADcAAEVAAEYAajRAADUAADdAAENAAEUAajJAADQAADcAADlAADwAAD5AAEFAAEMAaTkAADpAAD4AAEBAai1AADIAADoAADxAAEAAAEhAgVMtAAAuQABIAABKQGouAAAwQAA6QAA8ADQ5QAA6ADUwAAAyQAA5AAA6QGoyAAA0QGk0AAA1QAA5QAA6AABIQABKAIFUNEAANQAAOQAAPEAAQQAAQ0CBUzQAADVAAEMAAEVAAEgAAEpAgVM1AAA3QAA7QAA8AABDQABFAABKAABMQIFTNwAAOUAAOwAAPEAAQUAAQwAATAAATUBqOQAAOkAAPAAAPkAAQQAAQ0BpOgAAPEAAPgAAQEAATEAATQBqNEAAN0AAPAAAQABqNAAANUAANwAAOUAAQUAAQwAASkAATABpMkAANQAAOQAAPkBqMgAAN0AAO0AAPgCBUzBAADcAADsAADxAAEBAAEEAAEhAAEoAgVMwAAA1QABAAABBQABFQABIAIFTLkAANQAAOkAAPAAARQAASkBqOUAAOgBqLgAAMEAAN0AAOQAAQEAAQQAASEAASgCBUzAAADJAADcAAD5AAEAAAEFAAEZAAEgAaTIAADRAADxAAD4AAEEAAENAajQAADVAAEFAAEMAAEVAAEYAai5AADUAaS4AADBAAENAAEUAgVNAQABBAIFUKUAAMAAAQAAAQUAAQwCDJikAADRAAEEAAENAAEhAgyY0AAA1QABDAABFQABIAIEwPACBdzBAADUAAENAAEUAAEhAgyYpQAAwAABBQABDAABFQABIAIQQKQAAK0BqKwAALUBpLQAALkBqLgAAMEAAQEAAQQAAQ0AARQBqMAAAMkAAPkAAQABpMgAANEAAPgBqMEAANAAAOkBpMAAANUAAOUAAOgAAQwAARUBqNQAAN0AAOQAAOkBqNwAAOUAAOgBpOQAAOkAAPkBqOgAAPgAAQEAAQ0AARQBpOkBqOUAAOgBqN0AAOQBpNUAANwAAQAAAQUAAQwAARUBqNEAANQBpMkAANAAAPkBqMEAAMgBqLkAAMAAAQ0AARQBpK0AALgBqKwAAMEAAPEAAPgAAQEAAQQBpOkAAPABqKUAAMAAAOUAAOgAAQAAAQUAAQwCDJiZAACkAADkAAD5AAEEAAEVAAE1AaiYAAClAADxAAD4AaikAACtAADpAADwAAENAAEUAAExAAE0AaSsAAC1Aai0AAC5AAEFAAEMAAEpAAEwAaTlAADoAai4AADBAADdAADkAAEBAAEEAAEhAAEoAgVMwAAAyQAA1QAA3AAA+QABAAABGQABIAGoyAAA0QAA1AAA3QGk0AAA1QAA3AAA5QAA8QAA+AABFQABGAGotQAA1AAA5AGotAAAuQAA6QAA8AAA+QABDQABFAGkrQAAuADU5QAA6ADUrAAAwQAA3QAA5AAA8QAA+AIFTKUAAMAAANwAAOUAAQUAAQwCDJikAADkAADwAAEEAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
<p>Yay! Moving on…</p>
</section>
</details></section>
<section id="making-pytorch-datasets" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="making-pytorch-datasets"><span class="header-section-number">3.5</span> Making PyTorch Dataset(s)</h2>
<p>Our particular dataset already comes with a test/train/valid split in its subdirectories, so let’s use that split. We’ll go ahead and re-load the files:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tensor lists</span></span>
<span id="cb18-2">train_filenames <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> filenames <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/train'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x]</span>
<span id="cb18-3">val_filenames   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> filenames <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/val'</span>   <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x]</span>
<span id="cb18-4">test_filenames  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> filenames <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/test'</span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x]</span>
<span id="cb18-5"></span>
<span id="cb18-6">train_notes_tl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> files_to_tensor_list(train_filenames, serial<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb18-7">val_notes_tl   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> files_to_tensor_list(val_filenames, serial<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb18-8">test_notes_tl  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> files_to_tensor_list(test_filenames, serial<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb18-9"></span>
<span id="cb18-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> name, tl <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test'</span>],[train_notes_tl, val_notes_tl, test_notes_tl]):</span>
<span id="cb18-11">    stack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.vstack(tl)</span>
<span id="cb18-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> songs in </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>stack<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████████████████████████████████████████████████████████████████████████████████████| 229/229 [00:01&lt;00:00, 145.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████| 76/76 [00:00&lt;00:00, 152.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:00&lt;00:00, 142.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>229 songs in train, 46660 notes
76 songs in val, 15052 notes
77 songs in test, 16637 notes</code></pre>
</div>
</div>
<p>…that’s not a ton of data. We should include some data augmentation.</p>
<section id="data-augmentation" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="data-augmentation"><span class="header-section-number">3.5.1</span> Data Augmentation</h3>
<p>We’ll augment the pitch values by raising &amp; lowering them within an octave, except we’ll leave the rest pitch (=127 for the JSB chorales) alone since that sometimes gets used as a rest. And we’ll leave the timing values alone.</p>
<div class="cell">
<details>
<summary>Show the Data Augmentation code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> augment_data(data, pitch_shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, extra_augs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb21-2">    datanew <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()                                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># avoid overwriting memory of data</span></span>
<span id="cb21-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pitch</span></span>
<span id="cb21-4">    change <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randint(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>pitch_shift, pitch_shift, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,))    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how many semitones to change all the pitches</span></span>
<span id="cb21-5">    datanew[ datanew[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> REST_PITCH ] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> torch.tensor((change, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the pitches</span></span>
<span id="cb21-6">    </span>
<span id="cb21-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> extra_augs: </span>
<span id="cb21-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>:                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sometimes invert pitches? Probably not useful but anyway</span></span>
<span id="cb21-9">            datanew[ datanew[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> REST_PITCH ] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> torch.tensor((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb21-10">            datanew[ datanew[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> REST_PITCH ] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> torch.tensor((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">127</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb21-11">        </span>
<span id="cb21-12">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time - if we sometimes increase each non-zero time-token by one, that should be ok, right? </span></span>
<span id="cb21-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do step</span></span>
<span id="cb21-14">            datanew[ datanew[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> torch.tensor((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb21-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do duration</span></span>
<span id="cb21-16">            datanew[ datanew[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> torch.tensor((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb21-17">            </span>
<span id="cb21-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># extra 'safety' constraint: clamp to range of valid values (of tokens)</span></span>
<span id="cb21-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(codebooks):</span>
<span id="cb21-20">        datanew[:,i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.clamp(datanew[:,i], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cb)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb21-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> datanew</span>
<span id="cb21-22"></span>
<span id="cb21-23"></span>
<span id="cb21-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A couple quick tests: </span></span>
<span id="cb21-25">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setting this just  to make sure something happens ;-) </span></span>
<span id="cb21-26">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>],[REST_PITCH,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">86</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">126</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]])</span>
<span id="cb21-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.shape = "</span>,data.shape)</span>
<span id="cb21-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original data = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,data)</span>
<span id="cb21-29">aug <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> augment_data(data)</span>
<span id="cb21-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"augmented data = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,aug) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb21-31"></span>
<span id="cb21-32"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> torch.equal(aug[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oops, nothing changed"</span></span>
<span id="cb21-33"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> aug[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oops,  The REST_PITCH got changed"</span></span>
<span id="cb21-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checks passed! :-) "</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data.shape =  torch.Size([5, 3])
original data = 
 tensor([[ 54,  12,   6],
        [ 61,   0,  40],
        [127,  14,   4],
        [ 86,   0,  12],
        [126,   7,  12]])
augmented data = 
 tensor([[ 52,  12,   6],
        [ 59,   0,  27],
        [127,  14,   4],
        [ 84,   0,  12],
        [124,   7,  12]])
Checks passed! :-) </code></pre>
</div>
</div>
</section>
<section id="pytorch-dataset-object-definition" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="pytorch-dataset-object-definition"><span class="header-section-number">3.5.2</span> PyTorch Dataset Object Definition</h3>
<p>Now we’re ready to define our <code>Dataset</code> class/object. We’re going to yield <code>input, target</code> pairs of token sequences in which the targets have been shifted by one token so the model learns to predict what comes next. This method is called <a href="https://en.wikipedia.org/wiki/Teacher_forcing">“Teacher Forcing”</a> by the way. (I didn’t know it needed a name; seems like regular Supervised Learning to me!)</p>
<div class="cell">
<details>
<summary>Show the Pytorch Dataset code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> NotesDataset(Dataset):</span>
<span id="cb23-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"simple custom dataset of sliding windows"</span></span>
<span id="cb23-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, </span>
<span id="cb23-4">                 tensor_list, </span>
<span id="cb23-5">                 seq_length:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, </span>
<span id="cb23-6">                 tokenizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>encode,</span>
<span id="cb23-7">                 codebooks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebooks, </span>
<span id="cb23-8">                 aug_callback<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>augment_data,</span>
<span id="cb23-9">                 len_mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># factor to 'fudge' the dataset length when it's inspected by DataLoaders</span></span>
<span id="cb23-10">                 pad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pad end with rests</span></span>
<span id="cb23-11">                ):</span>
<span id="cb23-12">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb23-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> seq_length</span>
<span id="cb23-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.len_mult <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> len_mult</span>
<span id="cb23-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [tokenizer(t) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tensor_list] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encode everything at the start; encoded tokens are all we'll use</span></span>
<span id="cb23-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> pad:</span>
<span id="cb23-17">            rests <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([REST_PITCH,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).tile((seq_length,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb23-18">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [torch.cat((toks,rests), dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> toks <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list]</span>
<span id="cb23-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.aug_callback <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> aug_callback</span>
<span id="cb23-20"></span>
<span id="cb23-21">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__len__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb23-22">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""we're going to be grabbing random windows from the data, so just the len of the tensor </span></span>
<span id="cb23-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        list will be too small for large batch sizes, hence we multiply by len_mult"""</span></span>
<span id="cb23-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.len_mult  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this will keep the DataLoader going longer</span></span>
<span id="cb23-25"></span>
<span id="cb23-26">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__getitem__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, idx, shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> (torch.Tensor, torch.Tensor):</span>
<span id="cb23-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"grabs a random 'window' from a random song, with an offset of `shift` tokens between inputs and targets"</span></span>
<span id="cb23-28">        i_song <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list), (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pick a song</span></span>
<span id="cb23-29">        ix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  torch.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list[i_song]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start of window within song</span></span>
<span id="cb23-30">        data_block <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.data_list[i_song][ix:ix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># grab window plus an extra character</span></span>
<span id="cb23-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.aug_callback <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: </span>
<span id="cb23-32">            data_block <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.aug_callback(data_block)</span>
<span id="cb23-33">        inputs, targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data_block[:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sl], data_block[shift:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>shift]</span>
<span id="cb23-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> inputs, targets</span>
<span id="cb23-35">    </span>
<span id="cb23-36"></span>
<span id="cb23-37">seq_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb23-38">train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NotesDataset(train_notes_tl, seq_length)</span>
<span id="cb23-39">val_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NotesDataset(val_notes_tl, seq_length, aug_callback<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, len_mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000000</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># no aug, neverending</span></span>
<span id="cb23-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save test_ds for Evaluation section, later</span></span>
<span id="cb23-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Dataset lengths:  Train: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_ds)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes, Validation: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(val_ds)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes."</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset lengths:  Train: 22900 notes, Validation: 76000000 notes.</code></pre>
</div>
</div>
<p>Now we can use the <code>Dataset</code> instances to create <code>DataLoader</code> objects. Since the latter may involve random shuffling, let’s seed all the Random Number Generators for the sake of reproducibility.</p>
<div class="cell">
<details>
<summary>Show the RNG-setting &amp; DataLoader code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  set RNG seeds for reproducibility.</span></span>
<span id="cb25-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> set_seeds(seed):</span>
<span id="cb25-3">    torch.manual_seed(seed)</span>
<span id="cb25-4">    np.random.seed(seed)</span>
<span id="cb25-5">    random.seed(seed)</span>
<span id="cb25-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available():</span>
<span id="cb25-7">        torch.cuda.manual_seed(seed)</span>
<span id="cb25-8">        torch.cuda.manual_seed_all(seed) </span>
<span id="cb25-9">        </span>
<span id="cb25-10">set_seeds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb25-11"></span>
<span id="cb25-12">batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We may change this further down, for now it's just a test</span></span>
<span id="cb25-13">train_dl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(train_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb25-14">val_dl   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(val_ds,   batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, )</span>
<span id="cb25-15"></span>
<span id="cb25-16">batch_x, batch_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>(train_dl))</span>
<span id="cb25-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checking batch shapes:  batch_x.shape, batch_y.shape = "</span>,batch_x.shape, batch_y.shape)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Checking batch shapes:  batch_x.shape, batch_y.shape =  torch.Size([128, 64, 3]) torch.Size([128, 64, 3])</code></pre>
</div>
</div>
<p>Ok. Now that we have a feel for how to handle our data, let’s get set up for the Transformer!</p>
</section>
</section>
</section>
<section id="hyperparameters-model-configuration" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Hyperparameters / Model Configuration</h1>
<p>Here’s where we’ll put all of our architecture design variables, storing them in a dict-like “<code>dataclass</code>” object for easy passing around.</p>
<div class="cell">
<details>
<summary>Show the config-creation code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dataclasses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dataclass</span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb27-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MusicBoxConfig:</span>
<span id="cb27-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># model architecture details</span></span>
<span id="cb27-6">    seq_length: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb27-7">    batch_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span></span>
<span id="cb27-8">    n_embd:     <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># embedding dimension to use for tokens &amp; positions</span></span>
<span id="cb27-9">    n_heads:    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of attention heads</span></span>
<span id="cb27-10">    n_blocks:   <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of attention blocks</span></span>
<span id="cb27-11">    dropout:  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dropout value applied everywhere. since JSB is a small dataset, let's use more than usual</span></span>
<span id="cb27-12">    bias:      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># True: bias in Linears and LayerNorms, like GPT-2. False: a bit better and faster</span></span>
<span id="cb27-13">    use_alibi: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use ALiBi PE scheme</span></span>
<span id="cb27-14"></span>
<span id="cb27-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training details</span></span>
<span id="cb27-16">    learning_rate: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb27-17">    weight_decay:  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 0.01 is pytorch default</span></span>
<span id="cb27-18">    epochs:          <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb27-19"></span>
<span id="cb27-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># other handy bookkeeping</span></span>
<span id="cb27-21">    vocab_sizes: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(vocab_sizes)</span>
<span id="cb27-22"> </span>
<span id="cb27-23">        </span>
<span id="cb27-24">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MusicBoxConfig()</span>
<span id="cb27-25">pp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pprint.PrettyPrinter(indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb27-26">pp.pprint(config)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MusicBoxConfig(seq_length=64,
               batch_size=128,
               n_embd=128,
               n_heads=8,
               n_blocks=4,
               dropout=0.2,
               bias=False,
               use_alibi=False,
               learning_rate=0.001,
               weight_decay=0.01,
               epochs=20,
               vocab_sizes=(128, 15, 28))</code></pre>
</div>
</div>
</section>
<section id="transformer-model-code" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Transformer Model Code</h1>
<p>I did write my own Transformer code(s) – <a href="https://github.com/drscotthawley/TTTT/tree/main/notebooks">honest!</a> – but in the <a href="https://wandb.ai/drscotthawley/projects">quest</a> to get better results, I increasingly borrowed from Andrej Karpathy’s lesson code (feeling like the “Salieri” to his “Mozart”), to the point where the following is really a set of minor modifications, such as my added support for multiple codebooks, and passing around the config.</p>
<details>
<summary>
Details
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from my mod of Karpathy's code.</span></span>
<span id="cb29-2"></span>
<span id="cb29-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unless otherwise noted, anything good in what follows was pasted </span></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from https://github.com/karpathy/minGPT and adapted by Scott H. Hawley (SHH)</span></span>
<span id="cb29-5"></span>
<span id="cb29-6"></span>
<span id="cb29-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_alibi_mask(n):</span>
<span id="cb29-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"SHH: added this after the fact to demo ALiBi support"</span></span>
<span id="cb29-9">    mat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros((n, n))</span>
<span id="cb29-10">    </span>
<span id="cb29-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over the lower triangular indices (excluding the diagonal)</span></span>
<span id="cb29-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n):</span>
<span id="cb29-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(i):</span>
<span id="cb29-14">            mat[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> j)</span>
<span id="cb29-15">    </span>
<span id="cb29-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a mask for the upper triangular part, excluding the diagonal</span></span>
<span id="cb29-17">    mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.triu(torch.ones_like(mat), diagonal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb29-18">    </span>
<span id="cb29-19">    mat[mask.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>()] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-inf'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply mask, set upper triangular -inf</span></span>
<span id="cb29-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> mat</span>
<span id="cb29-21"></span>
<span id="cb29-22"></span>
<span id="cb29-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Head(nn.Module):</span>
<span id="cb29-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" one head of self-attention </span></span>
<span id="cb29-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        SHH: Note: Often Multi-head Attention is done all at once via one big matrix multiply, </span></span>
<span id="cb29-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                   but Karpathy (perhaps for reasons of clarity or to keep VRAM usage low)</span></span>
<span id="cb29-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                   implemented each Head separately and then looped over them.</span></span>
<span id="cb29-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb29-29">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, head_size, config):</span>
<span id="cb29-30">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb29-31">        n_embd, block_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> config.n_embd, config.seq_length</span>
<span id="cb29-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(n_embd, head_size, bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb29-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.query <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(n_embd, head_size, bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb29-34">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(n_embd, head_size, bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb29-35">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.use_alibi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> config.use_alibi</span>
<span id="cb29-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.use_alibi:</span>
<span id="cb29-37">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.register_buffer(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'alibi'</span>, create_alibi_mask(block_size))</span>
<span id="cb29-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb29-39">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.register_buffer(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tril'</span>, torch.tril(torch.ones(block_size, block_size)))</span>
<span id="cb29-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dropout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Dropout(config.dropout)</span>
<span id="cb29-41">        </span>
<span id="cb29-42">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb29-43">        B,T,C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.shape</span>
<span id="cb29-44">        k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key(x)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B,T,C)</span></span>
<span id="cb29-45">        q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.query(x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B,T,C)</span></span>
<span id="cb29-46">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute attention scores ("affinities")</span></span>
<span id="cb29-47">        wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> k.transpose(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, T, C) @ (B, C, T) -&gt; (B, T, T)</span></span>
<span id="cb29-48">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.use_alibi:</span>
<span id="cb29-49">            wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alibi[:T,:T]</span>
<span id="cb29-50">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb29-51">            wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wei.masked_fill(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tril[:T, :T] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-inf'</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, T, T)</span></span>
<span id="cb29-52">        wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.softmax(wei, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, T, T)</span></span>
<span id="cb29-53">        wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dropout(wei)</span>
<span id="cb29-54">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># perform the weighted aggregation of the values</span></span>
<span id="cb29-55">        v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value(x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B,T,C)</span></span>
<span id="cb29-56">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wei <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> v <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, T, T) @ (B, T, C) -&gt; (B, T, C)</span></span>
<span id="cb29-57">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="cb29-58"></span>
<span id="cb29-59"></span>
<span id="cb29-60"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MultiHeadAttention(nn.Module):</span>
<span id="cb29-61">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" multiple heads of self-attention in parallel </span></span>
<span id="cb29-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        SHH: As noted above, typically MHA is one big matmul (as in my original code), </span></span>
<span id="cb29-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">             but Karpathy looped over heads so we'll do that.</span></span>
<span id="cb29-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb29-65">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, num_heads, head_size, config):</span>
<span id="cb29-66">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb29-67">        n_embd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> config.n_embd</span>
<span id="cb29-68"></span>
<span id="cb29-69">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.heads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.ModuleList([Head(head_size, config) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_heads)])</span>
<span id="cb29-70">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.proj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Linear(n_embd, n_embd)</span>
<span id="cb29-71">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dropout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Dropout(config.dropout)</span>
<span id="cb29-72"></span>
<span id="cb29-73">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb29-74">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([h(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> h <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.heads], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb29-75">        out <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dropout(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.proj(out))</span>
<span id="cb29-76">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> out</span>
<span id="cb29-77"></span>
<span id="cb29-78">    </span>
<span id="cb29-79"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> FeedFoward(nn.Module):</span>
<span id="cb29-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" a simple linear layer followed by a non-linearity """</span></span>
<span id="cb29-81">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_embd, config):</span>
<span id="cb29-82">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb29-83">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.net <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Sequential(</span>
<span id="cb29-84">            nn.Linear(n_embd, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_embd),</span>
<span id="cb29-85">            nn.ReLU(),</span>
<span id="cb29-86">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_embd, n_embd),</span>
<span id="cb29-87">            nn.Dropout(config.dropout),</span>
<span id="cb29-88">        )</span>
<span id="cb29-89"></span>
<span id="cb29-90">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb29-91">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.net(x)</span>
<span id="cb29-92"></span>
<span id="cb29-93"></span>
<span id="cb29-94"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Block(nn.Module):</span>
<span id="cb29-95">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">""" Transformer block: communication followed by computation </span></span>
<span id="cb29-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        SHH: Note: The ordering of the LayerNorm ops has differed in different Transformer implementations</span></span>
<span id="cb29-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                   Some have pointed out that the original Transformer architecture diagram didn't match the code</span></span>
<span id="cb29-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb29-99"></span>
<span id="cb29-100">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_embd, n_head, config):</span>
<span id="cb29-101">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># n_embd: embedding dimension, n_head: the number of heads we'd like</span></span>
<span id="cb29-102">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb29-103">        head_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_embd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> n_head</span>
<span id="cb29-104">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MultiHeadAttention(n_head, head_size, config)</span>
<span id="cb29-105">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ffwd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FeedFoward(n_embd, config)</span>
<span id="cb29-106">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.LayerNorm(n_embd)</span>
<span id="cb29-107">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.LayerNorm(n_embd)</span>
<span id="cb29-108"></span>
<span id="cb29-109">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb29-110">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sa(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln1(x))</span>
<span id="cb29-111">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ffwd(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln2(x))</span>
<span id="cb29-112">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x</span>
<span id="cb29-113"></span>
<span id="cb29-114"></span>
<span id="cb29-115"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Transformer(nn.Module):</span>
<span id="cb29-116">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""  Main Transformer class, from Karpathy's "BigramLanguageModel" class. </span></span>
<span id="cb29-117"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">         SHH added the looping over multiple codebooks / vocabs</span></span>
<span id="cb29-118"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb29-119">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, config, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb29-120">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb29-121">        n_cb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(config.vocab_sizes)</span>
<span id="cb29-122">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.block_size, n_embd, n_head, n_layer, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.use_alibi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> config.seq_length, config.n_embd, config.n_heads, config.n_blocks, config.use_alibi</span>
<span id="cb29-123">        </span>
<span id="cb29-124">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seperate embeddings for pitch, step &amp; dur part of notes</span></span>
<span id="cb29-125">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.token_embedding_tables <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.ModuleList([nn.Embedding(vocab_sizes[cbi], n_embd) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cbi <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_cb)])</span>
<span id="cb29-126">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> config.use_alibi: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.position_embedding_table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Embedding(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.block_size, n_embd)</span>
<span id="cb29-127">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.blocks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Sequential(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>[Block(n_embd, n_head, config) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_layer)])</span>
<span id="cb29-128">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln_f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.LayerNorm(n_embd) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># final layer norm</span></span>
<span id="cb29-129">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.lm_heads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.ModuleList([nn.Linear(n_embd, vocab_sizes[cbi]) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cbi <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_cb)]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output token predictors</span></span>
<span id="cb29-130">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb29-131"></span>
<span id="cb29-132">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, idx, targets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb29-133">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># idx is array of input token indices in the current context</span></span>
<span id="cb29-134">        B, T, CBS <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> idx.shape</span>
<span id="cb29-135">        </span>
<span id="cb29-136">        tok_emb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb29-137">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(CBS): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just sum codebook reps</span></span>
<span id="cb29-138">            tok_emb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tok_emb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.token_embedding_tables[cb](idx[:,:,cb])</span>
<span id="cb29-139">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tok_emb</span>
<span id="cb29-140">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.use_alibi:</span>
<span id="cb29-141">            pos_emb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.position_embedding_table(torch.arange(T, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>idx.device)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (T,E)</span></span>
<span id="cb29-142">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pos_emb    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  sum token embeddings &amp; positional embeddings</span></span>
<span id="cb29-143">        </span>
<span id="cb29-144">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.blocks(x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Main computation loop! </span></span>
<span id="cb29-145">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ln_f(x)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># final layernorm</span></span>
<span id="cb29-146">        logits_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [head(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> head <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.lm_heads]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list of output projections over all codebook values</span></span>
<span id="cb29-147"></span>
<span id="cb29-148">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> targets <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># need targets to compute loss</span></span>
<span id="cb29-149">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb29-150">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb29-151">            lambdas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>CBS   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># relative "weights" to pitch, step, dur parts of loss. </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Should be in config as hyperparams</span></span>
<span id="cb29-152">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb29-153">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(CBS):        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loop over codebooks  (for pitch, step &amp; dur), summing loss</span></span>
<span id="cb29-154">                logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits_list[cb]  </span>
<span id="cb29-155">                B, T, V <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits.shape   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># V = vocab size, i.e. codebook length</span></span>
<span id="cb29-156">                targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> targets[:,:,cb]   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># B, T </span></span>
<span id="cb29-157">                logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits.view(B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>T, V)</span>
<span id="cb29-158">                targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> targ.reshape(B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>T)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># needs reshape &amp; not view b/c of contiguous memory issues.</span></span>
<span id="cb29-159">                loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  lambdas[cb] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F.cross_entropy(logits, targ)</span>
<span id="cb29-160">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> logits_list, loss</span>
<span id="cb29-161"></span>
<span id="cb29-162"></span>
<span id="cb29-163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@torch.no_grad</span>()</span>
<span id="cb29-164">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, idx, max_new_tokens, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>):</span>
<span id="cb29-165">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># idx is (B, T, CBS) array of token indices in the current context</span></span>
<span id="cb29-166">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(max_new_tokens):</span>
<span id="cb29-167">            idx_cond <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> idx[:, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.block_size:]      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># crop idx to the last block_size tokens</span></span>
<span id="cb29-168">            logits_list, loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>(idx_cond)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get the predictions</span></span>
<span id="cb29-169">            idx_next_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb29-170">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(idx_cond.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]):</span>
<span id="cb29-171">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># focus only on the last time step</span></span>
<span id="cb29-172">                logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits_list[cb]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># B, T, V  where V = vocab/embedding size </span></span>
<span id="cb29-173">                logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits[:, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get last time.  becomes (B, V)</span></span>
<span id="cb29-174">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># apply softmax to get probabilities</span></span>
<span id="cb29-175">                probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.softmax(logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>temperature, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, V)</span></span>
<span id="cb29-176">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample from the distribution</span></span>
<span id="cb29-177">                idx_next_list.append(torch.multinomial(probs, num_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, 1)</span></span>
<span id="cb29-178">                </span>
<span id="cb29-179">            idx_next <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor(idx_next_list).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(idx.device)</span>
<span id="cb29-180">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># append sampled index to the running sequence</span></span>
<span id="cb29-181">            idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat((idx, idx_next), dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (B, T+1)</span></span>
<span id="cb29-182">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> idx</span>
<span id="cb29-183"></span>
<span id="cb29-184">    </span>
<span id="cb29-185"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># test that, make sure we don't get any errors: </span></span>
<span id="cb29-186">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Transformer(config)</span>
<span id="cb29-187"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(p.numel() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> model.parameters())<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'M parameters in the model'</span>) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.843947 M parameters in the model</code></pre>
</div>
</div>
</details></section>
<section id="preliminaries-before-training" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Preliminaries Before Training</h1>
GPU device, Demo prompts, Clean re-init
<details>
<summary>
Details
</summary>
<section id="set-up-the-gpucpu-device" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="set-up-the-gpucpu-device"><span class="header-section-number">6.1</span> Set Up the GPU/CPU <code>device</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu"</span></span>
<span id="cb31-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"device is"</span>,device)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>device is mps</code></pre>
</div>
</div>
</section>
<section id="prompt-for-demos" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="prompt-for-demos"><span class="header-section-number">6.2</span> Prompt for Demos</h2>
<p>Let’s create a “prompt” from the validation dataset so we can monitor the models capabilities in producing “demos” of the music</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">demo_prompt_idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># file index from which to pull the demo prompt</span></span>
<span id="cb33-2">demo_target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> val_notes_tl[demo_prompt_idx]</span>
<span id="cb33-3">display(midiplayer(demo_target, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Full demo 'target', </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(demo_target)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes in length"</span>))</span>
<span id="cb33-4"></span>
<span id="cb33-5">demo_prompt_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of notes in demo prompt context</span></span>
<span id="cb33-6">demo_max_new_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(demo_target))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># try to make the whole song, but don't go on too long</span></span>
<span id="cb33-7">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> demo_target[:demo_prompt_length]</span>
<span id="cb33-8">display(midiplayer(prompt, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>demo_prompt_length<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-note 'prompt' for demos"</span>))</span>
<span id="cb33-9">prompt_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(prompt).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(device)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Full demo 'target', 149 notes in length<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAADlwDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC9Aai8AADBAajAAADJAAEAAAEFAaTIAADRAAEEAAENAAEUAgVM0AAA5QABAQABDAABIQIFUNEAAN0AAOQAAPAAAQACBUzQAAENAAEdAAEgAAEpAgVMwQAA3AABAQABHAABKAABMQIMmPEAAQACCPTAAADJAajIAADRAaTQAADVAajUAADdAADtAADwAajcAADlAADsAaThAADkAADtAAEFAAEMAAEpAAEwAajZAADgAaTYAADhAAEBAAEEAajRAADgAajQAADlAADsAADxAAEhAAEoAaTdAADkAajVAADcAAEAAAEVAAEgAAE1AgVM0QAA1AABDQABFAGoyQAA0AAA7QAA8AABBQABDAGkwQAAyAAA7AABBAABDQABIQABMQABNAIFTMAAAN0AAR0AASAAASkAATACDJzcAADlAADxAAEBAAEMAAEcAAEhAAEoAaUAAAEJAajdAADkAADtAADwAAEIAAENAAEgAAEpAajVAADcAaTRAADUAajJAADQAaTBAADIAADsAADxAAEoAAExAajAAADJAajIAADRAADtAADwAAEMAAERAAEpAAEwAaTJAADQAajBAADIAaS9AADAAai1AAC8AADsAADxAAEQAAEVAAEhAAEoAgVMtAAA1QABIAIFTMkAANQAAO0AAPAAAQ0AARQAAR0BqOwAAPEAAQUAAQwBqMgAAN0AAPAAAPkAAQQAAQ0CBUzBAADcAAD4AAEBAAEcAAEhAgyYvQAAwAAA+QABAAABIAABPQIFTLwAAMEAAPEAAPgAATEAATwBqL0AAMABqLwAAMEAAN0AAPABpMAAAMkAAQUAAQwAASkAATABqMgAANEAANwAAPEAAQQAAQ0AASEAASgBpMEAANABqMAAANUAAQwAARUAASAAASkBqNEAANQBpNAAANUAAO0AAPAAAQ0AARQBqNQAAN0AASgAATEBpNwAAOUAAOwAAQwAASEAATAAATUBqO0BqN0AAOQAAOwAAPEAATEAATQCBUzVAADcAADwAAENAAEdAAEgAAEpAAEwAaUVAAEcAakUAakFAaTBAADUAAEBAAEEAAEhAAEoAhHowAABAAABDAABIAAH/LwA=&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAADlwDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC9Aai8AADBAajAAADJAAEAAAEFAaTIAADRAAEEAAENAAEUAgVM0AAA5QABAQABDAABIQIFUNEAAN0AAOQAAPAAAQACBUzQAAENAAEdAAEgAAEpAgVMwQAA3AABAQABHAABKAABMQIMmPEAAQACCPTAAADJAajIAADRAaTQAADVAajUAADdAADtAADwAajcAADlAADsAaThAADkAADtAAEFAAEMAAEpAAEwAajZAADgAaTYAADhAAEBAAEEAajRAADgAajQAADlAADsAADxAAEhAAEoAaTdAADkAajVAADcAAEAAAEVAAEgAAE1AgVM0QAA1AABDQABFAGoyQAA0AAA7QAA8AABBQABDAGkwQAAyAAA7AABBAABDQABIQABMQABNAIFTMAAAN0AAR0AASAAASkAATACDJzcAADlAADxAAEBAAEMAAEcAAEhAAEoAaUAAAEJAajdAADkAADtAADwAAEIAAENAAEgAAEpAajVAADcAaTRAADUAajJAADQAaTBAADIAADsAADxAAEoAAExAajAAADJAajIAADRAADtAADwAAEMAAERAAEpAAEwAaTJAADQAajBAADIAaS9AADAAai1AAC8AADsAADxAAEQAAEVAAEhAAEoAgVMtAAA1QABIAIFTMkAANQAAO0AAPAAAQ0AARQAAR0BqOwAAPEAAQUAAQwBqMgAAN0AAPAAAPkAAQQAAQ0CBUzBAADcAAD4AAEBAAEcAAEhAgyYvQAAwAAA+QABAAABIAABPQIFTLwAAMEAAPEAAPgAATEAATwBqL0AAMABqLwAAMEAAN0AAPABpMAAAMkAAQUAAQwAASkAATABqMgAANEAANwAAPEAAQQAAQ0AASEAASgBpMEAANABqMAAANUAAQwAARUAASAAASkBqNEAANQBpNAAANUAAO0AAPAAAQ0AARQBqNQAAN0AASgAATEBpNwAAOUAAOwAAQwAASEAATAAATUBqO0BqN0AAOQAAOwAAPEAATEAATQCBUzVAADcAADwAAENAAEdAAEgAAEpAAEwAaUVAAEcAakUAakFAaTBAADUAAEBAAEEAAEhAAEoAhHowAABAAABDAABIAAH/LwA= sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAADlwDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC9Aai8AADBAajAAADJAAEAAAEFAaTIAADRAAEEAAENAAEUAgVM0AAA5QABAQABDAABIQIFUNEAAN0AAOQAAPAAAQACBUzQAAENAAEdAAEgAAEpAgVMwQAA3AABAQABHAABKAABMQIMmPEAAQACCPTAAADJAajIAADRAaTQAADVAajUAADdAADtAADwAajcAADlAADsAaThAADkAADtAAEFAAEMAAEpAAEwAajZAADgAaTYAADhAAEBAAEEAajRAADgAajQAADlAADsAADxAAEhAAEoAaTdAADkAajVAADcAAEAAAEVAAEgAAE1AgVM0QAA1AABDQABFAGoyQAA0AAA7QAA8AABBQABDAGkwQAAyAAA7AABBAABDQABIQABMQABNAIFTMAAAN0AAR0AASAAASkAATACDJzcAADlAADxAAEBAAEMAAEcAAEhAAEoAaUAAAEJAajdAADkAADtAADwAAEIAAENAAEgAAEpAajVAADcAaTRAADUAajJAADQAaTBAADIAADsAADxAAEoAAExAajAAADJAajIAADRAADtAADwAAEMAAERAAEpAAEwAaTJAADQAajBAADIAaS9AADAAai1AAC8AADsAADxAAEQAAEVAAEhAAEoAgVMtAAA1QABIAIFTMkAANQAAO0AAPAAAQ0AARQAAR0BqOwAAPEAAQUAAQwBqMgAAN0AAPAAAPkAAQQAAQ0CBUzBAADcAAD4AAEBAAEcAAEhAgyYvQAAwAAA+QABAAABIAABPQIFTLwAAMEAAPEAAPgAATEAATwBqL0AAMABqLwAAMEAAN0AAPABpMAAAMkAAQUAAQwAASkAATABqMgAANEAANwAAPEAAQQAAQ0AASEAASgBpMEAANABqMAAANUAAQwAARUAASAAASkBqNEAANQBpNAAANUAAO0AAPAAAQ0AARQBqNQAAN0AASgAATEBpNwAAOUAAOwAAQwAASEAATAAATUBqO0BqN0AAOQAAOwAAPEAATEAATQCBUzVAADcAADwAAENAAEdAAEgAAEpAAEwAaUVAAEcAakUAakFAaTBAADUAAEBAAEEAAEhAAEoAhHowAABAAABDAABIAAH/LwA= type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section394 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section394 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section394 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section394 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section394 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section394 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section394 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section394 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section394 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section394 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section394 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section394&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>16-note 'prompt' for demos<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAawDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AgVRAAGlFAIMnPAAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAawDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AgVRAAGlFAIMnPAAB/y8A sound-font visualizer=&quot;#section394 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAawDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AgVRAAGlFAIMnPAAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
</section>
<section id="re-init-things" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="re-init-things"><span class="header-section-number">6.3</span> (Re-)Init Things</h2>
<p>Just to keep things ‘clean’, re-setup the datasets &amp; loaders for good measure, instantiate a model and optimizer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">set_seeds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb34-2"></span>
<span id="cb34-3">train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NotesDataset(train_notes_tl, config.seq_length, len_mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.batch_size)</span>
<span id="cb34-4">val_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NotesDataset(val_notes_tl, seq_length, aug_callback<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, len_mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000000</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># no aug, neverending</span></span>
<span id="cb34-5"></span>
<span id="cb34-6">train_dl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(train_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb34-7">val_dl   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(val_ds,   batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb34-8"></span>
<span id="cb34-9">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Transformer(config)</span>
<span id="cb34-10">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.to(device)</span>
<span id="cb34-11">total_params_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(p.numel() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> model.parameters())<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e6</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> M'</span></span>
<span id="cb34-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(total_params_str,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parameters in the model'</span>)  </span>
<span id="cb34-13"></span>
<span id="cb34-14">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.AdamW(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.learning_rate, weight_decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.weight_decay)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.843947 M parameters in the model</code></pre>
</div>
</div>
</section>
</details></section>
<section id="train-the-model" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Train the Model</h1>
<section id="optional-setup-wandb-run-tracking" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="optional-setup-wandb-run-tracking"><span class="header-section-number">7.1</span> Optional: Setup WandB Run Tracking</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">use_wandb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tip: leave this off at first, until you're sure everything's working!</span></span>
<span id="cb36-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> use_wandb:</span>
<span id="cb36-3">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> wandb </span>
<span id="cb36-4">    </span>
<span id="cb36-5">    wandb.login()</span>
<span id="cb36-6">    wandb.init(project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"musicbox-jsb-tutorial"</span>, config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>wandb: Currently logged in as: drscotthawley. Use `wandb login --relogin` to force relogin</code></pre>
</div>
<div class="cell-output cell-output-display">
Tracking run with wandb version 0.16.1
</div>
<div class="cell-output cell-output-display">
Run data is saved locally in <code>/Users/shawley/github/blog/posts/wandb/run-20231218_102422-xo3mc3qf</code>
</div>
<div class="cell-output cell-output-display">
Syncing run <strong><a href="https://wandb.ai/drscotthawley/musicbox-jsb-tutorial/runs/xo3mc3qf" target="_blank">light-dew-42</a></strong> to <a href="https://wandb.ai/drscotthawley/musicbox-jsb-tutorial" target="_blank">Weights &amp; Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br>
</div>
<div class="cell-output cell-output-display">
 View project at <a href="https://wandb.ai/drscotthawley/musicbox-jsb-tutorial" target="_blank">https://wandb.ai/drscotthawley/musicbox-jsb-tutorial</a>
</div>
<div class="cell-output cell-output-display">
 View run at <a href="https://wandb.ai/drscotthawley/musicbox-jsb-tutorial/runs/xo3mc3qf" target="_blank">https://wandb.ai/drscotthawley/musicbox-jsb-tutorial/runs/xo3mc3qf</a>
</div>
</div>
</section>
<section id="training-loop-go" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="training-loop-go"><span class="header-section-number">7.2</span> Training Loop: Go!</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">val_every  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in steps, evaluate loss on val dataset</span></span>
<span id="cb38-2">cp_every   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in epochs, checkpoint every</span></span>
<span id="cb38-3">demo_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in epochs, make a midi player demo</span></span>
<span id="cb38-4"></span>
<span id="cb38-5">best_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999</span></span>
<span id="cb38-6"></span>
<span id="cb38-7">ema_weight, loss_ema, val_loss_ema <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> , <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># exponential moving averages for loss reporting</span></span>
<span id="cb38-8">step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> </span>
<span id="cb38-9">losses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb38-10">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> config.epochs</span>
<span id="cb38-11">model.train()</span>
<span id="cb38-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb38-13">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_dl), desc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>config<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, dynamic_ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># progress bar, per epoch</span></span>
<span id="cb38-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> bi, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(train_dl):</span>
<span id="cb38-15">        step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb38-16">        xb, yb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].to(device), batch[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].to(device)</span>
<span id="cb38-17"></span>
<span id="cb38-18">        logits, loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(xb, yb) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># evaluate the loss</span></span>
<span id="cb38-19">        loss_ema <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ema_weight)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>loss.item() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ema_weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>loss_ema <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> loss_ema <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> loss.item()</span>
<span id="cb38-20">        losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train'</span>], losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_ema'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss.item(), loss_ema</span>
<span id="cb38-21">        optimizer.zero_grad(set_to_none<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb38-22">        loss.backward()</span>
<span id="cb38-23">        optimizer.step()</span>
<span id="cb38-24"></span>
<span id="cb38-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># status / diagnostics:</span></span>
<span id="cb38-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> val_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note: computing val loss after backprop step will yield "artificially" low values vs train set...at first. I'm ok with that</span></span>
<span id="cb38-27">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb38-28">                model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb38-29">                xvb, yvb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>(val_dl))</span>
<span id="cb38-30">                val_logits, val_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model( xvb.to(device), yvb.to(device) ) </span>
<span id="cb38-31">                val_loss_ema <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ema_weight)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>val_loss.item() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ema_weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>val_loss_ema <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> val_loss_ema <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> val_loss.item() </span>
<span id="cb38-32">                losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>], losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val_ema'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> val_loss.item(), val_loss_ema</span>
<span id="cb38-33">            model.train()</span>
<span id="cb38-34">            </span>
<span id="cb38-35">        wbl_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>:step, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>:epoch} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> losses   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dict for logging losses, midi examples, etc to wandb</span></span>
<span id="cb38-36">        pbar.set_postfix( <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>((k,losses[k]) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val_ema'</span>])) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loss info for progress bar</span></span>
<span id="cb38-37">        pbar.update(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb38-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> use_wandb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> wbl_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> {}: wandb.log(wbl_dict)</span>
<span id="cb38-39">            </span>
<span id="cb38-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#--- end of epoch ---</span></span>
<span id="cb38-41"></span>
<span id="cb38-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val_ema'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> best_loss: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tracking best val_loss_ema for checkpointing purposes</span></span>
<span id="cb38-43">        best_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> losses[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val_ema'</span>]</span>
<span id="cb38-44">        pbar.set_postfix(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>( (k,losses[k]) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEST val_ema'</span>:best_loss})</span>
<span id="cb38-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> cp_every<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> (epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>epochs):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># occasionally save a checkpoint of best model/optimizer states</span></span>
<span id="cb38-46">            cp_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"musicbox-jsb"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    -{step}" # let's leave out step to avoid filling disk</span></span>
<span id="cb38-47">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving a checkpoint to </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cp_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb38-48">            torch.save({ <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>: step, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'model_state_dict'</span>: model.state_dict(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span>: loss,</span>
<span id="cb38-49">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'optimizer_state_dict'</span>: optimizer.state_dict(),}, cp_file)</span>
<span id="cb38-50">    pbar.refresh()</span>
<span id="cb38-51">    pbar.close()</span>
<span id="cb38-52">    </span>
<span id="cb38-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> demo_every <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> (epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>epochs):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># demo of midi generation</span></span>
<span id="cb38-54">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb38-55">            model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb38-56">            new_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decode( model.generate(prompt_tokens, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>demo_max_new_tokens, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].cpu() )</span>
<span id="cb38-57">            p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> midiplayer(new_notes,title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Demo on val dataset, Epoch=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb38-58">            display(p2)</span>
<span id="cb38-59">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> use_wandb: wandb.log( {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>:step, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'player'</span>:wandb.Html(p2.html)} )              </span>
<span id="cb38-60">        model.train()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Epoch 1/20: 100%|████████| 229/229 [00:48&lt;00:00,  4.73it/s, train=2.05, val=1.99, BEST val_ema=2.05]
Epoch 2/20: 100%|████████| 229/229 [00:47&lt;00:00,  4.85it/s, train=1.81, val=1.76, BEST val_ema=1.76]
Epoch 3/20: 100%|████████| 229/229 [00:46&lt;00:00,  4.90it/s, train=1.53, val=1.58, BEST val_ema=1.54]
Epoch 4/20: 100%|████████| 229/229 [00:46&lt;00:00,  4.92it/s, train=1.57, val=1.49, BEST val_ema=1.44]
Epoch 5/20: 100%|████████| 229/229 [00:46&lt;00:00,  4.88it/s, train=1.48, val=1.37, BEST val_ema=1.38]
Epoch 6/20: 100%|████████| 229/229 [00:47&lt;00:00,  4.87it/s, train=1.42, val=1.26, BEST val_ema=1.34]
Epoch 7/20: 100%|████████| 229/229 [00:46&lt;00:00,  4.90it/s, train=1.38, val=1.28, BEST val_ema=1.31]
Epoch 8/20: 100%|████████| 229/229 [00:45&lt;00:00,  5.03it/s, train=1.35, val=1.18, BEST val_ema=1.27]
Epoch 9/20: 100%|████████| 229/229 [00:47&lt;00:00,  4.86it/s, train=1.28, val=1.28, BEST val_ema=1.26]
Epoch 10/20: 100%|███████| 229/229 [00:46&lt;00:00,  4.96it/s, train=1.35, val=1.23, BEST val_ema=1.24]
Epoch 11/20: 100%|███████| 229/229 [00:46&lt;00:00,  4.92it/s, train=1.22, val=1.27, BEST val_ema=1.23]
Epoch 12/20: 100%|███████| 229/229 [00:46&lt;00:00,  4.97it/s, train=1.26, val=1.18, BEST val_ema=1.21]
Epoch 13/20: 100%|███████| 229/229 [00:46&lt;00:00,  4.91it/s, train=1.22, val=1.22, BEST val_ema=1.21]
Epoch 14/20: 100%|█████████| 229/229 [00:47&lt;00:00,  4.87it/s, train=1.27, val=1.2, BEST val_ema=1.2]
Epoch 15/20: 100%|███████| 229/229 [00:48&lt;00:00,  4.74it/s, train=1.17, val=1.24, BEST val_ema=1.18]
Epoch 16/20: 100%|████████████| 229/229 [00:47&lt;00:00,  4.84it/s, train=1.14, val=1.22, val_ema=1.19]
Epoch 17/20: 100%|███████| 229/229 [00:48&lt;00:00,  4.68it/s, train=1.15, val=1.22, BEST val_ema=1.18]
Epoch 18/20: 100%|█████████████| 229/229 [00:47&lt;00:00,  4.85it/s, train=1.14, val=1.2, val_ema=1.19]
Epoch 19/20: 100%|████████████| 229/229 [00:47&lt;00:00,  4.79it/s, train=1.16, val=1.19, val_ema=1.18]
Epoch 20/20: 100%|████████████| 229/229 [00:48&lt;00:00,  4.76it/s, train=1.13, val=1.15, val_ema=1.19]</code></pre>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Demo on val dataset, Epoch=4<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AgVQrAAAyQABAAABBQGktQABBAABDQABFAGotAAAyAAA0QAA8QABDAIFTQ0BqPABpNAAARkBqMEAAPAAAQEAAQUAAQUAARUAARgBpQQAAQwAARUBqLkAAMAAAMkAAQAAAQQAAQ0AARQAARQCBUy1AAC4AADBAADIAAEBAAEMAai0AADAAADJAAD5AAEVAaStAADIAADdAADtAAEFAAEUAaj4AAEAAaihAACsAADRAADcAADxAAEEAgVMoAAA0AAA7AAA8AABAQABDQIFTLkAAMEAANUAAPEAAPkAAQAAAQwBqKUAALgAAOUAAQUBpNQAAN0AAPAAAPgAAQEAAQQBqJEAAKQAAMAAAOQAAPEAAQAAAQUBpJAAAKUAANwAAOUAAPAAAPEAAQQBqOQAAOkAAPAAAPkAAQEBqKQAAK0AAOkAAPgAAQAAAQEBpOgAAQAAAQUBqKUAAKwAAM0AANUAAOUAAOgAAQQBpNQAAOQAAPEBqK0AAMkBqMgAAO0BpJEAAKQAAKwAAMwBqJAAAMEBpKUAALUAANUA1OUA1KkAAMkAANQAANUAAOwA1OQA1KgAAOkBpKEAANQAAOgAAO0AAPABqKAAAKEAAKQAALQBpKAAAMgAAN0AAOwBqJkAALUAANUAANwAAOUCBUyYAADAAADBAgVMfQAAuQAAwAAA5AIFUHwAAK0AALQAALgAANQAAO0BpKUAAKwBqKQAALUAAOwBpLQAANkAAOUCBVDJAADYAADZAADkAADxAgVMpQAAyAAAyQAA1QAA2AAA6QAA8AGk0QAA1AAA5QAA6AGomQAAyAAA0AAA1QAA3QAA5AAA6QGomAAApQAA5QAA6AGkpAAA1AAA5AAA8QGopAAArQAAvQAA6QAA8AGkkQAArAAAvAAAwQAA0QAA3QAA6AGokAAAmQAA3AGokQAAmAGkfQAAkAAArQGorAAAvQAAwAAA0AAA3AGkvAAA4QGomQAAyQAA4AGofAAAmAAAyAAA2QGkiQAApQGoeQAAiAAApAAAyQGkeAAAyAAA+QGorQAAuQAA2AAA3QGopQAArAAAtQAAuAAA1QAA5QAA+AGknQAA3AGotAGknAAAuQGopAAA1AAA5AGouAAAuQAAzQAA6QAA8QIFTLgAAMwAANUAAOEAAOgBpK0AALkAANQAAN0AAOAAAOkBqKwAALgAAM0AAOgAAPEBqMwAAPACBUzcAaTwAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AgVQrAAAyQABAAABBQGktQABBAABDQABFAGotAAAyAAA0QAA8QABDAIFTQ0BqPABpNAAARkBqMEAAPAAAQEAAQUAAQUAARUAARgBpQQAAQwAARUBqLkAAMAAAMkAAQAAAQQAAQ0AARQAARQCBUy1AAC4AADBAADIAAEBAAEMAai0AADAAADJAAD5AAEVAaStAADIAADdAADtAAEFAAEUAaj4AAEAAaihAACsAADRAADcAADxAAEEAgVMoAAA0AAA7AAA8AABAQABDQIFTLkAAMEAANUAAPEAAPkAAQAAAQwBqKUAALgAAOUAAQUBpNQAAN0AAPAAAPgAAQEAAQQBqJEAAKQAAMAAAOQAAPEAAQAAAQUBpJAAAKUAANwAAOUAAPAAAPEAAQQBqOQAAOkAAPAAAPkAAQEBqKQAAK0AAOkAAPgAAQAAAQEBpOgAAQAAAQUBqKUAAKwAAM0AANUAAOUAAOgAAQQBpNQAAOQAAPEBqK0AAMkBqMgAAO0BpJEAAKQAAKwAAMwBqJAAAMEBpKUAALUAANUA1OUA1KkAAMkAANQAANUAAOwA1OQA1KgAAOkBpKEAANQAAOgAAO0AAPABqKAAAKEAAKQAALQBpKAAAMgAAN0AAOwBqJkAALUAANUAANwAAOUCBUyYAADAAADBAgVMfQAAuQAAwAAA5AIFUHwAAK0AALQAALgAANQAAO0BpKUAAKwBqKQAALUAAOwBpLQAANkAAOUCBVDJAADYAADZAADkAADxAgVMpQAAyAAAyQAA1QAA2AAA6QAA8AGk0QAA1AAA5QAA6AGomQAAyAAA0AAA1QAA3QAA5AAA6QGomAAApQAA5QAA6AGkpAAA1AAA5AAA8QGopAAArQAAvQAA6QAA8AGkkQAArAAAvAAAwQAA0QAA3QAA6AGokAAAmQAA3AGokQAAmAGkfQAAkAAArQGorAAAvQAAwAAA0AAA3AGkvAAA4QGomQAAyQAA4AGofAAAmAAAyAAA2QGkiQAApQGoeQAAiAAApAAAyQGkeAAAyAAA+QGorQAAuQAA2AAA3QGopQAArAAAtQAAuAAA1QAA5QAA+AGknQAA3AGotAGknAAAuQGopAAA1AAA5AGouAAAuQAAzQAA6QAA8QIFTLgAAMwAANUAAOEAAOgBpK0AALkAANQAAN0AAOAAAOkBqKwAALgAAM0AAOgAAPEBqMwAAPACBUzcAaTwAAf8vAA== sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AgVQrAAAyQABAAABBQGktQABBAABDQABFAGotAAAyAAA0QAA8QABDAIFTQ0BqPABpNAAARkBqMEAAPAAAQEAAQUAAQUAARUAARgBpQQAAQwAARUBqLkAAMAAAMkAAQAAAQQAAQ0AARQAARQCBUy1AAC4AADBAADIAAEBAAEMAai0AADAAADJAAD5AAEVAaStAADIAADdAADtAAEFAAEUAaj4AAEAAaihAACsAADRAADcAADxAAEEAgVMoAAA0AAA7AAA8AABAQABDQIFTLkAAMEAANUAAPEAAPkAAQAAAQwBqKUAALgAAOUAAQUBpNQAAN0AAPAAAPgAAQEAAQQBqJEAAKQAAMAAAOQAAPEAAQAAAQUBpJAAAKUAANwAAOUAAPAAAPEAAQQBqOQAAOkAAPAAAPkAAQEBqKQAAK0AAOkAAPgAAQAAAQEBpOgAAQAAAQUBqKUAAKwAAM0AANUAAOUAAOgAAQQBpNQAAOQAAPEBqK0AAMkBqMgAAO0BpJEAAKQAAKwAAMwBqJAAAMEBpKUAALUAANUA1OUA1KkAAMkAANQAANUAAOwA1OQA1KgAAOkBpKEAANQAAOgAAO0AAPABqKAAAKEAAKQAALQBpKAAAMgAAN0AAOwBqJkAALUAANUAANwAAOUCBUyYAADAAADBAgVMfQAAuQAAwAAA5AIFUHwAAK0AALQAALgAANQAAO0BpKUAAKwBqKQAALUAAOwBpLQAANkAAOUCBVDJAADYAADZAADkAADxAgVMpQAAyAAAyQAA1QAA2AAA6QAA8AGk0QAA1AAA5QAA6AGomQAAyAAA0AAA1QAA3QAA5AAA6QGomAAApQAA5QAA6AGkpAAA1AAA5AAA8QGopAAArQAAvQAA6QAA8AGkkQAArAAAvAAAwQAA0QAA3QAA6AGokAAAmQAA3AGokQAAmAGkfQAAkAAArQGorAAAvQAAwAAA0AAA3AGkvAAA4QGomQAAyQAA4AGofAAAmAAAyAAA2QGkiQAApQGoeQAAiAAApAAAyQGkeAAAyAAA+QGorQAAuQAA2AAA3QGopQAArAAAtQAAuAAA1QAA5QAA+AGknQAA3AGotAGknAAAuQGopAAA1AAA5AGouAAAuQAAzQAA6QAA8QIFTLgAAMwAANUAAOEAAOgBpK0AALkAANQAAN0AAOAAAOkBqKwAALgAAM0AAOgAAPEBqMwAAPACBUzcAaTwAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section394 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section394 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section394 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section394 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section394 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section394 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section394 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section394 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section394 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section394 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section394 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section394&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Demo on val dataset, Epoch=8<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD9ADAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAaSlAACsAAEUAgVM5QABAQIFUKQAAPAAAPkBpK0AAMEAAO0AAPgAAQEAAQUBqKEAAOQAAOwAAQAAAQQBpKAAAKwAAL0AAMAAAMEAAMkBqJEAALwAAMAAAMgAANEAAQEBqQAAAQAAAQUBpJAAAKEAAL0AANAAAO0AAQQAAQ0CBUygAADRAADsAAEMAAERAgVQtQAA0AAA1QAA8QABEAABFQIFTK0AALQAANQAAN0AAO0AAPAAAPkAARQCBUysAAC9AADJAADcAADsAADtAAD4AAENAgVMkQAAvAAAyAAA0QAA7AGovAGkkAAApQAA0AAA1QAA5QAA8QABDAGo+QGopAAArQAA1AAA3QAA5AAA7QAA8AIFTKUAAKwAALUAANwAAOUAAOwBpKQAAOQAAQEBqKEAAN0AAPEAAQABqJkAAKAAANUAAPAAAPgAAPkBpJgAAKEAALQAANEAANQAANwAAPEAAPgBqO0AAPABpKAAANAAAOwAAPkBqLUAANEAAN0AAPgAAQEBqQAAAR0BpK0AALQAAMkAANAAANkAANwAARUAARwBqMgAAPkBpKwAAMUAANgAAPgAARQBqMQAANEAAOUAAPEAAQ0BqLUAANABpLQAAMkAAPAAAPkBqPgAAQUBpK0AAMgAAO0AAQQAAQwBqKwAAMEAAOQAAOwAAQEBqMAAAPEBpL0AAMkAAN0AAPABqNwAAQAAAQUBpLwAAMEAAMgAAOUBqLUAAMAAANEAAOQAAPEAAQQCBUzQAADwAgj0tAII9OUAAQECBUytAADJAADkAADpAAEAAAEdANToANTdAAD5ANDcAADhAADtAAD4ANSsAADIAADgAADxAAEcANTBAADRAajAAADJAaTIAADRAAERAai1AADQAaS0AAC9AADQAADsAADwAAEJAAEQAajxAai1AAC8AADFAADlAAEIAaTEAADwAAEVANTVAAD5AAENANS0AADkAAEUAgR4tQAA0QAA1AAA8QAA+AGotAAAvQAAwQAAyQAA0AGktQAAvAAAwAAAyAAA0QAA3QAA8AAA9QABDAGo3AAA5QGomQAAtAAAyQAA0AAA2QAA5AAA9AAA+QDR/QDV/QDV/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/AAB/QDUmAAAyAAA2AAA+AAB/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/ADV/AAH/LwA=&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD9ADAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAaSlAACsAAEUAgVM5QABAQIFUKQAAPAAAPkBpK0AAMEAAO0AAPgAAQEAAQUBqKEAAOQAAOwAAQAAAQQBpKAAAKwAAL0AAMAAAMEAAMkBqJEAALwAAMAAAMgAANEAAQEBqQAAAQAAAQUBpJAAAKEAAL0AANAAAO0AAQQAAQ0CBUygAADRAADsAAEMAAERAgVQtQAA0AAA1QAA8QABEAABFQIFTK0AALQAANQAAN0AAO0AAPAAAPkAARQCBUysAAC9AADJAADcAADsAADtAAD4AAENAgVMkQAAvAAAyAAA0QAA7AGovAGkkAAApQAA0AAA1QAA5QAA8QABDAGo+QGopAAArQAA1AAA3QAA5AAA7QAA8AIFTKUAAKwAALUAANwAAOUAAOwBpKQAAOQAAQEBqKEAAN0AAPEAAQABqJkAAKAAANUAAPAAAPgAAPkBpJgAAKEAALQAANEAANQAANwAAPEAAPgBqO0AAPABpKAAANAAAOwAAPkBqLUAANEAAN0AAPgAAQEBqQAAAR0BpK0AALQAAMkAANAAANkAANwAARUAARwBqMgAAPkBpKwAAMUAANgAAPgAARQBqMQAANEAAOUAAPEAAQ0BqLUAANABpLQAAMkAAPAAAPkBqPgAAQUBpK0AAMgAAO0AAQQAAQwBqKwAAMEAAOQAAOwAAQEBqMAAAPEBpL0AAMkAAN0AAPABqNwAAQAAAQUBpLwAAMEAAMgAAOUBqLUAAMAAANEAAOQAAPEAAQQCBUzQAADwAgj0tAII9OUAAQECBUytAADJAADkAADpAAEAAAEdANToANTdAAD5ANDcAADhAADtAAD4ANSsAADIAADgAADxAAEcANTBAADRAajAAADJAaTIAADRAAERAai1AADQAaS0AAC9AADQAADsAADwAAEJAAEQAajxAai1AAC8AADFAADlAAEIAaTEAADwAAEVANTVAAD5AAENANS0AADkAAEUAgR4tQAA0QAA1AAA8QAA+AGotAAAvQAAwQAAyQAA0AGktQAAvAAAwAAAyAAA0QAA3QAA8AAA9QABDAGo3AAA5QGomQAAtAAAyQAA0AAA2QAA5AAA9AAA+QDR/QDV/QDV/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/AAB/QDUmAAAyAAA2AAA+AAB/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/ADV/AAH/LwA= sound-font visualizer=&quot;#section394 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD9ADAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAaSlAACsAAEUAgVM5QABAQIFUKQAAPAAAPkBpK0AAMEAAO0AAPgAAQEAAQUBqKEAAOQAAOwAAQAAAQQBpKAAAKwAAL0AAMAAAMEAAMkBqJEAALwAAMAAAMgAANEAAQEBqQAAAQAAAQUBpJAAAKEAAL0AANAAAO0AAQQAAQ0CBUygAADRAADsAAEMAAERAgVQtQAA0AAA1QAA8QABEAABFQIFTK0AALQAANQAAN0AAO0AAPAAAPkAARQCBUysAAC9AADJAADcAADsAADtAAD4AAENAgVMkQAAvAAAyAAA0QAA7AGovAGkkAAApQAA0AAA1QAA5QAA8QABDAGo+QGopAAArQAA1AAA3QAA5AAA7QAA8AIFTKUAAKwAALUAANwAAOUAAOwBpKQAAOQAAQEBqKEAAN0AAPEAAQABqJkAAKAAANUAAPAAAPgAAPkBpJgAAKEAALQAANEAANQAANwAAPEAAPgBqO0AAPABpKAAANAAAOwAAPkBqLUAANEAAN0AAPgAAQEBqQAAAR0BpK0AALQAAMkAANAAANkAANwAARUAARwBqMgAAPkBpKwAAMUAANgAAPgAARQBqMQAANEAAOUAAPEAAQ0BqLUAANABpLQAAMkAAPAAAPkBqPgAAQUBpK0AAMgAAO0AAQQAAQwBqKwAAMEAAOQAAOwAAQEBqMAAAPEBpL0AAMkAAN0AAPABqNwAAQAAAQUBpLwAAMEAAMgAAOUBqLUAAMAAANEAAOQAAPEAAQQCBUzQAADwAgj0tAII9OUAAQECBUytAADJAADkAADpAAEAAAEdANToANTdAAD5ANDcAADhAADtAAD4ANSsAADIAADgAADxAAEcANTBAADRAajAAADJAaTIAADRAAERAai1AADQAaS0AAC9AADQAADsAADwAAEJAAEQAajxAai1AAC8AADFAADlAAEIAaTEAADwAAEVANTVAAD5AAENANS0AADkAAEUAgR4tQAA0QAA1AAA8QAA+AGotAAAvQAAwQAAyQAA0AGktQAAvAAAwAAAyAAA0QAA3QAA8AAA9QABDAGo3AAA5QGomQAAtAAAyQAA0AAA2QAA5AAA9AAA+QDR/QDV/QDV/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/AAB/QDUmAAAyAAA2AAA+AAB/AAB/QDV/AAB/QDV/AAB/QDR/AAB/QDV/ADV/AAH/LwA= type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section776 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section776 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section776 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section776 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section776 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section776 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section776 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section776 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section776 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section776 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section776 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section776&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Demo on val dataset, Epoch=12<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD5wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1AaitAAC0AaisAAEAAAEZAaTVAAEUAAEVAAEYAajRAADUAAENAaTQAADVAAD5AAEFAAEMAAEUAAEVAajUAADdAAEEAAEUAAEZAajcAADlAADwAAEBAAEVAAEYAaTxAAD4AajkAAEUAaSZAAD5AAEZAaiYAADBAai5AADAAADwAAENAAEYAaTxAAD4AajlAADwAAEJAAEMANX9ANEAAAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANS4AADkAAEIAAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8ANX8AAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD5wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1AaitAAC0AaisAAEAAAEZAaTVAAEUAAEVAAEYAajRAADUAAENAaTQAADVAAD5AAEFAAEMAAEUAAEVAajUAADdAAEEAAEUAAEZAajcAADlAADwAAEBAAEVAAEYAaTxAAD4AajkAAEUAaSZAAD5AAEZAaiYAADBAai5AADAAADwAAENAAEYAaTxAAD4AajlAADwAAEJAAEMANX9ANEAAAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANS4AADkAAEIAAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8ANX8AAf8vAA== sound-font visualizer=&quot;#section776 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD5wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1AaitAAC0AaisAAEAAAEZAaTVAAEUAAEVAAEYAajRAADUAAENAaTQAADVAAD5AAEFAAEMAAEUAAEVAajUAADdAAEEAAEUAAEZAajcAADlAADwAAEBAAEVAAEYAaTxAAD4AajkAAEUAaSZAAD5AAEZAaiYAADBAai5AADAAADwAAENAAEYAaTxAAD4AajlAADwAAEJAAEMANX9ANEAAAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANS4AADkAAEIAAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8ANX8AAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section911 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section911 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section911 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section911 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section911 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section911 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section911 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section911 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section911 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section911 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section911 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section911&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Demo on val dataset, Epoch=16<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD7wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1Aai0AADJAajIAAEAAAEFAaTVAADdAAEEAAEFAAENAAEUAajUAADVAADcAAEEAAEMAAEVAaTRAADUAADxAAENAAEUAajtAADwAajwAAD5AAEMAaTRAADsAADxANTtAADwANTBAADQAADQAADsAADxAAEBAgVMwAAA1QAA+AABAAABFQGo0QAA1AAA3QGkyQAA0AAA8AAA+QABFAABGQIFTMgAANEAANwAAPgAAQEAAQ0AARgBqMkAANAAAPkAAQABqMUAAMgAAMkAAPgAAQEAAQUAAQwAARUBpMgAANEAAOkAAPEBqMQAAN0AAOgAAPAAAPkAAQAAAQQAARQBpNUAANwAAOUAAPEAAPgBqN0AAOQAAO0AAPAAAPkBqNAAANQBpKEAANwAAPgAAQEBqQAAAQ0BpKAAAMkAANUAAQUBqOwAAPEAAQwBqLUAAMgAANEAANQAAN0AAPAAAPEAAQQBpKkAALQAANAAAPkA1PgAAQEA1KgAAK0AAL0AANwAAPAAAPkAAQAAAR0CEeTRAADtAAD4AAENAajJAaisAAC8AADBAADIAADQAADZAADlAAEMAAEVAAEcAaTkAADsAADtAai9AADAAADFAADRAADYAADlAADsAAD5AAEBAAEUAgVMsQAAvAAAxAAA0AAA3QAA5AAA8QAA+AABAAABAQGosAAAuQAA7QAA8AGkuAAAyQAA2QAA3AAA5QAA7AAA+QABAAGotQAAyAGktAAAvQAA+AABAQGovAAAxQAA4QAA5AGoxAAAxQAA4AAA5QGkvQAAxAAA2AAA5AGovAAA3QAA7QGk3AAA5QAA7AAA9QGovQAA5AAA7QAA9AAA+QGo+AABCQGkuQAAvAAA7AAA9QABAAABAQABCAABDQGorQAAuAAA7QABDAGktQAA9AGomQAArAAAtAAAvQAA2QAA7AAA+QGpAAGkmAAAoQAAvAAA0QAA2AAA4QGoyQAA0AGkoAAAtQAAxQAAyAAA0QAA4AAA5QAA+AIMnLQAAMQAANAAAN0AAOQAAPkAAf0AAf0BpK0AANEAANwAAOkAAPUAAPgAAfwAAfwBqKwAALEAAL0AANAAAOgAAPQAAPkBqLAAAPgAAQ0A0LwAAMUAAOUAAPUA1LUAAOQAAQwA1LQAAMQAANkAAOkBqMkAAPQCBUzRAgyYmQAAsQAAyAAA2AAA6AAA9QGomAAA9AGk0AIFULAAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD7wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1Aai0AADJAajIAAEAAAEFAaTVAADdAAEEAAEFAAENAAEUAajUAADVAADcAAEEAAEMAAEVAaTRAADUAADxAAENAAEUAajtAADwAajwAAD5AAEMAaTRAADsAADxANTtAADwANTBAADQAADQAADsAADxAAEBAgVMwAAA1QAA+AABAAABFQGo0QAA1AAA3QGkyQAA0AAA8AAA+QABFAABGQIFTMgAANEAANwAAPgAAQEAAQ0AARgBqMkAANAAAPkAAQABqMUAAMgAAMkAAPgAAQEAAQUAAQwAARUBpMgAANEAAOkAAPEBqMQAAN0AAOgAAPAAAPkAAQAAAQQAARQBpNUAANwAAOUAAPEAAPgBqN0AAOQAAO0AAPAAAPkBqNAAANQBpKEAANwAAPgAAQEBqQAAAQ0BpKAAAMkAANUAAQUBqOwAAPEAAQwBqLUAAMgAANEAANQAAN0AAPAAAPEAAQQBpKkAALQAANAAAPkA1PgAAQEA1KgAAK0AAL0AANwAAPAAAPkAAQAAAR0CEeTRAADtAAD4AAENAajJAaisAAC8AADBAADIAADQAADZAADlAAEMAAEVAAEcAaTkAADsAADtAai9AADAAADFAADRAADYAADlAADsAAD5AAEBAAEUAgVMsQAAvAAAxAAA0AAA3QAA5AAA8QAA+AABAAABAQGosAAAuQAA7QAA8AGkuAAAyQAA2QAA3AAA5QAA7AAA+QABAAGotQAAyAGktAAAvQAA+AABAQGovAAAxQAA4QAA5AGoxAAAxQAA4AAA5QGkvQAAxAAA2AAA5AGovAAA3QAA7QGk3AAA5QAA7AAA9QGovQAA5AAA7QAA9AAA+QGo+AABCQGkuQAAvAAA7AAA9QABAAABAQABCAABDQGorQAAuAAA7QABDAGktQAA9AGomQAArAAAtAAAvQAA2QAA7AAA+QGpAAGkmAAAoQAAvAAA0QAA2AAA4QGoyQAA0AGkoAAAtQAAxQAAyAAA0QAA4AAA5QAA+AIMnLQAAMQAANAAAN0AAOQAAPkAAf0AAf0BpK0AANEAANwAAOkAAPUAAPgAAfwAAfwBqKwAALEAAL0AANAAAOgAAPQAAPkBqLAAAPgAAQ0A0LwAAMUAAOUAAPUA1LUAAOQAAQwA1LQAAMQAANkAAOkBqMkAAPQCBUzRAgyYmQAAsQAAyAAA2AAA6AAA9QGomAAA9AGk0AIFULAAB/y8A sound-font visualizer=&quot;#section911 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD7wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaS0AAC1Aai0AADJAajIAAEAAAEFAaTVAADdAAEEAAEFAAENAAEUAajUAADVAADcAAEEAAEMAAEVAaTRAADUAADxAAENAAEUAajtAADwAajwAAD5AAEMAaTRAADsAADxANTtAADwANTBAADQAADQAADsAADxAAEBAgVMwAAA1QAA+AABAAABFQGo0QAA1AAA3QGkyQAA0AAA8AAA+QABFAABGQIFTMgAANEAANwAAPgAAQEAAQ0AARgBqMkAANAAAPkAAQABqMUAAMgAAMkAAPgAAQEAAQUAAQwAARUBpMgAANEAAOkAAPEBqMQAAN0AAOgAAPAAAPkAAQAAAQQAARQBpNUAANwAAOUAAPEAAPgBqN0AAOQAAO0AAPAAAPkBqNAAANQBpKEAANwAAPgAAQEBqQAAAQ0BpKAAAMkAANUAAQUBqOwAAPEAAQwBqLUAAMgAANEAANQAAN0AAPAAAPEAAQQBpKkAALQAANAAAPkA1PgAAQEA1KgAAK0AAL0AANwAAPAAAPkAAQAAAR0CEeTRAADtAAD4AAENAajJAaisAAC8AADBAADIAADQAADZAADlAAEMAAEVAAEcAaTkAADsAADtAai9AADAAADFAADRAADYAADlAADsAAD5AAEBAAEUAgVMsQAAvAAAxAAA0AAA3QAA5AAA8QAA+AABAAABAQGosAAAuQAA7QAA8AGkuAAAyQAA2QAA3AAA5QAA7AAA+QABAAGotQAAyAGktAAAvQAA+AABAQGovAAAxQAA4QAA5AGoxAAAxQAA4AAA5QGkvQAAxAAA2AAA5AGovAAA3QAA7QGk3AAA5QAA7AAA9QGovQAA5AAA7QAA9AAA+QGo+AABCQGkuQAAvAAA7AAA9QABAAABAQABCAABDQGorQAAuAAA7QABDAGktQAA9AGomQAArAAAtAAAvQAA2QAA7AAA+QGpAAGkmAAAoQAAvAAA0QAA2AAA4QGoyQAA0AGkoAAAtQAAxQAAyAAA0QAA4AAA5QAA+AIMnLQAAMQAANAAAN0AAOQAAPkAAf0AAf0BpK0AANEAANwAAOkAAPUAAPgAAfwAAfwBqKwAALEAAL0AANAAAOgAAPQAAPkBqLAAAPgAAQ0A0LwAAMUAAOUAAPUA1LUAAOQAAQwA1LQAAMQAANkAAOkBqMkAAPQCBUzRAgyYmQAAsQAAyAAA2AAA6AAA9QGomAAA9AGk0AIFULAAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section430 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section430 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section430 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section430 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section430 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section430 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section430 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section430 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section430 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section430 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section430 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section430&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Demo on val dataset, Epoch=20<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAAEZAaUUAAEVAAEYAakNAAEUAaUBAaisAADJAAD5AAEAAAEFAAEFAAEMAajwAADxAAD4AAEEAAEVAaS9AADIAADwAAD5AAENAAEUAai8AADBAaTAAADJAAEEAAEJAAEMAaj4AAEVAajBAADIAADpAAEIAAENAAEUAaToAAEMAAEpAajAAADlAADxAaTNAADkAADpAADwAAENAAEoAajJAADMAADlAADoAAD5AAEFAAEMAgVMwQAAyAAA5AAA8QAA+AAA/QABBAABDQIFTMAAAMkAAPkAAPwAAQUAAQwBqOUAAPAAAPgAAP0BqMEAAMgAAN0AAOQAAOkAAPkAAPwAAQQBpNUAANwBqMAAAOgAAPEAAPgA1RUCBHjwANS5AADNAADpAAENAAEUANTUAgR4uAAAyQAAzAABBQABDAIFTMgAANEAAQQAAQ0AARUCBUzJAAD5AAEMAAEUAAEdAajQAADhAADoAai1AADIAADgAAD4AAEBAAEVAAEcAAEhAaUgAAE1Aai0AAC9AAD5AAEAAAEJAAEUAAEtAAE0AaUFAAEIAai8AADBAAD4AAD9AAENAAEsAakEAAEhAaSxAADAAAEMAAERAakdAAEgAaSwAAC1AAD8AAEJAAEQAAEVAAEcAajxAai0AADFAAEIANCtAADEAAD5AAEBAgR9FADUrAAArQAA7QAA+AABAAABDQIFTNEAAOwCBUylAACsAADQAADxAAEFAAEMAgVM5QABBAABBQGopAAArQGkrAAA5AAA6QAA+QABBAGo6AABDQGo3QAA+AABDAABDQGk3AABLQDU8ADUyQAA8AAA+QABBQABDAABLAABNQGlBAABGQGoyAAAzQAA+AAA/QABDQABGAABNAABPQGpIQABPAGkzAAA1QAA+QAA/AABBQABDAABRQGo1AAA3QAA+AABRAABSQGk3AAA5QAA6QABBAGo5AAA5QAA6AGo5AAA8QABAQGk6QAA8AAA+QABAAGo5QAA6AAA8QAA+ADU8AAA+QDQ1QAA5AAA8QAA+AAA/QABBQABSAGpBAABFQGoyQAA1AAA6QAA8AAA/AABFAABGQGkyAAAzQAA1QAA/QABIAGoyQAAzAAA1AAA3QAA6AAA/AABBQGkwQAAyAAA/QABBAABGAGowAAAyQAA+QAA/AIFTNwAAPgAARkBqMgBpM0AARgCBVDMAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAAEZAaUUAAEVAAEYAakNAAEUAaUBAaisAADJAAD5AAEAAAEFAAEFAAEMAajwAADxAAD4AAEEAAEVAaS9AADIAADwAAD5AAENAAEUAai8AADBAaTAAADJAAEEAAEJAAEMAaj4AAEVAajBAADIAADpAAEIAAENAAEUAaToAAEMAAEpAajAAADlAADxAaTNAADkAADpAADwAAENAAEoAajJAADMAADlAADoAAD5AAEFAAEMAgVMwQAAyAAA5AAA8QAA+AAA/QABBAABDQIFTMAAAMkAAPkAAPwAAQUAAQwBqOUAAPAAAPgAAP0BqMEAAMgAAN0AAOQAAOkAAPkAAPwAAQQBpNUAANwBqMAAAOgAAPEAAPgA1RUCBHjwANS5AADNAADpAAENAAEUANTUAgR4uAAAyQAAzAABBQABDAIFTMgAANEAAQQAAQ0AARUCBUzJAAD5AAEMAAEUAAEdAajQAADhAADoAai1AADIAADgAAD4AAEBAAEVAAEcAAEhAaUgAAE1Aai0AAC9AAD5AAEAAAEJAAEUAAEtAAE0AaUFAAEIAai8AADBAAD4AAD9AAENAAEsAakEAAEhAaSxAADAAAEMAAERAakdAAEgAaSwAAC1AAD8AAEJAAEQAAEVAAEcAajxAai0AADFAAEIANCtAADEAAD5AAEBAgR9FADUrAAArQAA7QAA+AABAAABDQIFTNEAAOwCBUylAACsAADQAADxAAEFAAEMAgVM5QABBAABBQGopAAArQGkrAAA5AAA6QAA+QABBAGo6AABDQGo3QAA+AABDAABDQGk3AABLQDU8ADUyQAA8AAA+QABBQABDAABLAABNQGlBAABGQGoyAAAzQAA+AAA/QABDQABGAABNAABPQGpIQABPAGkzAAA1QAA+QAA/AABBQABDAABRQGo1AAA3QAA+AABRAABSQGk3AAA5QAA6QABBAGo5AAA5QAA6AGo5AAA8QABAQGk6QAA8AAA+QABAAGo5QAA6AAA8QAA+ADU8AAA+QDQ1QAA5AAA8QAA+AAA/QABBQABSAGpBAABFQGoyQAA1AAA6QAA8AAA/AABFAABGQGkyAAAzQAA1QAA/QABIAGoyQAAzAAA1AAA3QAA6AAA/AABBQGkwQAAyAAA/QABBAABGAGowAAAyQAA+QAA/AIFTNwAAPgAARkBqMgBpM0AARgCBVDMAAf8vAA== sound-font visualizer=&quot;#section430 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAD8wDAAACQMEAAPEAAQ0AASECBUzwAAEBAajAAADJAaTIAADRAajQAADVAajUAADdAAD5AAEAAAEdAAEgAaUFAAEMAai1AADcAADxAAD4AAEBAAEEAAEVAAEcAaStAAC0AailAACsAaikAACtAAEAAAEZAaUUAAEVAAEYAakNAAEUAaUBAaisAADJAAD5AAEAAAEFAAEFAAEMAajwAADxAAD4AAEEAAEVAaS9AADIAADwAAD5AAENAAEUAai8AADBAaTAAADJAAEEAAEJAAEMAaj4AAEVAajBAADIAADpAAEIAAENAAEUAaToAAEMAAEpAajAAADlAADxAaTNAADkAADpAADwAAENAAEoAajJAADMAADlAADoAAD5AAEFAAEMAgVMwQAAyAAA5AAA8QAA+AAA/QABBAABDQIFTMAAAMkAAPkAAPwAAQUAAQwBqOUAAPAAAPgAAP0BqMEAAMgAAN0AAOQAAOkAAPkAAPwAAQQBpNUAANwBqMAAAOgAAPEAAPgA1RUCBHjwANS5AADNAADpAAENAAEUANTUAgR4uAAAyQAAzAABBQABDAIFTMgAANEAAQQAAQ0AARUCBUzJAAD5AAEMAAEUAAEdAajQAADhAADoAai1AADIAADgAAD4AAEBAAEVAAEcAAEhAaUgAAE1Aai0AAC9AAD5AAEAAAEJAAEUAAEtAAE0AaUFAAEIAai8AADBAAD4AAD9AAENAAEsAakEAAEhAaSxAADAAAEMAAERAakdAAEgAaSwAAC1AAD8AAEJAAEQAAEVAAEcAajxAai0AADFAAEIANCtAADEAAD5AAEBAgR9FADUrAAArQAA7QAA+AABAAABDQIFTNEAAOwCBUylAACsAADQAADxAAEFAAEMAgVM5QABBAABBQGopAAArQGkrAAA5AAA6QAA+QABBAGo6AABDQGo3QAA+AABDAABDQGk3AABLQDU8ADUyQAA8AAA+QABBQABDAABLAABNQGlBAABGQGoyAAAzQAA+AAA/QABDQABGAABNAABPQGpIQABPAGkzAAA1QAA+QAA/AABBQABDAABRQGo1AAA3QAA+AABRAABSQGk3AAA5QAA6QABBAGo5AAA5QAA6AGo5AAA8QABAQGk6QAA8AAA+QABAAGo5QAA6AAA8QAA+ADU8AAA+QDQ1QAA5AAA8QAA+AAA/QABBQABSAGpBAABFQGoyQAA1AAA6QAA8AAA/AABFAABGQGkyAAAzQAA1QAA/QABIAGoyQAAzAAA1AAA3QAA6AAA/AABBQGkwQAAyAAA/QABBAABGAGowAAAyQAA+QAA/AIFTNwAAPgAARkBqMgBpM0AARgCBVDMAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
<p><br> <br> …and that’s about as good as it’s going to get for now. 😕 Moving on…</p>
</section>
</section>
<section id="evaluate-the-model" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Evaluate the Model</h1>
<p>Now we’ll grab some data from the hitherto-unseen <code>test</code> dataset, and use it to prompt the model. We’ll see how it “scores” – in more ways than one!</p>
<section id="sample-generations" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-generations"><span class="header-section-number">8.1</span> Sample Generations</h2>
<p>First we’ll set a “prompt” from the <code>test</code> set to see how the model continues it.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">file_ind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  </span>
<span id="cb40-2">original <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_notes_tl[file_ind]</span>
<span id="cb40-3">num_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(original)</span>
<span id="cb40-4">display(midiplayer(original, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Full Evaluation Target, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>num_tokens<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes long"</span>))</span>
<span id="cb40-5"></span>
<span id="cb40-6"></span>
<span id="cb40-7">prompt_len <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span></span>
<span id="cb40-8">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> original[:prompt_len] </span>
<span id="cb40-9">display(midiplayer(prompt, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Evaluation Prompt, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prompt_len<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> notes long"</span>))</span>
<span id="cb40-10">prompt_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(prompt).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(device)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section41 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section41 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section41 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section41 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section41 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section41 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section41 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section41 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section41 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section41 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section41 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section41&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Full Evaluation Target, 210 notes long<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/QDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUlAAEoAajtAAD9AAEAAAEdAAEkAajdAADkAaTZAADcAADlAADsAAD8AAEBAAEcAAElAajRAADYAADdAADkAaTQAADZAADcAADlAAD5AAEAAAEkAAEpAajJAADYAAD4AAEVAAElAAEoAajIAADRAADkAAEBAAERAAEUAAEdAAEkAaT5AAEAAai1AADQAAD1AAD4AAEBAAEQAAEVAAEcAhHktAAAyQAA5QAA9AABAAABCQIFUMgAAM0AARQAAR0BpMwAANEBqOEAAOQAAQEAAQgAARwAASUBpNAAANUAAPUAAQABqOAAAO0AAPQAAREAASQAASkBqNQAANkAAOUAAOwAAQkAARABpNgAAOEAAOQAAO0AAQEAAQgAAR0AASgBqOAAAOUAAP0AAQABpOEAAOQAAPwAAQEAARwAATEA1QAAAQkA1NEAAOAAAOwAAQEAAQgAAREBqNAAAO0AARAAARUAATAAATkBpP0AAQAAAQkAARQBqNEAAOwAAPwAAQEAAQgAAREAATEAATgCBUzQAADlAAEQAAEVAAElAAEwAajhAADkAaTZAADgAAEAAAEJAajRAADYAAEkAAEpAaTJAADQAAEUAAEZAAEoAAExAajFAADIAai9AADEAAEYAAEdAAEpAAEwAaUVAAEcAai8AADRAAEBAAEIAAERAAEUAAElAAEoAaTJAADQAAEJAAEQAAEdAAEkAajFAADIAAEIAAEVAAEcAai9AADEAAD5AAEAAAEJAAEUAAEdANEIAAERANS1AAC8AAD1AAD4AAEQAAEVAAEcAAElAaj0AAD9AAEJAAEUAaS0AADRAAD8AAEBAAEIAAERAAEdAAEkAgVQtQAA0AABEAABFQABHAABJQGlEQABFAGotAAAyQAA+QABAAABCQABEAABFQABJAGkyAAA0QAA9QAA+AGoyQAA0AAA9AAA+QABFAABHQGoxQAAyAAA+AABAQABCAABEQABHAABJQDREAABGQDUvQAAxAABAAABCQABGAABHQABJAABKQIFTLwAANkAARkAARwAASUAASgBqQEAAQgBqNgAAN0AAPkAAQAAARgAAR0AASQBpNkAANwAARUBqNEAANgAAPgAAQEAAQ0AARQAARwAASUCBUzJAADQAADlAAEAAAEJAAEMAAEkAAEpAgVMtQAAyAABAQABCAABJQABKAGpAAABFQGktAAA0QAA5AAA7QABHQABJAGpEQABFAGo7AAA9QABFQABHAGk9AAA/QABCQABEAGo/AABAQABCAABEQABFAABMQGk0AAA2QABEAABFQGo2AAA4QABFAABHQGo0QAA4AABKQABMAGk0AAA5QABJQABKAGo4QAA5AAA9QABHAGk2QAA4AAA5QAA9AABAAABFQABJAABKQGo0QAA2AAA5AAA9QABJQABKAGoyQAA0AAA9AABCQABHQABJAGkvQAAyAAA+QABCAGovAAA0QAA7QAA+AABEQABFAGk7AABAQGotQAA0AAA9QABEAABFQABHAIZNLQAAPQAAQAAARQAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/QDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUlAAEoAajtAAD9AAEAAAEdAAEkAajdAADkAaTZAADcAADlAADsAAD8AAEBAAEcAAElAajRAADYAADdAADkAaTQAADZAADcAADlAAD5AAEAAAEkAAEpAajJAADYAAD4AAEVAAElAAEoAajIAADRAADkAAEBAAERAAEUAAEdAAEkAaT5AAEAAai1AADQAAD1AAD4AAEBAAEQAAEVAAEcAhHktAAAyQAA5QAA9AABAAABCQIFUMgAAM0AARQAAR0BpMwAANEBqOEAAOQAAQEAAQgAARwAASUBpNAAANUAAPUAAQABqOAAAO0AAPQAAREAASQAASkBqNQAANkAAOUAAOwAAQkAARABpNgAAOEAAOQAAO0AAQEAAQgAAR0AASgBqOAAAOUAAP0AAQABpOEAAOQAAPwAAQEAARwAATEA1QAAAQkA1NEAAOAAAOwAAQEAAQgAAREBqNAAAO0AARAAARUAATAAATkBpP0AAQAAAQkAARQBqNEAAOwAAPwAAQEAAQgAAREAATEAATgCBUzQAADlAAEQAAEVAAElAAEwAajhAADkAaTZAADgAAEAAAEJAajRAADYAAEkAAEpAaTJAADQAAEUAAEZAAEoAAExAajFAADIAai9AADEAAEYAAEdAAEpAAEwAaUVAAEcAai8AADRAAEBAAEIAAERAAEUAAElAAEoAaTJAADQAAEJAAEQAAEdAAEkAajFAADIAAEIAAEVAAEcAai9AADEAAD5AAEAAAEJAAEUAAEdANEIAAERANS1AAC8AAD1AAD4AAEQAAEVAAEcAAElAaj0AAD9AAEJAAEUAaS0AADRAAD8AAEBAAEIAAERAAEdAAEkAgVQtQAA0AABEAABFQABHAABJQGlEQABFAGotAAAyQAA+QABAAABCQABEAABFQABJAGkyAAA0QAA9QAA+AGoyQAA0AAA9AAA+QABFAABHQGoxQAAyAAA+AABAQABCAABEQABHAABJQDREAABGQDUvQAAxAABAAABCQABGAABHQABJAABKQIFTLwAANkAARkAARwAASUAASgBqQEAAQgBqNgAAN0AAPkAAQAAARgAAR0AASQBpNkAANwAARUBqNEAANgAAPgAAQEAAQ0AARQAARwAASUCBUzJAADQAADlAAEAAAEJAAEMAAEkAAEpAgVMtQAAyAABAQABCAABJQABKAGpAAABFQGktAAA0QAA5AAA7QABHQABJAGpEQABFAGo7AAA9QABFQABHAGk9AAA/QABCQABEAGo/AABAQABCAABEQABFAABMQGk0AAA2QABEAABFQGo2AAA4QABFAABHQGo0QAA4AABKQABMAGk0AAA5QABJQABKAGo4QAA5AAA9QABHAGk2QAA4AAA5QAA9AABAAABFQABJAABKQGo0QAA2AAA5AAA9QABJQABKAGoyQAA0AAA9AABCQABHQABJAGkvQAAyAAA+QABCAGovAAA0QAA7QAA+AABEQABFAGk7AABAQGotQAA0AAA9QABEAABFQABHAIZNLQAAPQAAQAAARQAB/y8A sound-font visualizer=&quot;#section41 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/QDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUlAAEoAajtAAD9AAEAAAEdAAEkAajdAADkAaTZAADcAADlAADsAAD8AAEBAAEcAAElAajRAADYAADdAADkAaTQAADZAADcAADlAAD5AAEAAAEkAAEpAajJAADYAAD4AAEVAAElAAEoAajIAADRAADkAAEBAAERAAEUAAEdAAEkAaT5AAEAAai1AADQAAD1AAD4AAEBAAEQAAEVAAEcAhHktAAAyQAA5QAA9AABAAABCQIFUMgAAM0AARQAAR0BpMwAANEBqOEAAOQAAQEAAQgAARwAASUBpNAAANUAAPUAAQABqOAAAO0AAPQAAREAASQAASkBqNQAANkAAOUAAOwAAQkAARABpNgAAOEAAOQAAO0AAQEAAQgAAR0AASgBqOAAAOUAAP0AAQABpOEAAOQAAPwAAQEAARwAATEA1QAAAQkA1NEAAOAAAOwAAQEAAQgAAREBqNAAAO0AARAAARUAATAAATkBpP0AAQAAAQkAARQBqNEAAOwAAPwAAQEAAQgAAREAATEAATgCBUzQAADlAAEQAAEVAAElAAEwAajhAADkAaTZAADgAAEAAAEJAajRAADYAAEkAAEpAaTJAADQAAEUAAEZAAEoAAExAajFAADIAai9AADEAAEYAAEdAAEpAAEwAaUVAAEcAai8AADRAAEBAAEIAAERAAEUAAElAAEoAaTJAADQAAEJAAEQAAEdAAEkAajFAADIAAEIAAEVAAEcAai9AADEAAD5AAEAAAEJAAEUAAEdANEIAAERANS1AAC8AAD1AAD4AAEQAAEVAAEcAAElAaj0AAD9AAEJAAEUAaS0AADRAAD8AAEBAAEIAAERAAEdAAEkAgVQtQAA0AABEAABFQABHAABJQGlEQABFAGotAAAyQAA+QABAAABCQABEAABFQABJAGkyAAA0QAA9QAA+AGoyQAA0AAA9AAA+QABFAABHQGoxQAAyAAA+AABAQABCAABEQABHAABJQDREAABGQDUvQAAxAABAAABCQABGAABHQABJAABKQIFTLwAANkAARkAARwAASUAASgBqQEAAQgBqNgAAN0AAPkAAQAAARgAAR0AASQBpNkAANwAARUBqNEAANgAAPgAAQEAAQ0AARQAARwAASUCBUzJAADQAADlAAEAAAEJAAEMAAEkAAEpAgVMtQAAyAABAQABCAABJQABKAGpAAABFQGktAAA0QAA5AAA7QABHQABJAGpEQABFAGo7AAA9QABFQABHAGk9AAA/QABCQABEAGo/AABAQABCAABEQABFAABMQGk0AAA2QABEAABFQGo2AAA4QABFAABHQGo0QAA4AABKQABMAGk0AAA5QABJQABKAGo4QAA5AAA9QABHAGk2QAA4AAA5QAA9AABAAABFQABJAABKQGo0QAA2AAA5AAA9QABJQABKAGoyQAA0AAA9AABCQABHQABJAGkvQAAyAAA+QABCAGovAAA0QAA7QAA+AABEQABFAGk7AABAQGotQAA0AAA9QABEAABFQABHAIZNLQAAPQAAQAAARQAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section265 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section265 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section265 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section265 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section265 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section265 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section265 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section265 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section265 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section265 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section265 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section265&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Evaluation Prompt, 21 notes long<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAhwDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAakAAajkAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAhwDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAakAAajkAAf8vAA== sound-font visualizer=&quot;#section265 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAAhwDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAakAAajkAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
<p>In what follows, we’ll vary the “temperature” (aka “wackiness”) parameter of the model (see the <a href="https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html#sec-softmax-fun">bottom of the previous lesson</a>), to see its effect on the variety of notes produced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">new_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> num_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prompt_len</span>
<span id="cb41-2"></span>
<span id="cb41-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> temperature <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]:</span>
<span id="cb41-4">    set_seeds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) </span>
<span id="cb41-5">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decode( model.generate(prompt_tokens, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_tokens, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>temperature)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].cpu() )</span>
<span id="cb41-6">    display(midiplayer(notes, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Temperature = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>temperature<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 0.7<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFBQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajhAADkAADtAaTgAADlAADsAAD1AAEBAgVMyQAA5AAA9AABAAABCQABFQABJQABKAGpJAABOQGoyAAA0QABAQABCAABEQABFAABHQABOAGlCQABEAGotQAA0AAA9QABAAABCAABMQGk9AAA/QGotAAA0QAA7QAA/AABDQABEQABGQABHAABMAIFTMUAANAAAOwAAPUAAQwBqPQAATEBpMQAAM0AAP0AARgAATAAATkCBVDMAADhAAEQAAERAAEdAAE4AaT1AAD8AajgAADlAAEJAAEQAAEcAAElAaT0AAD9AajhAADkAAD1AAD8AAExAajxAAD0AaStAADgAADtAADwAAEIAAEkAAEpAAEwAajlAADsAAD1AAEBAaSsAADdAAEoAajJAADcAADkAAD5AAEAAAEJAgVMyAAA7QAA9AAA+AAA+QABCAABDQABHQGo+AABAQABCQABDAGk2QAA7AAA9QABAAABCAABCQABFQABHAIFUNgAAN0AAPQAAPkAAQgAARQAAR0BpNEAANkAANwAAPgAAQEAARkAARkAARwBqL0AANAAANgAAQAAAQkAARgAARgAAR0AASkCBUy8AADZAAEZAAEcAakBAAEYAaTNAADYAAEAAAEJAAEZAakRAAEYAaS9AADMAAD9AAEIAAEJAAEQAAEoAgVQvAAA7QAA+QAA/AABCAABCAABDQGlHQGoxQAA7AAA+AABAQABDAABGQABJQGlHAABHQABJAGoxAAAyQABAAABCQABFQABGAABHAGpFAABKQGkxQAAyAABAQABCAABDQABKAABMQGo+QABAAABCQABDAGkxAAA3QAA5QAA9QAA+AABAQABCAABJQABMAGo3QAA5AAA9AAA+QABAAGo2QAA3AAA3AAA5QAA+AAA+QABJAABKQGk0QAA2AAA+AABDQGoyQAA0AAA5AAA+QABCQABDAGlCAABFQGorQAAyAABDQABFAABHQABKAIFTKwAAMEAAPgAAQEAAQwAAQ0AARwAASEBqQwAARUBpMAAAMkAAPkAAQAAAQkAARQCBVDIAADdAAD4AAEIAAENAAEZAAEgAgVMwQAA3AABAQABBQABDAGk8QABAAGowAAA1QAA8AAA+QABBAABFQABGAIFTNEAANQAAPEAAPgAAQ0AARQAAT0CBUzJAADQAADwAAD5AAEJAAEMAAE8AAFFAgVQyAAA3QAA+AABCAABDQABRAABSQGlBQABDAGo3AAA5QAA/QABBAABFQABSAABUQIFTLkAAOQAAPwAAQUAARQAASkAAUkAAVABqLgAAOUAAQQAAQ0AASEAASgBpN0AAOQAAPkAAQwAASAAASkAAUgAAU0CBUzcAAD4AAENAAEZAAEhAAEoAAExAAFFAAFMAakZAAEgAAFEAAFJAaj5AAEMAAEVAAEYAAEYAAEpAAEwAAE1AAFIAaUUAAEZAajlAADxAAD4AAEYAAEhAAEoAAEtAAE0AgVM5AAA6QAA8AABIAABLAGo6AAH/LwA=&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFBQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajhAADkAADtAaTgAADlAADsAAD1AAEBAgVMyQAA5AAA9AABAAABCQABFQABJQABKAGpJAABOQGoyAAA0QABAQABCAABEQABFAABHQABOAGlCQABEAGotQAA0AAA9QABAAABCAABMQGk9AAA/QGotAAA0QAA7QAA/AABDQABEQABGQABHAABMAIFTMUAANAAAOwAAPUAAQwBqPQAATEBpMQAAM0AAP0AARgAATAAATkCBVDMAADhAAEQAAERAAEdAAE4AaT1AAD8AajgAADlAAEJAAEQAAEcAAElAaT0AAD9AajhAADkAAD1AAD8AAExAajxAAD0AaStAADgAADtAADwAAEIAAEkAAEpAAEwAajlAADsAAD1AAEBAaSsAADdAAEoAajJAADcAADkAAD5AAEAAAEJAgVMyAAA7QAA9AAA+AAA+QABCAABDQABHQGo+AABAQABCQABDAGk2QAA7AAA9QABAAABCAABCQABFQABHAIFUNgAAN0AAPQAAPkAAQgAARQAAR0BpNEAANkAANwAAPgAAQEAARkAARkAARwBqL0AANAAANgAAQAAAQkAARgAARgAAR0AASkCBUy8AADZAAEZAAEcAakBAAEYAaTNAADYAAEAAAEJAAEZAakRAAEYAaS9AADMAAD9AAEIAAEJAAEQAAEoAgVQvAAA7QAA+QAA/AABCAABCAABDQGlHQGoxQAA7AAA+AABAQABDAABGQABJQGlHAABHQABJAGoxAAAyQABAAABCQABFQABGAABHAGpFAABKQGkxQAAyAABAQABCAABDQABKAABMQGo+QABAAABCQABDAGkxAAA3QAA5QAA9QAA+AABAQABCAABJQABMAGo3QAA5AAA9AAA+QABAAGo2QAA3AAA3AAA5QAA+AAA+QABJAABKQGk0QAA2AAA+AABDQGoyQAA0AAA5AAA+QABCQABDAGlCAABFQGorQAAyAABDQABFAABHQABKAIFTKwAAMEAAPgAAQEAAQwAAQ0AARwAASEBqQwAARUBpMAAAMkAAPkAAQAAAQkAARQCBVDIAADdAAD4AAEIAAENAAEZAAEgAgVMwQAA3AABAQABBQABDAGk8QABAAGowAAA1QAA8AAA+QABBAABFQABGAIFTNEAANQAAPEAAPgAAQ0AARQAAT0CBUzJAADQAADwAAD5AAEJAAEMAAE8AAFFAgVQyAAA3QAA+AABCAABDQABRAABSQGlBQABDAGo3AAA5QAA/QABBAABFQABSAABUQIFTLkAAOQAAPwAAQUAARQAASkAAUkAAVABqLgAAOUAAQQAAQ0AASEAASgBpN0AAOQAAPkAAQwAASAAASkAAUgAAU0CBUzcAAD4AAENAAEZAAEhAAEoAAExAAFFAAFMAakZAAEgAAFEAAFJAaj5AAEMAAEVAAEYAAEYAAEpAAEwAAE1AAFIAaUUAAEZAajlAADxAAD4AAEYAAEhAAEoAAEtAAE0AgVM5AAA6QAA8AABIAABLAGo6AAH/LwA= sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFBQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajhAADkAADtAaTgAADlAADsAAD1AAEBAgVMyQAA5AAA9AABAAABCQABFQABJQABKAGpJAABOQGoyAAA0QABAQABCAABEQABFAABHQABOAGlCQABEAGotQAA0AAA9QABAAABCAABMQGk9AAA/QGotAAA0QAA7QAA/AABDQABEQABGQABHAABMAIFTMUAANAAAOwAAPUAAQwBqPQAATEBpMQAAM0AAP0AARgAATAAATkCBVDMAADhAAEQAAERAAEdAAE4AaT1AAD8AajgAADlAAEJAAEQAAEcAAElAaT0AAD9AajhAADkAAD1AAD8AAExAajxAAD0AaStAADgAADtAADwAAEIAAEkAAEpAAEwAajlAADsAAD1AAEBAaSsAADdAAEoAajJAADcAADkAAD5AAEAAAEJAgVMyAAA7QAA9AAA+AAA+QABCAABDQABHQGo+AABAQABCQABDAGk2QAA7AAA9QABAAABCAABCQABFQABHAIFUNgAAN0AAPQAAPkAAQgAARQAAR0BpNEAANkAANwAAPgAAQEAARkAARkAARwBqL0AANAAANgAAQAAAQkAARgAARgAAR0AASkCBUy8AADZAAEZAAEcAakBAAEYAaTNAADYAAEAAAEJAAEZAakRAAEYAaS9AADMAAD9AAEIAAEJAAEQAAEoAgVQvAAA7QAA+QAA/AABCAABCAABDQGlHQGoxQAA7AAA+AABAQABDAABGQABJQGlHAABHQABJAGoxAAAyQABAAABCQABFQABGAABHAGpFAABKQGkxQAAyAABAQABCAABDQABKAABMQGo+QABAAABCQABDAGkxAAA3QAA5QAA9QAA+AABAQABCAABJQABMAGo3QAA5AAA9AAA+QABAAGo2QAA3AAA3AAA5QAA+AAA+QABJAABKQGk0QAA2AAA+AABDQGoyQAA0AAA5AAA+QABCQABDAGlCAABFQGorQAAyAABDQABFAABHQABKAIFTKwAAMEAAPgAAQEAAQwAAQ0AARwAASEBqQwAARUBpMAAAMkAAPkAAQAAAQkAARQCBVDIAADdAAD4AAEIAAENAAEZAAEgAgVMwQAA3AABAQABBQABDAGk8QABAAGowAAA1QAA8AAA+QABBAABFQABGAIFTNEAANQAAPEAAPgAAQ0AARQAAT0CBUzJAADQAADwAAD5AAEJAAEMAAE8AAFFAgVQyAAA3QAA+AABCAABDQABRAABSQGlBQABDAGo3AAA5QAA/QABBAABFQABSAABUQIFTLkAAOQAAPwAAQUAARQAASkAAUkAAVABqLgAAOUAAQQAAQ0AASEAASgBpN0AAOQAAPkAAQwAASAAASkAAUgAAU0CBUzcAAD4AAENAAEZAAEhAAEoAAExAAFFAAFMAakZAAEgAAFEAAFJAaj5AAEMAAEVAAEYAAEYAAEpAAEwAAE1AAFIAaUUAAEZAajlAADxAAD4AAEYAAEhAAEoAAEtAAE0AgVM5AAA6QAA8AABIAABLAGo6AAH/LwA= type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 0.85<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajdAADkAAEBAaTZAADcAADlAAEAAgVM2AAA4QAA5AABHQABJQABKAABMQGo4AAA+QABCQABFQABHAABJAGo+AABAQABCAABFAABHQABMAGk5QABFQABHAABJQIFTPkAAQkAASQCBVDkAAD4AAEIAAEUAAEdAAEpAaUAAAENAaj1AAEFAAEcAAEoAAExAaUMAAEVAaj0AAD5AAEEAAEwAAE5AajxAAExAAE4AaTdAADtAADwAAD4AAENAAEUAAEpAAEwAajsAAD1AAEoAAExAaTJAADcAADlAAEJAAEMAajkAAD0AAD5AAEwANUJAAEpANUIANEVANT4ANStAAEIAAEUAAEdANTIANSsAADtAAENAAEcAaTsAAElAAEoAai9AAEJAAEMAAEZAaUBAAEIAai8AADJAAEAAAEJAAEVAAEYAakkAhBAyAAA+QABFAABKQIFTOUAAQgAAQkAASUAASgBpN0AAOQAAPgAAQEAAQgBqNkAANwAAQAAARUAAR0AASQBqNEAANgAAQ0AARQAAT0BpMUAAMkAANAAASkAATEAATwBqMQAAMgAANkAAPkAARwAASgAASkAATAA1RUBpRQAATEA1PgA1RkA1QwAARgAAR0A0RUAARwBqTACCcjYAAEoAgR4yQABCQABFQGoyAABOQGk3QGo3AAA7QAA+QABHQABOAGlCAABFAABFAABMQGo5QAA7AAA9QAA+AABGQABHAABKQGpGAABHQABJQABKAABMAGk5AAA7QAA9AABDQABHAABHQABJAGo2QABCQABDAABFQABHAABKQGk0QAA2AAA7AABCAABDQABFAABJQABKAGpDAABFQABJAABJQGo0AAA2QAA3QABCQABDQABFAABHQABJAGlAQABCAGo2AAA2QAA3AAA+QABDAABGQABHAGlAAABDQGo9QAA+AABGAGovQAA7QAA9AAA/QABCQABDAGk2AGo7QGk7AAA9QGovAAAzQAA7AAA7QAA9AAA/AGpHQGkxQAAzAAA7AAA9QABGQABHAIFTPQAAQkAARgAAR0BqL0AAMQAAPkAAQgAAQ0BqQEAAQgAARwBpLkAALwAAPUAAPgAAQkAAQwBqLgAANEAAO0AAQAAAQ0BpMUAAMkAANAAAPQAAQgAATEBqMUAAMgAAOkAAOwAAQwBqMQAAMQAAMkAAQkAATABpMgAANEAAOgBqNAAANEAAO0AAPkAAQEAAQgAAREBpLUAANAAAPUAAPgBqLQAAL0AAOwAAO0AAPQAAQAAAQkAARABqOwAAPUAAPkAAQEAAQgBpL0AAPQAAPgAAPkAAQAAAQkAASkBqLwAANEAAO0AAPgAAQ0BpLwAANAAAOUAAOwAAPUAAQEAAQgAAQwAASUAASgBqMkAAPQAAQAAAQkAASQAASkBqMUAAMgAAQEAAQgAASgAATEBpMQAAMkBqMgAANEAAN0AAOQAAO0AAQAAAQkAATACBUzQAADcAADsAAEIAAEpAakoAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajdAADkAAEBAaTZAADcAADlAAEAAgVM2AAA4QAA5AABHQABJQABKAABMQGo4AAA+QABCQABFQABHAABJAGo+AABAQABCAABFAABHQABMAGk5QABFQABHAABJQIFTPkAAQkAASQCBVDkAAD4AAEIAAEUAAEdAAEpAaUAAAENAaj1AAEFAAEcAAEoAAExAaUMAAEVAaj0AAD5AAEEAAEwAAE5AajxAAExAAE4AaTdAADtAADwAAD4AAENAAEUAAEpAAEwAajsAAD1AAEoAAExAaTJAADcAADlAAEJAAEMAajkAAD0AAD5AAEwANUJAAEpANUIANEVANT4ANStAAEIAAEUAAEdANTIANSsAADtAAENAAEcAaTsAAElAAEoAai9AAEJAAEMAAEZAaUBAAEIAai8AADJAAEAAAEJAAEVAAEYAakkAhBAyAAA+QABFAABKQIFTOUAAQgAAQkAASUAASgBpN0AAOQAAPgAAQEAAQgBqNkAANwAAQAAARUAAR0AASQBqNEAANgAAQ0AARQAAT0BpMUAAMkAANAAASkAATEAATwBqMQAAMgAANkAAPkAARwAASgAASkAATAA1RUBpRQAATEA1PgA1RkA1QwAARgAAR0A0RUAARwBqTACCcjYAAEoAgR4yQABCQABFQGoyAABOQGk3QGo3AAA7QAA+QABHQABOAGlCAABFAABFAABMQGo5QAA7AAA9QAA+AABGQABHAABKQGpGAABHQABJQABKAABMAGk5AAA7QAA9AABDQABHAABHQABJAGo2QABCQABDAABFQABHAABKQGk0QAA2AAA7AABCAABDQABFAABJQABKAGpDAABFQABJAABJQGo0AAA2QAA3QABCQABDQABFAABHQABJAGlAQABCAGo2AAA2QAA3AAA+QABDAABGQABHAGlAAABDQGo9QAA+AABGAGovQAA7QAA9AAA/QABCQABDAGk2AGo7QGk7AAA9QGovAAAzQAA7AAA7QAA9AAA/AGpHQGkxQAAzAAA7AAA9QABGQABHAIFTPQAAQkAARgAAR0BqL0AAMQAAPkAAQgAAQ0BqQEAAQgAARwBpLkAALwAAPUAAPgAAQkAAQwBqLgAANEAAO0AAQAAAQ0BpMUAAMkAANAAAPQAAQgAATEBqMUAAMgAAOkAAOwAAQwBqMQAAMQAAMkAAQkAATABpMgAANEAAOgBqNAAANEAAO0AAPkAAQEAAQgAAREBpLUAANAAAPUAAPgBqLQAAL0AAOwAAO0AAPQAAQAAAQkAARABqOwAAPUAAPkAAQEAAQgBpL0AAPQAAPgAAPkAAQAAAQkAASkBqLwAANEAAO0AAPgAAQ0BpLwAANAAAOUAAOwAAPUAAQEAAQgAAQwAASUAASgBqMkAAPQAAQAAAQkAASQAASkBqMUAAMgAAQEAAQgAASgAATEBpMQAAMkBqMgAANEAAN0AAOQAAO0AAQAAAQkAATACBUzQAADcAADsAAEIAAEpAakoAAf8vAA== sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaT5AAEJAAElAAEoAaj4AAEAAAEIAAEkAAEpAajdAADkAAEBAaTZAADcAADlAAEAAgVM2AAA4QAA5AABHQABJQABKAABMQGo4AAA+QABCQABFQABHAABJAGo+AABAQABCAABFAABHQABMAGk5QABFQABHAABJQIFTPkAAQkAASQCBVDkAAD4AAEIAAEUAAEdAAEpAaUAAAENAaj1AAEFAAEcAAEoAAExAaUMAAEVAaj0AAD5AAEEAAEwAAE5AajxAAExAAE4AaTdAADtAADwAAD4AAENAAEUAAEpAAEwAajsAAD1AAEoAAExAaTJAADcAADlAAEJAAEMAajkAAD0AAD5AAEwANUJAAEpANUIANEVANT4ANStAAEIAAEUAAEdANTIANSsAADtAAENAAEcAaTsAAElAAEoAai9AAEJAAEMAAEZAaUBAAEIAai8AADJAAEAAAEJAAEVAAEYAakkAhBAyAAA+QABFAABKQIFTOUAAQgAAQkAASUAASgBpN0AAOQAAPgAAQEAAQgBqNkAANwAAQAAARUAAR0AASQBqNEAANgAAQ0AARQAAT0BpMUAAMkAANAAASkAATEAATwBqMQAAMgAANkAAPkAARwAASgAASkAATAA1RUBpRQAATEA1PgA1RkA1QwAARgAAR0A0RUAARwBqTACCcjYAAEoAgR4yQABCQABFQGoyAABOQGk3QGo3AAA7QAA+QABHQABOAGlCAABFAABFAABMQGo5QAA7AAA9QAA+AABGQABHAABKQGpGAABHQABJQABKAABMAGk5AAA7QAA9AABDQABHAABHQABJAGo2QABCQABDAABFQABHAABKQGk0QAA2AAA7AABCAABDQABFAABJQABKAGpDAABFQABJAABJQGo0AAA2QAA3QABCQABDQABFAABHQABJAGlAQABCAGo2AAA2QAA3AAA+QABDAABGQABHAGlAAABDQGo9QAA+AABGAGovQAA7QAA9AAA/QABCQABDAGk2AGo7QGk7AAA9QGovAAAzQAA7AAA7QAA9AAA/AGpHQGkxQAAzAAA7AAA9QABGQABHAIFTPQAAQkAARgAAR0BqL0AAMQAAPkAAQgAAQ0BqQEAAQgAARwBpLkAALwAAPUAAPgAAQkAAQwBqLgAANEAAO0AAQAAAQ0BpMUAAMkAANAAAPQAAQgAATEBqMUAAMgAAOkAAOwAAQwBqMQAAMQAAMkAAQkAATABpMgAANEAAOgBqNAAANEAAO0AAPkAAQEAAQgAAREBpLUAANAAAPUAAPgBqLQAAL0AAOwAAO0AAPQAAQAAAQkAARABqOwAAPUAAPkAAQEAAQgBpL0AAPQAAPgAAPkAAQAAAQkAASkBqLwAANEAAO0AAPgAAQ0BpLwAANAAAOUAAOwAAPUAAQEAAQgAAQwAASUAASgBqMkAAPQAAQAAAQkAASQAASkBqMUAAMgAAQEAAQgAASgAATEBpMQAAMkBqMgAANEAAN0AAOQAAO0AAQAAAQkAATACBUzQAADcAADsAAEIAAEpAakoAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 0.92<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAAEpAajhAADkAADtAAD4AAEIAAEdAAEkAaTgAADlAADsAAEBAAEVAAEcAAElAaj5AAEkAaTkAAD4AAEAAAEJAAEoAakIAAElAajtAAEJAAEUAAEpAaUkAajsAAD1AAEVAAEoAgVNFAABMQIFTPQAAQgAATAAAUUBqUUBpO0AAR0AASkAAUEAAUQAAUQCBVDsAAD1AAEVAAEoAAExAAFAAAFFAaUcAAElAaj0AAD5AAEUAAEkAAEpAAEwAAE5AAFEAaVFAajtAAD4AAENAAE4AAE9AAFEAaj1AAEJAAEMAAEVAAEdAAEoAaTZAADsAAD0AAEcAAE8ANUNANUIANUMAAExANDYANTFAAEVANUUANTEAADJAAD5AAEUAAEdAaTIAADRAAD4AAENAajJAADQAAEJAAEMAAEVAAEcAAElAAEwAajFAADIAAEkAAEpAaTEAADJAAEIAAEdAAEoAajIAADtAAERAaTZAADsAAEUAajYAADlAAEBAAElAakcAaUAAAEJAAEQAakVAAEkAAEpAaThAADkAAEBAAEIAAEUAAEdAAEoAAExAakpAAEwAajgAADlAAEAAAEJAAEVAAEcAAElAAEoAgVM4QAA5AABFAABHQABJAABKQGlFQABHAGo2QAA4AABFAABGQGpEQABGAGk2AAA9QABAQABEAABFQGo0QAA7QAA9AAA+QABAAABKAABMQGk7AAA7QABCAABFAGo0AAA5QAA7AAA+AABJQABMAGoyQAA5AABHQABJAGkyAAA0QABAQABDQABHAABIQGo0AAA2QABAAABCQABDAABFQABIAABKQGk0QAA2AABAQABCAABDQABDQABFAABHQABKAGo3QAA8QABAAABAQABDAABDAABHAABIQGo0AAA8AABGQGkyQAA3AAA+QABAAABCQABGAABIAABKQGo9QAA+AGkyAAA2QAA7QAA9AABHQABKAGpFQABHAGo0QAA2AABCAABDQABFAABPQGk0AAA2QAA8QABKQABPAGo0QAA3QAA7AABDAABFQABKAGk0AAA2AAA8AABDQABFAGo3AAA7QAA+QGo3QAA8QABDAABMQGk2QAA7AAA+AGo2AAA3AABKQABMAGk5QGo3QAA5AAA7QAA8AABDQABKAABMQIFTNkAANwAAOwAAPkAAQwAARUAASkAATACBUzRAADYAAD4AAEBAAENAAEUAAEhAAEoAgVQyQAA0AAA5QAA+QABAAABDAABHQABIAGkyAAA0QAA3QAA+AGo0AAA3AAA5AAA8QABAQABDQABHAGkyQAA8AAA+QABAAABCQABDAABFQGoyAAA0QAA0QAA2QAA7QAA+AABAQABCAABDQGoyQAA0AAA0AAA5QAA7AABAAABCQABDAABFAGk2AABCAABFQGouQAA+QABDQABFAIFTMgCBUy4AADdAADlAAD1AAD4AAEBAAEMAajRAADcAADkAADlAaS1AADQAADdAADkAAD0AAD1AajkAAD0Aai0AADcAAEAAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAAEpAajhAADkAADtAAD4AAEIAAEdAAEkAaTgAADlAADsAAEBAAEVAAEcAAElAaj5AAEkAaTkAAD4AAEAAAEJAAEoAakIAAElAajtAAEJAAEUAAEpAaUkAajsAAD1AAEVAAEoAgVNFAABMQIFTPQAAQgAATAAAUUBqUUBpO0AAR0AASkAAUEAAUQAAUQCBVDsAAD1AAEVAAEoAAExAAFAAAFFAaUcAAElAaj0AAD5AAEUAAEkAAEpAAEwAAE5AAFEAaVFAajtAAD4AAENAAE4AAE9AAFEAaj1AAEJAAEMAAEVAAEdAAEoAaTZAADsAAD0AAEcAAE8ANUNANUIANUMAAExANDYANTFAAEVANUUANTEAADJAAD5AAEUAAEdAaTIAADRAAD4AAENAajJAADQAAEJAAEMAAEVAAEcAAElAAEwAajFAADIAAEkAAEpAaTEAADJAAEIAAEdAAEoAajIAADtAAERAaTZAADsAAEUAajYAADlAAEBAAElAakcAaUAAAEJAAEQAakVAAEkAAEpAaThAADkAAEBAAEIAAEUAAEdAAEoAAExAakpAAEwAajgAADlAAEAAAEJAAEVAAEcAAElAAEoAgVM4QAA5AABFAABHQABJAABKQGlFQABHAGo2QAA4AABFAABGQGpEQABGAGk2AAA9QABAQABEAABFQGo0QAA7QAA9AAA+QABAAABKAABMQGk7AAA7QABCAABFAGo0AAA5QAA7AAA+AABJQABMAGoyQAA5AABHQABJAGkyAAA0QABAQABDQABHAABIQGo0AAA2QABAAABCQABDAABFQABIAABKQGk0QAA2AABAQABCAABDQABDQABFAABHQABKAGo3QAA8QABAAABAQABDAABDAABHAABIQGo0AAA8AABGQGkyQAA3AAA+QABAAABCQABGAABIAABKQGo9QAA+AGkyAAA2QAA7QAA9AABHQABKAGpFQABHAGo0QAA2AABCAABDQABFAABPQGk0AAA2QAA8QABKQABPAGo0QAA3QAA7AABDAABFQABKAGk0AAA2AAA8AABDQABFAGo3AAA7QAA+QGo3QAA8QABDAABMQGk2QAA7AAA+AGo2AAA3AABKQABMAGk5QGo3QAA5AAA7QAA8AABDQABKAABMQIFTNkAANwAAOwAAPkAAQwAARUAASkAATACBUzRAADYAAD4AAEBAAENAAEUAAEhAAEoAgVQyQAA0AAA5QAA+QABAAABDAABHQABIAGkyAAA0QAA3QAA+AGo0AAA3AAA5AAA8QABAQABDQABHAGkyQAA8AAA+QABAAABCQABDAABFQGoyAAA0QAA0QAA2QAA7QAA+AABAQABCAABDQGoyQAA0AAA0AAA5QAA7AABAAABCQABDAABFAGk2AABCAABFQGouQAA+QABDQABFAIFTMgCBUy4AADdAADlAAD1AAD4AAEBAAEMAajRAADcAADkAADlAaS1AADQAADdAADkAAD0AAD1AajkAAD0Aai0AADcAAEAAAf8vAA== sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAAEpAajhAADkAADtAAD4AAEIAAEdAAEkAaTgAADlAADsAAEBAAEVAAEcAAElAaj5AAEkAaTkAAD4AAEAAAEJAAEoAakIAAElAajtAAEJAAEUAAEpAaUkAajsAAD1AAEVAAEoAgVNFAABMQIFTPQAAQgAATAAAUUBqUUBpO0AAR0AASkAAUEAAUQAAUQCBVDsAAD1AAEVAAEoAAExAAFAAAFFAaUcAAElAaj0AAD5AAEUAAEkAAEpAAEwAAE5AAFEAaVFAajtAAD4AAENAAE4AAE9AAFEAaj1AAEJAAEMAAEVAAEdAAEoAaTZAADsAAD0AAEcAAE8ANUNANUIANUMAAExANDYANTFAAEVANUUANTEAADJAAD5AAEUAAEdAaTIAADRAAD4AAENAajJAADQAAEJAAEMAAEVAAEcAAElAAEwAajFAADIAAEkAAEpAaTEAADJAAEIAAEdAAEoAajIAADtAAERAaTZAADsAAEUAajYAADlAAEBAAElAakcAaUAAAEJAAEQAakVAAEkAAEpAaThAADkAAEBAAEIAAEUAAEdAAEoAAExAakpAAEwAajgAADlAAEAAAEJAAEVAAEcAAElAAEoAgVM4QAA5AABFAABHQABJAABKQGlFQABHAGo2QAA4AABFAABGQGpEQABGAGk2AAA9QABAQABEAABFQGo0QAA7QAA9AAA+QABAAABKAABMQGk7AAA7QABCAABFAGo0AAA5QAA7AAA+AABJQABMAGoyQAA5AABHQABJAGkyAAA0QABAQABDQABHAABIQGo0AAA2QABAAABCQABDAABFQABIAABKQGk0QAA2AABAQABCAABDQABDQABFAABHQABKAGo3QAA8QABAAABAQABDAABDAABHAABIQGo0AAA8AABGQGkyQAA3AAA+QABAAABCQABGAABIAABKQGo9QAA+AGkyAAA2QAA7QAA9AABHQABKAGpFQABHAGo0QAA2AABCAABDQABFAABPQGk0AAA2QAA8QABKQABPAGo0QAA3QAA7AABDAABFQABKAGk0AAA2AAA8AABDQABFAGo3AAA7QAA+QGo3QAA8QABDAABMQGk2QAA7AAA+AGo2AAA3AABKQABMAGk5QGo3QAA5AAA7QAA8AABDQABKAABMQIFTNkAANwAAOwAAPkAAQwAARUAASkAATACBUzRAADYAAD4AAEBAAENAAEUAAEhAAEoAgVQyQAA0AAA5QAA+QABAAABDAABHQABIAGkyAAA0QAA3QAA+AGo0AAA3AAA5AAA8QABAQABDQABHAGkyQAA8AAA+QABAAABCQABDAABFQGoyAAA0QAA0QAA2QAA7QAA+AABAQABCAABDQGoyQAA0AAA0AAA5QAA7AABAAABCQABDAABFAGk2AABCAABFQGouQAA+QABDQABFAIFTMgCBUy4AADdAADlAAD1AAD4AAEBAAEMAajRAADcAADkAADlAaS1AADQAADdAADkAAD0AAD1AajkAAD0Aai0AADcAAEAAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 1.0<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFAQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AAA+QGk2QAA9QAA+AABAQABGQABHAABJAABMAIFTNgAAO0AAPQAAQkAARgAASkCBVEVAAElAAEoAaUdAAEkAajRAADsAADtAAEAAAEIAAENAAERAAEUAAEZAAEcAgVM0AAA2QAA7AAA9QABCQABDAABEAABGAABGQIFTO0AAPQAARgAASkBqNgBpOEAAO0AASgAATEBqNEAAOAAAOwAASkAATABqNAAANkAAOwAAPUAAQgAARUAASgAASkBpMUAANgAAPQAAQEAARQBqL0AAMQAAPkAAQAAAR0AASgBpLwAAPgAARwAASkBqOUAAPUAAQEAARUBqJ0AAQkAAREAARQAASgBpOQAAQAAAQEAAQgAARAAARUBqJwAAOEAAO0AAP0AAQAAAQkAARQBpNkAAOAAAOUAAOwAAPwA1OQAAOUA1NEAANgAAOQAAO0AAPQAAREBqOwAAPUAAQUBpPQAAP0AAP0AAQQAAQgBqL0AAMUAANAAAPwAAPwAAQEAAQkBpLwAAMQAAMUAAPUAAQAAAQgAARAAARkBqMQAANkAAO0AAPQA1OwA1M0AANgAANkAAPUAARgAAR0BpMwAANEAAPQAAP0BqNAAAN0AAPUAAPwAARkAARwCBUzRAADcAADtAAD0AAERAAEYAai5AADhAAEFAaTQAADgAADsAAD1AAENAAEQAaixAAC4AADxAAD0AaSwAAC5AADpAADwAAD5AAEFAAEMAajYAAEEAgj0nQAAuAAA+AAA/QABBAABCQGk5QAA6AABBQABCAGonAAAuQAAzQAA9QAA/AABBAABCQGouAAAwQGkwAAAxQAAzAAAzQAA9AAA/QABCAABmQGowQAAxAAA/AGkuQAAwAAAzAAA6QIFULgAAL0AAOgAAO0AAP0AAZgBpOUAAOwBqKEAALwAAOQAAOQAAO0AAPwAAQUAARECBUygAACpAADFAADpAADsAAEEAAEJAAEQAaioAACxAAC9AADEAADoAADtAaSwAAC5AAC8AADFAADsAAD1AAEBAAEIAakAAAEFAaSpAAC4AADEAADpAAD0AAEEAAEJAgVQqAAAsQAA6AAA7QAA/QABCAABEQIFTLAAALkAAOkAAOwAAPkAAPwAAQkAARACBUzhAADoAADtAAD4AAEFAAEIAaj9AAEEAaTZAADgAADpAADsAAD1AAD8AAEJAajFAADYAaS9AADEAADNAADoAAEIAai8AADFAADMAAD1AAEFAai4AAC9AADEAADtAAD0AAD0AaS5AAC8AADpAADsAAD1AAD9AAEEAaj0AAEJAaSlAACxAAC4AADoAADxAAD8AAEFAAEIAajwAAD1AaidAACkAACwAADZAADtAAD0AAD9AAEEAaScAAClAADhAADsAaikAADFAADgAADpAAD1AAD8AaTRAADYAaiNAADEAADQAADoAAD0AaiMAAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFAQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AAA+QGk2QAA9QAA+AABAQABGQABHAABJAABMAIFTNgAAO0AAPQAAQkAARgAASkCBVEVAAElAAEoAaUdAAEkAajRAADsAADtAAEAAAEIAAENAAERAAEUAAEZAAEcAgVM0AAA2QAA7AAA9QABCQABDAABEAABGAABGQIFTO0AAPQAARgAASkBqNgBpOEAAO0AASgAATEBqNEAAOAAAOwAASkAATABqNAAANkAAOwAAPUAAQgAARUAASgAASkBpMUAANgAAPQAAQEAARQBqL0AAMQAAPkAAQAAAR0AASgBpLwAAPgAARwAASkBqOUAAPUAAQEAARUBqJ0AAQkAAREAARQAASgBpOQAAQAAAQEAAQgAARAAARUBqJwAAOEAAO0AAP0AAQAAAQkAARQBpNkAAOAAAOUAAOwAAPwA1OQAAOUA1NEAANgAAOQAAO0AAPQAAREBqOwAAPUAAQUBpPQAAP0AAP0AAQQAAQgBqL0AAMUAANAAAPwAAPwAAQEAAQkBpLwAAMQAAMUAAPUAAQAAAQgAARAAARkBqMQAANkAAO0AAPQA1OwA1M0AANgAANkAAPUAARgAAR0BpMwAANEAAPQAAP0BqNAAAN0AAPUAAPwAARkAARwCBUzRAADcAADtAAD0AAERAAEYAai5AADhAAEFAaTQAADgAADsAAD1AAENAAEQAaixAAC4AADxAAD0AaSwAAC5AADpAADwAAD5AAEFAAEMAajYAAEEAgj0nQAAuAAA+AAA/QABBAABCQGk5QAA6AABBQABCAGonAAAuQAAzQAA9QAA/AABBAABCQGouAAAwQGkwAAAxQAAzAAAzQAA9AAA/QABCAABmQGowQAAxAAA/AGkuQAAwAAAzAAA6QIFULgAAL0AAOgAAO0AAP0AAZgBpOUAAOwBqKEAALwAAOQAAOQAAO0AAPwAAQUAARECBUygAACpAADFAADpAADsAAEEAAEJAAEQAaioAACxAAC9AADEAADoAADtAaSwAAC5AAC8AADFAADsAAD1AAEBAAEIAakAAAEFAaSpAAC4AADEAADpAAD0AAEEAAEJAgVQqAAAsQAA6AAA7QAA/QABCAABEQIFTLAAALkAAOkAAOwAAPkAAPwAAQkAARACBUzhAADoAADtAAD4AAEFAAEIAaj9AAEEAaTZAADgAADpAADsAAD1AAD8AAEJAajFAADYAaS9AADEAADNAADoAAEIAai8AADFAADMAAD1AAEFAai4AAC9AADEAADtAAD0AAD0AaS5AAC8AADpAADsAAD1AAD9AAEEAaj0AAEJAaSlAACxAAC4AADoAADxAAD8AAEFAAEIAajwAAD1AaidAACkAACwAADZAADtAAD0AAD9AAEEAaScAAClAADhAADsAaikAADFAADgAADpAAD1AAD8AaTRAADYAaiNAADEAADQAADoAAD0AaiMAAf8vAA== sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFAQDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AAA+QGk2QAA9QAA+AABAQABGQABHAABJAABMAIFTNgAAO0AAPQAAQkAARgAASkCBVEVAAElAAEoAaUdAAEkAajRAADsAADtAAEAAAEIAAENAAERAAEUAAEZAAEcAgVM0AAA2QAA7AAA9QABCQABDAABEAABGAABGQIFTO0AAPQAARgAASkBqNgBpOEAAO0AASgAATEBqNEAAOAAAOwAASkAATABqNAAANkAAOwAAPUAAQgAARUAASgAASkBpMUAANgAAPQAAQEAARQBqL0AAMQAAPkAAQAAAR0AASgBpLwAAPgAARwAASkBqOUAAPUAAQEAARUBqJ0AAQkAAREAARQAASgBpOQAAQAAAQEAAQgAARAAARUBqJwAAOEAAO0AAP0AAQAAAQkAARQBpNkAAOAAAOUAAOwAAPwA1OQAAOUA1NEAANgAAOQAAO0AAPQAAREBqOwAAPUAAQUBpPQAAP0AAP0AAQQAAQgBqL0AAMUAANAAAPwAAPwAAQEAAQkBpLwAAMQAAMUAAPUAAQAAAQgAARAAARkBqMQAANkAAO0AAPQA1OwA1M0AANgAANkAAPUAARgAAR0BpMwAANEAAPQAAP0BqNAAAN0AAPUAAPwAARkAARwCBUzRAADcAADtAAD0AAERAAEYAai5AADhAAEFAaTQAADgAADsAAD1AAENAAEQAaixAAC4AADxAAD0AaSwAAC5AADpAADwAAD5AAEFAAEMAajYAAEEAgj0nQAAuAAA+AAA/QABBAABCQGk5QAA6AABBQABCAGonAAAuQAAzQAA9QAA/AABBAABCQGouAAAwQGkwAAAxQAAzAAAzQAA9AAA/QABCAABmQGowQAAxAAA/AGkuQAAwAAAzAAA6QIFULgAAL0AAOgAAO0AAP0AAZgBpOUAAOwBqKEAALwAAOQAAOQAAO0AAPwAAQUAARECBUygAACpAADFAADpAADsAAEEAAEJAAEQAaioAACxAAC9AADEAADoAADtAaSwAAC5AAC8AADFAADsAAD1AAEBAAEIAakAAAEFAaSpAAC4AADEAADpAAD0AAEEAAEJAgVQqAAAsQAA6AAA7QAA/QABCAABEQIFTLAAALkAAOkAAOwAAPkAAPwAAQkAARACBUzhAADoAADtAAD4AAEFAAEIAaj9AAEEAaTZAADgAADpAADsAAD1AAD8AAEJAajFAADYAaS9AADEAADNAADoAAEIAai8AADFAADMAAD1AAEFAai4AAC9AADEAADtAAD0AAD0AaS5AAC8AADpAADsAAD1AAD9AAEEAaj0AAEJAaSlAACxAAC4AADoAADxAAD8AAEFAAEIAajwAAD1AaidAACkAACwAADZAADtAAD0AAD9AAEEAaScAAClAADhAADsAaikAADFAADgAADpAAD1AAD8AaTRAADYAaiNAADEAADQAADoAAD0AaiMAAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 1.2<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AABCQABHAABJQGk1QAA9QABCAABGQABJAABJAABMAIFTNQAARgAATUAAUECBVDZAAFAAAFFAgVM2AAA4QAA9AABHQABNAIFTNEAAOAAAQ0AARkAARwAAUQAAUkCBUzQAADRAAEYAAEhAAFFAAFIAgVMwQAA0AAA8QABMQABRAGowAAA1QABDAABEQABIAGo1AAA6QAA8AABDQABEAABGQABJQABMAGlCQABDAGowQAA6AABBQABCAABDQABFQABGAABIQABJAIMmMAAAPEAAQwAASACBUzwAAEEAAEUAAExAAE9AakpAAE8AAFZAakFAAEhAAEoAAEwAAFFAaVEAAFJAAFYAaidAAEgAAElAAFIAAFJAaU5AAFIAaicAADhAAE4AAFBAakEAaTVAADgAAERAAEhAAEtAAFAANUsAAE1ANTUAADpAAElAAE0AaUFAAEgAAEkAAEkAAFJAakEAAENAAEtAAFIAajoAAD9AAEQAaTJAADxAAD8AAEZAAEsAajwAAEYAAE1AaTIAAD5AAH9AakMAAH8AAH9ANX9ANT4AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANU0AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8ANX8AAf8vAA==&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AABCQABHAABJQGk1QAA9QABCAABGQABJAABJAABMAIFTNQAARgAATUAAUECBVDZAAFAAAFFAgVM2AAA4QAA9AABHQABNAIFTNEAAOAAAQ0AARkAARwAAUQAAUkCBUzQAADRAAEYAAEhAAFFAAFIAgVMwQAA0AAA8QABMQABRAGowAAA1QABDAABEQABIAGo1AAA6QAA8AABDQABEAABGQABJQABMAGlCQABDAGowQAA6AABBQABCAABDQABFQABGAABIQABJAIMmMAAAPEAAQwAASACBUzwAAEEAAEUAAExAAE9AakpAAE8AAFZAakFAAEhAAEoAAEwAAFFAaVEAAFJAAFYAaidAAEgAAElAAFIAAFJAaU5AAFIAaicAADhAAE4AAFBAakEAaTVAADgAAERAAEhAAEtAAFAANUsAAE1ANTUAADpAAElAAE0AaUFAAEgAAEkAAEkAAFJAakEAAENAAEtAAFIAajoAAD9AAEQAaTJAADxAAD8AAEZAAEsAajwAAEYAAE1AaTIAAD5AAH9AakMAAH8AAH9ANX9ANT4AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANU0AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8ANX8AAf8vAA== sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE/gDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAEkAAEpAaTdAAEBAajZAADcAADlAAEAAgVM2AAA3QAA5AABHQABJQABKAABMQGo3AABCQABHAABJQGk1QAA9QABCAABGQABJAABJAABMAIFTNQAARgAATUAAUECBVDZAAFAAAFFAgVM2AAA4QAA9AABHQABNAIFTNEAAOAAAQ0AARkAARwAAUQAAUkCBUzQAADRAAEYAAEhAAFFAAFIAgVMwQAA0AAA8QABMQABRAGowAAA1QABDAABEQABIAGo1AAA6QAA8AABDQABEAABGQABJQABMAGlCQABDAGowQAA6AABBQABCAABDQABFQABGAABIQABJAIMmMAAAPEAAQwAASACBUzwAAEEAAEUAAExAAE9AakpAAE8AAFZAakFAAEhAAEoAAEwAAFFAaVEAAFJAAFYAaidAAEgAAElAAFIAAFJAaU5AAFIAaicAADhAAE4AAFBAakEAaTVAADgAAERAAEhAAEtAAFAANUsAAE1ANTUAADpAAElAAE0AaUFAAEgAAEkAAEkAAFJAakEAAENAAEtAAFIAajoAAD9AAEQAaTJAADxAAD8AAEZAAEsAajwAAEYAAE1AaTIAAD5AAH9AakMAAH8AAH9ANX9ANT4AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANU0AAH8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANX8AAH9ANH8AAH9ANX8AAH9ANX8AAH9ANX8ANX8AAf8vAA== type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin:0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #222; /* Dark background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #6c7a89; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #00a; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #333; /* Dark background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #7aa6ed; /*  blue for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #d586d0; /* purple for Instrument 2 for consistency */
  stroke: #444; /* White stroke for visibility */
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: brightorange; 
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ddd; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Temperature = 1.5<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE9wDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAENAAEZAaTlAAEBAAEVAAEYAAEkAgVNAAABAQABBQABFAABFQGo5AAA6QABDAABFAGo6AAA8QABAAGk8AABJQGo1QABAQABGQDVBADQ1AAA5QABFQABJAGpFAABGAABIQIFTQ0AASAAATEBqOQAAQwAAR0AASEAATABpQAAAQ0BqN0AAO0AARwBqSAAATEBpMkAANwAAOwAAQUAASkBqPEAASgAATAAATEBpN0AAO0AAPAAAQQAAQwAAQ0BqMgAANwAAOUAAOwAAPEAAQwAARUBqN0AAOQAASkAATABpNwAAN0AAOkAAPAAAQ0AARQBqNkAANwAAOgAAQwAARUBpRQA1MkAAPkAASkA1SgA1MgAAOUAAPEAAPgAAQ0A1NgA0QEAASgBqN0AAOQAAQAAAQUAAQwAARUBqQEAARQAARUBpJ0AANwAAO0AAQAAAQQAAQkAAQkAARQBqJwAAKEAAPAAAQgAAQ0A1OUAAQwA0KAAAL0AAOQAAPkBqPgAAPkBqOwAAPUAAPgAAQgAAQ0AARkBpLwAAPQAAP0AAQEBqPwAAQAAARkBpMkAAQkAARgBqMgAANEAAO0AARgBqQwBpNAAANkAATEBqT0BpM0AANgAAN0BqMwAATAAAf0A1f0A1fwAAf0A0fwAAf0A1QgAAfwAAf0A1fwAAf0A1OwAATwAAfwAAf0A1fwAAf0A0NwAAfwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1ZkAAfwA1fwAAf0A1ZgAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwA1fwAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE9wDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAENAAEZAaTlAAEBAAEVAAEYAAEkAgVNAAABAQABBQABFAABFQGo5AAA6QABDAABFAGo6AAA8QABAAGk8AABJQGo1QABAQABGQDVBADQ1AAA5QABFQABJAGpFAABGAABIQIFTQ0AASAAATEBqOQAAQwAAR0AASEAATABpQAAAQ0BqN0AAO0AARwBqSAAATEBpMkAANwAAOwAAQUAASkBqPEAASgAATAAATEBpN0AAO0AAPAAAQQAAQwAAQ0BqMgAANwAAOUAAOwAAPEAAQwAARUBqN0AAOQAASkAATABpNwAAN0AAOkAAPAAAQ0AARQBqNkAANwAAOgAAQwAARUBpRQA1MkAAPkAASkA1SgA1MgAAOUAAPEAAPgAAQ0A1NgA0QEAASgBqN0AAOQAAQAAAQUAAQwAARUBqQEAARQAARUBpJ0AANwAAO0AAQAAAQQAAQkAAQkAARQBqJwAAKEAAPAAAQgAAQ0A1OUAAQwA0KAAAL0AAOQAAPkBqPgAAPkBqOwAAPUAAPgAAQgAAQ0AARkBpLwAAPQAAP0AAQEBqPwAAQAAARkBpMkAAQkAARgBqMgAANEAAO0AARgBqQwBpNAAANkAATEBqT0BpM0AANgAAN0BqMwAATAAAf0A1f0A1fwAAf0A0fwAAf0A1QgAAfwAAf0A1fwAAf0A1OwAATwAAfwAAf0A1fwAAf0A0NwAAfwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1ZkAAfwA1fwAAf0A1ZgAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwA1fwAB/y8A sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAE9wDAAACQNkAAPUAAQkAARUBqPQAAPkBpNgAAPUAAPgAAQEAAQgBqQkBpO0AAPQAAPkAAQAAAQgAAREAARQAATEBqOUAAOwAAPUAAPgAARAAARUBqOEAAOQAAO0AAPQAARQAAR0CBUzgAADlAADsAAEBAAEcAAEpAAEwAaUoAaj5AAEAAAEJAAElAajkAAD4AAEIAAENAAEZAaTlAAEBAAEVAAEYAAEkAgVNAAABAQABBQABFAABFQGo5AAA6QABDAABFAGo6AAA8QABAAGk8AABJQGo1QABAQABGQDVBADQ1AAA5QABFQABJAGpFAABGAABIQIFTQ0AASAAATEBqOQAAQwAAR0AASEAATABpQAAAQ0BqN0AAO0AARwBqSAAATEBpMkAANwAAOwAAQUAASkBqPEAASgAATAAATEBpN0AAO0AAPAAAQQAAQwAAQ0BqMgAANwAAOUAAOwAAPEAAQwAARUBqN0AAOQAASkAATABpNwAAN0AAOkAAPAAAQ0AARQBqNkAANwAAOgAAQwAARUBpRQA1MkAAPkAASkA1SgA1MgAAOUAAPEAAPgAAQ0A1NgA0QEAASgBqN0AAOQAAQAAAQUAAQwAARUBqQEAARQAARUBpJ0AANwAAO0AAQAAAQQAAQkAAQkAARQBqJwAAKEAAPAAAQgAAQ0A1OUAAQwA0KAAAL0AAOQAAPkBqPgAAPkBqOwAAPUAAPgAAQgAAQ0AARkBpLwAAPQAAP0AAQEBqPwAAQAAARkBpMkAAQkAARgBqMgAANEAAO0AARgBqQwBpNAAANkAATEBqT0BpM0AANgAAN0BqMwAATAAAf0A1f0A1fwAAf0A0fwAAf0A1QgAAfwAAf0A1fwAAf0A1OwAATwAAfwAAf0A1fwAAf0A0NwAAfwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1ZkAAfwA1fwAAf0A1ZgAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A1fwAAf0A0fwAAf0A1fwAAf0A1fwAAf0A1fwA1fwAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
</section>
<section id="perplexity-score" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="perplexity-score"><span class="header-section-number">8.2</span> Perplexity Score</h2>
<p>“<a href="https://blog.echen.me/2021/12/23/a-laymans-introduction-to-perplexity-in-nlp/">Perplexity</a>” is a common metric for language models; it comes from the field of information theory. Perplexity is often described as a measure of how “surprised” your model is by novel data.<br>
Operationally, it’s just the exponential of the value of the (cross-entropy) loss function – like, …yea, that’s it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why do people report perplexity scores instead of just cross-entropy loss values (since the exponential function is monotonic)? Well…because of custom, and because perplexity has some natural relation to entropy (but so does cross-entropy, so…?), and because it relates to something called the “branching factor” of a language… But “because custom” is enough.</p>
</div>
</div>
<p>So, all we’re going to do is feed the test set into our model, measure the loss, and take the exponential of that and that’s our perplexity! Lower scores are better.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">test_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NotesDataset(test_notes_tl, config.seq_length, len_mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.batch_size, pad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb42-2">test_dl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(train_ds, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config.batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb42-3"></span>
<span id="cb42-4">total, batches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> </span>
<span id="cb42-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb42-6">    model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb42-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(test_dl, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)): </span>
<span id="cb42-8">        batches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> </span>
<span id="cb42-9">        xb, yb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [q.to(device) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> q <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> batch]</span>
<span id="cb42-10">        logits, loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(xb, yb)</span>
<span id="cb42-11">        total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> loss.cpu().item()</span>
<span id="cb42-12">perplexity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>batches) </span>
<span id="cb42-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"(Average) Perplexity = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>perplexity<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:5.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>100%|█████████████████████████████████████████████████████████████| 229/229 [00:08&lt;00:00, 26.95it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(Average) Perplexity = 2.622</code></pre>
</div>
</div>
<p>Interesting. That seems really low to me. Perhaps all it means is that once you’ve seen a couple hundred Bach chorales, new ones aren’t very surprising! ;-)</p>
</section>
<section id="accuracy-score" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="accuracy-score"><span class="header-section-number">8.3</span> Accuracy Score</h2>
<p>How often did the model guess the “correct” next note?</p>
<p><em>…Uh… sorry folks, I ran out of time on this one. Left as an exercise. ;-)</em></p>
</section>
<section id="data-distributions" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="data-distributions"><span class="header-section-number">8.4</span> Data Distributions</h2>
<p>Let’s compare statistics of true notes from the test set vs.&nbsp;our generated notes. We’ll generate a lot of data, and then compare histograms of the codebook indices:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">redo_datadist_calc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb45-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> redo_datadist_calc:</span>
<span id="cb45-3">    all_test_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.vstack([encode(t) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> test_notes_tl]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(torch.float32)</span>
<span id="cb45-4">    all_test_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> all_test_notes[:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(all_test_notes)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to save time, let's not do stats on ALL-all of them, just a quarter</span></span>
<span id="cb45-5"></span>
<span id="cb45-6">    </span>
<span id="cb45-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate a big batch of fake data. </span></span>
<span id="cb45-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">WARNING</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: this is super slow because our generator only works for batches of one, oops</span></span>
<span id="cb45-9">    prompt_len, max_new_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54</span>          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I just made these numbers up. not great science yet, sorry.</span></span>
<span id="cb45-10">    new_notes_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb45-11">    set_seeds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb45-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generating new notes..."</span>) </span>
<span id="cb45-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, notes <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(test_notes_tl, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)): </span>
<span id="cb45-14">        ptoks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(notes[:prompt_len]).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(device)</span>
<span id="cb45-15">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate more notes, chop off prompt before adding to list of all generated notes</span></span>
<span id="cb45-16">        new_notes_list.append( model.generate(ptoks, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_new_tokens)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].cpu()[prompt_len:]  )</span>
<span id="cb45-17">    all_new_notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.vstack(new_notes_list).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(torch.float32)</span>
<span id="cb45-18"></span>
<span id="cb45-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"# of test notes = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(all_test_notes)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,  # of generated notes = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(all_new_notes)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> --- Close enough!"</span>)</span>
<span id="cb45-20"></span>
<span id="cb45-21"></span>
<span id="cb45-22">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb45-23">names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pitch'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'duration'</span>]</span>
<span id="cb45-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb45-25">    bins <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span>
<span id="cb45-26">    ax[i].hist(all_test_notes[:,i].numpy(), bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>bins, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'test indices'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span>
<span id="cb45-27">    ax[i].hist(all_new_notes[:,i].numpy(),  bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>bins, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'generated indices'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span>
<span id="cb45-28"></span>
<span id="cb45-29">    ax[i].set_title(names[i])</span>
<span id="cb45-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: ax[i].legend()</span>
<span id="cb45-31">    ax[i].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Value'</span>)</span>
<span id="cb45-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: ax[i].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Count'</span>)</span>
<span id="cb45-33">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating new notes...
# of test notes = 4159,  # of generated notes = 4158 --- Close enough!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|███████████████████████████████████████████████████████████████| 77/77 [02:05&lt;00:00,  1.63s/it]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/Transformers2-MusicBox_files/figure-html/cell-30-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>Hey! The generated and test data distributions look pretty similar. The generated pitches have a slightly larger spread, which is consistent with what we observe in the generated examples, and may be due to the pitch-shifting in our data augmentation.</p>
</section>
</section>
<section id="summary-and-faq" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Summary and FAQ</h1>
<p>We have delved into all the parts of the “classic” Transformer model architecture beyond just the Attention mechanism covered in the <a href="https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html">“Part 1”</a> lesson. Transformers and the Attention mechanism itself have both received a number of significant “updates” over the years, and we’ve seen “challenger” architectures appear. It may be that some new method will utterly unseat Transformers as the “SOTA” scheme, however Transformers will likely continue to be an important part of the “vocabulary” of model architectures, and thus studying them as an educational exercise is rewarding.</p>
<p>Avoiding the typical example of text generation, we chose to do MIDI generation, taking our cues from the many successes of the Google Magenta team. MIDI data has some particularities that make it different from many other common data types, notably the “free floating” nature of the <em>timing</em> information. This proved to be a major (and unforeseen) challenge in developing the code for this lesson. In the end, we chose the relatively “easy” task of continuing Bach chorales – btw, a tradition in AI-music that goes back to at least the 1970s, if not the 1950s – and found that the results were tolerable.</p>
<p>In the section that follows below, we provide some suggestions for further study. In particular, the fact that this project involved making predictions using multiple codebooks helps it generalize to complex datatypes such as video and audio. Overall, the development of this lesson was a great opportunity for self-education by the author! Thanks for joining me.</p>
<p>Finally, an <strong>Invitation:</strong> If you have suggestions for improvements or critiques of this lesson, <em>please write to me!</em> I’m not an NLP or MIDI specialist and I want to learn more. Find me on social media as @drscotthawley and/or you can get contact info from my university page: https://hawley.belmont.edu</p>
<section id="faq" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="faq"><span class="header-section-number">9.1</span> FAQ</h2>
<p><strong>Q: Can we have a Colab with just the code from this lesson?</strong><br> A: Sure! <a href="https://colab.research.google.com/github/drscotthawley/TTTT/blob/main/notebooks/Transformers2-MusicBox-Colab.ipynb">Here it is</a>. &nbsp; <a href="https://colab.research.google.com/github/drscotthawley/TTTT/blob/main/notebooks/Transformers2-MusicBox-Colab.ipynb"> <img src="https://drscotthawley.github.io/blog/posts/https:/colab.research.google.com/assets/colab-badge.svg" alt="open with Colab" width="130px"></a><br> <br> <strong>Q: If the Transformer is predicting “chunks” of tokens at a time, couldn’t we do faster autoregressive generation by predicting multiple tokens ahead (instead of just one at a time)?</strong> <br> A: Well, for starters, recall that our target data for “teacher forcing” is only shifted one token ahead, so you’d need to change that first. After that,…you’re welcome to try it, but… I don’t see people doing this much. There are probably “good reasons” of stability or “the curse of dimensionality” (so speculates Jeremy Jordan) for why this isn’t common practice.<br> <br> <strong>Q: What about the ethics of sourcing your dataset?</strong><br> A: Bach’s works are in the public domain, and these MIDI files don’t seem to taken from recorded performances, rather they seem to be taken from digitized versions of the sheet music. Tracing back through the history of papers using this dataset, even before the oft-cited 2012 work by <a href="https://arxiv.org/pdf/1206.6392.pdf">Boulanger-Lewandowski, Bengio, and Vincent</a>, I find earliest mention from Allan &amp; Williams, who don’t give us more than a mention of a URL, and there the trail ends:</p>
<blockquote cite="https://papers.nips.cc/paper_files/paper/2004/file/b628386c9b92481fab68fbf284bd6a64-Paper.pdf" class="blockquote">
<p>
We used a computer-readable edition of Bach’s chorales downloaded from <a href="ftp://i11ftp.ira.uka.de/pub/neuro/dominik/midifiles/bach.zip">ftp://i11ftp.ira.uka.de/pub/neuro/dominik/midifiles/bach.zip</a>
</p>
<footer>
—Allan &amp; Williams, <cite><a href="https://papers.nips.cc/paper_files/paper/2004/file/b628386c9b92481fab68fbf284bd6a64-Paper.pdf">“Harmonising chorales by probabilistic inference,”</a> NIPS 2004</cite>
</footer>
</blockquote>
</section>
</section>
<section id="sec-further" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Ideas for Further Exploration</h1>
The following are some ideas for taking this lesson further.
<details>
<summary>
Details
</summary>
<section id="change-hyperparamters-dataset" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="change-hyperparamters-dataset"><span class="header-section-number">10.1</span> Change Hyperparamters / Dataset</h2>
<p>I tried a <em>lot</em> of hyperparameter tuning already. Now it’s your turn. Maybe even trying WandB’s <a href="https://docs.wandb.ai/guides/sweeps">“Sweeps”</a>feature. Here’s a <code>config</code> suggestion <a href="https://wandb.ai/drscotthawley/musicbox-maestro-tutorial?workspace=user-drscotthawley">that I used for the MAESTRO dataset</a>:</p>
<div class="cell">
<details>
<summary>Watch out, there’s a Monster in this code!</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb48-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> LargeConfig:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "Monster" size model ;-) </span></span>
<span id="cb48-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># model architecture details</span></span>
<span id="cb48-4">    seq_length: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span></span>
<span id="cb48-5">    batch_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span></span>
<span id="cb48-6">    n_embd:     <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>     </span>
<span id="cb48-7">    n_heads:    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>      </span>
<span id="cb48-8">    n_blocks:   <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>       </span>
<span id="cb48-9">    dropout:  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>    </span>
<span id="cb48-10">    bias:      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb48-11">    use_alibi: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb48-12"></span>
<span id="cb48-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training details</span></span>
<span id="cb48-14">    learning_rate: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb48-15">    weight_decay:  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 0.01 is pytorch default</span></span>
<span id="cb48-16">    epochs:          <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb48-17"></span>
<span id="cb48-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># other handy bookkeeping</span></span>
<span id="cb48-19">    vocab_sizes: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(vocab_sizes)</span></code></pre></div>
</details>
</div>
</section>
<section id="report-individual-parts-of-the-loss" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="report-individual-parts-of-the-loss"><span class="header-section-number">10.2</span> Report Individual Parts of the Loss</h2>
<p>Currently we’re not reporting the contributions of pitch, step, and durations to the loss, separately. Doing so should be instructive! (My older codes had this, I just didn’t get around to putting it back in after a major rewrite.)</p>
</section>
<section id="improving-generation-by-implementing-beam-search" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="improving-generation-by-implementing-beam-search"><span class="header-section-number">10.3</span> Improving Generation by Implementing Beam Search</h2>
<p>Right now we’re just sampling a single token from the predicted probability distribution. If we instead predicted the most likely estimates by looking two or three steps into the future, that could greatly improve our results. Check out “<a href="https://towardsdatascience.com/foundations-of-nlp-explained-visually-beam-search-how-it-works-1586b9849a24">beam search</a>” algorithms.</p>
</section>
<section id="using-huggingfaces-transformers-instead" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="using-huggingfaces-transformers-instead"><span class="header-section-number">10.4</span> Using Huggingface’s <code>transformers</code> instead</h2>
<p><a href="https://github.com/huggingface/transformers"><code>transformers</code></a> is a package that is optimized for general applications and would likely outperform the above code in numerous ways: parallelism, mixed-precision training, &amp; more.</p>
</section>
<section id="pitch-only-estimation" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="pitch-only-estimation"><span class="header-section-number">10.5</span> Pitch-Only Estimation</h2>
<p>The timing can be the most challenging part. If you take that out and do only pitches (i.e.&nbsp;assume all notes have the same spacing and duration), you may like what you hear.</p>
</section>
<section id="raw-audio" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="raw-audio"><span class="header-section-number">10.6</span> Raw Audio</h2>
<p>If you were to instead use raw audio, I’d recommend converting it to spectrograms, treating each column of the spectrogram as a “word vector.” However, there’d likely be a lot of “wasted space” so you’d probably want to (invertibly) compress the dimensionality of your “audio-word vectors” via something like <a href="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ.html">(Residual) Vector Quantization</a>, an <a href="https://drscotthawley.github.io/audio-algebra/given-models.html">autoencoder</a>, or <a href="https://umap-learn.readthedocs.io/en/latest/">UMAP</a>. …And then you’d need to expand/decode it on the output side to be able to listen. Relatedly, a pretrained system like Meta’s <a href="https://github.com/facebookresearch/encodec">EnCodec</a> would likely provide such functions nicely.</p>
</section>
<section id="penalize-generation-of-end-of-song-padding" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="penalize-generation-of-end-of-song-padding"><span class="header-section-number">10.7</span> Penalize Generation of “End of Song” Padding?</h2>
<p>You’ll notice that in some of the examples, the generated song will reach its end really quickly and then just print out repeated <code>REST_NOTE</code>s, which is my current way of denoting the end of a song. Perhaps we could penalize the model for doing that (while it’s training), so it’s less likely to quit on us too early. Either that, or we just manually lower the probability of such notes in the generator code itself.</p>
</section>
</details></section>
<section id="acknowledgements" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Acknowledgements</h1>
<ul>
<li><p>Super huge thanks to <a href="https://twitter.com/jeremyjordan">Jeremy Jordan</a> for many fruitful discussions as I developed this! Check out <a href="https://www.jeremyjordan.me/">his blog</a> for many helpful posts, esp.&nbsp;on Transformers, Attention, and many other Machine Learning topics.</p></li>
<li><p>I referred to <a href="https://www.youtube.com/watch?v=kCc8FmEb1nY">Andrej Karpathy’s lesson and codes</a> frequently when my own code wasn’t working to my satisfaction (i.e.&nbsp;all the time).</p></li>
<li><p>Various papers by the Google Magenta team – the undisputed ML-MIDI experts in my book – were helpful in figuring out what to do. This lesson was influenced by their tutorial <a href="https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/audio/music_generation.ipynb">“Generate Music with an RNN”</a>, which I converted PyTorch. In this lesson, code that wasn’t lifted from Karpathy was heavily influenced by the Magenta code.</p></li>
<li><p>I’m thankful to <a href="https://github.com/cifkao">Ondřej Cífka</a> for the exchanges that led to my development of Jupyter support for the MIDI player object(s) that he built off Magenta’s work.</p></li>
<li><p>As I included in the Preface, thanks to <a href="https://twitter.com/mamodrzejewski">Mateusz Modrzejewski</a> for what I took to be a word of encouragement.</p></li>
<li><p>ChatGPT was used extensively for helping with what I’ll unapologetically term “annoying formatting bullshit” (with pandas, tqdm, CSS,…), but not for anything more significant.</p></li>
</ul>
</section>
<section id="appendix-feeding-it-christmas-carols" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Appendix: Feeding it Christmas Carols 🎄</h1>
<p>This is probably a bad idea for so many reasons – it will be <em>wayyy</em> outside the distribution of training data – but given the time of year, I’ma try it anyway.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’re downloading the prompt MIDI files on the fly from <a href="https://www.mfiles.co.uk/christmas-music-and-carols.htm">MFiles</a>.</p>
</div>
</div>
<!--- comment 

---
# Afterward: Stuff I Probably Should Have Looked at First


BTW, that code is a PyTorch implementation of the 2018 [Music Transformer](https://arxiv.org/abs/1809.04281) paper by Google Brain, the abstract of which includes:

> "Existing approaches for representing relative positional information
in the Transformer modulate attention based on pairwise distance (Shaw et al.,
2018). This is impractical for long sequences such as musical compositions since
their memory complexity for intermediate relative information is quadratic in the
sequence length. We propose an algorithm that reduces their intermediate memory
requirement to linear in the sequence length.
This enables us to demonstrate that a
Transformer with our modified relative attention mechanism can generate minutelong compositions (thousands of steps, four times the length modeled in Oore et al.
(2018)) with compelling structure, generate continuations that coherently elaborate
on a given motif, and in a seq2seq setup generate accompaniments conditioned on
melodies"

....but this notebook is a tutorial, so forgive me if it's 5 years behind SOTA. ;-)

[Here's a nother code for a Pytorch MIDI transformer from 2 years ago](https://github.com/spectraldoy/music-transformer)

https://medium.com/data-science-in-your-pocket/music-generation-using-musictransformer-with-codes-c7be89ba85b1

--->
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">xmas_css <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb49-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;style&gt;</span></span>
<span id="cb49-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/* Custom player style */</span></span>
<span id="cb49-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">p { </span></span>
<span id="cb49-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  margin: 0; </span></span>
<span id="cb49-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */</span></span>
<span id="cb49-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-8"></span>
<span id="cb49-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-player {</span></span>
<span id="cb49-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  display: block;</span></span>
<span id="cb49-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  width: inherit;</span></span>
<span id="cb49-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  margin: 4px;</span></span>
<span id="cb49-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  margin-bottom: 0;</span></span>
<span id="cb49-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  color: #d4d4d4; /* Lighter text color for better readability */</span></span>
<span id="cb49-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-player::part(control-panel) {</span></span>
<span id="cb49-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  background: #004400; /* green background */</span></span>
<span id="cb49-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border: 2px solid #888; /* Lightened border color for contrast */</span></span>
<span id="cb49-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border-radius: 10px 10px 0 0;</span></span>
<span id="cb49-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-player::part(play-button) {</span></span>
<span id="cb49-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  color: #ffffff; /* White text for visibility */</span></span>
<span id="cb49-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border: 2px solid currentColor;</span></span>
<span id="cb49-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  background-color: #ff00000; </span></span>
<span id="cb49-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border-radius: 20px;</span></span>
<span id="cb49-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  transition: all 0.2s;</span></span>
<span id="cb49-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  content: 'hello';</span></span>
<span id="cb49-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-player::part(play-button):hover {</span></span>
<span id="cb49-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  color: #a00; </span></span>
<span id="cb49-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  background-color: #9fafc9; </span></span>
<span id="cb49-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border-radius: 10px;</span></span>
<span id="cb49-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-player::part(time) {</span></span>
<span id="cb49-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  font-family: monospace; /* Monospace font for time */</span></span>
<span id="cb49-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-37"></span>
<span id="cb49-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/* Custom visualizer style */</span></span>
<span id="cb49-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer .piano-roll-visualizer {</span></span>
<span id="cb49-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  background: #900; /* red background for visualizer */</span></span>
<span id="cb49-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border: 2px solid #505050; /* Dark border for subtle appearance */</span></span>
<span id="cb49-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border-top: none;</span></span>
<span id="cb49-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  border-radius: 0 0 10px 10px;</span></span>
<span id="cb49-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  margin: 4px;</span></span>
<span id="cb49-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  width: inherit;</span></span>
<span id="cb49-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  margin-top: 0;</span></span>
<span id="cb49-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  overflow: auto;</span></span>
<span id="cb49-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer svg rect.note {</span></span>
<span id="cb49-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  opacity: 0.9; </span></span>
<span id="cb49-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke-width: 1; /* Stroke width for note clarity */</span></span>
<span id="cb49-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-53"></span>
<span id="cb49-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/* Different instrument colors */</span></span>
<span id="cb49-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer svg rect.note[data-instrument="0"]{</span></span>
<span id="cb49-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  fill: #00f000; /* Green for Instrument 0 */</span></span>
<span id="cb49-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke: #444; </span></span>
<span id="cb49-58"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-59"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer svg rect.note[data-instrument="2"]{</span></span>
<span id="cb49-60"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  fill: #008000; /* Green for Instrument 2 */</span></span>
<span id="cb49-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke: #444;</span></span>
<span id="cb49-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer svg rect.note[data-is-drum="true"]{</span></span>
<span id="cb49-64"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  fill: #008000; /* Green for drum notes */</span></span>
<span id="cb49-65"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke: #bbb;</span></span>
<span id="cb49-66"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#section3 midi-visualizer svg rect.note.active {</span></span>
<span id="cb49-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  opacity: 0.9; /* Highlight active notes */</span></span>
<span id="cb49-69"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke: #ffffff; /* White stroke for maximum contrast */</span></span>
<span id="cb49-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  stroke-width: 2; /* Thicker stroke for active notes */</span></span>
<span id="cb49-71"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb49-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/style&gt;</span></span>
<span id="cb49-73"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb49-74"></span>
<span id="cb49-75"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> xmasplayer(notes_tensor, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, midi_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/tmp/tmp.mid"</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, styler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>general, css<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>xmas_css):</span>
<span id="cb49-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"MIDIplayer that writes input tensor to temporary file"</span></span>
<span id="cb49-77">    pm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes_to_midi(notes_tensor, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>time_rescale, out_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>midi_file)</span>
<span id="cb49-78">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> MIDIPlayer(midi_file, height, styler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>partial(styler, css<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>css), dl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title)</span>
<span id="cb49-79"></span>
<span id="cb49-80"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> christmas_ohno(filename, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.242</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2880</span>, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>):</span>
<span id="cb49-81">    url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.mfiles.co.uk/downloads/"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>filename</span>
<span id="cb49-82">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>wget <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>N {url}</span>
<span id="cb49-83">    </span>
<span id="cb49-84">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> midi_file_to_tensor(filename)</span>
<span id="cb49-85">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> debug: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"notes = "</span>,notes)</span>
<span id="cb49-86">    notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> quantize_times(notes[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>time_rescale, res_ms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time rescale is mainly to get codebooks to agree</span></span>
<span id="cb49-87">    prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> notes[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>]</span>
<span id="cb49-88">    prompt_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encode(prompt).unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(device)</span>
<span id="cb49-89">    set_seeds(seed)</span>
<span id="cb49-90">    notes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decode( model.generate(prompt_tokens, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_tokens, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>temperature)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].cpu() )</span>
<span id="cb49-91">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> xmasplayer(notes,title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title)</span>
<span id="cb49-92"></span>
<span id="cb49-93"></span>
<span id="cb49-94">c1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> christmas_ohno(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jingle-bells-keyboard.mid"</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Janky Bells"</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb49-95">display(c1)</span>
<span id="cb49-96">c2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> christmas_ohno(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"away-in-a-manger.mid"</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Away in a Mangled"</span>, time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.48</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.68</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb49-97">display(c2)</span>
<span id="cb49-98">c3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> christmas_ohno(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hark-the-herald-angels-sing.mid"</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arg the Herald Angels Cringe"</span>,time_rescale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.48</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.616</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb49-99">display(c3)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin: 0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #004400; /* green background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #ff00000; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #a00; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #900; /* red background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #00f000; /* Green for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #008000; /* Green for Instrument 2 */
  stroke: #444;
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: #008000; /* Green for drum notes */
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ffffff; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Janky Bells<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFNQDAAACQK0AAO0AAPkBqKwAAMkAAPgAAR0BpMgAAN0AARUAARwBqMkAANwAAQ0AARQBpK0AAMgAAOwAAO0AAPkAAQwBqKwAAMkBqMgAAN0BpMkAANwAAPgAAPkA1PgAAPkA1K0AAMgAAOwAAO0AAPgAAPkBpKwAAMkAAPgAAR0BqMgAAN0AARUAARwBqMkAANwAAQ0AARQBpMEAAMgAAOwAAPEAAQEAAQwBqMAAANEBpLUAANABqLQAARUBqPAAAQABpNkAAPkCBUzYAAEUAAEpAAE9Aaj1AAD4AajhAADtAAD0AAEdAAEoAAExAAE8AgVMzQAA4AABCQABHAABMAABOQGkzAAA0QABCAABDQGoyQAA0AAA7AABIQABMQABOAIMmMgAAO0AASAAASkAATACBVDZAADsAAEoAAExAaTRAADYAajJAADQAAEhAaTBAADIAADtAAEwAajAAADsAAEMAAEgAAEpAajlAADxAAEoAAExAaTdAADkAADtAADwAajZAADcAADlAADsAAEpAAEwAaUhAAEoAajRAADYAAEdAAEgAAE9AakcAAEhAAE8AAFFAaTJAADQAADkAAD5AAEdAAEgAAE9AAFEAajIAADRAaTJAADQAADxAAD4AAEVAAEcAAE5AAE8AgycyAAA8AAA+QABFAABKQABOAABOQIFTN0AAPgAAQ0AAR0AATgBqQwAAT0BpNwAAOUAARwAASEAATEAATwBqN0AAOQBpNwAAO0AAQkAASgAASkAATABqOUAAOwAAQgAAQ0BqOQAAO0AAQkAAQwAAR0AASAAASgAASkCBU0IAAEoAAE5AaUBAAENAAEcAAEhAajsAAD5AAEAAAEMAAEVAAE4AAE5AakgAAEpAaTxAAD4AAENAAEUAAEoAAExAAE4Agj1DAGo+QABKQABMAABOQGk8AAA9QAA+AABKAABMQGo7QAA9AABKQABMAABOAABPQGkwQAA3QAA7AABHQABMQGowAAA0QAA3AABAQABHAABIQABKAABMADVIAABKQDU0AAA2QAA5QABAAABFQABIQABKAGk2AAA3QAA5AAA+QABFAABHQABPAGo3AAA5QAA+AABAQABIAABIQGk5AAA7QAA+QABAAABHAABIAABKQGo7AAA+AABOQGo3QABDQABOAABTQGk3AAA5QABIQABTAABUQGo5AAA7QABDAABDQABIAABKAABTQABUAGk7AAA8QABTAABUQGo8AAA8QAA+QABCQGo3QAA8AAA+AABCAABDAABDQABKQDQ3AAA5QABKADU5AAA7QABBQABKQABWQGpDAABHQABKAABUAGk7AAA8QAA/QABBAABHAABIQABPQABWAIR6PAAAQ0BqO0AAPwBpOwAAPEAAPkAAQkAAQwAASABqO0AAPgBpOkAAPAAAPkAAP0AAQgBqOgAAOwAAPEAAPwAARUBqN0AAPAAAPgAAPkAAQ0AARQBpQwAAR0AATwBqRUAARwBpNkAANwBqNgAAN0AAQ0AARQAAR0CBUzcAADxAAD4AAEBAAEMAAEcAAEhAaj5AAEAAAEFAaTlAADwAAEBAAEEAajVAADkAADlAADpAAD4AAD5AAEAAajkAADoAAEVAAEgAaTUAADdAADpAAD4AAENAAEUAAEZAajoAADxAAEBAAEMAAEYAAEhAaTwAAD5AAEAAAEFAAEZAAEgAajcAAEVAAEYAajpAAEEAAENAAEUAaT4AAENAajJAADxAAEBAaTIAADoAAEAAAEMAajwAgVNDAAH/LwA=&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFNQDAAACQK0AAO0AAPkBqKwAAMkAAPgAAR0BpMgAAN0AARUAARwBqMkAANwAAQ0AARQBpK0AAMgAAOwAAO0AAPkAAQwBqKwAAMkBqMgAAN0BpMkAANwAAPgAAPkA1PgAAPkA1K0AAMgAAOwAAO0AAPgAAPkBpKwAAMkAAPgAAR0BqMgAAN0AARUAARwBqMkAANwAAQ0AARQBpMEAAMgAAOwAAPEAAQEAAQwBqMAAANEBpLUAANABqLQAARUBqPAAAQABpNkAAPkCBUzYAAEUAAEpAAE9Aaj1AAD4AajhAADtAAD0AAEdAAEoAAExAAE8AgVMzQAA4AABCQABHAABMAABOQGkzAAA0QABCAABDQGoyQAA0AAA7AABIQABMQABOAIMmMgAAO0AASAAASkAATACBVDZAADsAAEoAAExAaTRAADYAajJAADQAAEhAaTBAADIAADtAAEwAajAAADsAAEMAAEgAAEpAajlAADxAAEoAAExAaTdAADkAADtAADwAajZAADcAADlAADsAAEpAAEwAaUhAAEoAajRAADYAAEdAAEgAAE9AakcAAEhAAE8AAFFAaTJAADQAADkAAD5AAEdAAEgAAE9AAFEAajIAADRAaTJAADQAADxAAD4AAEVAAEcAAE5AAE8AgycyAAA8AAA+QABFAABKQABOAABOQIFTN0AAPgAAQ0AAR0AATgBqQwAAT0BpNwAAOUAARwAASEAATEAATwBqN0AAOQBpNwAAO0AAQkAASgAASkAATABqOUAAOwAAQgAAQ0BqOQAAO0AAQkAAQwAAR0AASAAASgAASkCBU0IAAEoAAE5AaUBAAENAAEcAAEhAajsAAD5AAEAAAEMAAEVAAE4AAE5AakgAAEpAaTxAAD4AAENAAEUAAEoAAExAAE4Agj1DAGo+QABKQABMAABOQGk8AAA9QAA+AABKAABMQGo7QAA9AABKQABMAABOAABPQGkwQAA3QAA7AABHQABMQGowAAA0QAA3AABAQABHAABIQABKAABMADVIAABKQDU0AAA2QAA5QABAAABFQABIQABKAGk2AAA3QAA5AAA+QABFAABHQABPAGo3AAA5QAA+AABAQABIAABIQGk5AAA7QAA+QABAAABHAABIAABKQGo7AAA+AABOQGo3QABDQABOAABTQGk3AAA5QABIQABTAABUQGo5AAA7QABDAABDQABIAABKAABTQABUAGk7AAA8QABTAABUQGo8AAA8QAA+QABCQGo3QAA8AAA+AABCAABDAABDQABKQDQ3AAA5QABKADU5AAA7QABBQABKQABWQGpDAABHQABKAABUAGk7AAA8QAA/QABBAABHAABIQABPQABWAIR6PAAAQ0BqO0AAPwBpOwAAPEAAPkAAQkAAQwAASABqO0AAPgBpOkAAPAAAPkAAP0AAQgBqOgAAOwAAPEAAPwAARUBqN0AAPAAAPgAAPkAAQ0AARQBpQwAAR0AATwBqRUAARwBpNkAANwBqNgAAN0AAQ0AARQAAR0CBUzcAADxAAD4AAEBAAEMAAEcAAEhAaj5AAEAAAEFAaTlAADwAAEBAAEEAajVAADkAADlAADpAAD4AAD5AAEAAajkAADoAAEVAAEgAaTUAADdAADpAAD4AAENAAEUAAEZAajoAADxAAEBAAEMAAEYAAEhAaTwAAD5AAEAAAEFAAEZAAEgAajcAAEVAAEYAajpAAEEAAENAAEUAaT4AAENAajJAADxAAEBAaTIAADoAAEAAAEMAajwAgVNDAAH/LwA= sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFNQDAAACQK0AAO0AAPkBqKwAAMkAAPgAAR0BpMgAAN0AARUAARwBqMkAANwAAQ0AARQBpK0AAMgAAOwAAO0AAPkAAQwBqKwAAMkBqMgAAN0BpMkAANwAAPgAAPkA1PgAAPkA1K0AAMgAAOwAAO0AAPgAAPkBpKwAAMkAAPgAAR0BqMgAAN0AARUAARwBqMkAANwAAQ0AARQBpMEAAMgAAOwAAPEAAQEAAQwBqMAAANEBpLUAANABqLQAARUBqPAAAQABpNkAAPkCBUzYAAEUAAEpAAE9Aaj1AAD4AajhAADtAAD0AAEdAAEoAAExAAE8AgVMzQAA4AABCQABHAABMAABOQGkzAAA0QABCAABDQGoyQAA0AAA7AABIQABMQABOAIMmMgAAO0AASAAASkAATACBVDZAADsAAEoAAExAaTRAADYAajJAADQAAEhAaTBAADIAADtAAEwAajAAADsAAEMAAEgAAEpAajlAADxAAEoAAExAaTdAADkAADtAADwAajZAADcAADlAADsAAEpAAEwAaUhAAEoAajRAADYAAEdAAEgAAE9AakcAAEhAAE8AAFFAaTJAADQAADkAAD5AAEdAAEgAAE9AAFEAajIAADRAaTJAADQAADxAAD4AAEVAAEcAAE5AAE8AgycyAAA8AAA+QABFAABKQABOAABOQIFTN0AAPgAAQ0AAR0AATgBqQwAAT0BpNwAAOUAARwAASEAATEAATwBqN0AAOQBpNwAAO0AAQkAASgAASkAATABqOUAAOwAAQgAAQ0BqOQAAO0AAQkAAQwAAR0AASAAASgAASkCBU0IAAEoAAE5AaUBAAENAAEcAAEhAajsAAD5AAEAAAEMAAEVAAE4AAE5AakgAAEpAaTxAAD4AAENAAEUAAEoAAExAAE4Agj1DAGo+QABKQABMAABOQGk8AAA9QAA+AABKAABMQGo7QAA9AABKQABMAABOAABPQGkwQAA3QAA7AABHQABMQGowAAA0QAA3AABAQABHAABIQABKAABMADVIAABKQDU0AAA2QAA5QABAAABFQABIQABKAGk2AAA3QAA5AAA+QABFAABHQABPAGo3AAA5QAA+AABAQABIAABIQGk5AAA7QAA+QABAAABHAABIAABKQGo7AAA+AABOQGo3QABDQABOAABTQGk3AAA5QABIQABTAABUQGo5AAA7QABDAABDQABIAABKAABTQABUAGk7AAA8QABTAABUQGo8AAA8QAA+QABCQGo3QAA8AAA+AABCAABDAABDQABKQDQ3AAA5QABKADU5AAA7QABBQABKQABWQGpDAABHQABKAABUAGk7AAA8QAA/QABBAABHAABIQABPQABWAIR6PAAAQ0BqO0AAPwBpOwAAPEAAPkAAQkAAQwAASABqO0AAPgBpOkAAPAAAPkAAP0AAQgBqOgAAOwAAPEAAPwAARUBqN0AAPAAAPgAAPkAAQ0AARQBpQwAAR0AATwBqRUAARwBpNkAANwBqNgAAN0AAQ0AARQAAR0CBUzcAADxAAD4AAEBAAEMAAEcAAEhAaj5AAEAAAEFAaTlAADwAAEBAAEEAajVAADkAADlAADpAAD4AAD5AAEAAajkAADoAAEVAAEgAaTUAADdAADpAAD4AAENAAEUAAEZAajoAADxAAEBAAEMAAEYAAEhAaTwAAD5AAEAAAEFAAEZAAEgAajcAAEVAAEYAajpAAEEAAENAAEUAaT4AAENAajJAADxAAEBAaTIAADoAAEAAAEMAajwAgVNDAAH/LwA= type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin: 0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section864 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section864 midi-player::part(control-panel) {
  background: #004400; /* green background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section864 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #ff00000; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section864 midi-player::part(play-button):hover {
  color: #a00; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section864 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section864 midi-visualizer .piano-roll-visualizer {
  background: #900; /* red background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section864 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section864 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #00f000; /* Green for Instrument 0 */
  stroke: #444; 
}
#section864 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #008000; /* Green for Instrument 2 */
  stroke: #444;
}
#section864 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: #008000; /* Green for drum notes */
  stroke: #bbb;
}
#section864 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ffffff; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section864&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Away in a Mangled<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFRADAAACQMEAAN0AAPECBUylAADAAADVAADcAADlAADwAAEFAgVNBAABBQIFUKQAALkAAOQAAOkAAQQAAQ0BpQwAARUBqKUAALgAANQAANUAAOUAAOgAAQUAARQCBU0EAAEFAgVMpAAAyQAA5AABBAABBQABFQGpFAABGQGktQAAyAAA0QAA1AABBAABFQABGAABIQIFUQ0AARQAASAAASECBUzJAADQAAEJAAEMAAEgAAEpAgVMtAAAwQAAyAAA3QABAQABCAABIQABKAIFTMAAAMkAANwAAOUAAQAAAQUAASAAASkBqP0AAQQBpMgAANEAAOQAAO0AAPwAAQEAASEAASgBqP0AAQABqMkAANAAAOUAAOwAAPkAAPwAASAAASkBpSEAASgBqMUAAMgAAPgAAQEAASAAASUBpSQAATEBqMQAAMkAAQAAAQUAASkAATACBUyxAADIAAEBAAEEAAElAAEoAgVMsAAAtQAAyQAA7QAA+QABAAABBQABJAGotAAAuQAA0QABDQGoyAAA3QAA7AAA+AABBAGk0AAA5AAA+QABDAGo3AAA7QGkuAAAyQAA3QAA7AGoyAAA3AAA5QABAQGopQAA4QAA5AAA+AAA+QABAAABBQIFTKQAAK0AAN0AAOAAAPEAAPgAAQEAAQQCBUysAADBAAEAAAEBAgVMtQAAwAAA3AAA5QAA8AAA8QABAAABCQGo8AAA+QGktAAAuQAA5AAA6QAA9QAA+AABCAABDQGorQAAuAGorAAA8QAA9AAA+QGkyQAA8AAA+AAA+QGoyAAA1QAA5QAA6AAA8QAA+AABDAABFQIFTOQAAOkAAPAAARQAARkBqSUBpNQAAN0AAOgAAPkAARUAARgBqNkAASQBpNEAANwAAPEAAPgAAQ0AARQBqNgAARUBqMEAANABpMAAAQEAAQwAARQBqQAAAQ0BpL0AAPAAAPkAAQUBqPgAAPkAAQwAAR0BqLwAAMEAAPEAAPgAAQEAAQQAARUAARwBpQAAAQkBqMAAAMEAAN0AAPAAAQEAAQgAARQAARkBpMAAAMkAAQAAAQUBqMgAANEAAPEAAQQAAQ0AARgBqMkAANAAANUAANwAAPAAARUBpMEAAMgAANEAANQAAPEAAQwAAQ0AARQBqMAAAMkAANAAAPAAARkBpMEAAMgAANEAARUAARgBqNAAAN0BqMAAAMkAANUAANwAAPkAAQwBpNQAAN0BqLUAAMgAANwAAOUAAPUAAPgAAQEAARQCEeTkAADlAAD0AAD1AgVQtAABAAIFTPQAAQEAASECBUzkAAEAAAEgAAFFAalEAAFFAaTdAAD5AAEZAAE9AajcAADlAAD1AAD4AAFEAaTkAADtAAD0AAD5AAEJAAEYAAEpAAE8AgVQ3QAA7AABCAABDQIFTNwAAOkAAPEAAPgAAPkAAQEAAQwAARUAASgCBUzZAADoAADwAAD4AAD5AAEAAAEpAgVM2AAA3QAA+AABDQABFAABGQABJQABKAIFTNwAAOUAAQEAARUAARgAASEAASQCBVDkAADtAAD5AAEAAAEMAAENAAEUAAEgAAEpAaTsAAD1AAD4AAEBAaj0AAD5AAEAAAEFAAEVAAEoAaTxAAD4AAEUAAEdAajpAADwAAD5AAEEAAEFAAEMAAEcAAEhAajlAADoAADxAAEEAaTdAADkAADwAAENAajZAADcAAD4AAD5AAEMAAEVAaTdAAEgAajcAADpAAD4AAEpAajYAgjw6AABDQABKAABMQGoyQABKQABMAGpDAABFAGkyAABKAAH/LwA=&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFRADAAACQMEAAN0AAPECBUylAADAAADVAADcAADlAADwAAEFAgVNBAABBQIFUKQAALkAAOQAAOkAAQQAAQ0BpQwAARUBqKUAALgAANQAANUAAOUAAOgAAQUAARQCBU0EAAEFAgVMpAAAyQAA5AABBAABBQABFQGpFAABGQGktQAAyAAA0QAA1AABBAABFQABGAABIQIFUQ0AARQAASAAASECBUzJAADQAAEJAAEMAAEgAAEpAgVMtAAAwQAAyAAA3QABAQABCAABIQABKAIFTMAAAMkAANwAAOUAAQAAAQUAASAAASkBqP0AAQQBpMgAANEAAOQAAO0AAPwAAQEAASEAASgBqP0AAQABqMkAANAAAOUAAOwAAPkAAPwAASAAASkBpSEAASgBqMUAAMgAAPgAAQEAASAAASUBpSQAATEBqMQAAMkAAQAAAQUAASkAATACBUyxAADIAAEBAAEEAAElAAEoAgVMsAAAtQAAyQAA7QAA+QABAAABBQABJAGotAAAuQAA0QABDQGoyAAA3QAA7AAA+AABBAGk0AAA5AAA+QABDAGo3AAA7QGkuAAAyQAA3QAA7AGoyAAA3AAA5QABAQGopQAA4QAA5AAA+AAA+QABAAABBQIFTKQAAK0AAN0AAOAAAPEAAPgAAQEAAQQCBUysAADBAAEAAAEBAgVMtQAAwAAA3AAA5QAA8AAA8QABAAABCQGo8AAA+QGktAAAuQAA5AAA6QAA9QAA+AABCAABDQGorQAAuAGorAAA8QAA9AAA+QGkyQAA8AAA+AAA+QGoyAAA1QAA5QAA6AAA8QAA+AABDAABFQIFTOQAAOkAAPAAARQAARkBqSUBpNQAAN0AAOgAAPkAARUAARgBqNkAASQBpNEAANwAAPEAAPgAAQ0AARQBqNgAARUBqMEAANABpMAAAQEAAQwAARQBqQAAAQ0BpL0AAPAAAPkAAQUBqPgAAPkAAQwAAR0BqLwAAMEAAPEAAPgAAQEAAQQAARUAARwBpQAAAQkBqMAAAMEAAN0AAPAAAQEAAQgAARQAARkBpMAAAMkAAQAAAQUBqMgAANEAAPEAAQQAAQ0AARgBqMkAANAAANUAANwAAPAAARUBpMEAAMgAANEAANQAAPEAAQwAAQ0AARQBqMAAAMkAANAAAPAAARkBpMEAAMgAANEAARUAARgBqNAAAN0BqMAAAMkAANUAANwAAPkAAQwBpNQAAN0BqLUAAMgAANwAAOUAAPUAAPgAAQEAARQCEeTkAADlAAD0AAD1AgVQtAABAAIFTPQAAQEAASECBUzkAAEAAAEgAAFFAalEAAFFAaTdAAD5AAEZAAE9AajcAADlAAD1AAD4AAFEAaTkAADtAAD0AAD5AAEJAAEYAAEpAAE8AgVQ3QAA7AABCAABDQIFTNwAAOkAAPEAAPgAAPkAAQEAAQwAARUAASgCBUzZAADoAADwAAD4AAD5AAEAAAEpAgVM2AAA3QAA+AABDQABFAABGQABJQABKAIFTNwAAOUAAQEAARUAARgAASEAASQCBVDkAADtAAD5AAEAAAEMAAENAAEUAAEgAAEpAaTsAAD1AAD4AAEBAaj0AAD5AAEAAAEFAAEVAAEoAaTxAAD4AAEUAAEdAajpAADwAAD5AAEEAAEFAAEMAAEcAAEhAajlAADoAADxAAEEAaTdAADkAADwAAENAajZAADcAAD4AAD5AAEMAAEVAaTdAAEgAajcAADpAAD4AAEpAajYAgjw6AABDQABKAABMQGoyQABKQABMAGpDAABFAGkyAABKAAH/LwA= sound-font visualizer=&quot;#section864 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFRADAAACQMEAAN0AAPECBUylAADAAADVAADcAADlAADwAAEFAgVNBAABBQIFUKQAALkAAOQAAOkAAQQAAQ0BpQwAARUBqKUAALgAANQAANUAAOUAAOgAAQUAARQCBU0EAAEFAgVMpAAAyQAA5AABBAABBQABFQGpFAABGQGktQAAyAAA0QAA1AABBAABFQABGAABIQIFUQ0AARQAASAAASECBUzJAADQAAEJAAEMAAEgAAEpAgVMtAAAwQAAyAAA3QABAQABCAABIQABKAIFTMAAAMkAANwAAOUAAQAAAQUAASAAASkBqP0AAQQBpMgAANEAAOQAAO0AAPwAAQEAASEAASgBqP0AAQABqMkAANAAAOUAAOwAAPkAAPwAASAAASkBpSEAASgBqMUAAMgAAPgAAQEAASAAASUBpSQAATEBqMQAAMkAAQAAAQUAASkAATACBUyxAADIAAEBAAEEAAElAAEoAgVMsAAAtQAAyQAA7QAA+QABAAABBQABJAGotAAAuQAA0QABDQGoyAAA3QAA7AAA+AABBAGk0AAA5AAA+QABDAGo3AAA7QGkuAAAyQAA3QAA7AGoyAAA3AAA5QABAQGopQAA4QAA5AAA+AAA+QABAAABBQIFTKQAAK0AAN0AAOAAAPEAAPgAAQEAAQQCBUysAADBAAEAAAEBAgVMtQAAwAAA3AAA5QAA8AAA8QABAAABCQGo8AAA+QGktAAAuQAA5AAA6QAA9QAA+AABCAABDQGorQAAuAGorAAA8QAA9AAA+QGkyQAA8AAA+AAA+QGoyAAA1QAA5QAA6AAA8QAA+AABDAABFQIFTOQAAOkAAPAAARQAARkBqSUBpNQAAN0AAOgAAPkAARUAARgBqNkAASQBpNEAANwAAPEAAPgAAQ0AARQBqNgAARUBqMEAANABpMAAAQEAAQwAARQBqQAAAQ0BpL0AAPAAAPkAAQUBqPgAAPkAAQwAAR0BqLwAAMEAAPEAAPgAAQEAAQQAARUAARwBpQAAAQkBqMAAAMEAAN0AAPAAAQEAAQgAARQAARkBpMAAAMkAAQAAAQUBqMgAANEAAPEAAQQAAQ0AARgBqMkAANAAANUAANwAAPAAARUBpMEAAMgAANEAANQAAPEAAQwAAQ0AARQBqMAAAMkAANAAAPAAARkBpMEAAMgAANEAARUAARgBqNAAAN0BqMAAAMkAANUAANwAAPkAAQwBpNQAAN0BqLUAAMgAANwAAOUAAPUAAPgAAQEAARQCEeTkAADlAAD0AAD1AgVQtAABAAIFTPQAAQEAASECBUzkAAEAAAEgAAFFAalEAAFFAaTdAAD5AAEZAAE9AajcAADlAAD1AAD4AAFEAaTkAADtAAD0AAD5AAEJAAEYAAEpAAE8AgVQ3QAA7AABCAABDQIFTNwAAOkAAPEAAPgAAPkAAQEAAQwAARUAASgCBUzZAADoAADwAAD4AAD5AAEAAAEpAgVM2AAA3QAA+AABDQABFAABGQABJQABKAIFTNwAAOUAAQEAARUAARgAASEAASQCBVDkAADtAAD5AAEAAAEMAAENAAEUAAEgAAEpAaTsAAD1AAD4AAEBAaj0AAD5AAEAAAEFAAEVAAEoAaTxAAD4AAEUAAEdAajpAADwAAD5AAEEAAEFAAEMAAEcAAEhAajlAADoAADxAAEEAaTdAADkAADwAAENAajZAADcAAD4AAD5AAEMAAEVAaTdAAEgAajcAADpAAD4AAEpAajYAgjw6AABDQABKAABMQGoyQABKQABMAGpDAABFAGkyAABKAAH/LwA= type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<script src=&quot;https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0&quot;></script>

<style>
/* Custom player style */
p { 
  margin: 0; 
  color: #c4c4c4; /* mid-lightness text color for title, intended for dark backgrounds */
}

#section137 midi-player {
  display: block;
  width: inherit;
  margin: 4px;
  margin-bottom: 0;
  color: #d4d4d4; /* Lighter text color for better readability */
}
#section137 midi-player::part(control-panel) {
  background: #004400; /* green background */
  border: 2px solid #888; /* Lightened border color for contrast */
  border-radius: 10px 10px 0 0;
}
#section137 midi-player::part(play-button) {
  color: #ffffff; /* White text for visibility */
  border: 2px solid currentColor;
  background-color: #ff00000; 
  border-radius: 20px;
  transition: all 0.2s;
  content: 'hello';
}
#section137 midi-player::part(play-button):hover {
  color: #a00; 
  background-color: #9fafc9; 
  border-radius: 10px;
}
#section137 midi-player::part(time) {
  font-family: monospace; /* Monospace font for time */
}

/* Custom visualizer style */
#section137 midi-visualizer .piano-roll-visualizer {
  background: #900; /* red background for visualizer */
  border: 2px solid #505050; /* Dark border for subtle appearance */
  border-top: none;
  border-radius: 0 0 10px 10px;
  margin: 4px;
  width: inherit;
  margin-top: 0;
  overflow: auto;
}
#section137 midi-visualizer svg rect.note {
  opacity: 0.9; 
  stroke-width: 1; /* Stroke width for note clarity */
}

/* Different instrument colors */
#section137 midi-visualizer svg rect.note[data-instrument=&quot;0&quot;]{
  fill: #00f000; /* Green for Instrument 0 */
  stroke: #444; 
}
#section137 midi-visualizer svg rect.note[data-instrument=&quot;2&quot;]{
  fill: #008000; /* Green for Instrument 2 */
  stroke: #444;
}
#section137 midi-visualizer svg rect.note[data-is-drum=&quot;true&quot;]{
  fill: #008000; /* Green for drum notes */
  stroke: #bbb;
}
#section137 midi-visualizer svg rect.note.active {
  opacity: 0.9; /* Highlight active notes */
  stroke: #ffffff; /* White stroke for maximum contrast */
  stroke-width: 2; /* Thicker stroke for active notes */
}
</style>

          <section id=&quot;section137&quot;><p style=&quot;text-align:left;font-family:Arial;&quot;>Arg the Herald Angels Cringe<span style=&quot;float:right;&quot;><a href=&quot;data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFPADAAACQNUAAOUAAPECBUzUAADVAADkAADlAADwAADxAAEFAgVM1AAA1QAA5AAA5QAA8AAA8QABBAABBQIFUMEAANQBpN0AAOQAAPAAAPEAAQEAAQQBqLUAAMAAANwAAOUAAPAAAPEAAQAAAQUCBUylAAC0AADkAADwAADxAAEEAAEFAAEVAgVMpAAAwQAA8AAA8QABBAABBQABFAABFQIFTQEAAQQAAQ0AARQCBVC1AADAAADVAADwAAD9AAEAAAEFAAEMAgVMtAAAuQAA1AAA6QAA+QAA/AGkuAAAwQGowAAAyQIFTMgAAM0AAOkAAPEAAPgCBUy1AADMAADVAADoAADoAgVQtAAAuQAAwQAA1AAA6QAA+QAA/QIFTLUAALgAAMAAANUAAOgAAPAAAPEAAPgAAPwAAQQAAQUCBUy0AAC5AADpAADwAAD5AAEEAajUAADdAADoAADxAaS4AADBAADNAADVAADcAADlAAD4AajUAADdAADwAaS5AADAAADJAADMAADkAADpAajcAajVAADoAAEFAaS4AADBAADIAADNAajAAADJAADMAADUAADpAaTlAADoAajBAADIAADdAADkAAEBAai5AADAAaS1AAC4AAC5AADVAADcAADxAAD5AAEAAaitAAC0AADxAAD4AaSlAACsAAC4AADBAADlAADwAADwAgVQmQAApAAAwAAAyQAA1AABBAABBQGkwQAAyAGomAAArQAAuQAAwAAA3QAA5AABBAABDQGkuAAAwQDUwAAAzQDUrAAAsQAAwQAAzAAA3AAA8QAA/QABDAGowAAAyQGksAAAwQAAyAAAzQAA/AABEQGo6QAA8AGkrQAAwAABDQABEAIFUOgCBUylAACsAADMAADlAADxAAEFAAEMAaShAACkAaiZAACgAADwAAD5AAEEAAENAaiYAAChAaSgAAClAADkAADpAAEFAAEMAaihAACkAaSZAACgAADoAAEEAAEFAAENAaj9AAEEAAEFAAEMAaiYAACxAADtAAD4AAD5AAD8AAEEAAENAaTdAADsAaiZAACwAADZAADcAAEMAAEVAaTxAAD4AaiYAACtAADYAADdAADtAAD5AAEUAajVAADcAADwAaTUAADxAAD4AakBAaSsAADdAAD5AAEAAgVQ0QAA1QAA3AAA5QAA7AAA8AAA8QAA+AIFTNAAANQAAN0BpOQAAOkBqNwAAPAAAPkBqMUAANUAAOgAAPEAAPgAAREBpO0AAPABqMQAAMkAANQAAOUAAOwAAP0AAQkAARABpN0AAOQAAPkAAPwAAQgAAQ0BqMEAAMgAANwAAOUAAPEAAPgAAQwAARUBqN0AAOQAAPAAAQEAARQBpNwAAOkAAQAAAQUAASkBqOUAAOgAAOkAASEAASgBpMAAAN0AAOQAAOgBqNwAAPEBqPAAAP0AAQQAASABpPwAAQ0BqOkAAPkAAQUBpQwAARkBqNEAAOgAAPEAAPgAAQQAAQ0BqRgAASEBpNAAANUAAQUAAQwAARUAASABqO0AAPAAAPEAAPkAARQBpNQAAOUAAOwAAPAAAPEAAPgBqN0AAOQAAOkAAPAAAQ0BqMkAAM0AANwAAOgAAPEAAPkAAQQBpMgAAMkAAMwAANkAAPAAAQwAARUBqMEAAMgAANgAAN0AAPgAAP0BpMAAAMkAANkAAPkAAPwBqMEAAMgAANgAAPgAAQEAARQBqMAAAMkAAPkAAQAAAQUBpOEBqMEAAMgAANwAAPgAAQEAAQQBpN0AAOABqMAAANwAAQAAB/y8A&quot; target=&quot;_blank&quot;>Download MIDI</a><br></span></p>
          <midi-player src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFPADAAACQNUAAOUAAPECBUzUAADVAADkAADlAADwAADxAAEFAgVM1AAA1QAA5AAA5QAA8AAA8QABBAABBQIFUMEAANQBpN0AAOQAAPAAAPEAAQEAAQQBqLUAAMAAANwAAOUAAPAAAPEAAQAAAQUCBUylAAC0AADkAADwAADxAAEEAAEFAAEVAgVMpAAAwQAA8AAA8QABBAABBQABFAABFQIFTQEAAQQAAQ0AARQCBVC1AADAAADVAADwAAD9AAEAAAEFAAEMAgVMtAAAuQAA1AAA6QAA+QAA/AGkuAAAwQGowAAAyQIFTMgAAM0AAOkAAPEAAPgCBUy1AADMAADVAADoAADoAgVQtAAAuQAAwQAA1AAA6QAA+QAA/QIFTLUAALgAAMAAANUAAOgAAPAAAPEAAPgAAPwAAQQAAQUCBUy0AAC5AADpAADwAAD5AAEEAajUAADdAADoAADxAaS4AADBAADNAADVAADcAADlAAD4AajUAADdAADwAaS5AADAAADJAADMAADkAADpAajcAajVAADoAAEFAaS4AADBAADIAADNAajAAADJAADMAADUAADpAaTlAADoAajBAADIAADdAADkAAEBAai5AADAAaS1AAC4AAC5AADVAADcAADxAAD5AAEAAaitAAC0AADxAAD4AaSlAACsAAC4AADBAADlAADwAADwAgVQmQAApAAAwAAAyQAA1AABBAABBQGkwQAAyAGomAAArQAAuQAAwAAA3QAA5AABBAABDQGkuAAAwQDUwAAAzQDUrAAAsQAAwQAAzAAA3AAA8QAA/QABDAGowAAAyQGksAAAwQAAyAAAzQAA/AABEQGo6QAA8AGkrQAAwAABDQABEAIFUOgCBUylAACsAADMAADlAADxAAEFAAEMAaShAACkAaiZAACgAADwAAD5AAEEAAENAaiYAAChAaSgAAClAADkAADpAAEFAAEMAaihAACkAaSZAACgAADoAAEEAAEFAAENAaj9AAEEAAEFAAEMAaiYAACxAADtAAD4AAD5AAD8AAEEAAENAaTdAADsAaiZAACwAADZAADcAAEMAAEVAaTxAAD4AaiYAACtAADYAADdAADtAAD5AAEUAajVAADcAADwAaTUAADxAAD4AakBAaSsAADdAAD5AAEAAgVQ0QAA1QAA3AAA5QAA7AAA8AAA8QAA+AIFTNAAANQAAN0BpOQAAOkBqNwAAPAAAPkBqMUAANUAAOgAAPEAAPgAAREBpO0AAPABqMQAAMkAANQAAOUAAOwAAP0AAQkAARABpN0AAOQAAPkAAPwAAQgAAQ0BqMEAAMgAANwAAOUAAPEAAPgAAQwAARUBqN0AAOQAAPAAAQEAARQBpNwAAOkAAQAAAQUAASkBqOUAAOgAAOkAASEAASgBpMAAAN0AAOQAAOgBqNwAAPEBqPAAAP0AAQQAASABpPwAAQ0BqOkAAPkAAQUBpQwAARkBqNEAAOgAAPEAAPgAAQQAAQ0BqRgAASEBpNAAANUAAQUAAQwAARUAASABqO0AAPAAAPEAAPkAARQBpNQAAOUAAOwAAPAAAPEAAPgBqN0AAOQAAOkAAPAAAQ0BqMkAAM0AANwAAOgAAPEAAPkAAQQBpMgAAMkAAMwAANkAAPAAAQwAARUBqMEAAMgAANgAAN0AAPgAAP0BpMAAAMkAANkAAPkAAPwBqMEAAMgAANgAAPgAAQEAARQBqMAAAMkAAPkAAQAAAQUBpOEBqMEAAMgAANwAAPgAAQEAAQQBpN0AAOABqMAAANwAAQAAB/y8A sound-font visualizer=&quot;#section137 midi-visualizer&quot;></midi-player>
          <midi-visualizer src=data:audio/midi;base64,TVRoZAAAAAYAAQACANxNVHJrAAAAEwD/UQMHoSAA/1gEBAIYCAH/LwBNVHJrAAAFPADAAACQNUAAOUAAPECBUzUAADVAADkAADlAADwAADxAAEFAgVM1AAA1QAA5AAA5QAA8AAA8QABBAABBQIFUMEAANQBpN0AAOQAAPAAAPEAAQEAAQQBqLUAAMAAANwAAOUAAPAAAPEAAQAAAQUCBUylAAC0AADkAADwAADxAAEEAAEFAAEVAgVMpAAAwQAA8AAA8QABBAABBQABFAABFQIFTQEAAQQAAQ0AARQCBVC1AADAAADVAADwAAD9AAEAAAEFAAEMAgVMtAAAuQAA1AAA6QAA+QAA/AGkuAAAwQGowAAAyQIFTMgAAM0AAOkAAPEAAPgCBUy1AADMAADVAADoAADoAgVQtAAAuQAAwQAA1AAA6QAA+QAA/QIFTLUAALgAAMAAANUAAOgAAPAAAPEAAPgAAPwAAQQAAQUCBUy0AAC5AADpAADwAAD5AAEEAajUAADdAADoAADxAaS4AADBAADNAADVAADcAADlAAD4AajUAADdAADwAaS5AADAAADJAADMAADkAADpAajcAajVAADoAAEFAaS4AADBAADIAADNAajAAADJAADMAADUAADpAaTlAADoAajBAADIAADdAADkAAEBAai5AADAAaS1AAC4AAC5AADVAADcAADxAAD5AAEAAaitAAC0AADxAAD4AaSlAACsAAC4AADBAADlAADwAADwAgVQmQAApAAAwAAAyQAA1AABBAABBQGkwQAAyAGomAAArQAAuQAAwAAA3QAA5AABBAABDQGkuAAAwQDUwAAAzQDUrAAAsQAAwQAAzAAA3AAA8QAA/QABDAGowAAAyQGksAAAwQAAyAAAzQAA/AABEQGo6QAA8AGkrQAAwAABDQABEAIFUOgCBUylAACsAADMAADlAADxAAEFAAEMAaShAACkAaiZAACgAADwAAD5AAEEAAENAaiYAAChAaSgAAClAADkAADpAAEFAAEMAaihAACkAaSZAACgAADoAAEEAAEFAAENAaj9AAEEAAEFAAEMAaiYAACxAADtAAD4AAD5AAD8AAEEAAENAaTdAADsAaiZAACwAADZAADcAAEMAAEVAaTxAAD4AaiYAACtAADYAADdAADtAAD5AAEUAajVAADcAADwAaTUAADxAAD4AakBAaSsAADdAAD5AAEAAgVQ0QAA1QAA3AAA5QAA7AAA8AAA8QAA+AIFTNAAANQAAN0BpOQAAOkBqNwAAPAAAPkBqMUAANUAAOgAAPEAAPgAAREBpO0AAPABqMQAAMkAANQAAOUAAOwAAP0AAQkAARABpN0AAOQAAPkAAPwAAQgAAQ0BqMEAAMgAANwAAOUAAPEAAPgAAQwAARUBqN0AAOQAAPAAAQEAARQBpNwAAOkAAQAAAQUAASkBqOUAAOgAAOkAASEAASgBpMAAAN0AAOQAAOgBqNwAAPEBqPAAAP0AAQQAASABpPwAAQ0BqOkAAPkAAQUBpQwAARkBqNEAAOgAAPEAAPgAAQQAAQ0BqRgAASEBpNAAANUAAQUAAQwAARUAASABqO0AAPAAAPEAAPkAARQBpNQAAOUAAOwAAPAAAPEAAPgBqN0AAOQAAOkAAPAAAQ0BqMkAAM0AANwAAOgAAPEAAPkAAQQBpMgAAMkAAMwAANkAAPAAAQwAARUBqMEAAMgAANgAAN0AAPgAAP0BpMAAAMkAANkAAPkAAPwBqMEAAMgAANgAAPgAAQEAARQBqMAAAMkAAPkAAQAAAQUBpOEBqMEAAMgAANwAAPgAAQEAAQQBpN0AAOABqMAAANwAAQAAB/y8A type=piano-roll></midi-visualizer>
          </section>
          " width="100%" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"="">'
            </iframe>
</div>
</div>
<p>…yea, not sure what that accomplished, but it was fun to try!</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For more holiday-themed Machine Learning instruction, check out <a href="https://hedges.belmont.edu/~shawley/naughty/">“🎅 Naughty by Numbers: Classifications at Christmas”</a>!</p>
</div>
</div>
<center>
My official December faculty photo:<br> <strong>“Happy Holidays from Dr.&nbsp;Hawley and Wedge the Destroyer”</strong><br> <img src="https://drscotthawley.github.io/blog/posts/images/hawley_wedge.jpeg" width="300px">
</center>
<hr>
<p>Copyright (c) 2023, Scott H. Hawley. Code is MIT-licensed, text is licensed CC-BY-NC 4.0.</p>


</section>

 ]]></description>
  <category>nlp</category>
  <category>architectures</category>
  <category>transformers</category>
  <category>music</category>
  <category>midi</category>
  <guid>https://drscotthawley.github.io/blog/posts/Transformers2-MusicBox.html</guid>
  <pubDate>Mon, 18 Dec 2023 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/musicbox_prime.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>To Understand Transformers, Focus on Attention</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/TransformerOvalInOut.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">(GIF animation, zooming in on Attention part of Transformer model diagram)</figcaption>
</figure>
</div>
<section id="preface" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Preface</h1>
<p>“Attention is All You Need” (hereafter AIAYN) is the name of the 2017 paper <span class="citation" data-cites="aiayn">[1]</span> that introduced Transformer models, a neural network architecture that eventually “took over” as the preferred architecture for many machine learning tasks, with models such a BERT and the GPT series (“#ChatGPT” - for this blog’s SEO) becoming “foundation” models upon which further systems continue to be built.</p>
<p>Yet I found the multiplicity of Transformers’ “moving parts” to be daunting, and this hindered my numerous, ardent attempts at studying them – see the References in Section&nbsp;8 for a list of all the papers, tutorials, and videos I consumed over the years. Many of these treatments do little to reduce the complexity, and thus the simplicity of the original paper’s title is often lost.</p>
<p>This is partly because Attention <em>isn’t really</em> “all you need,” and it’s a bit of a joke to pair the title with such a complex model diagram like the one shown in the GIF image above. However, I’ve come to see the Attention mechanism as the <em>key piece</em>, the <em>central mechanism</em>, for which everything else is (pretty much) just an add-on.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An Analogy
</div>
</div>
<div class="callout-body-container callout-body">
<p>I liken this to rocketry: whether you’re talking about model rockets or Saturn Vs, the essential part is the engine that uses a chemical reaction to produce thrust, yet you still need to add on stabilizing fins and a cone for aerodynamics, etc. And if you <em>really</em> want to lift heavy payloads then you’ll need all kinds of auxiliary systems to regulate fuel flow and control systems for stability. But if you want to understand a Saturn V (I don’t, but I’d imagine…) you wouldn’t start by listing all the different systems and go over them one by one, rather you’d start from the basic idea and then go into why these other pieces were added on. Such is how I’m recommending that we approach Transformer models.</p>
</div>
</div>
<p>Things finally “clicked” for me this summer – years later! What finally helped was watching Andrej Karpathy’s excellent YouTube tutorial <span class="citation" data-cites="andrej_karpathy_lets_2023">[2]</span> for the <em>second time</em>, when I noticed he homed in on the Attention part of the model and explained it as being a <em>weighted average of words.</em> I believe that if you grasp that central part, then all the other parts of the Transformer can be regarded as “bells and whistles” that help it work better.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Throughout this tutorial I will highlight key ideas with the phrase “Attention is just…” to share different perspectives that have helped me understand.</p>
<p>In most places below, the code is hidden by default (behind “&gt; Show the code” expanders) because I don’t want you getting distracted by how I made certain figures; the point is the figure, not the code. This lesson is intended to be “coding-free”!</p>
</div>
</div>
</section>
<section id="building-intuition" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Building Intuition</h1>
<p>Certain parts of an input hold greater significance than others. Take, for instance, when you observe an image, your attention is likely drawn to objects in the foreground rather than the background. In the following picture, the dog, for instance, captures the attention of most people (and AI systems!):</p>
<div id="fig-doggie" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/doggie_vit_attn_map.png" width="96%" align="left" class="figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;1<strong>.</strong> Example of attention being given to a foreground object, like this cute doggy! In the image on the right, the background is darkened compared to the foreground, indicating that the foreground is receiving more attention than the background. (Source: Eunkwang Jeon, <a href="https://github.com/jeonsworld/ViT-pytorch">ViT-pytorch</a>)</figcaption>
</figure>
</div>
<p>Alternatively, when you’re reading or listening to someone speaking, certain words carry more weight than others and contribute differently to the meaning formed in your mind. Consider the following sentence:</p>
<blockquote class="blockquote">
<p>“Please go to the store and get some milk.”</p>
</blockquote>
<p>If you’re trying to understand the command being given, the words “go”, “store”, “get”, and “milk” probably matter the most to you. If what you’re interested in is the <em>tone</em> (e.g.&nbsp;“is the speaker being polite?”) then probably the “Please” would matter most.</p>
<p>Since the topic of Attention often comes up in the context of Natural Language Processing (NLP), we’ll stick to text for this lesson, but know that “<a href="https://paperswithcode.com/method/vision-transformer">Vision Transformers</a>” for image processing are definitely a thing <span class="citation" data-cites="vit_paper">[3]</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention is just a way to give certain parts of an input more weight than others.</p>
</div>
</div>
<section id="weighted-averages" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="weighted-averages"><span class="header-section-number">2.1</span> Weighted Averages</h2>
<p>On computers, the way we often emphasize certain parts of an array more than others is to multiply them by another array that has the “weights” to be assigned. In some other contexts, the “weights” array may be also called a “mask”, such as a “hard mask” of 1’s and 0’s to turn on or off parts of the array, or a “soft mask” with floating-point values to emphasize certain elements.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention is just a soft mask.</p>
</div>
</div>
<p>Let’s use the sample sentence above, and <em>make up</em> some mask weights to stress the relative importance of different words. We’ll display the weight values with a colored background to visualize their magnitude (darker = more weight):</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd </span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTML, display</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Please go to the store and get some milk"</span></span>
<span id="cb1-6">words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>.split()</span>
<span id="cb1-7">mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.98</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.99</span>])</span>
<span id="cb1-8">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"word"</span>:words,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>:mask})</span>
<span id="cb1-9">display(df.set_index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'word'</span>).T.style.background_gradient(vmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, vmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).hide())</span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Sum of mask weights = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>mask<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div id="word-weights-0" class="cell-output cell-output-display">
<style type="text/css">
#T_e5ca5_row0_col0 {
  background-color: #73a9cf;
  color: #f1f1f1;
}
#T_e5ca5_row0_col1 {
  background-color: #045382;
  color: #f1f1f1;
}
#T_e5ca5_row0_col2, #T_e5ca5_row0_col5, #T_e5ca5_row0_col7 {
  background-color: #f0eaf4;
  color: #000000;
}
#T_e5ca5_row0_col3 {
  background-color: #fef6fa;
  color: #000000;
}
#T_e5ca5_row0_col4 {
  background-color: #187cb6;
  color: #f1f1f1;
}
#T_e5ca5_row0_col6 {
  background-color: #023d60;
  color: #f1f1f1;
}
#T_e5ca5_row0_col8 {
  background-color: #023a5b;
  color: #f1f1f1;
}
</style>

<table id="T_e5ca5" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_e5ca5_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Please</th>
<th id="T_e5ca5_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">go</th>
<th id="T_e5ca5_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">to</th>
<th id="T_e5ca5_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">the</th>
<th id="T_e5ca5_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">store</th>
<th id="T_e5ca5_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">and</th>
<th id="T_e5ca5_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">get</th>
<th id="T_e5ca5_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">some</th>
<th id="T_e5ca5_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">milk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e5ca5_row0_col0" class="data row0 col0">0.500</td>
<td id="T_e5ca5_row0_col1" class="data row0 col1">0.900</td>
<td id="T_e5ca5_row0_col2" class="data row0 col2">0.100</td>
<td id="T_e5ca5_row0_col3" class="data row0 col3">0.010</td>
<td id="T_e5ca5_row0_col4" class="data row0 col4">0.700</td>
<td id="T_e5ca5_row0_col5" class="data row0 col5">0.100</td>
<td id="T_e5ca5_row0_col6" class="data row0 col6">0.980</td>
<td id="T_e5ca5_row0_col7" class="data row0 col7">0.100</td>
<td id="T_e5ca5_row0_col8" class="data row0 col8">0.990</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of mask weights = 4.38</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the above example, I made up a weight of nearly zero for “the” because it really doesn’t matter. The meaning of the sentence would still be unambiguous without “the”. We’ll use this trick of setting some weights to zero later on when we talk about “Masked Attention” for the Decoder part of the Transformer.</p>
</div>
</div>
<p>We’ll make it so that the weights all add up to one. If all <img src="https://latex.codecogs.com/png.latex?N"> words were weighted equally, the weight values would all be <img src="https://latex.codecogs.com/png.latex?1/N">. For other weighting schemes, we divide the mask weights by their sum to get our attention weights. For the example sentence above, dividing by the sum gives us:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">attention <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mask<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>mask.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb3-2">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"word"</span>:words,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>:attention})</span>
<span id="cb3-3">display(df.set_index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'word'</span>).T.style.background_gradient(vmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, vmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.22</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).hide())</span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Sum of attention weights = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>attention<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div id="word-weights-1" class="cell-output cell-output-display">
<style type="text/css">
#T_9ed2e_row0_col0 {
  background-color: #6ba5cd;
  color: #f1f1f1;
}
#T_9ed2e_row0_col1 {
  background-color: #034973;
  color: #f1f1f1;
}
#T_9ed2e_row0_col2, #T_9ed2e_row0_col5, #T_9ed2e_row0_col7 {
  background-color: #f0eaf4;
  color: #000000;
}
#T_9ed2e_row0_col3 {
  background-color: #fef6fa;
  color: #000000;
}
#T_9ed2e_row0_col4 {
  background-color: #0f76b3;
  color: #f1f1f1;
}
#T_9ed2e_row0_col6, #T_9ed2e_row0_col8 {
  background-color: #023858;
  color: #f1f1f1;
}
</style>

<table id="T_9ed2e" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_9ed2e_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Please</th>
<th id="T_9ed2e_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">go</th>
<th id="T_9ed2e_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">to</th>
<th id="T_9ed2e_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">the</th>
<th id="T_9ed2e_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">store</th>
<th id="T_9ed2e_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">and</th>
<th id="T_9ed2e_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">get</th>
<th id="T_9ed2e_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">some</th>
<th id="T_9ed2e_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">milk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9ed2e_row0_col0" class="data row0 col0">0.114</td>
<td id="T_9ed2e_row0_col1" class="data row0 col1">0.205</td>
<td id="T_9ed2e_row0_col2" class="data row0 col2">0.023</td>
<td id="T_9ed2e_row0_col3" class="data row0 col3">0.002</td>
<td id="T_9ed2e_row0_col4" class="data row0 col4">0.160</td>
<td id="T_9ed2e_row0_col5" class="data row0 col5">0.023</td>
<td id="T_9ed2e_row0_col6" class="data row0 col6">0.224</td>
<td id="T_9ed2e_row0_col7" class="data row0 col7">0.023</td>
<td id="T_9ed2e_row0_col8" class="data row0 col8">0.226</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of attention weights = 1</code></pre>
</div>
</div>
<p>Now, the words themselves will <em>each</em> be represented by an array of numbers we call a “word vector”. Usually, word vectors are viewed as living in some high-dimensional space given by 256, 512, or even 1024 numbers. When we combine the word vectors we get a “context vector”, and the contributions of the word vectors will be weighted appropriately. These weights are <em>literally</em> the attention. To put it differently:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention is just a weighted average of inputs.</p>
</div>
</div>
<p>So how should we actually <em>get</em> those weights – how should they be determined? That’s what we’ll cover for the rest of this lesson. Firstly, it helps if we understand the context of something called “context vectors.”</p>
</section>
</section>
<section id="historical-context" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Historical “Context”</h1>
<p>There are a few different attention-like schemes that have arisen over the years. The cleanest starting point for our lesson is the work of Bahdanau et al <span class="citation" data-cites="bahdanau_attn">[4]</span> who were making improvements to automated language translation models that at the time were using an architecture called a Recurrent Neural Network (RNN, which you don’t need to understand for this lesson, or the fact that specific flavor of RNN was called an LSTM which stood for Long Short-Term Memory).</p>
<p>At issue was traditional models’ management of the “context vector” of numbers that would store the “meaning” of the text as it was being processed. You can think of the context vector as being like the “state” of the machine as it works through the text.</p>
<p>The simplest context vector is just the average of the word vectors making up the sentence. This method is called “<strong>Bag of Words</strong>”. There’s a <em>lot</em> you can do with a Bag of Words model. If we were to weight certain words more than others – say using Attention – then we’d have an even better model.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention is just a weighted Bag of Words.</p>
</div>
</div>
<p>Note that a Bag of Words doesn’t take into account word ordering. For example, on the outdoor tables at the coffee shop where I’m working, <a href="https://www.bongojava.com/pages/bongo-java">Bongo Java in Nashville, TN</a>, there are signs that would mean something very different if the word “outside” were moved to the end of the sentence:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/bongo_outside.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Bongo Java image: “Please no outside food or drink” != “Please no food or drink outside.” This is on an outdoor table where the owners clearly expect you to be eating, so only the first sentence makes sense in this case. A Bag of Words model would incorrectly treat those two sentences equivalently.</figcaption>
</figure>
</div>
<p>To get a sense of word ordering, we’ll need another part of the Transformer model called Positional Encoding, which we mention in Section&nbsp;6.</p>
</section>
<section id="making-attention-mathematical" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Making Attention Mathematical</h1>
<p>We’ll start by showing the full formula for the Attention mechanism in Transformer models, and then we’ll unpack that to explain what its parts are and <em>why</em> they are there.</p>
<p>The set of attention weights <img src="https://latex.codecogs.com/png.latex?A"> – the ones used in the weighted average – are given by</p>
<p><img src="https://latex.codecogs.com/png.latex?%20A%20=%20%7B%5Crm%20softmax%7D%5Cleft(%20Q%20K%5ET%20%5Cover%20%5Csqrt%7Bd_k%7D%20%5Cright)."></p>
<p>We then multiply these by the input values <img src="https://latex.codecogs.com/png.latex?V"> to get the context <img src="https://latex.codecogs.com/png.latex?C%20=%20A%20V">. Or, putting these together in the form that appears in the original AIAYN paper,</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%7B%5Crm%20Attention%7D(Q,K,V)%20=%20%7B%5Crm%20softmax%7D%5Cleft(%20Q%20K%5ET%20%5Cover%20%5Csqrt%7Bd_k%7D%20%5Cright)V"></p>
<style>
.img3 {
    /*transform-origin: top left;*/
    width:140px;
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img3:hover {
    -webkit-transform:scale(2.07);
    transform:scale(2.07);
    z-index:1;
}
</style>
<p>Here’s the diagram from the AIAYN paper illustrating this process :</p>
<div id="fig-qkv" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/qkv.png" class="img3 img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;2<strong>.</strong> (Mouse-over or press to expand.) Attention computation diagram from AIAYN paper <span class="citation" data-cites="aiayn">[1]</span>. “MatMul” = “matrix multiplication” or what we’ll also call a “dot product”, which includes summation (which given our normalized weights means we get a weighted average).</figcaption>
</figure>
</div>
<p>So then, what is softmax, what are Q and K, and what’s that square root doing in the denominator? In what follows, we’re going to emphasize the intuitive understanding of what’s going on and why. (If you’re satisfied to know the “is” without the “why,” then this tutorial is probably not for you.)</p>
<section id="what-is-softmax" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="what-is-softmax"><span class="header-section-number">4.0.1</span> What is Softmax?</h3>
<p><a href="https://www.youtube.com/watch?v=ytbYRIN0N4g">Softmax</a> is a normalized element-wise exponential function that operates on a vector (i.e.&nbsp;an array) of data <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bx%7D"> by the following equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%7B%5Crm%20softmax%7D(%5Cvec%7Bx%7D)_i%20=%20%7Be%5E%7Bx_i%7D%20%20%5Cover%20%5Csum_i%20e%5E%7Bx_i%7D%7D%20"> where <img src="https://latex.codecogs.com/png.latex?x_i"> are the individual elements (i.e., components) of <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bx%7D">. Usually one sees softmax used as the final output of a classifier or recommendation system, and indeed the final stage of the Transformer’s <em>Decoder</em> is a softmax function.</p>
<p><em>Why</em> is softmax appearing in the Attention calculation? Well, we <em>could</em> use something else, but softmax is a great choice! ;-) What we need for our attention weights is a set of positive numbers that add up to 1 (what I call “parts of a whole” and what mathematicians call a “[probability] distribution”). Usually the <img src="https://latex.codecogs.com/png.latex?x_i"> values can be positive or negative, so we need <em>some</em> function to map from sets of arbitrary real numbers to our weights that are “parts of a whole.” (Mathematicians call such functions “distribution-generating functions.”) We could choose some other function instead of softmax to do the job we need – say, something monotonic and positive like a sigmoid function – but softmax is arguably the best choice for a distribution generator because…</p>
<ul>
<li>other functions may be slower computationally</li>
<li>people are already accustomed to using softmax for other things</li>
<li>it’s got some sweet properties in terms of both probability theory <em>and</em> calculus</li>
<li>and it’s hella versatile – see the interactive Appendix “Fun With Softmax” aka Section&nbsp;9.</li>
</ul>
</section>
<section id="what-are-q-k-v" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="what-are-q-k-v"><span class="header-section-number">4.1</span> What are Q, K, &amp; V?</h2>
<p>Literally, these stand for “Query,” “Key,” and “Value,” respectively. We already mentioned the value <img src="https://latex.codecogs.com/png.latex?V"> as the “inputs” that are being attended. Note: these “inputs” could be actual data points, or just the outputs from a previous layer in the (stacked) Transformer architecture.</p>
<p>“Query” and “Key” are typically described in terms of search algorithms, with <img src="https://latex.codecogs.com/png.latex?Q"> being “what am I looking for?” and <img src="https://latex.codecogs.com/png.latex?K"> being, say, the keywords or metadata associated with the “actual” value <img src="https://latex.codecogs.com/png.latex?V">. For example, if you’re searching on YouTube for videos, you’re not searching the <em>videos themselves</em>, you’re searching over metadata/“keys” <em>about</em> those videos, and then the <em>values</em> of the actual, corresponding videos are served up.</p>
<p><em>Buuuuut</em>…in the context of Transformer models, I tend to find the “search” analogy to be lacking…or at least it can be an impediment to my understanding. So I’ll say it this way: <img src="https://latex.codecogs.com/png.latex?Q"> is usually the “current state of the machine,” such as the context vector describing the preceding words so that we can predict the <em>next</em> word.</p>
<p>In the simplest implementations <img src="https://latex.codecogs.com/png.latex?K"> is exactly the same as <img src="https://latex.codecogs.com/png.latex?V">. Like, literally <img src="https://latex.codecogs.com/png.latex?K">=<img src="https://latex.codecogs.com/png.latex?V"> can work in many cases. We’re not going to do that, but just to say, it can be done. Instead we’ll say that <img src="https://latex.codecogs.com/png.latex?K"> is an “alternate reduced-dimensional embedding of the embedding of <img src="https://latex.codecogs.com/png.latex?V">,” meaning that typically <img src="https://latex.codecogs.com/png.latex?Q,%20K,"> and <img src="https://latex.codecogs.com/png.latex?V"> are usually not the vectors <em>themselves</em> but rather the result of a remapping by a (typically) single-layer neural network which adds a little extra expressiveness to the model and which could also be used to project these vectors into some new space with a different (reduced) number of dimensions which is called <img src="https://latex.codecogs.com/png.latex?d_k">.</p>
<p>One more thing: we’ve been saying “vectors” but technically <img src="https://latex.codecogs.com/png.latex?Q,%20K,"> and <img src="https://latex.codecogs.com/png.latex?V"> are <em>matrices</em> consisting of multiple vectors stacked up in rows to form a “batch” that allows us to take advantage of the parallel-processing capabilities of GPUs. In our discussion, the matrix nature doesn’t really affect anything. (If you like, you might think of the vector version as a matrix with a batch size of 1.)</p>
</section>
<section id="similarity-and-its-measures" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="similarity-and-its-measures"><span class="header-section-number">4.2</span> Similarity and its Measures</h2>
<p>The thing that goes inside the parentheses of the softmax function is something that measures the <em>similarity</em> between the query <img src="https://latex.codecogs.com/png.latex?Q"> and the key <img src="https://latex.codecogs.com/png.latex?K">. Treating these as vectors, we have a few choices that I’ll show on a diagram:</p>
<div id="fig-sim-qkt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/similarity_qkt_vectors.png" class="img-fluid figure-img" width="350"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;3<strong>.</strong> Diagram illustrating a few similarity measures for vectors <img src="https://latex.codecogs.com/png.latex?Q"> and <img src="https://latex.codecogs.com/png.latex?K">.</figcaption>
</figure>
</div>
<p>Our options for measuring similarity include the following 3, the last of which is what the Transformer’s Attention uses:</p>
<section id="euclidean-distance-delta" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="euclidean-distance-delta"><span class="header-section-number">4.2.1</span> <span style="color:red;">Euclidean Distance: <img src="https://latex.codecogs.com/png.latex?%5CDelta"></span></h3>
<p>This is just what you think: it’s just the magnitude of the difference <img src="https://latex.codecogs.com/png.latex?%5CDelta%20=%20Q-K">, i.e.&nbsp;square the differences of all the coordinates and add up the squares. (The true Euclidean distance would be the square root of that sum, but usually we’d skip that.) Another way of saying is that we take the “dot product” of <img src="https://latex.codecogs.com/png.latex?%5CDelta"> with itself, <img src="https://latex.codecogs.com/png.latex?%5Cvec%7B%5CDelta%7D%20%5Ccdot%20%5Cvec%7B%5CDelta%7D"> which in matrix form would be <img src="https://latex.codecogs.com/png.latex?%5CDelta"> times its transpose, ie. <img src="https://latex.codecogs.com/png.latex?%5CDelta%5C,%5CDelta%5ET">.</p>
<p>The Euclidean distance is “okay,” and there’s nothing inherently wrong with this measure, but for very high-dimensional spaces it can be tricky to make work well (e.g., it can require extra tweaking to get the scaling right) since most points end up both super-far away from each other and yet (paradoxically?) also distributed around near the surface of a hypersphere. 🤷‍♂️ If what I just wrote didn’t resonate with you, just shrug like that emoji-man and read on.</p>
</section>
<section id="cosine-similarity-costheta" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="cosine-similarity-costheta"><span class="header-section-number">4.2.2</span> <span style="color:yellow;">Cosine Similarity: <img src="https://latex.codecogs.com/png.latex?%5Ccos%5Ctheta"></span></h3>
<p>This measure is <em>extremely</em> common in the field of NLP: We just look at the angle between <img src="https://latex.codecogs.com/png.latex?Q"> and <img src="https://latex.codecogs.com/png.latex?K">, and this maps really nicely if you use the cosine of the angle. So, similar vectors will point in nearly the same direction and have a cosine close to 1, whereas vectors that are pointing in opposite directions will have a cosine of -1. Notice that this only considers the <em>directions</em> of <img src="https://latex.codecogs.com/png.latex?Q"> and <img src="https://latex.codecogs.com/png.latex?K"> and ignores their magnitudes <img src="https://latex.codecogs.com/png.latex?%7CQ%7C"> and <img src="https://latex.codecogs.com/png.latex?%7CK%7C">. It’s as if we’re treating <img src="https://latex.codecogs.com/png.latex?Q"> and <img src="https://latex.codecogs.com/png.latex?K"> like they were <em>unit</em> vectors (which is often fine or at least “good enough”). In fact, the cosine is just the dot product between the unit-vector versions of <img src="https://latex.codecogs.com/png.latex?Q"> and <img src="https://latex.codecogs.com/png.latex?K">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ccos%5Ctheta%20=%20%7BQ%5Cover%20%7CQ%7C%7D%5Ccdot%7BK%20%5Cover%20%7CK%7C%7D%20=%20%7BQ%20K%5ET%20%5Cover%20%7CQ%7C%7CK%7C%7D"></p>
<p>As we said, this is really handy, and works fine in many situations. But…what if we <em>didn’t</em> throw away the magnitude information? Might that work even better? Also, consider the fact it takes extra effort to compute the denominator <img src="https://latex.codecogs.com/png.latex?%7CQ%7C%7CK%7C"> every time. What if we just computed <img src="https://latex.codecogs.com/png.latex?Q%20K%5ET"> and went with that?</p>
</section>
<section id="scaled-dot-product-qkt-sqrtd_k" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="scaled-dot-product-qkt-sqrtd_k"><span class="header-section-number">4.2.3</span> <span style="color:#54B98F;"> 🌟 Scaled Dot Product: <img src="https://latex.codecogs.com/png.latex?QK%5ET%20/%20%5Csqrt%7Bd_k%7D"></span></h3>
<p>The quantity <img src="https://latex.codecogs.com/png.latex?Q%20K%5ET"> is a “dot product” that yields a distance corresponding to the length of <img src="https://latex.codecogs.com/png.latex?Q"> projected along <img src="https://latex.codecogs.com/png.latex?K"> (or vice versa), as shown in Figure&nbsp;3 above. This works like the cosine similarity but includes the magnitude, and allows us to consider the relative length of the two vectors. It also can map to any real number instead of just the interval <img src="https://latex.codecogs.com/png.latex?%5B-1,%201%5D"> like the cosine. But if we just use <img src="https://latex.codecogs.com/png.latex?Q%20K%5ET">, we run into a problem in high dimensions similar to what we see for the Euclidean distance. We’ll look at the fix for that in the next sub-section, which is where the <img src="https://latex.codecogs.com/png.latex?1%5Csqrt%7Bd_k%7D"> comes in…</p>
<section id="why-the-1sqrtd_k" class="level4" data-number="4.2.3.1">
<h4 data-number="4.2.3.1" class="anchored" data-anchor-id="why-the-1sqrtd_k"><span class="header-section-number">4.2.3.1</span> Why the <img src="https://latex.codecogs.com/png.latex?1/%5Csqrt%7Bd_k%7D%5C,"> ?</h4>
<p>Simply put, it keeps the variance of our resulting data from exploding as the number of dimensions increases. Take a look at Figure&nbsp;4 (a) and (b).</p>
<style>
.img1 {
    transition:max-width 0.4s ease;
    position: relative;
    z-index:0;
}
.img1:hover {
    max-width: 210%;
    z-index:1;
}
.img2 {
    transform-origin: top right;
    transition:transform 0.4s ease;
    position: relative;
    z-index: 0;
}
.img2:hover {
    -webkit-transform:scale(2.07);
    transform:scale(2.07);
    z-index:1;
}
</style>
<div id="fig-sqrtd" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-5-output-1.png" class="img1 img-fluid figure-img"></p>
<figcaption class="figure-caption">a) Without <img src="https://latex.codecogs.com/png.latex?1/%5Csqrt%7Bd_k%7D"></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-6-output-1.png" class="img2 img-fluid figure-img"></p>
<figcaption class="figure-caption">b) With <img src="https://latex.codecogs.com/png.latex?1/%5Csqrt%7Bd_k%7D"></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;4<strong>.</strong> (Mouse-over or press to expand.) Histograms of dot-products between random vectors in increasingly high-dimensional spaces, both without (a) and with (b) the <img src="https://latex.codecogs.com/png.latex?1/%5Csqrt%7Bd_k%7D%5C,"> factor. Note how, in (a), the horizontal scale and standard deviation <img src="https://latex.codecogs.com/png.latex?%5Csigma"> both grow with the number of dimensions (written as <img src="https://latex.codecogs.com/png.latex?D"> instead of <img src="https://latex.codecogs.com/png.latex?d_k">), whereas in (b) these remain constant. Source: Another blog post of mine <span class="citation" data-cites="blog-vec-orthog">[5]</span>.</figcaption><p></p>
</figure>
</div>
<p>The first figure (a) shows histograms of <img src="https://latex.codecogs.com/png.latex?QK%5ET"> for a bunch of random vectors as we increase the number of dimensions: what happens is that the “spread” of these values grows arbitrarily big. And generally in machine learning this can be a bad thing – we like to keep our values “normalized” within a certain range. It turns out that if you just divide by the <em>square root</em> of the number of dimensions…well, check out what happens in (b)! The data stays nicely distributed in the same range regardless of how many dimensions you want to use. 👍</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Inputs will get high attention-weight whenever their key <img src="https://latex.codecogs.com/png.latex?K"> has high similarity with the query <img src="https://latex.codecogs.com/png.latex?Q">.</p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="extensions-multi-headedness-masking" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Extensions: Multi-Headedness &amp; Masking</h1>
<p>Two “extensions” of Attention that show up in the Transformer model are worth including. But maybe some readers are starting to hope we’re nearly finished, so I’ll discuss these extensions in the following expandable “Details” section for those who want to read about them:</p>
<details>
<section id="multi-headed-attention" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="multi-headed-attention"><span class="header-section-number">5.1</span> Multi-Headed Attention</h2>
<p>If we extend the dimensionality of our attention appararatus, we can look at different “senses” of the sentence. These extra dimensions are referred to as “heads”. One head might focus on the sheer “facts” or instructions, such as “go get milk”. Another head might sense the tone of the text, such as the use of “Please” making it polite. By allowing for different “attention heads”, this can be handled automatically, using the broadcasting capability of Python.</p>
</section>
<section id="masked-attention" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="masked-attention"><span class="header-section-number">5.2</span> Masked Attention</h2>
<p>We’ve already likened Attention to a mask function. When saying “Masked Attention,” the authors mean that some values will be given zero weight, effectively removing them from the sequence. This kind of masked attention is found in the Decoder part of the Transformer when we are trying to (“auto-regressively”) generate new words without “looking into the future” of the training data. Karpathy’s video <span class="citation" data-cites="andrej_karpathy_lets_2023">[2]</span> does a great job of explaining this.</p>
<p>Say we were training a model to generate the phrase “Please go to the store and get some milk” one word at a time starting with the word “Please.” We’d start by giving weights of zero to all the later words.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Transformers do not handle variable-length sequences; all sequences have the same length in Transformer models – this is what makes them parallelizable and therefore fast. So to vary the length of a sequence, we just set all the unused parts to some token values such as zeros.</p>
</div>
</div>
<p>To get a value of 0 in the output of a softmax function, we supply <code>-inf</code> (i.e.&nbsp;<img src="https://latex.codecogs.com/png.latex?-%5Cinfty">) to the logits (i.e.&nbsp;the arguments of softmax), since <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bx%5Crightarrow-%5Cinfty%7De%5Ex%20=%200">. So to mask out future words in Masked Attention, we supply the value <code>-inf</code> for those words.</p>
<p>The net result of this will be a sequence of logits with progressively fewer <code>-inf</code>’s in them, or accordingly a set of attention wights with progressively fewer 0’s. As shown below (white=very little weight, dark=most weight):</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> softmax(x):</span>
<span id="cb5-2">    sums <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.exp(x), axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[:,np.newaxis]</span>
<span id="cb5-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.exp(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>sums</span>
<span id="cb5-4">    </span>
<span id="cb5-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Please go to the store and get some milk"</span></span>
<span id="cb5-6">words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>.split()</span>
<span id="cb5-7">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(words)</span>
<span id="cb5-8">attn_weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.114</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.205</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.002</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.160</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.224</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.226</span>])</span>
<span id="cb5-9">logits0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.log(attn_weights<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0e-8</span>)</span>
<span id="cb5-10">logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.full((n,n), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf)</span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n): </span>
<span id="cb5-12">    logits[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits0[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-13"></span>
<span id="cb5-14">attention <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax(logits)</span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logits:"</span>)</span>
<span id="cb5-17">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(logits, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>words)</span>
<span id="cb5-18">display(df.style.background_gradient(vmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, vmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).hide())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>logits:</code></pre>
</div>
<div id="masked-logits" class="cell-output cell-output-display">
<style type="text/css">
#T_0957d_row0_col0, #T_0957d_row1_col0, #T_0957d_row2_col0, #T_0957d_row3_col0, #T_0957d_row4_col0, #T_0957d_row5_col0, #T_0957d_row6_col0, #T_0957d_row7_col0, #T_0957d_row8_col0 {
  background-color: #034f7d;
  color: #f1f1f1;
}
#T_0957d_row0_col1, #T_0957d_row0_col2, #T_0957d_row0_col3, #T_0957d_row0_col4, #T_0957d_row0_col5, #T_0957d_row0_col6, #T_0957d_row0_col7, #T_0957d_row0_col8, #T_0957d_row1_col2, #T_0957d_row1_col3, #T_0957d_row1_col4, #T_0957d_row1_col5, #T_0957d_row1_col6, #T_0957d_row1_col7, #T_0957d_row1_col8, #T_0957d_row2_col3, #T_0957d_row2_col4, #T_0957d_row2_col5, #T_0957d_row2_col6, #T_0957d_row2_col7, #T_0957d_row2_col8, #T_0957d_row3_col4, #T_0957d_row3_col5, #T_0957d_row3_col6, #T_0957d_row3_col7, #T_0957d_row3_col8, #T_0957d_row4_col5, #T_0957d_row4_col6, #T_0957d_row4_col7, #T_0957d_row4_col8, #T_0957d_row5_col6, #T_0957d_row5_col7, #T_0957d_row5_col8, #T_0957d_row6_col7, #T_0957d_row6_col8, #T_0957d_row7_col8 {
  background-color: #fff7fb;
  color: #000000;
}
#T_0957d_row1_col1, #T_0957d_row2_col1, #T_0957d_row3_col1, #T_0957d_row4_col1, #T_0957d_row5_col1, #T_0957d_row6_col1, #T_0957d_row7_col1, #T_0957d_row8_col1 {
  background-color: #023d60;
  color: #f1f1f1;
}
#T_0957d_row2_col2, #T_0957d_row3_col2, #T_0957d_row4_col2, #T_0957d_row5_col2, #T_0957d_row5_col5, #T_0957d_row6_col2, #T_0957d_row6_col5, #T_0957d_row7_col2, #T_0957d_row7_col5, #T_0957d_row7_col7, #T_0957d_row8_col2, #T_0957d_row8_col5, #T_0957d_row8_col7 {
  background-color: #0f76b3;
  color: #f1f1f1;
}
#T_0957d_row3_col3, #T_0957d_row4_col3, #T_0957d_row5_col3, #T_0957d_row6_col3, #T_0957d_row7_col3, #T_0957d_row8_col3 {
  background-color: #8cb3d5;
  color: #000000;
}
#T_0957d_row4_col4, #T_0957d_row5_col4, #T_0957d_row6_col4, #T_0957d_row7_col4, #T_0957d_row8_col4 {
  background-color: #03456c;
  color: #f1f1f1;
}
#T_0957d_row6_col6, #T_0957d_row7_col6, #T_0957d_row8_col6, #T_0957d_row8_col8 {
  background-color: #023a5b;
  color: #f1f1f1;
}
</style>

<table id="T_0957d" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_0957d_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Please</th>
<th id="T_0957d_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">go</th>
<th id="T_0957d_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">to</th>
<th id="T_0957d_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">the</th>
<th id="T_0957d_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">store</th>
<th id="T_0957d_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">and</th>
<th id="T_0957d_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">get</th>
<th id="T_0957d_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">some</th>
<th id="T_0957d_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">milk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_0957d_row0_col0" class="data row0 col0">-2.172</td>
<td id="T_0957d_row0_col1" class="data row0 col1">-inf</td>
<td id="T_0957d_row0_col2" class="data row0 col2">-inf</td>
<td id="T_0957d_row0_col3" class="data row0 col3">-inf</td>
<td id="T_0957d_row0_col4" class="data row0 col4">-inf</td>
<td id="T_0957d_row0_col5" class="data row0 col5">-inf</td>
<td id="T_0957d_row0_col6" class="data row0 col6">-inf</td>
<td id="T_0957d_row0_col7" class="data row0 col7">-inf</td>
<td id="T_0957d_row0_col8" class="data row0 col8">-inf</td>
</tr>
<tr class="even">
<td id="T_0957d_row1_col0" class="data row1 col0">-2.172</td>
<td id="T_0957d_row1_col1" class="data row1 col1">-1.585</td>
<td id="T_0957d_row1_col2" class="data row1 col2">-inf</td>
<td id="T_0957d_row1_col3" class="data row1 col3">-inf</td>
<td id="T_0957d_row1_col4" class="data row1 col4">-inf</td>
<td id="T_0957d_row1_col5" class="data row1 col5">-inf</td>
<td id="T_0957d_row1_col6" class="data row1 col6">-inf</td>
<td id="T_0957d_row1_col7" class="data row1 col7">-inf</td>
<td id="T_0957d_row1_col8" class="data row1 col8">-inf</td>
</tr>
<tr class="odd">
<td id="T_0957d_row2_col0" class="data row2 col0">-2.172</td>
<td id="T_0957d_row2_col1" class="data row2 col1">-1.585</td>
<td id="T_0957d_row2_col2" class="data row2 col2">-3.772</td>
<td id="T_0957d_row2_col3" class="data row2 col3">-inf</td>
<td id="T_0957d_row2_col4" class="data row2 col4">-inf</td>
<td id="T_0957d_row2_col5" class="data row2 col5">-inf</td>
<td id="T_0957d_row2_col6" class="data row2 col6">-inf</td>
<td id="T_0957d_row2_col7" class="data row2 col7">-inf</td>
<td id="T_0957d_row2_col8" class="data row2 col8">-inf</td>
</tr>
<tr class="even">
<td id="T_0957d_row3_col0" class="data row3 col0">-2.172</td>
<td id="T_0957d_row3_col1" class="data row3 col1">-1.585</td>
<td id="T_0957d_row3_col2" class="data row3 col2">-3.772</td>
<td id="T_0957d_row3_col3" class="data row3 col3">-6.215</td>
<td id="T_0957d_row3_col4" class="data row3 col4">-inf</td>
<td id="T_0957d_row3_col5" class="data row3 col5">-inf</td>
<td id="T_0957d_row3_col6" class="data row3 col6">-inf</td>
<td id="T_0957d_row3_col7" class="data row3 col7">-inf</td>
<td id="T_0957d_row3_col8" class="data row3 col8">-inf</td>
</tr>
<tr class="odd">
<td id="T_0957d_row4_col0" class="data row4 col0">-2.172</td>
<td id="T_0957d_row4_col1" class="data row4 col1">-1.585</td>
<td id="T_0957d_row4_col2" class="data row4 col2">-3.772</td>
<td id="T_0957d_row4_col3" class="data row4 col3">-6.215</td>
<td id="T_0957d_row4_col4" class="data row4 col4">-1.833</td>
<td id="T_0957d_row4_col5" class="data row4 col5">-inf</td>
<td id="T_0957d_row4_col6" class="data row4 col6">-inf</td>
<td id="T_0957d_row4_col7" class="data row4 col7">-inf</td>
<td id="T_0957d_row4_col8" class="data row4 col8">-inf</td>
</tr>
<tr class="even">
<td id="T_0957d_row5_col0" class="data row5 col0">-2.172</td>
<td id="T_0957d_row5_col1" class="data row5 col1">-1.585</td>
<td id="T_0957d_row5_col2" class="data row5 col2">-3.772</td>
<td id="T_0957d_row5_col3" class="data row5 col3">-6.215</td>
<td id="T_0957d_row5_col4" class="data row5 col4">-1.833</td>
<td id="T_0957d_row5_col5" class="data row5 col5">-3.772</td>
<td id="T_0957d_row5_col6" class="data row5 col6">-inf</td>
<td id="T_0957d_row5_col7" class="data row5 col7">-inf</td>
<td id="T_0957d_row5_col8" class="data row5 col8">-inf</td>
</tr>
<tr class="odd">
<td id="T_0957d_row6_col0" class="data row6 col0">-2.172</td>
<td id="T_0957d_row6_col1" class="data row6 col1">-1.585</td>
<td id="T_0957d_row6_col2" class="data row6 col2">-3.772</td>
<td id="T_0957d_row6_col3" class="data row6 col3">-6.215</td>
<td id="T_0957d_row6_col4" class="data row6 col4">-1.833</td>
<td id="T_0957d_row6_col5" class="data row6 col5">-3.772</td>
<td id="T_0957d_row6_col6" class="data row6 col6">-1.496</td>
<td id="T_0957d_row6_col7" class="data row6 col7">-inf</td>
<td id="T_0957d_row6_col8" class="data row6 col8">-inf</td>
</tr>
<tr class="even">
<td id="T_0957d_row7_col0" class="data row7 col0">-2.172</td>
<td id="T_0957d_row7_col1" class="data row7 col1">-1.585</td>
<td id="T_0957d_row7_col2" class="data row7 col2">-3.772</td>
<td id="T_0957d_row7_col3" class="data row7 col3">-6.215</td>
<td id="T_0957d_row7_col4" class="data row7 col4">-1.833</td>
<td id="T_0957d_row7_col5" class="data row7 col5">-3.772</td>
<td id="T_0957d_row7_col6" class="data row7 col6">-1.496</td>
<td id="T_0957d_row7_col7" class="data row7 col7">-3.772</td>
<td id="T_0957d_row7_col8" class="data row7 col8">-inf</td>
</tr>
<tr class="odd">
<td id="T_0957d_row8_col0" class="data row8 col0">-2.172</td>
<td id="T_0957d_row8_col1" class="data row8 col1">-1.585</td>
<td id="T_0957d_row8_col2" class="data row8 col2">-3.772</td>
<td id="T_0957d_row8_col3" class="data row8 col3">-6.215</td>
<td id="T_0957d_row8_col4" class="data row8 col4">-1.833</td>
<td id="T_0957d_row8_col5" class="data row8 col5">-3.772</td>
<td id="T_0957d_row8_col6" class="data row8 col6">-1.496</td>
<td id="T_0957d_row8_col7" class="data row8 col7">-3.772</td>
<td id="T_0957d_row8_col8" class="data row8 col8">-1.487</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Attention weights = softmax(logits), row-wise:  "</span>)</span>
<span id="cb7-2">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(attention, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>words)</span>
<span id="cb7-3">display(df.style.background_gradient(vmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, vmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).hide())</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Attention weights = softmax(logits), row-wise:  </code></pre>
</div>
<div id="masked-attn" class="cell-output cell-output-display">
<style type="text/css">
#T_5647b_row0_col0, #T_5647b_row1_col1, #T_5647b_row2_col1, #T_5647b_row3_col1 {
  background-color: #023858;
  color: #f1f1f1;
}
#T_5647b_row0_col1, #T_5647b_row0_col2, #T_5647b_row0_col3, #T_5647b_row0_col4, #T_5647b_row0_col5, #T_5647b_row0_col6, #T_5647b_row0_col7, #T_5647b_row0_col8, #T_5647b_row1_col2, #T_5647b_row1_col3, #T_5647b_row1_col4, #T_5647b_row1_col5, #T_5647b_row1_col6, #T_5647b_row1_col7, #T_5647b_row1_col8, #T_5647b_row2_col3, #T_5647b_row2_col4, #T_5647b_row2_col5, #T_5647b_row2_col6, #T_5647b_row2_col7, #T_5647b_row2_col8, #T_5647b_row3_col4, #T_5647b_row3_col5, #T_5647b_row3_col6, #T_5647b_row3_col7, #T_5647b_row3_col8, #T_5647b_row4_col5, #T_5647b_row4_col6, #T_5647b_row4_col7, #T_5647b_row4_col8, #T_5647b_row5_col6, #T_5647b_row5_col7, #T_5647b_row5_col8, #T_5647b_row6_col7, #T_5647b_row6_col8, #T_5647b_row7_col8 {
  background-color: #fff7fb;
  color: #000000;
}
#T_5647b_row1_col0 {
  background-color: #1379b5;
  color: #f1f1f1;
}
#T_5647b_row2_col0 {
  background-color: #2685bb;
  color: #f1f1f1;
}
#T_5647b_row2_col2, #T_5647b_row3_col2 {
  background-color: #eae6f1;
  color: #000000;
}
#T_5647b_row3_col0 {
  background-color: #2786bb;
  color: #f1f1f1;
}
#T_5647b_row3_col3, #T_5647b_row4_col3 {
  background-color: #fef6fa;
  color: #000000;
}
#T_5647b_row4_col0, #T_5647b_row8_col8 {
  background-color: #88b1d4;
  color: #000000;
}
#T_5647b_row4_col1 {
  background-color: #04649e;
  color: #f1f1f1;
}
#T_5647b_row4_col2 {
  background-color: #f1ebf5;
  color: #000000;
}
#T_5647b_row4_col4 {
  background-color: #328dbf;
  color: #f1f1f1;
}
#T_5647b_row5_col0 {
  background-color: #8fb4d6;
  color: #000000;
}
#T_5647b_row5_col1 {
  background-color: #056ba7;
  color: #f1f1f1;
}
#T_5647b_row5_col2, #T_5647b_row5_col5 {
  background-color: #f2ecf5;
  color: #000000;
}
#T_5647b_row5_col3, #T_5647b_row6_col3, #T_5647b_row7_col3, #T_5647b_row8_col3 {
  background-color: #fef6fb;
  color: #000000;
}
#T_5647b_row5_col4 {
  background-color: #3f93c2;
  color: #f1f1f1;
}
#T_5647b_row6_col0 {
  background-color: #bfc9e1;
  color: #000000;
}
#T_5647b_row6_col1 {
  background-color: #5ea0ca;
  color: #f1f1f1;
}
#T_5647b_row6_col2, #T_5647b_row6_col5, #T_5647b_row7_col2, #T_5647b_row7_col5, #T_5647b_row7_col7 {
  background-color: #f6eff7;
  color: #000000;
}
#T_5647b_row6_col4 {
  background-color: #91b5d6;
  color: #000000;
}
#T_5647b_row6_col6 {
  background-color: #4496c3;
  color: #f1f1f1;
}
#T_5647b_row7_col0 {
  background-color: #c1cae2;
  color: #000000;
}
#T_5647b_row7_col1 {
  background-color: #65a3cb;
  color: #f1f1f1;
}
#T_5647b_row7_col4 {
  background-color: #97b7d7;
  color: #000000;
}
#T_5647b_row7_col6 {
  background-color: #4c99c5;
  color: #f1f1f1;
}
#T_5647b_row8_col0 {
  background-color: #d5d5e8;
  color: #000000;
}
#T_5647b_row8_col1 {
  background-color: #99b8d8;
  color: #000000;
}
#T_5647b_row8_col2, #T_5647b_row8_col5, #T_5647b_row8_col7 {
  background-color: #f8f1f8;
  color: #000000;
}
#T_5647b_row8_col4 {
  background-color: #b9c6e0;
  color: #000000;
}
#T_5647b_row8_col6 {
  background-color: #89b1d4;
  color: #000000;
}
</style>

<table id="T_5647b" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_5647b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Please</th>
<th id="T_5647b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">go</th>
<th id="T_5647b_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">to</th>
<th id="T_5647b_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">the</th>
<th id="T_5647b_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">store</th>
<th id="T_5647b_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">and</th>
<th id="T_5647b_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">get</th>
<th id="T_5647b_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">some</th>
<th id="T_5647b_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">milk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5647b_row0_col0" class="data row0 col0">1.000</td>
<td id="T_5647b_row0_col1" class="data row0 col1">0.000</td>
<td id="T_5647b_row0_col2" class="data row0 col2">0.000</td>
<td id="T_5647b_row0_col3" class="data row0 col3">0.000</td>
<td id="T_5647b_row0_col4" class="data row0 col4">0.000</td>
<td id="T_5647b_row0_col5" class="data row0 col5">0.000</td>
<td id="T_5647b_row0_col6" class="data row0 col6">0.000</td>
<td id="T_5647b_row0_col7" class="data row0 col7">0.000</td>
<td id="T_5647b_row0_col8" class="data row0 col8">0.000</td>
</tr>
<tr class="even">
<td id="T_5647b_row1_col0" class="data row1 col0">0.357</td>
<td id="T_5647b_row1_col1" class="data row1 col1">0.643</td>
<td id="T_5647b_row1_col2" class="data row1 col2">0.000</td>
<td id="T_5647b_row1_col3" class="data row1 col3">0.000</td>
<td id="T_5647b_row1_col4" class="data row1 col4">0.000</td>
<td id="T_5647b_row1_col5" class="data row1 col5">0.000</td>
<td id="T_5647b_row1_col6" class="data row1 col6">0.000</td>
<td id="T_5647b_row1_col7" class="data row1 col7">0.000</td>
<td id="T_5647b_row1_col8" class="data row1 col8">0.000</td>
</tr>
<tr class="odd">
<td id="T_5647b_row2_col0" class="data row2 col0">0.333</td>
<td id="T_5647b_row2_col1" class="data row2 col1">0.599</td>
<td id="T_5647b_row2_col2" class="data row2 col2">0.067</td>
<td id="T_5647b_row2_col3" class="data row2 col3">0.000</td>
<td id="T_5647b_row2_col4" class="data row2 col4">0.000</td>
<td id="T_5647b_row2_col5" class="data row2 col5">0.000</td>
<td id="T_5647b_row2_col6" class="data row2 col6">0.000</td>
<td id="T_5647b_row2_col7" class="data row2 col7">0.000</td>
<td id="T_5647b_row2_col8" class="data row2 col8">0.000</td>
</tr>
<tr class="even">
<td id="T_5647b_row3_col0" class="data row3 col0">0.331</td>
<td id="T_5647b_row3_col1" class="data row3 col1">0.596</td>
<td id="T_5647b_row3_col2" class="data row3 col2">0.067</td>
<td id="T_5647b_row3_col3" class="data row3 col3">0.006</td>
<td id="T_5647b_row3_col4" class="data row3 col4">0.000</td>
<td id="T_5647b_row3_col5" class="data row3 col5">0.000</td>
<td id="T_5647b_row3_col6" class="data row3 col6">0.000</td>
<td id="T_5647b_row3_col7" class="data row3 col7">0.000</td>
<td id="T_5647b_row3_col8" class="data row3 col8">0.000</td>
</tr>
<tr class="odd">
<td id="T_5647b_row4_col0" class="data row4 col0">0.226</td>
<td id="T_5647b_row4_col1" class="data row4 col1">0.407</td>
<td id="T_5647b_row4_col2" class="data row4 col2">0.046</td>
<td id="T_5647b_row4_col3" class="data row4 col3">0.004</td>
<td id="T_5647b_row4_col4" class="data row4 col4">0.317</td>
<td id="T_5647b_row4_col5" class="data row4 col5">0.000</td>
<td id="T_5647b_row4_col6" class="data row4 col6">0.000</td>
<td id="T_5647b_row4_col7" class="data row4 col7">0.000</td>
<td id="T_5647b_row4_col8" class="data row4 col8">0.000</td>
</tr>
<tr class="even">
<td id="T_5647b_row5_col0" class="data row5 col0">0.216</td>
<td id="T_5647b_row5_col1" class="data row5 col1">0.389</td>
<td id="T_5647b_row5_col2" class="data row5 col2">0.044</td>
<td id="T_5647b_row5_col3" class="data row5 col3">0.004</td>
<td id="T_5647b_row5_col4" class="data row5 col4">0.304</td>
<td id="T_5647b_row5_col5" class="data row5 col5">0.044</td>
<td id="T_5647b_row5_col6" class="data row5 col6">0.000</td>
<td id="T_5647b_row5_col7" class="data row5 col7">0.000</td>
<td id="T_5647b_row5_col8" class="data row5 col8">0.000</td>
</tr>
<tr class="odd">
<td id="T_5647b_row6_col0" class="data row6 col0">0.152</td>
<td id="T_5647b_row6_col1" class="data row6 col1">0.273</td>
<td id="T_5647b_row6_col2" class="data row6 col2">0.031</td>
<td id="T_5647b_row6_col3" class="data row6 col3">0.003</td>
<td id="T_5647b_row6_col4" class="data row6 col4">0.213</td>
<td id="T_5647b_row6_col5" class="data row6 col5">0.031</td>
<td id="T_5647b_row6_col6" class="data row6 col6">0.298</td>
<td id="T_5647b_row6_col7" class="data row6 col7">0.000</td>
<td id="T_5647b_row6_col8" class="data row6 col8">0.000</td>
</tr>
<tr class="even">
<td id="T_5647b_row7_col0" class="data row7 col0">0.147</td>
<td id="T_5647b_row7_col1" class="data row7 col1">0.265</td>
<td id="T_5647b_row7_col2" class="data row7 col2">0.030</td>
<td id="T_5647b_row7_col3" class="data row7 col3">0.003</td>
<td id="T_5647b_row7_col4" class="data row7 col4">0.207</td>
<td id="T_5647b_row7_col5" class="data row7 col5">0.030</td>
<td id="T_5647b_row7_col6" class="data row7 col6">0.289</td>
<td id="T_5647b_row7_col7" class="data row7 col7">0.030</td>
<td id="T_5647b_row7_col8" class="data row7 col8">0.000</td>
</tr>
<tr class="odd">
<td id="T_5647b_row8_col0" class="data row8 col0">0.114</td>
<td id="T_5647b_row8_col1" class="data row8 col1">0.205</td>
<td id="T_5647b_row8_col2" class="data row8 col2">0.023</td>
<td id="T_5647b_row8_col3" class="data row8 col3">0.002</td>
<td id="T_5647b_row8_col4" class="data row8 col4">0.160</td>
<td id="T_5647b_row8_col5" class="data row8 col5">0.023</td>
<td id="T_5647b_row8_col6" class="data row8 col6">0.224</td>
<td id="T_5647b_row8_col7" class="data row8 col7">0.023</td>
<td id="T_5647b_row8_col8" class="data row8 col8">0.226</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If you want to see this in action, I recommend Karpathy’s video <span class="citation" data-cites="andrej_karpathy_lets_2023">[2]</span> at around <a href="https://youtu.be/kCc8FmEb1nY?t=3368">56 minutes in</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Transformer can operate on the the above array <em>all at once</em>, in parallel — BLAM! So, even though we say the model is “autoregressive” that doesn’t mean it has to “wait” until it’s generated one word first before it generates the next word. This model can actually generate entire sentences or even entire paragraphs (or more) <em>all in one step</em>. This (parallelism-based) speed is another key reason why large companies like these models. ;-)</p>
</div>
</div>
</section></details>
</section>

<section id="sec-nextup" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Summary and Further Topics</h1>
<p>We’ve looked at the main dynamic in Transformer models, namely the Attention process. We now have a grasp of not only what it is and how it works, but why it fulfills its intended purpose well. There’s a lot more we could still cover, but I’m going to stop here for now. To fully explain the Transformer model, we’ll want to take a look at Positional Encoding, residual connections, and more.</p>
<p>However, now that you’re (hopefully) over the basic “hump” of the Attention mechanism, you may find the rest of the Transformer model to be fairly straightforward. You should be able to read any other guide to Transformer models and they should make <em>a lot</em> more sense now – or wait until I write a follow-up post! For now, check out the <strong>References</strong> in Section&nbsp;8 below for a list of good resources you can use to carry on with your studies.</p>
</section>
<section id="afterward-i-wrote-a-song" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Afterward: I Wrote A Song</h1>
<p>While I was away on a solo writer’s retreat to a shack in the woods, I started fiddling with a little song idea inspired by this tweet:</p>
<div class="cell">
<div class="cell-output cell-output-display">

<blockquote class="twitter-tweet blockquote"><p lang="en" dir="ltr">"Traumatized Transformers": In which certain words are intrinsically weighted more that others.<br>(alternately, "Annoying Transformers Who Won't Shut Up About Their Favorite Topics")</p>— Horrific ML Ideas (@ml_ideas) <a href="https://twitter.com/ml_ideas/status/1683716504821325824?ref_src=twsrc%5Etfw">July 25, 2023</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
</div>
<p>Here’s a video of a rough take I sent to friends:</p>
<div class="cell">
<div class="cell-output cell-output-display">

<iframe width="560" height="315" src="https://www.youtube.com/embed/W65eENFUM_0?start=28" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="sec-references" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> References</h1>
<p>I recommend any of the following. Seriously, I studied all of these and they’re great. Things just didn’t “click” for me until later in life I guess. LOL.</p>
<p>My trajectory was first the original paper<span class="citation" data-cites="aiayn">[1]</span>, then Jay Alammar’s “The Illustrated Transformer” <span class="citation" data-cites="alammar_illustrated">[6]</span>, then the Coursera course <span class="citation" data-cites="coursera">[7]</span> co-taught by one of the original Transformer paper authors, then Brendan Rohrer’s great post <span class="citation" data-cites="rohrer">[8]</span>, then Jeremy Jordan’s tutorial <span class="citation" data-cites="jeremyj_transformers">[9]</span>. Then a couple of years later Karpathy’s video <span class="citation" data-cites="andrej_karpathy_lets_2023">[2]</span>, with a follow-up of CodeEmporiums’s video <span class="citation" data-cites="codeemporium">[10]</span>. But hopefully after reading my post(s) you won’t need to do all that!</p>
<p>I also recommend Daniel Dugas’ “GPT on a Napkin” <span class="citation" data-cites="dugas_gpt_napkin">[11]</span> and Sebastian Rashka’s post on Attention <span class="citation" data-cites="raschka_understanding_attn">[12]</span>, but didn’t learn of these until after I started writing this post.</p>
<div id="refs" class="references csl-bib-body">
<div id="ref-aiayn" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">A. Vaswani <em>et al.</em>, <span>“Attention is <span>All</span> you <span>Need</span>,”</span> in <em>Advances in <span>Neural</span> <span>Information</span> <span>Processing</span> <span>Systems</span></em>, I. Guyon, U. V. Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, Eds., Curran Associates, Inc., 2017. Available: <a href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a></div>
</div>
<div id="ref-andrej_karpathy_lets_2023" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">A. Karpathy, <span>“Let’s build <span>GPT</span>: From scratch, in code, spelled out.”</span> Jan. 2023. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://www.youtube.com/watch?v=kCc8FmEb1nY">https://www.youtube.com/watch?v=kCc8FmEb1nY</a></div>
</div>
<div id="ref-vit_paper" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">A. Dosovitskiy <em>et al.</em>, <span>“An <span>Image</span> is <span>Worth</span> 16x16 <span>Words</span>: <span>Transformers</span> for <span>Image</span> <span>Recognition</span> at <span>Scale</span>,”</span> Oct. 2020. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://openreview.net/forum?id=YicbFdNTTy">https://openreview.net/forum?id=YicbFdNTTy</a></div>
</div>
<div id="ref-bahdanau_attn" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">D. Bahdanau, K. Cho, and Y. Bengio, <span>“Neural machine translation by jointly learning to align and translate,”</span> in <em>3rd international conference on learning representations, <span>ICLR</span> 2015, san diego, CA, USA, may 7-9, 2015, conference track proceedings</em>, Y. Bengio and Y. LeCun, Eds., 2015. Available: <a href="http://arxiv.org/abs/1409.0473">http://arxiv.org/abs/1409.0473</a></div>
</div>
<div id="ref-blog-vec-orthog" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">S. H. Hawley, <span>“Likelihood of vector orthogonality in high-dimensional spaces.”</span> Jan. 2022. Accessed: Aug. 18, 2023. [Online]. Available: <a href="https://drscotthawley.github.io/blog/posts/2022-01-24-multidim-dotproducts.html">https://drscotthawley.github.io/blog/posts/2022-01-24-multidim-dotproducts.html</a></div>
</div>
<div id="ref-alammar_illustrated" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">J. Alammar, <span>“The <span>Illustrated</span> <span>Transformer</span>.”</span> Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://jalammar.github.io/illustrated-transformer/">https://jalammar.github.io/illustrated-transformer/</a></div>
</div>
<div id="ref-coursera" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">Y. B. Mourri and Ł. Kaiser, <span>“Natural <span>Language</span> <span>Processing</span> with <span>Attention</span> <span>Models</span>,”</span> <em>Coursera</em>. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://www.coursera.org/learn/attention-models-in-nlp">https://www.coursera.org/learn/attention-models-in-nlp</a></div>
</div>
<div id="ref-rohrer" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">B. Rohrer, <span>“Transformers from <span>Scratch</span>.”</span> Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://e2eml.school/transformers.html">https://e2eml.school/transformers.html</a></div>
</div>
<div id="ref-jeremyj_transformers" class="csl-entry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">J. Jordan, <span>“Understanding the <span>Transformer</span> architecture for neural networks,”</span> <em>Jeremy Jordan</em>. May 2023. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://www.jeremyjordan.me/transformer-architecture/">https://www.jeremyjordan.me/transformer-architecture/</a></div>
</div>
<div id="ref-codeemporium" class="csl-entry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">CodeEmporium, <span>“Transformer <span>Decoder</span> coded from scratch.”</span> Mar. 2023. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://www.youtube.com/watch?v=MqDehUoMk-E">https://www.youtube.com/watch?v=MqDehUoMk-E</a></div>
</div>
<div id="ref-dugas_gpt_napkin" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">D. Dugas, <span>“The <span>GPT</span>-3 <span>Architecture</span>, on a <span>Napkin</span>.”</span> Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://dugas.ch/artificial_curiosity/GPT_architecture.html">https://dugas.ch/artificial_curiosity/GPT_architecture.html</a></div>
</div>
<div id="ref-raschka_understanding_attn" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">S. Raschka, <span>“Understanding and <span>Coding</span> the <span>Self</span>-<span>Attention</span> <span>Mechanism</span> of <span>Large</span> <span>Language</span> <span>Models</span> <span>From</span> <span>Scratch</span>,”</span> <em>Sebastian Raschka, PhD</em>. Accessed: Aug. 10, 2023. [Online]. Available: <a href="https://sebastianraschka.com/blog/2023/self-attention-from-scratch.html">https://sebastianraschka.com/blog/2023/self-attention-from-scratch.html</a></div>
</div>
</div>
</section>
<section id="sec-softmax-fun" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Appendix: Fun with Softmax - Interactive!</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section is optional.</p>
</div>
</div>
<p>By rescaling the inputs to the softmax function (i.e., the “logits”), we can change the “sharpness” of the result. Try playing with the slider below to rescale the sample weights from our introductory sentence!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" data-startfrom="2" data-source-offset="-1" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1;"><span id="cb9-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> {plotter} <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@kjerandp/plotter"</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// This is written in Observable JS, cf. https://quarto.org/docs/interactive/ojs/</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply_s</span>(logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> s) {</span>
<span id="cb9-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) { <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0e-8</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  </span>
<span id="cb9-7">}</span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">softmax</span>(logits) {</span>
<span id="cb9-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> maxLogit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span>logits)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">=&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> maxLogit))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">const</span> denom <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scores<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>((a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> b) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">=&gt;</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> scores<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(s <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">=&gt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-14">}</span>
<span id="cb9-15"></span>
<span id="cb9-16"></span>
<span id="cb9-17">words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Please'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'go'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'to'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'the'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'store'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'and'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'get'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'some'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'milk'</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-18">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> words<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span></span>
<span id="cb9-19">attn_weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.114</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.205</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.002</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.160</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.224</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.023</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.226</span>]</span>
<span id="cb9-20">logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_weights<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">=&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0e-8</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-21"></span>
<span id="cb9-22">viewof s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sharpness S:"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">width</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">460</span>})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-23">numbers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">softmax</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply_s</span>(logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>s))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-24"></span>
<span id="cb9-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// make a bar plot manually by plotting a bunch of rectangles. </span></span>
<span id="cb9-26">xlocs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-27">basic_plot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb9-28">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">let</span> p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotter</span>( {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">height</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">width</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">xDomain</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [xlocs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xlocs[n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">yDomain</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-.</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">xLabel</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">yLabel</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'softmax(xS)'</span> } )<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-29">  p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'softmax(xS/(1-S))'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'white'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">weight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">anchor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'start'</span> })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-30">  p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xlocs[n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-.</span><span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">02</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'white'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">weight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-31">  p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rectangle</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">fill</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'white'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">opacity</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// background</span></span>
<span id="cb9-32"></span>
<span id="cb9-33">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb9-34">      p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rectangle</span>(xlocs[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> numbers[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xlocs[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">fill</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cyan'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">opacity</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span> })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-35">      p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(words[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xlocs[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-.</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'yellow'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">weight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> } )</span>
<span id="cb9-36">      p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(numbers[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xlocs[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> numbers[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+.</span><span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">weight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> } )</span>
<span id="cb9-37">  }</span>
<span id="cb9-38">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-39">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p>For a “sharpness” parameter <img src="https://latex.codecogs.com/png.latex?S=0.5">, we have normal softmax. Whereas for <img src="https://latex.codecogs.com/png.latex?S=0"> we turn softmax into an <em>ordinary average</em>, and for <img src="https://latex.codecogs.com/png.latex?S=1"> we return <em>only the maximum</em> input. (For those in the know, this is like a thermodynamic system with temperature <img src="https://latex.codecogs.com/png.latex?%5C,T%20=%20(1-S)/S">.) So softmax is a pretty versatile tool!<img src="https://latex.codecogs.com/png.latex?%5E*"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5E*"><small>Oooo and if you really want to dive deep, look up “Gumbel-Softmax Trick.” But that’s for another day.</small></p>
<hr>
<p>(c) 2023 Scott H. Hawley</p>


</section>

 ]]></description>
  <category>nlp</category>
  <category>architectures</category>
  <guid>https://drscotthawley.github.io/blog/posts/Transformers1-Attention.html</guid>
  <pubDate>Mon, 21 Aug 2023 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/TransformerOvalInOut.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>Residual Vector Quantization</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>“Vector Quantization.” Sounds intimidating. “Residual Vector Quantization” sounds even more intimidating, even near-meaningless to most people. Turns out, these are easy to understand given a few pictures, even to the point a child could understand them – uh… if the child <em>wanted</em> to. Certainly, there can be sophisticated ways to implement these algorithms, and we’ll cover a bit of that later on, but the basics are very simple.</p>
<p>Residual Vector Quantization (RVQ) is a <a href="https://www.instagram.com/p/CteX0esglU-/">data compression</a> technique found in state-of-the-art neural audio codecs such as Google’s <a href="https://ai.googleblog.com/2021/08/soundstream-end-to-end-neural-audio.html">SoundStream</a>, and Facebook/Meta AI’s <a href="https://github.com/facebookresearch/encodec">Encodec</a>, which in turn form the backbone of generative audio models such as <a href="https://google-research.github.io/seanet/audiolm/examples/">AudioLM</a> (Google) and <a href="https://ai.honu.io/papers/musicgen/">MusicGen</a> (Facebook). It’s also the subject of Lucidrain’s library <a href="https://github.com/lucidrains/vector-quantize-pytorch"><code>vector-quantize-pytorch</code></a>, which we’ll use toward the end because it’s <em>so fast</em> and <em>so good</em>.</p>
<p>What is RVQ and how does it work?</p>
<p>First we should consider regular vector quantization (VQ). VQ has been around for decades, and it shows up in many areas of signal processing when compression is involved.</p>
<blockquote class="blockquote">
<p>Note: Whenever I say something that applies to both VQ and RVQ, I’ll use the abbreviation “(R)VQ.”</p>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Two Analogies
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Cities and Towns:</strong> RVQ is like a “hub-and-spoke” <em>graph</em> that often appears in logistics: Consider air travel, in which the major cities are “hubs” (Chicago, LA, Atlanta) from which you take smaller flights to get to smaller cities and towns. VQ would be like replacing every address with its nearest town – which could result in a lot of vectors! RVQ means we have a short list of hubs, then from each hub we have a list of smaller cities, from which we could then have lists connecting smaller cities to nearby towns.</p></li>
<li><p><strong>Numbers and Digits:</strong> In one dimension, RVQ is like the way we represent numbers using digits. Instead of creating 10,000 separate categories for each of the integers from 0 to 9999, we use 4 “codebooks” (for thousands, hundreds, tens, and ones) consisting of the ten digits 0 through 9. 4 * 10 = 40, which is a lot less than 10,000! We even can represent real numbers to arbitrary precision by using more codebooks to include ever-smaller “residual vectors” to the right of the decimal point.</p></li>
</ol>
</div>
</div>
</section>
<section id="vector-quantization-partitioning-space" class="level2">
<h2 class="anchored" data-anchor-id="vector-quantization-partitioning-space">Vector Quantization = Partitioning Space</h2>
<p>“Vector Quantization” is really about dividing up the space of your data points into a discrete set of regions. Put differently, we “partition” the space.</p>
<p>Let’s say we have a bunch of points in space:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make some data</span></span>
<span id="cb1-5">n_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb1-6">DATA_MIN, DATA_MAX <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we'll let these be globals</span></span>
<span id="cb1-7">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility</span></span>
<span id="cb1-8">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (DATA_MAX<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(n_points, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot it</span></span>
<span id="cb1-11">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb1-12">ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb1-13">ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ax.set_xticks([])  # hide axis ticks</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ax.set_yticks([])</span></span>
<span id="cb1-16">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)</span>
<span id="cb1-17">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>)</span>
<span id="cb1-18">plt.scatter(data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb1-19">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-dots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-dots-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;1<strong>.</strong> A set of data points, aka ‘vectors’.</figcaption>
</figure>
</div>
</div>
</div>
<p>To computer scientists, the <img src="https://latex.codecogs.com/png.latex?(x,y)"> coordinates of each point define a “vector”. (To mathematicians and physicists, the “vector” points from the origin to each point, but that distinction isn’t going to matter to us.)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Clarification
</div>
</div>
<div class="callout-body-container callout-body">
<p>For neural audio codecs, the vectors could be vertical slices (columns) from an audio spectrogram, i.e., a list of amplitudes for a set of frequencies that were found over a short time interval called a “frame.” More often, however, the vectors are <em>themselves</em> the outputs of some other audio encoder (e.g.&nbsp;a Convolutional Neural Network), and the (R)VQ is done to compress <em>those</em> encoded vectors even more in order to do things like <a href="https://github.com/CompVis/latent-diffusion">Latent Diffusion</a>.</p>
</div>
</div>
<p>Now divide up the space into a bunch of regions. How we do that can take many forms. For now, just consider the two examples of my hand drawing with colors, and a set of tiled squares. There are “fancier” algorithms to partition the space in a way that best “fits” the data (e.g., see “k-Means”, below). We can cover schemes like the third image later.</p>
<!--- ::: {layout-ncol=2 label="fig-region-options" fig-cap="Two ways of partitioning space"} -->
<div id="fig-regions2" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hand" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/dots_square_handregions.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(a) By hand</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-lilsquares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/dots_squares_basic.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(b) Squares</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-lilsquares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/vq_aalto_sm.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(c) Fancy (credit: Aalto University, Finland)</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;2<strong>.</strong> Examples of ways to divide up or “quantize” space, aka “Partitioning schemes.”</figcaption><p></p>
</figure>
</div>
<p>Moving forward, I can do a bit more code-wise with the squares, so let’s start there. ;-)</p>
<p>Let me just formalize that a bit: We’ll let the number of squares be controlled by the variable “<code>n_grid</code>”. So for our two-dimensional examples, there will be <code>n_grid</code><img src="https://latex.codecogs.com/png.latex?%5E2"> square regions.</p>
<p>With vector quantization, we give an index value to every region (e.g.&nbsp;0 to 24 for a 5x5 square grid), and then we <strong><em>replace each vector’s value with the index of the region</em></strong>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| code-fold: true</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| code-summary: "Show the code"</span></span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd </span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_data_grid(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_indices<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, </span>
<span id="cb2-6">                   show_next_level_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb2-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"big ol' workhorse plotting routine that we'll progressively make use of as the lesson proceeds"</span></span>
<span id="cb2-8">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb2-9">    h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb2-10">    ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb2-11">    ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb2-12"></span>
<span id="cb2-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb2-14">        ax.axhline(DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb2-15">        ax.axvline(DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb2-16">        </span>
<span id="cb2-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_indices:</span>
<span id="cb2-18">        index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb2-20">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb2-21">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb2-22">                y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb2-23">                ax.text(x, y, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(index), ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb2-24">                index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-25"></span>
<span id="cb2-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_centroids: </span>
<span id="cb2-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb2-28">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb2-29">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h</span>
<span id="cb2-30">                y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h</span>
<span id="cb2-31">                ax.plot(x, y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ro'</span>, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb2-32">                </span>
<span id="cb2-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> hide_tick_labels:</span>
<span id="cb2-34">        ax.set_xticks([])</span>
<span id="cb2-35">        ax.set_yticks([])</span>
<span id="cb2-36"></span>
<span id="cb2-37">    ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb2-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> data <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb2-39">        plt.scatter(data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb2-40">    plt.show()</span>
<span id="cb2-41">    </span>
<span id="cb2-42">    </span>
<span id="cb2-43">n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb2-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot_data_grid(data, n_grid=n_grid)</span></span>
<span id="cb2-45">plot_data_grid(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_indices<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-indices" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-indices-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;3<strong>.</strong> (Integer) Indices for each region.</figcaption>
</figure>
</div>
</div>
</div>
<p>For each of the “vectors” represented by the data points, we no longer use the (<img src="https://latex.codecogs.com/png.latex?x">,<img src="https://latex.codecogs.com/png.latex?y">) coordinate pairs, but rather the (integer) index of the region it’s in.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ve gone from needing two floating point numbers per point to just one integer value. In two dimensions, the “savings” or data-compression amount that we get from that may not be readily apparent, but stick around: As we go to large numbers of dimensions later, this scheme will save us a <em>ton</em> of data.</p>
</div>
</div>
<p>If we want the coordinates that go with the indices, we’ll use the centroid of each region. In this sense, the vectors are “quantized” so that they can only take on values given by the centroids of the regions. In the following example, the centroids are shown in red:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">plot_data_grid(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_indices<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, </span>
<span id="cb3-2">               show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-centroids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-centroids-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;4<strong>.</strong> Centroid locations</figcaption>
</figure>
</div>
</div>
</div>
<p>So each blue point will effectively be replaced by the nearest red point. In this sense we have “quantized” the vectors (because we’ve quantized the space itself).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology
</div>
</div>
<div class="callout-body-container callout-body">
<p>The set of locations of centroids is called the “<strong>codebook</strong>”. When we want to use an actual vector value (in space), we convert the codebook index into a (centroid) location by looking up the codebook.</p>
</div>
</div>
<!--
For reasons of simplicity (/laziness) that will become clear later, for this blog post we'll choose coordinates where our space is centered on (0,0), and has a span of (1,1) across it. So that means the space will go from (-0.5,-0.5) to (0.5,0.5).  This choice of coordinates doesn't change the basic mechanics of (R)VQ, it just means less work to do later. -->
<p>So a full (albeit unweidly) picture showing the data points, the region indices, and the centroids, looks like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">plot_data_grid(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_indices<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-detailed-squares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-detailed-squares-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;5<strong>.</strong> Detailed figure showing data points, region indices, and centroid locations.</figcaption>
</figure>
</div>
</div>
</div>
<p>For our choice of coordinates, the codebook (i.e.&nbsp;the mapping of indices to centroid locations) looks like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> display, Markdown</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate_codebook(n_grid, n_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, debug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb5-4">    n_gridpoints <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> n_dim</span>
<span id="cb5-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> debug: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"generate_codebook: n_grid = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, n_dim = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_dim<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, n_gridpoints = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n_gridpoints<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-6">    centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.empty((n_gridpoints, n_dim))</span>
<span id="cb5-7">    h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (DATA_MAX <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid</span>
<span id="cb5-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_dim):</span>
<span id="cb5-9">        coords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, DATA_MAX <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, n_grid)</span>
<span id="cb5-10">        coords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(coords, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(n_gridpoints <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb5-11">        coords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.repeat(coords, n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> i)</span>
<span id="cb5-12">        centroids[:, i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coords</span>
<span id="cb5-13"></span>
<span id="cb5-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> centroids</span>
<span id="cb5-15"></span>
<span id="cb5-16"></span>
<span id="cb5-17">codebook <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_codebook(n_grid)</span>
<span id="cb5-18"></span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print it nicely</span></span>
<span id="cb5-21">cb_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"| index      | vector |</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">| ----------- | ----------- |"</span></span>
<span id="cb5-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(codebook.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]):</span>
<span id="cb5-23">    cb_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">| </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> | (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>codebook[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>codebook[i,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) |"</span></span>
<span id="cb5-24">display(Markdown(cb_str))</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th>index</th>
<th>vector</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>(-0.4, -0.4)</td>
</tr>
<tr class="even">
<td>1</td>
<td>(-0.2, -0.4)</td>
</tr>
<tr class="odd">
<td>2</td>
<td>(0.0, -0.4)</td>
</tr>
<tr class="even">
<td>3</td>
<td>(0.2, -0.4)</td>
</tr>
<tr class="odd">
<td>4</td>
<td>(0.4, -0.4)</td>
</tr>
<tr class="even">
<td>5</td>
<td>(-0.4, -0.2)</td>
</tr>
<tr class="odd">
<td>6</td>
<td>(-0.2, -0.2)</td>
</tr>
<tr class="even">
<td>7</td>
<td>(0.0, -0.2)</td>
</tr>
<tr class="odd">
<td>8</td>
<td>(0.2, -0.2)</td>
</tr>
<tr class="even">
<td>9</td>
<td>(0.4, -0.2)</td>
</tr>
<tr class="odd">
<td>10</td>
<td>(-0.4, 0.0)</td>
</tr>
<tr class="even">
<td>11</td>
<td>(-0.2, 0.0)</td>
</tr>
<tr class="odd">
<td>12</td>
<td>(0.0, 0.0)</td>
</tr>
<tr class="even">
<td>13</td>
<td>(0.2, 0.0)</td>
</tr>
<tr class="odd">
<td>14</td>
<td>(0.4, 0.0)</td>
</tr>
<tr class="even">
<td>15</td>
<td>(-0.4, 0.2)</td>
</tr>
<tr class="odd">
<td>16</td>
<td>(-0.2, 0.2)</td>
</tr>
<tr class="even">
<td>17</td>
<td>(0.0, 0.2)</td>
</tr>
<tr class="odd">
<td>18</td>
<td>(0.2, 0.2)</td>
</tr>
<tr class="even">
<td>19</td>
<td>(0.4, 0.2)</td>
</tr>
<tr class="odd">
<td>20</td>
<td>(-0.4, 0.4)</td>
</tr>
<tr class="even">
<td>21</td>
<td>(-0.2, 0.4)</td>
</tr>
<tr class="odd">
<td>22</td>
<td>(0.0, 0.4)</td>
</tr>
<tr class="even">
<td>23</td>
<td>(0.2, 0.4)</td>
</tr>
<tr class="odd">
<td>24</td>
<td>(0.4, 0.4)</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="reconstruction-error" class="level3">
<h3 class="anchored" data-anchor-id="reconstruction-error">Reconstruction Error</h3>
<p>When we do this quantization (i.e.&nbsp;replacing vectors by their nearest centroid), the centroid locations will naturally be a bit “off” compared to the original data vectors themselves. The finer the grid you make, the smaller the regions, and the less error. For a 2D grid, the error will be on the order of <img src="https://latex.codecogs.com/png.latex?h%5E2"> where <img src="https://latex.codecogs.com/png.latex?h"> is the grid spacing (<img src="https://latex.codecogs.com/png.latex?h"> = 1/5 = 0.2 in our example).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the vectors in the codebook are <em>not</em> “basis vectors”: We do not add linear combinations of the codebook vectors, as that would not be “quantization” (and would subject us to the same number of data points as the original, resulting in nearly no compression). VQ helps us get around some problems of having large numbers of data points by approximating them by their nearest codebook vectors, and the R in RVQ allows us to increase the provide for good “resolution” within the space <em>without</em> requiring extremely long codebooks.</p>
</div>
</div>
<p>Let’s check how the error changes as we vary the grid spacing, i.e., as we vary <code>n_grid</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> find_closest_centroids(data, codebook):</span>
<span id="cb6-2">    distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>((data[:, np.newaxis] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> codebook) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-3">    closest_centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmin(distances, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> closest_centroids <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indices not coordinates</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> compute_error(data, codebook):</span>
<span id="cb6-7">    n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(np.sqrt(codebook.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span>
<span id="cb6-8">    h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (DATA_MAX <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> DATA_MIN) </span>
<span id="cb6-9">    quantized_ind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> find_closest_centroids(data, codebook)</span>
<span id="cb6-10">    quantized_xy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> codebook[quantized_ind]       </span>
<span id="cb6-11">    error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt( np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>( (data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> quantized_xy)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> ) )</span>
<span id="cb6-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> error </span>
<span id="cb6-13"></span>
<span id="cb6-14">n_points2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb6-15">data2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (DATA_MAX <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(n_points2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-16"></span>
<span id="cb6-17">errors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-18">grids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>])</span>
<span id="cb6-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n_grid2 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> grids:</span>
<span id="cb6-20">    codebook <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_codebook(n_grid2)</span>
<span id="cb6-21">    error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> compute_error(data2, codebook)               </span>
<span id="cb6-22">    errors.append(error)</span>
<span id="cb6-23">    </span>
<span id="cb6-24">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))    </span>
<span id="cb6-25">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].plot(grids, errors, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>)</span>
<span id="cb6-26">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].loglog(grids, errors, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>)</span>
<span id="cb6-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb6-28">    ax[i].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Error'</span>)</span>
<span id="cb6-29">    ax[i].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_grid'</span>)</span>
<span id="cb6-30">plt.show()</span>
<span id="cb6-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"lowest error (for n_grid=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>grids[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) = "</span>,errors[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-error" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-error-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;6<strong>.</strong> Plots of error vs.&nbsp;resolution with linear (left) and logarithmic (right) axes. Note that the computational cost will scale like the number of regions, which is <code>n_grid</code><img src="https://latex.codecogs.com/png.latex?%5E2">.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lowest error (for n_grid=200) =  0.019903707672610238</code></pre>
</div>
</div>
<p>So, the more “gridlines” you use, the lower the error, but at what cost? To get an error of 0.02 we need <img src="https://latex.codecogs.com/png.latex?200%5E2%20=%20400"> regions. And in higher dimensions than 2, the “cost” of higher resolution / lower error goes up <em>immensely</em>: to double the resolution in <img src="https://latex.codecogs.com/png.latex?d"> dimensions, the computational cost goes up by a factor of <img src="https://latex.codecogs.com/png.latex?2%5Ed">. (Imagine <img src="https://latex.codecogs.com/png.latex?d">=32, 64, 128,…)</p>
<p>But we don’t need to cover the entire space uniformly! That’s where Residual Vector Quantization comes in. Feel free to skip ahead to the section on RVQ. For the next bit we’ll take an optional aside to learn about an alternate way to partition space, known as a the “k-Means” algorithm.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Another key point: By replacing all the coordinate values for a vector (i.e.&nbsp;<img src="https://latex.codecogs.com/png.latex?d"> floating point numbers) with a <em>single integer</em>, VQ achieves data compression by a factor of <img src="https://latex.codecogs.com/png.latex?d"> (times however many bit floats take up compared to integers). For large numbers of dimensions – regardless of the partitioning scheme – this compression can be <em>significant</em>.</p>
</div>
</div>
</section>
<section id="k-means-partitioning-scheme" class="level3">
<h3 class="anchored" data-anchor-id="k-means-partitioning-scheme">k-Means (Partitioning Scheme)</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional
</div>
</div>
<div class="callout-body-container callout-body">
<p>This discussion on k-Means is actually not crucial to understanding (R)VQ. At all. It’s quite skippable, to be honest. So…only read if you’re really curious. Otherwise skip down to the section on Residual Vector Quantization.</p>
</div>
</div>
<details>
<summary>
Details on k-Means
</summary>
<p>The k-Means algorithm is another method to partition space, a method that instead of static squares, will allow our regions and centroids to “follow the data”. Often k-Means is used to <em>initialize</em> an RVQ codebook for neural codecs (e.g.&nbsp;in SoundStream, Encodec, etc), after which the rest of the neural network’s training algorithm may refine the codebooks more.</p>
<p>We’ll start with a bunch of data points shown as small dark circles below, and a set of <img src="https://latex.codecogs.com/png.latex?k"> “centroids” shown by the large colored circles. (They’re not actually “centroids” yet but we’ll get there).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lots of imports to try to get the plotly plots and animations to show!</span></span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pio</span>
<span id="cb8-3">pio.renderers.default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span></span>
<span id="cb8-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.express <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> px </span>
<span id="cb8-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotly.offline <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb8-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb8-7">init_notebook_mode(connected<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-8"></span>
<span id="cb8-9"></span>
<span id="cb8-10">ndim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># easier to do in 2d at first</span></span>
<span id="cb8-11">npoints <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb8-12">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-13">datak <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (DATA_MAX<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(npoints, ndim)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make up some random data points</span></span>
<span id="cb8-14"></span>
<span id="cb8-15">k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># k-Means parameter: number of clusters</span></span>
<span id="cb8-16"></span>
<span id="cb8-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start with random centroids</span></span>
<span id="cb8-18">centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(DATA_MAX<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(k, ndim) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't let the starting centroids be on the far edges of the plot</span></span>
<span id="cb8-19">orig_centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> centroids.copy() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save these for later when we'll make a movie</span></span>
<span id="cb8-20"></span>
<span id="cb8-21"></span>
<span id="cb8-22"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_kmeans(data, centroids, cluster_memb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we'll leave a way to color the data points</span></span>
<span id="cb8-23">    all_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate((data,centroids))</span>
<span id="cb8-24">    is_centroid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array( [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> npoints <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(all_data.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])] , np.newaxis)</span>
<span id="cb8-25">    sizes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> is_centroid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-26">    cs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cluster_memb <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> cluster_memb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.zeros( (data.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) ,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>) </span>
<span id="cb8-27">    cs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.append(cs, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(k)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the centroids</span></span>
<span id="cb8-28">    plot_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.column_stack( (all_data, sizes, cs) )</span>
<span id="cb8-29">    columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sizes'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cluster'</span>]</span>
<span id="cb8-30">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame( plot_data,  columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>columns)</span>
<span id="cb8-31">    fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> px.scatter(df, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cluster'</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sizes'</span>,  range_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,k),</span>
<span id="cb8-32">            width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">420</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, color_continuous_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Turbo'</span>)</span>
<span id="cb8-33">    fig.update_layout(margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#template='plotly_dark',)</span></span>
<span id="cb8-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> fig</span>
<span id="cb8-35"></span>
<span id="cb8-36">plot_kmeans(datak, centroids)</span>
<span id="cb8-37">    </span></code></pre></div>
</details>
<div id="fig-kmeans-init" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="50a709ff-d48c-4533-aff9-2a37a8ad8d0f" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("50a709ff-d48c-4533-aff9-2a37a8ad8d0f")) {                    Plotly.newPlot(                        "50a709ff-d48c-4533-aff9-2a37a8ad8d0f",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('50a709ff-d48c-4533-aff9-2a37a8ad8d0f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;7<strong>.</strong> Initial state of k-Means, showing data without any ‘membership’ (dark dots) and random centroid locations (large colored dots)</figcaption>
</figure>
</div>
</div>
<p>That’s our starting points. Then what we’ll do is, we’ll color each point according to which centroid it’s closest to.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yes, this can be <em>very slow</em> for lots of points in many dimensions. There is a whole field of study of how to speed up “nearest neighbors” types of algorithms. We’re going to keep it simple for this demo. Further down, the library we’ll use will actually do an “approximate k-Means” for speed.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> distance(p1, p2):</span>
<span id="cb9-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"euclidean distance squared. we don't need the square root b/c we're only interested in ordering by distance"</span></span>
<span id="cb9-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>((p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> calc_cluster_membership(data, centroids):</span>
<span id="cb9-6">    npoints <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb9-7">    min_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9999</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.ones(npoints)</span>
<span id="cb9-8">    cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(npoints, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb9-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, c <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(centroids): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute distances for all points</span></span>
<span id="cb9-10">        ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> distance(data, c)</span>
<span id="cb9-11">        inds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argwhere(ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_ds)</span>
<span id="cb9-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> inds.size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: </span>
<span id="cb9-13">            min_ds[inds] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds[inds]</span>
<span id="cb9-14">            cluster_memb[inds] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i</span>
<span id="cb9-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cluster_memb)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>npoints <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we're not including the centroids themselves here</span></span>
<span id="cb9-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> cluster_memb</span>
<span id="cb9-17"></span>
<span id="cb9-18">cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb9-19">plot_kmeans(datak, centroids, cluster_memb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster_memb)</span></code></pre></div>
</details>
<div id="fig-kmeans-first" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="f7a4fa35-0d4e-486c-83d6-ea4df59f951e" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7a4fa35-0d4e-486c-83d6-ea4df59f951e")) {                    Plotly.newPlot(                        "f7a4fa35-0d4e-486c-83d6-ea4df59f951e",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f7a4fa35-0d4e-486c-83d6-ea4df59f951e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;8<strong>.</strong> First step in k-Means: Assign ‘membership’ of datapoints to different clusters based on which centroids (large dots) are nearest. Note that the ‘centroids’ in this graph aren’t true centroids yet. We’ll fix them in the next step after this.</figcaption>
</figure>
</div>
</div>
<p>The next step is to recalculate the centroid locations using the points that were assigned to each centroid. And these centroids are just the mean value of the points.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> move_centroids(centroids, data, cluster_memb):</span>
<span id="cb10-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ki <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(centroids.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]):</span>
<span id="cb10-3">        inds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argwhere( cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ki)</span>
<span id="cb10-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> inds.size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb10-5">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dim <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(data.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]):</span>
<span id="cb10-6">                centroids[ki,dim] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(data[inds,dim], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> centroids</span>
<span id="cb10-8"></span>
<span id="cb10-9">centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> move_centroids(centroids, datak, cluster_memb)</span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print("These centroids should be fairly 'centered' in their respective groups of data.")</span></span>
<span id="cb10-11">plot_kmeans(datak, centroids, cluster_memb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster_memb)</span></code></pre></div>
</details>
<div id="fig-kmeans-centroids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="93a25cec-e82e-4ccd-b00c-4937148864f2" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("93a25cec-e82e-4ccd-b00c-4937148864f2")) {                    Plotly.newPlot(                        "93a25cec-e82e-4ccd-b00c-4937148864f2",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('93a25cec-e82e-4ccd-b00c-4937148864f2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;9<strong>.</strong> Next step in k-Means: move centroids so they are in the middle of each cluster</figcaption>
</figure>
</div>
</div>
<p>…But now, having moved the centroids, the nearest-neighbor membership of some of the points may have changed. So we recalculate those:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb11-2">plot_kmeans(datak, centroids, cluster_memb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster_memb)</span></code></pre></div>
</details>
<div id="fig-kmeans-re-member" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="8264910e-1bd2-4635-ac42-66651ce00780" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8264910e-1bd2-4635-ac42-66651ce00780")) {                    Plotly.newPlot(                        "8264910e-1bd2-4635-ac42-66651ce00780",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8264910e-1bd2-4635-ac42-66651ce00780');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;10<strong>.</strong> Next step in k-Means: re-assign cluster membership of point based on new cluster locations</figcaption>
</figure>
</div>
</div>
<p>…And we repeat the process until some stopping criterion is met. For example we may just set a maximum iteration number, or we may stop when the centroids stop moving, or the cluster membership stops changing, etc. For this demo, we’ll just use a maximum number of iterations.</p>
<p>So, a movie of the whole process can look like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> orig_centroids.copy() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start over</span></span>
<span id="cb12-2">cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.zeros( (datak.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) ,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>) </span>
<span id="cb12-3">maxiter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb12-4">plot_kmeans(datak, centroids, cluster_memb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster_memb)</span>
<span id="cb12-5">ts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>maxiter,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb12-6"></span>
<span id="cb12-7">columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sizes'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cluster'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'point_number'</span>]</span>
<span id="cb12-8">total_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> npoints <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># points + clusters</span></span>
<span id="cb12-9">movie_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros( (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>total_points, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(columns)) )  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># giant data array for all data points at all times</span></span>
<span id="cb12-10">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.repeat(ts, total_points)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># t</span></span>
<span id="cb12-11"></span>
<span id="cb12-12">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate( ( datak[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], centroids[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] ) ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial xs</span></span>
<span id="cb12-13">ys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate( ( datak[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], centroids[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] ) ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial ys</span></span>
<span id="cb12-14">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(xs, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts))</span>
<span id="cb12-15">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(ys, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts))</span>
<span id="cb12-16"></span>
<span id="cb12-17">sizes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones(total_points,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb12-18">sizes[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>k:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb12-19">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(sizes, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sizes is repeated for all times</span></span>
<span id="cb12-20"></span>
<span id="cb12-21">cs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.ones(total_points,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb12-22">cs[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>k:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(k, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb12-23">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(cs, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts))</span>
<span id="cb12-24"></span>
<span id="cb12-25">movie_data[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.tile(np.arange(total_points), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ts))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_number is repeated for all time</span></span>
<span id="cb12-26"></span>
<span id="cb12-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ts:</span>
<span id="cb12-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: </span>
<span id="cb12-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">continue</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># leave initial data as step 0</span></span>
<span id="cb12-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: </span>
<span id="cb12-31">        cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb12-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb12-33">        centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> move_centroids(centroids, datak, cluster_memb)</span>
<span id="cb12-34"></span>
<span id="cb12-35">    start, end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>total_points, (t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>total_points  </span>
<span id="cb12-36">    movie_data[start:end, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate( (datak[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], centroids[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) )    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># xs</span></span>
<span id="cb12-37">    movie_data[start:end, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate( (datak[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], centroids[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) )    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ys</span></span>
<span id="cb12-38">    movie_data[start:end, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate( (cluster_memb, np.arange(k, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)) )  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cluster membership</span></span>
<span id="cb12-39">    </span>
<span id="cb12-40">    </span>
<span id="cb12-41">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(movie_data, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>columns)</span>
<span id="cb12-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#df['cluster'] = df['cluster'].astype(int).astype(str) # use discrete colormap</span></span>
<span id="cb12-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#display(df)</span></span>
<span id="cb12-44"></span>
<span id="cb12-45"></span>
<span id="cb12-46">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> px.scatter(df, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, animation_frame<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, animation_group<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point_number"</span>,</span>
<span id="cb12-47">           color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cluster"</span>, hover_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cluster"</span>, hover_data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'point_number'</span>],</span>
<span id="cb12-48">           size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sizes'</span>, width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">420</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">460</span>, range_color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,k), color_continuous_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Turbo'</span></span>
<span id="cb12-49">           )</span>
<span id="cb12-50">fig.update_layout( margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># template='plotly_dark',)</span></span>
<span id="cb12-51">fig.layout.updatemenus[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].buttons[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].args[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transition"</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"duration"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't interpolate frames</span></span>
<span id="cb12-52">display(fig)</span>
<span id="cb12-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print( "Caption: In this movie, each step will either be the 'membership' step or \nthe 'centroid moving' step.")</span></span></code></pre></div>
</details>
<div id="fig-kmeans-movie" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="9bde66d9-76f7-4f42-9fb5-905a05044377" class="plotly-graph-div" style="height:460px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9bde66d9-76f7-4f42-9fb5-905a05044377")) {                    Plotly.newPlot(                        "9bde66d9-76f7-4f42-9fb5-905a05044377",                        [{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=0.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":30,"l":20,"r":20,"b":10},"height":460,"width":420,"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":500,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"&#9654;","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"&#9724;","method":"animate"}],"direction":"left","pad":{"r":10,"t":70},"showactive":false,"type":"buttons","x":0.1,"xanchor":"right","y":0,"yanchor":"top"}],"sliders":[{"active":0,"currentvalue":{"prefix":"t="},"len":0.9,"pad":{"b":10,"t":60},"steps":[{"args":[["0.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"0.0","method":"animate"},{"args":[["1.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"1.0","method":"animate"},{"args":[["2.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"2.0","method":"animate"},{"args":[["3.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"3.0","method":"animate"},{"args":[["4.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"4.0","method":"animate"},{"args":[["5.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"5.0","method":"animate"},{"args":[["6.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"6.0","method":"animate"},{"args":[["7.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"7.0","method":"animate"},{"args":[["8.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"8.0","method":"animate"},{"args":[["9.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"9.0","method":"animate"},{"args":[["10.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"10.0","method":"animate"},{"args":[["11.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"11.0","method":"animate"},{"args":[["12.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"12.0","method":"animate"},{"args":[["13.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"13.0","method":"animate"},{"args":[["14.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"14.0","method":"animate"},{"args":[["15.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"15.0","method":"animate"},{"args":[["16.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"16.0","method":"animate"},{"args":[["17.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"17.0","method":"animate"},{"args":[["18.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"18.0","method":"animate"},{"args":[["19.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"19.0","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}]},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('9bde66d9-76f7-4f42-9fb5-905a05044377', [{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=0.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],"name":"0.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=1.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],"name":"1.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=2.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],"name":"2.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=3.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],"name":"3.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=4.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.37790772772452336,-0.33812634921340606,0.09255627098174209,0.1259974971497314],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.1380965785002598,-0.024751908905440143,-0.22727838184694918,0.37884272277850634],"yaxis":"y","type":"scatter"}],"name":"4.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=5.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.37790772772452336,-0.33812634921340606,0.09255627098174209,0.1259974971497314],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.1380965785002598,-0.024751908905440143,-0.22727838184694918,0.37884272277850634],"yaxis":"y","type":"scatter"}],"name":"5.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=6.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.3497949357807991,-0.3539094544831096,0.02884248681410691,0.09700668269262519],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.13925940815269164,0.0030571989598238095,-0.3163771112817965,0.3703369700893865],"yaxis":"y","type":"scatter"}],"name":"6.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=7.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.3497949357807991,-0.3539094544831096,0.02884248681410691,0.09700668269262519],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.13925940815269164,0.0030571989598238095,-0.3163771112817965,0.3703369700893865],"yaxis":"y","type":"scatter"}],"name":"7.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=8.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.29199323982610076,0.35508338160817193,-0.35330868071671834,-0.09762130360884347,0.06228952743295979],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22572669719391558,0.17351315292739797,0.047291133986268115,-0.37207286235092224,0.36528374699986227],"yaxis":"y","type":"scatter"}],"name":"8.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=9.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.29199323982610076,0.35508338160817193,-0.35330868071671834,-0.09762130360884347,0.06228952743295979],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22572669719391558,0.17351315292739797,0.047291133986268115,-0.37207286235092224,0.36528374699986227],"yaxis":"y","type":"scatter"}],"name":"9.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=10.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.26524154315575504,0.3480235334717306,-0.3457471560130612,-0.19973888565877868,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22274322741347125,0.17931696919891849,0.10663698544949418,-0.38551496105113114,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"10.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=11.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.26524154315575504,0.3480235334717306,-0.3457471560130612,-0.19973888565877868,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22274322741347125,0.17931696919891849,0.10663698544949418,-0.38551496105113114,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"11.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=12.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.2301082297401732,0.3480235334717306,-0.33693649639793505,-0.2820402770712598,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24305459697418308,0.17931696919891849,0.15067799818347158,-0.3602971867710162,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"12.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=13.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.2301082297401732,0.3480235334717306,-0.33693649639793505,-0.2820402770712598,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24305459697418308,0.17931696919891849,0.15067799818347158,-0.3602971867710162,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"13.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=14.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.21224142667856824,0.3480235334717306,-0.3242971106696142,-0.3347551766744631,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2684592041594238,0.17931696919891849,0.18082101355704377,-0.3282365117203218,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"14.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=15.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.21224142667856824,0.3480235334717306,-0.3242971106696142,-0.3347551766744631,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2684592041594238,0.17931696919891849,0.18082101355704377,-0.3282365117203218,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"15.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=16.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.31871472118813665,-0.35647597286232025,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.20032021408628328,-0.2991871031761379,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"16.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=17.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.31871472118813665,-0.35647597286232025,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.20032021408628328,-0.2991871031761379,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"17.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=18.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.3157124414868205,-0.3583077010695947,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.21002893285206703,-0.28795616547831776,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"18.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=19.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.3157124414868205,-0.3583077010695947,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.21002893285206703,-0.28795616547831776,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"19.0"}]);
                        }).then(function(){
                            
var gd = document.getElementById('9bde66d9-76f7-4f42-9fb5-905a05044377');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;11<strong>.</strong> (Interactive) In this movie, each time step is either the ‘cluster membership’ step or the ‘centroid moving’ step.</figcaption>
</figure>
</div>
</div>
<p>For those who are interested, I’ll put the code for a working k-Means algorithm below – it’s short!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> kmeans(data, k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n_iter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>):</span>
<span id="cb13-2">    n_dim, data_min, data_max <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(data), np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(data)</span>
<span id="cb13-3">    centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data_min <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(data_max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>data_min)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(k, n_dim) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random init</span></span>
<span id="cb13-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> it <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_iter):</span>
<span id="cb13-5">        cluster_memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_cluster_membership(data, centroids)</span>
<span id="cb13-6">        centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> move_centroids(centroids, data, cluster_memb)</span>
<span id="cb13-7"></span>
<span id="cb13-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> centroids, cluster_memb</span></code></pre></div>
</div>
<p>The end result of k-Means, since it is a kind of “nearest neighbors” algorithm, is set of vectors grouped according to a “<a href="https://mathworld.wolfram.com/VoronoiDiagram.html">Vornonoi diagram</a>” like the one shown near the beginning of this post, which we’ll show again for good measure:</p>
<div id="fig-regions-kmeans" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/vq_aalto_sm.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;12<strong>.</strong> Space partitioning that can result from k-Means. (Credit: <a href="https://speechprocessingbook.aalto.fi/Modelling/Vector_quantization_VQ.html">Aalto University, Finland</a>)</figcaption>
</figure>
</div>
</details>
</section>
</section>
<section id="residual-vector-quantization-rvq" class="level2">
<h2 class="anchored" data-anchor-id="residual-vector-quantization-rvq">Residual Vector Quantization (RVQ)</h2>
<div class="{callout-note}">
<p>By the way, RVQ has been around for <a href="https://ieeexplore.ieee.org/abstract/document/480761">quite a while</a>.</p>
</div>
<section id="basic-idea-codebooks-in-codebooks" class="level3">
<h3 class="anchored" data-anchor-id="basic-idea-codebooks-in-codebooks">Basic Idea: “Codebooks in Codebooks”</h3>
<p>The trick with RVQ is, rather than having a single high-resolution codebook, to instead have “codebooks inside of codebooks”, or, if you like, “stacking codebooks”. Let’s say we want to quintuple the resolution of our initial 5x5 grid. Instead of using a 25x25 grid (which would be 25x the computational cost of the original), what if we put a little 5x5 grid “inside” the region to which a vector was quantized?</p>
<p>For example, in the “middle” region (region 12), we can do…</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> collections  <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mc</span>
<span id="cb14-2"></span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_region_membership(data:np.array, h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb14-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"Tells which region each point is in. </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TBD</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: this is slow but it works! ;-) "</span></span>
<span id="cb14-6">    memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(data.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.int32)</span>
<span id="cb14-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> codebook <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just assume basic squares</span></span>
<span id="cb14-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> di, p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(data):</span>
<span id="cb14-9">            i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> h</span>
<span id="cb14-10">            j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> h</span>
<span id="cb14-11">            ind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_grid</span>
<span id="cb14-12">            memb[di] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ind</span>
<span id="cb14-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>: </span>
<span id="cb14-14">        memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_cluster_membership(data, codebook)</span>
<span id="cb14-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> memb</span>
<span id="cb14-16"></span>
<span id="cb14-17"></span>
<span id="cb14-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_data_grid_with_resids(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_indices<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, </span>
<span id="cb14-19">                   show_next_level_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, show_resids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, show_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>):</span>
<span id="cb14-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"big ol' workhorse plotting routine that we'll progressively make use of as the lesson proceeds"</span></span>
<span id="cb14-21">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb14-22">    h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb14-23">    ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb14-24">    ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb14-25"></span>
<span id="cb14-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_grid:</span>
<span id="cb14-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):  </span>
<span id="cb14-28">            ax.axhline(DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb14-29">            ax.axvline(DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb14-30">        </span>
<span id="cb14-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_next_level_grid: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># draws lines in the middle</span></span>
<span id="cb14-32">        x_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h</span>
<span id="cb14-33">        y_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb14-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal lines</span></span>
<span id="cb14-35">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid</span>
<span id="cb14-36">            ax.axhline(y, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x_start, xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb14-37">        y_start, x_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_start, y_start</span>
<span id="cb14-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal lines</span></span>
<span id="cb14-39">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid</span>
<span id="cb14-40">            ax.axvline(x, ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_start, ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>h, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb14-41">        </span>
<span id="cb14-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_indices:</span>
<span id="cb14-43">        index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb14-45">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb14-46">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb14-47">                y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_grid</span>
<span id="cb14-48">                ax.text(x, y, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(index), ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb14-49">                index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-50"></span>
<span id="cb14-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_centroids: </span>
<span id="cb14-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb14-53">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_grid):</span>
<span id="cb14-54">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h</span>
<span id="cb14-55">                y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>h</span>
<span id="cb14-56">                ax.plot(x, y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ro'</span>, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb14-57">                </span>
<span id="cb14-58">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> show_resids <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> codebook <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb14-59">        memb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_region_membership(data, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebook)</span>
<span id="cb14-60">        resids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-61">        lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-62">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, p <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(data):</span>
<span id="cb14-63">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#resids[i] = p - codebook[memb[i]] # don't actually need to compute resids for this</span></span>
<span id="cb14-64">            lines.append([p, codebook[memb[i]] ] )</span>
<span id="cb14-65">        lc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mc.LineCollection(lines, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), linewidths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-66">        ax.add_collection(lc)</span>
<span id="cb14-67">        </span>
<span id="cb14-68">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> hide_tick_labels:</span>
<span id="cb14-69">        ax.set_xticks([])</span>
<span id="cb14-70">        ax.set_yticks([])</span>
<span id="cb14-71"></span>
<span id="cb14-72">    ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb14-73">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> data <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb14-74">        plt.scatter(data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb14-75">    plt.show()</span>
<span id="cb14-76">    </span>
<span id="cb14-77">    </span>
<span id="cb14-78">n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb14-79">codebook <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_codebook(n_grid)</span>
<span id="cb14-80">plot_data_grid_with_resids(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_next_level_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb14-81">                           hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebook, show_resids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-basic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-rvq-basic-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;13<strong>.</strong> Illustration of ‘codebook within a codebook’, with a smaller 5x5 codebook which will be relative to the middle region’s codebook.</figcaption>
</figure>
</div>
</div>
</div>
<p>The difference between that blue point in the middle “main” square and its corresponding red centroid will be the “residual”. We will also quantize that within the “little” 5x5 grid. This will serve as a codebook to use “after” the original codebook. And we’ll get the same resolution as if we had a 25x25 grid, except our computational cost will instead be 2*(5*5)=50 instead of 25*25=625! So our cost will be 12.5 smaller than the full-grid approach.</p>
<p>And interestingly, if we only consider the <em>residual</em>, i.e.&nbsp;the difference between the main centroid and the vector in question, then we can use the same “next level” codebook for <em>all</em> points in the space! In the following figure, we show the residuals as purple line segments that run from each point to its corresponding nearest centroid:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">plot_data_grid_with_resids(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_next_level_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb15-2">                           hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>codebook, show_resids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-resids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-rvq-resids-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;14<strong>.</strong> Illustration of redisuals, shown as purple line segments connecting vectors (blue points) with their nearest centroids (red points).</figcaption>
</figure>
</div>
</div>
</div>
<p>Also, because we cleverly set up our data to be centered around the origin <img src="https://latex.codecogs.com/png.latex?(0,0)">, we can treat the original data points as “residuals” relative to the “centroid” of the whole domain, namely the origin!</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">plot_data_grid_with_resids(data, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_grid, show_next_level_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, show_centroids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, </span>
<span id="cb16-2">                           hide_tick_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.zeros((data.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), show_resids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-zero" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-rvq-zero-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;15<strong>.</strong> How we can treat the data points themselves as residuals relative to the origin, for a ‘level 0’ codebook</figcaption>
</figure>
</div>
</div>
</div>
<p>Also because of our clever choice of coordinates, for the next “level” of quantization, we can take the codebook at the next level to be just the previous codebook divided by <code>n_grid</code>! This won’t always be the case; I’m just feeling clever and lazy.</p>
</section>
<section id="quantizer-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="quantizer-algorithm">Quantizer algorithm</h3>
<p>Up til now, we’ve hidden the code by default. But to really get the RVQ method, I’m going to show the code.</p>
<p>Let’s write a general quantizer multiple “levels” of nested codebooks. It will take our data points and return the various levels of codebook indices.</p>
<p>Will be following “Algorithm 1” from page 4 of Google’s 2021 paper “<a href="https://arxiv.org/abs/2107.03312">SoundStream: An End-to-End Neural Audio Codec</a>”:</p>
<div id="fig-soundstream-alg1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/images/soundstream_alg1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;16<strong>.</strong> SoundStream’s RVQ Algorithm</figcaption>
</figure>
</div>
<p>But I like the way I write it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> quantizer(data, codebooks, n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb17-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"this will spit out indices for residuals in a series of 'nested' codebooks"</span></span>
<span id="cb17-3">    resids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data </span>
<span id="cb17-4">    indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb17-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> cb <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> codebooks:</span>
<span id="cb17-6">        indices_l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_region_membership(resids, codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cb)</span>
<span id="cb17-7">        resids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> resids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cb[indices_l]</span>
<span id="cb17-8">        indices.append(indices_l)</span>
<span id="cb17-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.array(indices)</span>
<span id="cb17-10"></span>
<span id="cb17-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the nested codebooks</span></span>
<span id="cb17-12">n_codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb17-13">codebook <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_codebook(n_grid)</span>
<span id="cb17-14">codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [codebook<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>level <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> level <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_codebooks)]</span>
<span id="cb17-15"></span>
<span id="cb17-16">indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> quantizer(data, codebooks)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># call the quantizer</span></span>
<span id="cb17-17">display(indices)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[10,  2,  5,  7,  5, 20,  4, 13, 19, 17, 16, 14, 24,  4, 22, 23,
         4, 21, 19, 11, 13, 12,  4, 18,  4],
       [10, 17,  3,  5, 17,  9,  3, 22,  7, 13, 14,  5,  3, 24, 18,  6,
        24,  6, 17,  8, 10,  1, 21, 12,  3],
       [11,  6, 12,  7, 15, 20, 23,  7, 17, 13,  8, 18,  2,  7, 15, 11,
        16, 20, 23, 13, 11, 24, 18, 10, 20]])</code></pre>
</div>
</div>
<p>Let’s test this by trying to reconstruct our original data using each level of codebook. In the following, the original data will be in blue, and the other colors will show the results of quantization using an increasing number of codebooks:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">K <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_codebooks</span>
<span id="cb19-2">fig, ax_all <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>K, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>(K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb19-3">recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb19-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> axi <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(K):</span>
<span id="cb19-5">    ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax_all[axi]</span>
<span id="cb19-6">    ax.scatter(data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], data[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb19-7">    recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> codebooks[axi][indices[axi]]</span>
<span id="cb19-8">    ax.scatter(recon[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], recon[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>)</span>
<span id="cb19-9">    ax.set_xticks([])</span>
<span id="cb19-10">    ax.set_yticks([])</span>
<span id="cb19-11">    hpos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.81</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>axi <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.25</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.27</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>axi</span>
<span id="cb19-12">    fig.text(hpos, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.05</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>axi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> codebook</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> axi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb19-13"></span>
<span id="cb19-14">    error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).mean()</span>
<span id="cb19-15">    fig.text(hpos, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.0001</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Error = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2e}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb19-16">    </span>
<span id="cb19-17">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-recon" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-rvq-recon-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;17<strong>.</strong> Reconstructing data (blue points) using multiple levels of RVQ codebooks (orange dots)</figcaption>
</figure>
</div>
</div>
</div>
<p>We see that the more (levels of) codebooks we use, the better we can approximate the original data. The rightmost image has an effective resolution of <img src="https://latex.codecogs.com/png.latex?5%5E3%20=%20125"> little squares, but instead uses only <img src="https://latex.codecogs.com/png.latex?5x5x3%20=%2075">. In two dimensions, this is not a huge savings, but let’s see how important this is for higher numbers of dimensions.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?d"> be the number of dimensions and <img src="https://latex.codecogs.com/png.latex?K"> be the number of codebooks (no relation to the k from k-Means, I’m afraid). We’ll populate a d-dimensional hypercube with a lot of data, and subdivide it into nested groups of little hypercubes using RVQ, and compute the error – as well as the compuational cost “savings” from if we had used regular VQ instead of RVQ.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using uniform square/(hyper)cube regions is a <em>really dumb</em> idea for this. Because the number of regions will scale like <code>n_grid</code><img src="https://latex.codecogs.com/png.latex?%5Ed">, which can actually be <em>much</em> larger than the number of data vectors we have! We’ll try a more sophisticated partitioning scheme further below.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#### label: fig-rvq-recon-highdim2</span></span>
<span id="cb20-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#### fig-cap: "Error for high-dimensional datasets using various levels of RVQ. 'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution) vs RVQ"</span></span>
<span id="cb20-3"></span>
<span id="cb20-4">d_choices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can't go much higher with 5x5 uniform grids!</span></span>
<span id="cb20-5">K_choices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variable numbers of codebooks</span></span>
<span id="cb20-6"></span>
<span id="cb20-7">npoints_hd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># points in high-dim spaces</span></span>
<span id="cb20-8"></span>
<span id="cb20-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Here we show the error for high-dimensional datasets using various levels of RVQ."</span>)</span>
<span id="cb20-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution)</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">vs RVQ."</span>)</span>
<span id="cb20-11"></span>
<span id="cb20-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> d_choices:</span>
<span id="cb20-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">d = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span>)</span>
<span id="cb20-14">    np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb20-15">    data_hd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DATA_MIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (DATA_MAX<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>DATA_MIN)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(npoints_hd, d)</span>
<span id="cb20-16">    codebook0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> generate_codebook(n_grid, n_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>d)</span>
<span id="cb20-17">    codebooks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [codebook0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>level <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> level <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(K_choices))] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lets get this over with rather than in the loop</span></span>
<span id="cb20-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> K <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> K_choices: </span>
<span id="cb20-19">        indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> quantizer(data_hd, codebooks)</span>
<span id="cb20-20">        recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data_hd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb20-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> lil_k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(K):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reconstruct using all codebooks</span></span>
<span id="cb20-22">            recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> codebooks[lil_k][indices[lil_k]]</span>
<span id="cb20-23">        error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((recon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data_hd)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).mean()</span>
<span id="cb20-24">        grid_0_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(d)</span>
<span id="cb20-25">        rvq_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_0_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>K </span>
<span id="cb20-26">        uni_res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_0_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>K <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># comparable uniform resolution</span></span>
<span id="cb20-27">        savings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uni_res<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>rvq_points</span>
<span id="cb20-28">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  K = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>K<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, error = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2e}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, cost savings factor = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>savings<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb20-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Here we show the error for high-dimensional datasets using various levels of RVQ.
'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution)
vs RVQ.

d = 2:
  K = 1, error = 3.41e-03, cost savings factor = 1.0
  K = 2, error = 1.29e-04, cost savings factor = 12.5
  K = 3, error = 5.26e-06, cost savings factor = 208.3
  K = 4, error = 2.16e-07, cost savings factor = 3906.2

d = 3:
  K = 1, error = 3.37e-03, cost savings factor = 1.0
  K = 2, error = 1.29e-04, cost savings factor = 62.5
  K = 3, error = 5.31e-06, cost savings factor = 5208.3
  K = 4, error = 2.18e-07, cost savings factor = 488281.2

d = 4:
  K = 1, error = 3.36e-03, cost savings factor = 1.0
  K = 2, error = 1.32e-04, cost savings factor = 312.5
  K = 3, error = 5.34e-06, cost savings factor = 130208.3
  K = 4, error = 2.16e-07, cost savings factor = 61035156.2

d = 6:
  K = 1, error = 3.37e-03, cost savings factor = 1.0
  K = 2, error = 1.33e-04, cost savings factor = 7812.5
  K = 3, error = 5.35e-06, cost savings factor = 81380208.3
  K = 4, error = 2.16e-07, cost savings factor = 953674316406.2</code></pre>
</div>
</div>
<p>Those “cost savings factors” were artifically high though, because we’re still using squares/hypercubes for our regions, and we don’t need to shape them that way and we don’t need <em>that many</em> of them. The great thing about (R)VQ is that you can specify how many centroids you want – i.e.&nbsp;how “long” you want your codebook to be – and you can keep that to some manageable number even as the number of dimensions skyrockets.</p>
<p>So, to tackle higher dimensions, we need to stop using uniform squares so we can have a codebook “length” of less than a few thousand centroids (instead of what just had, which was going into the hundreds of thousands, e.g.&nbsp;<img src="https://latex.codecogs.com/png.latex?5%5E8%20=%20390625">). To get our non-uniform regions that follow the data, we’ll use the k-Means method described above.</p>
<p>Let’s look at how the reconstruction error behaves in high dimensions.</p>
</section>
<section id="error-analysis-exponential-convergence" class="level3">
<h3 class="anchored" data-anchor-id="error-analysis-exponential-convergence">Error Analysis: Exponential Convergence</h3>
<p>We can try a given number of (initially) random centroids, and try to match them to the data via k-Means.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The residuals at different levels of our RVQ calculations will likely have different data distributions. Which means that instead of “sharing (scaled) codebooks” like we did before, we’ll need to re-calculate a new codebook at each “level”. Otherwise we won’t see any advantage from RVQ (trust me I tried).</p>
</div>
</div>
<p>In the following calculation, we’ll vary the number of dimensions, the length of the codebooks, and the number of codebooks, and see how these all affect the reconstruction error.</p>
<p>But rather than using our code, use let’s use the wonderful repository by lucidrains: <a href="https://github.com/lucidrains/vector-quantize-pytorch">lucidrains/vector-quantize-pytorch</a></p>
<p>The following set of error values is a “wall of numbers” which may not interest you. Feel free to scroll past it and skip down to the graphical representation of (some of) the numbers.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb22-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> vector_quantize_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ResidualVQ</span>
<span id="cb22-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> partial </span>
<span id="cb22-4"></span>
<span id="cb22-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> make_pretty(d,styler):</span>
<span id="cb22-6">    styler.set_caption(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"d = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span>)</span>
<span id="cb22-7">    styler.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> e: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:0.1e}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># undo the log op</span></span>
<span id="cb22-8">    styler.background_gradient(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, vmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, vmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plasma"</span>)</span>
<span id="cb22-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> styler</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show_colored_data(results_d, d, cb_lengths, K_choices):</span>
<span id="cb22-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"displays a dataframe table but colors the background according to log10 of the numbers"</span></span>
<span id="cb22-13">    rdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(np.log10(results_d.numpy()), </span>
<span id="cb22-14">                       columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'K = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> K_choices], </span>
<span id="cb22-15">                       index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'cb_len = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> c <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> cb_lengths])</span>
<span id="cb22-16">    ourfunc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> partial(make_pretty,d)</span>
<span id="cb22-17">    display(rdf.style.pipe(ourfunc))</span>
<span id="cb22-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span></span>
<span id="cb22-19"></span>
<span id="cb22-20">n_dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of dimensions</span></span>
<span id="cb22-21">cb_len <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># codebook length</span></span>
<span id="cb22-22">K <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of codebooks</span></span>
<span id="cb22-23">npoints_hd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of data points in high-dim space</span></span>
<span id="cb22-24"></span>
<span id="cb22-25">d_choices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dimensions to try</span></span>
<span id="cb22-26">cb_lengths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>]                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># codebook lengths</span></span>
<span id="cb22-27">K_choices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#,16]                           # variable numbers of codebooks</span></span>
<span id="cb22-28"></span>
<span id="cb22-29">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.empty( ( <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d_choices), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cb_lengths), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(K_choices) )).cpu()</span>
<span id="cb22-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> q1, n_dim <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(d_choices):</span>
<span id="cb22-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(f"\nd={n_dim:4}:       {' '.join([f'      K={i}' for i in K_choices])}")</span></span>
<span id="cb22-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> q2, cb_len <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(cb_lengths):</span>
<span id="cb22-33">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(f"   cb_len={cb_len:4}: ",end="")</span></span>
<span id="cb22-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> q3, K <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(K_choices):</span>
<span id="cb22-35">            </span>
<span id="cb22-36">            residual_vq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ResidualVQ(</span>
<span id="cb22-37">                dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_dim,</span>
<span id="cb22-38">                codebook_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cb_len,</span>
<span id="cb22-39">                num_quantizers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> K,</span>
<span id="cb22-40">                kmeans_init <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set to True</span></span>
<span id="cb22-41">                kmeans_iters <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of kmeans iterations to calculate the centroids for the codebook on init</span></span>
<span id="cb22-42">            )</span>
<span id="cb22-43">            torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb22-44">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, npoints_hd, n_dim)</span>
<span id="cb22-45">            quantized, indices, commit_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> residual_vq(x)</span>
<span id="cb22-46">            error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((quantized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).mean()</span>
<span id="cb22-47">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(f"  {error:.1e} ", end="")</span></span>
<span id="cb22-48">            results[q1,q2,q3] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> error</span>
<span id="cb22-49">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print()</span></span>
<span id="cb22-50">    show_colored_data(results[q1], n_dim, cb_lengths, K_choices)     </span>
<span id="cb22-51">        </span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_09467_row0_col0 {
  background-color: #fdb52e;
  color: #000000;
}
#T_09467_row0_col1 {
  background-color: #f9973f;
  color: #000000;
}
#T_09467_row0_col2 {
  background-color: #f0804e;
  color: #f1f1f1;
}
#T_09467_row0_col3, #T_09467_row1_col2 {
  background-color: #e56b5d;
  color: #f1f1f1;
}
#T_09467_row0_col4 {
  background-color: #ce4b75;
  color: #f1f1f1;
}
#T_09467_row0_col5 {
  background-color: #ad2793;
  color: #f1f1f1;
}
#T_09467_row0_col6 {
  background-color: #8305a7;
  color: #f1f1f1;
}
#T_09467_row1_col0 {
  background-color: #fca934;
  color: #000000;
}
#T_09467_row1_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_09467_row1_col3 {
  background-color: #d6556d;
  color: #f1f1f1;
}
#T_09467_row1_col4 {
  background-color: #b32c8e;
  color: #f1f1f1;
}
#T_09467_row1_col5 {
  background-color: #8606a6;
  color: #f1f1f1;
}
#T_09467_row1_col6 {
  background-color: #5302a3;
  color: #f1f1f1;
}
#T_09467_row2_col0 {
  background-color: #f99a3e;
  color: #000000;
}
#T_09467_row2_col1 {
  background-color: #e76f5a;
  color: #f1f1f1;
}
#T_09467_row2_col2 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_09467_row2_col3 {
  background-color: #bb3488;
  color: #f1f1f1;
}
#T_09467_row2_col4 {
  background-color: #8405a7;
  color: #f1f1f1;
}
#T_09467_row2_col5 {
  background-color: #3f049c;
  color: #f1f1f1;
}
#T_09467_row2_col6, #T_09467_row3_col5, #T_09467_row3_col6, #T_09467_row4_col5, #T_09467_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
#T_09467_row3_col0 {
  background-color: #f48948;
  color: #f1f1f1;
}
#T_09467_row3_col1 {
  background-color: #da5b69;
  color: #f1f1f1;
}
#T_09467_row3_col2 {
  background-color: #c13b82;
  color: #f1f1f1;
}
#T_09467_row3_col3 {
  background-color: #a72197;
  color: #f1f1f1;
}
#T_09467_row3_col4 {
  background-color: #5601a4;
  color: #f1f1f1;
}
#T_09467_row4_col0 {
  background-color: #ee7b51;
  color: #f1f1f1;
}
#T_09467_row4_col1 {
  background-color: #c7427c;
  color: #f1f1f1;
}
#T_09467_row4_col2 {
  background-color: #a21d9a;
  color: #f1f1f1;
}
#T_09467_row4_col3 {
  background-color: #7201a8;
  color: #f1f1f1;
}
#T_09467_row4_col4 {
  background-color: #16078a;
  color: #f1f1f1;
}
</style>

<table id="T_09467" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 2:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_09467_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_09467_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_09467_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_09467_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_09467_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_09467_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_09467_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_09467_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_09467_row0_col0" class="data row0 col0">7.5e-02</td>
<td id="T_09467_row0_col1" class="data row0 col1">6.8e-03</td>
<td id="T_09467_row0_col2" class="data row0 col2">8.9e-04</td>
<td id="T_09467_row0_col3" class="data row0 col3">1.2e-04</td>
<td id="T_09467_row0_col4" class="data row0 col4">4.8e-06</td>
<td id="T_09467_row0_col5" class="data row0 col5">1.1e-07</td>
<td id="T_09467_row0_col6" class="data row0 col6">2.6e-09</td>
</tr>
<tr class="even">
<td id="T_09467_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_09467_row1_col0" class="data row1 col0">3.1e-02</td>
<td id="T_09467_row1_col1" class="data row1 col1">1.7e-03</td>
<td id="T_09467_row1_col2" class="data row1 col2">1.3e-04</td>
<td id="T_09467_row1_col3" class="data row1 col3">1.3e-05</td>
<td id="T_09467_row1_col4" class="data row1 col4">2.1e-07</td>
<td id="T_09467_row1_col5" class="data row1 col5">3.5e-09</td>
<td id="T_09467_row1_col6" class="data row1 col6">6.9e-11</td>
</tr>
<tr class="odd">
<td id="T_09467_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_09467_row2_col0" class="data row2 col0">8.5e-03</td>
<td id="T_09467_row2_col1" class="data row2 col1">1.9e-04</td>
<td id="T_09467_row2_col2" class="data row2 col2">7.4e-06</td>
<td id="T_09467_row2_col3" class="data row2 col3">4.5e-07</td>
<td id="T_09467_row2_col4" class="data row2 col4">3.1e-09</td>
<td id="T_09467_row2_col5" class="data row2 col5">1.8e-11</td>
<td id="T_09467_row2_col6" class="data row2 col6">1.5e-13</td>
</tr>
<tr class="even">
<td id="T_09467_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_09467_row3_col0" class="data row3 col0">2.0e-03</td>
<td id="T_09467_row3_col1" class="data row3 col1">2.4e-05</td>
<td id="T_09467_row3_col2" class="data row3 col2">9.6e-07</td>
<td id="T_09467_row3_col3" class="data row3 col3">6.1e-08</td>
<td id="T_09467_row3_col4" class="data row3 col4">9.4e-11</td>
<td id="T_09467_row3_col5" class="data row3 col5">4.8e-14</td>
<td id="T_09467_row3_col6" class="data row3 col6">3.5e-15</td>
</tr>
<tr class="odd">
<td id="T_09467_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_09467_row4_col0" class="data row4 col0">6.0e-04</td>
<td id="T_09467_row4_col1" class="data row4 col1">1.8e-06</td>
<td id="T_09467_row4_col2" class="data row4 col2">3.9e-08</td>
<td id="T_09467_row4_col3" class="data row4 col3">7.8e-10</td>
<td id="T_09467_row4_col4" class="data row4 col4">1.4e-12</td>
<td id="T_09467_row4_col5" class="data row4 col5">3.8e-15</td>
<td id="T_09467_row4_col6" class="data row4 col6">1.4e-15</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_bc096_row0_col0 {
  background-color: #fec029;
  color: #000000;
}
#T_bc096_row0_col1, #T_bc096_row2_col0 {
  background-color: #fdab33;
  color: #000000;
}
#T_bc096_row0_col2 {
  background-color: #f9983e;
  color: #000000;
}
#T_bc096_row0_col3 {
  background-color: #f48849;
  color: #f1f1f1;
}
#T_bc096_row0_col4 {
  background-color: #e56b5d;
  color: #f1f1f1;
}
#T_bc096_row0_col5, #T_bc096_row2_col3 {
  background-color: #d45270;
  color: #f1f1f1;
}
#T_bc096_row0_col6, #T_bc096_row4_col2 {
  background-color: #c13b82;
  color: #f1f1f1;
}
#T_bc096_row1_col0 {
  background-color: #feb82c;
  color: #000000;
}
#T_bc096_row1_col1 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_bc096_row1_col2 {
  background-color: #f3854b;
  color: #f1f1f1;
}
#T_bc096_row1_col3 {
  background-color: #e97158;
  color: #f1f1f1;
}
#T_bc096_row1_col4 {
  background-color: #cf4c74;
  color: #f1f1f1;
}
#T_bc096_row1_col5 {
  background-color: #b6308b;
  color: #f1f1f1;
}
#T_bc096_row1_col6 {
  background-color: #8d0ba5;
  color: #f1f1f1;
}
#T_bc096_row2_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_bc096_row2_col2 {
  background-color: #e4695e;
  color: #f1f1f1;
}
#T_bc096_row2_col4 {
  background-color: #ac2694;
  color: #f1f1f1;
}
#T_bc096_row2_col5 {
  background-color: #7e03a8;
  color: #f1f1f1;
}
#T_bc096_row2_col6 {
  background-color: #4b03a1;
  color: #f1f1f1;
}
#T_bc096_row3_col0 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_bc096_row3_col1 {
  background-color: #e97257;
  color: #f1f1f1;
}
#T_bc096_row3_col2 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_bc096_row3_col3 {
  background-color: #bb3488;
  color: #f1f1f1;
}
#T_bc096_row3_col4 {
  background-color: #7b02a8;
  color: #f1f1f1;
}
#T_bc096_row3_col5 {
  background-color: #2a0593;
  color: #f1f1f1;
}
#T_bc096_row3_col6, #T_bc096_row4_col5, #T_bc096_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
#T_bc096_row4_col0 {
  background-color: #f79143;
  color: #f1f1f1;
}
#T_bc096_row4_col1 {
  background-color: #df6263;
  color: #f1f1f1;
}
#T_bc096_row4_col3 {
  background-color: #9d189d;
  color: #f1f1f1;
}
#T_bc096_row4_col4 {
  background-color: #330597;
  color: #f1f1f1;
}
</style>

<table id="T_bc096" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 3:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_bc096_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_bc096_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_bc096_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_bc096_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_bc096_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_bc096_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_bc096_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_bc096_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_bc096_row0_col0" class="data row0 col0">1.8e-01</td>
<td id="T_bc096_row0_col1" class="data row0 col1">3.5e-02</td>
<td id="T_bc096_row0_col2" class="data row0 col2">7.7e-03</td>
<td id="T_bc096_row0_col3" class="data row0 col3">1.8e-03</td>
<td id="T_bc096_row0_col4" class="data row0 col4">1.3e-04</td>
<td id="T_bc096_row0_col5" class="data row0 col5">1.0e-05</td>
<td id="T_bc096_row0_col6" class="data row0 col6">9.1e-07</td>
</tr>
<tr class="even">
<td id="T_bc096_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_bc096_row1_col0" class="data row1 col0">9.8e-02</td>
<td id="T_bc096_row1_col1" class="data row1 col1">1.1e-02</td>
<td id="T_bc096_row1_col2" class="data row1 col2">1.4e-03</td>
<td id="T_bc096_row1_col3" class="data row1 col3">2.2e-04</td>
<td id="T_bc096_row1_col4" class="data row1 col4">5.7e-06</td>
<td id="T_bc096_row1_col5" class="data row1 col5">2.7e-07</td>
<td id="T_bc096_row1_col6" class="data row1 col6">5.8e-09</td>
</tr>
<tr class="odd">
<td id="T_bc096_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_bc096_row2_col0" class="data row2 col0">3.6e-02</td>
<td id="T_bc096_row2_col1" class="data row2 col1">1.7e-03</td>
<td id="T_bc096_row2_col2" class="data row2 col2">9.8e-05</td>
<td id="T_bc096_row2_col3" class="data row2 col3">9.6e-06</td>
<td id="T_bc096_row2_col4" class="data row2 col4">1.1e-07</td>
<td id="T_bc096_row2_col5" class="data row2 col5">1.8e-09</td>
<td id="T_bc096_row2_col6" class="data row2 col6">4.2e-11</td>
</tr>
<tr class="even">
<td id="T_bc096_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_bc096_row3_col0" class="data row3 col0">1.2e-02</td>
<td id="T_bc096_row3_col1" class="data row3 col1">2.7e-04</td>
<td id="T_bc096_row3_col2" class="data row3 col2">8.0e-06</td>
<td id="T_bc096_row3_col3" class="data row3 col3">4.5e-07</td>
<td id="T_bc096_row3_col4" class="data row3 col4">1.5e-09</td>
<td id="T_bc096_row3_col5" class="data row3 col5">4.2e-12</td>
<td id="T_bc096_row3_col6" class="data row3 col6">2.4e-14</td>
</tr>
<tr class="odd">
<td id="T_bc096_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_bc096_row4_col0" class="data row4 col0">4.4e-03</td>
<td id="T_bc096_row4_col1" class="data row4 col1">4.7e-05</td>
<td id="T_bc096_row4_col2" class="data row4 col2">9.3e-07</td>
<td id="T_bc096_row4_col3" class="data row4 col3">2.5e-08</td>
<td id="T_bc096_row4_col4" class="data row4 col4">7.5e-12</td>
<td id="T_bc096_row4_col5" class="data row4 col5">3.8e-15</td>
<td id="T_bc096_row4_col6" class="data row4 col6">1.8e-15</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_8b7bc_row0_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_8b7bc_row0_col1, #T_8b7bc_row2_col0 {
  background-color: #fec029;
  color: #000000;
}
#T_8b7bc_row0_col2, #T_8b7bc_row3_col0 {
  background-color: #fdb52e;
  color: #000000;
}
#T_8b7bc_row0_col3, #T_8b7bc_row4_col0 {
  background-color: #fdac33;
  color: #000000;
}
#T_8b7bc_row0_col4 {
  background-color: #f99a3e;
  color: #000000;
}
#T_8b7bc_row0_col5 {
  background-color: #f48948;
  color: #f1f1f1;
}
#T_8b7bc_row0_col6, #T_8b7bc_row3_col2 {
  background-color: #ee7b51;
  color: #f1f1f1;
}
#T_8b7bc_row1_col0 {
  background-color: #fdc827;
  color: #000000;
}
#T_8b7bc_row1_col1 {
  background-color: #feb82c;
  color: #000000;
}
#T_8b7bc_row1_col2 {
  background-color: #fdab33;
  color: #000000;
}
#T_8b7bc_row1_col3 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_8b7bc_row1_col4 {
  background-color: #f2844b;
  color: #f1f1f1;
}
#T_8b7bc_row1_col5 {
  background-color: #e76e5b;
  color: #f1f1f1;
}
#T_8b7bc_row1_col6 {
  background-color: #da5a6a;
  color: #f1f1f1;
}
#T_8b7bc_row2_col1 {
  background-color: #fca934;
  color: #000000;
}
#T_8b7bc_row2_col2 {
  background-color: #f89540;
  color: #000000;
}
#T_8b7bc_row2_col3 {
  background-color: #f1834c;
  color: #f1f1f1;
}
#T_8b7bc_row2_col4 {
  background-color: #de5f65;
  color: #f1f1f1;
}
#T_8b7bc_row2_col5 {
  background-color: #c5407e;
  color: #f1f1f1;
}
#T_8b7bc_row2_col6 {
  background-color: #a62098;
  color: #f1f1f1;
}
#T_8b7bc_row3_col1 {
  background-color: #f9973f;
  color: #000000;
}
#T_8b7bc_row3_col3 {
  background-color: #df6263;
  color: #f1f1f1;
}
#T_8b7bc_row3_col4 {
  background-color: #ba3388;
  color: #f1f1f1;
}
#T_8b7bc_row3_col5 {
  background-color: #8707a6;
  color: #f1f1f1;
}
#T_8b7bc_row3_col6 {
  background-color: #46039f;
  color: #f1f1f1;
}
#T_8b7bc_row4_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_8b7bc_row4_col2 {
  background-color: #e26660;
  color: #f1f1f1;
}
#T_8b7bc_row4_col3 {
  background-color: #cc4977;
  color: #f1f1f1;
}
#T_8b7bc_row4_col4 {
  background-color: #9410a2;
  color: #f1f1f1;
}
#T_8b7bc_row4_col5 {
  background-color: #4c02a1;
  color: #f1f1f1;
}
#T_8b7bc_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
</style>

<table id="T_8b7bc" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 6:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_8b7bc_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_8b7bc_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_8b7bc_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_8b7bc_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_8b7bc_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_8b7bc_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_8b7bc_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_8b7bc_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_8b7bc_row0_col0" class="data row0 col0">4.3e-01</td>
<td id="T_8b7bc_row0_col1" class="data row0 col1">1.9e-01</td>
<td id="T_8b7bc_row0_col2" class="data row0 col2">8.2e-02</td>
<td id="T_8b7bc_row0_col3" class="data row0 col3">3.7e-02</td>
<td id="T_8b7bc_row0_col4" class="data row0 col4">8.6e-03</td>
<td id="T_8b7bc_row0_col5" class="data row0 col5">2.1e-03</td>
<td id="T_8b7bc_row0_col6" class="data row0 col6">5.5e-04</td>
</tr>
<tr class="even">
<td id="T_8b7bc_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_8b7bc_row1_col0" class="data row1 col0">3.2e-01</td>
<td id="T_8b7bc_row1_col1" class="data row1 col1">1.0e-01</td>
<td id="T_8b7bc_row1_col2" class="data row1 col2">3.3e-02</td>
<td id="T_8b7bc_row1_col3" class="data row1 col3">1.1e-02</td>
<td id="T_8b7bc_row1_col4" class="data row1 col4">1.3e-03</td>
<td id="T_8b7bc_row1_col5" class="data row1 col5">1.7e-04</td>
<td id="T_8b7bc_row1_col6" class="data row1 col6">2.2e-05</td>
</tr>
<tr class="odd">
<td id="T_8b7bc_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_8b7bc_row2_col0" class="data row2 col0">1.8e-01</td>
<td id="T_8b7bc_row2_col1" class="data row2 col1">3.2e-02</td>
<td id="T_8b7bc_row2_col2" class="data row2 col2">6.0e-03</td>
<td id="T_8b7bc_row2_col3" class="data row2 col3">1.1e-03</td>
<td id="T_8b7bc_row2_col4" class="data row2 col4">4.0e-05</td>
<td id="T_8b7bc_row2_col5" class="data row2 col5">1.5e-06</td>
<td id="T_8b7bc_row2_col6" class="data row2 col6">5.6e-08</td>
</tr>
<tr class="even">
<td id="T_8b7bc_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_8b7bc_row3_col0" class="data row3 col0">8.0e-02</td>
<td id="T_8b7bc_row3_col1" class="data row3 col1">6.7e-03</td>
<td id="T_8b7bc_row3_col2" class="data row3 col2">5.8e-04</td>
<td id="T_8b7bc_row3_col3" class="data row3 col3">5.0e-05</td>
<td id="T_8b7bc_row3_col4" class="data row3 col4">4.0e-07</td>
<td id="T_8b7bc_row3_col5" class="data row3 col5">3.6e-09</td>
<td id="T_8b7bc_row3_col6" class="data row3 col6">3.0e-11</td>
</tr>
<tr class="odd">
<td id="T_8b7bc_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_8b7bc_row4_col0" class="data row4 col0">3.8e-02</td>
<td id="T_8b7bc_row4_col1" class="data row4 col1">1.6e-03</td>
<td id="T_8b7bc_row4_col2" class="data row4 col2">7.9e-05</td>
<td id="T_8b7bc_row4_col3" class="data row4 col3">3.6e-06</td>
<td id="T_8b7bc_row4_col4" class="data row4 col4">1.1e-08</td>
<td id="T_8b7bc_row4_col5" class="data row4 col5">4.5e-11</td>
<td id="T_8b7bc_row4_col6" class="data row4 col6">2.5e-13</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_196f2_row0_col0 {
  background-color: #fcce25;
  color: #000000;
}
#T_196f2_row0_col1 {
  background-color: #fdc627;
  color: #000000;
}
#T_196f2_row0_col2 {
  background-color: #febe2a;
  color: #000000;
}
#T_196f2_row0_col3, #T_196f2_row1_col2 {
  background-color: #fdb52e;
  color: #000000;
}
#T_196f2_row0_col4 {
  background-color: #fca636;
  color: #000000;
}
#T_196f2_row0_col5 {
  background-color: #f9983e;
  color: #000000;
}
#T_196f2_row0_col6 {
  background-color: #f58c46;
  color: #f1f1f1;
}
#T_196f2_row1_col0 {
  background-color: #fdcb26;
  color: #000000;
}
#T_196f2_row1_col1 {
  background-color: #fec029;
  color: #000000;
}
#T_196f2_row1_col3 {
  background-color: #fca934;
  color: #000000;
}
#T_196f2_row1_col4 {
  background-color: #f89540;
  color: #000000;
}
#T_196f2_row1_col5 {
  background-color: #f2844b;
  color: #f1f1f1;
}
#T_196f2_row1_col6 {
  background-color: #e97257;
  color: #f1f1f1;
}
#T_196f2_row2_col0 {
  background-color: #fdc527;
  color: #000000;
}
#T_196f2_row2_col1, #T_196f2_row4_col0 {
  background-color: #fdb42f;
  color: #000000;
}
#T_196f2_row2_col2 {
  background-color: #fca338;
  color: #000000;
}
#T_196f2_row2_col3 {
  background-color: #f89441;
  color: #000000;
}
#T_196f2_row2_col4 {
  background-color: #ec7754;
  color: #f1f1f1;
}
#T_196f2_row2_col5 {
  background-color: #dc5d67;
  color: #f1f1f1;
}
#T_196f2_row2_col6 {
  background-color: #c9447a;
  color: #f1f1f1;
}
#T_196f2_row3_col0 {
  background-color: #febd2a;
  color: #000000;
}
#T_196f2_row3_col1 {
  background-color: #fba238;
  color: #000000;
}
#T_196f2_row3_col2 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_196f2_row3_col3, #T_196f2_row4_col2 {
  background-color: #eb7655;
  color: #f1f1f1;
}
#T_196f2_row3_col4 {
  background-color: #d14e72;
  color: #f1f1f1;
}
#T_196f2_row3_col5 {
  background-color: #ae2892;
  color: #f1f1f1;
}
#T_196f2_row3_col6 {
  background-color: #8305a7;
  color: #f1f1f1;
}
#T_196f2_row4_col1 {
  background-color: #f79342;
  color: #000000;
}
#T_196f2_row4_col3 {
  background-color: #db5c68;
  color: #f1f1f1;
}
#T_196f2_row4_col4 {
  background-color: #b22b8f;
  color: #f1f1f1;
}
#T_196f2_row4_col5 {
  background-color: #7d03a8;
  color: #f1f1f1;
}
#T_196f2_row4_col6 {
  background-color: #3e049c;
  color: #f1f1f1;
}
</style>

<table id="T_196f2" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 8:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_196f2_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_196f2_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_196f2_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_196f2_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_196f2_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_196f2_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_196f2_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_196f2_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_196f2_row0_col0" class="data row0 col0">5.3e-01</td>
<td id="T_196f2_row0_col1" class="data row0 col1">2.8e-01</td>
<td id="T_196f2_row0_col2" class="data row0 col2">1.5e-01</td>
<td id="T_196f2_row0_col3" class="data row0 col3">8.2e-02</td>
<td id="T_196f2_row0_col4" class="data row0 col4">2.4e-02</td>
<td id="T_196f2_row0_col5" class="data row0 col5">7.7e-03</td>
<td id="T_196f2_row0_col6" class="data row0 col6">2.6e-03</td>
</tr>
<tr class="even">
<td id="T_196f2_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_196f2_row1_col0" class="data row1 col0">4.2e-01</td>
<td id="T_196f2_row1_col1" class="data row1 col1">1.7e-01</td>
<td id="T_196f2_row1_col2" class="data row1 col2">7.4e-02</td>
<td id="T_196f2_row1_col3" class="data row1 col3">3.2e-02</td>
<td id="T_196f2_row1_col4" class="data row1 col4">6.2e-03</td>
<td id="T_196f2_row1_col5" class="data row1 col5">1.2e-03</td>
<td id="T_196f2_row1_col6" class="data row1 col6">2.6e-04</td>
</tr>
<tr class="odd">
<td id="T_196f2_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_196f2_row2_col0" class="data row2 col0">2.7e-01</td>
<td id="T_196f2_row2_col1" class="data row2 col1">7.1e-02</td>
<td id="T_196f2_row2_col2" class="data row2 col2">1.9e-02</td>
<td id="T_196f2_row2_col3" class="data row2 col3">5.2e-03</td>
<td id="T_196f2_row2_col4" class="data row2 col4">3.9e-04</td>
<td id="T_196f2_row2_col5" class="data row2 col5">3.0e-05</td>
<td id="T_196f2_row2_col6" class="data row2 col6">2.2e-06</td>
</tr>
<tr class="even">
<td id="T_196f2_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_196f2_row3_col0" class="data row3 col0">1.3e-01</td>
<td id="T_196f2_row3_col1" class="data row3 col1">1.8e-02</td>
<td id="T_196f2_row3_col2" class="data row3 col2">2.5e-03</td>
<td id="T_196f2_row3_col3" class="data row3 col3">3.5e-04</td>
<td id="T_196f2_row3_col4" class="data row3 col4">6.6e-06</td>
<td id="T_196f2_row3_col5" class="data row3 col5">1.3e-07</td>
<td id="T_196f2_row3_col6" class="data row3 col6">2.7e-09</td>
</tr>
<tr class="odd">
<td id="T_196f2_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_196f2_row4_col0" class="data row4 col0">6.6e-02</td>
<td id="T_196f2_row4_col1" class="data row4 col1">4.7e-03</td>
<td id="T_196f2_row4_col2" class="data row4 col2">3.4e-04</td>
<td id="T_196f2_row4_col3" class="data row4 col3">2.8e-05</td>
<td id="T_196f2_row4_col4" class="data row4 col4">1.8e-07</td>
<td id="T_196f2_row4_col5" class="data row4 col5">1.6e-09</td>
<td id="T_196f2_row4_col6" class="data row4 col6">1.5e-11</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_5f713_row0_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_5f713_row0_col1, #T_5f713_row2_col0 {
  background-color: #fcce25;
  color: #000000;
}
#T_5f713_row0_col2, #T_5f713_row1_col1 {
  background-color: #fdcb26;
  color: #000000;
}
#T_5f713_row0_col3, #T_5f713_row3_col0 {
  background-color: #fdc627;
  color: #000000;
}
#T_5f713_row0_col4, #T_5f713_row1_col3, #T_5f713_row4_col0 {
  background-color: #febe2a;
  color: #000000;
}
#T_5f713_row0_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_5f713_row0_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_5f713_row1_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_5f713_row1_col2 {
  background-color: #fdc527;
  color: #000000;
}
#T_5f713_row1_col4 {
  background-color: #fdb42f;
  color: #000000;
}
#T_5f713_row1_col5, #T_5f713_row3_col2, #T_5f713_row4_col1 {
  background-color: #fca835;
  color: #000000;
}
#T_5f713_row1_col6 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_5f713_row2_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_5f713_row2_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_5f713_row2_col3 {
  background-color: #fdb130;
  color: #000000;
}
#T_5f713_row2_col4 {
  background-color: #fb9f3a;
  color: #000000;
}
#T_5f713_row2_col5 {
  background-color: #f68f44;
  color: #f1f1f1;
}
#T_5f713_row2_col6, #T_5f713_row3_col4 {
  background-color: #f07f4f;
  color: #f1f1f1;
}
#T_5f713_row3_col1 {
  background-color: #feb72d;
  color: #000000;
}
#T_5f713_row3_col3 {
  background-color: #f99a3e;
  color: #000000;
}
#T_5f713_row3_col5 {
  background-color: #e26660;
  color: #f1f1f1;
}
#T_5f713_row3_col6 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_5f713_row4_col2 {
  background-color: #f79342;
  color: #000000;
}
#T_5f713_row4_col3 {
  background-color: #ef7e50;
  color: #f1f1f1;
}
#T_5f713_row4_col4 {
  background-color: #db5c68;
  color: #f1f1f1;
}
#T_5f713_row4_col5 {
  background-color: #c23c81;
  color: #f1f1f1;
}
#T_5f713_row4_col6 {
  background-color: #a21d9a;
  color: #f1f1f1;
}
</style>

<table id="T_5f713" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 16:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_5f713_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_5f713_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_5f713_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_5f713_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_5f713_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_5f713_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_5f713_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5f713_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_5f713_row0_col0" class="data row0 col0">7.3e-01</td>
<td id="T_5f713_row0_col1" class="data row0 col1">5.3e-01</td>
<td id="T_5f713_row0_col2" class="data row0 col2">3.9e-01</td>
<td id="T_5f713_row0_col3" class="data row0 col3">2.8e-01</td>
<td id="T_5f713_row0_col4" class="data row0 col4">1.5e-01</td>
<td id="T_5f713_row0_col5" class="data row0 col5">7.9e-02</td>
<td id="T_5f713_row0_col6" class="data row0 col6">4.2e-02</td>
</tr>
<tr class="even">
<td id="T_5f713_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_5f713_row1_col0" class="data row1 col0">6.4e-01</td>
<td id="T_5f713_row1_col1" class="data row1 col1">4.0e-01</td>
<td id="T_5f713_row1_col2" class="data row1 col2">2.6e-01</td>
<td id="T_5f713_row1_col3" class="data row1 col3">1.6e-01</td>
<td id="T_5f713_row1_col4" class="data row1 col4">6.6e-02</td>
<td id="T_5f713_row1_col5" class="data row1 col5">2.7e-02</td>
<td id="T_5f713_row1_col6" class="data row1 col6">1.1e-02</td>
</tr>
<tr class="odd">
<td id="T_5f713_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_5f713_row2_col0" class="data row2 col0">4.9e-01</td>
<td id="T_5f713_row2_col1" class="data row2 col1">2.4e-01</td>
<td id="T_5f713_row2_col2" class="data row2 col2">1.2e-01</td>
<td id="T_5f713_row2_col3" class="data row2 col3">5.6e-02</td>
<td id="T_5f713_row2_col4" class="data row2 col4">1.3e-02</td>
<td id="T_5f713_row2_col5" class="data row2 col5">3.2e-03</td>
<td id="T_5f713_row2_col6" class="data row2 col6">7.8e-04</td>
</tr>
<tr class="even">
<td id="T_5f713_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_5f713_row3_col0" class="data row3 col0">3.0e-01</td>
<td id="T_5f713_row3_col1" class="data row3 col1">9.0e-02</td>
<td id="T_5f713_row3_col2" class="data row3 col2">2.7e-02</td>
<td id="T_5f713_row3_col3" class="data row3 col3">8.1e-03</td>
<td id="T_5f713_row3_col4" class="data row3 col4">7.7e-04</td>
<td id="T_5f713_row3_col5" class="data row3 col5">7.6e-05</td>
<td id="T_5f713_row3_col6" class="data row3 col6">7.4e-06</td>
</tr>
<tr class="odd">
<td id="T_5f713_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_5f713_row4_col0" class="data row4 col0">1.6e-01</td>
<td id="T_5f713_row4_col1" class="data row4 col1">2.8e-02</td>
<td id="T_5f713_row4_col2" class="data row4 col2">4.7e-03</td>
<td id="T_5f713_row4_col3" class="data row4 col3">7.6e-04</td>
<td id="T_5f713_row4_col4" class="data row4 col4">2.7e-05</td>
<td id="T_5f713_row4_col5" class="data row4 col5">1.0e-06</td>
<td id="T_5f713_row4_col6" class="data row4 col6">3.8e-08</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_1a973_row0_col0, #T_1a973_row1_col0 {
  background-color: #fbd524;
  color: #000000;
}
#T_1a973_row0_col1 {
  background-color: #fbd324;
  color: #000000;
}
#T_1a973_row0_col2, #T_1a973_row1_col1, #T_1a973_row2_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_1a973_row0_col3, #T_1a973_row1_col2 {
  background-color: #fcce25;
  color: #000000;
}
#T_1a973_row0_col4, #T_1a973_row1_col3 {
  background-color: #fdca26;
  color: #000000;
}
#T_1a973_row0_col5 {
  background-color: #fdc527;
  color: #000000;
}
#T_1a973_row0_col6, #T_1a973_row2_col3 {
  background-color: #fdc229;
  color: #000000;
}
#T_1a973_row1_col4, #T_1a973_row3_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_1a973_row1_col5 {
  background-color: #febd2a;
  color: #000000;
}
#T_1a973_row1_col6, #T_1a973_row2_col4 {
  background-color: #feb72d;
  color: #000000;
}
#T_1a973_row2_col1, #T_1a973_row3_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_1a973_row2_col2, #T_1a973_row4_col0 {
  background-color: #fdc627;
  color: #000000;
}
#T_1a973_row2_col5 {
  background-color: #fdac33;
  color: #000000;
}
#T_1a973_row2_col6, #T_1a973_row4_col2 {
  background-color: #fca338;
  color: #000000;
}
#T_1a973_row3_col2 {
  background-color: #feb82c;
  color: #000000;
}
#T_1a973_row3_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_1a973_row3_col4 {
  background-color: #fa9b3d;
  color: #000000;
}
#T_1a973_row3_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_1a973_row3_col6 {
  background-color: #ed7a52;
  color: #f1f1f1;
}
#T_1a973_row4_col1 {
  background-color: #fdb42f;
  color: #000000;
}
#T_1a973_row4_col3 {
  background-color: #f89441;
  color: #000000;
}
#T_1a973_row4_col4 {
  background-color: #ec7754;
  color: #f1f1f1;
}
#T_1a973_row4_col5 {
  background-color: #dd5e66;
  color: #f1f1f1;
}
#T_1a973_row4_col6 {
  background-color: #ca457a;
  color: #f1f1f1;
}
</style>

<table id="T_1a973" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 32:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_1a973_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_1a973_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_1a973_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_1a973_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_1a973_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_1a973_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_1a973_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_1a973_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_1a973_row0_col0" class="data row0 col0">8.5e-01</td>
<td id="T_1a973_row0_col1" class="data row0 col1">7.2e-01</td>
<td id="T_1a973_row0_col2" class="data row0 col2">6.1e-01</td>
<td id="T_1a973_row0_col3" class="data row0 col3">5.1e-01</td>
<td id="T_1a973_row0_col4" class="data row0 col4">3.7e-01</td>
<td id="T_1a973_row0_col5" class="data row0 col5">2.6e-01</td>
<td id="T_1a973_row0_col6" class="data row0 col6">1.9e-01</td>
</tr>
<tr class="even">
<td id="T_1a973_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_1a973_row1_col0" class="data row1 col0">7.8e-01</td>
<td id="T_1a973_row1_col1" class="data row1 col1">6.1e-01</td>
<td id="T_1a973_row1_col2" class="data row1 col2">4.8e-01</td>
<td id="T_1a973_row1_col3" class="data row1 col3">3.8e-01</td>
<td id="T_1a973_row1_col4" class="data row1 col4">2.3e-01</td>
<td id="T_1a973_row1_col5" class="data row1 col5">1.4e-01</td>
<td id="T_1a973_row1_col6" class="data row1 col6">8.7e-02</td>
</tr>
<tr class="odd">
<td id="T_1a973_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_1a973_row2_col0" class="data row2 col0">6.7e-01</td>
<td id="T_1a973_row2_col1" class="data row2 col1">4.4e-01</td>
<td id="T_1a973_row2_col2" class="data row2 col2">3.0e-01</td>
<td id="T_1a973_row2_col3" class="data row2 col3">2.0e-01</td>
<td id="T_1a973_row2_col4" class="data row2 col4">9.0e-02</td>
<td id="T_1a973_row2_col5" class="data row2 col5">4.1e-02</td>
<td id="T_1a973_row2_col6" class="data row2 col6">1.8e-02</td>
</tr>
<tr class="even">
<td id="T_1a973_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_1a973_row3_col0" class="data row3 col0">4.6e-01</td>
<td id="T_1a973_row3_col1" class="data row3 col1">2.2e-01</td>
<td id="T_1a973_row3_col2" class="data row3 col2">1.0e-01</td>
<td id="T_1a973_row3_col3" class="data row3 col3">4.7e-02</td>
<td id="T_1a973_row3_col4" class="data row3 col4">9.9e-03</td>
<td id="T_1a973_row3_col5" class="data row3 col5">2.3e-03</td>
<td id="T_1a973_row3_col6" class="data row3 col6">5.1e-04</td>
</tr>
<tr class="odd">
<td id="T_1a973_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_1a973_row4_col0" class="data row4 col0">2.7e-01</td>
<td id="T_1a973_row4_col1" class="data row4 col1">7.1e-02</td>
<td id="T_1a973_row4_col2" class="data row4 col2">1.9e-02</td>
<td id="T_1a973_row4_col3" class="data row4 col3">5.1e-03</td>
<td id="T_1a973_row4_col4" class="data row4 col4">4.2e-04</td>
<td id="T_1a973_row4_col5" class="data row4 col5">3.6e-05</td>
<td id="T_1a973_row4_col6" class="data row4 col6">2.6e-06</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_b6f69_row0_col0, #T_b6f69_row1_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_b6f69_row0_col1, #T_b6f69_row0_col2, #T_b6f69_row1_col1, #T_b6f69_row2_col0 {
  background-color: #fbd524;
  color: #000000;
}
#T_b6f69_row0_col3 {
  background-color: #fbd324;
  color: #000000;
}
#T_b6f69_row0_col4, #T_b6f69_row1_col3, #T_b6f69_row2_col2, #T_b6f69_row3_col0 {
  background-color: #fcd025;
  color: #000000;
}
#T_b6f69_row0_col5 {
  background-color: #fcce25;
  color: #000000;
}
#T_b6f69_row0_col6 {
  background-color: #fdcb26;
  color: #000000;
}
#T_b6f69_row1_col2, #T_b6f69_row2_col1 {
  background-color: #fcd225;
  color: #000000;
}
#T_b6f69_row1_col4, #T_b6f69_row2_col3 {
  background-color: #fccd25;
  color: #000000;
}
#T_b6f69_row1_col5, #T_b6f69_row3_col1, #T_b6f69_row4_col0 {
  background-color: #fdca26;
  color: #000000;
}
#T_b6f69_row1_col6 {
  background-color: #fdc527;
  color: #000000;
}
#T_b6f69_row2_col4 {
  background-color: #fdc827;
  color: #000000;
}
#T_b6f69_row2_col5 {
  background-color: #fdc328;
  color: #000000;
}
#T_b6f69_row2_col6 {
  background-color: #febe2a;
  color: #000000;
}
#T_b6f69_row3_col2 {
  background-color: #fdc229;
  color: #000000;
}
#T_b6f69_row3_col3, #T_b6f69_row4_col1 {
  background-color: #febb2b;
  color: #000000;
}
#T_b6f69_row3_col4, #T_b6f69_row4_col2 {
  background-color: #fdae32;
  color: #000000;
}
#T_b6f69_row3_col5, #T_b6f69_row4_col3 {
  background-color: #fba139;
  color: #000000;
}
#T_b6f69_row3_col6 {
  background-color: #f89540;
  color: #000000;
}
#T_b6f69_row4_col4 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_b6f69_row4_col5 {
  background-color: #eb7655;
  color: #f1f1f1;
}
#T_b6f69_row4_col6 {
  background-color: #e06363;
  color: #f1f1f1;
}
</style>

<table id="T_b6f69" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 64:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_b6f69_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_b6f69_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_b6f69_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_b6f69_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_b6f69_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_b6f69_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_b6f69_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b6f69_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_b6f69_row0_col0" class="data row0 col0">9.1e-01</td>
<td id="T_b6f69_row0_col1" class="data row0 col1">8.4e-01</td>
<td id="T_b6f69_row0_col2" class="data row0 col2">7.6e-01</td>
<td id="T_b6f69_row0_col3" class="data row0 col3">7.0e-01</td>
<td id="T_b6f69_row0_col4" class="data row0 col4">5.8e-01</td>
<td id="T_b6f69_row0_col5" class="data row0 col5">4.8e-01</td>
<td id="T_b6f69_row0_col6" class="data row0 col6">4.0e-01</td>
</tr>
<tr class="even">
<td id="T_b6f69_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_b6f69_row1_col0" class="data row1 col0">8.7e-01</td>
<td id="T_b6f69_row1_col1" class="data row1 col1">7.6e-01</td>
<td id="T_b6f69_row1_col2" class="data row1 col2">6.7e-01</td>
<td id="T_b6f69_row1_col3" class="data row1 col3">5.8e-01</td>
<td id="T_b6f69_row1_col4" class="data row1 col4">4.5e-01</td>
<td id="T_b6f69_row1_col5" class="data row1 col5">3.5e-01</td>
<td id="T_b6f69_row1_col6" class="data row1 col6">2.7e-01</td>
</tr>
<tr class="odd">
<td id="T_b6f69_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_b6f69_row2_col0" class="data row2 col0">7.9e-01</td>
<td id="T_b6f69_row2_col1" class="data row2 col1">6.6e-01</td>
<td id="T_b6f69_row2_col2" class="data row2 col2">5.5e-01</td>
<td id="T_b6f69_row2_col3" class="data row2 col3">4.5e-01</td>
<td id="T_b6f69_row2_col4" class="data row2 col4">3.2e-01</td>
<td id="T_b6f69_row2_col5" class="data row2 col5">2.2e-01</td>
<td id="T_b6f69_row2_col6" class="data row2 col6">1.5e-01</td>
</tr>
<tr class="even">
<td id="T_b6f69_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_b6f69_row3_col0" class="data row3 col0">5.8e-01</td>
<td id="T_b6f69_row3_col1" class="data row3 col1">3.4e-01</td>
<td id="T_b6f69_row3_col2" class="data row3 col2">2.0e-01</td>
<td id="T_b6f69_row3_col3" class="data row3 col3">1.2e-01</td>
<td id="T_b6f69_row3_col4" class="data row3 col4">4.2e-02</td>
<td id="T_b6f69_row3_col5" class="data row3 col5">1.5e-02</td>
<td id="T_b6f69_row3_col6" class="data row3 col6">5.6e-03</td>
</tr>
<tr class="odd">
<td id="T_b6f69_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_b6f69_row4_col0" class="data row4 col0">3.5e-01</td>
<td id="T_b6f69_row4_col1" class="data row4 col1">1.2e-01</td>
<td id="T_b6f69_row4_col2" class="data row4 col2">4.3e-02</td>
<td id="T_b6f69_row4_col3" class="data row4 col3">1.5e-02</td>
<td id="T_b6f69_row4_col4" class="data row4 col4">2.4e-03</td>
<td id="T_b6f69_row4_col5" class="data row4 col5">3.6e-04</td>
<td id="T_b6f69_row4_col6" class="data row4 col6">5.2e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_9f3b7_row0_col0, #T_9f3b7_row0_col1, #T_9f3b7_row0_col2, #T_9f3b7_row1_col0, #T_9f3b7_row1_col1 {
  background-color: #fbd724;
  color: #000000;
}
#T_9f3b7_row0_col3, #T_9f3b7_row1_col2, #T_9f3b7_row2_col0, #T_9f3b7_row2_col1 {
  background-color: #fbd524;
  color: #000000;
}
#T_9f3b7_row0_col4, #T_9f3b7_row1_col3, #T_9f3b7_row2_col2 {
  background-color: #fbd324;
  color: #000000;
}
#T_9f3b7_row0_col5, #T_9f3b7_row1_col4, #T_9f3b7_row2_col3, #T_9f3b7_row3_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_9f3b7_row0_col6, #T_9f3b7_row1_col5, #T_9f3b7_row2_col4 {
  background-color: #fcd025;
  color: #000000;
}
#T_9f3b7_row1_col6 {
  background-color: #fcce25;
  color: #000000;
}
#T_9f3b7_row2_col5, #T_9f3b7_row3_col1 {
  background-color: #fccd25;
  color: #000000;
}
#T_9f3b7_row2_col6, #T_9f3b7_row3_col2 {
  background-color: #fdca26;
  color: #000000;
}
#T_9f3b7_row3_col3 {
  background-color: #fdc527;
  color: #000000;
}
#T_9f3b7_row3_col4 {
  background-color: #febb2b;
  color: #000000;
}
#T_9f3b7_row3_col5 {
  background-color: #fdb22f;
  color: #000000;
}
#T_9f3b7_row3_col6 {
  background-color: #fca835;
  color: #000000;
}
#T_9f3b7_row4_col0 {
  background-color: #fdcb26;
  color: #000000;
}
#T_9f3b7_row4_col1 {
  background-color: #fdc229;
  color: #000000;
}
#T_9f3b7_row4_col2 {
  background-color: #feb82c;
  color: #000000;
}
#T_9f3b7_row4_col3 {
  background-color: #fdae32;
  color: #000000;
}
#T_9f3b7_row4_col4 {
  background-color: #f99a3e;
  color: #000000;
}
#T_9f3b7_row4_col5 {
  background-color: #f48849;
  color: #f1f1f1;
}
#T_9f3b7_row4_col6 {
  background-color: #e3685f;
  color: #f1f1f1;
}
</style>

<table id="T_9f3b7" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 128:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_9f3b7_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_9f3b7_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_9f3b7_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_9f3b7_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_9f3b7_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_9f3b7_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_9f3b7_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9f3b7_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_9f3b7_row0_col0" class="data row0 col0">9.5e-01</td>
<td id="T_9f3b7_row0_col1" class="data row0 col1">9.1e-01</td>
<td id="T_9f3b7_row0_col2" class="data row0 col2">8.6e-01</td>
<td id="T_9f3b7_row0_col3" class="data row0 col3">8.2e-01</td>
<td id="T_9f3b7_row0_col4" class="data row0 col4">7.4e-01</td>
<td id="T_9f3b7_row0_col5" class="data row0 col5">6.7e-01</td>
<td id="T_9f3b7_row0_col6" class="data row0 col6">6.0e-01</td>
</tr>
<tr class="even">
<td id="T_9f3b7_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_9f3b7_row1_col0" class="data row1 col0">9.3e-01</td>
<td id="T_9f3b7_row1_col1" class="data row1 col1">8.6e-01</td>
<td id="T_9f3b7_row1_col2" class="data row1 col2">8.0e-01</td>
<td id="T_9f3b7_row1_col3" class="data row1 col3">7.4e-01</td>
<td id="T_9f3b7_row1_col4" class="data row1 col4">6.4e-01</td>
<td id="T_9f3b7_row1_col5" class="data row1 col5">5.6e-01</td>
<td id="T_9f3b7_row1_col6" class="data row1 col6">5.1e-01</td>
</tr>
<tr class="odd">
<td id="T_9f3b7_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_9f3b7_row2_col0" class="data row2 col0">8.6e-01</td>
<td id="T_9f3b7_row2_col1" class="data row2 col1">7.9e-01</td>
<td id="T_9f3b7_row2_col2" class="data row2 col2">7.2e-01</td>
<td id="T_9f3b7_row2_col3" class="data row2 col3">6.5e-01</td>
<td id="T_9f3b7_row2_col4" class="data row2 col4">5.4e-01</td>
<td id="T_9f3b7_row2_col5" class="data row2 col5">4.4e-01</td>
<td id="T_9f3b7_row2_col6" class="data row2 col6">3.6e-01</td>
</tr>
<tr class="even">
<td id="T_9f3b7_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_9f3b7_row3_col0" class="data row3 col0">6.5e-01</td>
<td id="T_9f3b7_row3_col1" class="data row3 col1">4.7e-01</td>
<td id="T_9f3b7_row3_col2" class="data row3 col2">3.4e-01</td>
<td id="T_9f3b7_row3_col3" class="data row3 col3">2.5e-01</td>
<td id="T_9f3b7_row3_col4" class="data row3 col4">1.3e-01</td>
<td id="T_9f3b7_row3_col5" class="data row3 col5">6.0e-02</td>
<td id="T_9f3b7_row3_col6" class="data row3 col6">2.6e-02</td>
</tr>
<tr class="odd">
<td id="T_9f3b7_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_9f3b7_row4_col0" class="data row4 col0">4.1e-01</td>
<td id="T_9f3b7_row4_col1" class="data row4 col1">2.0e-01</td>
<td id="T_9f3b7_row4_col2" class="data row4 col2">9.3e-02</td>
<td id="T_9f3b7_row4_col3" class="data row4 col3">4.4e-02</td>
<td id="T_9f3b7_row4_col4" class="data row4 col4">8.3e-03</td>
<td id="T_9f3b7_row4_col5" class="data row4 col5">1.8e-03</td>
<td id="T_9f3b7_row4_col6" class="data row4 col6">8.4e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_da518_row0_col0 {
  background-color: #fad824;
  color: #000000;
}
#T_da518_row0_col1, #T_da518_row0_col2, #T_da518_row0_col3, #T_da518_row1_col0, #T_da518_row1_col1, #T_da518_row1_col2, #T_da518_row2_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_da518_row0_col4, #T_da518_row0_col5, #T_da518_row1_col3, #T_da518_row1_col4, #T_da518_row2_col1 {
  background-color: #fbd524;
  color: #000000;
}
#T_da518_row0_col6, #T_da518_row1_col5, #T_da518_row1_col6, #T_da518_row2_col2, #T_da518_row2_col3, #T_da518_row3_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_da518_row2_col4 {
  background-color: #fcd025;
  color: #000000;
}
#T_da518_row2_col5, #T_da518_row3_col1 {
  background-color: #fcce25;
  color: #000000;
}
#T_da518_row2_col6, #T_da518_row3_col2 {
  background-color: #fdcb26;
  color: #000000;
}
#T_da518_row3_col3 {
  background-color: #fdc627;
  color: #000000;
}
#T_da518_row3_col4 {
  background-color: #febd2a;
  color: #000000;
}
#T_da518_row3_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_da518_row3_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_da518_row4_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_da518_row4_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_da518_row4_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_da518_row4_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_da518_row4_col4 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_da518_row4_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_da518_row4_col6 {
  background-color: #e97257;
  color: #f1f1f1;
}
</style>

<table id="T_da518" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 256:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_da518_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_da518_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_da518_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_da518_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_da518_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_da518_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_da518_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_da518_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_da518_row0_col0" class="data row0 col0">9.7e-01</td>
<td id="T_da518_row0_col1" class="data row0 col1">9.4e-01</td>
<td id="T_da518_row0_col2" class="data row0 col2">9.2e-01</td>
<td id="T_da518_row0_col3" class="data row0 col3">8.9e-01</td>
<td id="T_da518_row0_col4" class="data row0 col4">8.4e-01</td>
<td id="T_da518_row0_col5" class="data row0 col5">8.0e-01</td>
<td id="T_da518_row0_col6" class="data row0 col6">7.5e-01</td>
</tr>
<tr class="even">
<td id="T_da518_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_da518_row1_col0" class="data row1 col0">9.5e-01</td>
<td id="T_da518_row1_col1" class="data row1 col1">9.1e-01</td>
<td id="T_da518_row1_col2" class="data row1 col2">8.7e-01</td>
<td id="T_da518_row1_col3" class="data row1 col3">8.4e-01</td>
<td id="T_da518_row1_col4" class="data row1 col4">7.8e-01</td>
<td id="T_da518_row1_col5" class="data row1 col5">7.4e-01</td>
<td id="T_da518_row1_col6" class="data row1 col6">7.1e-01</td>
</tr>
<tr class="odd">
<td id="T_da518_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_da518_row2_col0" class="data row2 col0">8.9e-01</td>
<td id="T_da518_row2_col1" class="data row2 col1">8.3e-01</td>
<td id="T_da518_row2_col2" class="data row2 col2">7.6e-01</td>
<td id="T_da518_row2_col3" class="data row2 col3">7.0e-01</td>
<td id="T_da518_row2_col4" class="data row2 col4">5.9e-01</td>
<td id="T_da518_row2_col5" class="data row2 col5">5.0e-01</td>
<td id="T_da518_row2_col6" class="data row2 col6">4.2e-01</td>
</tr>
<tr class="even">
<td id="T_da518_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_da518_row3_col0" class="data row3 col0">6.9e-01</td>
<td id="T_da518_row3_col1" class="data row3 col1">5.2e-01</td>
<td id="T_da518_row3_col2" class="data row3 col2">3.8e-01</td>
<td id="T_da518_row3_col3" class="data row3 col3">2.8e-01</td>
<td id="T_da518_row3_col4" class="data row3 col4">1.5e-01</td>
<td id="T_da518_row3_col5" class="data row3 col5">7.8e-02</td>
<td id="T_da518_row3_col6" class="data row3 col6">4.4e-02</td>
</tr>
<tr class="odd">
<td id="T_da518_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_da518_row4_col0" class="data row4 col0">4.4e-01</td>
<td id="T_da518_row4_col1" class="data row4 col1">2.2e-01</td>
<td id="T_da518_row4_col2" class="data row4 col2">1.1e-01</td>
<td id="T_da518_row4_col3" class="data row4 col3">5.2e-02</td>
<td id="T_da518_row4_col4" class="data row4 col4">1.2e-02</td>
<td id="T_da518_row4_col5" class="data row4 col5">2.3e-03</td>
<td id="T_da518_row4_col6" class="data row4 col6">2.6e-04</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_abe1d_row0_col0, #T_abe1d_row0_col1, #T_abe1d_row1_col0 {
  background-color: #fad824;
  color: #000000;
}
#T_abe1d_row0_col2, #T_abe1d_row0_col3, #T_abe1d_row0_col4, #T_abe1d_row0_col5, #T_abe1d_row1_col1, #T_abe1d_row1_col2, #T_abe1d_row1_col3, #T_abe1d_row1_col4, #T_abe1d_row2_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_abe1d_row0_col6, #T_abe1d_row1_col5, #T_abe1d_row1_col6, #T_abe1d_row2_col1, #T_abe1d_row2_col2 {
  background-color: #fbd524;
  color: #000000;
}
#T_abe1d_row2_col3, #T_abe1d_row3_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_abe1d_row2_col4 {
  background-color: #fcd225;
  color: #000000;
}
#T_abe1d_row2_col5, #T_abe1d_row3_col1 {
  background-color: #fcce25;
  color: #000000;
}
#T_abe1d_row2_col6, #T_abe1d_row4_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_abe1d_row3_col2 {
  background-color: #fdcb26;
  color: #000000;
}
#T_abe1d_row3_col3 {
  background-color: #fdc627;
  color: #000000;
}
#T_abe1d_row3_col4 {
  background-color: #febe2a;
  color: #000000;
}
#T_abe1d_row3_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_abe1d_row3_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_abe1d_row4_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_abe1d_row4_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_abe1d_row4_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_abe1d_row4_col4 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_abe1d_row4_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_abe1d_row4_col6 {
  background-color: #ef7c51;
  color: #f1f1f1;
}
</style>

<table id="T_abe1d" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 512:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_abe1d_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_abe1d_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_abe1d_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_abe1d_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_abe1d_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_abe1d_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_abe1d_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_abe1d_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_abe1d_row0_col0" class="data row0 col0">9.8e-01</td>
<td id="T_abe1d_row0_col1" class="data row0 col1">9.7e-01</td>
<td id="T_abe1d_row0_col2" class="data row0 col2">9.5e-01</td>
<td id="T_abe1d_row0_col3" class="data row0 col3">9.3e-01</td>
<td id="T_abe1d_row0_col4" class="data row0 col4">9.0e-01</td>
<td id="T_abe1d_row0_col5" class="data row0 col5">8.7e-01</td>
<td id="T_abe1d_row0_col6" class="data row0 col6">8.4e-01</td>
</tr>
<tr class="even">
<td id="T_abe1d_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_abe1d_row1_col0" class="data row1 col0">9.7e-01</td>
<td id="T_abe1d_row1_col1" class="data row1 col1">9.4e-01</td>
<td id="T_abe1d_row1_col2" class="data row1 col2">9.3e-01</td>
<td id="T_abe1d_row1_col3" class="data row1 col3">9.1e-01</td>
<td id="T_abe1d_row1_col4" class="data row1 col4">8.8e-01</td>
<td id="T_abe1d_row1_col5" class="data row1 col5">8.4e-01</td>
<td id="T_abe1d_row1_col6" class="data row1 col6">8.0e-01</td>
</tr>
<tr class="odd">
<td id="T_abe1d_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_abe1d_row2_col0" class="data row2 col0">9.1e-01</td>
<td id="T_abe1d_row2_col1" class="data row2 col1">8.6e-01</td>
<td id="T_abe1d_row2_col2" class="data row2 col2">7.9e-01</td>
<td id="T_abe1d_row2_col3" class="data row2 col3">7.3e-01</td>
<td id="T_abe1d_row2_col4" class="data row2 col4">6.3e-01</td>
<td id="T_abe1d_row2_col5" class="data row2 col5">5.4e-01</td>
<td id="T_abe1d_row2_col6" class="data row2 col6">4.6e-01</td>
</tr>
<tr class="even">
<td id="T_abe1d_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_abe1d_row3_col0" class="data row3 col0">7.1e-01</td>
<td id="T_abe1d_row3_col1" class="data row3 col1">5.3e-01</td>
<td id="T_abe1d_row3_col2" class="data row3 col2">3.9e-01</td>
<td id="T_abe1d_row3_col3" class="data row3 col3">2.9e-01</td>
<td id="T_abe1d_row3_col4" class="data row3 col4">1.5e-01</td>
<td id="T_abe1d_row3_col5" class="data row3 col5">8.2e-02</td>
<td id="T_abe1d_row3_col6" class="data row3 col6">4.5e-02</td>
</tr>
<tr class="odd">
<td id="T_abe1d_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_abe1d_row4_col0" class="data row4 col0">4.6e-01</td>
<td id="T_abe1d_row4_col1" class="data row4 col1">2.2e-01</td>
<td id="T_abe1d_row4_col2" class="data row4 col2">1.1e-01</td>
<td id="T_abe1d_row4_col3" class="data row4 col3">5.0e-02</td>
<td id="T_abe1d_row4_col4" class="data row4 col4">1.2e-02</td>
<td id="T_abe1d_row4_col5" class="data row4 col5">2.3e-03</td>
<td id="T_abe1d_row4_col6" class="data row4 col6">6.1e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p>Clarification: RVQ with K=1 is the same thing a regular VQ.</p>
</blockquote>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb23-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb23-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pio</span>
<span id="cb23-4">pio.renderers.default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span></span>
<span id="cb23-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.express <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> px </span>
<span id="cb23-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotly.offline <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb23-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb23-8">init_notebook_mode(connected<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb23-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, log_z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, vary_K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb23-12">                camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>( up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), center<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), eye<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>)),</span>
<span id="cb23-13">                width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">750</span>,):</span>
<span id="cb23-14">    y, ylabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(d_choices), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span></span>
<span id="cb23-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> vary_K:</span>
<span id="cb23-16">        x, xlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(K_choices), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'K'</span></span>
<span id="cb23-17">        z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[:,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,:] </span>
<span id="cb23-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb23-19">        x, xlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(cb_lengths), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cb_len'</span></span>
<span id="cb23-20">        z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[:,:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] </span>
<span id="cb23-21">    z, zlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z.numpy(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span></span>
<span id="cb23-22"></span>
<span id="cb23-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> log_xy:</span>
<span id="cb23-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> vary_K: </span>
<span id="cb23-25">            x, xlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.log10(x), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"log10( </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>xlabel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> )"</span></span>
<span id="cb23-26">        y, ylabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.log10(y), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"log10( </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ylabel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> )"</span></span>
<span id="cb23-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> log_z:</span>
<span id="cb23-28">        z, zlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.log10(z), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"log10( </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>zlabel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> )"</span></span>
<span id="cb23-29"></span>
<span id="cb23-30">    X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x, y)</span>
<span id="cb23-31"></span>
<span id="cb23-32">    fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Surface(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>X, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Y, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z, )], )</span>
<span id="cb23-33">    fig.update_layout(scene <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>xlabel,yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ylabel,zaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>zlabel))</span>
<span id="cb23-34">    fig.update_layout(template<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plotly_dark'</span>,</span>
<span id="cb23-35">        autosize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb23-36">        width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>width,</span>
<span id="cb23-37">        height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb23-38">        margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,pad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb23-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#paper_bgcolor="LightSteelBlue",</span></span>
<span id="cb23-40">        scene_camera <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> camera,</span>
<span id="cb23-41">    )</span>
<span id="cb23-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> fig</span>
<span id="cb23-43"></span>
<span id="cb23-44">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, log_z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb23-45">fig.show()</span></code></pre></div>
</details>
<div id="fig-rvq-error-surfacea" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="377d756b-b5b8-44dd-b8a5-eacbb127866e" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("377d756b-b5b8-44dd-b8a5-eacbb127866e")) {                    Plotly.newPlot(                        "377d756b-b5b8-44dd-b8a5-eacbb127866e",                        [{"x":[[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[0.0001194791,0.000013041611,4.5001212e-7,6.08875e-8,7.8245804e-10],[0.001829724,0.00021511987,0.000009550631,4.545183e-7,2.4666173e-8],[0.03747351,0.011077854,0.0011352181,0.000050426737,0.0000036374568],[0.081909396,0.032012165,0.0052097593,0.00034891343,0.000028127608],[0.28064567,0.16229738,0.055833414,0.008146616,0.0007630689],[0.51241994,0.37574497,0.20006032,0.046573743,0.005081785],[0.69774455,0.5829518,0.4546781,0.12038385,0.015401484],[0.8201094,0.7430855,0.6539526,0.24878451,0.043749306],[0.8906704,0.8390631,0.69743395,0.2768929,0.051854175],[0.93333817,0.9102819,0.73448575,0.2887212,0.050273906]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"log10( cb_len )"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"error"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":0,"y":0,"z":-0.2},"eye":{"x":1.3,"y":1.3,"z":1.25}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('377d756b-b5b8-44dd-b8a5-eacbb127866e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;18<strong>.</strong> (Interactive) Surface plot of reconstruction error for 4 codebooks with various data dimensions and codebook lengths.</figcaption>
</figure>
</div>
</div>
<p>So as we expect, longer codebooks help, and at higher dimensions, error tends to be larger.</p>
<p>Here’s the same thing but with a logarithm axis for the error:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>( up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), center<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), eye<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb24-2">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, log_z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>camera)</span>
<span id="cb24-3">fig.show()</span></code></pre></div>
</details>
<div id="fig-rvq-error-surfacea-logz" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="9ccad324-61e5-4cd6-99ab-9ab6a065efef" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9ccad324-61e5-4cd6-99ab-9ab6a065efef")) {                    Plotly.newPlot(                        "9ccad324-61e5-4cd6-99ab-9ab6a065efef",                        [{"x":[[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[-3.922708,-4.884669,-6.346776,-7.2154717,-9.106539],[-2.7376144,-3.6673195,-5.019968,-6.3424487,-7.607898],[-1.4262756,-1.9555444,-2.9449208,-4.297339,-5.4392023],[-1.0866662,-1.4946849,-2.2831824,-3.4572823,-4.550867],[-0.5518417,-0.78968847,-1.2531058,-2.0890229,-3.1174362],[-0.29037398,-0.42510682,-0.698839,-1.3318589,-2.2939837],[-0.15630355,-0.23436737,-0.34229597,-0.91943175,-1.8124374],[-0.0861282,-0.1289612,-0.18445373,-0.60417664,-1.3590288],[-0.05028297,-0.07620537,-0.15649691,-0.5576882,-1.2852163],[-0.029960975,-0.040824093,-0.13401663,-0.53952134,-1.2986574]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"log10( cb_len )"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"log10( error )"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":-0.15,"y":0,"z":-0.2},"eye":{"x":1.2,"y":-1.4,"z":1}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9ccad324-61e5-4cd6-99ab-9ab6a065efef');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;19<strong>.</strong> (Interactive) Surface plot of reconstruction error for 4 codebooks with various data dimensions and codebook lengths. (Logarithmic z-axis)</figcaption>
</figure>
</div>
</div>
<p>And now let’s look at the error for a codebook length of 2048, where we vary the number of codebooks:</p>
<div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>( up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), center<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>), eye<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb25-2">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plot_results(results, d_choices, cb_lengths, K_choices, vary_K<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, log_xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, log_z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>camera)</span>
<span id="cb25-3">fig.show()</span>
<span id="cb25-4"></span>
<span id="cb25-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb25-6">ourdata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[:,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,:] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># max cb_len</span></span>
<span id="cb25-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> q1, d <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(d_choices):</span>
<span id="cb25-8">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(K_choices)</span>
<span id="cb25-9">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ourdata[q1]</span>
<span id="cb25-10">    ax.semilogy(x,y,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"d = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb25-11">    </span>
<span id="cb25-12">box <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.get_position()</span>
<span id="cb25-13">ax.set_position([box.x0, box.y0, box.width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, box.height])</span>
<span id="cb25-14">ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center left'</span>, bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb25-15">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"K"</span>)</span>
<span id="cb25-16">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"error"</span>)</span>
<span id="cb25-17">plt.show()</span></code></pre></div>
</details>
<div id="fig-rvq-error-logz-varyk" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="fig-rvq-error-logz-varyk-1" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">

<div>                            <div id="702b742b-0d1b-4e99-bd34-d4c61c32601a" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("702b742b-0d1b-4e99-bd34-d4c61c32601a")) {                    Plotly.newPlot(                        "702b742b-0d1b-4e99-bd34-d4c61c32601a",                        [{"x":[[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[-3.224405,-5.73846,-7.4118648,-9.106539,-11.846527,-14.425459,-14.848204],[-2.3546593,-4.3316574,-6.0297394,-7.607898,-11.1222725,-14.419368,-14.740961],[-1.4203463,-2.7881258,-4.1049337,-5.4392023,-7.9532456,-10.347302,-12.598212],[-1.1800427,-2.330022,-3.4667091,-4.550867,-6.73431,-8.7964945,-10.812202],[-0.78516006,-1.550504,-2.3245468,-3.1174362,-4.573653,-5.985911,-7.417034],[-0.5713669,-1.1497808,-1.7276982,-2.2939837,-3.380397,-4.442157,-5.582937],[-0.4546547,-0.9143086,-1.3624536,-1.8124374,-2.6217163,-3.4454503,-4.280762],[-0.3907326,-0.7049824,-1.0309411,-1.3590288,-2.0810802,-2.7485373,-4.0779834],[-0.35315803,-0.6559364,-0.96061885,-1.2852163,-1.9224304,-2.6384947,-3.5889297],[-0.33344215,-0.65092665,-0.96849597,-1.2986574,-1.923794,-2.6294942,-3.2139428]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"K"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"log10( error )"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":-0.1,"y":0,"z":-0.22},"eye":{"x":0.3,"y":-1.8,"z":1}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('702b742b-0d1b-4e99-bd34-d4c61c32601a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption">(a) (Interactive) 3D Surface Plot</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-rvq-error-logz-varyk-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ_files/figure-html/fig-rvq-error-logz-varyk-output-2.png" class="img-fluid figure-img" data-ref-parent="fig-rvq-error-logz-varyk"></p>
<figcaption class="figure-caption">(b) Line plot</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;20<strong>.</strong> Reconstruction error for codebook length of 2048 with various data dimensions and number of codebooks (K). (Logarithmic z-axis)</figcaption><p></p>
</figure>
</div>
</div>
<p>Note that in the last figure, we see <strong>straight lines</strong><sup>1</sup> across as we vary K, and the K-axis is linear and the error axis is logarithmic.<img src="https://latex.codecogs.com/png.latex?%5E*"> What this means is – and this is a major takeway:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>As we add codebooks to the RVQ algorithm, the error decreases <em>exponentially</em>!</strong></p>
</div>
</div>
<p>This is a big “selling point” for the RVQ method: you get an <em>exponential</em> payoff in error reduction for a <em>linear</em> increase in computational cost.</p>
</section>
</section>
<section id="addendum-difficulty-at-very-high-dimensions" class="level1">
<h1>Addendum: Difficulty at Very High Dimensions</h1>
<p>However, the above results also indicate that, for very high dimensions (say, <img src="https://latex.codecogs.com/png.latex?d%20%5Cgeq%20128">), (R)VQ doesn’t offer nearly as big of a payoff as is does for lower dimensions – adding more and larger codebooks doesn’t have <em>that much</em> of an effect on the errors.</p>
<p>For this reason, in their <em>brand new</em><sup>2</sup> paper “<a href="https://arxiv.org/abs/2306.06546">High-Fidelity Audio Compression with Improved RVQGAN</a>”, the <a href="https://www.descript.com/">Descript</a> team choose to project down to a lower-dimensional space (<img src="https://latex.codecogs.com/png.latex?d=8">) first, using <a href="https://pytorch.org/docs/stable/generated/torch.nn.Linear.html">Linear</a> layers, and <em>then</em> perform RVQ, and then project back up using another set of Linear Layers.</p>
<hr>
<p>…Pausing here for now. There’s more that we could say and do – for example, “How do you do backpropagation with RVQ?” – but this seems like a good place to pause this discussion.</p>
</section>
<section id="acknowledgement" class="level1">
<h1>Acknowledgement</h1>
<p>Thanks to <a href="https://twitter.com/zqevans">Zach Evans</a> of <a href="https://www.harmonai.org/">Harmonai</a> for the impetus to look into this topic, and for helpful discussions and corrections while I was writing.</p>
<hr>
<p>(c) 2023 Scott H. Hawley</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Yes, the lines flatten out when we reach machine precision of <img src="https://latex.codecogs.com/png.latex?10%5E%7B-15%7D">; don’t worry about that.↩︎</p></li>
<li id="fn2"><p>Brand new” as in “came out while I was finishing this post”!↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>compression</category>
  <category>ssl</category>
  <guid>https://drscotthawley.github.io/blog/posts/2023-06-12-RVQ.html</guid>
  <pubDate>Mon, 12 Jun 2023 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/rvq_image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>BYOL - Contrastive Representation Learning without Contrastive Losses</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2022-11-17-byol.html</link>
  <description><![CDATA[ 




<p><em>“In this work, we thus tasked ourselves to find out whether…negative examples are indispensable to prevent collapsing while preserving high performance.”</em> – the BYOL paper</p>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References:</h2>
<p>This post is indebted to * <a href="https://arxiv.org/pdf/2006.07733.pdf">The Bootstrap Your Own Latent (BYOL) paper</a> by Grill et al – you could just stop reading my blog and read that, it’s not a scary paper! (And yes, actually use the arXiv version because it’s got extra figures not in the NeurIPS version I found.)<br>
* The <a href="https://theaisummer.com/byol/">wonderful tutorial from The AI Summer</a> by Nikolas Adaloglou * The <a href="https://arxiv.org/pdf/2103.06695.pdf">“BYOL-A: BYOL for Audio” paper</a> by Nizumi et al * The <a href="https://github.com/lucidrains/byol-pytorch"><code>byol-pytorch</code></a> code repository by Phil Wang aka lucidrains</p>
</section>
<section id="review" class="level2">
<h2 class="anchored" data-anchor-id="review">Review</h2>
<p>Previously, on “Trying to Understand Embeddings, with Scott”, i.e.&nbsp;<a href="https://drscotthawley.github.io/blog/2021/08/01/Live-CL-Demo.html">Part 3 of my blog series</a>, we’d worked out way to think of embeddings, and contrastive losses, and even built a toy model.</p>
<p>In the toy model there were pairwise losses (boo!) and triplet losses (yay!), and even an “Attract Only” option whereby we got rid of ‘repulsion’ entirely. After the “Attract Only” ran, we would rescale the answers and that rescaling would produce a kind of “repulsion”. In that sense, the “Attract Only” method was one way to “remove the contrastive loss” thing.</p>
<p>…uh… but as far as I know, nobody does that. The <a href="https://arxiv.org/abs/2002.05709">SimCLR</a> (“sim-clear”) method mentioned a bit in earlier posts and elsewhere is one way of dealing with the problem of finding “challenging” negative examples, by working on a kind of “attraction”, but not as naive as the toy model I made.</p>
<p>BYOL is another way to simplify ‘contrastive’ learning and avoid hard-negative mining and it seems a bit like “attract only” in that it no longer means <em>explicitly</em> including a respulsive term in the loss function, but BYOL different from SimCLR and not as naive as my own scheme. Instead, BYOL, uses an another network to do some comparisons.</p>
<p>Recal that the goal of these systems is to get “good”, “semantically meaningful” representations, however we can. If it takes multiple networks to do that, no worries.</p>
<p>In <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a> of this blog series, we looked at Siamese Networks, where two copies of the same network are employed for pairwise contrastive learning. With BYOL however, the two networks have the same architectures but <em>different weights</em>, and this difference helps to force “semantically interesting” embedding choices.</p>
<blockquote class="blockquote">
<p><strong>Anthropomorphism</strong>: The use of two very different networks to try to arrive at similar embedding points is akin to having two very different people talk about something (while each trying on lots of very different funny-colored eyeglasses!) and iteratively refine their understanding through discussion until they can come to (some sufficient level of) agreement.</p>
</blockquote>
</section>
<section id="strategy-how-were-going-to-do-this" class="level2">
<h2 class="anchored" data-anchor-id="strategy-how-were-going-to-do-this">Strategy: How we’re going to do this</h2>
<p>I’m a firm believer in toy models, so my plan is to use the <a href="https://github.com/zalandoresearch/fashion-mnist">Fashion-MNIST</a> dataset and then BYOL-embed a 3-dimensional set of represenations that we can look at and play with.</p>
<p>Oh, and since BYOL is a self-supervised method, we’re going to <em>throw away the labels</em> from Fashion-MNIST ;-).</p>
</section>
<section id="how-byol-works" class="level2">
<h2 class="anchored" data-anchor-id="how-byol-works">How BYOL Works</h2>
<section id="in-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="in-diagrams">In Diagrams</h3>
<p>First let’s steal multiple diagrams that all attempt to show the same thing.</p>
<p>From the original BYOL paper, we have this one: <img src="https://drscotthawley.github.io/blog/posts/images/byol_orig_proc_diagram.png" class="img-fluid" alt="byol_orig_process"></p>
<blockquote class="blockquote">
<p><em>“BYOL’s goal is to learn a representation <img src="https://latex.codecogs.com/png.latex?y_%5Ctheta"> which can then be used for downstream tasks.”</em> – the BYOL paper.</p>
</blockquote>
<blockquote class="blockquote">
<p>So beyond the “representation” parts we want to ultimately use, we’ll tack on additional “projection” parts (and even a “prediction” part) to facilitate the training.</p>
</blockquote>
<p>Later in the BYOL paper (Figure 8), we have this version: <img src="https://drscotthawley.github.io/blog/posts/images/byol_aisummer_proc.png" class="img-fluid" alt="byol_aisummer_process"></p>
<p>And from the BYOL-A paper we have this version: <img src="https://drscotthawley.github.io/blog/posts/images/byola_proc_diagram.png" class="img-fluid" alt="byol-a process diagram"></p>
<p>In each case, what we see are 3 main parts:</p>
<ol type="1">
<li>A single input (<img src="https://latex.codecogs.com/png.latex?x">) gets modified in two different ways (<img src="https://latex.codecogs.com/png.latex?v"> and <img src="https://latex.codecogs.com/png.latex?v')">. The two different ways are termed <em>views</em>.<br>
</li>
<li>Each view is sent through a different network (“online” or “target”) and gets mapped to the <em>same</em> embedding space.<br>
</li>
<li>Then the loss/training is about minimizing the distance between those points in the embeddings space.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>there is only minimizing, i.e.&nbsp;“attraction” going on. There is no “repulsion”.</p>
</div>
</div>
<p>Those were broad strokes. What about the details? What about the “exponential moving average” bit, and the <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta(z_%5Ctheta)"> and <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi">, and that…equation? We’ll get there.</p>
<blockquote class="blockquote">
<p>Note also that we don’t “want to keep” those points <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta(z_%5Ctheta)"> and <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi">, they’re just used along the way to help us learn the representations <img src="https://latex.codecogs.com/png.latex?y_%5Ctheta">.</p>
</blockquote>
</section>
<section id="contrastive-learning-without-contrastive-loss-via-different-networks" class="level3">
<h3 class="anchored" data-anchor-id="contrastive-learning-without-contrastive-loss-via-different-networks">Contrastive Learning Without Contrastive Loss, via Different Networks</h3>
<p>The two networks aren’t <em>totally</em> different. If you look at the second diagram above (with the dogs), you’ll see that the the first couple layers (in yellow) are of the same types: ResNet then MLP. They don’t have the same weights, but the weights are “related”.</p>
<p>And one of the networks (the “target”) learns “slower” than the other (“online”) network… in a sense. This is the “exponential moving average” (EMA) part. EMA gets used in many contexts in machine learning (ML) to try to help keep things stable so that the system doesn’t jump around too much, i.e.&nbsp;to keep the system from behaving erratically. Think of reinforcement learning, where you want your robot to smoothly improve its position information instead of undergoing wild overcorrections.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In some ML contexts, the slower-learning network is called the “teacher” rather than the “target”, and the “online” network is termed the “student”. <a href="https://paperswithcode.com/paper/knowledge-distillation-and-student-teacher">Here’s a link for an influential paper on “Teacher-Student” models</a>. I find this terminology to be counter-intutitive because in the BYOL case the “student” would be <em>teaching</em> the “teacher”.</p>
</div>
</div>
<p>The target network gets its weights <em>only</em> from the EMA of the corresponding weights in the online network. The target weights are not obtained via gradient descent; only the online weights are updated via gradient descent.) In other words, if the online weights are <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> and the target weights are <img src="https://latex.codecogs.com/png.latex?%5Cxi">, then the EMA operation consists of</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cxi%20%5Cleftarrow%20%5Ctau%20%5Cxi%20+%20(1%20-%20%5Ctau)%20%5Ctheta,%20"> for some choice of the “EMA spread/strength” (hyper)parameter <img src="https://latex.codecogs.com/png.latex?%5Ctau">.</p>
<p>The terms “target” and “online” can also refer to the representation “points” in the embedding space. Using such terminology, the BYOL paper explains the method this way:</p>
<blockquote class="blockquote">
<p><em>“the core motivation for BYOL: from a given representation, referred to as target, we can train a new, potentially enhanced representation, referred to as online, by predicting the target representation. From there, we can expect to build a sequence of representations of increasing quality by iterating this procedure, using subsequent online networks as new target networks for further training…”</em></p>
</blockquote>
<p>…i.e.&nbsp;we update the target (a bit, using the EMA) and do it all again.</p>
<p>Ok, so then what’s with the extra “projection” and “prediction” layers?</p>
</section>
<section id="the-mapping-functions" class="level3">
<h3 class="anchored" data-anchor-id="the-mapping-functions">The Mapping Functions</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The BYOL authors use the subscript “<img src="https://latex.codecogs.com/png.latex?%7B%7D_%5Ctheta">” to refer to weights in the online network, and the subscript “<img src="https://latex.codecogs.com/png.latex?%7B%7D_%5Cxi">” to refer to weights in the target network. Vectors in the target network are also denoted via primes, e.g., <img src="https://latex.codecogs.com/png.latex?v'">, <img src="https://latex.codecogs.com/png.latex?y'">, <img src="https://latex.codecogs.com/png.latex?z'">.</p>
</div>
</div>
<ul>
<li><p><strong>Encoder <img src="https://latex.codecogs.com/png.latex?f"></strong> (<img src="https://latex.codecogs.com/png.latex?f_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?f_%5Cxi">): Views (i.e., <img src="https://latex.codecogs.com/png.latex?v"> and <img src="https://latex.codecogs.com/png.latex?v'">, i.e., augmented versions of the input <img src="https://latex.codecogs.com/png.latex?x">) are mapped to embeddings <img src="https://latex.codecogs.com/png.latex?y"> (<img src="https://latex.codecogs.com/png.latex?y_%5Ctheta"> in the online network) via the “encoder” function <img src="https://latex.codecogs.com/png.latex?f"> (<img src="https://latex.codecogs.com/png.latex?f_%5Ctheta"> online). And remember, <em>“BYOL’s goal is to learn a representation <img src="https://latex.codecogs.com/png.latex?y_%5Ctheta"> which can then be used for downstream tasks.”</em> For images, <img src="https://latex.codecogs.com/png.latex?f"> is typically a ResNet.</p></li>
<li><p><strong>Projector <img src="https://latex.codecogs.com/png.latex?g"></strong> (<img src="https://latex.codecogs.com/png.latex?g_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?g_%5Cxi">): Maps the embeddings <img src="https://latex.codecogs.com/png.latex?y"> to points <img src="https://latex.codecogs.com/png.latex?z"> in the space where loss will be evaluated. In particular, <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi"> is important because it’s a point output by the target network, which the online network is going to try to “predict”. <img src="https://latex.codecogs.com/png.latex?g"> can just be an MLP (though see below for comments about BatchNorm).</p></li>
<li><p><strong>Predictor <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta"></strong>: is only on the online network. The predictors output <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta(z_%5Ctheta)"> is the online network’s <em>prediction</em> of the target network’s output <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi">.</p></li>
</ul>
</section>
<section id="hold-up-questions" class="level3">
<h3 class="anchored" data-anchor-id="hold-up-questions">Hold up: Questions</h3>
<ol type="1">
<li><p>Why’s the predictor there at all? In other words, why can’t we just compare <img src="https://latex.codecogs.com/png.latex?z_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi"> without this additional <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta"> function?</p></li>
<li><p>And for that matter, why can’t we just compare <img src="https://latex.codecogs.com/png.latex?y_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?y'_%5Cxi"> directly?</p></li>
</ol>
<p>Let’s answer these in reverse order:</p>
<ol start="2" reversed="reversed">
<li>
Comparing <img src="https://latex.codecogs.com/png.latex?y_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?y'_%5Cxi"> is what we were already doing before with ordinary contrastive losses.
</li>
<li>
And then SimCLR came along and introduced an additional mapping function akin to our “projector” <img src="https://latex.codecogs.com/png.latex?g"> in which we could compare <img src="https://latex.codecogs.com/png.latex?z_%5Ctheta"> and <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi"> – so that’s been tried already. And it does work quite well for assisting with contrastive representation learning without having to worry to much about finding “hard negatives”.
</li>
</ol>
<p>But now we’re trying something different, with the goal of avoiding negative examples (i.e.&nbsp;contrastive losses) and the goal of…beating SimCLR. ;-) So bear with this discussion!</p>
</section>
<section id="the-loss" class="level3">
<h3 class="anchored" data-anchor-id="the-loss">The Loss</h3>
<p>We define a loss in the “projected” space between the points <img src="https://latex.codecogs.com/png.latex?q_%5Ctheta(z_%5Ctheta)"> and <img src="https://latex.codecogs.com/png.latex?z'_%5Cxi">, that’s just the ordinary mean L2 norm (“Euclidean distance”) between them. So</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7B%5Ctheta%5Cxi%7D=%20%7C%7C%5Cbar%7Bq_%7B%5Ctheta%7D%7D(z_%5Ctheta)%20-%20%5Cbar%7Bz%7D'_%5Cxi%7C%7C_2%5E2"></p>
<p>Or you can write it in terms of a dot product normalized by the magnitudes, which is what we see written in the BYOL paper:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7B%5Ctheta%5Cxi%7D%20=%202%20-%202%5Ccdot%5Cfrac%7B%5Clangle%20q_%5Ctheta(z_%5Ctheta),%20%20z'_%5Cxi%20%5Crangle%20%7D%7B%5Cbig%5C%7Cq_%5Ctheta(z_%5Ctheta)%5Cbig%5C%7C_2%5Ccdot%20%5Cbig%5C%7Cz'_%5Cxi%5Cbig%5C%7C_2%20%20%7D%0A"></p>
<p>If that reminds you of a cosine similarity – good, because that’s exactly what it is. See, the graph of <img src="https://latex.codecogs.com/png.latex?2(1-%5Ccos%20x)"> has a nice minimum when its argument is zero, kind of like a parabola on a certain domain:</p>
<p>::: {.cell 0=‘h’ 1=‘i’ 2=‘d’ 3=‘e’}</p>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb1-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.pi, np.pi,num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)</span>
<span id="cb1-5">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2 - 2 cos(x)'</span>)</span>
<span id="cb1-6">plt.plot(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.cos(x)))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-11-17-BYOL_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
<p>:::</p>
<p>One other thing they do is to “symmetrize” the loss by also passing <img src="https://latex.codecogs.com/png.latex?v'"> through the online network and passing <img src="https://latex.codecogs.com/png.latex?v"> through the target network, to compute what they call <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7B%5Cmathcal%7BL%7D%7D_%7B%5Cxi%5Ctheta%7D">, and then the full loss is the sum of these two losses:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D%5E%7B%5Crm%20BYOL%7D%20=%20%5Cmathcal%7BL%7D_%7B%5Ctheta%5Cxi%7D%20+%20%5Ctilde%7B%5Cmathcal%7BL%7D%7D_%7B%5Cxi%5Ctheta%7D"></p>
</section>
<section id="further-theory-reading" class="level3">
<h3 class="anchored" data-anchor-id="further-theory-reading">Further Theory-Reading</h3>
<ul>
<li>Still you may ask, “But whyyyyyyy does this work?” Here’s a good paper that tries to answer just that: <a href="https://arxiv.org/abs/2102.06810">“Understanding self-supervised Learning Dynamics without Contrastive Pairs”</a> by Tian et al (2021).</li>
<li>“What’s up with the batch norm / group norm stuff that appears in some discussions of BYOL?” (which I may or may not have mentioned above, LOL): See <a href="https://arxiv.org/abs/2010.10241">“BYOL works even without batch statistics”</a> by Richemond et al (2020).</li>
</ul>
</section>
</section>
<section id="lets-go-quick-implemenation-for-images" class="level2">
<h2 class="anchored" data-anchor-id="lets-go-quick-implemenation-for-images">Let’s Go! Quick Implemenation for Images</h2>
<p>In a later post we can talk about writing our own implmentation from scratch (e.g.&nbsp;for something other than images, such as audio). But to just get started with all this, what better place to start a coding implementation than <a href="https://github.com/lucidrains/byol-pytorch">lucidrains’ repository</a>? It’s super easy to install:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>pip <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq install byol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>pytorch</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: you may need to restart the kernel to use updated packages.</code></pre>
</div>
</div>
<p>…and we can just “tack it on” to whatever network/task we might have. He provides a sample use case in his README which we’ll modify slightly. First, he sets up a simple test using random images, which we’ll run a version of now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> byol_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BYOL </span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> models, transforms, datasets</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tqdm.notebook <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm_notebook</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">resnet <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> models.resnet50(weights<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this will download resnet50 weights. </span></span>
<span id="cb5-2"></span>
<span id="cb5-3">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.device(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mps'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span>
<span id="cb5-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.device(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> device: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Warning: Running on the CPU."</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6">image_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># size for fashion mnist images</span></span>
<span id="cb5-7"></span>
<span id="cb5-8">learner <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BYOL(     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lucidrains' class</span></span>
<span id="cb5-9">    resnet,</span>
<span id="cb5-10">    image_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image_size,</span>
<span id="cb5-11">    hidden_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avgpool'</span></span>
<span id="cb5-12">).to(device)</span>
<span id="cb5-13"></span>
<span id="cb5-14">opt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam(learner.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3e-4</span>)</span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sample_unlabelled_images():</span>
<span id="cb5-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.randn(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, image_size, image_size).to(device)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make batch of 20 RGB images from random pixels.</span></span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tqdm_notebook(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)):</span>
<span id="cb5-20">    images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_unlabelled_images()</span>
<span id="cb5-21">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learner(images)</span>
<span id="cb5-22">    opt.zero_grad()</span>
<span id="cb5-23">    loss.backward()</span>
<span id="cb5-24">    opt.step()</span>
<span id="cb5-25">    learner.update_moving_average() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update moving average of target encoder</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0a13f79dfac44ab4bd5eb9cde8825cfe","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>Great! It works!</p>
<p>Now, rather than using random images, we’ll use Fashion-MNIST. Let’s get the data…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">training_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.FashionMNIST(</span>
<span id="cb6-2">    root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>,</span>
<span id="cb6-3">    train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-4">    download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-5">    transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>transforms.ToTensor()</span>
<span id="cb6-6">)</span>
<span id="cb6-7"></span>
<span id="cb6-8">batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span></span>
<span id="cb6-9">train_dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(training_data, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>And… we should note that we don’t <em>have</em> to use ResNet50 – in fact, we don’t have to use ResNet-Anything! We could specify some other model, which for our dataset, a very simple model could suffice.</p>
<p>And/or, rather than a classifcation model, we could choose something like a U-Net, and then try to get the “interior” represenation of the U-Net to offer a more interesting represenation than it otherwise might.</p>
<p>For now, just to avoid having to deviate from lucidrains’ demo much, we will stick with pretrained ResNet and just “drop down” in complexity to <code>resnet18</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">resnet <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> models.resnet18(weights<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reset resnet weights. </span></span>
<span id="cb7-2"></span>
<span id="cb7-3">learner <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BYOL(</span>
<span id="cb7-4">    resnet, </span>
<span id="cb7-5">    image_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, </span>
<span id="cb7-6">    hidden_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avgpool'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># activations from this layer will be used as y_theta!</span></span>
<span id="cb7-7">    use_momentum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set to false for 'SimSiam' variant. https://arxiv.org/abs/2011.10566</span></span>
<span id="cb7-8">).to(device)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train_it(learner, lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3e-4</span>, epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>):</span>
<span id="cb7-11">    opt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam(learner.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lr)</span>
<span id="cb7-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> e <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(epochs): </span>
<span id="cb7-13">        pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm_notebook(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(steps), desc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>e<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epochs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: "</span>)</span>
<span id="cb7-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> pbar:</span>
<span id="cb7-15">            images, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>(train_dataloader))</span>
<span id="cb7-16">            images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> images.to(device).tile([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># put on GPU &amp; create RGB from greyscale</span></span>
<span id="cb7-17">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learner(images)</span>
<span id="cb7-18">            pbar.set_postfix({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span>:<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>detach()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>})</span>
<span id="cb7-19">            pbar.refresh()</span>
<span id="cb7-20">            opt.zero_grad()</span>
<span id="cb7-21">            loss.backward()</span>
<span id="cb7-22">            opt.step()</span>
<span id="cb7-23">            learner.update_moving_average() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update moving average of target encoder</span></span>
<span id="cb7-24">            </span>
<span id="cb7-25">train_it(learner) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># operates on learner &amp; resnet in-place</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"104c60786f344b0fa79c7ac973a282b7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b0c6c1e53d7a43e097b27eefec24ca97","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bb1fb4af6088404ba78802e1a271dee9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c2798d977d8c4e398e03df92729388c8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"20344289a17c4a05991fa221d2954a13","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<section id="inspecting-our-results" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-our-results">Inspecting Our Results</h3>
<p>How do we access and inspect the representations learned from this? lucidrains’ README tells us that we already specified that:</p>
<blockquote class="blockquote">
<p>the name (or index) of the hidden layer, whose output is used as the latent representation used for self-supervised training.</p>
</blockquote>
<p>…So we specified the layer named “<code>avgpool</code>” as the layer of our network <code>resnet</code> whose activations will serve as our learned representations. We can print out the names of the layers to see where <code>avgpool</code> is (look way near the bottom):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">resnet</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)</code></pre>
</div>
</div>
<p>So pretty much all the way at the end, just before the last Linear layer. Let’s see how we can get these layer outputs / activations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get some mo' images</span></span>
<span id="cb10-2">images, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>(train_dataloader))</span>
<span id="cb10-3">images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> images.to(device).tile([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># put on GPU &amp; create RGB from greyscale</span></span>
<span id="cb10-4">images.shape</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([128, 3, 28, 28])</code></pre>
</div>
</div>
<p>One way is to use some code we can find in lucidrains’ source code…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learner.online_encoder.get_representation(images)</span>
<span id="cb12-2">reps.shape</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([128, 512])</code></pre>
</div>
</div>
<p>But the ‘classic’ way to do this in PyTorch is to <a href="https://discuss.pytorch.org/t/how-can-l-load-my-best-model-as-a-feature-extractor-evaluator/17254/6">register a “forward hook”</a>, as in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_activation(name):</span>
<span id="cb14-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> hook(model, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>, output):</span>
<span id="cb14-4">        activation[name] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> output.detach()</span>
<span id="cb14-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> hook</span>
<span id="cb14-6"></span>
<span id="cb14-7">resnet.avgpool.register_forward_hook(get_activation(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avgpool'</span>))</span>
<span id="cb14-8">output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> resnet(images)</span>
<span id="cb14-9">reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activation[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avgpool'</span>].squeeze()</span>
<span id="cb14-10">reps.shape</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>torch.Size([128, 512])</code></pre>
</div>
</div>
<p>Note that our images are 28x28=784 monochrome pixels, so a “representation” via 512 points does not make much of a compression. ….But at this point, you can see the basics of how this works.</p>
<p>No promises, but I may do a later version of this blog where we write our BYOL code from scratch, and/or use a U-Net or some other architecture, and/or look more closely into BYOL-A, but for now, this seems like a reasonable stopping point. :-)</p>


</section>
</section>

 ]]></description>
  <category>ssl</category>
  <guid>https://drscotthawley.github.io/blog/posts/2022-11-17-byol.html</guid>
  <pubDate>Thu, 17 Nov 2022 06:00:00 GMT</pubDate>
  <media:content url="https://production-media.paperswithcode.com/methods/Screenshot_2021-03-15_at_19.58.32_ENGHInW.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Shell Volumes and Distances in High-Dimensional Spaces</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2022-11-15-multidim-shells.html</link>
  <description><![CDATA[ 




<p>Some of us are still not accustomed to thinking in terms of very high numbers of dimensions – myself included. Earlier this year, I made a post on <a href="https://drscotthawley.github.io/blog/2022/01/24/MultiDim-DotProducts.html">vector orthogonality in high-dimensional spaces</a>.</p>
<p>This post is about the <em>volume</em> of high-dimensional spaces. Even in two dimensions, you may be aware of facts such as that <strong>a 20-inch pizza has more than twice the area of a 14-inch pizza</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Areas ="</span>,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> r <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Areas in square inches = [615.44, 1256.0]</code></pre>
</div>
</div>
<p>As we go to higher dimensions, such observations become more stark, for example that a sphere of radius 4 has <strong>eight times</strong> the volume of a sphere of radius 2.</p>
<section id="intuition-from-geometry-volumes-of-n-balls" class="level2">
<h2 class="anchored" data-anchor-id="intuition-from-geometry-volumes-of-n-balls">Intuition from Geometry: Volumes of n-balls</h2>
<p>Let’s consider the <a href="https://en.wikipedia.org/wiki/Volume_of_an_n-ball">volume of a multidimensional “n-ball”</a> of dimension <img src="https://latex.codecogs.com/png.latex?n"> and radius <img src="https://latex.codecogs.com/png.latex?r">, which is given by this recurrence relation: <img src="https://latex.codecogs.com/png.latex?%20%7B%5Cdisplaystyle%20V_%7Bn%7D(r)=%7B%5Cbegin%7Bcases%7D1&amp;%7B%5Ctext%7Bif%20%7D%7Dn=0,%5C%5C%5B0.5ex%5D2r&amp;%7B%5Ctext%7Bif%20%7D%7Dn=1,%5C%5C%5B0.5ex%5D%7B%5Cdfrac%20%7B2%5Cpi%20%7D%7Bn%7D%7Dr%5E%7B2%7D%5Ctimes%20V_%7Bn-2%7D(r)&amp;%7B%5Ctext%7Botherwise%7D%7D.%5Cend%7Bcases%7D%7D%7D%20"></p>
<p>So, for example, <img src="https://latex.codecogs.com/png.latex?V_2(r)%20=%20%5Cpi%20r%5E2">, <img src="https://latex.codecogs.com/png.latex?V_3(r)%20=%20%7B2%5Cpi%5Cover%203%7Dr%5E2%5Ctimes%202r%20=%20%7B4%5Cover%203%7D%5Cpi%20r%5E3">,…and so on.</p>
<p>Let’s consider the <em>percentage of the total</em> volume for a shell of thickness <img src="https://latex.codecogs.com/png.latex?%5CDelta%20r">, as a function of both <img src="https://latex.codecogs.com/png.latex?r"> and <img src="https://latex.codecogs.com/png.latex?n">. In the following we’re going to plot <img src="https://latex.codecogs.com/png.latex?V_n(r+%5CDelta%20r)%20-%20V_n(r)"> as we vary <img src="https://latex.codecogs.com/png.latex?n">, and let’s take steps of size <img src="https://latex.codecogs.com/png.latex?%5CDelta%20r"> = r/10 and let <img src="https://latex.codecogs.com/png.latex?n=2,3,4">…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> volume(n, r):</span>
<span id="cb3-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"a recursive formula for the volume of an n-ball of radius r"</span></span>
<span id="cb3-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>n: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>n: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>r</span>
<span id="cb3-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> volume(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, r)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_fractions(ns, dr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb3-11">    rs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dr,num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dr)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#we'll let r go from 0 to 1</span></span>
<span id="cb3-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print("rs = ",rs)</span></span>
<span id="cb3-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ns:</span>
<span id="cb3-14">        v_dr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (volume(n, rs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>dr) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> volume(n, rs))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># volume of the shell</span></span>
<span id="cb3-15">        fractions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v_dr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>volume(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fraction of total volume</span></span>
<span id="cb3-16">        plt.plot(rs, fractions, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'n=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(fractions) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: fractions don't add up to 1"</span></span>
<span id="cb3-18">    plt.legend()</span>
<span id="cb3-19">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>)</span>
<span id="cb3-20">    plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fraction of total volume'</span>)</span>
<span id="cb3-21">    plt.show()</span>
<span id="cb3-22">    </span>
<span id="cb3-23">plot_fractions([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-11-15-MultiDim-Shells_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>If we go to larger numbers of dimensions, we see that almost the entire volume is made up of a thin shell near the perimeter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">plot_fractions([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>], dr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-11-15-MultiDim-Shells_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In Deep Learning applications, it’s not uncommon to have dimensions <img src="https://latex.codecogs.com/png.latex?n"> which are 64, 256, even over 1000 dimensions. For data points which populate such a high dimensional n-ball with <strong>uniform density</strong>, essentially all of them will lie “on the surface” of the n-ball.</p>
<p>We may want to know about the distance between such points. If they’re inside a “volume”, we might think than a Euclidean-type distance would be the best. But if they <em>pretty much all lie</em> along the surface of a sphere, would that really be any better or worse that something like an angular distance or the frequently used <a href="https://en.wikipedia.org/wiki/Cosine_similarity">cosine similarity</a>?</p>
<p>Hmmm. Good question. We should consider something else first before we go on.</p>
</section>
<section id="hold-up.-an-n-ball-of-uniform-density-how-relevant-is-that" class="level2">
<h2 class="anchored" data-anchor-id="hold-up.-an-n-ball-of-uniform-density-how-relevant-is-that">Hold up. “An n-ball of uniform density”: How relevant is that?</h2>
<p>That depends.</p>
<p>Previously we were imagining just the volume of the n-ball itself, then we imagined it being populated “uniformly” by data points. But is that likely to happen? In other words, if we’ve got <img src="https://latex.codecogs.com/png.latex?n"> random variables that are each uniformly distributed on <img src="https://latex.codecogs.com/png.latex?%5B0..1%5D">, then are we saying that the average radius (or distance from the origin) is going to be close to 1? Uh…. let’s check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>]:</span>
<span id="cb5-2">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.rand(n)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># some random vector</span></span>
<span id="cb5-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"n = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, distance = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>sqrt(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n = 2, distance = 0.4531853366702091
n = 3, distance = 1.0826001130628344
n = 4, distance = 1.2805569079817343
n = 10, distance = 1.965822638795274
n = 20, distance = 2.9421432188892176</code></pre>
</div>
</div>
<p>…so, no. We can actually get greater distances than 1 this way. That means that such points are <strong>not within the unit n-ball</strong>.</p>
<p>But what if these are the kinds of points we’re mostly likely to get in our Data Science and Deep Learning investigations? That depends on our data, and how it may (or may not) be normalized.</p>
<p>If we have such random, independent variables, which may lie outside the unit n-ball, what can we say about their distances? Well, the above list of outputs were were just <em>one vector</em> for each dimension. Let’s take a look a a number (…ah we can’t use the letter <img src="https://latex.codecogs.com/png.latex?n">, let’s say) <img src="https://latex.codecogs.com/png.latex?m"> random vectors in <img src="https://latex.codecogs.com/png.latex?n"> dimensions…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">ns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of dimensions</span></span>
<span id="cb7-2">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of random vectors in each dimension</span></span>
<span id="cb7-3">avg_distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb7-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ns:</span>
<span id="cb7-5">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.rand(m,n)</span>
<span id="cb7-6">    distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb7-7">    avg_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(distance)</span>
<span id="cb7-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"n = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, avg distance from origin = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>avg_distance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb7-9">    avg_distances.append(avg_distance)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n = 2, avg distance from origin = 0.7481821823467171
n = 3, avg distance from origin = 0.9691494533397342
n = 4, avg distance from origin = 1.124886358111731
n = 10, avg distance from origin = 1.8035216690887792
n = 32, avg distance from origin = 3.261533859767904
n = 64, avg distance from origin = 4.607289814395833
n = 128, avg distance from origin = 6.527956044174336
n = 256, avg distance from origin = 9.238162970649888
n = 512, avg distance from origin = 13.071335971436879
n = 1024, avg distance from origin = 18.464564627923217
n = 2048, avg distance from origin = 26.135526554018735</code></pre>
</div>
</div>
<p>It kind of looks like a (sideways) parabola!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">plt.plot(ns,avg_distances, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avg_distance'</span>)</span>
<span id="cb9-2">plt.plot(ns, np.sqrt(np.array(ns)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{n}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/3$'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># what if we also plot sqrt(n)* a constant? </span></span>
<span id="cb9-3">plt.legend()</span>
<span id="cb9-4">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avg distance'</span>)</span>
<span id="cb9-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$n$'</span>)</span>
<span id="cb9-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-11-15-MultiDim-Shells_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now, if we were to <em>normalize</em> these points so that they had some similar magnitude, that’d be fine, although if we normalized using the Euclidean norm that would <em>force</em> the points to lie on the surface of the n-ball, i.e.&nbsp;an n-sphere. That’s kind of boring, right? ;-)</p>
<p>More interesting would probably be those points which have been normalized according to the frequently-used <a href="https://en.wikipedia.org/wiki/Softmax_function">softmax</a> function,</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%7B%5Crm%20softmax%7D(x_i)%20=%20%7Be%5E%7Bx_i%7D%20%5Cover%20%5Csum_j%20e%5E%7Bx_j%7D%7D,"></p>
<p>which will force them to have unit magnitude according to the L1 norm or “<a href="https://en.wikipedia.org/wiki/Taxicab_geometry">Manhattan Distance</a>” which was the subject of <a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html">earlier investigations in this blog</a>.</p>
<p>So, what we’ll do is we’ll choose random variables on some interval – but will they be uniform, Gaussian, or some other choice? – and then softmax them, and then have a look at their distance from the origin, and <strong>then, more importantly, their distances from each other</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> softmax(x):</span>
<span id="cb10-2">    xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this little trick can help with numerical accuracy</span></span>
<span id="cb10-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.exp(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>xmax) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.exp(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xmax))</span>
<span id="cb10-4"></span>
<span id="cb10-5"></span>
<span id="cb10-6">ns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of dimensions</span></span>
<span id="cb10-7">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of random vectors in each dimension</span></span>
<span id="cb10-8">avg_distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb10-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ns:</span>
<span id="cb10-10">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.rand(m,n)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># let each value vary on -1..1 before we softmax them</span></span>
<span id="cb10-11">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax(x)               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># softmax will force everything to have L1 norm = 1</span></span>
<span id="cb10-12">    distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># measure distance according to L2/Euclidean norm</span></span>
<span id="cb10-13">    avg_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(distance)</span>
<span id="cb10-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"n = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, avg distance from origin = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>avg_distance<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-15">    avg_distances.append(avg_distance)</span>
<span id="cb10-16"></span>
<span id="cb10-17">ns, avg_distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(ns), np.array(avg_distances)</span>
<span id="cb10-18">fit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11e-4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>ns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-19">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb10-20">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].plot(ns,avg_distances, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data points'</span>)</span>
<span id="cb10-21">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].plot(ns,fit, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rough fit$\sim 1/\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{n}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span>)</span>
<span id="cb10-22">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].plot(np.log10(ns),np.log10(avg_distances), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data points'</span>)</span>
<span id="cb10-23">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].plot(np.log10(ns),np.log10(fit), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rough fit$\sim 1/\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{n}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span>)</span>
<span id="cb10-24"></span>
<span id="cb10-25">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'avg radius'</span>)</span>
<span id="cb10-26">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$n$'</span>)</span>
<span id="cb10-27">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log10(avg radius)'</span>)</span>
<span id="cb10-28">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log10($n$)'</span>)</span>
<span id="cb10-29"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]: </span>
<span id="cb10-30">    ax[i].legend()</span>
<span id="cb10-31">    ax[i].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Softmaxxed uniform vectors"</span>)</span>
<span id="cb10-32">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n = 2, avg distance from origin = 0.0007511397255709152
n = 3, avg distance from origin = 0.0006308267488890856
n = 4, avg distance from origin = 0.0005510334461844213
n = 10, avg distance from origin = 0.00035750458935601627
n = 32, avg distance from origin = 0.00020173684564505517
n = 64, avg distance from origin = 0.00014270354448691296
n = 128, avg distance from origin = 0.00010118972374124984
n = 256, avg distance from origin = 7.159922929099627e-05
n = 512, avg distance from origin = 5.064894541153353e-05
n = 1024, avg distance from origin = 3.579446707831397e-05
n = 2048, avg distance from origin = 2.5317769100231054e-05</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-11-15-MultiDim-Shells_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>So does this mean that for larger numbers of dimensions, the “softmaxxed” points tend to get <strong>closer to the origin, rather than the perimeter</strong>? Well, not necessarily from these graphs alone. These are showing the <em>average</em>, which could be distorted by large values, for example. So let’s do a series of plots for different values of <img src="https://latex.codecogs.com/png.latex?n">.</p>
<p>….<strong>TODO.</strong> I’ll need to come back and fill this in later.<br>
For now, it’s an exercise for the student/professor. ;-)</p>


</section>

 ]]></description>
  <category>ssl</category>
  <category>math</category>
  <guid>https://drscotthawley.github.io/blog/posts/2022-11-15-multidim-shells.html</guid>
  <pubDate>Tue, 15 Nov 2022 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/softmax_radii.png" medium="image" type="image/png" height="65" width="144"/>
</item>
<item>
  <title>Likelihood of Vector Orthogonality in High-Dimensional Spaces</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2022-01-24-multidim-dotproducts.html</link>
  <description><![CDATA[ 




<p>One sometimes sees claims like <a href="https://towardsdatascience.com/loss-landscapes-and-the-blessing-of-dimensionality-46685e28e6a4">“within high dimensional spaces, if you choose random vectors, they tend to be orthogonal to each other,”</a> but is this true?</p>
<p>The answer <strong>depends on whether you’re talking about unit vectors or not</strong>.</p>
<p>More to the point, it depends on the context in which the above nugget of wisdom is being applied, and on not so much orthogonality per se as what we might call “near orthogonality”: Are we interested in cases when the <strong>dot product</strong> is nearly zero, or when the <strong>cosine</strong> of the angle between the vectors is nearly zero? (In the case of exact orthogonality, the dot product and cosine are both exactly zero.) The latter statement is equivalent to restricting attention to unit vectors, and also is isomorphic to considering the Pearson correlation coefficient between two random signals.</p>
<p>Let’s do some direct computations. We’ll vary the number of dimensions and compute a bunch of dot products between random vectors, and then plot histograms of these dot product values. The sharper the distribution is around the value of zero, the more likely it is for vectors to be orthogonal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#all_slow</span></span></code></pre></div>
</div>
<section id="general-setup" class="level2">
<h2 class="anchored" data-anchor-id="general-setup">General Setup</h2>
<p>Imports and global settings</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># General Setup</span></span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ss</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> display</span>
<span id="cb2-7"></span>
<span id="cb2-8">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb2-9"></span>
<span id="cb2-10">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of random pairs of vectors to try</span></span>
<span id="cb2-11">dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># different dimensionalities to try. Same as "D" in plots below</span></span>
<span id="cb2-12">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span></code></pre></div>
</div>
</section>
<section id="utility-routines" class="level2">
<h2 class="anchored" data-anchor-id="utility-routines">Utility Routines</h2>
<p>Define some functions that we’re likely to use multiple times.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Utility routines </span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> norm_rows(arr):   </span>
<span id="cb3-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"normalize vectors which exist as rows with components as columns"</span></span>
<span id="cb3-5">    arrT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> arr.T                               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .T is to make broadcasting work easily </span></span>
<span id="cb3-6">    mags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt( (arrT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>arrT).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) )  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vector magnitudes</span></span>
<span id="cb3-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (arrT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>mags).T</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> uniform_rand(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)):</span>
<span id="cb3-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"random number on [-1..1]"</span></span>
<span id="cb3-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.random.uniform(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>size)</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> softmax(x):</span>
<span id="cb3-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"good ol' softmax function, for a bunch of row vectors"</span></span>
<span id="cb3-15">    xT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.T  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .T's are just to make broadcasting work out.</span></span>
<span id="cb3-16">    vec_max <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(xT,axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-17">    e_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(xT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vec_max)   </span>
<span id="cb3-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (e_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> e_x.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)).T</span>
<span id="cb3-19"></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> make_plot(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n, dims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dims, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, rand_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>uniform_rand, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb3-22">             color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#1f77b4'</span>, xlim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, softmax_them<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, scale_x_by_sqrtd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb3-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""A function we'll call again &amp; again to make plots with"""</span></span>
<span id="cb3-24">    fig, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb3-25">    fig.suptitle(title, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x-large"</span>)</span>
<span id="cb3-26">    axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> axes.ravel()</span>
<span id="cb3-27">    sds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list of standard devations for different dims</span></span>
<span id="cb3-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i,ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(axes):</span>
<span id="cb3-29">        dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dims[i]</span>
<span id="cb3-30">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rand_func(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,dim))</span>
<span id="cb3-31">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rand_func(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,dim))</span>
<span id="cb3-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> softmax_them: a, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax(a), softmax(b)</span>
<span id="cb3-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> normalize: a, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm_rows(a), norm_rows(b)</span>
<span id="cb3-34">        dots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> scale_x_by_sqrtd: dots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> np.sqrt(dim)</span>
<span id="cb3-36">        std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.std(dots,axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># measure standard dev of distribution of dot product</span></span>
<span id="cb3-37">        ax.hist(dots, density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'D=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dim<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, $\sigma$=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>std<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:3.2g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color)  </span>
<span id="cb3-38">        sds.append(std)</span>
<span id="cb3-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> xlim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: ax.set_xlim(xlim)</span>
<span id="cb3-40">        ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># legend will show dimensions and std dev</span></span>
<span id="cb3-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Probability'</span>)</span>
<span id="cb3-42">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Dot product value'</span>)</span>
<span id="cb3-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sds, axes, fig   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># return some axes &amp; figure info too in case we want to replot</span></span></code></pre></div>
</details>
</div>
<p>Now we can get started by looking at distributions of dot products for various kinds of vectors. Starting with…</p>
</section>
<section id="uniform-distribution-non-unit-vectors" class="level2">
<h2 class="anchored" data-anchor-id="uniform-distribution-non-unit-vectors">Uniform distribution, Non-Unit Vectors</h2>
<p>These will be vectors that fill a hypercube, i.e.&nbsp;each component can take on a value on [-1…1].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uniform distribution, Non-Unit Vectors"</span></span>
<span id="cb4-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title)</span>
<span id="cb4-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the above graph, we see that as the dimensionality D increases, it’s still the case that the most common dot product is zero, but the probability distribution becomes wider &amp; flatter, i.e.&nbsp;the chances that a pair of random vectors are <em>not</em> orthogonal becomes increasingly <em>more</em> likely as D increases.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: Normalizing by sqrt(D)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ooo, ooo! Some of you may have seen how in the “<a href="https://paperswithcode.com/method/scaled">scaled dot product attention</a>” used in <a href="https://arxiv.org/abs/1706.03762">Transformer</a> models, they normalize by the square root of the number of dimensions? Let’s try that on the above graphs and see if the variance (i.e.&nbsp;the scale on the horizontal axis) stays roughly the same:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uniform distribution, Non-Unit Vectors, Scaled by 1/sqrt(D)"</span></span>
<span id="cb5-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, scale_x_by_sqrtd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>See how the variance stays constant as D increases? Cool, right? ;-)</p>
</div>
</div>
</section>
<section id="uniform-distribution-unit-vectors" class="level2">
<h2 class="anchored" data-anchor-id="uniform-distribution-unit-vectors">Uniform distribution, Unit vectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uniform distribution, Unit vectors"</span></span>
<span id="cb6-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>, xlim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Wait, back up! Those orange graphs remind me of a beta distribution. Can we fit that? Let’s try…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> fit_beta(axes):</span>
<span id="cb7-2">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb7-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i,ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(axes):</span>
<span id="cb7-4">        dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dims[i]</span>
<span id="cb7-5">        alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this seems to work quite well</span></span>
<span id="cb7-6">        y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>ss.beta.pdf(x, alpha, alpha)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just messing with beta distribution</span></span>
<span id="cb7-7">        ax.plot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>)</span>
<span id="cb7-8">        </span>
<span id="cb7-9">fit_beta(axes)</span>
<span id="cb7-10">fig</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>(Turns out that that beta distribution <a href="https://mathoverflow.net/questions/361612/scalar-product-of-random-unit-vectors">can be derived symbolically</a>. Lucky guess on my part. ;-) )</p>
<p>Interesting that for D=2, the vectors are more likely to be parallel or antiparallel than orthogonal, but that changes as D increases.</p>
<p>In the above graphs we see the opposite trend from the previous non-unit-vector case: the distribution gets narrower as D increases, meaning that a given pair of random <em>unit</em> vectors are more likely to be orthogonal as D increases.</p>
<p>What if we draw from a normal distribution of components instead of a uniform one?</p>
</section>
<section id="normal-distribution-non-unit-vectors" class="level2">
<h2 class="anchored" data-anchor-id="normal-distribution-non-unit-vectors">Normal Distribution, Non-Unit Vectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Normal distribution, Non-Unit Vectors"</span></span>
<span id="cb8-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, rand_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.random.normal)</span>
<span id="cb8-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>OK, same trend as before: the distribution gets wider as dimensionality increases. What about for unit vectors?</p>
</section>
<section id="normal-distribution-unit-vectors" class="level2">
<h2 class="anchored" data-anchor-id="normal-distribution-unit-vectors">Normal distribution, Unit Vectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Normal distribution, Unit vectors"</span></span>
<span id="cb9-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, rand_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.random.normal,</span>
<span id="cb9-3">                           normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>, xlim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb9-4">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds })  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span>
<span id="cb9-5">fit_beta(axes)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Looks like the normal distribution case is the same – wow, <em>exactly</em> the same – as the uniform distribution only more extreme: for unit vectors, the distribution gets narrower (around 0) as the dimension increases.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the vectors have only positive components (e.g.&nbsp;what you get from softmax) then you will <em>never</em> have orthogonal vectors (because they all exist in the “positive subspace”). But lets see what happens with such “softmax vectors”:</p>
</div>
</div>
</section>
<section id="softmax-vectors" class="level2">
<h2 class="anchored" data-anchor-id="softmax-vectors">“Softmax Vectors”</h2>
<p>If the vectors all have positive coefficients, e.g.&nbsp;because they are the output of a softmax function, then there’s no way they can be orthogonal. We might ask, what’s the most common value for the dot product?</p>
<p>(Note that these are not unit vectors according to the L2/“Euclidean” norm, rather they are unit vectors according to an L1/“Manhattan distance” norm).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Softmax vectors, not unit in L2"</span></span>
<span id="cb10-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, softmax_them<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb10-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span>
<span id="cb10-4"></span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i,ax <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(axes):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seems the mean is 1/D; let's show that:</span></span>
<span id="cb10-7">    dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dims[i]</span>
<span id="cb10-8">    ax.plot([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dim,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dim],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ax.get_ylim()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'vert bar at 1/D'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Given that the dot product / cosine similarity for these vectors seems to consistently have an expectation value of <img src="https://latex.codecogs.com/png.latex?1/D"> for dimensions <img src="https://latex.codecogs.com/png.latex?D">, then as <img src="https://latex.codecogs.com/png.latex?D"> increases this value will go to zero, and thus the vectors will be increasingly “orthogonal”.</p>
</section>
<section id="cosine-similarity-for-softmax-vectors" class="level2">
<h2 class="anchored" data-anchor-id="cosine-similarity-for-softmax-vectors">Cosine Similarity for Softmax Vectors</h2>
<p>What about the cosine between the vectors we just did? That’s equivalent to normalizing the softmax vectors according to an L2/Eucliean norm. Here we go:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cosine Similarity for Softmax"</span></span>
<span id="cb11-2">sds, axes, fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>title, normalize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, softmax_them<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>)</span>
<span id="cb11-3">results.append({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: title, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>: sds})  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save for later</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>…yeah I dunno ’bout that. Seems to be approaching a number a bit larger than 0.76. ?? I can’t immediately think any “special” number that matches that (e.g., it’s too low to be <img src="https://latex.codecogs.com/png.latex?%5Cpi">/4 and much too high to be <img src="https://latex.codecogs.com/png.latex?1/%5Csqrt%7B2%7D">). Let’s keep going to higher dimensions and see what the mean converges to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># let's keep going higher</span></span>
<span id="cb12-2">new_dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>]</span>
<span id="cb12-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dim <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> new_dims:</span>
<span id="cb12-4">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.uniform(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,dim)).astype(np.float32) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gotta watch for mem overruns</span></span>
<span id="cb12-5">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.uniform(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,dim)).astype(np.float32) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-6">    a, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax(a), softmax(b) </span>
<span id="cb12-7">    a, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm_rows(a), norm_rows(b)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># normalize to get cosine</span></span>
<span id="cb12-8">    dots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-9">    std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.std(dots,axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb12-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(dim, dots.mean(), std)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10000 0.7616262 0.002711203
20000 0.7616077 0.0019324023
50000 0.76159537 0.001209799</code></pre>
</div>
</div>
<p>Likely candidate special number is the hyperbolic tangent of 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">np.tanh(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.7615941559557649</code></pre>
</div>
</div>
<p>…though I’m not sure how that arises. Hmmm!</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In all cases, the mode of the distribution is still at zero dot product. So we can say with confidence that vectors are most likely to be (near-)orthogonal regardless of the dimensionality. However we see that although for unit vectors the distribution of dot product values gets sharper (around zero) as the number of dimensions increases, for non-unit vectors it gets <em>flatter</em>, i.e.&nbsp;betting on orthogonality becomes increasinly less of a safe bet as you go to higher dimensions.</p>
<p>The following graph summarizes our results, in terms of the standard deviation of the distribution of dot product values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb16-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(results)):</span>
<span id="cb16-3">    marker, markersize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s-'</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)</span>
<span id="cb16-4">    ax.loglog(dims, results[k][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sds'</span>], marker, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>markersize, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>results[k][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>])</span>
<span id="cb16-5">plt.legend()</span>
<span id="cb16-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Dimensions'</span>)</span>
<span id="cb16-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Std Dev'</span>)</span>
<span id="cb16-8">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"For dot products of random vectors..."</span>)</span>
<span id="cb16-9">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2022-01-24-MultiDim-DotProducts_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>(where the orange line and the red line are right on top of each other)</p>
<p>Thus we see that the dot products of unit vectors, “softmax vectors” (positive definite with unit L1 norm), as well as the cosine similarity for the latter, are all more likely to be zero as the dimensionality increases, whereas for other vectors the dimensionality trend goes the other way.</p>
<p><strong>Also: can I just say that</strong> I really like the scaling laws apparent in that last plot.</p>


</section>

 ]]></description>
  <category>ssl</category>
  <category>math</category>
  <guid>https://drscotthawley.github.io/blog/posts/2022-01-24-multidim-dotproducts.html</guid>
  <pubDate>Mon, 24 Jan 2022 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/multidim_dp_summary.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Learning Some Geometric/Clifford Algebra</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2021-10-15-geometric-algebra.html</link>
  <description><![CDATA[ 




<blockquote class="blockquote">
<p>“…for geometry, you know, is the gate of science, and the gate is so low and small that one can only enter it as a little child.”<br> – William K. Clifford</p>
</blockquote>
<section id="motivations" class="level2">
<h2 class="anchored" data-anchor-id="motivations">Motivations</h2>
<ol type="1">
<li>The recent paper, <a href="https://arxiv.org/abs/2110.04176">“Lightweight Convolutional Neural Networks By Hypercomplex Parameterization”</a>. i.e, the potential for interesting (multichannel audio) signal processing applications of deep learning + hypercomplex numbers.</li>
<li>The fact that, even as theoretical physicist (of <em>classical field theory</em>), I never learned enough about particle physics / QFT because I hated Dirac spinors, Pauli matrices, quaternions, and such. Thus this is an attempt to finally overcome my ignorance and aversion to an important and useful area of mathematics/physics!</li>
</ol>
</section>
<section id="references-im-finding-to-be-helpful" class="level2">
<h2 class="anchored" data-anchor-id="references-im-finding-to-be-helpful">References I’m finding to be helpful</h2>
<ul>
<li>The following video by “sudgylacmoe” using the “<a href="https://www.manim.community/">manim</a>” presentation style developed by <a href="https://www.3blue1brown.com/">3blue1brown</a>. Watch this!</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-display">

        <iframe width="400" height="300" src="https://www.youtube.com/embed/60z_hpEAtD8" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
<ul>
<li>Another video: historical perspective: “The Vector Algebra War” (Oh, and there’s <a href="https://ieeexplore.ieee.org/document/7431944">a paper from IEEE Access</a> to go with it):</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-display">

        <iframe width="400" height="300" src="https://www.youtube.com/embed/_AaOFCl2ihc" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
<ul>
<li><a href="https://slehar.wordpress.com/2014/03/18/clifford-algebra-a-visual-introduction/comment-page-2/?unapproved=1590&amp;moderation-hash=571d6eb02d897393899feffd4dddca41#comment-1590">“Clifford Algebra: A visual introduction”</a>, blog post by “slehar”</li>
<li><a href="https://www.amazon.com/Geometric-Algebra-Physicists-Chris-Doran/dp/0521715954">This book!</a>: <a href="https://www.amazon.com/Geometric-Algebra-Physicists-Chris-Doran/dp/0521715954"><img src="https://drscotthawley.github.io/blog/posts/https:/pbs.twimg.com/media/FDYnk7AXoAEgYn8?format=jpg&amp;name=900x900" width="200px" alt="image of book cover"></a></li>
<li>From “the man” himself: <a href="http://geocalc.clas.asu.edu/pdf/OerstedMedalLecture.pdf">David Hestenes’s Oersted Lecture</a></li>
<li><a href="https://www.semanticscholar.org/paper/Vectors-and-Beyond%3A-Geometric-Algebra-and-its-Simons/8cb9a2b8344604f52b556c3b10f8b0bc8fb00f73">“Vectors and Beyond: Geometric Algebra and its Philosophical Significance”</a> by Peter Simons, <em>Dialectica</em>, Vol. 63, N° 4 (2010), pp.&nbsp;381–395.</li>
<li><a href="https://www.ime.unicamp.br/~agacse2018/GA_Lecture1.pdf">These slides</a> by Joan Lasenby (Signal Processing Group, Trinity College, Cambridge) )</li>
<li><a href="http://www.faculty.luther.edu/~macdonal/#geometric-algebra">Alan Macdonald’s textbook(s)</a> and <a href="https://www.youtube.com/watch?v=srwoPQfWWS8&amp;list=PLLvlxwbzkr7igd6bL7959WWE7XInCCevt&amp;index=1">YouTube videos</a></li>
<li><a href="https://www.av8n.com/physics/clifford-intro.pdf">John Denker’s write-up</a></li>
<li><a href="http://wackerart.de/mathematik/clifford_algebra.html">This very handy list of properties</a></li>
</ul>
</section>
<section id="other-resources-i-have-yet-to-read" class="level2">
<h2 class="anchored" data-anchor-id="other-resources-i-have-yet-to-read">Other resources I have yet to read</h2>
<ul>
<li>Hestenes’ mechanics texbook: <a href="https://www.amazon.com/Foundations-Classical-Mechanics-Fundamental-Theories/dp/0792353021">New Foundations for Classical Mechanics</a>, 1999.</li>
<li><a href="https://github.com/TParcollet/Quaternion-Neural-Networks">PyTorch Quaternion Neural Networks</a></li>
<li><a href="https://arxiv.org/pdf/2006.06507.pdf">“Embed Me If You Can: A Geometric Perceptron”</a></li>
<li>This book chapter: <a href="https://link.springer.com/chapter/10.1007/978-3-319-57027-3_6">“Outlook for Clifford Algebra Based Feature and Deep Learning AI Architectures”</a></li>
<li>Michael Reed’s <a href="https://grassmann.crucialflow.com/">Grassmann.jl</a> Julia package looks amazing</li>
<li>So does all the code &amp; resources at <a href="https://bivector.net/">bivector.net</a>! Including the “shop”, haha!</li>
<li><a href="http://geometry.mrao.cam.ac.uk/1993/01/imaginary-numbers-are-not-real-the-geometric-algebra-of-spacetime/">“Imaginary Numbers are not Real — the Geometric Algebra of Spacetime”</a> by S. F. Gull, A. N. Lasenby and C. J. L. Doran, <em>Found. Phys</em>. <strong>23</strong>(9), 1175-1201 (1993).</li>
<li><a href="https://drive.google.com/file/d/15fTvrmP-Fht-u5iMMsq-4ie-7yEcgOcA/view">Something Twitter-y…?</a></li>
<li>….your suggestions?</li>
</ul>
</section>
<section id="summary-of-my-thoughts-so-far" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-my-thoughts-so-far">Summary of My Thoughts So Far</h2>
<ol type="1">
<li><strong>Why didn’t anybody teach me this stuff before???</strong> It makes <em>so many</em> things in physics make more sense.</li>
<li>Cross products are like the Easter Bunny. Quaternions are like the Bohr Atom. Should we still teach young people these concepts? If the people in other communities are still using stone tools, should students be deprived of learning to work with bronze or iron?</li>
<li>Cross products are neither <em>necessary</em> for introductory physics instruction <em>nor easier</em> than outer/exterior/wedge products. In 3D, the two are isomorphic, so why not teach the one that’s actually more useful? When we encounter cross products in physics it is always the rotating-area aspect that’s relevant, not the pseudovector aspect (see #2 above).<br>
</li>
<li>There’s nothing inherently “quantum mechanical” about Pauli matrices &amp; Dirac spinors, or quaternions. Rather they are just manifestations of the geometry of 3D space! Futhermore, the fact that Pauli matrices are typically taught in such a unmotivated,/“here memorize these” kind of way is anathema — or perhaps you benefited from the “Interlude: now let’s inject a bunch of Group Theory” approach — whereas with the GA approach they arise naturally.</li>
<li>It’s not yet clear to me how bivectors are to be represented in (computational) linear algebra: square, antisymmetric matrices, perhaps?</li>
<li>The relation between complex numbers and GA in 2D is cool but there are parts that can be a bit tricky conceptually. I think the reason is that (apart from GA) one typically deals with <em>either</em> complex numbers <em>or</em> 2d vectors (/phasors), and the question of multiplying a 2d vector by a complex number doesn’t really come up – the tricky bit being is that in GA, the pseudoscalar <em>anti-</em>commutes with vectors, whereas one normally thinks of <img src="https://latex.codecogs.com/png.latex?i"> as being an ordinary scalar that should commute.</li>
<li>Notation choices: I’m a bit confused when in 2D is that “<img src="https://latex.codecogs.com/png.latex?I">” is not the identity operator, rather it is a pseudoscalar/bivector that’s akin to “<img src="https://latex.codecogs.com/png.latex?i">” (see point #6 above). But I’m getting used to it. Other choices such as <img src="https://latex.codecogs.com/png.latex?i"> and <img src="https://latex.codecogs.com/png.latex?j"> (in EE) are similarly…interesting. Also noticing that the Brits seem to prefer <img src="https://latex.codecogs.com/png.latex?%5Csigma_i"> for basis vectors whereas I was raised on <img src="https://latex.codecogs.com/png.latex?%5Chat%7Be%7D_i">. I’m working on a dynamic “choose your own notation” interactive version of the materials I’m writing up, so that notation won’t be a sticking point for anyone, they can just choose what they prefer.</li>
<li>Terminology: I find it to be a huge stumbling block ( / language barrier) when people say “outer product” in GA, b/c that term <a href="https://en.wikipedia.org/wiki/Outer_product">already means something different to the rest of the world</a> – namely the “tensor product” aka “Kronecker product” – something that does’t (necessarily) anticommute! Now, if the point is that we’re looking for a “unified language,” let’s use a unified language and not conflate in one term two very different concepts, because this is bound to confuse students (and I confess, physics professors too). Just say “wedge product.” Even “exterior product” is potentially confusing to students, since “exterior” is just a synonym of “outer”.</li>
<li>Re. (anti-)commutivity: many expressions one sees are written in terms of orthonormal vectors, and thus it’s not always clear when these statements apply to general vectors/bivectors/etc. When in doubt, the thing to do is (presumably) to write out each product in terms of an othonormal basis (<img src="https://latex.codecogs.com/png.latex?%5Chat%7Be%7D_1,%20%5Chat%7Be%7D_2">, etc.) and multiply and/or reverse things until you can show what you want to show.<br>
</li>
<li>In E&amp;M, GA gives you the relativistic Faraday tensor without even any relavity! Again it’s just a manifestation of geometry.</li>
<li>This quote from McRobie and Joan Lasenby – <em>engineers, BTW!</em>: &gt; “The principal argument for the adoption of geometric algebra is that it provides a single, simple mathematical framework which eliminates the plethora of diverse mathematical descriptions and techniques it would otherwise be necessary to learn.” (F. A. McRobie and J. Lasenby, Simo-Vu Quoc Rods using Clifford Algebra. Int. J. Numer. Meth. Eng. 45 (1999), 377-398.) As <a href="http://www.faculty.luther.edu/~macdonal/GA&amp;GC.pdf">quoted by Alan Macdonald</a></li>
</ol>
</section>
<section id="prospectus-introducing-geometric-algebra-to-undergrads-in-analytical-mechanics" class="level1">
<h1><strong>Prospectus: Introducing Geometric Algebra to Undergrads in Analytical Mechanics</strong></h1>
<p>Writing out some ideas in anticipation of my Spring 2023 course. – by <a href="https://twitter.com/drscotthawley">Scott H.Hawley</a>. Comments welcome.</p>
<p><em>Geometric Algebra (GA) = Clifford Algebra applied in modern contexts.</em></p>
<p>The <a href="https://ieeexplore.ieee.org/document/7431944">historical dominance of the Gibbs/Heaviside vector algebra in physics over Clifford’s superior framework</a> is unfortunate, cumbersome, confusing, etc., but the former has an enormous amount of popularity as the de-facto standard approach (mostly, I conjecture, due to “inertia” or what <a href="https://www.semanticscholar.org/paper/Vectors-and-Beyond%3A-Geometric-Algebra-and-its-Simons/8cb9a2b8344604f52b556c3b10f8b0bc8fb00f73">Peter Simons described</a> as being based “not on effectiveness but on tradition, entrenchment, and institutions.”) Sure, <a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html">GA may be cool</a> in helping to provide “a unified mathematical framework for all of physics” (C. Doran), and to provide a set of consistent computational tools for students at all stages of their educational development, as well as a set of powerful and intuitive conceptual frameworks for reasoning about physics, but one might raise questions such as: Is subjecting undergrads to GA pointless, vain, and selfish, or does it set them up well for future success? Can they even handle it? Do they gain anything from it? Why not just wait until they’re grad students (or late-career physicists) to teach them GA approaches, if ever? And if they don’t learn cross products won’t they be at a disadvantage? (Quick answer to that last one: yes we’ll still show them what a cross product is.)</p>
<p>Well, let’s find out. GA could be introduced in our classical mechanics, E&amp;M, and/or quantum mechanics courses, but classical mechanics is under my purview and the place where vector algebra is typically taught (e.g., as “Chapter 2”). The curriculum changes should not be onerous or burdensome to students or instructor, and could proceed as follows:</p>
<section id="topicchapter-breakdown" class="level2">
<h2 class="anchored" data-anchor-id="topicchapter-breakdown">Topic/Chapter Breakdown</h2>
<p>Is there really <em>that much</em> that would need to change in a (‘second year”/diff-eq-based) mechanics course’? Not really. As follows…</p>
<ul>
<li><p>Intro/“Chapter 2”: A little extra content in the usual “vector math” chapter (typically Chapter 2):</p>
<ul>
<li>After teaching the dot product, teach the/Grassman’s wedge product. (Which is isomorphic in 3D to the cross product.) This means discussing bivectors, and how they add.</li>
<li>After the wedge product, teach the/Clifford’s general vector product. Assuming orthonormal basis vectors have already been introduced by then, show that vector products of basis vectors are the same as wedge products. Then show how <em>everything</em> <em>you need</em> to compute/derive/ can be figured out by yourself, in terms of products when writing things out in terms of bases.</li>
<li>Mention the cross product, and what it is, and that other areas of physics &amp; engineering may still use cross-products, and that in terms of components it’s the same as the wedge product.</li>
<li>Maybe mention in passing / as a footnote: in GA the vector product has an inverse (i.e.&nbsp;you can divide vectors) whereas it’s not defined with Gibbs’ system. Applications for this appear in computer graphics (cf.&nbsp;Joan Lazenby) but not really in physics so, skipping it.</li>
</ul></li>
<li><p>Early coverage of rotational motion:</p>
<ul>
<li>Angular momentum as a wedge product, i.e.&nbsp;as an oriented surface showing the plane and direction of rotation, i.e.&nbsp;a bivector.</li>
<li>Remind students that this is the same as a cross-product, component wise.</li>
<li>Same with torque: it’s a bivector.</li>
<li>Look at precessional motion of gyroscope in gravitational field, viewed via bivector vs.&nbsp;cross-product paradigms.</li>
<li>No other changes to standard curriculum.</li>
</ul></li>
<li><p>Small Oscillations / Simple Harmonic Motion:</p>
<ul>
<li>Using complex numbers for oscillations and/or Fourier transforms is SUPER standard. Depriving students of this approach (just to shoehorn in GA) would be inadvisable. …Ok, no problem!</li>
<li>Really it just comes to your interpretation of “<em>i</em>”:: i.e., whether it’s interpreted as an “imaginary number” or as the pseudoscalar. The mathematical calculations are the same either way.</li>
<li>Viewing in terms of pseudoscalar would tie things in to the fact that we’re talking about rotations of phase. So this’ll be mentioned but not stressed. It’s not a big deal either way.</li>
<li>So, this chapter could be “agnostic” about the nature of i.</li>
<li>See link below to the paper about GA for teaching about AC circuits.</li>
<li>Now <em>if</em> we were to also mention (as many instructors already do) that is a <em>generator of rotations</em>, then this sets us up for all kinds of subsequent interesting discussions, including when we get to Rigid Body Rotation….</li>
</ul></li>
<li><p>Rigid Body Rotation:</p>
<ul>
<li>Sadly we usually have to skip this topic/chapter anyway at Belmont University due to time &amp; pace of course – we have to “go slower” at Belmont compared to some other schools, given our lax math prereqs. It’s a major omission that I’d like to remedy someday.</li>
<li>Actually, GA could <em>help</em> by requiring <em>less</em> <em>new</em> formalism in this chapter: Students wouldn’t need to learn Euler angles (which lead to gimbal lock) or quaternions (which have negative magnitude and are janky IMHO). Everything could just be done in terms of rotation matrices (which students would be learning either way) and/or rotors.</li>
<li>These sorts of rotations would set them up for Quantum Mechanics and provide them <em>exactly what they need</em>, even providing a route “around” Pauli spinors, etc. since they’d now know GA anyway.</li>
</ul></li>
<li><p>…And that’s all we’d change in Mechanics! (When we cover Lagrangian mechanics, we never get to Noether’s Theorem. This is still only an undergrad class. That could be a grad school thing.)</p></li>
<li><p>Looking ahead to later classes:</p>
<ul>
<li><strong>E&amp;M</strong>: Maxwell’s equations in GA are the best “parlor trick” I’ve seen. On a practical level, what of gradient, divergence, curl? Hestenes 2003:</li>
</ul>
<blockquote class="blockquote">
<p>“GA reduces ‘grad, div, curl and all that’ to a single vector derivative that, among other things, combines the standard set of four Maxwell equations into a single equation and provides new methods to solve it.’’</p>
</blockquote>
<p>(For more, one could see <a href="https://www.amazon.com/Multivectors-Clifford-Algebra-Electrodynamics-Jancewicz/dp/9971502909">Jancewicz 1989, “Multivectors and Clifford Algebras in Electrodynamics</a>.)</p>
<ul>
<li><strong>Quantum Mechanics</strong>: I mean…what’s not to like?? We’re no longer forced to puzzle over why <img src="https://latex.codecogs.com/png.latex?i"> is an imaginary number that suddenly appears for no good reason (other than to make the algebra work out right, which GA does for you as well yet with spatially-meaningful objects instead)? (Simons 2010: “…the puzzle about the otherwise unmotivated introduction of complex numbers disappears.”) We get rotors that naturally lead to spinors? We get a geometric interpretation of spin? We still get all the algebra and symmetries that we need?? Uh… win-win, right?</li>
</ul></li>
</ul>
</section>
<section id="who-else-is-teaching-this" class="level2">
<h2 class="anchored" data-anchor-id="who-else-is-teaching-this">Who Else Is Teaching This?</h2>
<p>Have others tried teaching GA approaches? And if so, have they done it with undergrads or only grad students? And have these been successful or not – i.e.&nbsp;have they been tried and found lacking, or just not tried much? And how would success even be measured?</p>
<p>Names/Works:</p>
<ul>
<li><a href="https://www.amazon.com/Foundations-Classical-Mechanics-Fundamental-Theories/dp/0792355148/ref=sr_1_1?crid=26UN80Z1DL79A&amp;keywords=hestenes+mechanics&amp;qid=1642367054&amp;s=books&amp;sprefix=hestenes+mechanics%2Cstripbooks%2C63&amp;sr=1-1">David Hestenes’s Mechanics textbook</a>, 1999.Hestenes has done <em>a lot</em>, and is essentially the “father of the (modern) field” / primarily responsible for disseminating GA. My question is: Who <em>besides</em> Hestenes?</li>
<li>There’s a <a href="https://www.linkedin.com/groups/8278281/">LinkedIn group on Pre-University Geometric Algebra</a>, i.e.&nbsp;for <em>high schools!</em> Run by educator <a href="https://www.linkedin.com/in/james-smith-1b195047/">James A. Smith</a>, whose works are <a href="https://vixra.org/author/james_a_smith">published on Vixra.org</a></li>
<li><a href="https://twitter.com/QuirinoSugonJr">Quirino Sugon, Jr</a><a href="https://twitter.com/QuirinoSugonJr">.</a> writes in <a href="https://physics.stackexchange.com/a/19914">this</a><a href="https://physics.stackexchange.com/a/19914"></a><a href="https://physics.stackexchange.com/a/19914">Physics</a><a href="https://physics.stackexchange.com/a/19914"></a><a href="https://physics.stackexchange.com/a/19914">StackExchange</a><a href="https://physics.stackexchange.com/a/19914"></a><a href="https://physics.stackexchange.com/a/19914">thread</a>, “For several years I have been teaching Clifford (geometric) algebra as part of the Vector Analysis Course for undergraduate physics majors in Ateneo de Manila University…”</li>
<li>Not mechanics, but: “<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">Geometric</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">Algebra</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">for</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">Teaching</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">AC</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">Circuit</a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132"></a><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/cta.3132">Theory</a>”, by Francisco G. Montoya et al, <em>Int. J. Circ. Theor. Appl.,</em> Sep.&nbsp;2021. Excerpt:</li>
</ul>
<p><em>“It requires the students to learn the basics of geometric algebra, but this effort is clearly compensated with the advantages derived from the possibility of using easy identifiable geometrical concepts. In fact, it is shown that the application of GA overcomes some limitations derived from the use of complex algebra and its phasor-based notation.”</em></p>
<p>Why aren’t more instructors doing this? I believe it’s because they just haven’t been exposed to it: “Clifford Algebra” mostly shows up in high-level theoretical physics discussions and/or pure-math stuff (ring theory + whatever my math colleague Brad Schleben does ;-) ). It’s been growing in popularity since the 1990s, and Doran &amp; the Lazenbys have popularized it a bit in physics, engineering &amp; computer graphics/vision, but kinda.. beyond that it’s still largely viewed as an obscure pure-theory thing rather than “the way things should be.” We believe this will and should change, and we’re willing to be a part of it. Others will say, “I guess this is interesting but why should we change? Cross products, quaternions, spinors, four-vectors, etc. are janky as hell but we learned them and we turned out fine!”</p>
</section>
<section id="education-research-studies" class="level2">
<h2 class="anchored" data-anchor-id="education-research-studies">Education Research Studies?</h2>
<p>David Hestenes mentioned in his <a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html">Oersted</a><a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html"></a><a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html">Medal</a><a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html"></a><a href="https://drscotthawley.github.io/blog/2021/10/15/Geometric-Algebra.html">lecture</a> (ca. 2002) that the physics-ed community needs to do the education research to show how/whether teaching GA in physics courses is a good idea….and AFAIK his call has not been taken up, at all. Hestenes received <a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">AAPT</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">’</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">s</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">2014 ”</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">Excellence</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014"></a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">in</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014"></a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">Physics</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014"></a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">Education</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">”</a><a href="https://www.aps.org/programs/honors/prizes/prizerecipient.cfm?last_nm=Jackson&amp;first_nm=Jane&amp;year=2014">award</a> for his work with teaching GA, but still I can’t find any learning outcome results. <a href="https://www.google.com/search?q=%22physics+education%22+%22education+research%22++%22geometric+algebra%22+learning+outcomes++%22students%22&amp;biw=1382&amp;bih=682&amp;ei=pYfkYdbkApunqtsPtNGc8A8&amp;ved=0ahUKEwiWy5i2lbf1AhWbk2oFHbQoB_4Q4dUDCA4&amp;uact=5&amp;oq=%22physics+education%22+%22education+research%22++%22geometric+algebra%22+learning+outcomes++%22students%22&amp;gs_lcp=Cgdnd3Mtd2l6EAM6BwgAEEcQsANKBAhBGABKBAhGGABQmh1Ymh1ghB9oAnACeACAAVSIAVSSAQExmAEAoAEByAEIwAEB&amp;sclient=gws-wiz">My literature searches</a> turned up zero studies about this. (<a href="https://www.researchgate.net/publication/303373032_The_role_of_mathematics_for_physics_teaching_and_understanding">Closest thing I found</a> merely mentions Hestens but no explicit GA. Found one <a href="http://kmr.csc.kth.se/wp/research/math-rehab/learning-object-repository/physical-units/">listserv</a><a href="http://kmr.csc.kth.se/wp/research/math-rehab/learning-object-repository/physical-units/"></a><a href="http://kmr.csc.kth.se/wp/research/math-rehab/learning-object-repository/physical-units/">discussion</a> but no results/outcomes.)</p>
<p><strong>Update:</strong> One small study: James A. Smith shared with me one study by Ramón López Escudero and Philippe Eenens, which can be translated to English via Google Translate: “<a href="https://www.jovenesenlaciencia.ugto.mx/index.php/jovenesenlaciencia/article/download/212/pdf1">Enseñar el Álgebra Geométrica en el Primer Semestre de Ingenierías</a>” (“Teach Geometric Algebra in the First Semester of Engineering”). Assessment consisted of two application problems and a test at the end of the course, as well as interviewing students. “The test result also turned out to be good.”</p>
<p>This merits revisiting an earlier question:</p>
</section>
<section id="how-would-success-be-measured" class="level2">
<h2 class="anchored" data-anchor-id="how-would-success-be-measured"><strong>How Would “Success” Be Measured?</strong></h2>
<p>Ideas:</p>
<ol type="1">
<li>Lack of complaints/negative results. Seriously. If we can introduce this material and nobody says boo, that can count as success. If people don’t show negative results (e.g.&nbsp;students later report “I got to grad school and wished we’d spent a whole 50 on cross-products instead of 10 minutes”), if whatever “scores” we have don’t go down.. That’s a plus.</li>
<li>Actual positive anecdotal reports (which “count” in education circles), e.g.&nbsp;someone says “I loved the GA stuff” – a question about this could be added to the end of course eval reports that students answer: “How did you feel about the GA content?” We could perhaps somehow ask students later in Quantum if they felt the GA background helped them (it <em>should</em>!)</li>
<li>Improved scores on our standard metrics / exams? Hard to insist on a causal relationship, but see #1, re not-going-down as justification.</li>
</ol>
<p>…and if we’ve only got an enrollment of at most 10 undergrads in the class, then how would we ever turn this into a legit study, e.g.&nbsp;something one might present at a Lily Conference or somesuch? I know <em>nothing</em> about proper education research (but Danielle and/or the Teaching Center probably do! ;-) ) .</p>
<p>Sugon: “I am the only one teaching geometric algebra in my university, so I could not follow-up my students.”</p>
</section>
<section id="main-issues-with-doing-ed-research-for-me" class="level2">
<h2 class="anchored" data-anchor-id="main-issues-with-doing-ed-research-for-me">Main Issues with Doing Ed Research for Me:</h2>
<ol type="1">
<li><strong>Tracking Downstream Effects/Cohorts:</strong> The benefits of the GA approach will be mostly “downstream,” i.e., when students take more advanced courses – it’s hard to imagine students seeing “the unity of physics” from within only their very first semi-advanced course, on one topic! There will be a few benefits within mechanics itself, but I speculate that they may not be enough to appear significant on their own. Dr.&nbsp;Danielle Garrett (sci-ed expert) suggested tracking cohorts of students (and also mentioned that tracking student data would need IRB approval). That begs the question of whether other physics faculty at my university will be “on board” with using GA in, say, quantum &amp; E&amp;M, and/or whether we’d track the 1 or 2 of our students each year who go on to graduate school. (Note also that GA is seeing huge inroads into computer graphics, so, for the few students who go on to <em>advanced</em> CG work,…?)</li>
<li><strong>My Time &amp; Other Commitments:</strong> I don’t need or really want a publication in some physics-ed journal; I’ve got enough other projects to keep me busy already. (I’ve got a book to work on that has nothing to do with GA!). But…it seems the community could really benefit from a study of this – and again, Hestenes’ call has gone largely unanswered.<br>
</li>
<li>Related: <strong>Becoming an Admin for a Large Project:</strong> Maybe a <em>networking</em> approach would be needed, in which multiple faculty from multiple institutions commit to sharing data in some kind of standardized format in order to put together a study. That sounds like something a “bigger team” at a major university would/should/could do. But perhaps a consortium of “small college people” could still achieve something. Do I want to drop everything else in order to become the PI coordinating such an effort (even seek NSF funding, offer summer assistantships, etc)? …TBH, not really. But perhaps I could assist in motivating someone else to do so, and then I could “assist”. ;-)</li>
</ol>
</section>
<section id="to-do-extras" class="level2">
<h2 class="anchored" data-anchor-id="to-do-extras"><strong>TO-DO / Extras:</strong></h2>
<ul>
<li><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">List</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">of</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">lots</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">of</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">people</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">’</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">s</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">personal</a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra"></a><a href="http://bleyer.org/dw/doku.php?id=geometric_algebra">websites</a> by instructors, to check to see if they talk about pedagogy</li>
</ul>
</section>
</section>
<section id="deleted-me-messing-with-python-clifford-package" class="level1">
<h1>Deleted: Me Messing With Python <code>clifford</code> package</h1>
<p>This blog post used to feature ca. 10 pages of me screwing around with the Python <a href="https://clifford.readthedocs.io/en/latest/">clifford</a> package, but deleted these as I didn’t imagine they’d be much use to anyone else.</p>


</section>

 ]]></description>
  <category>math</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-10-15-geometric-algebra.html</guid>
  <pubDate>Fri, 15 Oct 2021 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/cliffords.png" medium="image" type="image/png" height="79" width="144"/>
</item>
<item>
  <title>Handy Bash Functions for ML &amp; Data Science</title>
  <link>https://drscotthawley.github.io/blog/posts/2021-09-15-Handy-Bash-Functions.html</link>
  <description><![CDATA[ 




<p>Once I figure out a complicated command, I make a <code>bash</code> function or alias for it. Here are some that I find useful:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up python environment.</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage: $ makeenv &lt;env_name&gt;</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: the pip update is b/c sometimes I've gotten stuck with an ancient pip where nothing works!</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeenv()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv ~/envs/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/envs/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/bin/activate<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install pip <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Uqq</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loads python environment.  </span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage: $ loadenv &lt;env_name&gt;</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loadenv()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/envs/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/bin/activate<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># same thing different name</span></span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gimme()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/envs/<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/bin/activate<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># downloads colab notebook.  [Writes to colab.ipynb]</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage: $ grabcolab &lt;sharing_URL&gt;    </span></span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grabcolab()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fileid</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/.*drive\/(.*)\?.*/\1/'</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> colab.ipynb <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://docs.google.com/uc?export=download&amp;id='</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fileid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># runs a notebook on command line, as if it were a python script.  </span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage: $ nbrun colab.ipynb  </span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [Note for student nbs, run this from an access-reduced account!]</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># On my personal page I remove the pip install but put it in to make it handy for students</span></span>
<span id="cb1-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nbrun()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Uqq</span> jupytext<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">jupytext</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--to</span> py <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.py run_this.ipy<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ipython</span> run_this.ipy<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creates .tgz file from directory, runs in parallel</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># $ usage: $ partar &lt;dir_name&gt;  [no / on end.   requires pigz: $ sudo apt install pigz</span></span>
<span id="cb1-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">partar()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span> pigz <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-cf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.tgz"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uncompresses .tgz file into directory, runs in parallel.</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage $ paruntar &lt;.tgz file&gt;</span></span>
<span id="cb1-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paruntar()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span> pigz <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span>  </span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># long-list sorted by timestamp, with more-style pagination.  $@ is all arguments.</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># usage: ltt *.ipynb</span></span>
<span id="cb1-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">llt()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--color</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>auto <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lth</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--color</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>always <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$@</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">less</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quit-if-one-screen</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># which alias is this?  includes functions too.  </span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example: $ wa partar</span></span>
<span id="cb1-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wa()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;}</span></span></code></pre></div>
<p>…these are all in my <code>~/.bash_aliases</code> file, which is invoked at the bottom of my <code>~/.bashrc</code> file in the line: <code>source ~/.bash_aliases</code>.<br>
Note that <code>"$1"</code> just refers to the first argument of the command.</p>
<blockquote class="blockquote">
<p>I used to use Anaconda &amp; <code>conda</code> but found it “bulky” and “invasive”, so now I just use python <code>venv</code>.</p>
</blockquote>
<p><small>Image via <a href="https://colab.research.google.com/drive/10a9adSTzNtZvp7_2OkYFVFICND2m2iEk?usp=sharing">VQGAN+CLIP</a>, prompt=‘computer code | bash shell scripting | data science | by james gurney | trending on artstation’</small></p>



 ]]></description>
  <category>computer_usage</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-09-15-Handy-Bash-Functions.html</guid>
  <pubDate>Wed, 15 Sep 2021 15:46:18 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/bash_functions_thumb.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Typical (Neural-Network-Based) Classification vs. Zero-Shot, Part 3 - Live Demo of CL Toy</title>
  <link>https://drscotthawley.github.io/blog/posts/2021-08-06-Live-CL-Demo.html</link>
  <description><![CDATA[ 




<p><em>Earlier entries: <a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html">Part 1</a>, <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a></em></p>
<p>I added some more optional controls to the “<a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html#Contrastive-Loss-Cartoon-Demo">contrastive loss toy model</a>” from <a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html">Part 1</a> that I want to demonstrate interactively, so this Part 3 post is in the form of a video:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1cwc42sFA0A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<section id="addenda" class="level2">
<h2 class="anchored" data-anchor-id="addenda">Addenda:</h2>
<p><em>(I’m new to this video-making thing and TBH not sure I want to get good at it. I realize I’m over-animated…in a way that doesn’t happen when I’m in front of a class, on stage or on TV!)</em></p>
<section id="what-i-left-out" class="level3">
<h3 class="anchored" data-anchor-id="what-i-left-out">What I left out:</h3>
<ul>
<li>Various ways of getting a handle on choosing negative examples and doing so in a computationally efficient way (e.g.&nbsp;via <a href="https://en.wikipedia.org/wiki/Locality-sensitive_hashing">Locality Sensitive Hashing</a>). But the paper by Wu et al has a good survey of these issues – at least ca. 2017. And since then you can find newer treatments of such things as well, and I encourage you to do so – I’ll be joining you. Furthermore, if you follow the “Attract Only” methodology of SimCLR, then you wouldn’t have any negative examples anyway. ;-)</li>
<li>Messing around with the toy model – giving it “crazy” inputs like huge margins, whatever – is not only fun (to me) but can also be quite informative as a process of “discovery”: I’m sure I learned things in the context of <em>experience</em> that I might otherwise have read (and maybe missed) in a paper.</li>
</ul>
</section>
<section id="what-said-that-came-off-as-maybe-misleading" class="level3">
<h3 class="anchored" data-anchor-id="what-said-that-came-off-as-maybe-misleading">What said that came off as maybe misleading:</h3>
<ul>
<li>I didn’t mean to imply that CLIP used the “attract-only” scheme I attribute to SimCLR. CLIP has a “contrastive loss” which means negative examples. I was just talking about how the CLIP result on ImageNet demonstrated the utility of metric-based, semi-supervised learning.</li>
</ul>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Jordan, J. Personal communications. cf.&nbsp;Twitter Page: <a href="https://twitter.com/jeremyjordan">https://twitter.com/jeremyjordan</a>.</li>
<li><strong>Wu, C.-Y.; Manmatha, R.; Smola, A.J.; Krähenbühl, P. <a href="https://openaccess.thecvf.com/content_ICCV_2017/papers/Wu_Sampling_Matters_in_ICCV_2017_paper.pdf">Sampling Matters in Deep Embedding Learning</a>. In Proceedings of the arXiv:1706.07567 [cs]; January 16 2018.</strong></li>
<li>“<a href="https://openai.com/blog/clip/">CLIP</a>”: Radford, A.; Kim, J.W.; Hallacy, C.; Ramesh, A.; Goh, G.; Agarwal, S.; Sastry, G.; Askell, A.; Mishkin, P.; Clark, J.; et al.&nbsp;<a href="https://arxiv.org/abs/2103.00020">Learning Transferable Visual Models From Natural Language Supervision</a>. ArXiv210300020 Cs 2021.<br>
</li>
<li>Fonseca, E.; Ortego, D.; McGuinness, K.; O’Connor, N.E.; Serra, X. <a href="https://arxiv.org/pdf/2011.07616.pdf">Unsupervised Contrastive Learning of Sound Event Representations</a>. In Proceedings of the 2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP); IEEE, 2021.</li>
<li>Hadsell, R.; Chopra, S.; LeCun, Y. <a href="http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf">Dimensionality Reduction by Learning an Invariant Mapping</a>. In Proceedings of the 2006 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR’06); 2006; Vol. 2, pp.&nbsp;1735–1742.</li>
<li>“SimCLR”: Chen, T.; Kornblith, S.; Norouzi, M.; Hinton, G. <a href="https://arxiv.org/pdf/2002.05709.pdf">A Simple Framework for Contrastive Learning of Visual Representations</a>. ArXiv200205709 Cs Stat 2020.</li>
<li>Alamar, J. “<a href="https://jalammar.github.io/illustrated-word2vec/">Illustrated Word2Vec</a>”, https://jalammar.github.io/illustrated-word2vec/</li>
<li>AK / akhaliq / ak92501, “<a href="https://huggingface.co/spaces/akhaliq/VQGAN_CLIP">Gradio Demo for VQGAN+CLIP</a>”, <em>HuggingFace Spaces</em>, https://huggingface.co/spaces/akhaliq/VQGAN_CLIP</li>
</ol>


</section>

 ]]></description>
  <category>ssl</category>
  <category>classification</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-08-06-Live-CL-Demo.html</guid>
  <pubDate>Sun, 01 Aug 2021 18:00:18 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/live-cl-demo.png" medium="image" type="image/png" height="97" width="144"/>
</item>
<item>
  <title>Typical (NN-Based) Classification vs. Zero-Shot, Part 2 - An Example Using FastAI</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2021-06-17-contrasting-contrastive-loss.html</link>
  <description><![CDATA[ 




<p><em>(This blog post implements the concepts illustrated in my previous post, <a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html">“Typical (Neural-Network-Based) Classification vs.&nbsp;Zero-Shot, Part 1 - The Joy of 3D”</a>. Note that the “3D” part was because of its utility as a teaching tool for gaining intuition; realistic applications usually involve hundreds of “dimensions.”)</em></p>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>In <a href="https://drscotthawley.github.io/blog/scottergories/2021/05/04/The-Joy-Of-3D.html">Part 1</a>, I described how contrastive loss-based “metric learning” methods are similar to and different from traditional “one-hot” neural network classifiers in a few ways: similar in that both types of methods can be viewed as embedding methods (not just metric learning), different in that the latter involve a fixed set of classes, whereas the former rely on a similarity measure.</p>
<blockquote class="blockquote">
<p><strong>Confession:</strong> I didn’t fully disclose my motivation last time: I simply got sick of not knowing what “contrastive losses” meant in many important paper titles – notably <a href="https://openai.com/blog/clip/">OpenAI’s “CLIP”</a> and Eduardo Fonseca et al’s <a href="https://github.com/edufonseca/uclser20">“Unsupervised Contrastive Learning of Sound Event Representations”</a> – and decided “I need to learn this.” And (as one often finds in the rapidly-advancing and fragmented world of ML) it turned out I already knew what contrastive losses and metric learning were (e.g., I took a 4-course <a href="https://www.coursera.org/specializations/natural-language-processing">NLP Specialization</a> last year!), just not by those names. So hey, I might actually be qualified to teach on this after all! ;-) Ok, enough with the autobiography.</p>
</blockquote>
<p>Here’s an annotated outline of the sections of this post:</p>
<ol type="1">
<li><strong>Traditional One-Hot Classification Demo</strong>, using 3 and 4 classes. We’ll be following <a href="https://github.com/fastai/fastbook/blob/master/02_production.ipynb">Jeremy Howard and Sylvain Guggers’s “bears” example from Chapter 2 of the fastai book</a>. But we’ll focus on concepts and outcomes, saving FastAI details for Section 4</li>
<li><strong>Contrastive Loss Demo</strong> using the same data as as Section 1.</li>
<li><strong>Discussion</strong></li>
<li><strong>FastAI Details</strong>, including “how I learned to write my own <strong>Callback</strong>” for progress-tracking and data visualization. Note that these coding details will be <em>present</em> earlier in the post and viewable via the “Display Code” buttons, but the explanations of the code won’t appear until Section 4.</li>
</ol>
</section>
<section id="traditional-one-hot-classification-demo-three-and-4-types-of-bears" class="level2">
<h2 class="anchored" data-anchor-id="traditional-one-hot-classification-demo-three-and-4-types-of-bears">1. Traditional One-Hot Classification Demo: Three (and 4) Types of Bears</h2>
<p>We could do the “cats vs.&nbsp;dogs vs.&nbsp;horses” example from the previous Part 1 post, but it turns out that because we’re going to do Transfer Learning using a model pre-trained on ImageNet (which already has categories for cats, dogs, and horses), it’s <em>too easy</em> to even see anything “interesting” happen! I want to be able to show you “dots moving around” as the model trains.</p>
<p>Instead, we’ll copy Jeremy Howard…</p>
<blockquote class="blockquote">
<p>Aside: “We’ll copy Jeremy Howard” is something more members the ML community could probably stand to do, or admit they’re doing.</p>
</blockquote>
<p>…and do three types of bears: grizzly, brown, and teddy. ;-) And then later we’ll throw in one more “natural kind” of bear. ;-)</p>
<section id="scraping-for-images" class="level3">
<h3 class="anchored" data-anchor-id="scraping-for-images">Scraping for Images</h3>
<p>Using the DuckDuckGo API, let’s grab ~100 images of each kind of bear.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> scrape_for_me(dl_path, labels, search_suffix, erase_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>):</span>
<span id="cb1-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> erase_dir:</span>
<span id="cb1-3">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>rf {dl_path}           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clear out last time's downloads</span></span>
<span id="cb1-4">    path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(dl_path)</span>
<span id="cb1-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> path.exists(): path.mkdir()</span>
<span id="cb1-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> o <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> labels:            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scrape images off the web</span></span>
<span id="cb1-7">        search_term <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>o<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>search_suffix<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>).strip()</span>
<span id="cb1-8">        dest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>o)</span>
<span id="cb1-9">        dest.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Getting urls for search_term = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>search_term<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.."</span>)</span>
<span id="cb1-11">        urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> search_images_ddg(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>search_term<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_n) </span>
<span id="cb1-12">        urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ x <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> urls <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"magpies"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"charliebears"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> x) ]   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># kludge for now to keep download_images from hanging</span></span>
<span id="cb1-13">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>search_term<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: Got </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(urls)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> image URLs. Downloading..."</span>)</span>
<span id="cb1-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"   urls = "</span>,urls)</span>
<span id="cb1-15">        download_images(dest, urls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>urls, preserve_filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Images downloaded."</span>)</span>
<span id="cb1-17">        </span>
<span id="cb1-18">    fns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_image_files(path)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list image filenames</span></span>
<span id="cb1-19">    failed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> verify_images(fns)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check if any are unloadable</span></span>
<span id="cb1-20"></span>
<span id="cb1-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove what's unloadable</span></span>
<span id="cb1-22">    failed.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(Path.unlink)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> failed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> []:</span>
<span id="cb1-24">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fns.remove(f) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> failed]</span>
<span id="cb1-25"></span>
<span id="cb1-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extra: To avoid Transparency warnings, convert PNG images to RGBA, from https://forums.fast.ai/t/errors-when-training-the-bear-image-classification-model/83422/9</span></span>
<span id="cb1-27">    converted <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L()</span>
<span id="cb1-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> image <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> fns:</span>
<span id="cb1-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.png'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(image):</span>
<span id="cb1-30">            im <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Image.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(image)</span>
<span id="cb1-31">            converted.append(image)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># old file name before resaving</span></span>
<span id="cb1-32">            im.convert(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RGBA"</span>).save(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>image<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2.png"</span>)    </span>
<span id="cb1-33">    converted.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(Path.unlink)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># delete originals</span></span>
<span id="cb1-34">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"After checking images for issues, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(get_image_files(path))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (total) images remain."</span>)</span>
<span id="cb1-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> path     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and return a pathlib object pointing to image dir</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">dl_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scraped_images'</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where we're saving to</span></span>
<span id="cb2-2">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grizzly'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'teddy'</span>  </span>
<span id="cb2-3">search_suffix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bear'</span></span>
<span id="cb2-4">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scrape_for_me(dl_path, labels, search_suffix, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Getting urls for search_term = grizzly bear..</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>“Only 100(x3) images?! How can you hope to train a sophistical computer vision model with such a small amount of data?” Transfer Learning, my friend.</p>
</blockquote>
</section>
<section id="load-the-data-and-take-a-look" class="level3">
<h3 class="anchored" data-anchor-id="load-the-data-and-take-a-look">Load the Data and Take a Look</h3>
<p>Here are some examples of the images we grabbed:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> setup_dls(path):</span>
<span id="cb4-2">    data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataBlock(        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define fastai data structure</span></span>
<span id="cb4-3">        blocks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(ImageBlock, CategoryBlock), </span>
<span id="cb4-4">        get_items<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_image_files, </span>
<span id="cb4-5">        splitter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>RandomSplitter(valid_pct<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>),</span>
<span id="cb4-6">        get_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>parent_label,</span>
<span id="cb4-7">        item_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>RandomResizedCrop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">224</span>, min_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb4-8">        batch_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>aug_transforms())</span>
<span id="cb4-9">    dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.dataloaders(path)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define dataloader(s)</span></span>
<span id="cb4-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dls </span>
<span id="cb4-11"></span>
<span id="cb4-12">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_dls(path)</span>
<span id="cb4-13">dls.show_batch()                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># take a look</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="define-and-train-the-model" class="level3">
<h3 class="anchored" data-anchor-id="define-and-train-the-model">Define and Train the Model</h3>
<p>…With my special “triangle plot” visualization ( as demonstrated in the Part 1 blog post) called from my VizPreds fastai Callback (described below). (If you run this notebook on Colab, you’ll need to authorize Google Drive when prompted below, in order for the triangle plot image thumbnails to show).</p>
<p>In the plots that follow, mouse over the dots to see our bear images “move” as the model trains! You’ll see one epoch where the “body” network’s weights are frozen, and then four epochs where the full model trains.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cnn_learner(dls, resnet18, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[error_rate])</span>
<span id="cb5-2">learn.fine_tune(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>VizPreds)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fine_tune does 1 epoch 'frozen', then as many more epochs you specify</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generating (URLS of) thumbnail images...
Drive already mounted at /gdrive; to attempt to forcibly remount, call drive.mount("/gdrive", force_remount=True).
Thumbnails saved to Google Drive in /gdrive/My Drive/scraped_images_thumbs/
Waiting on Google Drive until URLs are ready.

Epoch 0: Plotting 51 (= 51?) points:
Epoch 0: Plotting 51 (= 51?) points:
Epoch 1: Plotting 51 (= 51?) points:
Epoch 2: Plotting 51 (= 51?) points:
Epoch 3: Plotting 51 (= 51?) points:</code></pre>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.788116</td>
<td>0.159182</td>
<td>0.019608</td>
<td>00:13</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</div>
<div class="cell-output cell-output-display">

<script type="application/javascript">

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    const hashes = {"https://cdn.bokeh.org/bokeh/release/bokeh-2.3.2.min.js": "XypntL49z55iwGVUW4qsEu83zKL3XEcz0MjuGOQ9SlaaQ68X/g+k1FcioZi7oQAc", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.3.2.min.js": "bEsM86IHGDTLCS0Zod8a8WM6Y4+lafAL/eSiyQcuPzinmWNgNO2/olUF0Z2Dkn5i", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.3.2.min.js": "TX0gSQTdXTTeScqxj6PVQxTiRW8DOoGVwinyi1D3kxv7wuxQ02XkOxv0xwiypcAH"};

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      if (url in hashes) {
        element.crossOrigin = "anonymous";
        element.integrity = "sha384-" + hashes[url];
      }
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.3.2.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script>
</div>
<div class="cell-output cell-output-display">






  <div class="bk-root" id="6fd0e3ad-4a24-44f2-81ec-c0abbe31f7c2" data-root-id="1002"></div>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"1c6d56f8-423b-485d-ba26-9a6edecc00b3":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1013"}],"center":[{"id":"1016"},{"id":"1020"},{"id":"1067"},{"id":"1068"},{"id":"1069"},{"id":"1070"}],"height":350,"left":[{"id":"1017"}],"renderers":[{"id":"1049"},{"id":"1054"},{"id":"1059"},{"id":"1065"}],"title":{"id":"1003"},"toolbar":{"id":"1029"},"width":400,"x_range":{"id":"1005"},"x_scale":{"id":"1009"},"y_range":{"id":"1007"},"y_scale":{"id":"1011"}},"id":"1002","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1038","type":"AllLabels"},{"attributes":{"source":{"id":"1051"}},"id":"1055","type":"CDSView"},{"attributes":{"data_source":{"id":"1046"},"glyph":{"id":"1047"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1048"},"view":{"id":"1050"}},"id":"1049","type":"GlyphRenderer"},{"attributes":{},"id":"1018","type":"BasicTicker"},{"attributes":{"text":"black","text_align":"right","x":-1,"y":0},"id":"1067","type":"Label"},{"attributes":{},"id":"1021","type":"PanTool"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1084"},"selection_policy":{"id":"1083"}},"id":"1056","type":"ColumnDataSource"},{"attributes":{"axis":{"id":"1017"},"dimension":1,"ticker":null},"id":"1020","type":"Grid"},{"attributes":{"text":"grizzly","x":1,"y":0},"id":"1068","type":"Label"},{"attributes":{"text":"Epoch 0","x":-1,"y":0.95},"id":"1070","type":"Label"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1082"},"selection_policy":{"id":"1081"}},"id":"1051","type":"ColumnDataSource"},{"attributes":{},"id":"1022","type":"WheelZoomTool"},{"attributes":{"source":{"id":"1046"}},"id":"1050","type":"CDSView"},{"attributes":{"data_source":{"id":"1051"},"glyph":{"id":"1052"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1053"},"view":{"id":"1055"}},"id":"1054","type":"GlyphRenderer"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"80\" alt=\"@imgs\"\n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1028","type":"HoverTool"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1027","type":"BoxAnnotation"},{"attributes":{"text":"teddy","text_align":"center","x":0,"y":1},"id":"1069","type":"Label"},{"attributes":{"formatter":{"id":"1043"},"major_label_policy":{"id":"1041"},"ticker":{"id":"1014"}},"id":"1013","type":"LinearAxis"},{"attributes":{},"id":"1040","type":"BasicTickFormatter"},{"attributes":{"data_source":{"id":"1056"},"glyph":{"id":"1057"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1058"},"view":{"id":"1060"}},"id":"1059","type":"GlyphRenderer"},{"attributes":{},"id":"1009","type":"LinearScale"},{"attributes":{"active_multi":null,"active_scroll":{"id":"1022"},"tools":[{"id":"1021"},{"id":"1022"},{"id":"1023"},{"id":"1024"},{"id":"1025"},{"id":"1026"},{"id":"1028"}]},"id":"1029","type":"Toolbar"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1057","type":"Line"},{"attributes":{"data":{"colors":["blue","red","blue","blue","green","red","blue","green","red","red","green","green","blue","green","red","blue","green","red","green","green","blue","red","blue","red","red","red","red","red","blue","green","red","green","red","green","green","blue","red","red","green","red","green","red","green","blue","green","green","green","green","green","red","red"],"desc":["teddy","black","teddy","teddy","grizzly","black","teddy","grizzly","black","black","grizzly","grizzly","teddy","grizzly","black","teddy","grizzly","black","grizzly","grizzly","teddy","black","teddy","black","black","black","black","black","teddy","grizzly","black","grizzly","black","grizzly","grizzly","teddy","black","black","grizzly","black","grizzly","black","grizzly","teddy","grizzly","grizzly","grizzly","grizzly","grizzly","black","black"],"imgs":["https://drive.google.com/uc?id=144UkVrxda4UfDaxzLAXpVeFK4qs6EQZq","https://drive.google.com/uc?id=13yrOC0bF05t16oeIHyd8jGcgc8vvFATn","https://drive.google.com/uc?id=13of7EO_C4Hycy7QVKhu8suQgrrgVREyo","https://drive.google.com/uc?id=13mqTpJ3Dgvif6LVqQWUe-lKkeF96UUf7","https://drive.google.com/uc?id=13ctTDS6PV80_IMSrdECv9xhqcx9LekrN","https://drive.google.com/uc?id=13VKKxGUJKRBUD2fWtX-e_Uf2npblNVyo","https://drive.google.com/uc?id=13MrycLyVxd7rUPE0nxFU-17UMUnFlRWe","https://drive.google.com/uc?id=13MpYou1FK5AcIkbAWWpeU8G0yJI_vjfh","https://drive.google.com/uc?id=13KAW9MNTa7HC72d1wfRy85OucPR6XYKP","https://drive.google.com/uc?id=13JOBr0dMSn6VkXBOhNu8XC30LP_UPMhL","https://drive.google.com/uc?id=13JACf5-bju0YJMETud3sa0fL2WJ3-Sxo","https://drive.google.com/uc?id=13DfS0f-VsYDKAIQnVs_PFHu-Hg06S-XM","https://drive.google.com/uc?id=13C4pfym-1VD9Dv5CX0EmLmBWamAR5bID","https://drive.google.com/uc?id=1393lLmOV6npis9P-P3-CqpklxJiPtrfT","https://drive.google.com/uc?id=12xcrhuANLFl_7rWtTxeP-tTLFJJGtBtD","https://drive.google.com/uc?id=15W1pgbK9IZmJTsGDkhGuiDkagbNSQTwi","https://drive.google.com/uc?id=15QyVVMztCGz27L353KIWMTGZB2ipyVv9","https://drive.google.com/uc?id=15GRZC6aNQp3F9elNGTj3ZaFllIm7dn8L","https://drive.google.com/uc?id=15A3xW0CxXwsjSxzzJcthgwTS_mpJGnQ2","https://drive.google.com/uc?id=152f9wYwVKh3fT0MvFNzn6rmQRAAUdztv","https://drive.google.com/uc?id=14y4xqLlWS_bHGE_Wlx28MGYmRdhVDufl","https://drive.google.com/uc?id=14xkVKUNuaH1OyrPwG9BAc2a53mcTkK-C","https://drive.google.com/uc?id=14vs_YJtcEVLXFLP6G4d_WBHb93j7fte_","https://drive.google.com/uc?id=14pwEYoKytVytNqeRJ38K2DmnautzTNh7","https://drive.google.com/uc?id=14h7T3R0t7iuemHzsK9nqGxVPoV2r7KwA","https://drive.google.com/uc?id=14_XerMk61NKlDRA3cS8wqTdgWcqPsJhf","https://drive.google.com/uc?id=14R6mpXVga4V73WJYO22vQZJ2l6dX7XII","https://drive.google.com/uc?id=14KSuyF3OjJGo3JrZ1QO2rxIP8SB5WiET","https://drive.google.com/uc?id=14FlfKzcIxfjULItQfyf5GYojA8YF9zz0","https://drive.google.com/uc?id=16qF8W_r9THgNSTFR9AM0wiqCBZsSQBjI","https://drive.google.com/uc?id=16pXsH15QFvcAy9rIwOMF21Xy3Sm86jtv","https://drive.google.com/uc?id=16ncOYapzN4Oa1agITkUOeaI2jJ7W_D3K","https://drive.google.com/uc?id=16gX21nGC2_BFLU2jIr0aZs9XcxBv4hhp","https://drive.google.com/uc?id=16c6ZkIoY7aU8bZxqWYOlSWVPmfUSd8lv","https://drive.google.com/uc?id=16_wzemGQyMtd_Mk3Idfzb0B96s7QLm87","https://drive.google.com/uc?id=16HLWDFM2qu0y4ySUeoZSLM3R1e-c9Lfl","https://drive.google.com/uc?id=16DbvqnFxb7fHMXP3x03ge0-wEGVgKIZt","https://drive.google.com/uc?id=1685ol1eECA_QPvxFBblcdbox8KoNtpxV","https://drive.google.com/uc?id=167YXnthhbu4AaavfhgM7M3gtWkZY5u-x","https://drive.google.com/uc?id=165r1wKFjrQL3NOk_RibnmcNtscxIv2fz","https://drive.google.com/uc?id=1656ybwpgt_pMLoQfHmvWb-tv00agMLAd","https://drive.google.com/uc?id=16-XVTd6xWZVZktb1R5RUsCakzqAKxAZb","https://drive.google.com/uc?id=15z05LH4y9it2CdTqcClWgVcSQQzTosGq","https://drive.google.com/uc?id=15vVLOCk2RIITHCKwAxJggZktY9TWl2p-","https://drive.google.com/uc?id=15sHZbU7JwqdEtobOCZu5YMnWSBRHjUyb","https://drive.google.com/uc?id=15qAdiVC3llbsfFJjsjVf7QHLkSHQbDSn","https://drive.google.com/uc?id=15eofsGgA-vlxuGziwACvOhhT4OUwaVKT","https://drive.google.com/uc?id=15axvmV1j-yIGnm_gXn-1wJQzGn-iA3VO","https://drive.google.com/uc?id=15_XXXfq312Bpv9tozpVy-ECwuxLYyfDo","https://drive.google.com/uc?id=15Y4dez3TvNlYfBkLo2reCCpY7l6nvA8h","https://drive.google.com/uc?id=15XWnZAzesjUWfe0hXRQgwwBr5jARRck8"],"x":{"__ndarray__":"bxQHPFEWer8VJUg7zl5/PgY2bD8NG3+/C90/u7Cdsz6+yUe/X26yvqbXfj+qSsM++jvUPMyVEj/BuWa/glS1PHNqWD+seXW/+6MPP2/pUD+2TC07989+v0JQdDyilFy/knRmv4Fher9Uvym/odR/v0pJV7oYNd693JNwv/wwnj2OXn+/n86rPnIpbT9tWxo+BfXNvm1Hc7/kfA0/SBUCvdoQMz/AXm2/Q/JJP1uawzuFPjQ/GIZBP/ss6j7wrmI/hBTlPaD7br8SS2a/","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"N9V9P6s0ADoLCn8/ue8/P8eyOjoLoT84cB9/P6iwJjo6GRw9saRBPK5ZzDnhJRc8QVR5P2J6JzlRiPQ5fxt5Pxo8izslLxw8E3VWOlJFPz0dT38/5pw1OVTgej+Wz0k9ua9oPLQ2rDo5sqA63RebNvMGfz9eR6M7pyvGOwFmuTuldcM6Q/IMPk6KpTv4hlc/St2mPOOsEzsa1aM57YeMORXWpzvrDac6eMawOuE0fj/NS7o6eT7aOSr2BDuxhiU5UU19PWxf3ztRo0M8","dtype":"float32","order":"little","shape":[51]}},"selected":{"id":"1086"},"selection_policy":{"id":"1085"}},"id":"1061","type":"ColumnDataSource"},{"attributes":{},"id":"1081","type":"UnionRenderers"},{"attributes":{"data_source":{"id":"1061"},"glyph":{"id":"1063"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1064"},"view":{"id":"1066"}},"id":"1065","type":"GlyphRenderer"},{"attributes":{"overlay":{"id":"1027"}},"id":"1023","type":"BoxZoomTool"},{"attributes":{"text":"Mouse over the dots"},"id":"1003","type":"Title"},{"attributes":{},"id":"1011","type":"LinearScale"},{"attributes":{},"id":"1024","type":"SaveTool"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1063","type":"Circle"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1052","type":"Line"},{"attributes":{},"id":"1041","type":"AllLabels"},{"attributes":{},"id":"1025","type":"ResetTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1048","type":"Line"},{"attributes":{"source":{"id":"1056"}},"id":"1060","type":"CDSView"},{"attributes":{"formatter":{"id":"1040"},"major_label_policy":{"id":"1038"},"ticker":{"id":"1018"}},"id":"1017","type":"LinearAxis"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1058","type":"Line"},{"attributes":{},"id":"1079","type":"UnionRenderers"},{"attributes":{},"id":"1082","type":"Selection"},{"attributes":{},"id":"1026","type":"HelpTool"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1047","type":"Line"},{"attributes":{"axis":{"id":"1013"},"ticker":null},"id":"1016","type":"Grid"},{"attributes":{},"id":"1083","type":"UnionRenderers"},{"attributes":{},"id":"1005","type":"DataRange1d"},{"attributes":{},"id":"1043","type":"BasicTickFormatter"},{"attributes":{},"id":"1084","type":"Selection"},{"attributes":{},"id":"1080","type":"Selection"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1053","type":"Line"},{"attributes":{},"id":"1014","type":"BasicTicker"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1080"},"selection_policy":{"id":"1079"}},"id":"1046","type":"ColumnDataSource"},{"attributes":{},"id":"1085","type":"UnionRenderers"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1064","type":"Circle"},{"attributes":{},"id":"1086","type":"Selection"},{"attributes":{"source":{"id":"1061"}},"id":"1066","type":"CDSView"},{"attributes":{},"id":"1007","type":"DataRange1d"}],"root_ids":["1002"]},"title":"Bokeh Application","version":"2.3.2"}};
  var render_items = [{"docid":"1c6d56f8-423b-485d-ba26-9a6edecc00b3","root_ids":["1002"],"roots":{"1002":"6fd0e3ad-4a24-44f2-81ec-c0abbe31f7c2"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.327038</td>
<td>0.050930</td>
<td>0.000000</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.231127</td>
<td>0.067547</td>
<td>0.019608</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.170447</td>
<td>0.047806</td>
<td>0.019608</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.134644</td>
<td>0.027070</td>
<td>0.019608</td>
<td>00:13</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">






  <div class="bk-root" id="e054ad69-e9e5-40b2-9f7d-dfe2dc2215a3" data-root-id="1167"></div>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"3e66e96a-ad51-4edb-83e0-9b91cbfb1f8b":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1178"}],"center":[{"id":"1181"},{"id":"1185"},{"id":"1232"},{"id":"1233"},{"id":"1234"},{"id":"1235"}],"height":350,"left":[{"id":"1182"}],"renderers":[{"id":"1214"},{"id":"1219"},{"id":"1224"},{"id":"1230"}],"title":{"id":"1168"},"toolbar":{"id":"1194"},"width":400,"x_range":{"id":"1170"},"x_scale":{"id":"1174"},"y_range":{"id":"1172"},"y_scale":{"id":"1176"}},"id":"1167","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1179","type":"BasicTicker"},{"attributes":{},"id":"1267","type":"Selection"},{"attributes":{},"id":"1170","type":"DataRange1d"},{"attributes":{"source":{"id":"1216"}},"id":"1220","type":"CDSView"},{"attributes":{"source":{"id":"1221"}},"id":"1225","type":"CDSView"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1265"},"selection_policy":{"id":"1264"}},"id":"1221","type":"ColumnDataSource"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1218","type":"Line"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1228","type":"Circle"},{"attributes":{"text":"teddy","text_align":"center","x":0,"y":1},"id":"1234","type":"Label"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1229","type":"Circle"},{"attributes":{"formatter":{"id":"1208"},"major_label_policy":{"id":"1206"},"ticker":{"id":"1179"}},"id":"1178","type":"LinearAxis"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"80\" alt=\"@imgs\"\n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1193","type":"HoverTool"},{"attributes":{},"id":"1205","type":"BasicTickFormatter"},{"attributes":{},"id":"1172","type":"DataRange1d"},{"attributes":{},"id":"1203","type":"AllLabels"},{"attributes":{"text":"Epoch 0","x":-1,"y":0.95},"id":"1235","type":"Label"},{"attributes":{"source":{"id":"1226"}},"id":"1231","type":"CDSView"},{"attributes":{},"id":"1261","type":"Selection"},{"attributes":{"data_source":{"id":"1221"},"glyph":{"id":"1222"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1223"},"view":{"id":"1225"}},"id":"1224","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1223","type":"Line"},{"attributes":{"text":"grizzly","x":1,"y":0},"id":"1233","type":"Label"},{"attributes":{},"id":"1191","type":"HelpTool"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1192","type":"BoxAnnotation"},{"attributes":{},"id":"1266","type":"UnionRenderers"},{"attributes":{"text":"black","text_align":"right","x":-1,"y":0},"id":"1232","type":"Label"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1217","type":"Line"},{"attributes":{},"id":"1208","type":"BasicTickFormatter"},{"attributes":{"data_source":{"id":"1211"},"glyph":{"id":"1212"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1213"},"view":{"id":"1215"}},"id":"1214","type":"GlyphRenderer"},{"attributes":{},"id":"1176","type":"LinearScale"},{"attributes":{"axis":{"id":"1178"},"ticker":null},"id":"1181","type":"Grid"},{"attributes":{"active_multi":null,"active_scroll":{"id":"1187"},"tools":[{"id":"1186"},{"id":"1187"},{"id":"1188"},{"id":"1189"},{"id":"1190"},{"id":"1191"},{"id":"1193"}]},"id":"1194","type":"Toolbar"},{"attributes":{"axis":{"id":"1182"},"dimension":1,"ticker":null},"id":"1185","type":"Grid"},{"attributes":{},"id":"1190","type":"ResetTool"},{"attributes":{},"id":"1260","type":"UnionRenderers"},{"attributes":{},"id":"1174","type":"LinearScale"},{"attributes":{},"id":"1186","type":"PanTool"},{"attributes":{},"id":"1262","type":"UnionRenderers"},{"attributes":{"formatter":{"id":"1205"},"major_label_policy":{"id":"1203"},"ticker":{"id":"1183"}},"id":"1182","type":"LinearAxis"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1212","type":"Line"},{"attributes":{"overlay":{"id":"1192"}},"id":"1188","type":"BoxZoomTool"},{"attributes":{},"id":"1183","type":"BasicTicker"},{"attributes":{},"id":"1187","type":"WheelZoomTool"},{"attributes":{"source":{"id":"1211"}},"id":"1215","type":"CDSView"},{"attributes":{},"id":"1206","type":"AllLabels"},{"attributes":{},"id":"1263","type":"Selection"},{"attributes":{"text":"Mouse over the dots"},"id":"1168","type":"Title"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1263"},"selection_policy":{"id":"1262"}},"id":"1216","type":"ColumnDataSource"},{"attributes":{},"id":"1189","type":"SaveTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1213","type":"Line"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1261"},"selection_policy":{"id":"1260"}},"id":"1211","type":"ColumnDataSource"},{"attributes":{"data":{"colors":["blue","red","blue","blue","green","red","blue","green","red","red","green","green","blue","green","red","blue","green","red","green","green","blue","red","blue","red","red","red","red","red","blue","green","red","green","red","green","green","blue","red","red","green","red","green","red","green","blue","green","green","green","green","green","red","red"],"desc":["teddy","black","teddy","teddy","grizzly","black","teddy","grizzly","black","black","grizzly","grizzly","teddy","grizzly","black","teddy","grizzly","black","grizzly","grizzly","teddy","black","teddy","black","black","black","black","black","teddy","grizzly","black","grizzly","black","grizzly","grizzly","teddy","black","black","grizzly","black","grizzly","black","grizzly","teddy","grizzly","grizzly","grizzly","grizzly","grizzly","black","black"],"imgs":["https://drive.google.com/uc?id=144UkVrxda4UfDaxzLAXpVeFK4qs6EQZq","https://drive.google.com/uc?id=13yrOC0bF05t16oeIHyd8jGcgc8vvFATn","https://drive.google.com/uc?id=13of7EO_C4Hycy7QVKhu8suQgrrgVREyo","https://drive.google.com/uc?id=13mqTpJ3Dgvif6LVqQWUe-lKkeF96UUf7","https://drive.google.com/uc?id=13ctTDS6PV80_IMSrdECv9xhqcx9LekrN","https://drive.google.com/uc?id=13VKKxGUJKRBUD2fWtX-e_Uf2npblNVyo","https://drive.google.com/uc?id=13MrycLyVxd7rUPE0nxFU-17UMUnFlRWe","https://drive.google.com/uc?id=13MpYou1FK5AcIkbAWWpeU8G0yJI_vjfh","https://drive.google.com/uc?id=13KAW9MNTa7HC72d1wfRy85OucPR6XYKP","https://drive.google.com/uc?id=13JOBr0dMSn6VkXBOhNu8XC30LP_UPMhL","https://drive.google.com/uc?id=13JACf5-bju0YJMETud3sa0fL2WJ3-Sxo","https://drive.google.com/uc?id=13DfS0f-VsYDKAIQnVs_PFHu-Hg06S-XM","https://drive.google.com/uc?id=13C4pfym-1VD9Dv5CX0EmLmBWamAR5bID","https://drive.google.com/uc?id=1393lLmOV6npis9P-P3-CqpklxJiPtrfT","https://drive.google.com/uc?id=12xcrhuANLFl_7rWtTxeP-tTLFJJGtBtD","https://drive.google.com/uc?id=15W1pgbK9IZmJTsGDkhGuiDkagbNSQTwi","https://drive.google.com/uc?id=15QyVVMztCGz27L353KIWMTGZB2ipyVv9","https://drive.google.com/uc?id=15GRZC6aNQp3F9elNGTj3ZaFllIm7dn8L","https://drive.google.com/uc?id=15A3xW0CxXwsjSxzzJcthgwTS_mpJGnQ2","https://drive.google.com/uc?id=152f9wYwVKh3fT0MvFNzn6rmQRAAUdztv","https://drive.google.com/uc?id=14y4xqLlWS_bHGE_Wlx28MGYmRdhVDufl","https://drive.google.com/uc?id=14xkVKUNuaH1OyrPwG9BAc2a53mcTkK-C","https://drive.google.com/uc?id=14vs_YJtcEVLXFLP6G4d_WBHb93j7fte_","https://drive.google.com/uc?id=14pwEYoKytVytNqeRJ38K2DmnautzTNh7","https://drive.google.com/uc?id=14h7T3R0t7iuemHzsK9nqGxVPoV2r7KwA","https://drive.google.com/uc?id=14_XerMk61NKlDRA3cS8wqTdgWcqPsJhf","https://drive.google.com/uc?id=14R6mpXVga4V73WJYO22vQZJ2l6dX7XII","https://drive.google.com/uc?id=14KSuyF3OjJGo3JrZ1QO2rxIP8SB5WiET","https://drive.google.com/uc?id=14FlfKzcIxfjULItQfyf5GYojA8YF9zz0","https://drive.google.com/uc?id=16qF8W_r9THgNSTFR9AM0wiqCBZsSQBjI","https://drive.google.com/uc?id=16pXsH15QFvcAy9rIwOMF21Xy3Sm86jtv","https://drive.google.com/uc?id=16ncOYapzN4Oa1agITkUOeaI2jJ7W_D3K","https://drive.google.com/uc?id=16gX21nGC2_BFLU2jIr0aZs9XcxBv4hhp","https://drive.google.com/uc?id=16c6ZkIoY7aU8bZxqWYOlSWVPmfUSd8lv","https://drive.google.com/uc?id=16_wzemGQyMtd_Mk3Idfzb0B96s7QLm87","https://drive.google.com/uc?id=16HLWDFM2qu0y4ySUeoZSLM3R1e-c9Lfl","https://drive.google.com/uc?id=16DbvqnFxb7fHMXP3x03ge0-wEGVgKIZt","https://drive.google.com/uc?id=1685ol1eECA_QPvxFBblcdbox8KoNtpxV","https://drive.google.com/uc?id=167YXnthhbu4AaavfhgM7M3gtWkZY5u-x","https://drive.google.com/uc?id=165r1wKFjrQL3NOk_RibnmcNtscxIv2fz","https://drive.google.com/uc?id=1656ybwpgt_pMLoQfHmvWb-tv00agMLAd","https://drive.google.com/uc?id=16-XVTd6xWZVZktb1R5RUsCakzqAKxAZb","https://drive.google.com/uc?id=15z05LH4y9it2CdTqcClWgVcSQQzTosGq","https://drive.google.com/uc?id=15vVLOCk2RIITHCKwAxJggZktY9TWl2p-","https://drive.google.com/uc?id=15sHZbU7JwqdEtobOCZu5YMnWSBRHjUyb","https://drive.google.com/uc?id=15qAdiVC3llbsfFJjsjVf7QHLkSHQbDSn","https://drive.google.com/uc?id=15eofsGgA-vlxuGziwACvOhhT4OUwaVKT","https://drive.google.com/uc?id=15axvmV1j-yIGnm_gXn-1wJQzGn-iA3VO","https://drive.google.com/uc?id=15_XXXfq312Bpv9tozpVy-ECwuxLYyfDo","https://drive.google.com/uc?id=15Y4dez3TvNlYfBkLo2reCCpY7l6nvA8h","https://drive.google.com/uc?id=15XWnZAzesjUWfe0hXRQgwwBr5jARRck8"],"x":{"__ndarray__":"bJYDO3wxeL/xOnc6Anc+PeZ/fT9Rg3+/GVgHuhqUNj/GnFy/wCEkv5DZfz9syDk/i8pAOxERfD9jmGW/yij/OyAJbz8T9Hu/QfR6P0n6cz9fE5M5rIN/vzMPNjtyOXq/0HN8vzP5er+rlSy/T/l/v/dbRTmmOzM/UTd7v4V9PT/66H+/56duP4ONeT+G5ZE7Ff1Dv2r+fr9hU3E/8L3RvE4AdT+JYmm/H/1pP1za0DrnoX0//ZN1P0Hwej/TVHI/VWhYP06YYr/OH3q/","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"sXd/P/JRhjjAu38/cAp0P0D4uji4Hok3+8p/PyUZGzk0EvU7Bb+aO2sMojjyvU47/zx/P6L2tzbWAoU5MoF9PxLesjpa2JE7lbFxOBdSIzyt7H8/ipxBOGsefz9u4jE8gdAjO6v9lzkY/6Q5dqkVNt/Wfz/M3gE7/pjzOUptPzuQP3A5V5YDPbHcjDuxv34/og4vPGwZrDm6X7w4KzqBODhenzrVQzI6GIZIOryQfz+pgns4q/LcOGR45zmUopg4HrYWPVMgsjtqzYs7","dtype":"float32","order":"little","shape":[51]}},"selected":{"id":"1267"},"selection_policy":{"id":"1266"}},"id":"1226","type":"ColumnDataSource"},{"attributes":{},"id":"1264","type":"UnionRenderers"},{"attributes":{},"id":"1265","type":"Selection"},{"attributes":{"data_source":{"id":"1226"},"glyph":{"id":"1228"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1229"},"view":{"id":"1231"}},"id":"1230","type":"GlyphRenderer"},{"attributes":{"data_source":{"id":"1216"},"glyph":{"id":"1217"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1218"},"view":{"id":"1220"}},"id":"1219","type":"GlyphRenderer"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1222","type":"Line"}],"root_ids":["1167"]},"title":"Bokeh Application","version":"2.3.2"}};
  var render_items = [{"docid":"3e66e96a-ad51-4edb-83e0-9b91cbfb1f8b","root_ids":["1167"],"roots":{"1167":"e054ad69-e9e5-40b2-9f7d-dfe2dc2215a3"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
<div class="cell-output cell-output-display">






  <div class="bk-root" id="c15801c5-c35c-483f-86ee-b3203604690e" data-root-id="1348"></div>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"7039a618-5686-42ce-b035-f03e38f69e68":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1359"}],"center":[{"id":"1362"},{"id":"1366"},{"id":"1413"},{"id":"1414"},{"id":"1415"},{"id":"1416"}],"height":350,"left":[{"id":"1363"}],"renderers":[{"id":"1395"},{"id":"1400"},{"id":"1405"},{"id":"1411"}],"title":{"id":"1349"},"toolbar":{"id":"1375"},"width":400,"x_range":{"id":"1351"},"x_scale":{"id":"1355"},"y_range":{"id":"1353"},"y_scale":{"id":"1357"}},"id":"1348","subtype":"Figure","type":"Plot"},{"attributes":{"source":{"id":"1407"}},"id":"1412","type":"CDSView"},{"attributes":{},"id":"1360","type":"BasicTicker"},{"attributes":{},"id":"1386","type":"BasicTickFormatter"},{"attributes":{"data_source":{"id":"1407"},"glyph":{"id":"1409"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1410"},"view":{"id":"1412"}},"id":"1411","type":"GlyphRenderer"},{"attributes":{"axis":{"id":"1363"},"dimension":1,"ticker":null},"id":"1366","type":"Grid"},{"attributes":{},"id":"1367","type":"PanTool"},{"attributes":{"source":{"id":"1397"}},"id":"1401","type":"CDSView"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1403","type":"Line"},{"attributes":{"data_source":{"id":"1397"},"glyph":{"id":"1398"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1399"},"view":{"id":"1401"}},"id":"1400","type":"GlyphRenderer"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1458"},"selection_policy":{"id":"1457"}},"id":"1392","type":"ColumnDataSource"},{"attributes":{"text":"grizzly","x":1,"y":0},"id":"1414","type":"Label"},{"attributes":{"source":{"id":"1392"}},"id":"1396","type":"CDSView"},{"attributes":{"text":"Epoch 1","x":-1,"y":0.95},"id":"1416","type":"Label"},{"attributes":{},"id":"1364","type":"BasicTicker"},{"attributes":{},"id":"1370","type":"SaveTool"},{"attributes":{},"id":"1384","type":"AllLabels"},{"attributes":{"formatter":{"id":"1386"},"major_label_policy":{"id":"1384"},"ticker":{"id":"1364"}},"id":"1363","type":"LinearAxis"},{"attributes":{},"id":"1355","type":"LinearScale"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1399","type":"Line"},{"attributes":{"text":"teddy","text_align":"center","x":0,"y":1},"id":"1415","type":"Label"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1398","type":"Line"},{"attributes":{"data":{"colors":["blue","red","blue","blue","green","red","blue","green","red","red","green","green","blue","green","red","blue","green","red","green","green","blue","red","blue","red","red","red","red","red","blue","green","red","green","red","green","green","blue","red","red","green","red","green","red","green","blue","green","green","green","green","green","red","red"],"desc":["teddy","black","teddy","teddy","grizzly","black","teddy","grizzly","black","black","grizzly","grizzly","teddy","grizzly","black","teddy","grizzly","black","grizzly","grizzly","teddy","black","teddy","black","black","black","black","black","teddy","grizzly","black","grizzly","black","grizzly","grizzly","teddy","black","black","grizzly","black","grizzly","black","grizzly","teddy","grizzly","grizzly","grizzly","grizzly","grizzly","black","black"],"imgs":["https://drive.google.com/uc?id=144UkVrxda4UfDaxzLAXpVeFK4qs6EQZq","https://drive.google.com/uc?id=13yrOC0bF05t16oeIHyd8jGcgc8vvFATn","https://drive.google.com/uc?id=13of7EO_C4Hycy7QVKhu8suQgrrgVREyo","https://drive.google.com/uc?id=13mqTpJ3Dgvif6LVqQWUe-lKkeF96UUf7","https://drive.google.com/uc?id=13ctTDS6PV80_IMSrdECv9xhqcx9LekrN","https://drive.google.com/uc?id=13VKKxGUJKRBUD2fWtX-e_Uf2npblNVyo","https://drive.google.com/uc?id=13MrycLyVxd7rUPE0nxFU-17UMUnFlRWe","https://drive.google.com/uc?id=13MpYou1FK5AcIkbAWWpeU8G0yJI_vjfh","https://drive.google.com/uc?id=13KAW9MNTa7HC72d1wfRy85OucPR6XYKP","https://drive.google.com/uc?id=13JOBr0dMSn6VkXBOhNu8XC30LP_UPMhL","https://drive.google.com/uc?id=13JACf5-bju0YJMETud3sa0fL2WJ3-Sxo","https://drive.google.com/uc?id=13DfS0f-VsYDKAIQnVs_PFHu-Hg06S-XM","https://drive.google.com/uc?id=13C4pfym-1VD9Dv5CX0EmLmBWamAR5bID","https://drive.google.com/uc?id=1393lLmOV6npis9P-P3-CqpklxJiPtrfT","https://drive.google.com/uc?id=12xcrhuANLFl_7rWtTxeP-tTLFJJGtBtD","https://drive.google.com/uc?id=15W1pgbK9IZmJTsGDkhGuiDkagbNSQTwi","https://drive.google.com/uc?id=15QyVVMztCGz27L353KIWMTGZB2ipyVv9","https://drive.google.com/uc?id=15GRZC6aNQp3F9elNGTj3ZaFllIm7dn8L","https://drive.google.com/uc?id=15A3xW0CxXwsjSxzzJcthgwTS_mpJGnQ2","https://drive.google.com/uc?id=152f9wYwVKh3fT0MvFNzn6rmQRAAUdztv","https://drive.google.com/uc?id=14y4xqLlWS_bHGE_Wlx28MGYmRdhVDufl","https://drive.google.com/uc?id=14xkVKUNuaH1OyrPwG9BAc2a53mcTkK-C","https://drive.google.com/uc?id=14vs_YJtcEVLXFLP6G4d_WBHb93j7fte_","https://drive.google.com/uc?id=14pwEYoKytVytNqeRJ38K2DmnautzTNh7","https://drive.google.com/uc?id=14h7T3R0t7iuemHzsK9nqGxVPoV2r7KwA","https://drive.google.com/uc?id=14_XerMk61NKlDRA3cS8wqTdgWcqPsJhf","https://drive.google.com/uc?id=14R6mpXVga4V73WJYO22vQZJ2l6dX7XII","https://drive.google.com/uc?id=14KSuyF3OjJGo3JrZ1QO2rxIP8SB5WiET","https://drive.google.com/uc?id=14FlfKzcIxfjULItQfyf5GYojA8YF9zz0","https://drive.google.com/uc?id=16qF8W_r9THgNSTFR9AM0wiqCBZsSQBjI","https://drive.google.com/uc?id=16pXsH15QFvcAy9rIwOMF21Xy3Sm86jtv","https://drive.google.com/uc?id=16ncOYapzN4Oa1agITkUOeaI2jJ7W_D3K","https://drive.google.com/uc?id=16gX21nGC2_BFLU2jIr0aZs9XcxBv4hhp","https://drive.google.com/uc?id=16c6ZkIoY7aU8bZxqWYOlSWVPmfUSd8lv","https://drive.google.com/uc?id=16_wzemGQyMtd_Mk3Idfzb0B96s7QLm87","https://drive.google.com/uc?id=16HLWDFM2qu0y4ySUeoZSLM3R1e-c9Lfl","https://drive.google.com/uc?id=16DbvqnFxb7fHMXP3x03ge0-wEGVgKIZt","https://drive.google.com/uc?id=1685ol1eECA_QPvxFBblcdbox8KoNtpxV","https://drive.google.com/uc?id=167YXnthhbu4AaavfhgM7M3gtWkZY5u-x","https://drive.google.com/uc?id=165r1wKFjrQL3NOk_RibnmcNtscxIv2fz","https://drive.google.com/uc?id=1656ybwpgt_pMLoQfHmvWb-tv00agMLAd","https://drive.google.com/uc?id=16-XVTd6xWZVZktb1R5RUsCakzqAKxAZb","https://drive.google.com/uc?id=15z05LH4y9it2CdTqcClWgVcSQQzTosGq","https://drive.google.com/uc?id=15vVLOCk2RIITHCKwAxJggZktY9TWl2p-","https://drive.google.com/uc?id=15sHZbU7JwqdEtobOCZu5YMnWSBRHjUyb","https://drive.google.com/uc?id=15qAdiVC3llbsfFJjsjVf7QHLkSHQbDSn","https://drive.google.com/uc?id=15eofsGgA-vlxuGziwACvOhhT4OUwaVKT","https://drive.google.com/uc?id=15axvmV1j-yIGnm_gXn-1wJQzGn-iA3VO","https://drive.google.com/uc?id=15_XXXfq312Bpv9tozpVy-ECwuxLYyfDo","https://drive.google.com/uc?id=15Y4dez3TvNlYfBkLo2reCCpY7l6nvA8h","https://drive.google.com/uc?id=15XWnZAzesjUWfe0hXRQgwwBr5jARRck8"],"x":{"__ndarray__":"xYwhOZU7bb8gSO84sGaMO536fz/L0n2/2sMDuHoJfz9D326/XU+vvsD/fz/LpHs/qrwBOYz/fz+1zlO/GgJrOi43fj8Yf36/8Px/P1rJfz8PoYA3XaV/v0YyBTq6En+/vtd+vx22er/MHTO/7/h/vy9tiDfYdX0/1ud8v11MfT9293+/aOh/PxjYfz8GHPM4zfk+v0Wpf782yH8/TeQ9P5Gdfz+eYl6/EQl/P4nyBjme/38/Dup/Pxj/fz+LrX4/y3R/Pxcvvb4giHi/","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"kPV/Pzvf+zbW938/8OV+P3wd0jWDBdM2Tvt/P4R8ZDbnS8I6x6doOoFx4DU+Ca45nPd/Pw6+iTFwDlw43bJ/P8HDuDiAuYE6EaAENcpYmTnq/n8/WcwYN2/cfz/H6886xcALOgJFUzhnY244/WcGNUj9fz9E4RA5f/ZMOBqspDmhnuI3lMCgOZcIqDmm938/G+lTO3uJ9DdwmLU22baCNpR0yThsMPs4l8ScOBb3fz+yxGAzD+dCNk0rgDaxIio35QnsOq2QODvigpg6","dtype":"float32","order":"little","shape":[51]}},"selected":{"id":"1464"},"selection_policy":{"id":"1463"}},"id":"1407","type":"ColumnDataSource"},{"attributes":{},"id":"1372","type":"HelpTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1394","type":"Line"},{"attributes":{},"id":"1387","type":"AllLabels"},{"attributes":{"active_multi":null,"active_scroll":{"id":"1368"},"tools":[{"id":"1367"},{"id":"1368"},{"id":"1369"},{"id":"1370"},{"id":"1371"},{"id":"1372"},{"id":"1374"}]},"id":"1375","type":"Toolbar"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1393","type":"Line"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1373","type":"BoxAnnotation"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1460"},"selection_policy":{"id":"1459"}},"id":"1397","type":"ColumnDataSource"},{"attributes":{"text":"Mouse over the dots"},"id":"1349","type":"Title"},{"attributes":{"formatter":{"id":"1389"},"major_label_policy":{"id":"1387"},"ticker":{"id":"1360"}},"id":"1359","type":"LinearAxis"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1462"},"selection_policy":{"id":"1461"}},"id":"1402","type":"ColumnDataSource"},{"attributes":{},"id":"1457","type":"UnionRenderers"},{"attributes":{"axis":{"id":"1359"},"ticker":null},"id":"1362","type":"Grid"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"80\" alt=\"@imgs\"\n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1374","type":"HoverTool"},{"attributes":{},"id":"1389","type":"BasicTickFormatter"},{"attributes":{},"id":"1458","type":"Selection"},{"attributes":{"data_source":{"id":"1402"},"glyph":{"id":"1403"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1404"},"view":{"id":"1406"}},"id":"1405","type":"GlyphRenderer"},{"attributes":{},"id":"1459","type":"UnionRenderers"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1409","type":"Circle"},{"attributes":{},"id":"1460","type":"Selection"},{"attributes":{"source":{"id":"1402"}},"id":"1406","type":"CDSView"},{"attributes":{},"id":"1462","type":"Selection"},{"attributes":{},"id":"1357","type":"LinearScale"},{"attributes":{"text":"black","text_align":"right","x":-1,"y":0},"id":"1413","type":"Label"},{"attributes":{},"id":"1368","type":"WheelZoomTool"},{"attributes":{},"id":"1371","type":"ResetTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1404","type":"Line"},{"attributes":{},"id":"1463","type":"UnionRenderers"},{"attributes":{},"id":"1351","type":"DataRange1d"},{"attributes":{},"id":"1461","type":"UnionRenderers"},{"attributes":{"overlay":{"id":"1373"}},"id":"1369","type":"BoxZoomTool"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1410","type":"Circle"},{"attributes":{},"id":"1464","type":"Selection"},{"attributes":{},"id":"1353","type":"DataRange1d"},{"attributes":{"data_source":{"id":"1392"},"glyph":{"id":"1393"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1394"},"view":{"id":"1396"}},"id":"1395","type":"GlyphRenderer"}],"root_ids":["1348"]},"title":"Bokeh Application","version":"2.3.2"}};
  var render_items = [{"docid":"7039a618-5686-42ce-b035-f03e38f69e68","root_ids":["1348"],"roots":{"1348":"c15801c5-c35c-483f-86ee-b3203604690e"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
<div class="cell-output cell-output-display">






  <div class="bk-root" id="7f542469-d911-4240-b40f-dbbcac43bd31" data-root-id="1545"></div>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"f24b21b5-769c-470e-b84e-30076a3731db":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1556"}],"center":[{"id":"1559"},{"id":"1563"},{"id":"1610"},{"id":"1611"},{"id":"1612"},{"id":"1613"}],"height":350,"left":[{"id":"1560"}],"renderers":[{"id":"1592"},{"id":"1597"},{"id":"1602"},{"id":"1608"}],"title":{"id":"1546"},"toolbar":{"id":"1572"},"width":400,"x_range":{"id":"1548"},"x_scale":{"id":"1552"},"y_range":{"id":"1550"},"y_scale":{"id":"1554"}},"id":"1545","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"1564","type":"PanTool"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1600","type":"Line"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1607","type":"Circle"},{"attributes":{"axis":{"id":"1556"},"ticker":null},"id":"1559","type":"Grid"},{"attributes":{"text":"black","text_align":"right","x":-1,"y":0},"id":"1610","type":"Label"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1671"},"selection_policy":{"id":"1670"}},"id":"1589","type":"ColumnDataSource"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1675"},"selection_policy":{"id":"1674"}},"id":"1599","type":"ColumnDataSource"},{"attributes":{},"id":"1565","type":"WheelZoomTool"},{"attributes":{"source":{"id":"1594"}},"id":"1598","type":"CDSView"},{"attributes":{"formatter":{"id":"1583"},"major_label_policy":{"id":"1581"},"ticker":{"id":"1561"}},"id":"1560","type":"LinearAxis"},{"attributes":{"data_source":{"id":"1589"},"glyph":{"id":"1590"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1591"},"view":{"id":"1593"}},"id":"1592","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1596","type":"Line"},{"attributes":{"axis":{"id":"1560"},"dimension":1,"ticker":null},"id":"1563","type":"Grid"},{"attributes":{"formatter":{"id":"1586"},"major_label_policy":{"id":"1584"},"ticker":{"id":"1557"}},"id":"1556","type":"LinearAxis"},{"attributes":{"data_source":{"id":"1604"},"glyph":{"id":"1606"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1607"},"view":{"id":"1609"}},"id":"1608","type":"GlyphRenderer"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1606","type":"Circle"},{"attributes":{},"id":"1561","type":"BasicTicker"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1590","type":"Line"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1601","type":"Line"},{"attributes":{"source":{"id":"1589"}},"id":"1593","type":"CDSView"},{"attributes":{"data_source":{"id":"1594"},"glyph":{"id":"1595"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1596"},"view":{"id":"1598"}},"id":"1597","type":"GlyphRenderer"},{"attributes":{"text":"grizzly","x":1,"y":0},"id":"1611","type":"Label"},{"attributes":{"overlay":{"id":"1570"}},"id":"1566","type":"BoxZoomTool"},{"attributes":{"text":"Epoch 2","x":-1,"y":0.95},"id":"1613","type":"Label"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1591","type":"Line"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1673"},"selection_policy":{"id":"1672"}},"id":"1594","type":"ColumnDataSource"},{"attributes":{},"id":"1581","type":"AllLabels"},{"attributes":{"active_multi":null,"active_scroll":{"id":"1565"},"tools":[{"id":"1564"},{"id":"1565"},{"id":"1566"},{"id":"1567"},{"id":"1568"},{"id":"1569"},{"id":"1571"}]},"id":"1572","type":"Toolbar"},{"attributes":{"text":"Mouse over the dots"},"id":"1546","type":"Title"},{"attributes":{},"id":"1583","type":"BasicTickFormatter"},{"attributes":{"text":"teddy","text_align":"center","x":0,"y":1},"id":"1612","type":"Label"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1595","type":"Line"},{"attributes":{"data":{"colors":["blue","red","blue","blue","green","red","blue","green","red","red","green","green","blue","green","red","blue","green","red","green","green","blue","red","blue","red","red","red","red","red","blue","green","red","green","red","green","green","blue","red","red","green","red","green","red","green","blue","green","green","green","green","green","red","red"],"desc":["teddy","black","teddy","teddy","grizzly","black","teddy","grizzly","black","black","grizzly","grizzly","teddy","grizzly","black","teddy","grizzly","black","grizzly","grizzly","teddy","black","teddy","black","black","black","black","black","teddy","grizzly","black","grizzly","black","grizzly","grizzly","teddy","black","black","grizzly","black","grizzly","black","grizzly","teddy","grizzly","grizzly","grizzly","grizzly","grizzly","black","black"],"imgs":["https://drive.google.com/uc?id=144UkVrxda4UfDaxzLAXpVeFK4qs6EQZq","https://drive.google.com/uc?id=13yrOC0bF05t16oeIHyd8jGcgc8vvFATn","https://drive.google.com/uc?id=13of7EO_C4Hycy7QVKhu8suQgrrgVREyo","https://drive.google.com/uc?id=13mqTpJ3Dgvif6LVqQWUe-lKkeF96UUf7","https://drive.google.com/uc?id=13ctTDS6PV80_IMSrdECv9xhqcx9LekrN","https://drive.google.com/uc?id=13VKKxGUJKRBUD2fWtX-e_Uf2npblNVyo","https://drive.google.com/uc?id=13MrycLyVxd7rUPE0nxFU-17UMUnFlRWe","https://drive.google.com/uc?id=13MpYou1FK5AcIkbAWWpeU8G0yJI_vjfh","https://drive.google.com/uc?id=13KAW9MNTa7HC72d1wfRy85OucPR6XYKP","https://drive.google.com/uc?id=13JOBr0dMSn6VkXBOhNu8XC30LP_UPMhL","https://drive.google.com/uc?id=13JACf5-bju0YJMETud3sa0fL2WJ3-Sxo","https://drive.google.com/uc?id=13DfS0f-VsYDKAIQnVs_PFHu-Hg06S-XM","https://drive.google.com/uc?id=13C4pfym-1VD9Dv5CX0EmLmBWamAR5bID","https://drive.google.com/uc?id=1393lLmOV6npis9P-P3-CqpklxJiPtrfT","https://drive.google.com/uc?id=12xcrhuANLFl_7rWtTxeP-tTLFJJGtBtD","https://drive.google.com/uc?id=15W1pgbK9IZmJTsGDkhGuiDkagbNSQTwi","https://drive.google.com/uc?id=15QyVVMztCGz27L353KIWMTGZB2ipyVv9","https://drive.google.com/uc?id=15GRZC6aNQp3F9elNGTj3ZaFllIm7dn8L","https://drive.google.com/uc?id=15A3xW0CxXwsjSxzzJcthgwTS_mpJGnQ2","https://drive.google.com/uc?id=152f9wYwVKh3fT0MvFNzn6rmQRAAUdztv","https://drive.google.com/uc?id=14y4xqLlWS_bHGE_Wlx28MGYmRdhVDufl","https://drive.google.com/uc?id=14xkVKUNuaH1OyrPwG9BAc2a53mcTkK-C","https://drive.google.com/uc?id=14vs_YJtcEVLXFLP6G4d_WBHb93j7fte_","https://drive.google.com/uc?id=14pwEYoKytVytNqeRJ38K2DmnautzTNh7","https://drive.google.com/uc?id=14h7T3R0t7iuemHzsK9nqGxVPoV2r7KwA","https://drive.google.com/uc?id=14_XerMk61NKlDRA3cS8wqTdgWcqPsJhf","https://drive.google.com/uc?id=14R6mpXVga4V73WJYO22vQZJ2l6dX7XII","https://drive.google.com/uc?id=14KSuyF3OjJGo3JrZ1QO2rxIP8SB5WiET","https://drive.google.com/uc?id=14FlfKzcIxfjULItQfyf5GYojA8YF9zz0","https://drive.google.com/uc?id=16qF8W_r9THgNSTFR9AM0wiqCBZsSQBjI","https://drive.google.com/uc?id=16pXsH15QFvcAy9rIwOMF21Xy3Sm86jtv","https://drive.google.com/uc?id=16ncOYapzN4Oa1agITkUOeaI2jJ7W_D3K","https://drive.google.com/uc?id=16gX21nGC2_BFLU2jIr0aZs9XcxBv4hhp","https://drive.google.com/uc?id=16c6ZkIoY7aU8bZxqWYOlSWVPmfUSd8lv","https://drive.google.com/uc?id=16_wzemGQyMtd_Mk3Idfzb0B96s7QLm87","https://drive.google.com/uc?id=16HLWDFM2qu0y4ySUeoZSLM3R1e-c9Lfl","https://drive.google.com/uc?id=16DbvqnFxb7fHMXP3x03ge0-wEGVgKIZt","https://drive.google.com/uc?id=1685ol1eECA_QPvxFBblcdbox8KoNtpxV","https://drive.google.com/uc?id=167YXnthhbu4AaavfhgM7M3gtWkZY5u-x","https://drive.google.com/uc?id=165r1wKFjrQL3NOk_RibnmcNtscxIv2fz","https://drive.google.com/uc?id=1656ybwpgt_pMLoQfHmvWb-tv00agMLAd","https://drive.google.com/uc?id=16-XVTd6xWZVZktb1R5RUsCakzqAKxAZb","https://drive.google.com/uc?id=15z05LH4y9it2CdTqcClWgVcSQQzTosGq","https://drive.google.com/uc?id=15vVLOCk2RIITHCKwAxJggZktY9TWl2p-","https://drive.google.com/uc?id=15sHZbU7JwqdEtobOCZu5YMnWSBRHjUyb","https://drive.google.com/uc?id=15qAdiVC3llbsfFJjsjVf7QHLkSHQbDSn","https://drive.google.com/uc?id=15eofsGgA-vlxuGziwACvOhhT4OUwaVKT","https://drive.google.com/uc?id=15axvmV1j-yIGnm_gXn-1wJQzGn-iA3VO","https://drive.google.com/uc?id=15_XXXfq312Bpv9tozpVy-ECwuxLYyfDo","https://drive.google.com/uc?id=15Y4dez3TvNlYfBkLo2reCCpY7l6nvA8h","https://drive.google.com/uc?id=15XWnZAzesjUWfe0hXRQgwwBr5jARRck8"],"x":{"__ndarray__":"mVXwOB57d7+U+jk4iZriOqz/fz/ioH6//QsMN5Hufz/Bc3e/pEVBv/3/fz/yo38/M0PoN///fz/A63S/FFLJOcORfz+MT3+/9P9/P4z7fz+08vU2XtZ/vw8Rnjmd1H+/4Nx/v9bffb8yz1i/1/t/v3yeLDczrn8/VEd/v9g7fz85/n+/1v5/P//6fz8dNO4308d2v+znf78a/X8/mpMHPxb3fz/KiXi/4+x/PyuMjzj//38/E/9/P/v/fz+Ou38/sPJ/P5CqK73Duna/","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"dPh/Pzh1GTYA/X8/jo5/P30qgzSF86g2vP5/P9P7BDX5UxY6bDnHOcZyETQv/4g4KP5/P3zfzi6rj5E3E+R/PzkXuzdpLQA6nJa9MsfoBziE/38/MzuDNgTsfz/j9co5EfkAOdBovTflTrQ3qwaZNCj/fz8KFAg4aP9GN4iVFjnxA442/ZKLNy9ghzgc/n8/bwE5OqBJDjf5No01cFYVNrRFnDeHqNQ3rw97N3j7fz82neYwwnXRNFPvYTRU6IA27ZlQOcz6vzrPQCk6","dtype":"float32","order":"little","shape":[51]}},"selected":{"id":"1677"},"selection_policy":{"id":"1676"}},"id":"1604","type":"ColumnDataSource"},{"attributes":{},"id":"1568","type":"ResetTool"},{"attributes":{},"id":"1670","type":"UnionRenderers"},{"attributes":{"source":{"id":"1599"}},"id":"1603","type":"CDSView"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1570","type":"BoxAnnotation"},{"attributes":{},"id":"1672","type":"UnionRenderers"},{"attributes":{},"id":"1552","type":"LinearScale"},{"attributes":{},"id":"1567","type":"SaveTool"},{"attributes":{},"id":"1586","type":"BasicTickFormatter"},{"attributes":{},"id":"1673","type":"Selection"},{"attributes":{},"id":"1554","type":"LinearScale"},{"attributes":{},"id":"1674","type":"UnionRenderers"},{"attributes":{},"id":"1548","type":"DataRange1d"},{"attributes":{},"id":"1584","type":"AllLabels"},{"attributes":{"data_source":{"id":"1599"},"glyph":{"id":"1600"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1601"},"view":{"id":"1603"}},"id":"1602","type":"GlyphRenderer"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"80\" alt=\"@imgs\"\n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1571","type":"HoverTool"},{"attributes":{},"id":"1675","type":"Selection"},{"attributes":{},"id":"1676","type":"UnionRenderers"},{"attributes":{},"id":"1550","type":"DataRange1d"},{"attributes":{},"id":"1569","type":"HelpTool"},{"attributes":{},"id":"1671","type":"Selection"},{"attributes":{},"id":"1677","type":"Selection"},{"attributes":{},"id":"1557","type":"BasicTicker"},{"attributes":{"source":{"id":"1604"}},"id":"1609","type":"CDSView"}],"root_ids":["1545"]},"title":"Bokeh Application","version":"2.3.2"}};
  var render_items = [{"docid":"f24b21b5-769c-470e-b84e-30076a3731db","root_ids":["1545"],"roots":{"1545":"7f542469-d911-4240-b40f-dbbcac43bd31"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
<div class="cell-output cell-output-display">






  <div class="bk-root" id="14dee29f-bee9-4779-a7a0-ebd2119622e3" data-root-id="1758"></div>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"eaf6a57b-5608-439a-9d46-d72b6026e3ef":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1769"}],"center":[{"id":"1772"},{"id":"1776"},{"id":"1823"},{"id":"1824"},{"id":"1825"},{"id":"1826"}],"height":350,"left":[{"id":"1773"}],"renderers":[{"id":"1805"},{"id":"1810"},{"id":"1815"},{"id":"1821"}],"title":{"id":"1759"},"toolbar":{"id":"1785"},"width":400,"x_range":{"id":"1761"},"x_scale":{"id":"1765"},"y_range":{"id":"1763"},"y_scale":{"id":"1767"}},"id":"1758","subtype":"Figure","type":"Plot"},{"attributes":{"formatter":{"id":"1799"},"major_label_policy":{"id":"1797"},"ticker":{"id":"1770"}},"id":"1769","type":"LinearAxis"},{"attributes":{"data_source":{"id":"1817"},"glyph":{"id":"1819"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1820"},"view":{"id":"1822"}},"id":"1821","type":"GlyphRenderer"},{"attributes":{},"id":"1796","type":"BasicTickFormatter"},{"attributes":{},"id":"1770","type":"BasicTicker"},{"attributes":{},"id":"1763","type":"DataRange1d"},{"attributes":{"source":{"id":"1807"}},"id":"1811","type":"CDSView"},{"attributes":{"text":"grizzly","x":1,"y":0},"id":"1824","type":"Label"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1808","type":"Line"},{"attributes":{"text":"Epoch 3","x":-1,"y":0.95},"id":"1826","type":"Label"},{"attributes":{"active_multi":null,"active_scroll":{"id":"1778"},"tools":[{"id":"1777"},{"id":"1778"},{"id":"1779"},{"id":"1780"},{"id":"1781"},{"id":"1782"},{"id":"1784"}]},"id":"1785","type":"Toolbar"},{"attributes":{},"id":"1794","type":"AllLabels"},{"attributes":{"data_source":{"id":"1807"},"glyph":{"id":"1808"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1809"},"view":{"id":"1811"}},"id":"1810","type":"GlyphRenderer"},{"attributes":{"data":{"colors":["blue","red","blue","blue","green","red","blue","green","red","red","green","green","blue","green","red","blue","green","red","green","green","blue","red","blue","red","red","red","red","red","blue","green","red","green","red","green","green","blue","red","red","green","red","green","red","green","blue","green","green","green","green","green","red","red"],"desc":["teddy","black","teddy","teddy","grizzly","black","teddy","grizzly","black","black","grizzly","grizzly","teddy","grizzly","black","teddy","grizzly","black","grizzly","grizzly","teddy","black","teddy","black","black","black","black","black","teddy","grizzly","black","grizzly","black","grizzly","grizzly","teddy","black","black","grizzly","black","grizzly","black","grizzly","teddy","grizzly","grizzly","grizzly","grizzly","grizzly","black","black"],"imgs":["https://drive.google.com/uc?id=144UkVrxda4UfDaxzLAXpVeFK4qs6EQZq","https://drive.google.com/uc?id=13yrOC0bF05t16oeIHyd8jGcgc8vvFATn","https://drive.google.com/uc?id=13of7EO_C4Hycy7QVKhu8suQgrrgVREyo","https://drive.google.com/uc?id=13mqTpJ3Dgvif6LVqQWUe-lKkeF96UUf7","https://drive.google.com/uc?id=13ctTDS6PV80_IMSrdECv9xhqcx9LekrN","https://drive.google.com/uc?id=13VKKxGUJKRBUD2fWtX-e_Uf2npblNVyo","https://drive.google.com/uc?id=13MrycLyVxd7rUPE0nxFU-17UMUnFlRWe","https://drive.google.com/uc?id=13MpYou1FK5AcIkbAWWpeU8G0yJI_vjfh","https://drive.google.com/uc?id=13KAW9MNTa7HC72d1wfRy85OucPR6XYKP","https://drive.google.com/uc?id=13JOBr0dMSn6VkXBOhNu8XC30LP_UPMhL","https://drive.google.com/uc?id=13JACf5-bju0YJMETud3sa0fL2WJ3-Sxo","https://drive.google.com/uc?id=13DfS0f-VsYDKAIQnVs_PFHu-Hg06S-XM","https://drive.google.com/uc?id=13C4pfym-1VD9Dv5CX0EmLmBWamAR5bID","https://drive.google.com/uc?id=1393lLmOV6npis9P-P3-CqpklxJiPtrfT","https://drive.google.com/uc?id=12xcrhuANLFl_7rWtTxeP-tTLFJJGtBtD","https://drive.google.com/uc?id=15W1pgbK9IZmJTsGDkhGuiDkagbNSQTwi","https://drive.google.com/uc?id=15QyVVMztCGz27L353KIWMTGZB2ipyVv9","https://drive.google.com/uc?id=15GRZC6aNQp3F9elNGTj3ZaFllIm7dn8L","https://drive.google.com/uc?id=15A3xW0CxXwsjSxzzJcthgwTS_mpJGnQ2","https://drive.google.com/uc?id=152f9wYwVKh3fT0MvFNzn6rmQRAAUdztv","https://drive.google.com/uc?id=14y4xqLlWS_bHGE_Wlx28MGYmRdhVDufl","https://drive.google.com/uc?id=14xkVKUNuaH1OyrPwG9BAc2a53mcTkK-C","https://drive.google.com/uc?id=14vs_YJtcEVLXFLP6G4d_WBHb93j7fte_","https://drive.google.com/uc?id=14pwEYoKytVytNqeRJ38K2DmnautzTNh7","https://drive.google.com/uc?id=14h7T3R0t7iuemHzsK9nqGxVPoV2r7KwA","https://drive.google.com/uc?id=14_XerMk61NKlDRA3cS8wqTdgWcqPsJhf","https://drive.google.com/uc?id=14R6mpXVga4V73WJYO22vQZJ2l6dX7XII","https://drive.google.com/uc?id=14KSuyF3OjJGo3JrZ1QO2rxIP8SB5WiET","https://drive.google.com/uc?id=14FlfKzcIxfjULItQfyf5GYojA8YF9zz0","https://drive.google.com/uc?id=16qF8W_r9THgNSTFR9AM0wiqCBZsSQBjI","https://drive.google.com/uc?id=16pXsH15QFvcAy9rIwOMF21Xy3Sm86jtv","https://drive.google.com/uc?id=16ncOYapzN4Oa1agITkUOeaI2jJ7W_D3K","https://drive.google.com/uc?id=16gX21nGC2_BFLU2jIr0aZs9XcxBv4hhp","https://drive.google.com/uc?id=16c6ZkIoY7aU8bZxqWYOlSWVPmfUSd8lv","https://drive.google.com/uc?id=16_wzemGQyMtd_Mk3Idfzb0B96s7QLm87","https://drive.google.com/uc?id=16HLWDFM2qu0y4ySUeoZSLM3R1e-c9Lfl","https://drive.google.com/uc?id=16DbvqnFxb7fHMXP3x03ge0-wEGVgKIZt","https://drive.google.com/uc?id=1685ol1eECA_QPvxFBblcdbox8KoNtpxV","https://drive.google.com/uc?id=167YXnthhbu4AaavfhgM7M3gtWkZY5u-x","https://drive.google.com/uc?id=165r1wKFjrQL3NOk_RibnmcNtscxIv2fz","https://drive.google.com/uc?id=1656ybwpgt_pMLoQfHmvWb-tv00agMLAd","https://drive.google.com/uc?id=16-XVTd6xWZVZktb1R5RUsCakzqAKxAZb","https://drive.google.com/uc?id=15z05LH4y9it2CdTqcClWgVcSQQzTosGq","https://drive.google.com/uc?id=15vVLOCk2RIITHCKwAxJggZktY9TWl2p-","https://drive.google.com/uc?id=15sHZbU7JwqdEtobOCZu5YMnWSBRHjUyb","https://drive.google.com/uc?id=15qAdiVC3llbsfFJjsjVf7QHLkSHQbDSn","https://drive.google.com/uc?id=15eofsGgA-vlxuGziwACvOhhT4OUwaVKT","https://drive.google.com/uc?id=15axvmV1j-yIGnm_gXn-1wJQzGn-iA3VO","https://drive.google.com/uc?id=15_XXXfq312Bpv9tozpVy-ECwuxLYyfDo","https://drive.google.com/uc?id=15Y4dez3TvNlYfBkLo2reCCpY7l6nvA8h","https://drive.google.com/uc?id=15XWnZAzesjUWfe0hXRQgwwBr5jARRck8"],"x":{"__ndarray__":"C3OsOKNXe7+lo8I3ufmEOrz/fz/SRn+/P/O4Nhbwfz8uYXq/jAtsv/3/fz/orX8/uBFwNwAAgD9VkXy/i/Z4ObuHfz8WqX+/+P9/Pwr8fz8D9L82Y/B/vzZCPjmo7H+/4PF/v08mf78qv2q/oP5/v3pK1jYToH8/9cJ/v9iKfj99/3+/1v5/Px75fz+U4HQ3ME9+vxH3f79M/X8/OFSXPSr3fz+z532/be5/P+EEVzj//38/BP9/P/z/fz8AnH8/u/V/P/5fgL4xPXu/","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"lPp/P3LlBTZu/n8/Z71/P7UOlTRAshU35P5/PzCd1jRMx885EI2JORy6FTQitaA4DP9/P02/qC7EmUU31e1/P+z4zDfdSJI5ZkhsMnYEyTeg/38/Vx03Nuvzfz9y9mU5RfCpOOLOljdTyas3o0uMNGL/fz/amjM4J5H1Nkepnjm4vvk1ZUuJNwHXwDgG/38/jeajOV5FyTaeML417oJ4NhMWnzdChjg37RG4N5z8fz+0uMkwVbgKNTeKLzSFzd8207ohOfl7xTpVNvM5","dtype":"float32","order":"little","shape":[51]}},"selected":{"id":"1906"},"selection_policy":{"id":"1905"}},"id":"1817","type":"ColumnDataSource"},{"attributes":{},"id":"1778","type":"WheelZoomTool"},{"attributes":{"source":{"id":"1802"}},"id":"1806","type":"CDSView"},{"attributes":{"text":"teddy","text_align":"center","x":0,"y":1},"id":"1825","type":"Label"},{"attributes":{},"id":"1780","type":"SaveTool"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1813","type":"Line"},{"attributes":{"source":{"id":"1812"}},"id":"1816","type":"CDSView"},{"attributes":{"formatter":{"id":"1796"},"major_label_policy":{"id":"1794"},"ticker":{"id":"1774"}},"id":"1773","type":"LinearAxis"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1904"},"selection_policy":{"id":"1903"}},"id":"1812","type":"ColumnDataSource"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1803","type":"Line"},{"attributes":{},"id":"1799","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1804","type":"Line"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1783","type":"BoxAnnotation"},{"attributes":{},"id":"1900","type":"Selection"},{"attributes":{},"id":"1761","type":"DataRange1d"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1809","type":"Line"},{"attributes":{},"id":"1901","type":"UnionRenderers"},{"attributes":{"axis":{"id":"1769"},"ticker":null},"id":"1772","type":"Grid"},{"attributes":{"overlay":{"id":"1783"}},"id":"1779","type":"BoxZoomTool"},{"attributes":{},"id":"1797","type":"AllLabels"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1902"},"selection_policy":{"id":"1901"}},"id":"1807","type":"ColumnDataSource"},{"attributes":{},"id":"1902","type":"Selection"},{"attributes":{},"id":"1777","type":"PanTool"},{"attributes":{},"id":"1899","type":"UnionRenderers"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1814","type":"Line"},{"attributes":{},"id":"1903","type":"UnionRenderers"},{"attributes":{},"id":"1767","type":"LinearScale"},{"attributes":{},"id":"1781","type":"ResetTool"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1819","type":"Circle"},{"attributes":{"text":"Mouse over the dots"},"id":"1759","type":"Title"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1900"},"selection_policy":{"id":"1899"}},"id":"1802","type":"ColumnDataSource"},{"attributes":{},"id":"1904","type":"Selection"},{"attributes":{},"id":"1782","type":"HelpTool"},{"attributes":{},"id":"1774","type":"BasicTicker"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"80\" alt=\"@imgs\"\n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1784","type":"HoverTool"},{"attributes":{},"id":"1905","type":"UnionRenderers"},{"attributes":{"data_source":{"id":"1812"},"glyph":{"id":"1813"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1814"},"view":{"id":"1816"}},"id":"1815","type":"GlyphRenderer"},{"attributes":{"axis":{"id":"1773"},"dimension":1,"ticker":null},"id":"1776","type":"Grid"},{"attributes":{"source":{"id":"1817"}},"id":"1822","type":"CDSView"},{"attributes":{},"id":"1906","type":"Selection"},{"attributes":{"data_source":{"id":"1802"},"glyph":{"id":"1803"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1804"},"view":{"id":"1806"}},"id":"1805","type":"GlyphRenderer"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1820","type":"Circle"},{"attributes":{"text":"black","text_align":"right","x":-1,"y":0},"id":"1823","type":"Label"},{"attributes":{},"id":"1765","type":"LinearScale"}],"root_ids":["1758"]},"title":"Bokeh Application","version":"2.3.2"}};
  var render_items = [{"docid":"eaf6a57b-5608-439a-9d46-d72b6026e3ef","root_ids":["1758"],"roots":{"1758":"14dee29f-bee9-4779-a7a0-ebd2119622e3"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
</div>
<p>Depending on which bear images get scraped on which day, even this may be trivially easy. When I ran this above, there was only one error: a tiny brown-colored bear cub that was classified by the model as grizzly but that was labeled (via DuckDuckGo) as a black bear. All the other points correctly “collapsed” very quickly nearly the poles.</p>
<p>If we look at the confusion matrix, we’ll see (for the time I ran this), only the one error mentioned above:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">interp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ClassificationInterpretation.from_learner(learn)</span>
<span id="cb7-2">interp.plot_confusion_matrix()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>And if we plot the top losses, we’ll see (based on mousing-over in the triangle plot above) the images for the points furthest from the poles: first the mislabeled cub, then a grizzly mother and cub, then a teddy bear:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">interp.plot_top_losses(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>When I ran this, the top loss image was actually a small dog! I coulda/shoulda checked that above in the triangle plot!</p>
<p>We’re not going to train this more or clean the dataset, instead let’s just remember that in this case, <strong>for 3 classes our error rate was 0.019608 </strong>(= 1/51, i.e.&nbsp;1 error out of 51 images in the validation set), i.e.&nbsp;we were ~98% accurate.</p>
</section>
<section id="four-classes" class="level3">
<h3 class="anchored" data-anchor-id="four-classes">Four Classes</h3>
<p>Let’s add one more bear to the mix, the “spectacled bear”, and repeat this process, and visualize in 3D (sadly no image thumbnail mouseovers for 3D plots). First we’ll download and look at what we’ve got..</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grizzly'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'teddy'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'spectacled'</span></span>
<span id="cb9-2">scrape_for_me(dl_path, [labels[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], search_suffix, erase_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># download one more class</span></span>
<span id="cb9-3">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_dls(path)</span>
<span id="cb9-4">dls.show_batch()  </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spectacled bear: Got 100 image URLs. Downloading...
   urls =  ['http://4.bp.blogspot.com/-6xZLUXHh8Uc/UUxmEy9QZBI/AAAAAAAAXcY/TMXg3WwS3GA/s1600/Spectacled+Bear+2.jpg', 'https://www.coolearth.org/wp-content/uploads/2016/06/Spectacled-Bear-2.jpg', 'http://3.bp.blogspot.com/-Sg8TmR5qh88/UUxmNY4d0HI/AAAAAAAAXcw/dpL2qFHZvp0/s1600/Spectacled+Bear+5.jpg', 'https://i.natgeofe.com/n/804d9cdb-f8da-449a-93b0-aac7a448b7c0/spectacled-bear_thumb.JPG?w=1200', 'https://www.activewild.com/wp-content/uploads/2018/03/spectacled-bears-1024x683.jpg', 'http://www.rainforest-alliance.org/sites/default/files/2016-09/spectacled-bear-header.jpg', 'https://lh6.googleusercontent.com/-Sptgd7fYIqY/TYk4YVRbndI/AAAAAAAAB7E/MYqqcMu-isw/s1600/Spectacled_Bear_Tennoji_2.jpg', 'https://www.vanwageningen.net/i/upload/2014/10/29/20141029132015-bc5e40e5-me.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-1002804-spectacled-bear-face.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear.jpg', 'https://colombiareports.com/wp-content/uploads/2017/07/spectacled_bear.jpg', 'http://tenrandomfacts.com/wp-content/uploads/2016/07/Spectacled-Bear.jpg', 'https://static1.squarespace.com/static/56a1a14b05caa7ee9f26f47d/t/57390f5520c6471cf068c6cc/1463357302812/', 'http://theamazonianassignment.weebly.com/uploads/1/2/1/3/12136910/944137409_orig.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-ecuadorian-andes-mountains-328x562.jpg?c14113', 'http://i1.treknature.com/photos/2959/bear_0111111.jpg', 'http://2.bp.blogspot.com/-vdZv8wGWMdo/UUxmNCvsvhI/AAAAAAAAXco/H5Pzgk5dtOk/s1600/Spectacled+Bear+6.jpg', 'https://media.sciencephoto.com/image/c0175188/800wm/C0175188-Spectacled_Bear.jpg', 'http://www.stlzoo.org/files/1014/0017/1158/ANDEANBEAR9410WINKELMAN2.jpg', 'https://www.tourradar.com/days-to-come/wp-content/uploads/2016/01/Spectacled-bear.jpg', 'https://www.zoochat.com/community/media/spectacled-bear.250657/full?d=1393011952', 'http://2.bp.blogspot.com/-1jh4WfVEyx4/T_A-OoNHGFI/AAAAAAAAMHM/Wm41l9WFfgs/s1600/Spectacled+Bear3.jpg', 'http://www.rainforest-alliance.org/sites/default/files/styles/750w_585h/public/2016-09/spectacled-bear-header.jpg?itok=0V7_KGpe', 'https://www.sustainability-times.com/wp-content/uploads/2019/06/AndeanBear_ZN.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Habitat.jpg', 'http://seethewild.org/wp-content/uploads/2016/05/features.jpeg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/spectacled-bear-portrait-rose-santuci-sofranko.jpg', 'http://kids.sandiegozoo.org/sites/default/files/2017-07/andean-bear-tree.jpg', 'https://southafricatoday.net/wp-content/uploads/2018/07/1532665810_1-1024x1000.jpg', 'https://upload.wikimedia.org/wikipedia/en/c/ce/Spectacled-bear.jpg', 'http://4.bp.blogspot.com/-zHQPWNws7VQ/TwK7vuoleYI/AAAAAAAAEuI/iZJGb0R9CEQ/s1600/spectacled_bear-spectacled_bear.jpg', 'http://www.ecns.cn/hd/2020/05/18/e41ef93a186c40a38726189b8901f6f3.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Baby-Spectacled-Bear.jpg', 'http://www.mammalwatching.com/wp-content/uploads/2018/01/EC-square-fox.jpg', 'http://newyorktrendnyc.com/wp-content/uploads/2013/11/andean-bear.jpg', 'https://home.bt.com/images/spectacled-bears-and-snow-leopards-among-creatures-getting-funding-boost-136427641293802601-180606124211.jpg', 'https://nationalzoo.si.edu/sites/default/files/animals/andeanbear-006.jpg', 'https://www.pitara.com/wordpress/wp-content/uploads/2001/02/spectacled-bear.jpg', 'http://3.bp.blogspot.com/-EGI8NqbPcvo/UUxmUJ6t1qI/AAAAAAAAXdA/fDUqD60Tv00/s1600/Spectacled+Bear.jpg', 'https://lh6.googleusercontent.com/-cc05A4QkDxc/TYk4S3w1qFI/AAAAAAAAB7A/3vb0t85A7GU/s1600/spectacled_bear_03.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-rocks-820x545.jpg?c14113', 'https://i.ytimg.com/vi/VXFIYIQgEkg/maxresdefault.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-71192249-spectacled-bear.jpg', 'https://farm3.staticflickr.com/2913/14137750328_d101997a4c_z.jpg', 'http://www.realworldholidays.co.uk/blog/wp-content/uploads/2015/12/spectacled-bear1.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-2.jpg', 'http://upload.wikimedia.org/wikipedia/commons/6/62/Spectacled_Bear_059.jpg', 'https://media.nbcwashington.com/2019/09/4621594915_9022bfd814_b.jpg?fit=1024%2C702', 'https://philadelphiazoo.org/wp-content/uploads/2019/10/Andean.SpectacledBear_Rosie_3395.jpg', 'http://2.bp.blogspot.com/-4bGjmY9K4pk/T_A-Yq5aNGI/AAAAAAAAMHc/pv9gEJ8O6Uo/s1600/Spectacled+Bear5.jpg', 'https://resize.hswstatic.com/w_907/gif/types-of-spectacled-bear0.jpg', 'http://1.bp.blogspot.com/-xGs4-W-3iSY/TjaZG6_XnOI/AAAAAAAABUE/AkEJ97L1HQc/s1600/156521.jpg', 'https://www.robertharding.com/watermark.php?type=preview&amp;im=RM/RH/HORIZONTAL/1127-12838', 'https://i.pinimg.com/736x/fa/40/33/fa403340878f175322c07b860b9d6426--spectacled-bear-bolivia.jpg', 'http://img.izismile.com/img/img3/20100513/640/cute_spectacled_bear_640_03.jpg', 'https://ourplnt.com/wp-content/uploads/2016/03/Spectacled-bear.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/3956278926_328d1c6a54_o.jpg', 'http://cincinnatizoo.org/system/assets/uploads/2014/02/spectaculed-bear.jpg', 'http://3.bp.blogspot.com/-brSuqjGOIG0/URGtpFtyo_I/AAAAAAAAARg/vLE13RVoCsk/s1600/spectacled-bear.jpg', 'https://c2.staticflickr.com/2/1501/24144684635_73b9e79d88_b.jpg', 'https://critter.science/wp-content/uploads/2019/05/sb1.jpg', 'https://srcnaut.com/cdn-cgi/image/f=auto,fit=crop,g=0.5x0.5,w=2000,h=1125,q=90,d=1/upload/32/02/df/shutterstock-1188627676.jpg', 'http://seethewild.org/wp-content/uploads/2016/05/dreamstime_15373008-1.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Spectacled_Bear_-_Houston_Zoo.jpg/1200px-Spectacled_Bear_-_Houston_Zoo.jpg', 'https://www.zoochat.com/community/media/spectacled-bear-at-chester-15-07-12.192796/full?d=1342391273', 'https://res.cloudinary.com/dk-find-out/image/upload/q_80,w_1440,f_auto/MA_00155387_i4leyu.jpg', 'http://2.bp.blogspot.com/-PQGmVUDZAhs/TwK5urRX1LI/AAAAAAAAEtw/s569QHCcx8Y/s1600/spectacled+bear.jpg', 'https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2865567/db2b44df10ba2a567a8e5cc34ddfeed0_original.JPG', 'http://etc.usf.edu/clippix/pix/spectacled-bear-with-piece-of-food-in-its-mouth_medium.jpg', 'https://www.activewild.com/wp-content/uploads/2018/03/spectacled-bear-standing-768x1024.jpg', 'http://2.bp.blogspot.com/-1mdQ66udYmw/T_A-UjaJk5I/AAAAAAAAMHU/uJw0kPcz1vc/s1600/Spectacled+Bear4.jpg', 'https://www.worldatlas.com/upload/43/04/5c/shutterstock-92656222-min.jpg', 'https://www.si.edu/sites/default/files/newsdesk/photos/andean-bear.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-ogimage.jpg', 'https://images.freeimages.com/images/large-previews/e0f/spectacled-bear-1561333.jpg', 'https://kentattractions.co.uk/wp-content/uploads/2016/09/Spectacled-Bear.jpg', 'http://gringosabroad.com/wp-content/uploads/2013/11/Male-Andean-Bear-face.jpg', 'https://rangerplanet.com/wp-content/uploads/2019/10/spectacled-bear.jpg', 'https://www.wisebirding.co.uk/wp-content/uploads/Spectacled-Bear.jpg', 'https://i.ytimg.com/vi/2TmnhBSyQoo/maxresdefault.jpg', 'https://vistapointe.net/images/spectacled-bear-5.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-tree-820x513.jpg?d8bc0c', 'https://standfirst-whitleyaward-production.imgix.net/content/uploads/1996/12/18134457/Tremarctos_ornatus_portrait.jpg?auto=compress,enhance,format&amp;crop=faces,entropy,edges&amp;fit=crop&amp;fm=pjpg&amp;w=1866&amp;h=1400', 'https://c1.staticflickr.com/7/6037/6304684676_8fe4be5717_b.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/5566818433_9c994ec063_o.jpg', 'https://www.bwallpaperhd.com/wp-content/uploads/2018/12/SpectacledBear.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-eating-fruit.jpg', 'https://images.fineartamerica.com/images-medium-large-5/andean-bear-spectacled-bear-houston-zoo-tessa-fairey.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-598140-spectacled-bear.jpg', 'http://magarticles.magzter.com/articles/8803/216564/58e38ecbbeeb4/Conservation-Insight-Andean-Bear.jpg', 'http://www.rainforest-alliance.org/sites/default/files/styles/large/public/2016-09/spectacled-bear.jpg?itok=BXWidYtz', 'https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2865571/a3195154ccdac7c9efcbed5727462346_original.JPG', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-in-the-Wild.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/6862037661_30664cf53f_o.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Eating.jpg', 'http://2.bp.blogspot.com/-3UzekS1270M/TiAwko0VrQI/AAAAAAAAAKI/rOXYR8LXLHM/s1600/spectacled_bear_3.jpg', 'https://i.pinimg.com/736x/d2/99/fa/d299fa76c3d1a5c0e017514b086ddd9c--spectacled-bear-teddy-bears.jpg', 'https://c2.staticflickr.com/4/3685/8852797884_8f3a84d84c_b_d.jpg', 'http://www.kidzone.ws/lw/bears/images/spectacled-bear.jpg', 'https://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Images.jpg']
    Images downloaded.
After checking images for issues, 348 (total) images remain.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Then we’ll train the model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cnn_learner(dls, resnet18, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[error_rate])</span>
<span id="cb11-2">learn.fine_tune(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>VizPreds)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fine_tune does 1 epoch 'frozen', then as many more epochs you specify</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.685202</td>
<td>0.791340</td>
<td>0.275362</td>
<td>00:16</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 0: Plotting 69 (= 69?) points:
Epoch 0: Plotting 69 (= 69?) points:
Epoch 1: Plotting 69 (= 69?) points:
Epoch 2: Plotting 69 (= 69?) points:
Epoch 3: Plotting 69 (= 69?) points:</code></pre>
</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="49f3e28a-1f48-4e97-b8a6-a992492e9a32" class="plotly-graph-div" style="height:525px; width:700px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("49f3e28a-1f48-4e97-b8a6-a992492e9a32")) {
                    Plotly.newPlot(
                        '49f3e28a-1f48-4e97-b8a6-a992492e9a32',
                        [{"hovertext": ["black", "grizzly", "spectacled", "teddy", "black", "spectacled", "grizzly", "spectacled", "grizzly", "spectacled", "grizzly", "teddy", "black", "grizzly", "grizzly", "teddy", "spectacled", "grizzly", "grizzly", "spectacled", "black", "black", "black", "teddy", "spectacled", "teddy", "grizzly", "spectacled", "teddy", "spectacled", "black", "spectacled", "teddy", "grizzly", "black", "spectacled", "spectacled", "spectacled", "teddy", "black", "grizzly", "teddy", "grizzly", "black", "black", "black", "black", "grizzly", "grizzly", "grizzly", "grizzly", "spectacled", "grizzly", "black", "spectacled", "spectacled", "black", "grizzly", "teddy", "spectacled", "spectacled", "teddy", "teddy", "spectacled", "grizzly", "grizzly", "black", "teddy", "teddy", "black", "grizzly", "teddy", "spectacled"], "marker": {"color": ["red", "green", "blue", "orange", "red", "blue", "green", "blue", "green", "blue", "green", "orange", "red", "green", "green", "orange", "blue", "green", "green", "blue", "red", "red", "red", "orange", "blue", "orange", "green", "blue", "orange", "blue", "red", "blue", "orange", "green", "red", "blue", "blue", "blue", "orange", "red", "green", "orange", "green", "red", "red", "red", "red", "green", "green", "green", "green", "blue", "green", "red", "blue", "blue", "red", "green", "orange", "blue", "blue", "orange", "orange", "blue", "green", "green", "red", "orange", "orange", "red", "green", "orange", "blue"], "opacity": 0.6, "size": 5}, "mode": "markers", "type": "scatter3d", "x": [-0.7370690107345581, 0.06138782575726509, 0.002662815386429429, 0.6730183959007263, -0.7349777817726135, -0.6854103207588196, 0.05239170417189598, -0.010724496096372604, -0.4102674424648285, -0.20792701840400696, 0.022178616374731064, 0.5380143523216248, -0.7369385957717896, 0.25062137842178345, -0.2797873616218567, 0.6728650331497192, -0.05547712743282318, 0.03215255215764046, -0.3494768440723419, -0.46641528606414795, -0.7106611132621765, -0.7366750240325928, -0.7143970131874084, 0.6729375720024109, -0.7118181586265564, 0.6601531505584717, -0.2856457829475403, -0.6440808773040771, 0.6729893684387207, -0.526488184928894, -0.5503164529800415, -0.7011440396308899, 0.6729130148887634, -0.3679543435573578, -0.7292075753211975, -0.7301070690155029, -0.27190524339675903, -0.6208845376968384, 0.6663424968719482, -0.7316058874130249, -0.3266999125480652, 0.671872615814209, -0.18102119863033295, -0.7063194513320923, -0.6046302914619446, -0.7331517338752747, -0.7368736267089844, 0.028705159202218056, -0.4681691527366638, -0.2243470698595047, -0.31888166069984436, -0.4983426332473755, 0.01947823166847229, -0.7366974353790283, -0.019891539588570595, -0.32532647252082825, -0.7314629554748535, -0.6992747187614441, 0.6723673939704895, -0.7243182063102722, -0.718376874923706, 0.6730183959007263, 0.6718721985816956, -0.31043267250061035, -0.1638522744178772, -0.3909546434879303, -0.7368005514144897, 0.6729675531387329, 0.6729944944381714, -0.7361700534820557, -0.09379120171070099, 0.672858715057373, -0.7356022596359253], "y": [-0.38622117042541504, 0.7715229392051697, 0.10847767442464828, -0.4937794506549835, -0.3847973942756653, -0.34846705198287964, 0.7575398683547974, 0.12270158529281616, 0.08006928861141205, -0.03972814604640007, 0.7114587426185608, -0.21931013464927673, -0.38607800006866455, 0.17672199010849, 0.2365012764930725, -0.4937454164028168, 0.0706266388297081, 0.7241172194480896, 0.12723302841186523, -0.206024631857872, -0.3537238538265228, -0.38583847880363464, -0.36047011613845825, -0.4937012493610382, -0.37344950437545776, -0.4833097457885742, 0.24748943746089935, -0.2768216133117676, -0.49374207854270935, -0.24421747028827667, -0.12252397835254669, -0.3599107265472412, -0.493578165769577, 0.10577211529016495, -0.3791164755821228, -0.3821796178817749, -0.07375489175319672, -0.3074116110801697, -0.48470500111579895, -0.38024914264678955, 0.1891935020685196, -0.49354448914527893, 0.3887820243835449, -0.3656482696533203, -0.201121523976326, -0.3834598660469055, -0.38608694076538086, 0.7162643671035767, -0.045943792909383774, 0.24813781678676605, 0.16889315843582153, -0.22702942788600922, 0.7010002136230469, -0.3857589066028595, 0.09417011588811874, -0.12322045862674713, -0.3814030587673187, -0.34288138151168823, -0.49286407232284546, -0.37769851088523865, -0.37360239028930664, -0.49377942085266113, -0.4933367669582367, -0.09987927228212357, 0.42242205142974854, 0.0689343512058258, -0.3859938085079193, -0.4937460124492645, -0.4937765300273895, -0.385409951210022, 0.42797571420669556, -0.4936635196208954, -0.3848181664943695], "z": [-0.23992180824279785, -0.38856643438339233, 0.8592004776000977, -0.23071224987506866, -0.23687045276165009, -0.17040948569774628, -0.384949266910553, 0.7890151143074036, -0.2931162118911743, 0.5193007588386536, -0.3808269202709198, -0.26067468523979187, -0.2398812621831894, -0.2779747545719147, -0.24532920122146606, -0.23071561753749847, 0.7695397734642029, -0.3778897821903229, -0.2941836714744568, 0.15694071352481842, -0.23311389982700348, -0.23966799676418304, -0.22935296595096588, -0.23066575825214386, -0.21523307263851166, -0.22835050523281097, -0.28331226110458374, -0.2028874307870865, -0.2307165265083313, 0.06362803280353546, -0.2721109986305237, -0.19280555844306946, -0.23073379695415497, -0.21629507839679718, -0.2327595055103302, -0.23202736675739288, 0.44777441024780273, -0.07126087695360184, -0.23182067275047302, -0.23717084527015686, -0.30250975489616394, -0.2307237982749939, -0.3152533769607544, -0.19429196417331696, -0.2606586515903473, -0.23461149632930756, -0.23974014818668365, -0.36969059705734253, -0.27748462557792664, -0.22979465126991272, -0.21457438170909882, 0.11171495914459229, -0.3781917989253998, -0.2398591786623001, 0.8237514495849609, 0.3423027992248535, -0.23458200693130493, -0.22893625497817993, -0.23081570863723755, -0.22142146527767181, -0.21242739260196686, -0.23071224987506866, -0.23074448108673096, 0.38442084193229675, -0.3265225887298584, -0.24884657561779022, -0.23965135216712952, -0.23071402311325073, -0.23071171343326569, -0.23932960629463196, -0.28743940591812134, -0.2307223379611969, -0.2388734370470047]}],
                        {"margin": {"b": 10, "l": 10, "r": 20, "t": 0}, "scene": {"annotations": [{"text": "black", "x": -0.7370690107345581, "xanchor": "center", "y": -0.38622117042541504, "z": -0.23992180824279785}, {"text": "grizzly", "x": 0.06138782575726509, "xanchor": "center", "y": 0.7715229392051697, "z": -0.38856643438339233}, {"text": "spectacled", "x": 0.002662815386429429, "xanchor": "center", "y": 0.10847767442464828, "z": 0.8592004776000977}, {"text": "teddy", "x": 0.6730183959007263, "xanchor": "center", "y": -0.4937794506549835, "z": -0.23071224987506866}], "xaxis": {"showticklabels": false, "title": {"text": ""}}, "yaxis": {"showticklabels": false, "title": {"text": ""}}, "zaxis": {"showticklabels": false, "title": {"text": ""}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "width": 700},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('49f3e28a-1f48-4e97-b8a6-a992492e9a32');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.474520</td>
<td>0.377549</td>
<td>0.130435</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.337095</td>
<td>0.232552</td>
<td>0.086957</td>
<td>00:16</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.252857</td>
<td>0.182564</td>
<td>0.072464</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.207571</td>
<td>0.131986</td>
<td>0.057971</td>
<td>00:16</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="5645d19d-7820-4980-98f5-35389356d59f" class="plotly-graph-div" style="height:525px; width:700px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("5645d19d-7820-4980-98f5-35389356d59f")) {
                    Plotly.newPlot(
                        '5645d19d-7820-4980-98f5-35389356d59f',
                        [{"hovertext": ["black", "grizzly", "spectacled", "teddy", "black", "spectacled", "grizzly", "spectacled", "grizzly", "spectacled", "grizzly", "teddy", "black", "grizzly", "grizzly", "teddy", "spectacled", "grizzly", "grizzly", "spectacled", "black", "black", "black", "teddy", "spectacled", "teddy", "grizzly", "spectacled", "teddy", "spectacled", "black", "spectacled", "teddy", "grizzly", "black", "spectacled", "spectacled", "spectacled", "teddy", "black", "grizzly", "teddy", "grizzly", "black", "black", "black", "black", "grizzly", "grizzly", "grizzly", "grizzly", "spectacled", "grizzly", "black", "spectacled", "spectacled", "black", "grizzly", "teddy", "spectacled", "spectacled", "teddy", "teddy", "spectacled", "grizzly", "grizzly", "black", "teddy", "teddy", "black", "grizzly", "teddy", "spectacled"], "marker": {"color": ["red", "green", "blue", "orange", "red", "blue", "green", "blue", "green", "blue", "green", "orange", "red", "green", "green", "orange", "blue", "green", "green", "blue", "red", "red", "red", "orange", "blue", "orange", "green", "blue", "orange", "blue", "red", "blue", "orange", "green", "red", "blue", "blue", "blue", "orange", "red", "green", "orange", "green", "red", "red", "red", "red", "green", "green", "green", "green", "blue", "green", "red", "blue", "blue", "red", "green", "orange", "blue", "blue", "orange", "orange", "blue", "green", "green", "red", "orange", "orange", "red", "green", "orange", "blue"], "opacity": 0.6, "size": 5}, "mode": "markers", "type": "scatter3d", "x": [0.7481371760368347, -0.6470844149589539, 0.04021141305565834, -0.1412641555070877, 0.7379847764968872, 0.6596457958221436, -0.6462621092796326, -0.02307717315852642, -0.5913352966308594, 0.05602756515145302, -0.6465809345245361, -0.15918146073818207, 0.7477837800979614, -0.538075864315033, -0.5791051387786865, -0.14126165211200714, 0.041021302342414856, -0.6462557315826416, -0.638135552406311, 0.113735631108284, 0.7149328589439392, 0.7472206354141235, 0.719594419002533, -0.14126451313495636, 0.6790557503700256, -0.14193688333034515, -0.3308863043785095, 0.17643314599990845, -0.14126603305339813, 0.16595110297203064, -0.3618626892566681, 0.4271584153175354, -0.14127646386623383, -0.5821236371994019, 0.7132766842842102, 0.6825902462005615, 0.04513286426663399, 0.12913665175437927, -0.1431037038564682, 0.7434914708137512, -0.6004667282104492, -0.1412469893693924, -0.6339541077613831, 0.7377666234970093, 0.5809342861175537, 0.7390486598014832, 0.7476154565811157, -0.6457198262214661, -0.5861621499061584, -0.6128577589988708, -0.6097184419631958, 0.10179117321968079, -0.6416311264038086, 0.7480096817016602, 0.04180136322975159, 0.04489459842443466, 0.7399948835372925, -0.36763620376586914, -0.141399085521698, 0.7011274695396423, 0.7248430252075195, -0.1412641555070877, -0.14139023423194885, 0.05096718296408653, -0.6096487641334534, -0.5620666742324829, 0.7478782534599304, -0.14128781855106354, -0.14126384258270264, 0.7461447715759277, -0.608612596988678, -0.141305074095726, 0.7355561852455139], "y": [-0.32824966311454773, -0.5408305525779724, 0.10129527747631073, 0.7677849531173706, -0.3222837746143341, -0.28824490308761597, -0.5406641960144043, 0.037977587431669235, -0.5315789580345154, 0.09085269272327423, -0.5406625866889954, 0.7208365201950073, -0.328269898891449, -0.28197431564331055, -0.526402473449707, 0.7677617073059082, 0.10039025545120239, -0.5405523777008057, -0.5335991382598877, 0.05625162646174431, -0.3267289698123932, -0.3282962739467621, -0.3253716826438904, 0.7677720785140991, -0.28769344091415405, 0.7642301321029663, -0.48483243584632874, -0.35118845105171204, 0.7677796483039856, 0.007636143360286951, -0.49598756432533264, -0.1476781815290451, 0.767751932144165, -0.5189405679702759, -0.3160288333892822, -0.28715434670448303, 0.09748131036758423, 0.045296840369701385, 0.7625493407249451, -0.3274887502193451, -0.5308011174201965, 0.7677001357078552, -0.5370060205459595, -0.3221754729747772, -0.35101595520973206, -0.3237614035606384, -0.32801905274391174, -0.5402044057846069, -0.5254098176956177, -0.5147514939308167, -0.5310529470443726, 0.06332281231880188, -0.539636492729187, -0.3282628059387207, 0.09959328174591064, 0.09930180758237839, -0.32518449425697327, -0.48936256766319275, 0.7673200368881226, -0.3018980622291565, -0.31451237201690674, 0.7677849531173706, 0.7672519683837891, 0.09142006933689117, -0.5332178473472595, -0.5175395607948303, -0.3281385600566864, 0.7677204608917236, 0.7677841782569885, -0.32825756072998047, -0.523530125617981, 0.7676613926887512, -0.32724085450172424], "z": [-0.2873028516769409, -0.19693663716316223, 0.8591404557228088, -0.3749009370803833, -0.27126169204711914, -0.1723261922597885, -0.19692035019397736, 0.7524661421775818, -0.2002953588962555, 0.8187551498413086, -0.1969798058271408, -0.368150919675827, -0.28724339604377747, -0.2276943176984787, -0.1938803791999817, -0.374898225069046, 0.8568534255027771, -0.1968933343887329, -0.19791388511657715, 0.7351109981536865, -0.2721121907234192, -0.28715068101882935, -0.2714824974536896, -0.3748953640460968, -0.22178882360458374, -0.373347669839859, -0.20493458211421967, -0.11900477111339569, -0.374900221824646, 0.6114186644554138, -0.21493230760097504, 0.20009087026119232, -0.37489625811576843, -0.17664490640163422, -0.25008299946784973, -0.19213081896305084, 0.8493876457214355, 0.7079473733901978, -0.3741901218891144, -0.28411686420440674, -0.19961310923099518, -0.37489065527915955, -0.19720028340816498, -0.27098485827445984, -0.27458783984184265, -0.27482232451438904, -0.2867163419723511, -0.19677069783210754, -0.20067235827445984, -0.19017550349235535, -0.19324807822704315, 0.7553319931030273, -0.19728145003318787, -0.2872883081436157, 0.8549574613571167, 0.8464288115501404, -0.2782725393772125, -0.20057959854602814, -0.37483784556388855, -0.21641995012760162, -0.2504700720310211, -0.3749009370803833, -0.3748286962509155, 0.8323148488998413, -0.1978636384010315, -0.19094523787498474, -0.28699991106987, -0.37489160895347595, -0.37490078806877136, -0.2866997718811035, -0.1945781260728836, -0.3748839199542999, -0.2809405028820038]}],
                        {"margin": {"b": 10, "l": 10, "r": 20, "t": 0}, "scene": {"annotations": [{"text": "black", "x": 0.7481371760368347, "xanchor": "center", "y": -0.32824966311454773, "z": -0.2873028516769409}, {"text": "grizzly", "x": -0.6470844149589539, "xanchor": "center", "y": -0.5408305525779724, "z": -0.19693663716316223}, {"text": "spectacled", "x": 0.04021141305565834, "xanchor": "center", "y": 0.10129527747631073, "z": 0.8591404557228088}, {"text": "teddy", "x": -0.1412641555070877, "xanchor": "center", "y": 0.7677849531173706, "z": -0.3749009370803833}], "xaxis": {"showticklabels": false, "title": {"text": ""}}, "yaxis": {"showticklabels": false, "title": {"text": ""}}, "zaxis": {"showticklabels": false, "title": {"text": ""}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "width": 700},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('5645d19d-7820-4980-98f5-35389356d59f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="b4fa0680-e87b-4995-9bac-c9394ec99d9b" class="plotly-graph-div" style="height:525px; width:700px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("b4fa0680-e87b-4995-9bac-c9394ec99d9b")) {
                    Plotly.newPlot(
                        'b4fa0680-e87b-4995-9bac-c9394ec99d9b',
                        [{"hovertext": ["black", "grizzly", "spectacled", "teddy", "black", "spectacled", "grizzly", "spectacled", "grizzly", "spectacled", "grizzly", "teddy", "black", "grizzly", "grizzly", "teddy", "spectacled", "grizzly", "grizzly", "spectacled", "black", "black", "black", "teddy", "spectacled", "teddy", "grizzly", "spectacled", "teddy", "spectacled", "black", "spectacled", "teddy", "grizzly", "black", "spectacled", "spectacled", "spectacled", "teddy", "black", "grizzly", "teddy", "grizzly", "black", "black", "black", "black", "grizzly", "grizzly", "grizzly", "grizzly", "spectacled", "grizzly", "black", "spectacled", "spectacled", "black", "grizzly", "teddy", "spectacled", "spectacled", "teddy", "teddy", "spectacled", "grizzly", "grizzly", "black", "teddy", "teddy", "black", "grizzly", "teddy", "spectacled"], "marker": {"color": ["red", "green", "blue", "orange", "red", "blue", "green", "blue", "green", "blue", "green", "orange", "red", "green", "green", "orange", "blue", "green", "green", "blue", "red", "red", "red", "orange", "blue", "orange", "green", "blue", "orange", "blue", "red", "blue", "orange", "green", "red", "blue", "blue", "blue", "orange", "red", "green", "orange", "green", "red", "red", "red", "red", "green", "green", "green", "green", "blue", "green", "red", "blue", "blue", "red", "green", "orange", "blue", "blue", "orange", "orange", "blue", "green", "green", "red", "orange", "orange", "red", "green", "orange", "blue"], "opacity": 0.6, "size": 5}, "mode": "markers", "type": "scatter3d", "x": [-0.5856688022613525, 0.7964252233505249, -0.12102759629487991, -0.08972878754138947, -0.5640361309051514, -0.5036776661872864, 0.7963749766349792, 0.05356047675013542, 0.7904770374298096, -0.12124156951904297, 0.7964158654212952, -0.08765365928411484, -0.5856005549430847, 0.7591849565505981, 0.7921650409698486, -0.08972862362861633, -0.12102445214986801, 0.7964182496070862, 0.796021580696106, -0.12236239016056061, -0.5773609280586243, -0.5849519968032837, -0.5729115605354309, -0.08972879499197006, -0.43230053782463074, -0.08937174826860428, 0.6378583908081055, 0.05235258862376213, -0.0897287055850029, -0.12413553893566132, 0.6909754276275635, -0.1341237872838974, -0.08972818404436111, 0.7957785725593567, -0.5345675349235535, -0.3106015920639038, -0.1210508719086647, -0.1228388249874115, -0.08938675373792648, -0.5843377709388733, 0.7952104210853577, -0.08972706645727158, 0.7960786819458008, -0.5853446125984192, -0.5400068163871765, -0.5814861059188843, -0.5855513215065002, 0.7963566780090332, 0.7949264049530029, 0.7950032949447632, 0.7954484224319458, -0.12285128235816956, 0.7954848408699036, -0.585642397403717, -0.12101506441831589, -0.12105603516101837, -0.5825760364532471, 0.7931429743766785, -0.08970282226800919, -0.507034420967102, -0.5264396667480469, -0.08972878754138947, -0.08969781547784805, -0.12042007595300674, 0.7922728061676025, 0.7906230092048645, -0.5855399370193481, -0.08971200883388519, -0.08972878009080887, -0.5853564739227295, 0.7941538095474243, -0.0897095650434494, -0.5527392625808716], "y": [0.5636184811592102, 0.3112286925315857, -0.11899617314338684, -0.7558510303497314, 0.531901478767395, 0.4672110378742218, 0.31123510003089905, -0.03658052161335945, 0.31224697828292847, -0.11842171847820282, 0.3112237751483917, -0.7533413767814636, 0.5635995864868164, 0.26709437370300293, 0.3118404746055603, -0.7558498978614807, -0.11896873265504837, 0.31122761964797974, 0.3108852505683899, -0.11696314066648483, 0.558048665523529, 0.5634666085243225, 0.5501531362533569, -0.755850613117218, 0.3764542043209076, -0.7553345561027527, 0.3386495113372803, 0.19629384577274323, -0.7558509111404419, -0.08918148279190063, 0.3300946354866028, -0.09544635564088821, -0.7558502554893494, 0.3112044334411621, 0.4946304261684418, 0.15518665313720703, -0.1189190223813057, -0.11634017527103424, -0.7554163932800293, 0.5622859001159668, 0.311336874961853, -0.7558445930480957, 0.31113937497138977, 0.5633043050765991, 0.5541577935218811, 0.5582259297370911, 0.5634592175483704, 0.3111693561077118, 0.31122535467147827, 0.31006574630737305, 0.3112446963787079, -0.11634370684623718, 0.31136661767959595, 0.5636132955551147, -0.1189572885632515, -0.11901441961526871, 0.5600940585136414, 0.3117149770259857, -0.7558106184005737, 0.45879462361335754, 0.4767763614654541, -0.7558510303497314, -0.7558084726333618, -0.11824068427085876, 0.31184548139572144, 0.31113430857658386, 0.5634413361549377, -0.7558306455612183, -0.7558510303497314, 0.5635170340538025, 0.3111170530319214, -0.7558274269104004, 0.5423594117164612], "z": [0.2988749146461487, 0.13727200031280518, -0.8492303490638733, 0.4130834937095642, 0.245540052652359, 0.1405034065246582, 0.13727614283561707, -0.6598944067955017, 0.1379762589931488, -0.8471497297286987, 0.13727401196956635, 0.41243356466293335, 0.29886293411254883, 0.1486828476190567, 0.13754992187023163, 0.4130833148956299, -0.8491656184196472, 0.13727307319641113, 0.13737750053405762, -0.8454387187957764, 0.2906489372253418, 0.2987874448299408, 0.27816617488861084, 0.41308340430259705, 0.07346832752227783, 0.41286858916282654, 0.15489336848258972, -0.23440973460674286, 0.41308343410491943, -0.7925508618354797, 0.1495140939950943, -0.8080047965049744, 0.4130832850933075, 0.1370905190706253, 0.1846359372138977, -0.3653033375740051, -0.8490869402885437, -0.8443304896354675, 0.4129737913608551, 0.29678255319595337, 0.13742776215076447, 0.4130823314189911, 0.1373298615217209, 0.29838401079177856, 0.2931249141693115, 0.2899591028690338, 0.29862648248672485, 0.13728904724121094, 0.1374807208776474, 0.13759005069732666, 0.13738426566123962, -0.8442120552062988, 0.13738597929477692, 0.29887181520462036, -0.8491443991661072, -0.8489052057266235, 0.2932645380496979, 0.13756023347377777, 0.4130741357803345, 0.12552623450756073, 0.1530199646949768, 0.4130834937095642, 0.4130730926990509, -0.8472538590431213, 0.13775114715099335, 0.1375744789838791, 0.298594206571579, 0.4130782186985016, 0.4130834937095642, 0.29877594113349915, 0.13754650950431824, 0.4130774438381195, 0.26843538880348206]}],
                        {"margin": {"b": 10, "l": 10, "r": 20, "t": 0}, "scene": {"annotations": [{"text": "black", "x": -0.5856688022613525, "xanchor": "center", "y": 0.5636184811592102, "z": 0.2988749146461487}, {"text": "grizzly", "x": 0.7964252233505249, "xanchor": "center", "y": 0.3112286925315857, "z": 0.13727200031280518}, {"text": "spectacled", "x": -0.12102759629487991, "xanchor": "center", "y": -0.11899617314338684, "z": -0.8492303490638733}, {"text": "teddy", "x": -0.08972878754138947, "xanchor": "center", "y": -0.7558510303497314, "z": 0.4130834937095642}], "xaxis": {"showticklabels": false, "title": {"text": ""}}, "yaxis": {"showticklabels": false, "title": {"text": ""}}, "zaxis": {"showticklabels": false, "title": {"text": ""}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "width": 700},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('b4fa0680-e87b-4995-9bac-c9394ec99d9b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="66758748-453e-4489-9788-14e5484aab1a" class="plotly-graph-div" style="height:525px; width:700px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("66758748-453e-4489-9788-14e5484aab1a")) {
                    Plotly.newPlot(
                        '66758748-453e-4489-9788-14e5484aab1a',
                        [{"hovertext": ["black", "grizzly", "spectacled", "teddy", "black", "spectacled", "grizzly", "spectacled", "grizzly", "spectacled", "grizzly", "teddy", "black", "grizzly", "grizzly", "teddy", "spectacled", "grizzly", "grizzly", "spectacled", "black", "black", "black", "teddy", "spectacled", "teddy", "grizzly", "spectacled", "teddy", "spectacled", "black", "spectacled", "teddy", "grizzly", "black", "spectacled", "spectacled", "spectacled", "teddy", "black", "grizzly", "teddy", "grizzly", "black", "black", "black", "black", "grizzly", "grizzly", "grizzly", "grizzly", "spectacled", "grizzly", "black", "spectacled", "spectacled", "black", "grizzly", "teddy", "spectacled", "spectacled", "teddy", "teddy", "spectacled", "grizzly", "grizzly", "black", "teddy", "teddy", "black", "grizzly", "teddy", "spectacled"], "marker": {"color": ["red", "green", "blue", "orange", "red", "blue", "green", "blue", "green", "blue", "green", "orange", "red", "green", "green", "orange", "blue", "green", "green", "blue", "red", "red", "red", "orange", "blue", "orange", "green", "blue", "orange", "blue", "red", "blue", "orange", "green", "red", "blue", "blue", "blue", "orange", "red", "green", "orange", "green", "red", "red", "red", "red", "green", "green", "green", "green", "blue", "green", "red", "blue", "blue", "red", "green", "orange", "blue", "blue", "orange", "orange", "blue", "green", "green", "red", "orange", "orange", "red", "green", "orange", "blue"], "opacity": 0.6, "size": 5}, "mode": "markers", "type": "scatter3d", "x": [-0.5092968940734863, 0.8301352262496948, -0.16385100781917572, -0.1569872945547104, -0.5010306239128113, -0.4248799979686737, 0.8301293253898621, 0.19286872446537018, 0.8294682502746582, -0.16383500397205353, 0.8301331400871277, -0.15648868680000305, -0.5092782974243164, 0.8185741305351257, 0.8297083973884583, -0.15698720514774323, -0.1638476699590683, 0.8301348686218262, 0.830065131187439, -0.16393400728702545, -0.5053275227546692, -0.5085009932518005, -0.5010165572166443, -0.1569872945547104, -0.20706363022327423, -0.15678319334983826, 0.7819206118583679, 0.14404748380184174, -0.156987264752388, -0.15833225846290588, 0.7932243943214417, -0.16506913304328918, -0.15698717534542084, 0.8301020264625549, -0.458605021238327, -0.18801510334014893, -0.1638503521680832, -0.16403266787528992, -0.15689486265182495, -0.5083928108215332, 0.8300467133522034, -0.15698686242103577, 0.8300928473472595, -0.5090833306312561, -0.48224160075187683, -0.5062814354896545, -0.5092571973800659, 0.8301098346710205, 0.8300648927688599, 0.8298953175544739, 0.830023467540741, -0.1640293300151825, 0.8298983573913574, -0.5092700123786926, -0.16384491324424744, -0.16385170817375183, -0.5060262084007263, 0.8300859332084656, -0.15697304904460907, -0.37424880266189575, -0.47538965940475464, -0.1569872945547104, -0.1569746434688568, -0.16360464692115784, 0.8296711444854736, 0.8293019533157349, -0.5091353058815002, -0.15696409344673157, -0.1569872796535492, -0.5092162489891052, 0.8299475312232971, -0.156981959939003, -0.3938619792461395], "y": [0.620587170124054, 0.22083021700382233, -0.09504478424787521, -0.7463725805282593, 0.6034924387931824, 0.4914972186088562, 0.22083105146884918, 0.01838059164583683, 0.2210122048854828, -0.09501377493143082, 0.22082847356796265, -0.7458820343017578, 0.6205797791481018, 0.2095935344696045, 0.22090290486812592, -0.7463722825050354, -0.09504163265228271, 0.2208300530910492, 0.22076599299907684, -0.09485206007957458, 0.6163652539253235, 0.6203347444534302, 0.6070377230644226, -0.7463724613189697, 0.10856122523546219, -0.7460910677909851, 0.23446659743785858, 0.0891774520277977, -0.7463725805282593, -0.08997871726751328, 0.23170137405395508, -0.09074211120605469, -0.7463725209236145, 0.2208251953125, 0.5205835700035095, -0.04653961583971977, -0.09503282606601715, -0.09468377381563187, -0.7462788224220276, 0.6190729737281799, 0.22083745896816254, -0.7463718056678772, 0.220803365111351, 0.6204484105110168, 0.6112598180770874, 0.6150003671646118, 0.6205089688301086, 0.22080658376216888, 0.22081801295280457, 0.22062134742736816, 0.22078676521778107, -0.09468002617359161, 0.22088667750358582, 0.6205788254737854, -0.09504146128892899, -0.09505049139261246, 0.6154538989067078, 0.2208394557237625, -0.7463552355766296, 0.3696615695953369, 0.550462007522583, -0.7463725805282593, -0.7463594079017639, -0.09494813531637192, 0.22093285620212555, 0.22067975997924805, 0.6202589273452759, -0.7463497519493103, -0.7463725805282593, 0.6205565929412842, 0.22082072496414185, -0.7463673949241638, 0.4939071238040924], "z": [0.32478949427604675, 0.11004331707954407, -0.8450558185577393, 0.41022300720214844, 0.2968507707118988, 0.12243153154850006, 0.1100439727306366, -0.5017183423042297, 0.11015209555625916, -0.8448387384414673, 0.11004392057657242, 0.4100702702999115, 0.3247850835323334, 0.11352531611919403, 0.11003655940294266, 0.41022297739982605, -0.8450455665588379, 0.11004339158535004, 0.11006409674882889, -0.8446743488311768, 0.31878039240837097, 0.32466042041778564, 0.30467966198921204, 0.41022297739982605, -0.4083898067474365, 0.41001686453819275, 0.117510586977005, -0.39176374673843384, 0.41022300720214844, -0.8330166935920715, 0.11589371412992477, -0.8374635577201843, 0.41022297739982605, 0.11002203822135925, 0.16296391189098358, -0.7577020525932312, -0.8450314998626709, -0.8443694114685059, 0.4101945161819458, 0.3224512040615082, 0.11005949974060059, 0.4102228581905365, 0.11005409061908722, 0.32464003562927246, 0.31992441415786743, 0.31580105423927307, 0.32466745376586914, 0.1100507378578186, 0.11005762964487076, 0.11010812222957611, 0.1100650206208229, -0.8443394303321838, 0.11008267849683762, 0.32478517293930054, -0.845043420791626, -0.845026433467865, 0.31688928604125977, 0.11004861444234848, 0.4102182686328888, -0.07880748808383942, 0.21028906106948853, 0.41022300720214844, 0.4102190434932709, -0.8446853160858154, 0.11011767387390137, 0.11007029563188553, 0.3242708146572113, 0.4102158844470978, 0.41022300720214844, 0.3247685432434082, 0.11007124930620193, 0.4102214276790619, 0.14211630821228027]}],
                        {"margin": {"b": 10, "l": 10, "r": 20, "t": 0}, "scene": {"annotations": [{"text": "black", "x": -0.5092968940734863, "xanchor": "center", "y": 0.620587170124054, "z": 0.32478949427604675}, {"text": "grizzly", "x": 0.8301352262496948, "xanchor": "center", "y": 0.22083021700382233, "z": 0.11004331707954407}, {"text": "spectacled", "x": -0.16385100781917572, "xanchor": "center", "y": -0.09504478424787521, "z": -0.8450558185577393}, {"text": "teddy", "x": -0.1569872945547104, "xanchor": "center", "y": -0.7463725805282593, "z": 0.41022300720214844}], "xaxis": {"showticklabels": false, "title": {"text": ""}}, "yaxis": {"showticklabels": false, "title": {"text": ""}}, "zaxis": {"showticklabels": false, "title": {"text": ""}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "width": 700},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('66758748-453e-4489-9788-14e5484aab1a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="f2c9a1b8-9f25-4162-ad76-4b9697ff69f8" class="plotly-graph-div" style="height:525px; width:700px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("f2c9a1b8-9f25-4162-ad76-4b9697ff69f8")) {
                    Plotly.newPlot(
                        'f2c9a1b8-9f25-4162-ad76-4b9697ff69f8',
                        [{"hovertext": ["black", "grizzly", "spectacled", "teddy", "black", "spectacled", "grizzly", "spectacled", "grizzly", "spectacled", "grizzly", "teddy", "black", "grizzly", "grizzly", "teddy", "spectacled", "grizzly", "grizzly", "spectacled", "black", "black", "black", "teddy", "spectacled", "teddy", "grizzly", "spectacled", "teddy", "spectacled", "black", "spectacled", "teddy", "grizzly", "black", "spectacled", "spectacled", "spectacled", "teddy", "black", "grizzly", "teddy", "grizzly", "black", "black", "black", "black", "grizzly", "grizzly", "grizzly", "grizzly", "spectacled", "grizzly", "black", "spectacled", "spectacled", "black", "grizzly", "teddy", "spectacled", "spectacled", "teddy", "teddy", "spectacled", "grizzly", "grizzly", "black", "teddy", "teddy", "black", "grizzly", "teddy", "spectacled"], "marker": {"color": ["red", "green", "blue", "orange", "red", "blue", "green", "blue", "green", "blue", "green", "orange", "red", "green", "green", "orange", "blue", "green", "green", "blue", "red", "red", "red", "orange", "blue", "orange", "green", "blue", "orange", "blue", "red", "blue", "orange", "green", "red", "blue", "blue", "blue", "orange", "red", "green", "orange", "green", "red", "red", "red", "red", "green", "green", "green", "green", "blue", "green", "red", "blue", "blue", "red", "green", "orange", "blue", "blue", "orange", "orange", "blue", "green", "green", "red", "orange", "orange", "red", "green", "orange", "blue"], "opacity": 0.6, "size": 5}, "mode": "markers", "type": "scatter3d", "x": [-0.4162692427635193, 0.8531609773635864, -0.2596711218357086, -0.1772206425666809, -0.4113524556159973, -0.34818634390830994, 0.8531526327133179, 0.01504560373723507, 0.8527776598930359, -0.25964587926864624, 0.8531592488288879, -0.17676131427288055, -0.416250616312027, 0.8456867933273315, 0.8528063893318176, -0.17722047865390778, -0.2596692144870758, 0.8531607389450073, 0.8531220555305481, -0.25967714190483093, -0.412773072719574, -0.41540461778640747, -0.4115944802761078, -0.1772206574678421, -0.23226608335971832, -0.17695939540863037, 0.8056854605674744, -0.09651170670986176, -0.17722056806087494, -0.2563846707344055, 0.8105040788650513, -0.25961852073669434, -0.17722050845623016, 0.8530964851379395, -0.37652990221977234, -0.26238951086997986, -0.25966930389404297, -0.2596935033798218, -0.17710000276565552, -0.41523614525794983, 0.8531027436256409, -0.17722004652023315, 0.8531247973442078, -0.4159899055957794, -0.3980138301849365, -0.41309434175491333, -0.4162326753139496, 0.8531366586685181, 0.8531264662742615, 0.8529581427574158, 0.8530658483505249, -0.25969740748405457, 0.8528698086738586, -0.41623613238334656, -0.25966644287109375, -0.25967058539390564, -0.41327017545700073, 0.8531440496444702, -0.177195742726326, -0.3063846230506897, -0.38991785049438477, -0.1772206425666809, -0.17720262706279755, -0.2595377564430237, 0.8528400659561157, 0.8524213433265686, -0.4160865545272827, -0.17712566256523132, -0.17722062766551971, -0.4162074029445648, 0.8530257344245911, -0.17721442878246307, -0.26783183217048645], "y": [-0.5904166102409363, -0.1417836993932724, -0.0600728839635849, 0.792273223400116, -0.573811948299408, -0.42428481578826904, -0.14178535342216492, -0.08020596951246262, -0.1419070065021515, -0.06007182225584984, -0.14178232848644257, 0.791853129863739, -0.5904079675674438, -0.13509805500507355, -0.14183498919010162, 0.7922724485397339, -0.060073208063840866, -0.14178359508514404, -0.14175085723400116, -0.060112446546554565, -0.5862201452255249, -0.5900920629501343, -0.5791726112365723, 0.7922730445861816, -0.11763447523117065, 0.7916949987411499, -0.15770961344242096, -0.09451807290315628, 0.7922731041908264, -0.060911282896995544, -0.15668262541294098, -0.06103159859776497, 0.7922731041908264, -0.14178122580051422, -0.4637485146522522, -0.06921947747468948, -0.06007542833685875, -0.06014592573046684, 0.7921584844589233, -0.5875025391578674, -0.14178700745105743, 0.7922723293304443, -0.1417655348777771, -0.5902095437049866, -0.5824392437934875, -0.5809240937232971, -0.5903005599975586, -0.1417626589536667, -0.14177510142326355, -0.14162437617778778, -0.14173635840415955, -0.060173891484737396, -0.14186684787273407, -0.5904045701026917, -0.060073163360357285, -0.06007050722837448, -0.5838242769241333, -0.14178644120693207, 0.7922435998916626, -0.285986065864563, -0.5014607310295105, 0.792273223400116, 0.7922559380531311, -0.060078997164964676, -0.141859769821167, -0.1416701376438141, -0.589807391166687, 0.7921865582466125, 0.792273223400116, -0.5903893709182739, -0.14178840816020966, 0.7922675013542175, -0.3524279296398163], "z": [0.47762760519981384, 0.04487436264753342, -0.823991596698761, 0.3014896512031555, 0.43688341975212097, 0.08126796782016754, 0.04487616568803787, -0.609234094619751, 0.04500407725572586, -0.8238962292671204, 0.04487480968236923, 0.30137351155281067, 0.47761785984039307, 0.04669944569468498, 0.044827792793512344, 0.3014896810054779, -0.8239877820014954, 0.0448744110763073, 0.044884201139211655, -0.8238577842712402, 0.46895965933799744, 0.47732555866241455, 0.4528007507324219, 0.3014896810054779, -0.5961169600486755, 0.30101150274276733, 0.06030794978141785, -0.637251079082489, 0.30148962140083313, -0.8195227980613708, 0.0592036210000515, -0.8213337063789368, 0.30148962140083313, 0.04483062028884888, 0.1691955029964447, -0.7977816462516785, -0.8239824175834656, -0.8237630128860474, 0.3014598786830902, 0.4707140624523163, 0.04489275813102722, 0.30148956179618835, 0.04488370195031166, 0.47730427980422974, 0.4700036644935608, 0.454578161239624, 0.4773503243923187, 0.04488020017743111, 0.044883619993925095, 0.044916026294231415, 0.044893257319927216, -0.8236691951751709, 0.04497149586677551, 0.47761622071266174, -0.82398521900177, -0.8239850401878357, 0.4624035060405731, 0.044876862317323685, 0.30148398876190186, -0.25651776790618896, 0.2595433294773102, 0.3014896512031555, 0.30148521065711975, -0.8238469958305359, 0.044972531497478485, 0.044826406985521317, 0.47616058588027954, 0.30146563053131104, 0.3014896512031555, 0.47759684920310974, 0.044896673411130905, 0.30148810148239136, -0.05447635427117348]}],
                        {"margin": {"b": 10, "l": 10, "r": 20, "t": 0}, "scene": {"annotations": [{"text": "black", "x": -0.4162692427635193, "xanchor": "center", "y": -0.5904166102409363, "z": 0.47762760519981384}, {"text": "grizzly", "x": 0.8531609773635864, "xanchor": "center", "y": -0.1417836993932724, "z": 0.04487436264753342}, {"text": "spectacled", "x": -0.2596711218357086, "xanchor": "center", "y": -0.0600728839635849, "z": -0.823991596698761}, {"text": "teddy", "x": -0.1772206425666809, "xanchor": "center", "y": 0.792273223400116, "z": 0.3014896512031555}], "xaxis": {"showticklabels": false, "title": {"text": ""}}, "yaxis": {"showticklabels": false, "title": {"text": ""}}, "zaxis": {"showticklabels": false, "title": {"text": ""}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "width": 700},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('f2c9a1b8-9f25-4162-ad76-4b9697ff69f8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
</div>
<p>…So we see that spectacled bears, being black-colored, can get mixed up with black bears sometimes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">interp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ClassificationInterpretation.from_learner(learn)</span>
<span id="cb13-2">interp.plot_confusion_matrix()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The biggest losses are usually when the spectacled bears’ “spectacles” are not fully in view (e.g.&nbsp;in a side shot), in which case either its black coat makes it seem like a black bear, or its shagginess &amp; size make it seem like a grizzly:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">interp.plot_top_losses(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>(Another time I ran this, the top loss was for an image of a fox that was mislabeled as ‘spectacled’! Clearly just scraping from DuckDuckGo is not fool-proof. LOL)</p>
<p>Note that we had to retrain the model in order to handle the spectacled bear – there was no “slot” for it in the original 3-class model. We’re now going to switch to a contrastive loss model that uses a Siamese Network, which…we’ll see how it does on the spectacled bear after we train it on <em>only</em> the first 3 types of bear.</p>
<p><em>I’m going to pause writing and come back in the morning, so that I can title the next section…</em></p>
</section>
</section>
<section id="contrastive-loss-demo-same-bears-different-day" class="level2">
<h2 class="anchored" data-anchor-id="contrastive-loss-demo-same-bears-different-day">2. Contrastive Loss Demo: Same Bears, Different Day</h2>
<p>As we described in blog post Part 1, contrastive loss systems achieve metric learning by employing a Siamese Network.</p>
<p>Lesson 2 of the FastAI book already has a very effective Siamese Network demo. It does <em>not</em> use contrastive loss, and yet it will (see Appenix below) <em>outperform</em> my contrastive loss version (in terms of accuracy, by about 5 to 6%). So why would we want contrastive losses? Well, because they are useful for learning “semantically meaningful” embeddings, something the aforementioned Siamese Network lesson did not set as a goal.</p>
<p>The FastAI lesson uses the Oxford PETS dataset which has a different format than our bear-images dataset, so <em>the “good news”</em> is I got an opportuny to learn more about writing my own fastai dataloader by altering Jeremy’s instructions in the Lesson.</p>
<section id="writing-my-first-dataloaders" class="level4">
<h4 class="anchored" data-anchor-id="writing-my-first-dataloaders">Writing My First DataLoader(s)</h4>
<p>…Actually it turns out that we can copy all we need from the fastai tutorial <em>except</em> the parts where we grab the image files and the <code>label_func()</code> (below) that gives us class names based on the file pathnames. What we need is a routine that grabs pairs of images at a time, and labels* them as either “similar” (denoted by a label value of 1) or not (denoted by a value of 0). .</p>
<blockquote class="blockquote">
<p>Terminology: By “labels” I refer exclusively to “ground truth” or “target” values, which I may use interchangeably (esp.&nbsp;“targets”) supplied by the dataset/user – we are doing Supervised Learning. Model outputs will be referred to as “predictions”.</p>
</blockquote>
<p>So, adapting the <a href="https://docs.fast.ai/tutorial.siamese.html">FastAI Siamese Networks Tutorial</a> to a slightly different (and slightly simpler) data file structure,… it turns out we won’t be writing a <code>DataBlock</code>, but rather writing a <code>Transform</code>. (I don’t yet understand why TBH.)</p>
<p>Before we do that, we’re going to define a custom input object called <code>SiameseImage</code> that our dataloader/Transform can operate on, and that we can “show” in the notebook – it pays to be able to look at your data! ;-)</p>
<p>Let’s review our list of (3-bears) files, and we’ll leave out the spectacled bears for now</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grizzly'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'teddy'</span></span>
<span id="cb15-2">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scrape_for_me(dl_path, labels, search_suffix, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#labels = ['cat','dog','horse']</span></span>
<span id="cb15-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#path = scrape_for_me(dl_path, labels, '', max_n=300)</span></span>
<span id="cb15-5">subdirs, path, files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels, Path(dl_path), []</span>
<span id="cb15-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> subdirs: files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> get_image_files(path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>s)</span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'files has </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(files)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> elements.'</span>)</span>
<span id="cb15-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"files[0] = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>files[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, files[-1] = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>files[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grizzly bear: Got 280 image URLs. Downloading...
   urls =  ['https://i0.wp.com/www.commonsenseevaluation.com/wp-content/uploads/2013/08/Bear.jpg', 'https://blog.humanesociety.org/wp-content/uploads/2019/04/BEAR_GRIZZLY_A45T3555_468435.jpg', 'https://www.conservationnw.org/wp-content/uploads/2017/06/Grizzly-bear-family-Copyright-iStock.com_PhotosbyAndy-4.2015-e1507229404830.jpg', 'https://images.fineartamerica.com/images-medium-large/grizzly-bear-portrait-jim-guy.jpg', 'https://www.mtpr.org/sites/kufm/files/styles/x_large/public/201809/grizzly-bear-02_Istock.jpg', 'https://www.rmef.org/wp-content/uploads/2019/04/grizzly.jpg', 'https://images.dailyhive.com/20170509095127/bear-148-parks-canada-amar-atwal.jpeg', 'https://api.time.com/wp-content/uploads/2015/08/grizzly-bear.jpg?quality=85&amp;w=1200&amp;h=628&amp;crop=1', 'https://a57.foxnews.com/a57.foxnews.com/static.foxnews.com/foxnews.com/content/uploads/2018/09/640/320/1862/1048/Grizzly-iStock.jpg?ve=1&amp;tl=1?ve=1&amp;tl=1', 'https://media.spokesman.com/photos/2014/09/15/jj-Grizzly_MT.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/grizzly-bear-in-snow-tendrel-images.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-Desktop-Wallpaper-.jpg', 'https://i.cbc.ca/1.4132188.1495755019!/fileImage/httpImage/image.jpg_gen/derivatives/original_780/grizzly-bear.jpg', 'http://elelur.com/data_images/mammals/grizzly-bear/grizzly-bear-08.jpg', 'https://images.fineartamerica.com/images-medium-large-5/grizzly-bear-cub-phyllis-taylor.jpg', 'https://www.mtpr.org/sites/kufm/files/styles/x_large/public/201812/Grizzly-bear-family_LuCaAr-iStock.jpg', 'https://images.fineartamerica.com/images-medium-large/grizzly-bear-yukon-robert-postma.jpg', 'https://www.unilad.co.uk/wp-content/uploads/2020/02/close-up-photography-of-grizzly-bear-1068554.jpg', 'https://reidparkzoo.org/wp-content/uploads/2013/09/grzbear2812a.jpg', 'https://outsider.com/wp-content/uploads/2020/06/Grizzly-Bear-3.png', 'http://i.huffpost.com/gen/1227495/images/o-GRIZZLY-BEAR-facebook.jpg', 'https://i.ytimg.com/vi/Tue__Hlazh4/maxresdefault.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-Wallpapers-and-Backgrounds.jpg', 'https://get.wallhere.com/photo/animals-wildlife-bears-fur-wilderness-Grizzly-Bears-Grizzly-bear-brown-bear-bear-fauna-mammal-1920x1200-px-snout-carnivoran-organism-american-black-bear-terrestrial-animal-771353.jpg', 'http://traveltalesoflife.com/wp-content/uploads/Kicking-Horse-Resort-Grizzly-Close-Up.jpg', 'http://www.hickerphoto.com/images/1024/-56752.jpg', 'https://images.dailyhive.com/20161104114500/Grizzly-bears-TrophyLush.jpg', 'https://mtsgreenway.org/wp-content/uploads/2019/08/September-Grizzly-Large.png', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/1-grizzly-bear-art-wildlife-fine-art.jpg', 'https://www.livewaterjacksonhole.com/wp-content/uploads/2020/06/Grizzly-399-Grand-Teton-National-Park.jpg', 'https://i0.wp.com/rangerrick.org/wp-content/uploads/2018/04/RRMAR13_6-11Grizzlies.jpg?fit=1156%2C650&amp;ssl=1', 'http://grizzlybearwatching.com/wp-content/uploads/2017/03/BlackBear1-1500x998.jpg', 'http://mediad.publicbroadcasting.net/p/kufm/files/styles/medium/public/201410/grizzlybear.jpg', 'https://www.vmcdn.ca/f/files/rmotoday/images/grizzly122_kalra.jpg;w=960', 'http://4.bp.blogspot.com/-iRDehywX024/UNMpj9s5kVI/AAAAAAAAADI/9sxChqYMV2c/s1600/Grizzly-Bear-Yellowstone.jpg', 'https://2.bp.blogspot.com/-d0DjXibvH8w/UQN3Xn4QWDI/AAAAAAAAFb0/2nUaH5eoapg/s1600/Grizzly+Bear-2013-0pic-0.jpg', 'https://www.gannett-cdn.com/presto/2020/07/21/PGRF/83612915-6ab2-4f0d-aeca-7088f219ecec-AP20191697142470.jpg?crop=2999,1687,x0,y0&amp;width=2999&amp;height=1687&amp;format=pjpg&amp;auto=webp', 'http://assets.nydailynews.com/polopoly_fs/1.3269663.1498159924!/img/httpImage/image.jpg_gen/derivatives/article_750/654079900.jpg', 'https://d.ibtimes.co.uk/en/full/1621655/grizzly-bears.jpg', 'https://www.idahoconservation.org/wp-content/uploads/2020/06/Grizzly-Bear-photo-by-Jim-Mellen-1.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Ursus_arctos_californicus%2C_Santa_Barbara%2C_Natural_History_Museum.jpg/1200px-Ursus_arctos_californicus%2C_Santa_Barbara%2C_Natural_History_Museum.jpg', 'https://patch.com/img/cdn20/users/22906546/20180731/095817/styles/raw/public/processed_images/image006_1-1533085927-8474.jpg', 'https://wallup.net/wp-content/uploads/2017/11/17/265280-bears-Grizzly_bear.jpg', 'https://keyassets.timeincuk.net/inspirewp/live/wp-content/uploads/sites/2/2019/06/GettyImages-525103104.jpg', 'https://www.tsln.com/wp-content/uploads/2018/10/bears-tsln-101318-3-1240x826.jpg', 'http://www.bearsmart.com/wp-content/uploads/2015/01/why-bears3-730x330.jpg', 'https://cdn.rbth.com/980x-/all/2016/10/07/grizzly_gettyimages-10188130_b.jpg', 'https://wildlife.org/wp-content/uploads/2015/08/Grizzly-Bear-Credit-Washington-State-University-620x264.jpg', 'http://agenda21news.com/wp-content/uploads/2014/12/Grizzly-bear.gif', 'https://bloximages.chicago2.vip.townnews.com/codyenterprise.com/content/tncms/assets/v3/editorial/c/75/c75e6ae4-5ab0-11e7-9823-3b1d2aaec452/595173d52fa4e.image.jpg?resize=1200%2C885', 'https://cdn11.bigcommerce.com/s-db59p/images/stencil/1280x1280/products/21092/42704/oversized_12162019_01__97480.1577021805.jpg?c=2', 'http://1.bp.blogspot.com/_VgXaDXiFvX4/TOLc_oEzGcI/AAAAAAAAA9c/Q7qtQ7R1ju8/s1600/grizzly-bear-1.jpg', 'https://devdenverzoo.com/wp-content/uploads/2018/09/Grizzly-Bear_03.jpg', 'https://miro.medium.com/max/1758/1*cBBVLzODaagrL7V2eNSjSQ.jpeg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/3/grizzly-bear-jerry-fornarotto.jpg', 'https://www.wildnatureimages.com/images/xl/170628-145-Grizzly-Bear-Sow-with-Cubs.jpg', 'http://www.telegraph.co.uk/content/dam/news/2016/06/21/99682788_Two_grizzly_bears_at_the_Woodland_Park_Zoo_eat_salmon_after_the_fish_was_tossed_to_them_by-xlarge_trans_NvBQzQNjv4BqDfnT11g5XZty1Nobnb9oJsN7dAtWJUhNbBLTzbEHUEY.jpg', 'https://bloximages.chicago2.vip.townnews.com/trib.com/content/tncms/assets/v3/editorial/c/af/caf539ee-9c28-5fda-819a-3aeaa1f029bc/582cffad235a4.image.jpg?resize=1200%2C800', 'https://wildlife.org/wp-content/uploads/2016/08/grizzly1.jpg', 'https://cdn.thefencepost.com/wp-content/uploads/sites/12/2017/06/grizzly-RFP-070317-1240x826.jpg', 'http://static.independent.co.uk/s3fs-public/styles/story_large/public/thumbnails/image/2015/10/06/09/Grizzly.jpg', 'http://mediad.publicbroadcasting.net/p/kufm/files/styles/x_large/public/201603/grizzly-bear_Nathan-Rupert-CC-BY-NC-ND_0.jpg', 'https://www.cbbulletin.com/wp-content/uploads/2020/04/griz.jpg', 'https://img.thedailybeast.com/image/upload/v1492108548/articles/2016/10/15/won-t-you-please-adopt-a-grizzly-bear-cub/161014-Andrews-Grizzly-cubs-tease__p9gwbc.jpg', 'https://onekindplanet.org/wp-content/uploads/2017/09/grizzlybear-edit.jpg', 'http://www.akronzoo.org/Data/Sites/1/media/GalleryImages/105/WebImages/grizzly-bear-hero-1.jpg', 'http://wallup.net/wp-content/uploads/2016/01/139369-bears-nature-animals-river-baby_animals-Grizzly_Bears-Grizzly_bear.jpg', 'https://weneedfun.com/wp-content/uploads/Grizzly-Bear-4.jpg', 'https://1.bp.blogspot.com/-l-Y6zD_KF6o/UQN3jPgigAI/AAAAAAAAFcU/HOKJWQmNjo4/s1600/Grizzly+Bear-2013-0pic-05.jpg', 'https://devdenverzoo.com/wp-content/uploads/2018/09/Grizzly-Bear_02.jpg', 'https://www.conservationnw.org/wp-content/uploads/2017/10/grizzly-bears-1280x950.jpg', 'https://s1.it.atcdn.net/wp-content/uploads/2013/07/Grizzly-bear.jpg', 'https://outsider.com/wp-content/uploads/2020/09/grizzly-bear-ferociously-protects-kill-while-tourists-watch-yellowstone-national-park-1170x702.jpg', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/wyoming-grizzly-bear-og_0.jpg', 'https://www.wildernesscommittee.org/sites/default/files/2018-05/grizzly_bear.jpg', 'http://www.wyofile.com/wp-content/uploads/2017/11/grizzly-pic-e1509641980482.jpg', 'http://averageoutdoorsman.com/wp-content/uploads/2013/02/grizzly-bear.jpg', 'https://www.publicdomainpictures.net/pictures/90000/velka/grizzly-bear-portrait.jpg', 'https://www.vancouverobserver.com/sites/vancouverobserver.com/files/images/article/body/grouse-grizzly_n3d3306-web.jpg', 'http://www.wild-facts.com/wp-content/uploads/2012/04/Grizzlybear55.jpg', 'http://kgmi-am.sagacom.com/wp-content/blogs.dir/70/files/2014/08/grizzly-bear.jpg', 'http://www.shetzers.com/wp-content/uploads/2017/06/W-Blonde-Bear-Cub-and-Mother.jpg', 'https://i2.wp.com/jakesnatureblog.com/wp-content/uploads/2016/06/baby-brown-bear.jpg', 'https://d.newsweek.com/en/full/400233/rtr4kseg.jpg', 'https://wallup.net/wp-content/uploads/2018/10/09/125286-grizzly-bear-forest.jpg', 'https://www.columbiatribune.com/storyimage/MO/20171003/NEWS/171009653/AR/0/AR-171009653.jpg', 'https://images.wallpapersden.com/image/download/bear-grizzly-bear-eyes_amhrZ5SZmpqtpaSklGZuZ2WtZmVtZQ.jpg', 'https://wallpapertag.com/wallpaper/full/a/1/1/437141-grizzly-bear-backgrounds-1920x1080-for-lockscreen.jpg', 'https://bloximages.chicago2.vip.townnews.com/idahostatejournal.com/content/tncms/assets/v3/editorial/6/45/64588e0b-55e7-5585-bc61-819ae3630cff/59b721e2eb964.image.jpg', 'https://devdenverzoo.com/wp-content/uploads/2018/09/Grizzly-Bear_05.jpg', 'https://www.washingtonpost.com/resizer/i6X-FE4FqlbaGDzh9CanT4YU99Y=/1440x0/smart/arc-anglerfish-washpost-prod-washpost.s3.amazonaws.com/public/2C55XVXHAE5FTHUGC726432CYU.jpg', 'http://www.100hdwallpapers.com/wallpapers/3840x2160/two_grizzly_bears_in_water_4k-hd_wallpapers.jpg', 'https://www.uniquelynorthwest.com/wp-content/uploads/2014/12/grizzly-bear-alaska-incentive.jpg', 'https://www.conservationnw.org/wp-content/uploads/2020/03/JSW_6993-scaled.jpg', 'https://www.conservationnw.org/wp-content/uploads/2017/10/Grizzly-bear-in-mountain-meadow.-Photo-copyright-Jason-Verschoor.-iStockphoto.com_-e1507583569416.jpg', 'http://cdn.roaring.earth/wp-content/uploads/2016/03/Scratching-head-main-text.jpg', 'https://content.presspage.com/uploads/1979/1920_190416-oped-nielsen-grizzly-alex-taylor-banner-534230.jpg?10000', 'https://outsider.com/wp-content/uploads/2020/07/Grizzly-Bear.png', 'https://static01.nyt.com/images/2020/07/10/multimedia/10xp-bears-pix/10xp-bears-pix-videoSixteenByNineJumbo1600.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/grizzli-bear-cub-lyl-dil-creations.jpg', 'https://cowboystatedaily.com/wp-content/uploads/2020/05/bear-photo-not-cat-scaled.jpg', 'https://2.bp.blogspot.com/-p-QKKk3T8O0/UQN3a5YSALI/AAAAAAAAFcE/iTlNg3jee9A/s1600/Grizzly+Bear-2013-0pic-03.jpg', 'https://3.bp.blogspot.com/-_kQl-36lVL4/ThYEDrnAGBI/AAAAAAAABdM/sQkA6n28LJY/s1600/Grizzly+7+WA.jpg', 'https://fotos.perfil.com/2019/12/02/trim/1140/641/grizly-bear-811359.jpg', 'https://wildlifeimages.org/wp-content/uploads/2016/09/DSC1704.jpg', 'https://lakechelannow.com/wp-content/uploads/2019/08/Grizzly_Bear-Face-800x600.jpg', 'https://www.realtree.com/sites/default/files/content/images/open-graph/2020/cdenniswdonohue-shutterstock-griz.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-4K.jpg', 'http://2.bp.blogspot.com/-u2jNl3VZLpU/T5LoHWgdunI/AAAAAAAAFPo/DdDtaVJGTco/s1600/grizzly-bear_grizzly-bear.jpg', 'https://life.hawkeoptics.com/wp-content/uploads/2019/07/Keith-Crowley-Grizzly-Bears-03.jpg', 'https://img.theculturetrip.com/1440x807/wp-content/uploads/2018/01/carnivore-nature-wild-alaska-wildlife-grizzly-bear-861962.jpg', 'https://www.skinnymoose.com/outdoorsmorgasbord/files/2014/03/Grizzly-Bear-3.jpg', 'https://blog.humanesociety.org/wp-content/uploads/2020/07/grizzly-bear-iStock-647126690_369827.jpg', 'https://ewscripps.brightspotcdn.com/dims4/default/083faf0/2147483647/strip/true/crop/806x453+0+21/resize/1280x720!/quality/90/?url=https:%2F%2Fewscripps.brightspotcdn.com%2F00%2F7f%2F2489255d4d9ab8fc447f4b57ed66%2Fgrizzly-bear.jpg', 'https://www.lintelligencer.com/wp-content/uploads/2020/09/Alaska-Grizzly-kills-hunter-in-attack-at-national-park-Report.jpg', 'https://the-biggest.net/wp-content/uploads/2019/07/how-tall-was-the-biggest-grizzly-bear.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-for-desktop-background.jpg', 'https://www.shetzers.com/wp-content/uploads/2017/06/R-Grizzly-bear-cub-standing-tall-704x880.jpg', 'https://4.bp.blogspot.com/-7YmqPws-fF4/WhI9SBZv5dI/AAAAAAAAKik/KR02M342yKYwifxV3MgJQJYu1vhydOhFQCLcBGAs/s1600/IMG_3113.JPG', 'https://resize.hswstatic.com/w_1024/gif/grizzly-center.jpg', 'https://c.wallhere.com/photos/80/58/brown_bear_face_beautiful_background-629567.jpg!d', 'https://buckrail.com/wp-content/uploads/2018/05/Grizzly-bears-are-a-popular-attraction-for-visitors.-Jackson-Hole-EcoTour-Adventures.jpg', 'https://gephardtdaily.com/wp-content/uploads/2015/08/11754872_1109393535742666_5103459483633495575_o.jpg', 'http://www.outdoorhub.com/wp-content/uploads/sites/2/2015/08/outdoorhub-yellowstone-grizzly-bear-kills-hiker-in-apparent-predatory-attack-2015-08-12_15-18-35.jpg', 'https://www.whistler.ca/sites/default/files/styles/crop_min_663/public/2019/Apr/page/main-images/25900/grizzly.jpg?itok=NGH8XPEe', 'https://d.ibtimes.co.uk/en/full/1462246/grizzly-bear.jpg', 'https://cdn.rbth.com/all/2016/10/07/grizzly_gettyimages-dv1620005_b.jpg', 'https://www.rmef.org/wp-content/uploads/2020/05/wyoming-grizzly-bear.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/standing-grizzly-bear-cub-in-the-evening-light-daryl-l-hunter.jpg', 'https://www.wintersexpress.com/files/2019/05/animal-bear-cute-162340.jpg', 'https://weneedfun.com/wp-content/uploads/Grizzly-Bear-Picture-4.jpg', 'https://intercontinentalcry.org/wp-content/uploads/2019/08/grizzly-bear1.jpg', 'http://calgaryguardian.com/wp-content/uploads/2017/05/142_1289.jpg', 'https://cdn.abcotvs.com/dip/images/492803_012715-ss-grizzly-bears-img.jpg?w=1600', 'http://www.publicdomainpictures.net/pictures/90000/velka/grizzly-bear-profile.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-HD-Desktop.jpg', 'https://townsquare.media/site/101/files/2020/05/GrizzRS.jpg?w=1200', 'https://wallpapertag.com/wallpaper/full/e/b/8/437151-grizzly-bear-backgrounds-2560x1600-for-tablet.jpg', 'https://images.fineartamerica.com/images-medium-large-5/usa-alaska-grizzly-bear-cub-sits-brenda-tharp.jpg', 'https://external-preview.redd.it/bccjV-0WX40IgFdJ1FOy7_IE9nLPXR0wloCap7hXTSA.jpg?auto=webp&amp;s=a17fd3832e57032a5b44af94010a189e4e906ea6', 'https://defenders.org/sites/default/files/styles/meta_image/public/2019-04/grizzly_bear_sow_jim_peaco_nps_header.jpg?itok=vTdBffpn', 'https://outsider.com/wp-content/uploads/2020/08/grizzly-bear-hiker-glacier-national-park-video.png', 'https://i.cbc.ca/1.4174820.1506608673!/fileImage/httpImage/image.jpg_gen/derivatives/16x9_1180/grizzly-glares-at-viewer.jpg', 'https://ourplnt.com/wp-content/uploads/2020/12/grizzly-bear.jpg', 'https://spca.bc.ca/wp-content/uploads/WS2017_92846_Stephen-Lustig_Grizzly-Bear.jpg', 'https://braincharm.com/wp-content/uploads/2019/08/cropped-Grizzly-Bear-Bozeman-Grizzly-Montana-Bear-3483886.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-Wallpapers-HD.jpg', 'https://cdn.britannica.com/19/186719-050-887A6F2C/Grizzly-bear-Rocky-Mountains-Wyoming.jpg', 'http://www.pbs.org/wnet/nature/files/2018/07/Bear133.jpg', 'http://1.bp.blogspot.com/-CoOIzMhLQUI/UHzVx6IxyVI/AAAAAAAAA-c/RHMhnAXXniU/s1600/Grizzly+Bear+Sleepy.jpg', 'http://www.photos-public-domain.com/wp-content/uploads/2012/03/grizzly-bear.jpg', 'http://img.huffingtonpost.com/asset/1910_1000/58c0a5fe1d000027007cd5c0.jpg', 'http://blog.theclymb.com/wp-content/uploads/2014/09/angry-grizzly-bear.jpg', 'http://s3.amazonaws.com/Photo_of_the_Day/system/uploads/photo/image/12388/sized_Grizzly_Bear_Cubs.jpg', 'https://www.unilad.co.uk/wp-content/uploads/2015/08/UNILAD-mom-grizzly8.jpg', 'https://www.hoglezoo.org/wp-content/themes/hoglezoo_new/images/animal_finder/491283162GrizzlyBear.jpg', 'http://dawnsbrain.com/wp-content/uploads/2014/11/grizzly-bear-6.jpg', 'https://4.bp.blogspot.com/-2_RuGHXGm0Y/UQW3vwH37JI/AAAAAAAAEzc/Mt1seFmFrog/s1600/Grizzly-Bear-.jpg', 'https://i.ytimg.com/vi/zzJbkmOVgMI/maxresdefault.jpg', 'https://cdn.abcotvs.com/dip/images/1407687_062916-wtvd-file-grizzly-bear-img.jpg?w=1280&amp;r=16:9', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-Background-.jpg', 'https://devdenverzoo.com/wp-content/uploads/2018/09/Grizzly-Bear_04.jpg', 'http://www.montanaoutdoor.com/wp-content/uploads/2018/02/Grizzly-King-FEAT.jpg', 'https://outsider.com/wp-content/uploads/2020/06/Grizzly-Bear-Unsplash.png', 'http://www.wallpapergeeks.com/wp-content/uploads/2014/03/Grizzly-Bear-Near-McNeil-River-Alaska.jpg', 'https://outsider.com/wp-content/uploads/2020/09/two-grizzly-bears-brutally-fight-over-fish-in-alaska-1170x702.png', 'https://lh3.googleusercontent.com/proxy/XiCQkPJB2tAag16S3wO0yNJnMQXTpTzEOZw-eWQKr6nOaJhlqeJzHrDhPowuHfLQREfxRPAN9kjW-6KrwU8HUeBesZsH-nLKkYV2lr5NE5sXcRy5xwMqv9cbYYYNpEJnhJs=w1200-h630-p-k-no-nu', 'https://cottagelife.com/wp-content/uploads/2020/07/shutterstock_546562111.jpg', 'https://images.fineartamerica.com/images-medium-large-5/grizzly-bear-6-thomas-woolworth.jpg', 'https://redtri.com/wp-content/uploads/2014/07/grizzly-bear-2.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/grizzly-bear-twenty-two-north-photography.jpg', 'https://a57.foxnews.com/static.foxnews.com/foxnews.com/content/uploads/2019/06/931/524/iStock-grizzly-bear-and-cubs.jpg?ve=1&amp;tl=1', 'http://www.alaskaphotoworld.com/alaska365/wp-content/uploads/2013/06/Grizzly-Bear-Yukon-Alaska-c-Laurent-Dick-Wild-Alaska-Travel(pp_w1060_h657).jpg', 'http://mediad.publicbroadcasting.net/p/kufm/files/styles/x_large/public/201712/grizzly-bear-snow_pd.jpg', 'https://i.ytimg.com/vi/jR_U9AoAtJE/maxresdefault.jpg', 'http://www.marketwire.com/library/MwGo/2017/3/7/11G132324/Images/3_Bears_Approach_by_Jim_Lawrence-4f4d16b51311853286570ff0d3022a81.jpg', 'http://2.bp.blogspot.com/-e6e4YOB-K9I/UQEz1wt72TI/AAAAAAAAC0s/YZUgPnIwTks/s640/Grizzly+bear.jpg', 'https://media.spokesman.com/photos/2018/08/18/Grizzly_Bears_Montana.JPG.jpg', 'https://s3-assets.eastidahonews.com/wp-content/uploads/2015/10/03030033/0ad8593723.jpg', 'https://www.mtpr.org/sites/kufm/files/styles/x_large/public/201512/grizzly-bear_02-PD.jpg', 'https://www.indianz.com/News/2017/01/12/grizzlybearyellowstoneitingchiang.jpg', 'https://www.alloutdoor.com/wp-content/uploads/2019/08/Grizzly_Bear_Ursus_arctos_ssp..jpg', 'https://www.getwest.ca/site/assets/files/1049/uchuck-grizzly-bear.jpg', 'http://zooidaho.org/wp-content/uploads/2016/02/shonibear.jpg', 'http://www.cs.columbia.edu/~sedwards/photos/kyle200604/20060412-7108%20Grizzly%20bear.jpg', 'https://cdn.suwalls.com/wallpapers/animals/grizzly-bear-46852-1920x1200.jpg', 'http://wildlifewaystation.org/images/content/animals/Bear-Grizzly-2.JPG', 'http://2.bp.blogspot.com/-NjMTuklENdE/UHzVv_8dIxI/AAAAAAAAA-U/tNBsQDn8kFI/s1600/Grizzly+Bear+Pic.jpg', 'https://live.staticflickr.com/8078/8277276763_b4d8cff511_b.jpg', 'http://images.fineartamerica.com/images-medium-large/1-grizzly-bear-yukon-robert-postma.jpg', 'https://www.yourhikeguide.com/wp-content/uploads/scandinavian_wildlife_park_26-26995.jpg', 'http://bloximages.newyork1.vip.townnews.com/stltoday.com/content/tncms/assets/v3/editorial/b/99/b99156d5-0ad8-5b5c-a98a-d805c9a5d6bb/57eaaca236063.image.jpg?resize=1200%2C1369', 'http://www.tweedsmuirparklodge.com/assets/Uploads/_resampled/ScaleWidthWzEyMDBd/Grizzly-bear-with-fish-at-Tweedsmuir.jpg', 'https://1471793142.rsc.cdn77.org/data/images/full/27318/palm-beach-zoo-debuts-grizzly-bear-cubs.jpg', 'https://media.salon.com/2014/03/Grizzly-Bear.jpg', 'https://d3d0lqu00lnqvz.cloudfront.net/media/media/897b2e5d-6d4c-40fa-bbe8-6829455747e2.jpg', 'https://www.trbimg.com/img-5966ab20/turbine/ct-yellowstone-grizzly-scarface-killed-20170712', 'https://www.wyomingpublicmedia.org/sites/wpr/files/styles/x_large/public/202005/grizzly_and_cubs.png', 'https://cmkt-image-prd.freetls.fastly.net/0.1.0/ps/5129718/910/1365/m2/fpnw/wm1/mrkxj2x8a849nf6stvtxuofhydmjnf7slsysexqsuhadz3xaxi6ze1soz8huzzsg-.jpg?1538388129&amp;s=48c555641b232ab7c64b9c76b97a67bc', 'http://www.my-photo-blog.com/wp-content/uploads/2017/07/Grizzly-Bear-Nursing.jpg', 'https://i0.wp.com/pgdailynews.ca/wp-content/uploads/2017/12/Grizzly.jpg', 'https://www.naturalworldsafaris.com/~/media/images/blogs/2018/01/grizzly-bear-hunting-ban/mmr_2015-08-06_7055.jpg', 'http://i.huffpost.com/gen/1747973/images/o-GRIZZLY-BEAR-RAINFOREST-facebook.jpg', 'https://bloximages.chicago2.vip.townnews.com/trib.com/content/tncms/assets/v3/editorial/b/6c/b6c62d25-f84e-51b0-95ae-223fcd943312/57cc8795a69a1.image.jpg?resize=1200%2C800', 'https://www.readersdigest.ca/wp-content/uploads/2018/09/grizzly-bear-cub.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/grizzly-bear-judy-vincent.jpg', 'http://2.bp.blogspot.com/-9JAlJayP2XU/UQN3Wffpa8I/AAAAAAAAFbs/eMP5BcuLetc/w1200-h630-p-k-nu/Grizzly+Bear-2013-0pic-02.jpg', 'https://townsquare.media/site/99/files/2018/12/Bear.jpg?w=1200&amp;h=0&amp;zc=1&amp;s=0&amp;a=t&amp;q=89', 'http://www.hickerphoto.com/images/1024/alert-grizzly-bear-56745.jpg', 'https://s3.amazonaws.com/images.gearjunkie.com/uploads/2015/07/Grizzly-Bear.jpg', 'https://wildlifefriendly.org/wp-content/uploads/2015/09/Grizzly.jpg', 'https://www.thefencepost.com/wp-content/uploads/sites/12/2018/08/grizzlies-tsln-081118-1240x828.jpg', 'https://www.expeditionsalaska.com/wp-content/uploads/2017/04/16-brown-bear-photos-2377.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-Download.jpg', 'http://4.bp.blogspot.com/-QmwOWiR3ydM/USOj4DBjZSI/AAAAAAAAFBM/bvX4-MmH-tY/s1600/Grizzly_Bear_Info_Images+08.jpg', 'https://www.scitechnow.org/wp-content/uploads/2015/05/Ep27_Grizzly-Bears.jpg', 'https://whatthingsweigh.com/wp-content/uploads/grizzly_bear.jpg', 'https://www.huntingillustrated.com/wp-content/uploads/2014/03/Depositphotos_93855856_xl-2015-1-scaled.jpg', 'https://www.wildnatureimages.com/images/xl/080914-113-Grizzly-Bear.jpg', 'http://media1.s-nbcnews.com/j/newscms/2017_07/1905761/170217-grizzly-alaska-mn-1130_e938eae58cdfe33a8c5bd9af07356dd9.nbcnews-ux-2880-1000.jpg', 'https://i.ytimg.com/vi/-klfQbvz0Nw/maxresdefault.jpg', 'https://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/embed/public/2017/11/20/grizzly-bear.jpg', 'https://www.canadatravelspecialists.com/media/3362/bear-catching-salmon.jpeg', 'https://www.legendsofamerica.com/wp-content/uploads/2018/07/Grizzlybear-269x300.png', 'https://farm8.staticflickr.com/7026/6843888709_b6136360c8_z.jpg', 'https://i.cbc.ca/1.4775731.1533917302!/fileImage/httpImage/image.jpg_gen/derivatives/original_780/eyes-of-the-grizzly.jpg', 'http://mediad.publicbroadcasting.net/p/kufm/files/styles/x_large/public/201606/grizzly_PD.jpg', 'https://i1.wp.com/backcountryjourneys.com/wp-content/uploads/2015/12/bigstock-Grizzly-Bear-9532331.jpg', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/washington-grizzly-bear-og.jpg', 'https://www.expeditionsalaska.com/wp-content/uploads/2016/09/09_SEP3502.jpg', 'https://www.shared.com/content/images/2017/08/Ordelheide_20160803-_D5A7701_bearfamily.jpg', 'https://detroitzoo.org/wp-content/uploads/2015/08/Grizzly-Boys.jpg', 'https://filson-life.imgix.net/2020/03/grizzly-bear-reintroduction-1.jpg?fit=scale&amp;fm=pjpg&amp;h=573&amp;ixlib=php-1.2.1&amp;w=860&amp;wpsize=entry-main', 'https://cdn0.wideopenspaces.com/wp-content/uploads/2020/04/whatdogrizzlybearseat4-scaled.jpg', 'https://s3-assets.eastidahonews.com/wp-content/uploads/2019/05/06175149/grizzly-bear-860x571.jpg', 'https://cdn.s3-media.wbal.com/Media/2017/03/22/ac89e9aa-1e3f-4f88-bef3-aeba490d0059/original.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/GrizzlyBearJeanBeaufort.jpg/1200px-GrizzlyBearJeanBeaufort.jpg', 'https://gray-kmvt-prod.cdn.arcpublishing.com/resizer/XDqt0Wh9pw0QyVfKY5V7d77a44o=/1200x675/smart/cloudfront-us-east-1.images.arcpublishing.com/gray/XDDLIRAFIRMF7KDSS56OJSWEIQ.jpg', 'https://miro.medium.com/max/9504/1*1cfuPs8clxIj8f_CDH4sYw.jpeg', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/Idaho-grizzly-bear-hunt-approved-og.jpg', 'https://bloximages.chicago2.vip.townnews.com/ravallirepublic.com/content/tncms/assets/v3/editorial/9/05/90555037-3848-5130-a254-aca92323e46f/5c87f956c8b30.image.jpg?resize=1200%2C755', 'https://media.spokesman.com/photos/2017/11/30/Yellowstone_Grizzlies.JPG.jpg', 'https://www.wpxi.com/resizer/e8abHzJalKpN_CfzbIS07FZBOig=/1200x628/d1hfln2sfez66z.cloudfront.net/09-24-2020/t_82d50577f56b4e2fa00191d8f33c12fe_name_Moose_hunter_mauled__killed_by_grizzly_bear_in_Alaska_Poster.jpg', 'https://bloximages.chicago2.vip.townnews.com/helenair.com/content/tncms/assets/v3/editorial/6/45/645660ec-59b9-58a0-a7d7-213e342af246/5a02181673916.image.jpg', 'https://i2.wp.com/nypost.com/wp-content/uploads/sites/2/2020/09/grizzly-bear-89.jpg?quality=90&amp;strip=all&amp;ssl=1', 'https://www.grandviewoutdoors.com/uploads/images/_facebook/Grizzly.jpg', 'https://i1.wp.com/nypost.com/wp-content/uploads/sites/2/2020/05/grizzly-bear-57.jpg?quality=90&amp;strip=all&amp;ssl=1', 'https://images.fineartamerica.com/images-medium-large-5/grizzly-bear-with-yearling-cub-matthias-breiter.jpg', 'https://davidsuzuki.org/wp-content/uploads/2017/04/grizzly-bears-alaska-wildlife-sanctuary-whittier.jpg', 'https://www.campbellriver.travel/media/2020/02/bear-ears1.jpg', 'https://3.bp.blogspot.com/-ERmaouEbCOw/ThYPiIH9ACI/AAAAAAAAB4E/AzbPHNqSMxE/s1600/Feeling_Grizzly-1600x1200.jpg', 'http://www.famouscutouts.com/images/detailed/0/675-Bear.jpg', 'https://cdn.apartmenttherapy.info/image/upload/f_auto,q_auto:eco,c_fill,g_auto,w_1500/at/news-culture/2019-11/grizzly-bear', 'http://1.bp.blogspot.com/-wzfvrOdkAao/USOjE-6mdDI/AAAAAAAAFAg/GRopRcG-p1k/s1600/Grizzly_Bear_Info_Images+01.jpg', 'http://static.independent.co.uk/s3fs-public/thumbnails/image/2016/06/30/08/yellowstone-grizzly-bear-.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/5004711979_d7bbce11c4_o.jpg', 'https://www.tsln.com/wp-content/uploads/2018/10/bears-tsln-101318-1-1240x823.jpg', 'https://i1.wp.com/www.animalprotectionparty.ca/wp-content/uploads/2017/10/grizzly-bear-report.jpg?fit=1072%2C712&amp;ssl=1', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/grizzly-bear-og_0.jpg', 'http://i.huffpost.com/gen/1390652/images/o-GRIZZLY-BEAR-ROAR-facebook.jpg', 'https://wallsdesk.com/wp-content/uploads/2017/01/Grizzly-Bear-HD.jpg', 'https://thenarwhal.ca/wp-content/uploads/2018/04/BC-grizzly-bear.jpg', 'https://www.vmcdn.ca/f/files/via/import/2018/07/08143100_grizzly-bear.jpg;w=960', 'https://wyo4news.com/wp-content/uploads/2020/07/grizzly-bear.jpg', 'https://cdn.shopify.com/s/files/1/1520/0394/products/Grizzly_bear.jpg?v=1541529305', 'https://bozone.com/site/wp-content/uploads/2019/03/GRIZZLY.jpeg', 'http://www.news1130.com/wp-content/blogs.dir/sites/9/2015/09/17/iStock_000010656016_Double-e1442507974878.jpg', 'http://static-21.sinclairstoryline.com/resources/media/6078265b-815a-4172-a17f-67f94d69e53c-large16x9_ImportedfromLakana.jpg?1514431909725', 'https://4.bp.blogspot.com/-HNxOANqzIwQ/Un_rDbUxCGI/AAAAAAAABUc/CpX9FRsAdLA/s1600/Grizzly_Bear_2.jpg', 'https://cdn4.creativecirclemedia.com/powell/original/20190926-083657-Griz.jpg', 'https://tetonvalleylodge.com/wp-content/uploads/2015/04/grizzly-bear-idaho.jpg', 'https://idahobusinessreview.com/files/2018/08/grizzly-bear-scaled.jpg', 'https://cdn0.wideopenspaces.com/wp-content/uploads/2017/08/grizzly.jpg', 'https://holidayarchitects.co.uk/canada-holidays/wp-content/uploads/sites/7/Grizzly-bear-3-CRWW.jpg', 'https://imgc.allpostersimages.com/img/print/u-g-PZLADY0.jpg?w=338&amp;h=450', 'http://1.bp.blogspot.com/-422rK0Kje1E/UQW3yELFQeI/AAAAAAAAEzs/Rcg4Gniz4rU/s1600/Grizzly-Bear-2.jpg', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/Grizzly-bear-protections-west-OG.jpg', 'https://cdnph.upi.com/sv/ph/og/upi/9261403133345/2014/1/f6484c26a086306575f2eabf184d2d11/v1.5/Conservationists-push-to-triple-Americas-grizzly-bear-population.jpg', 'https://www.the-sun.com/wp-content/uploads/sites/6/2020/09/NINTCHDBPICT000512282491.jpg?strip=all&amp;quality=100&amp;w=1200&amp;h=800&amp;crop=1', 'https://www.wyofile.com/wp-content/uploads/2013/09/blondie-the-griz2_Jackie-Skaggs_June-2011.jpg']
    Images downloaded.
black bear: Got 278 image URLs. Downloading...
   urls =  ['https://scx2.b-cdn.net/gfx/news/hires/2019/blackbear.jpg', 'https://www.seacoastonline.com/storyimage/SO/20190730/NEWS/190739992/AR/0/AR-190739992.jpg', 'https://www.theintell.com/storyimage/PA/20190610/NEWS/190619908/AR/0/AR-190619908.jpg', 'https://www.enr.gov.nt.ca/sites/enr/files/black_bear_banner.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/02/american-black-bear-2.jpg', 'https://www.gannett-cdn.com/-mm-/870435c5930644f2716846ecf8ba7354bdf4dead/c=0-414-862-901/local/-/media/2018/07/09/Westchester/Westchester/636667658911415885-Armonk-bear-3.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://wallup.net/wp-content/uploads/2019/09/719345-baribal-black-bear-bear-muzzle-eyes-predator.jpg', 'https://www.visitmt.com/binaries/content/gallery/MTOT/responsive/hero-f/dec-2014/blackbear_subjectmatterlandinghero.jpg', 'https://d3i3l3kraiqpym.cloudfront.net/wp-content/uploads/2016/05/26232920/12079543_847437148710024_685610861999970941_n.jpg', 'http://www.adirondackexplorer.org/wp-content/uploads/2016/12/17-Black-bear-Raquette.jpg', 'https://static1.pointsinfocus.com/2017/12/black-bears-of-revillagigedo-island-ketchikan-alaska/Fat-Bear.jpg', 'https://outsider.com/wp-content/uploads/2020/10/black-bear-encounter-how-to-prevent-survive-attack.jpg', 'https://nypost.com/wp-content/uploads/sites/2/2014/10/black-bear-cub.jpg?quality=90&amp;strip=all&amp;w=1200', 'http://www.stgeorgeutah.com/wp-content/uploads/2015/11/lynn_11-22-2011_black_bear_1.jpg', 'http://bearsmartdurango.org/wp-content/uploads/2013/06/100_0642.jpg', 'https://alaskashoreexcursions.com/media/ecom/prodxl/Baby-Black-Bear.JPG', 'https://www.fascinationwildlife.com/wp-content/uploads/2018/11/TON6447_DxO.jpg', 'http://www.canadianrockies.net/wp-content/uploads/2012/03/blb0389_bigblackbear.jpg', 'https://i.cbc.ca/1.3267259.1444652249!/fileImage/httpImage/image.jpg_gen/derivatives/16x9_620/black-bear.jpg', 'https://binderparkzoo.org/wp-content/uploads/2017/10/black-bear-5-1024x683.jpg', 'http://www.camelcitydispatch.com/wp-content/uploads/2013/05/black-bear-stting-face-on.jpg', 'https://www.huntingnewfoundlandlabrador.com/-/media/marquees/hunting/hunting-species/black-bear/black-bear-main-header.jpg?mh=960&amp;mw=1280&amp;hash=935A53A530E3F07AFB9DC4FF03D08C8B103FD601', 'https://www.gofingerlakes.org/wp-content/uploads/Ursus_americanus_Simon-Pierre-Barrette.CC-BY-SA-004-1.jpg', 'http://elelur.com/data_images/mammals/asian-black-bear/asian-black-bear-04.jpg', 'https://www.cullmantribune.com/wp-content/uploads/2019/08/Black-bear-mother-and-cubs-1024x835.jpg', 'http://3.bp.blogspot.com/_1N1pZVb1_C4/TUCDSYH2XuI/AAAAAAAABU4/N-8QVjyjpiA/s1600/bear_black.jpg', 'http://naturalbridgezoo.com/wp-content/uploads/2017/05/BB1-1.jpg', 'https://live.staticflickr.com/3223/2762479597_07c4b2f908_b.jpg', 'http://grizzlybearwatching.com/wp-content/uploads/2017/03/BlackBear1-1500x998.jpg', 'https://en.reepark.dk/media/1613/_n011753.jpg?width=1024', 'https://render.fineartamerica.com/images/rendered/default/print/8.000/7.000/break/images/artworkimages/medium/2/bear-stare-jerry-lofaro.jpg', 'http://cdn-image.travelandleisure.com/sites/default/files/styles/1600x1000/public/1522685410/black-bear-BEAR418.jpg?itok=qmoXuFRx', 'https://exploreoakridge.com/wp-content/uploads/2019/10/American-Black-Bear-photo-by-Chris-Norcott.jpg', 'https://cottagelife.com/wp-content/uploads/2017/07/shutterstock_503744119.jpg', 'https://i0.wp.com/imagineourflorida.org/wp-content/uploads/2016/09/Florida_Black_Bear_square_Kon_Studio.jpg?fit=800%2C800&amp;ssl=1', 'https://2.bp.blogspot.com/-bMCoR7-d0SU/TmstJPh8sOI/AAAAAAAAAPo/4J5H-Mm2qEM/s1600/black-bear-wallpaper-11-755660.jpg', 'http://infotel.ca/news/medialibrary/image/orig-mediaitemid22167-3862.jpg', 'http://www.sott.net/image/s13/261520/full/Black_bear.jpg', 'https://downeast.com/wp-content/uploads/2014/02/Bear4.jpg', 'https://visitadirondacks.com/sites/default/files/images/adirondack-black-bear.jpg', 'https://www.vpr.org/sites/vpr/files/styles/x_large/public/202007/black-bear-fish-wildlife-dept-Tom-Rogers-2013.png', 'http://www.mountaincountrycabinrentals.com/wp-content/uploads/2014/10/Closeup-of-a-black-bear.jpg', 'https://nypost.com/wp-content/uploads/sites/2/2020/08/black-bear-81.jpg?quality=90&amp;strip=all&amp;w=1200', 'https://bear.org/wp-content/uploads/2008/02/20130607_Bow-copy.jpg', 'https://st.focusedcollection.com/14026668/i/1800/focused_181901682-stock-photo-american-black-bear-ursus-americanus.jpg', 'https://www.gulflive.com/resizer/XxMMGfEvOQQAVOEKfieknpQOIv8=/1280x0/smart/advancelocal-adapter-image-uploads.s3.amazonaws.com/image.gulflive.com/home/gulf-media/width2048/img/news_impact/photo/bears-threatened-fbdfb579fa67c166.jpg', 'https://wildlife.utah.gov/news_photos/11-18-19_black-bear-in-grass.jpg', 'https://www.piecebypiece.ca/wp-content/uploads/2018/05/165-Black-Bear-Cub.jpg', 'https://www.hdwallpapers.in/download/black_bear_hd_animals-HD.jpg', 'https://www.greatswamp.org/wp-content/uploads/2016/01/black-bear.jpg', 'http://getwallpapers.com/wallpaper/full/a/8/4/1452654-wallpaper-black-bear-pictures-2560x1600-for-4k.jpg', 'https://beartrackoutfitters.com/wp-content/uploads/2018/09/bear.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/02/american-black-bear-smell.jpg', 'http://upload.wikimedia.org/wikipedia/commons/1/18/Black_Bear_7.jpg', 'http://snowbrains.com/wp-content/uploads/2015/08/American-Black-Bear-jpg.jpg', 'https://vignette.wikia.nocookie.net/parody/images/5/5a/11775722235_19bb44c6e7_b.jpg/revision/latest?cb=20161008190514', 'https://www.wildlifecenter.org/sites/default/files/patient_images/DSCN2925.JPG', 'https://media-cdn.wehco.com/img/photos/2020/12/11/blackbearnoppers06cmykoriginal1483610356_t1070_h5b279ad6a60bb8d6261090d0367921ea9d3e0cc8.jpg', 'https://www.gannett-cdn.com/-mm-/ba9293e2ff57f90c5ea896bbb7fb36126f38dbc9/c=0-134-3468-2093/local/-/media/2016/06/28/CNYGroup/Elmira/636027114617396897-black-bear.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://bearexpert.com/wp-content/uploads/2019/10/american-black-bear.jpg', 'https://cdn2.outdoorphotographer.com/gallery/7522/leahed_100307_589944_290c530a74_28f7de1b95-leahed-dsc_9774.jpg', 'https://onncg8dr7k-flywheel.netdna-ssl.com/wp-content/uploads/2020/10/GettyImages-1195788516.jpg', 'https://www.gannett-cdn.com/-mm-/cd26c8713e884a8483a3eb4efd7e9b47f526e46d/c=0-264-4620-2863/local/-/media/Bridgewater/2015/01/05/B9315749966Z.1_20150105153333_000_GUS9JJHMR.1-0.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://www.mlive.com/resizer/Klh1maBtQ2BXs9MJ79W4mVfcL8k=/1280x0/smart/advancelocal-adapter-image-uploads.s3.amazonaws.com/image.mlive.com/home/mlive-media/width2048/img/outdoors_impact/photo/black-bears-new-exhibit-at-binder-park-zoo-07-a88a34fbe0690fea.jpg', 'https://texnat.tamu.edu/files/2018/07/IMG_1573.jpg', 'https://photos1.blogger.com/blogger/5712/2802/1600/DSC01502.jpg', 'https://bloximages.newyork1.vip.townnews.com/pilotonline.com/content/tncms/assets/v3/editorial/e/d5/ed52c12b-4e68-5024-a886-f0fc147bf94e/563d906095138.image.jpg', 'https://img1-azrcdn.newser.com/image/1255962-12-20190904134100.jpeg', 'https://www.gravel.org/wp-content/uploads/2015/10/Black-Bear.jpg', 'https://3.bp.blogspot.com/-nFt10gfJrzM/UDKIjeW21LI/AAAAAAAADfA/uomt-SjA-Sc/s1600/IMG_5635.jpg', 'https://www.crozetgazette.com/wp-content/uploads/2018/06/iStock-153562011.jpg', 'https://images.thestar.com/-S-RKsYxNaEcCX0LRaqhNeLpMAs=/1200x932/smart/filters:cb(1565190981014)/https://www.thestar.com/content/dam/thestar/vancouver/2019/08/06/child-injured-by-bear-bite-at-greater-vancouver-zoo-officials-say/blackbear.jpg', 'https://socalguidedhunts.com/wp-content/uploads/2013/09/guided-black-bear-hunts.jpg', 'https://seniors101.ca/wp-content/uploads/2015/08/Black-bear-cub.jpg', 'https://www.koamnewsnow.com/content/uploads/2020/05/pixabay-black-bear.jpg', 'https://www.gannett-cdn.com/-mm-/40756a948d5a0edcc7ce6d0e16b133540995c9c8/c=0-138-1997-1266/local/-/media/2017/03/06/JacksonMS/JacksonMS/636243918786987260-0307bear01.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://www.wallpaperflare.com/static/805/363/779/bear-black-bear-forest-black-wallpaper.jpg', 'https://img.huffingtonpost.com/asset/5d71a56a2500007a1205d0b4.jpeg?cache=i3bilfyydx&amp;ops=1778_1000', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/one-big-black-bear-john-rowe.jpg', 'http://i.huffpost.com/gen/1105509/images/o-MARYLAND-BLACK-BEAR-facebook.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/02/black-bear.jpg', 'https://blog.humanesociety.org/wp-content/uploads/2016/06/BLACK-BEAR-ISTOCK_000046186676_288801-1220x813.jpg', 'https://aldf.org/wp-content/uploads/2018/05/blackbear-121274561-16x9.jpg', 'https://www.timberon.org/wp-content/uploads/Young_black_bear.jpg', 'https://www.outsideonline.com/sites/default/files/styles/img_600x600/public/2019/06/28/black-bear-grazes_s.jpg?itok=ZaqoTZKg', 'https://a-z-animals.com/media/Asiatic-black-bear.jpg', 'https://www.worldlandtrust.org/wp-content/uploads/2019/07/youung-black-bear.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/bear-family-timothy-flanigan.jpg', 'https://nhpbs.org/wild/images/blackbearusfw2.jpg', 'https://a57.foxnews.com/a57.foxnews.com/static.foxnews.com/foxnews.com/content/uploads/2018/09/640/320/1862/1048/Black20Bear20iStock.jpg?ve=1&amp;tl=1?ve=1&amp;tl=1', 'https://www.gannett-cdn.com/presto/2019/05/08/PASH/9be97cd2-c85d-4eb6-a503-68b17b29ce94-NC_Bear_study_NO27_resting_after_work_up.jpg?crop=639,359,x0,y23&amp;width=3200&amp;height=1680&amp;fit=bounds', 'https://abdnews.org/wp-content/uploads/2017/04/Authorities-Rescue-Black-Bear-Cubs-After-Mother-Hit-By-Truck.jpg', 'http://blog.healthywildlife.ca/wp-content/uploads/2016/07/black-bear-hg-1-of-1.jpg', 'https://www.vmcdn.ca/f/files/via/import/2019/10/01132841_black-bear.jpg;w=700;h=347;mode=crop', 'https://advancelocal-adapter-image-uploads.s3.amazonaws.com/image.pennlive.com/home/penn-media/width2048/img/pa-sportsman/photo/23770296-standard.jpg', 'http://wildlife.org/wp-content/uploads/2015/01/Florida-Blackbear-via-Flickr-credit-Rich-Turner-940.jpg', 'http://snowbrains.com/wp-content/uploads/2015/08/connie-lemperle-black-bear-web.jpg', 'https://detroit.cbslocal.com/wp-content/uploads/sites/15909782/2015/05/black-bear-forest.jpg?w=1500', 'https://www.gannett-cdn.com/-mm-/4f6c5cb86bdd5d6da988b998c98d5233eb4312d0/c=0-250-4921-3030/local/-/media/2017/12/30/Tallahassee/Tallahassee/636502285489982021-Black-Bears.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://www.poconorecord.com/storyimage/PR/20161114/NEWS/161119826/AR/0/AR-161119826.jpg', 'https://floridablackbearscenicbyway.org/wp-content/uploads/2020/02/2411420-1920x1080-DesktopNexus.com_.jpg', 'http://www.wildernesscollege.com/images/blkbr-face.jpg', 'https://www.trbimg.com/img-557b8359/turbine/ct-indiana-black-bear-20150612', 'http://wiseaboutbears.org/wp-content/uploads/2014/04/img034.jpg', 'https://img.thrfun.com/img/214/282/bears_tx3.jpg', 'http://www.sciencebuzz.org/sites/default/files/images/Black_bear.jpg', 'http://i.huffpost.com/gen/1669786/images/o-BLACK-BEAR-CANADA-facebook.jpg', 'https://images.wallpaperscraft.com/image/bear_black_bear_forest_113045_800x1200.jpg', 'https://storage.googleapis.com/afs-prod/media/media:c1a9aa6b7050465d83977305953495aa/3000.jpeg', 'https://www.wildnatureimages.com/images/xl/140729-016-Black-Bear-at-Anan-Wildlife-Observatory.jpg', 'https://brevardzoo.org/wp-content/uploads/2019/05/bearsidebar.jpg', 'https://canadaintherough.com/wp-content/uploads/2020/06/blackbear.jpg', 'https://i1.wp.com/albertawild.com/wp-content/uploads/2017/02/bear-1698.jpg?fit=1698%2C1132', 'http://mediad.publicbroadcasting.net/p/upr/files/styles/x_large/public/201612/black-bear.jpg', 'http://www.encyclopediaofalabama.org/images/m-9033.jpg', 'http://bloximages.newyork1.vip.townnews.com/pilotonline.com/content/tncms/assets/v3/editorial/8/47/84743c51-975b-555f-9f30-1234790e97a8/563d905fe2c27.image.jpg?resize=1200%2C852', 'http://bearlegend.com/wp-content/uploads/2012/04/2641024724_d12e4afcb9_o-361.jpg', 'https://images.dailyhive.com/20190916163711/North-Shore-Black-Bear-Society.jpg', 'https://s29027.pcdn.co/wp-content/uploads/2019/08/Black-Bear-mating-Tekiela-TEK1811.jpg', 'https://someinterestingfacts.net/wp-content/uploads/2016/07/American-black-bear.jpg', 'https://media.gettyimages.com/photos/black-bear-standing-in-rocky-stream-british-columbia-canada-picture-id974154560', 'http://www.toledoblade.com/image/2013/01/21/black-bear.JPG', 'https://www.thehuntingpage.com/wp-content/uploads/sites/2/2014/01/o-BLACK-BEAR-facebook.jpg', 'https://cdn-image.travelandleisure.com/sites/default/files/styles/1600x1000/public/1572373216/black-bear-tennessee-BEARLODGE1019.jpg?itok=jO4eurBD', 'http://4.bp.blogspot.com/-YS1MBBAHGPs/TjkTZIS8WGI/AAAAAAAABi0/alssUhDH3Pk/s1600/Baby+black+bears+3.jpg', 'https://www.transylvaniatimes.com/home/cms_data/dfault/photos/stories/id/9/1/41091/s_top', 'https://www.wsls.com/resizer/fmqqOp8dNrEIIDxQOlsBSRip5KY=/1600x1333/smart/filters:format(jpeg):strip_exif(true):strip_icc(true):no_upscale(true):quality(65)/arc-anglerfish-arc2-prod-gmg.s3.amazonaws.com/public/3VGIKDGQDNAY5I4NO7KP4ZX5N4.jpg', 'https://mediad.publicbroadcasting.net/p/wvtf/files/styles/x_large/public/201607/AP_608334627084.jpg', 'https://gothunts.com/wp-content/uploads/2019/06/Black-Bear-scaled.jpeg', 'http://www.visitmysmokies.com/wp-content/uploads/2013/08/Black-Bear-Cub.jpg', 'https://cdn.audleytravel.com/-/-/79/160033025091139069040022125202060038124167252088.jpg', 'http://2.bp.blogspot.com/-oL5wK6KYI7M/UBji1ikDXXI/AAAAAAAAAMY/jmXUpXVGet4/s1600/Black-Bear-05.jpg', 'https://www.montanaoutdoor.com/wp-content/uploads/2018/05/bear6.jpg', 'http://2.bp.blogspot.com/_1N1pZVb1_C4/TUCDn6EEngI/AAAAAAAABVA/h6BmG9TLADA/s1600/Black+Bear+159087.jpg', 'https://www.oregonlive.com/resizer/nSifR1unuKEMPswzQtebZRI_03g=/600x0/arc-anglerfish-arc2-prod-advancelocal.s3.amazonaws.com/public/6GF72P3X25EXVLEKGSGVXUJRKI.png', 'http://someinterestingfacts.net/wp-content/uploads/2016/07/Black-bear.jpg', 'https://www.remotelands.com/travelogues/app/uploads/2019/07/AsiaWire-BearReturn-2.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/7-maine-black-bear-sharon-fiedler.jpg', 'https://d.ibtimes.co.uk/en/full/1611947/black-bear.jpg', 'https://animalhype.com/wp-content/uploads/2019/12/How-Fast-Do-Black-Bears-Run-1024x682.jpg', 'http://uffmannatureimages.net/wp-content/uploads/2012/07/20120519-_Q2C6428Black-Bears-save-for-web-cs6.jpg', 'https://www.gannett-cdn.com/presto/2019/01/02/PASH/bff6ff36-67d2-44be-bdda-0d5e29cda4e1-Black_bear_Ken_Taylor.jpg?crop=1796,1007,x0,y0&amp;width=3200&amp;height=1680&amp;fit=bounds', 'https://wildlife.org/wp-content/uploads/2015/07/Black-Bear-Reintroduction-Image-1-600.jpg', 'https://imgc.allpostersimages.com/img/print/posters/barrett-hedges-a-large-black-bear-ursus-americanus-moves-quickly-over-the-rocks_a-L-13725186-4990831.jpg', 'http://www.wildernessrealty.com/wp-content/uploads/2015/02/Maine-Black-Bear.jpg', 'http://cdn0.wideopenspaces.com/wp-content/uploads/2014/10/bigstock-Black-bear-cub-62558696.jpg', 'http://archery360.com/wp-content/uploads/2014/06/black-bear-cub.jpg', 'https://www.wideopenspaces.com/wp-content/uploads/2020/09/wisconsinblackbear.jpg', 'https://cdn.extra.ie/wp-content/uploads/2018/05/15124559/Black-bear-1.jpg', 'https://2.bp.blogspot.com/-oMj7lKf-Lb8/UMJTf68A6SI/AAAAAAAABfw/L91dawds-Nk/s1600/black-bear-photos-2012+03.jpg', 'https://i.cbc.ca/1.4130464.1495668985!/fileImage/httpImage/image.jpg_gen/derivatives/16x9_780/black-bear.jpg', 'http://content.wzzm13.com/photo/2015/10/09/635799990906985114-ThinkstockPhotos-178500326_40932_ver1.0.jpg', 'http://www.my-photo-blog.com/wp-content/uploads/2014/07/Black-Bear-Cub.jpg', 'https://www.massaudubon.org/var/ezdemo_site/storage/images/media/departments/lww/mammals/images/black-bear/black-bear-standing-up-next-to-tree-c-karen-karlberg-500vert/196541-4-eng-US/black-bear-standing-up-next-to-tree-c-karen-karlberg-500vert_blockitemmedium.jpg', 'https://www.grandviewoutdoors.com/uploads/images/BlackBearUSFWS_181004_111434.jpg', 'https://mediad.publicbroadcasting.net/p/wusf/files/styles/x_large/public/201504/black_bear_closeup_gary_langley.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/6-american-black-bear-cub-david-kenny.jpg', 'https://www.coniferousforest.com/wp-content/uploads/2016/08/American-Black-Bear.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/10/asiatic-black-bear-5.jpg', 'https://www.gannett-cdn.com/presto/2019/12/30/PKNS/e7f38dd1-a441-4cc3-a48a-1df9445344de-KNS-Zoo_Knoxville_Bears_BP_3.JPG?width=540&amp;height=&amp;fit=bounds&amp;auto=webp', 'https://miro.medium.com/max/6014/1*sGT7ccEjG6KF0-UjdsJ3nQ.jpeg', 'https://wildlife.org/wp-content/uploads/2017/03/blackbear.png', 'https://bearexpert.com/wp-content/uploads/2020/08/american-black-bear-6.jpg', 'http://cdn0.wideopenspaces.com/wp-content/uploads/2015/12/BlackBearMass.jpg', 'http://dnr.maryland.gov/wildlife/PublishingImages/Maryland-Bear-Stamp-Winning-Artwork-19-20.jpg', 'http://www.thestar.com/content/dam/thestar/news/gta/2015/06/01/black-bear-cornered-in-newmarket-backyard/bear-file.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/2015-08-07_Black_Bear_near_Stewart%2C_BC_1090.jpg/1280px-2015-08-07_Black_Bear_near_Stewart%2C_BC_1090.jpg', 'http://www.adirondackalmanack.com/wp-content/uploads/2017/05/blackbear.jpg', 'https://www.coniferousforest.com/wp-content/uploads/2016/08/American-Black-Bear-Cubs.jpg', 'http://strangesounds.org/wp-content/uploads/2014/08/bear-cubs-photo.jpg', 'https://bear.org/wp-content/uploads/2017/10/Serious-Bear.jpg', 'https://thelaurelofasheville.com/wp-content/uploads/2016/06/Carolina_Nature_Photographers_Association-Black_Bear-6.jpg', 'https://yukon.ca/sites/yukon.ca/files/env/env-imgs/env-black-bear_0.jpg', 'https://www.victoriabuzz.com/wp-content/uploads/2019/08/black-bear-unsplash.jpg', 'https://media.spokesman.com/photos/2017/07/04/BLACK_BEAR.JPG.jpg', 'http://yesofcorsa.com/wp-content/uploads/2018/10/American-Black-Bear-Best-Wallpaper-1024x753.jpg', 'https://wallup.net/wp-content/uploads/2019/09/300546-minnesota-black-bear.jpg', 'https://cdn1.theweek.co.uk/sites/theweek/files/2016/10/161026_black_bear.jpg', 'https://bloximages.newyork1.vip.townnews.com/swnewsmedia.com/content/tncms/assets/v3/editorial/7/1a/71a9b7ca-1825-5fdd-9534-5a7c30ac10c8/5d444ec6ac2d5.image.jpg', 'https://quincy-network.s3.ca-central-1.amazonaws.com/wp-content/uploads/sites/37/2020/06/MGN_1280x960_70623P00-TYOFD-860x645.jpg', 'http://www.karelianbeardog.us/photos/outdoor/blackbears/Black%20bear.jpg', 'https://brevardzoo.org/wp-content/uploads/2019/05/bearmain.gif', 'http://justfunfacts.com/wp-content/uploads/2017/10/asiatic-black-bear-2.jpg', 'http://ovlc.org/wp-content/uploads/2014/07/black_bear.jpg', 'https://cdn0.wideopenspaces.com/wp-content/uploads/2017/02/black-bear-feature.jpg', 'https://nhpbs.org/wild/images/blackbearusfw1.jpg', 'http://uffmannatureimages.net/wp-content/uploads/2012/07/20120518-KQ2C5610Black_Bears-Edit-692x1024.jpg', 'https://www.raincoast.org/wp-content/uploads/2019/12/black-bear-diane-bb-v1.1.jpg', 'https://gohunt-assets-us-west-2.s3.amazonaws.com/media/Large-Montana-black-bear.jpg', 'http://www.hww.ca/kaboom/images/Mammals/Black-Bear/Black-Bear-David-Cracknell.jpg', 'http://2.bp.blogspot.com/-yc7X_uO7iMM/UA7U_q5_NtI/AAAAAAAAAqI/72EaqVglzPM/s1600/black-bear.jpg', 'https://d.newsweek.com/en/full/1092319/black-bear.jpg', 'https://www.grandviewoutdoors.com/uploads/images/_facebook/Black-Bear-Sweepstakes-beauty.jpg', 'http://3.bp.blogspot.com/-vwLa2VwfXg4/Ul6IwR1sIJI/AAAAAAAABYw/INnD5gQH-dM/s1600/Black-Bear.jpg', 'http://wyrz.org/wp-content/uploads/2016/07/black_bear.jpg', 'https://www.gannett-cdn.com/-mm-/98e9eb0055148d8550b3a7d264f19fd6462e6062/c=0-213-4288-2636/local/-/media/2017/03/22/CarolinaGroup/Asheville/636257813777562324-Black-bear-Getty-images.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://floridawildlifefederation.org/wp-content/uploads/2020/04/black-bear-scaled-e1598566846480.jpg', 'https://www.stgeorgeutah.com/wp-content/uploads/2015/01/lynn_11-22-2011_black_bear_6-1.jpg', 'https://bento.cdn.pbs.org/hostedbento-prod/gallery/20170713_222850_315402black-bear-01-gettyimages-155467721.jpg.1280x720_q85.jpg', 'https://dehayf5mhw1h7.cloudfront.net/wp-content/uploads/sites/301/2020/06/26101300/bear-illinois-dnr.jpg', 'http://2.bp.blogspot.com/-MKgsmEatcvk/UKuf-CiWdFI/AAAAAAAACQU/VPvHckGI7DA/s1600/Black_bear_large.jpg', 'https://kanati.com/wp-content/uploads/black-bear-life-size-mount_poseBB109-feature.png', 'https://compote.slate.com/images/0a308e2c-48e2-476a-ad72-61c20aa92709.jpg', 'https://external-preview.redd.it/ieT9RTLmwvN4hfQBYix4109CLYniR3fSUAeT6jg6kO0.jpg?auto=webp&amp;s=4f2ec1a52f7c1f5b16238503377981645c54ae27', 'http://wallpapersdsc.net/wp-content/uploads/2017/10/Black-Bear-Background.jpg', 'https://www.gannett-cdn.com/-mm-/2b06f05d8e31b4112ec2ecbca6e9ef0db0cf4d0b/c=0-108-2125-1309/local/-/media/2016/05/18/Wilmington/Wilmington/635991906230694281-black-bear.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://i.ytimg.com/vi/-2cj5pPe778/maxresdefault.jpg', 'https://www.outdoorrevival.com/wp-content/uploads/2017/04/american-black-bear.jpg', 'https://www.pennlive.com/resizer/zKZdn6cmyoUATjOlNY4O_OEWRTI=/1280x0/smart/advancelocal-adapter-image-uploads.s3.amazonaws.com/image.pennlive.com/home/penn-media/width2048/img/pa-sportsman/photo/black-bear-8789aeebd5c67247.jpg', 'http://www.hww.ca/kaboom/images/Mammals/Black-Bear/Black-Bear-Elliott-Fotherby.jpg', 'http://www.hdnicewallpapers.com/Walls/Big/Bear/Animal_Black_Bear_Wallpaper.jpg', 'https://biologydictionary.net/wp-content/uploads/2020/09/shutterstock_1452356795-1.jpg', 'http://theazaleainnbb.com/wp-content/uploads/2018/07/black-bear.jpg', 'https://wallpapercave.com/wp/wp3102474.jpg', 'https://www.simplemost.com/wp-content/uploads/2019/06/AdobeStock_122783246.jpeg', 'https://onekindplanet.org/wp-content/uploads/2017/09/blackbear.jpg', 'https://images.fineartamerica.com/images-medium-large-5/baby-black-bear-jack-nevitt.jpg', 'http://www.wildlifecenter.org/sites/default/files/patient_images/Black_Bear/DSCN6285.JPG', 'https://audubonnatureinstitute.org/images/600x450/zoo/black-bear-600.jpg', 'https://bear.org/wp-content/uploads/2008/01/Bear-by-lake-looking.jpg', 'https://cottagelife.com/wp-content/uploads/2019/02/Cottage-Life-Black-Bear-cub.jpg', 'https://images.axios.com/WACso7e7dbhjup_i7iVfclq3BdI=/0x322:4288x2734/1920x1080/2018/05/22/1527002317479.jpg', 'https://northdakotawildlifefederation.org/wp-content/uploads/2020/02/black-bear.jpg', 'https://a57.foxnews.com/a57.foxnews.com/static.foxnews.com/foxnews.com/content/uploads/2018/11/640/320/1862/1048/louisiana-black-bear.jpg?ve=1&amp;tl=1?ve=1&amp;tl=1', 'https://www.montanaoutdoor.com/wp-content/uploads/2015/05/bears_desktop_2700x1809_hd-wallpaper-832781.jpg', 'https://www.stgeorgeutah.com/wp-content/uploads/2017/01/blackbear.jpg', 'https://fthmb.tqn.com/OUfFPaVmyC8KJnjYhPqr-aq-Sy4=/4896x3264/filters:fill(auto,1)/tired-black-bear-cub-537071213-59bda526845b340011591e7f.jpg', 'https://cdn2.outdoorphotographer.com/gallery/7522/thegagglephotog@gmail.com_102543_647246_d57a3bd609_1c886941c4-thegagglephotoggmail-com-baby-black-bear-standing-fb.jpg', 'http://images.dailyhive.com/20160826144034/black-bear-e1475078273412.jpg', 'http://animalia.bio/uploads/animals/photos/full/1.25x1/YCezTGiM824aJwMLQgqJ.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/10/asiatic-black-bear-eating.jpg', 'https://images.fineartamerica.com/images-medium-large-5/standing-bear-timothy-flanigan.jpg', 'https://www.trbimg.com/img-58eeaeb6/turbine/os-black-bear-dead-sanford-criminal-20170412', 'https://winchestersun.com/wp-content/uploads/sites/44/2020/06/A1-062320-Black-bear-e1593005720644.jpg', 'https://i0.wp.com/taiwan-scene.com/wp-content/uploads/2019/06/taiwan-hualien-formosan-black-bear.jpg?fit=870%2C654&amp;ssl=1', 'https://www.gannett-cdn.com/presto/2018/11/04/PGRF/7c692a2a-f1d1-4f07-8181-6bfc90c42b2c-AP18305732083625.jpg?crop=1999,1144,x0,y211&amp;width=3200&amp;height=1680&amp;fit=bounds', 'http://i.huffpost.com/gen/1190583/thumbs/o-BLACK-BEAR-facebook.jpg', 'http://1.bp.blogspot.com/-Jc2_QqcDTz4/UBjix7v9rjI/AAAAAAAAAMA/Hr67qTiw_I4/s1600/Black-Bear-02.jpg', 'http://mediad.publicbroadcasting.net/p/nhpr/files/styles/x_large/public/201303/April26girlapril30.jpg', 'http://mediad.publicbroadcasting.net/p/nhpr/files/201303/April25onlog.jpg', 'http://www.exploreclarion.com/wp-content/uploads/2018/11/black-bear.png', 'https://external-preview.redd.it/ny2anVEkjB6eTawYfAN6KcZ7TUyH69buX9Vhm56cds8.jpg?auto=webp&amp;s=500e3a52f7e797eff002fcd91f0f3cf62ff1f401', 'https://img.huffingtonpost.com/asset/594a9e981700001f001021dc.jpeg?ops=1910_1000', 'https://site-547756.mozfiles.com/files/547756/medium/Black_Bear3.jpg', 'https://images.fineartamerica.com/images-medium-large/pa-black-bear-portrait-bill-maile-.jpg', 'https://www.oceanlight.com/stock-photo/ursus-americanus-black-bear-image-18790-351363.jpg', 'https://www.gannett-cdn.com/-mm-/a5076e7a43a0cec6129489319d0fb728e2cd1814/c=0-264-5184-3193/local/-/media/2017/02/15/DetroitFreePress/DetroitFreePress/636227474186999380-GettyImages-497031868.jpg?width=3200&amp;height=1680&amp;fit=crop', 'https://3.bp.blogspot.com/-T62hFwmwBSg/TmstHyDCjWI/AAAAAAAAAAg/hZSRZIqaEpE/s1600/black-bear-backgrounds-4-751651.jpg', 'https://media.news4jax.com/photo/2015/11/06/Black-bear-blurb-jpg_308110_ver1.0_1280_720.jpg', 'https://downeast.com/wp-content/uploads/2014/02/Bear9.jpg', 'http://www.minnesotaseasons.com/Mammals/Large/American_black_bear_03.jpg', 'https://animals.net/wp-content/uploads/2018/12/Black-Bear-2.jpg', 'https://i.cbc.ca/1.4656566.1525955305!/cpImage/httpImage/image.jpg_gen/derivatives/16x9_780/alberta-black-bear.jpg', 'http://www.hdnicewallpapers.com/Walls/Big/Bear/Animal_Black_Bear_in_Forest.jpg', 'http://2.bp.blogspot.com/-NU71JkUr_MU/UNois4w5TnI/AAAAAAAABK4/ul6piYtCZUU/s1600/christmas+bear.JPG', 'http://www.trbimg.com/img-52bde9f3/turbine/os-blackbearhabitat9910-jpg-20131227/2000/2000x1182', 'http://elelur.com/data_images/mammals/asian-black-bear/asian-black-bear-05.jpg', 'https://globaljusticeecology.org/wp-content/uploads/black-bear-937037_1920-980x460.png', 'http://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/embed/public/2017/05/16/black-bears-19723071920.jpg', 'http://www.nwtrek.org/wp-content/uploads/2017/12/KBYG-black-bear.jpg', 'https://wildlifefriendly.org/wp-content/uploads/2015/09/Black-bear-Full.jpg', 'https://www.sott.net/image/s13/270500/full/Black_bear_looks_angry_Shutter.jpg', 'http://wiseaboutbears.org/wp-content/uploads/2014/06/bearmaleJune-222012D80_2149-copy.jpg', 'https://www.columbiatribune.com/storyimage/MO/20200519/NEWS/200519240/AR/0/AR-200519240.jpg', 'https://cdn2.bigcommerce.com/server100/6ca92/product_images/uploaded_images/florida-black-bear.jpg?t=1430242234', 'http://explorenorth.com/library/nature/images/brown_black_bear-tutshi_lake-0709.jpg', 'https://cdn.shopify.com/s/files/1/1603/1175/products/American_Black_Bear_Cub_3265_2048x.jpg?v=1523665570', 'http://getwallpapers.com/wallpaper/full/a/0/7/1303653-black-bear-desktop-wallpaper-1920x1080-for-meizu.jpg', 'https://farm6.staticflickr.com/5588/15080045718_78c2561e6e_b.jpg', 'https://www.nps.gov/shen/learn/nature/images/BlackBear_6.jpg?maxwidth=1200&amp;autorotate=false', 'https://www.gannett-cdn.com/-mm-/a5076e7a43a0cec6129489319d0fb728e2cd1814/c=0-264-5184-3193/local/-/media/2017/06/23/PAGroup/YorkDailyRecord/636338199651309082-GettyImages-482466374.jpg?width=3200&amp;height=1680&amp;fit=crop', 'http://www.reportingday.com/wp-content/uploads/2018/07/Black-Bear-Cute-Pictures-1.png', 'https://upload.wikimedia.org/wikipedia/commons/9/9c/%22Cinnamon%22_Black_Bear.jpg', 'https://media.timesfreepress.com/img/photos/2014/11/09/111014b04_black_bears_t800_h8b150168072b2d9c018ca481200aa3e621674f4c.JPG', 'https://www.realtree.com/sites/default/files/styles/site_large/public/content/inserts/642px-blackbearatwoburnsafaripark.jpg', 'http://adwimages.co.uk/Blog/wp-content/uploads/2016/11/adult-black-bear.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/black-bear-cub-in-a-tree-ursula-salzmann.jpg', 'https://cdn.vox-cdn.com/thumbor/SNyMBO6T0qwheM_sxxaWIKDDPAc=/0x0:5000x3313/1200x800/filters:focal(1435x1342:2235x2142)/cdn.vox-cdn.com/uploads/chorus_image/image/57942213/GettyImages_187133529.0.jpg']
    Images downloaded.
teddy bear: Got 283 image URLs. Downloading...
   urls =  ['https://i2-prod.birminghammail.co.uk/incoming/article17583074.ece/ALTERNATES/s1227b/0_IFP_BEM_160120bears011JPG.jpg', 'http://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-14271861817446_1200x.jpg?v=1584804420', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/970/6782/Life_size_72in_black_teddy_bear_Juju_Cuddles_is_Tall_dark_and_adorable__95688.1463592717.jpg?c=2', 'https://www.sugardelites.com/assets/images/teddybearlarge.jpg', 'http://www.photos-public-domain.com/wp-content/uploads/2010/12/white_teddy_bear.jpg', 'http://wallsdesk.com/wp-content/uploads/2016/11/Lonely-Teddy-Bear.jpg', 'http://www.fitzulas.com/Merchant4c/graphics/00000001/2014/gund-4040161-xl.jpg', 'https://backdropscanada.ca/wp-content/uploads/2015/01/p-8282-Teddy_Bear_Blue_TL_800302__02186.jpg', 'https://cdn0.rubylane.com/shops/chippewalakeantiques/863.1L.jpg', 'https://cdn.shopify.com/s/files/1/2975/6858/products/tan-big-bear-9_1200x1200.jpg?v=1524446749', 'https://cdn.notonthehighstreet.com/system/product_images/images/001/708/113/original_standing-teddy-bears.jpg', 'https://n2.sdlcdn.com/imgs/i/6/4/X-Atom-Teddy-Bears-Couple-SDL372766290-2-658f9.jpeg', 'https://www.sippycupmom.com/wp-content/uploads/2017/09/NTBD-Exclusive-Bear.jpg', 'http://theawesomedaily.com/wp-content/uploads/2017/10/teddy-bear-images-10-2.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Photos.png', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/883/8957/48in_green_teddy_bear_Big_smile_and_soft_cuddly_bear__93790.1493921224.jpg?c=2', 'https://hips.hearstapps.com/vader-prod.s3.amazonaws.com/1543338622-costco-giant-teddy-bear-1543338603.jpg?crop=1xw:1xh;center,top', 'http://icecreamoffpaperplates.com/wp-content/uploads/2016/08/teddy-bears.jpg', 'http://cdn.shopify.com/s/files/1/2610/9472/products/BL1985_BIRKIN_TEDDY_BEAR_01_1024x1024.jpg?v=1554885535', 'https://d3n8a8pro7vhmx.cloudfront.net/accessalliance/pages/454/meta_images/original/Cute_but_Lonely_Teddy_Bear_Sitting_on_Grass.jpg?1591840883', 'https://www.super99.in/media/catalog/product/cache/1/image/1800x/040ec09b1e35df139433887a97daa66f/0/1/01_22.jpg', 'https://static1.momsimage.com/wordpress/wp-content/uploads/2020/03/2020-03-30_110127.jpg', 'https://www.stuffedwithplushtoys.com/assets/full/27-1704436.jpg?20200129144114', 'https://www.celebrationgiftware.com.au/media/catalog/product/cache/cb58f11d039ee9c021f50f3360077761/t/s/tshirtbear-yellow-birthdetails.jpg', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-8100-14243358867558_1024x1024.jpg?v=1588363171', 'https://cdn.notonthehighstreet.com/fs/34/8c/3995-961a-4318-86e4-a5ee78006bf4/original_personalised-teddy-bear-gift.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG114.png', 'http://edicollector.com/wp-content/uploads/2017/10/Krampus-Teddy-Bear-Edicollector-02.jpg', 'https://img.pngio.com/teddy-bear-png-baby-teddy-bear-png-1456_1456.png', 'https://cdn1.tedsby.com/tb/large/storage/1/3/0/13062/cute-handmade-teddy-bear-miniature-ooak-artist.jpg', 'https://cdn0.rubylane.com/_pod/item/1068141/0001459/1910s-Antique-Steiff-Tiny-Teddy-Bear-pic-1-2048-50-f.jpg', 'https://cdn0.rubylane.com/_pod/item/1494839/RL446/Large-Ideal-Antique-Teddy-Bear-full-2o-2048-14-r-ffffff-9f9b7e.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG104.png', 'https://startknitting.org/wp-content/uploads/2018/03/Teddy-Bear-Free-Knitting-Pattern-f.jpg', 'https://cdn.notonthehighstreet.com/fs/7a/fe/5bda-9f46-403c-9d21-c798fa5de5ed/original_personalised-siblings-teddy-bears.jpg', 'https://cdn1.tedsby.com/tb/large/storage/1/3/9/139462/cute-handmade-teddy-bear-oliver.jpg', 'http://www.listofdownload.com/wp-content/uploads/2017/02/red-roses-cute-teddy-bear-picture-background-wallpaper.jpg', 'https://i5.walmartimages.com/asr/5d5541cd-d9cc-4b47-b7de-ebc107b74d82_1.9f14f307142cfd730852e875760b90bc.jpeg', 'https://townsquare.media/site/43/files/2020/08/Teddy-Bear.jpg?w=1200&amp;h=0&amp;zc=1&amp;s=0&amp;a=t&amp;q=89', 'https://alqurumresort.com/img/vermont-teddy-bear-valentines-day.jpg', 'https://api.time.com/wp-content/uploads/2016/12/teddy-bear.jpg', 'https://www.kentishembroidery.co.uk/133/mm01-cuddly-mumbles-bracken-teddy-bear-989.jpg', 'http://www.fitzulas.com/Merchant4c/graphics/00000001/2012/gund-015418-xl.jpg', 'http://oglasi.ovh/images/2020/02/15/84/pomeranian-boo-white-teddy-bear_4.jpg', 'https://perpetualpreschool.com/wp-content/uploads/2017/12/32221695_ml.jpg', 'https://cdn.shopify.com/s/files/1/0270/2981/products/Bear_Plush_Pink_Color_with_Bow_25_cm_1024x1024.jpg?v=1527556065', 'https://www.myflowergift.com/media/catalog/product/cache/1/image/1200x1200/9df78eab33525d08d6e5fb8d27136e95/s/n/snow_white..3_feet_height_white_teddy_bear_4000.jpg', 'http://www.photos-public-domain.com/wp-content/uploads/2011/01/teddy-bear-wearing-mardi-gras-beads.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Wallpaper.jpg', 'https://3.bp.blogspot.com/-MF361EGT_e4/TrwxX4LsSMI/AAAAAAAAEP8/xKbu4DUVjEI/s1600/little+bear.JPG', 'https://www.petlandracine.com/wp-content/uploads/2019/05/1386238_800.jpg', 'https://2.bp.blogspot.com/-v-DbNHEhI0c/UkK6mc0ImdI/AAAAAAAAAB8/4rdaS87Bxqo/s1600/Giant+Teddy+Halloween+2013+Photo+Blog+4.jpg', 'https://cdn.shopify.com/s/files/1/0798/6397/products/eddie_cover_no_logo.jpg?v=1535766533', 'https://www.kidswholesaleclothing.co.uk/4599-thickbox_default/soft-toys-for-personalisation-teddy-bear-grey.jpg', 'https://cdn.thisiswhyimbroke.com/images/ebonics-romantic-bear.jpg', 'https://www.worldofbears.com/acatalog/Oxford%2010in_WEB.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG5.png', 'https://cdn.notonthehighstreet.com/system/product_images/images/001/941/993/original_baby-teddy-bear-dress-up-costume.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG14.png', 'https://www.zookini.com.au/media/catalog/product/cache/8/image/5beb446e055b53f6b95ea24807ed418d/w/a/waffle-cute-teddy-bear-beige-01.jpg', 'https://teddy.ph/wp-content/uploads/2019/08/feature-30.jpg', 'http://www.sippycupmom.com/wp-content/uploads/2017/09/Teddy-Bear.jpg', 'https://cdn.jewishboston.com/uploads/2019/01/iStock-932242472.jpg', 'https://newcastlebeach.org/images/teddy-bear-with-heart-4.jpg', 'https://1.bp.blogspot.com/_GSA-YfDFMXc/TDhlS3NvdcI/AAAAAAAAAb8/m0-7WTaPif8/s1600/DSC_1528.JPG', 'https://teddybears.co.uk/wp-content/uploads/2019/02/uk-2019-2736x3648.jpg', 'https://cdn.thewhoot.com/wp-content/uploads/2018/06/Knitted-Teddy-Bear-Patterns-1.jpg', 'https://cdn0.rubylane.com/shops/1147637/bk727.1L.jpg', 'https://cdn0.rubylane.com/_pod/item/737200/266/Vintage-Steiff-Original-Teddy-Bear-1950x7827s-full-3o-2048-eea9d521-f.jpg', 'https://cdn-r.fishpond.com/0037/184/777/237402416/6.jpeg', 'https://cdn.notonthehighstreet.com/fs/0e/9b/9f39-5053-4edd-a7b8-33a6780fb100/original_personalised-1st-christmas-teddy-bear.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG24.png', 'https://www.teddybearaustralia.com.au/wp-content/uploads/2018/09/FullSizeRender-6.jpg', 'https://worldofbears.com/acatalog/Steiff-022098.jpg', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/883/8961/4ft_green_teddy_bear_Big_smile_and_soft_cuddly_bear__85725.1493921227.jpg?c=2', 'https://thegadgetflow.com/wp-content/uploads/2013/01/Personalised-Teddy-Bear-In-A-Gift-Tin-4.jpg', 'https://www.steiffteddybears.co.uk/img/products/027710.png', 'https://image.made-in-china.com/2f0j00wqhfEUTWOVbo/Factary-Price-Giant-Teddy-Bear-Big-Plush-Teddy-Bear-Soft-Toys-for-Girls.jpg', 'https://cdn0.rubylane.com/_pod/item/1491561/Peacockx20Bear/Peacock-Stores-Teddy-Bear-foot-label-pic-1A-2048:10.10-27-f.jpg', 'https://n3.sdlcdn.com/imgs/g/u/e/Ultra-Blue-Teddy-Bear-12-SDL607416536-2-76098.jpeg', 'https://1.bp.blogspot.com/-ChPUEPH4ssg/T-nXRUqH6zI/AAAAAAAAAWY/7HEyWdQvV_E/s1600/teddy+bear+picnic+(7).JPG', 'https://s2.r29static.com/bin/entry/a85/0,0,2000,1050/x,80/1655673/image.jpg', 'https://app.skufetch.com/images.tmp/Gemmy_8_5_ft_Animate_294606_109_0_res.jpg', 'https://www.stuffedwithplushtoys.com/assets/full/u4040131.jpg', 'https://www.bloomsonly.com/media/catalog/product/cache/2/image/1200x1200/9df78eab33525d08d6e5fb8d27136e95/m/e/meng-meng-cute-brown-teddy-bear-head-tilt-twisting-holiday-gifts-velvet-ribbon-light-brown-bear.jpg', 'https://www.desicomments.com/dc3/02/215657/215657.jpg', 'https://www.teddybearacademy.net/wp-content/uploads/2014/08/Marco-full.jpg', 'https://st4.depositphotos.com/4431055/22853/i/950/depositphotos_228530988-stock-photo-cute-teddy-bears-hugging-back.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG45.png', 'http://images.antiquesatlas.com/dealer-stock-images/sladesantiques/Vintage_Small_9_Steiff_Mohair__as527a528z.jpg', 'https://www.worldofbears.com/acatalog/LG01.jpg', 'https://teddybears.co.uk/wp-content/uploads/2017/08/075797-2736x3648.jpg', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/882/8984/6ft_Green_lucky_teddy_Life_Size_bear_cuddly_Giant_and_biggest_cuddles_bear__64679.1493929106.jpg?c=2', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG11.png', 'http://www.pavlovspuppets.com/p/teddy3.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Pictures.jpg', 'https://www.taylorherring.com/wp-content/uploads/2015/04/GiantTeddyBears-6.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Wallpapers.jpg', 'https://primopromo.com.au/assets/Uploads/Teddy-Bear+Dark-Green-v3.jpg', 'https://cdn0.rubylane.com/shops/700632/I-1277.1L.jpg', 'https://cdn1.bigcommerce.com/server1900/dee9d/images/stencil/700x900/products/970/6782/Life_size_72in_black_teddy_bear_Juju_Cuddles_is_Tall_dark_and_adorable__95688.1463592717.jpg?c=2', 'https://n1.sdlcdn.com/imgs/i/7/9/Teddy-bear-SDL324941391-1-f3e93.png', 'https://1.bp.blogspot.com/-eTFJzsbT2Pg/T3qHL_rPBMI/AAAAAAAABsA/5J8eXBe2d9A/s1600/Teddy+Bear+Wallpapers.jpg', 'http://geekologie.com/2014/11/10/teddy-bear-dog-2.jpg', 'https://plazarealestate.com.au/wp-content/uploads/sites/131/2016/07/Teddy-Bears.jpg', 'https://cdn0.rubylane.com/_pod/item/1491561/1920sx20Germanx20bear/lovely-German-1920s-teddy-bear--full-2-2048-93.jpg', 'https://cdn.geekwire.com/wp-content/uploads/2017/11/Pasted-image-at-2017_11_15-02_22-PM.png', 'https://twinsmom.com/wp-content/uploads/2020/04/GUND-Slumbers-Teddy-Bear-Stuffed-Animal-Plush-Brown-1722.jpg', 'https://teddybears.co.uk/wp-content/uploads/2019/02/1903-2736x3648.jpg', 'https://dayz.gamepedia.com/media/dayz.gamepedia.com/e/e5/TeddyBearBrown.png', 'https://www.melijoe.com/images/142519/open_graph.jpg', 'http://3.bp.blogspot.com/-oU6bGNvicT0/UjH80jmsEfI/AAAAAAAAFTA/H6gDxpq_rE4/s1600/teddy_bear_wallpapers+%2814%29.jpg', 'https://i.ebayimg.com/images/i/221655718748-0-1/s-l1000.jpg', 'https://www.worldofbears.com/acatalog/steiff-ean-001765.jpg', 'https://winkgo.com/wp-content/uploads/2016/09/Proud-Grandpa-Buys-Giant-Teddy-Bear-His-Granddaughter-05.jpg', 'https://s-i.huffpost.com/gen/1995262/images/o-TEDDY-BEAR-COOKIES-facebook.jpg', 'https://n3.sdlcdn.com/imgs/i/h/h/Mable-Cuddle-Big-Teddy-Bear-SDL312942984-1-7984b.jpeg', 'https://i5.walmartimages.com/asr/dfe8f0fc-3ada-4f4d-b641-4e86af319c30_1.2c587767c675128916b101e1563dc5b2.jpeg', 'https://n4.sdlcdn.com/imgs/a/0/r/Toysaa-Brown-Jumbo-Teddy-SDL441635333-1-f7f59.jpg', 'https://www.worldofbears.com/acatalog/steiff-ean-012037.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Background.jpg', 'https://www.tteengift.com/wp-content/uploads/2014/12/Small-Classic-Teddy-Bear-G01.jpg', 'https://www.dhresource.com/0x0s/f2-albu-g3-M01-AF-81-rBVaHFoewiyATnxuAAPEbt5vzFw787.jpg/63-160-cm-white-giant-teddy-bear-big-huge.jpg', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-105-14241810382950_1200x.jpg?v=1584732813', 'https://www.jarrold.co.uk/userdata/root/images/products/steiff/teddy-bear-replica-1909.jpg', 'https://usercontent2.hubstatic.com/14656219_f1024.jpg', 'https://www.worldofbears.com/acatalog/steiff-113673.jpg', 'https://4.bp.blogspot.com/_OTdJvruSaiI/Swtbm1GvbWI/AAAAAAAAFdo/WXyAoA_1Qco/s1600/IMG_3609.JPG', 'http://cdn.shopify.com/s/files/1/0748/9103/products/steiff_10_1920_brass_000713-37_grande.jpeg?v=1426675827', 'https://giftteens.com/wp-content/uploads/2018/01/PPST0063.jpg', 'https://theawesomedaily.com/wp-content/uploads/2017/10/teddy-bear-images-17-1.jpg', 'http://www.worldofbears.com/acatalog/gund-4056332.jpg', 'http://4.bp.blogspot.com/_ED0zYuiiwBg/TBke2UCnvHI/AAAAAAAACJU/AfQyXaz-NJI/s1600/aetna+bear.jpg', 'https://www.buildabear.co.uk/on/demandware.static/-/Sites-buildabear-master/default/dw82e7e236/25239x.jpg', 'https://www.lifejackets.com/wp-content/uploads/2020/03/229-EBbearblueribboneverych-1.png', 'http://www.funandcash.com/ebay/teddy-white-small-X-1-A.jpg', 'https://3.bp.blogspot.com/_ED0zYuiiwBg/TLNvSWhZTCI/AAAAAAAACrM/1zXtB07mYlY/s1600/teddy+bears+halloween+closeup+2.JPG', 'https://jooinn.com/images/teddy-bear-48.jpg', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-106-14242280636518_1200x.jpg?v=1597087632', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-8101-14241651163238_1200x.jpg?v=1584559861', 'https://www.carouselshop.co.uk/media/catalog/product/cache/9/image/2000x/040ec09b1e35df139433887a97daa66f/B/F/BFFC8662B837D2AA8409CA13393604F6.jpg', 'https://www.worldofbears.com/acatalog/Steiff-237010.jpg', 'https://cdn3.volusion.com/9nxdj.fchy5/v/vspfiles/photos/BB-1486-2.jpg?v-cache=1520605016', 'https://cdn.shopify.com/s/files/1/3045/2256/products/GRID-1_76173971-e87f-42ab-bebd-e5f0db3fe386_600x900.png?v=1594136153', 'https://www.grabhub.co.uk/wp-content/uploads/2020/06/Big-Cuddly-Teddy-Bear-4.jpg', 'https://cdn.shopify.com/s/files/1/1417/0972/products/4056786-high-res_1024x1024.jpg?v=1548786811', 'https://lovemydoodles.com/wp-content/uploads/2020/04/IMG_0006-18.jpg', 'https://i5.walmartimages.com/asr/ab097d42-d89e-4db0-a7df-6d87b08de9ab_1.0e68fae386f2fafcb61bfbd7fc12828e.jpeg', 'https://www.worldofbears.com/acatalog/steiff-000867.jpg', 'http://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-110-14235158642790_1200x.jpg?v=1584033067', 'https://www.braillehouse.org.au/wp-content/uploads/2018/12/Hand-knitted-teddy-bear-3.jpg', 'https://3.bp.blogspot.com/-vmp7XBf08eM/Tca-_DqLdeI/AAAAAAAACGQ/cJa3P2VUpT4/s1600/%252362+Teddy+bears+picnic.JPG', 'https://image.made-in-china.com/2f0j00NdUtRvuYOLbp/2017-New-Design-Scary-Teddy-Bear-Zombie-Bear-Undead-Bear-Bloody-Bear-Horrible-Teddy-Bear.jpg', 'https://i5.walmartimages.com/asr/aa216a37-5af0-447c-a7eb-515b94be2bc7.c9ca3e8b8902b7cac68d5a93587a5598.jpeg', 'https://teddybears.co.uk/wp-content/uploads/2015/09/petsy-28cm.jpg', 'http://www.iheartteacups.com/wp-content/uploads/2017/05/IMG_3852.jpg', 'https://cdn.notonthehighstreet.com/fs/93/ed/2016-9d7d-4c2d-bc12-e84f66c2e4d5/original_valentine-s-day-bertie-bear.jpg', 'https://4.bp.blogspot.com/-003EDE5jTOw/UDSwjEWC7oI/AAAAAAAADuQ/lA_x_5ECQAo/s1600/teddy-bear-14-hqwallpapers4u.co.cc.jpg', 'https://3.bp.blogspot.com/_ED0zYuiiwBg/TTeCTVngmNI/AAAAAAAADF0/b6ySiPXTVlA/s1600/sleep+eyed+bear.JPG', 'http://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-108-14241933426790_1200x.jpg?v=1588417411', 'http://www.fitzulas.com/Merchant4c/graphics/00000001/2016/4056250.jpg', 'https://www.sayitwithbears.co.uk/wp-content/uploads/2016/07/large-personalised-bonnie-honey-scaled.jpg', 'https://webimg.secondhandapp.com/1.1/5e30189ab33a15626007900b', 'https://www.buildabear.com/on/demandware.static/-/Sites-buildabear-master/default/dwa68008ec/26614x.jpg', 'http://www.worldofbears.com/acatalog/mxmas-2017-1.jpg', 'https://hdwallpaperfun.com/wp-content/uploads/2015/10/Cute-Teddy-Bear-Wallpaper.jpg', 'https://teddybears.co.uk/wp-content/uploads/2015/05/MT-new-2017-cropped.jpg', 'https://cdn0.rubylane.com/shops/1539575/0025.1L.jpg', 'http://cdn.shopify.com/s/files/1/2429/7549/products/Edgar-_4_634bce55-3448-4579-adaf-349cc2dfe069_1200x1200.jpg?v=1557254763', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-14271863685222_1024x1024.jpg?v=1586794398', 'https://2.bp.blogspot.com/_ED0zYuiiwBg/S_FJV5v3f4I/AAAAAAAAB5o/7GGX-bleb1Y/s1600/bears.JPG', 'https://cdn11.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/59/9448/Huge_Blue_Teddy_Bear_Happy_Cuddles_38in__38354.1495128960.jpg?c=2', 'http://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-103-14241683964006_1200x.jpg?v=1585177055', 'https://n1.sdlcdn.com/imgs/g/x/j/ToyHub-3-Feet-Super-Soft-SDL448496021-1-7dfe5.jpeg', 'https://cdn-image.realsimple.com/sites/default/files/styles/portrait_435x518/public/1510689111/giant-teddy-bear.jpg?itok=JRUEDZtP', 'https://www.buildabear.com/dw/image/v2/BBNG_PRD/on/demandware.static/-/Sites-buildabear-master/default/dw78d308a2/28167x.jpg?sw=600&amp;sh=600&amp;sm=fit&amp;q=70', 'https://www.pcsoutdoors.com/images/products/detail/BeaverBearLgFront.jpg', 'https://www.buildabear.co.uk/on/demandware.static/-/Sites-buildabear-master/default/dwdac83d3c/24663x.jpg', 'http://allpicts.in/wp-content/uploads/2015/10/Cute-Teddy-bear-with-Pink-roses.jpg', 'https://www.thetoyshoppe.com/images/productslarge/57457d.jpg', 'https://www.stuffedwithplushtoys.com/assets/full/17223-RD.jpg?20201103131623', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG97.png', 'https://teddybears.co.uk/wp-content/uploads/2017/08/113413_113420_113437_web-2736x3648.jpg', 'https://4.bp.blogspot.com/-fGtPzuETOho/T3qG6e61h9I/AAAAAAAABro/z8CWfoVG3bQ/s1600/Teddy+Bear+Wallpapers+2.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG94.png', 'http://cdn.shopify.com/s/files/1/0704/5013/products/teddy-bears-gund-maxie-bear-beige-24-1_1024x1024.jpg?v=1544388291', 'http://c.shld.net/rpx/i/s/i/spin/image/spin_prod_1099814412??hei=64&amp;wid=64&amp;qlt=50', 'https://cdn0.rubylane.com/shops/1754162/118.1L.jpg', 'http://www.photos-public-domain.com/wp-content/uploads/2010/12/cream_colored_teddy_bear.jpg', 'https://cdn0.rubylane.com/_pod/item/737200/266/Vintage-Steiff-Original-Teddy-Bear-1950x7827s-full-1o-2048-fe3a394d-f.png', 'https://cdn0.rubylane.com/_pod/item/1491561/Peacockx20Bear/Peacock-Stores-Teddy-Bear-foot-label-full-3o-2048-94-r-ffffff-d8cbbb.jpg', 'https://cdn0.rubylane.com/shops/your-favorite-doll/156.1L.jpg', 'https://954puppies.com/wp-content/uploads/2019/07/DSC03401-1.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG7.png', 'https://www.pets4homes.co.uk/images/classifieds/2018/08/16/2028360/large/stunning-toy-cavapoo-teddy-bear-puppies-pra-clear-5b9d3f067fc36.jpg', 'https://n1.sdlcdn.com/imgs/f/g/5/Lovely-Multicolour-Small-Teddy-Bear-SDL963778079-1-36406.jpg', 'https://www.buildabear.com/on/demandware.static/-/Sites-buildabear-master/default/dwbebeadb4/24925x.jpg', 'http://cdn.shopify.com/s/files/1/2679/2566/articles/19424368_161403274403867_6843080688077087305_n_1200x1200.jpg?v=1563408993', 'https://www.luxurypuppies2u.com/wp-content/uploads/2020/01/bibi-teddy-bear-dog-2.jpg', 'https://cdn.notonthehighstreet.com/fs/d7/0c/8e2c-5db7-4ecf-8fec-9dd401de329a/original_personalised-new-baby-teddy-bear.jpg', 'https://www.worldofbears.com/acatalog/steiff-403286.jpg', 'https://www.worldofbears.com/acatalog/steiff-026812a.jpg', 'https://www.pioupiou-et-merveilles.fr/3237-large_default/giant-teddy-bear-gaston-beige-100cm.jpg', 'https://d3h6k4kfl8m9p0.cloudfront.net/stories/qjGrIHo8t0ha-j8tgE3tdQ.jpeg', 'https://rare.us/wp-content/uploads/sites/3/2017/07/teddy-bears.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG90.png', 'http://1.bp.blogspot.com/_ED0zYuiiwBg/TCoGLyKhVNI/AAAAAAAACMU/Sk2m6kJtwQ0/s1600/odd+bear+seated.jpg', 'https://www.henrymayo.com/images/content-images/Teddy-Bear.jpg', 'https://www.onlinedelivery.in/images/thumbnails/1202/1165/detailed/29/8522.jpg', 'https://usercontent2.hubstatic.com/14720461_f1024.jpg', 'https://www.buildabear.com/on/demandware.static/-/Sites-buildabear-master/default/dw2b81d8a7/28502x.jpg', 'https://cdn.shopify.com/s/files/1/2622/2548/products/wholesale-plush-in-a-rush-112-14235212972134_1200x.jpg?v=1584034090', 'https://www.hicodenver.com/wp-content/uploads/2020/05/Teddy-Bear-with-Heart.png', 'http://1.bp.blogspot.com/-z6yWAofGr14/T3FujYmUuTI/AAAAAAAABZ8/LY-pQFofo0o/s1600/Christmas+Teddy+Bear+Wallpapers+4.jpg', 'https://www.worldofbears.com/acatalog/steiff-113666.jpg', 'http://traditionsjewishgifts.com/media/brown-hanukkah-plush-teddy-bear-RLTYTEDDY2.jpg', 'https://www.school-bears.co.uk/wp-content/uploads/2018/01/personalised-teddy-bear-anne.jpg', 'https://www.worldofbears.com/acatalog/ean-034978.jpg', 'https://sc01.alicdn.com/kf/HTB17fixJ1uSBuNjy1Xcq6AYjFXaJ.jpg', 'https://api.time.com/wp-content/uploads/2019/12/Teddy-Bear.jpg?quality=85&amp;w=1200&amp;h=628&amp;crop=1', 'http://weneedfun.com/wp-content/uploads/2015/10/Cute-Teddy-Bear-Wallpaper-4.jpg', 'https://1.bp.blogspot.com/-gdpjJWS07gg/UkK6oVmYZXI/AAAAAAAAACY/RZu_k0a2hl4/s1600/Giant+Teddy+Halloween+2013+photo+blog+1.jpg', 'https://pixfeeds.com/images/baby-care/baby-gifts/1280-622057492-white-teddy-bear.jpg', 'https://purepng.com/public/uploads/large/two-teddy-bear-in-basket-qyo.png', 'https://3.bp.blogspot.com/_ED0zYuiiwBg/S_FJynlFrhI/AAAAAAAAB5w/ioeinkP5Ri0/s1600/bears+profile.JPG', 'https://cdn11.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/143/1173/Sweetie-Pie-Big-Love-hazelnut-brown-teddy-bear-30in__97755.1542992358.jpg?c=2', 'https://d3h6k4kfl8m9p0.cloudfront.net/stories/B4LWqbQh48c0ultSGdJraA.jpeg', 'https://cdn.notonthehighstreet.com/system/product_images/images/001/942/001/original_baby-teddy-bear-dress-up-costume.jpg', 'http://cdn.shopify.com/s/files/1/0748/9103/products/jellycat_18_bumbly_bears_grande.jpg?v=1530708337', 'https://www.taylorherring.com/wp-content/uploads/2015/04/GiantTeddyBears-5-781x1020.jpg', 'http://1.bp.blogspot.com/-4Z91ISiPs94/UYzX1S-xB9I/AAAAAAAAE7c/MGsL0bQ2EpY/s1600/Coco-L-Cuddles-white-teddy-bear-with-necklace-26in__23715.1327379838.1280.1280.jpg', 'https://theeducationhub.org.nz/wp-content/uploads/2020/03/Teddy-bear-hunt-scaled.jpg', 'https://cdn.suwalls.com/wallpapers/photography/happy-teddy-bear-family-under-the-snowy-pine-tree-51847-1920x1080.jpg', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/875/6201/Adorable_Brown_Bears_Set_Of_three_Gift_Huge_Family_Giant_Teddy__55363.1436899340.jpg?c=2', 'https://teddybearsandfriends.com/wp-content/uploads/2013/12/Teddy-Bear-Miniature-US-Special-1984-97-98-1_.jpg', 'https://usercontent2.hubstatic.com/11954973_f260.jpg', 'https://wallsdesk.com/wp-content/uploads/2016/11/Teddy-Bear-Wallpapers-HD.jpg', 'http://www.fitzulas.com/Merchant4c/graphics/00000001/2017/173902.jpg', 'https://4.bp.blogspot.com/-m23FOuiaNfM/Vlcb1HUm1-I/AAAAAAAABi4/NAAxnfHZ7kY/s1600/IMG_2519.JPG', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/1280x1280/products/354/2910/Sweetie-Tubs-mocha-brown-teddy-bear-65in_3__58929.1323818431.jpg?c=2', 'https://oneofakindantiques.com/r.php?itemNumber=5261&amp;imageNumber=1&amp;w=1500&amp;type=regular', 'https://teddybears.co.uk/wp-content/uploads/2017/09/113321.jpg', 'https://i.ebayimg.com/00/s/MTAyNFg3Njg=/z/pnMAAOSw7eld87sL/$_86.JPG', 'https://www.megelles.com/assets/full/MEG-frankie.jpg?20191212083854', 'https://www.fromme.co.zw/uploads/2020/08/Teddy-FM_.jpg', 'http://2.bp.blogspot.com/-uBj8qN2NvdM/T3FurKV2-WI/AAAAAAAABaE/04CNHLuEczw/s1600/Christmas+Teddy+Bear+Wallpapers.jpg', 'https://bestdolltoys.com/wp-content/uploads/2020/03/51YOoVe9H1L.jpg', 'https://cdn.thewhoot.com/wp-content/uploads/2018/06/Knitted-Teddy-Bear-Patterns--550x896.jpg', 'https://cdn0.rubylane.com/_pod/item/1130386/Bear1/Adorable-antique-Jointed-Mohair-Teddy-Bear-full-4o-2048-a9115339-r-ffffff-f68787.jpg', 'https://i.ebayimg.com/00/s/MTAyNFg4OTk=/z/pwYAAOSw4VRc6XRa/$_86.JPG', 'http://2.bp.blogspot.com/_ED0zYuiiwBg/TTd9rrMJswI/AAAAAAAADFc/i3w3l43MeGg/s1600/aetna.JPG', 'https://s32071.pcdn.co/wp-content/uploads/ep0195_1.jpg', 'https://craftsmumship.com/wp-content/uploads/2013/04/Kina-dolls-size-knitted-cardigan.jpg', 'https://www.professorshouse.com/wp-content/uploads/2019/08/teddy-bear-names.jpg', 'http://mylitter.com/wp-content/uploads/2019/02/bear.jpg', 'https://petvblog.com/wp-content/uploads/2020/06/teddy-bear-puppies-1024x683.jpg', 'https://www.worldofbears.com/acatalog/steiff-ean-000997.jpg', 'https://3.bp.blogspot.com/_ED0zYuiiwBg/TLNuVSd7t_I/AAAAAAAACrE/AXkCJv9QF9Y/s1600/teddy+bears+halloween.JPG', 'http://cdn.shopify.com/s/files/1/2975/6858/products/large-tan-bear_1200x1200.jpg?v=1524446719', 'http://www.familytree.com/wp-content/uploads/2017/09/National-Teddy-Bear-Day-Find-more-genealogy-blogs-at-FamilyTree.com_.jpg', 'https://s3.amazonaws.com/hoover.church.of.christ/wp-content/uploads/2020/08/teddy-bear-sick-in-the-hospital.jpg', 'https://www.stuffedwithplushtoys.com/assets/full/9750-30.jpg?20180212090824', 'https://www.worldofbears.com/acatalog/steiff-ean-111556.jpg', 'https://cdn8.bigcommerce.com/s-dee9d/images/stencil/700x900/products/883/8961/4ft_green_teddy_bear_Big_smile_and_soft_cuddly_bear__85725.1493921227.jpg?c=2', 'https://www.carouselshop.co.uk/media/catalog/product/cache/9/image/2000x/040ec09b1e35df139433887a97daa66f/E/E/EE49104AE5D9AFA3C9C246D2F4F81F73.jpg', 'https://www.elizabeths.co.uk/upload/mt/eliz126/products/lg_null-teddy-bears---grey.jpg', 'https://www.sayitwithbears.co.uk/wp-content/uploads/2017/05/SN0778-925x1024.jpg', 'https://www.grabhub.co.uk/wp-content/uploads/2020/07/Peek-a-Boo-Teddy-Bear-1.jpg', 'https://images.wallpaperscraft.com/image/soft_toy_teddy_bear_bear_117110_938x1668.jpg', 'https://www.snappysnaps.co.uk/media/catalog/product/cache/62/image/650x650/9df78eab33525d08d6e5fb8d27136e95/s/n/snappy_teddy_bear.png', 'https://petclassifieds.com/wp-content/uploads/2020/10/20201003_153234.jpg', 'https://images.wallpaperscraft.com/image/toy_teddy_bear_teddy_31381_800x1420.jpg', 'https://www.curiousmondo.com/images/2017/11/02/teddy-bear-making-04.jpg', 'https://www.worldofbears.com/acatalog/LCG01.jpg', 'https://image.made-in-china.com/2f0j00iOetbZrDhvzU/Mini-Baby-Teddy-Bear-Keychain-with-Shirt.jpg', 'https://pngimg.com/uploads/teddy_bear/teddy_bear_PNG106.png', 'https://www.thunderbay.ca/en/recreation/resources/Thunder-Bay_recreation_interior_0032_Events---teddy-bears-picnic.jpg', 'http://1.bp.blogspot.com/-NosZBJngTnA/Tp_rt11Z4PI/AAAAAAAAAJg/GNVaaoWmesg/s1600/Teddy+bear+detail1.JPG', 'https://www.carouselshop.co.uk/media/catalog/product/cache/9/image/2000x/040ec09b1e35df139433887a97daa66f/D/1/D10F255704F7CE7FBEB25963EFF90A74.jpg', 'https://www.scarymommy.com/wp-content/uploads/2017/11/screen-shot-2017-11-13-at-8-39-00-am.png', 'https://3.bp.blogspot.com/-JB9Xu_dEIxA/UkLLT_b-TXI/AAAAAAAAADM/2UnCl1TvU8g/s1600/Giant+Teddy+Fall+2013+photo+blog+3.jpg', 'https://s34468.pcdn.co/wp-content/uploads/2019/09/DSC07821-scaled.jpg', 'https://cdn0.rubylane.com/shops/738907/T722.1L.jpg?63']
    Images downloaded.
After checking images for issues, 714 (total) images remain.
files has 714 elements.
files[0] = scraped_images/grizzly/00000143.jpg, files[-1] = scraped_images/teddy/00000109.png2.png</code></pre>
</div>
</div>
<p>And a routine that will parse filename to get the class label, and another that will list all the files in a certain class</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> label_func(file_path):</span>
<span id="cb17-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> file_path.parents[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].name  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just get the name of the parent directory for the file</span></span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"label_func yields </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>([label_func(fp) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fp <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sanity check: do we get all the labels we expect?</span></span>
<span id="cb17-5"></span>
<span id="cb17-6">lbl2files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {l: [f <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> label_func(f) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> l] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> labels}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>label_func yields {'teddy', 'grizzly', 'black'}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> SiameseImage(fastuple):</span>
<span id="cb19-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ctx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs): </span>
<span id="cb19-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb19-4">            img1,img2,similarity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb19-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb19-6">            img1,img2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span></span>
<span id="cb19-7">            similarity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Undetermined'</span></span>
<span id="cb19-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(img1, Tensor):</span>
<span id="cb19-9">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> img2.size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> img1.size: img2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> img2.resize(img1.size)</span>
<span id="cb19-10">            t1,t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor(img1),tensor(img2)</span>
<span id="cb19-11">            t1,t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t1.permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),t2.permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb19-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>: t1,t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> img1,img2</span>
<span id="cb19-13">        line <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t1.new_zeros(t1.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], t1.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb19-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> show_image(torch.cat([t1,line,t2], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>similarity, ctx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ctx, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> SiameseTransform(Transform):</span>
<span id="cb20-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, files, splits):</span>
<span id="cb20-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.splbl2files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [{l: [f <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files[splits[i]] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> label_func(f) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> l] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> labels}</span>
<span id="cb20-4">                          <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)]</span>
<span id="cb20-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.valid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {f: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._draw(f,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files[splits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]}</span>
<span id="cb20-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> encodes(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, f):</span>
<span id="cb20-7">        f2,same <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.valid.get(f, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._draw(f,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb20-8">        img1,img2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PILImage.create(f),PILImage.create(f2)</span>
<span id="cb20-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> SiameseImage(img1, img2, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(same))</span>
<span id="cb20-10">    </span>
<span id="cb20-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _draw(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, f, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>):</span>
<span id="cb20-12">        same <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.random() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb20-13">        cls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> label_func(f)</span>
<span id="cb20-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> same: cls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.choice(L(l <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> labels <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> cls)) </span>
<span id="cb20-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> random.choice(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.splbl2files[split][cls]),same</span>
<span id="cb20-16"></span>
<span id="cb20-17">splits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomSplitter()(files)</span>
<span id="cb20-18">tfm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SiameseTransform(files, splits)</span>
<span id="cb20-19">tls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TfmdLists(files, tfm, splits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>splits)</span>
<span id="cb20-20">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tls.dataloaders(after_item<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[Resize(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">224</span>), ToTensor], </span>
<span id="cb20-21">                      after_batch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[IntToFloatTensor, Normalize.from_stats(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>imagenet_stats)])</span>
<span id="cb20-22"></span>
<span id="cb20-23">valids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [v[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tfm.valid.items()]      </span>
<span id="cb20-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> [v <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> valids <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files[splits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]]</span></code></pre></div>
</div>
</section>
<section id="defining-the-contrastive-loss-model" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-contrastive-loss-model">Defining the Contrastive Loss Model</h3>
<p>We’re going to, again, copy the fastai Siamese Networks tutorial but change up the model a bit: we’re going to output two “embedding vectors”, one for each input image.</p>
<p>I found it <em>way</em> easier to interface with the <em>rest</em> of fastai if I just “packaged” these two vectors into one big long vector, and then later just ‘cut it in half’ whenever I needed one vector or the other.</p>
<p>Initially we’re going to use an embedding dimension of 3 so we can visualize it. This isn’t actually going to be ideal for achieving high accuracy, so afterward we’ll re-do it with the dimension increased.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> SiameseNet(nn.Module):</span>
<span id="cb21-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, </span>
<span id="cb21-3">        arch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>resnet34, </span>
<span id="cb21-4">        lin_ftrs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>], </span>
<span id="cb21-5">        emb_sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dimensionality of embeddings: 128 works pretty well. Sadly 3 is too small in my experience</span></span>
<span id="cb21-6">        ps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb21-7">        bn_final<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb21-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>(SiameseNet, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>).<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb21-9">        store_attr()</span>
<span id="cb21-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.body <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_body(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.arch, cut<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span>
<span id="cb21-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.head <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_head(num_features_model(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.body), <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.emb_sz, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.lin_ftrs, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.ps, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bn_final)</span>
<span id="cb21-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cnn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Sequential(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.body, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.head)</span>
<span id="cb21-13">                                  </span>
<span id="cb21-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x1, x2):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note that this expects two inputs not a single pair-like "SiameseImage" </span></span>
<span id="cb21-15">        output1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cnn(x1)</span>
<span id="cb21-16">        output2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cnn(x2)</span>
<span id="cb21-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.cat((output1,output2),dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  </span>
<span id="cb21-18">        </span>
<span id="cb21-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_embedding(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># operates on just one image instead of 2</span></span>
<span id="cb21-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cnn(x)</span>
<span id="cb21-21"></span>
<span id="cb21-22"></span>
<span id="cb21-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> split_out(out):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this will split the model output down the middle, into the set of two embeddings</span></span>
<span id="cb21-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.split(out, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(out.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb21-25"></span>
<span id="cb21-26">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.device(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mps'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span>
<span id="cb21-27">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SiameseNet().to(device)</span>
<span id="cb21-28">apply_init(model.head, nn.init.kaiming_normal_)</span>
<span id="cb21-29"></span>
<span id="cb21-30"></span>
<span id="cb21-31">CL_DISTANCE_FUNC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.pairwise_distance  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># btw, cosine similarity did not work well for me -SH</span></span>
<span id="cb21-32">CL_MARGIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># distance beyond which we stop pushing dissimilar items apart. 4 seems to work as well as any other value I tried.</span></span>
<span id="cb21-33"></span>
<span id="cb21-34"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> ContrastiveLoss(nn.Module):</span>
<span id="cb21-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Takes embeddings of two samples and a target label == 1 if samples are from the same class and label == 0 otherwise"""</span></span>
<span id="cb21-36">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>CL_MARGIN):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># big margin for training means "always keep pushing dissimilar points away"</span></span>
<span id="cb21-37">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>(ContrastiveLoss, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>).<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb21-38">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.margin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> margin</span>
<span id="cb21-39">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, embs, target):</span>
<span id="cb21-40">        emb1, emb2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> split_out(embs)</span>
<span id="cb21-41">        dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CL_DISTANCE_FUNC(emb1, emb2)</span>
<span id="cb21-42">        pdist, ndist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dist<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>target, dist<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>target)</span>
<span id="cb21-43">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ((pdist<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (F.relu(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ndist)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># relu serves as the "hinge"</span></span>
<span id="cb21-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> loss.mean()</span>
<span id="cb21-45">    </span>
<span id="cb21-46">    </span>
<span id="cb21-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> siamese_splitter(m):</span>
<span id="cb21-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> L(m.body, m.head).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(params)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading: "https://download.pytorch.org/models/resnet34-333f7ec4.pth" to /root/.cache/torch/hub/checkpoints/resnet34-333f7ec4.pth</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6256f42ad778484b84c4d61aa8fbddaa","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<p>We’ll define the following custom way of measuring accuracy, called <code>sim_acc</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># custom accuracy metric </span></span>
<span id="cb24-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sim(p, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>): </span>
<span id="cb24-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"where outputs are within delta of each other, they are similar (1), otherwise not (0)"</span> </span>
<span id="cb24-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> delta <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CL_MARGIN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a bit less than half the margin seems to work ok</span></span>
<span id="cb24-5">    p0, p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> split_out(p)</span>
<span id="cb24-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> (CL_DISTANCE_FUNC(p0,p1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> delta)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb24-7"></span>
<span id="cb24-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sim_acc(pred,targ, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb24-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"similarity accuracy"</span></span>
<span id="cb24-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ( sim(pred, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>delta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> targ ).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span></code></pre></div>
</div>
<p>Define the model, freeze it, and run the LRFinder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, model, loss_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ContrastiveLoss(), splitter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>siamese_splitter, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sim_acc)</span>
<span id="cb25-2">learn.freeze() </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">learn.lr_find()   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for some reason lr_find takes FOREVER.</span></span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<pre><code>SuggestedLRs(valley=tensor(0.0132))</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-20-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># below, note that sim_acc=0.5 is roughly the same as "random guessing"</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">sim_acc</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>182.274185</td>
<td>35.945770</td>
<td>0.654930</td>
<td>00:55</td>
</tr>
<tr class="even">
<td>1</td>
<td>127.189186</td>
<td>14.088330</td>
<td>0.654930</td>
<td>00:55</td>
</tr>
<tr class="odd">
<td>2</td>
<td>91.577187</td>
<td>6.649684</td>
<td>0.654930</td>
<td>00:57</td>
</tr>
<tr class="even">
<td>3</td>
<td>69.468987</td>
<td>4.976199</td>
<td>0.669014</td>
<td>00:55</td>
</tr>
<tr class="odd">
<td>4</td>
<td>55.596302</td>
<td>4.554039</td>
<td>0.683099</td>
<td>00:56</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">learn.unfreeze()</span>
<span id="cb29-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">slice</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">sim_acc</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>15.782226</td>
<td>4.337954</td>
<td>0.690141</td>
<td>00:56</td>
</tr>
<tr class="even">
<td>1</td>
<td>15.417539</td>
<td>4.133821</td>
<td>0.725352</td>
<td>00:57</td>
</tr>
<tr class="odd">
<td>2</td>
<td>14.990416</td>
<td>4.219871</td>
<td>0.753521</td>
<td>01:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>14.579235</td>
<td>4.243847</td>
<td>0.767606</td>
<td>00:59</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So, the accuracy is not as good as our regular “traditional”/“vanilla” classifier, but it’s still…well…actually…. I’ve run this many times in the course of preparing the post, and I’ve seen it score as high as 95% and as low as 75%. …Hmm. Well, moving on for now.</p>
<p>Now we’ll add a show_results method:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">myacc_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for diagnostically messing with delta</span></span>
<span id="cb30-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@typedispatch</span></span>
<span id="cb30-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> show_results(x:SiameseImage, y, samples, outs, ctxs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb30-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">global</span> myacc_val</span>
<span id="cb30-5">    sims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sim(y[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'delta'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> kwargs <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'delta'</span>])</span>
<span id="cb30-6">    acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (sims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean().item()   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute accuracy for diagnostic purposes</span></span>
<span id="cb30-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'show_acc'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> kwargs <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'show_acc'</span>]: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy = "</span>,acc)</span>
<span id="cb30-8">    myacc_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> acc</span>
<span id="cb30-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'just_acc'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> kwargs: <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span></span>
<span id="cb30-10"></span>
<span id="cb30-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> figsize <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: figsize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>ncols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb30-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> ctxs <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: ctxs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_grid(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], max_n), nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ncols, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>figsize)</span>
<span id="cb30-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i,ctx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(ctxs):</span>
<span id="cb30-14">        pred, targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sims[i].item(), x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>][i].item()</span>
<span id="cb30-15">        title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Actual: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not similar"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similar"</span>][targ]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> Prediction: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not similar"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similar"</span>][pred]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb30-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> targ: title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'***'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>title.upper()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'***'</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uppercase when we get it wrong</span></span>
<span id="cb30-17">        SiameseImage(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][i], x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][i], title).show(ctx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ctx)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">learn.show_results(max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, show_acc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  make max_n large &amp; vary delta to tweak performance</span></span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>accuracy =  0.78125</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-06-17-Contrasting-Contrastive-Loss_files/figure-html/cell-24-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="now-lets-visualize-the-embeddings" class="level3">
<h3 class="anchored" data-anchor-id="now-lets-visualize-the-embeddings">Now Let’s Visualize the Embeddings</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@patch</span></span>
<span id="cb33-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> siamembed(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>:Learner, item, rm_type_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, with_input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb33-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.predict(item, rm_type_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, with_input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb34-2"></span>
<span id="cb34-3">nclasses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(labels)</span>
<span id="cb34-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_clusters(labels,dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb34-5">    fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure()</span>
<span id="cb34-6">    colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(nclasses<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb34-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i,l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(labels):      </span>
<span id="cb34-8">        cluster <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(lbl2files[l]),dim))</span>
<span id="cb34-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j,f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(lbl2files[l]):         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: this is insanely slow; should use batches instead</span></span>
<span id="cb34-10">            img <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PILImage.create(f)</span>
<span id="cb34-11">            cluster[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learn.siamembed(SiameseImage(img, img))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>].detach().numpy() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: for now just grab the first 3 coorrdinates, not even PCA</span></span>
<span id="cb34-12">        fig.add_trace( go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cluster[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], hovertext<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels[i], name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels[i], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-13">            mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>colors[i])))</span>
<span id="cb34-14">    fig.show()</span>
<span id="cb34-15">    </span>
<span id="cb34-16">plot_clusters(labels)</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="4817aaba-9e4b-4af4-97ff-b299e4d095d8" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("4817aaba-9e4b-4af4-97ff-b299e4d095d8")) {
                    Plotly.newPlot(
                        '4817aaba-9e4b-4af4-97ff-b299e4d095d8',
                        [{"hovertext": "grizzly", "marker": {"color": "red", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "grizzly", "type": "scatter3d", "x": [0.1427900642156601, -0.008086610585451126, -0.04809732735157013, 0.12226875126361847, -0.07549791038036346, -0.21922582387924194, -0.008332505822181702, -0.02184370905160904, 0.14222785830497742, 0.13639792799949646, 0.014027617871761322, 0.022118479013442993, -0.11797241121530533, -0.09148385375738144, 0.1870245337486267, -0.5595685839653015, 0.05623913183808327, 0.030649248510599136, -0.1057056114077568, 0.0716935470700264, -0.060697365552186966, -0.14838190376758575, 0.08946672827005386, -0.2369043529033661, 0.05138576030731201, -0.11880197376012802, -0.03601909428834915, 0.08227914571762085, 0.09612242132425308, -0.00657949224114418, -0.039161767810583115, -0.08706442266702652, -0.13568538427352905, -0.012850619852542877, -0.06143249571323395, -0.04624880105257034, 0.093388631939888, -0.057557620108127594, 0.03993535041809082, 0.03596166521310806, 0.08057865500450134, 0.07838698476552963, 0.00985343661159277, -0.034711048007011414, -0.18861578404903412, -5.613267421722412e-05, 0.041127365082502365, 0.11228404939174652, 0.06751614809036255, -0.026992017403244972, 0.055520981550216675, 0.22277897596359253, 0.12289564311504364, -0.168520987033844, 0.1043577790260315, -0.28193938732147217, 0.23826682567596436, -0.15275561809539795, -0.1420431286096573, -0.2678516209125519, 0.03576759621500969, -0.02152252197265625, 0.007800940424203873, 0.017098318785429, 0.057998426258563995, -0.003067620098590851, 0.0034868940711021423, 0.01398632675409317, 0.09831200540065765, -0.001127399504184723, 0.09573052078485489, 0.08402368426322937, 0.036673810333013535, -0.09707922488451004, -0.07469980418682098, 0.22534531354904175, 0.06573735922574997, 0.07181957364082336, -0.14219467341899872, -0.15243297815322876, -0.0803726315498352, -0.1183348298072815, -0.1357971727848053, 0.016597166657447815, 0.11185453087091446, 0.07377555966377258, -0.0014940891414880753, -0.33643150329589844, 0.15644672513008118, 0.27862250804901123, 0.20883478224277496, 0.02243272215127945, -0.034015193581581116, 0.051374875009059906, -0.008295569568872452, -0.08960835635662079, 0.03813808783888817, 0.01201985776424408, 0.012274548411369324, 0.0922778844833374, 0.1053525060415268, -0.09529172629117966, 0.06549838185310364, 0.06815915554761887, 0.10513651371002197, 0.09973422437906265, -0.3062604069709778, 0.1574958860874176, 0.08568673580884933, 0.18573883175849915, 0.01686696708202362, 0.004881709814071655, 0.14250774681568146, -0.12979483604431152, 0.00489005446434021, 0.11997580528259277, 0.1685401201248169, -0.061505720019340515, -0.007397793233394623, 0.03610016405582428, -0.05420726537704468, -0.08667173981666565, -0.07683831453323364, -0.13916179537773132, -0.026918254792690277, 0.1059761643409729, 0.20105761289596558, 0.1414174735546112, -0.1291961669921875, -0.45107129216194153, 0.2791084349155426, -0.2280760109424591, 0.013212926685810089, -0.09695209562778473, -0.06750133633613586, 0.07262548804283142, -0.1032860204577446, -0.005809154361486435, 0.13431048393249512, -0.07480621337890625, 0.10018882155418396, -0.13754454255104065, 0.01092991977930069, 0.021759219467639923, 0.08384668827056885, -0.3054458796977997, -0.15833507478237152, -0.15572409331798553, 0.07213915139436722, 0.08917178213596344, -0.0006007105112075806, -0.12206323444843292, 0.08328182995319366, -0.10515718162059784, -0.04380457103252411, 0.14290782809257507, -0.14951284229755402, 0.05026068538427353, -0.0003549829125404358, 0.04449620097875595, -0.002394631505012512, 0.05165598914027214, 0.013468608260154724, 0.10981939733028412, -0.15205928683280945, 0.37412264943122864, 0.03566563501954079, -0.04805561155080795, 0.13036304712295532, 0.1060626357793808, -0.05804665386676788, -0.039848968386650085, -0.10456891357898712, 0.03155114874243736, -0.08390314131975174, 0.07797916233539581, 0.102145716547966, -0.05706360936164856, -0.0032813288271427155, -0.008315060287714005, -0.04069563001394272, 0.08080452680587769, 0.0016920790076255798, -0.10215705633163452, 0.03105999156832695, 0.02055564522743225, -0.1550752818584442, -0.1426658183336258, 0.007213988341391087, -0.045855484902858734, -0.012359626591205597, 0.014743469655513763, -0.07943621277809143, -0.06878151744604111, -0.04010690748691559, 0.15175460278987885, 0.16683410108089447, -0.06977172195911407, 0.1414276510477066, 0.2847931385040283, 0.05140651762485504, -0.013407677412033081, -0.10878976434469223, -0.07954595237970352, 0.03800201416015625, 0.025890212506055832, -0.09734989702701569, 0.12656861543655396, -0.010379716753959656, -0.19434013962745667, -0.08444765210151672, 0.10804743319749832, -0.11280988156795502, 0.13919766247272491, -0.20614281296730042, -0.1789826601743698, -0.24618880450725555, 0.14462298154830933, -0.020571216940879822, -0.22619250416755676, 0.14025306701660156, -0.031661972403526306, -0.04526905342936516, -0.0872156098484993, -0.16862064599990845, -0.2863786816596985, -0.17322711646556854, -0.13126757740974426, -0.11529907584190369, -0.14791297912597656, 0.03886333107948303, -0.13043969869613647, 0.18758642673492432, -0.10152494162321091, -0.07272449135780334, -0.022570274770259857, -0.23020051419734955, -0.274739533662796, 0.08550148457288742, -0.13169918954372406, -0.19088944792747498], "y": [0.05722782015800476, 0.13927599787712097, 0.18799078464508057, 0.1316613107919693, 0.008640521205961704, 0.5045021772384644, 0.3782379925251007, 0.3956988453865051, 0.14994484186172485, 0.07075086981058121, 0.09338309615850449, 0.491913765668869, 0.3830353319644928, -0.0963313952088356, 0.1633121371269226, 0.5440019369125366, -0.07646724581718445, -0.18755613267421722, 0.30704575777053833, 0.11510437726974487, 0.3130701780319214, -0.1176123321056366, 0.3335888981819153, 0.35816043615341187, 0.10413868725299835, 0.03039148822426796, -0.0020784963853657246, 0.05175606906414032, 0.4396771192550659, 0.04926253855228424, 0.11140835285186768, 0.4996057450771332, 0.29678794741630554, 0.27388086915016174, -0.07044797390699387, 0.02568521536886692, 0.3920830190181732, -0.19286862015724182, 0.31266504526138306, 0.08973380923271179, 0.2980270981788635, 0.23133689165115356, 0.18827636539936066, -0.008637458086013794, 0.2153465747833252, 0.24947331845760345, 0.3211005628108978, 0.38170769810676575, 0.15137803554534912, 0.13838902115821838, 0.15339940786361694, 0.25078174471855164, 0.11308100074529648, -0.033522363752126694, 0.227567657828331, 0.24197515845298767, 0.02176372893154621, 0.008829357102513313, 0.2095300704240799, 0.23217356204986572, 0.30172795057296753, 0.0331515334546566, -0.4588192403316498, 0.29664358496665955, -0.17260852456092834, 0.12106127291917801, -0.11910193413496017, 0.1601565033197403, 0.3603897988796234, 0.28941458463668823, 0.23164977133274078, 0.18486477434635162, 0.15349292755126953, 0.23532326519489288, 0.437697172164917, 0.2998359799385071, 0.15104304254055023, 0.15866482257843018, 0.5551255345344543, 0.0670609325170517, 0.23814235627651215, -0.10587938129901886, 0.14853835105895996, 0.1153770238161087, 0.22007699310779572, 0.408374160528183, 0.4088640809059143, 0.03574465215206146, 0.23876598477363586, 0.20122388005256653, 0.30799293518066406, 0.0883401557803154, -0.016978997737169266, 0.14825522899627686, 0.328730970621109, 0.10286550223827362, 0.14193302392959595, 0.18230411410331726, 0.17334231734275818, 0.1944374293088913, -0.0669303610920906, 0.4329603612422943, 0.18045157194137573, 0.12594515085220337, -0.20737335085868835, 0.14591765403747559, 0.22569787502288818, 0.33100152015686035, 0.291464239358902, 0.04410481080412865, -0.2797071039676666, 0.36254793405532837, -0.008781660348176956, 0.2532775402069092, 0.4061998724937439, 0.3047056198120117, 0.5431411266326904, 0.2839224338531494, 0.05775617063045502, -0.005483545362949371, 0.4272123873233795, 0.15419307351112366, 0.5078697800636292, -0.07635387778282166, 0.45117223262786865, 0.2966388165950775, 0.1660088300704956, 0.5417624711990356, 0.5031917095184326, 0.7224544286727905, -0.032367728650569916, 0.30255571007728577, 0.2631358206272125, 0.11550025641918182, 0.06982456892728806, 0.2679813802242279, 0.24869272112846375, 0.1597079187631607, -0.0030101388692855835, 0.34161698818206787, -0.05721328407526016, 0.37360289692878723, 0.03736221045255661, 0.3526099622249603, 0.24438534677028656, -0.07875083386898041, 0.250119686126709, -0.13886989653110504, 0.22857284545898438, 0.14072738587856293, 0.011008994653820992, 0.29378122091293335, 0.37133920192718506, 0.4876117408275604, 0.22864121198654175, 0.2725241184234619, 0.13971737027168274, -0.010759145021438599, 0.11541455239057541, 0.1485089808702469, 0.09976880252361298, 0.06670180708169937, 0.17031843960285187, 0.2731316089630127, 0.36886587738990784, 0.3231513798236847, 0.0450209379196167, -0.07675030082464218, -0.04369089752435684, 0.36946505308151245, 0.19929461181163788, 0.2685491740703583, 0.23630034923553467, 0.19558370113372803, 0.21265210211277008, 0.15382933616638184, -0.38077473640441895, 0.11230139434337616, 0.04583855718374252, 0.10972101241350174, 0.20345310866832733, 0.13694468140602112, 0.3042421340942383, -0.135141983628273, 0.3368035852909088, 0.02991168387234211, 0.5527070164680481, 0.16067059338092804, 0.043281327933073044, 0.020756639540195465, 0.03906484693288803, 0.03788045048713684, 0.2712031602859497, 0.148781880736351, 0.24862730503082275, 0.1104014664888382, 0.07526995241641998, 0.24223417043685913, 0.18320035934448242, 0.0437537357211113, 0.15103842318058014, -0.1301189810037613, 0.15532274544239044, 0.0477239191532135, 0.12857244908809662, 0.36164018511772156, 0.08818795531988144, -0.1612372100353241, 0.2467685490846634, -0.3759078085422516, 0.5154597163200378, -0.19477933645248413, 0.12036043405532837, -0.012598630040884018, 0.4329313039779663, 0.30050355195999146, 0.6600281000137329, -0.07132430374622345, 0.04157370328903198, 0.2695835530757904, 0.25269800424575806, 0.045198455452919006, 0.26741427183151245, 0.46875014901161194, 0.44805240631103516, -0.010751426219940186, 0.38574954867362976, -0.08367593586444855, -0.028937840834259987, 0.2861449420452118, 0.4439052641391754, 0.4891951084136963, 0.15558229386806488, 0.1607816368341446, 0.21674807369709015, 0.2605876922607422, 0.5382767915725708, 0.36765754222869873, 0.0895615741610527, 0.2035488486289978, 0.4130416512489319], "z": [0.032774537801742554, -0.12905427813529968, 0.20856909453868866, -0.014808684587478638, -0.16000500321388245, 0.23034918308258057, 0.22026151418685913, -0.03654388338327408, -0.09792433679103851, -0.06554670631885529, -0.2518603205680847, 0.13812115788459778, 0.07376046478748322, -0.1317448914051056, -0.09888875484466553, 0.30813443660736084, 0.04797740653157234, -0.04196156561374664, 0.06042639911174774, -0.06608185917139053, -0.03506558761000633, -0.19947829842567444, -0.09152418375015259, 0.17202448844909668, -0.11640001833438873, -0.1044171154499054, -0.06688432395458221, -0.2243949919939041, 0.13901107013225555, 0.051037661731243134, -0.026456404477357864, 0.16465558111667633, 0.0874117836356163, -0.05423074588179588, -0.13630500435829163, -0.07381211221218109, -0.14614643156528473, 0.12394827604293823, -0.12735053896903992, 0.012403436005115509, 0.04143206775188446, 0.21146191656589508, -0.08622068166732788, -0.219781294465065, 0.19184841215610504, -0.20090451836585999, -0.15584330260753632, 0.13713496923446655, 0.03963121771812439, 0.19883275032043457, 0.15234476327896118, -0.06916455924510956, -0.2141622006893158, -0.07411251217126846, 0.02373853325843811, -0.05971241742372513, -0.09226464480161667, -0.13265198469161987, 0.35679611563682556, -0.062422480434179306, -0.06566444039344788, -0.07548017799854279, 0.03847616910934448, -0.052797283977270126, -0.03084559738636017, -0.23095262050628662, 0.05309629812836647, -0.07940123230218887, 0.10658411681652069, -0.12743186950683594, 0.24503721296787262, -0.09877355396747589, -0.16780893504619598, -0.13536237180233002, 0.01694929413497448, 0.05839109793305397, -0.10282424837350845, -0.11959265917539597, 0.06690181791782379, -0.140109121799469, 0.048962511122226715, 0.03009694442152977, -0.006186649203300476, 0.0487593337893486, -0.0720137357711792, -0.02511519379913807, -0.14428646862506866, -0.038009658455848694, -0.07720382511615753, -0.07233333587646484, -0.009598016738891602, 0.022319771349430084, -0.11323992908000946, 0.011250630021095276, -0.06606446206569672, -0.015181556344032288, -0.11759891360998154, -0.12090247869491577, -0.032869189977645874, 0.06179709732532501, -0.22566024959087372, 0.27119991183280945, 0.210627019405365, -0.26659101247787476, 0.014410622417926788, -0.06333161145448685, -0.1265491098165512, -0.03171328455209732, -0.2505541741847992, 0.2866499423980713, -0.028895936906337738, -0.05826522409915924, -0.1219438910484314, -0.021938174962997437, -0.07145783305168152, -0.07064429670572281, 0.09298709034919739, -0.003397218883037567, 0.058452751487493515, -0.09905949234962463, 0.0964621976017952, -0.2738937735557556, 0.22433805465698242, 0.04785723611712456, 0.3517459034919739, 0.017422549426555634, 0.14062733948230743, 0.029225889593362808, 0.2619473934173584, 0.4800718426704407, 0.1994171142578125, -0.03612577170133591, -0.15182757377624512, -0.04742546007037163, -0.1116618812084198, -0.0753854364156723, -0.04912276566028595, -0.23097968101501465, -0.2175910621881485, 0.11899790167808533, -0.11233071982860565, 0.13431492447853088, -0.07599897682666779, 0.055169008672237396, 0.14437106251716614, -0.19707411527633667, 0.07855147123336792, -0.3280077576637268, -0.00923716090619564, -0.17887623608112335, -0.035081349313259125, 0.3759292662143707, 0.10748393833637238, 0.08823802322149277, 0.05255822092294693, 0.16742953658103943, 0.011698804795742035, -0.11181479692459106, -0.21079754829406738, -0.10334032028913498, -0.1850534975528717, -0.011418966576457024, -0.08024219423532486, -0.02055305801331997, -0.09869466722011566, -0.34102296829223633, -0.23488131165504456, -0.21931183338165283, -0.07465458661317825, -0.1143261045217514, -0.029208920896053314, -0.13416625559329987, 0.21869489550590515, -0.05057577043771744, -0.06507085263729095, 0.007763586938381195, -0.12105954438447952, -0.017999317497015, -0.35475435853004456, -0.3074062168598175, -0.08150994777679443, 0.1972401887178421, 0.03696154057979584, -0.10381679236888885, 0.20102976262569427, -0.09487895667552948, 0.03829128295183182, -0.11512890458106995, -0.08433046191930771, -0.19474922120571136, -0.16210421919822693, -0.2587335407733917, -0.048482295125722885, -0.04390355199575424, -0.007456950843334198, -0.10472902655601501, -0.13989637792110443, 0.03439352661371231, -0.2891635298728943, -0.0642368420958519, -0.11987600475549698, -0.016139309853315353, 0.09813019633293152, -0.20017889142036438, -0.0328320637345314, -0.17665407061576843, 0.30690574645996094, -0.10832741856575012, 0.16728568077087402, -0.11186452955007553, 0.1374981701374054, -0.04941564053297043, -0.06158516928553581, -0.24424436688423157, 0.30437615513801575, -0.08936330676078796, 0.3587783873081207, -0.07160376012325287, 0.05844755098223686, 0.12576651573181152, -0.13183428347110748, -0.3401293158531189, 0.17671777307987213, -0.07929021120071411, 0.3131140470504761, -0.08287186920642853, 0.3413864076137543, 0.10351012647151947, -0.14557236433029175, -0.1438109427690506, 0.3016898036003113, -0.013503476977348328, -0.0856412872672081, -0.19807696342468262, -0.15415416657924652, -0.12269233167171478, 0.19538067281246185, 0.06799718737602234, 0.01862739771604538, 0.021523959934711456, -0.09981681406497955]}, {"hovertext": "black", "marker": {"color": "green", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "black", "type": "scatter3d", "x": [0.35960954427719116, 0.3360121250152588, 0.06085364893078804, 0.024088405072689056, 0.2781960964202881, 0.1412961632013321, 0.0800497904419899, 0.0077080316841602325, 0.13691937923431396, 0.3491545021533966, 0.06473811715841293, 0.36321431398391724, 0.11104047298431396, 0.06951553374528885, 0.02610103040933609, 0.06919564306735992, 0.014490611851215363, 0.05518291890621185, 0.3706645369529724, 0.29811179637908936, 0.09081593155860901, 0.2599934935569763, -0.09432436525821686, -0.09147238731384277, 0.009607434272766113, -0.09742020070552826, 0.0049538761377334595, -0.3212754428386688, 0.06988706439733505, 0.021024800837039948, 0.061530016362667084, 0.32214438915252686, 0.18906797468662262, 0.02326393872499466, 0.122881680727005, -0.007608428597450256, -0.06947677582502365, 0.08927193284034729, 0.20843270421028137, 0.08266203850507736, 0.33714115619659424, 0.32894569635391235, 0.12165236473083496, 0.003515571355819702, 0.07335120439529419, 0.02590090036392212, 0.35280823707580566, -0.09035874158143997, -0.11157292127609253, 0.2036065012216568, 0.02159624546766281, 0.14521196484565735, -0.03851453959941864, -0.28130581974983215, 0.3613930940628052, 0.05185732990503311, 0.4040604829788208, 0.1556132286787033, 0.17443016171455383, 0.19201475381851196, 0.04572924226522446, -0.123334139585495, 0.4011414349079132, 0.2370625138282776, 0.09155547618865967, 0.29007190465927124, 0.09589442610740662, 0.24244391918182373, 0.11061210930347443, 0.014897570013999939, 0.3210509121417999, 0.2119196504354477, 0.0435318797826767, 0.14466050267219543, 0.15854202210903168, 0.2659838795661926, 0.02877619117498398, -0.11032897979021072, 0.4035748243331909, 0.15043692290782928, -0.09332184493541718, -0.014608511701226234, 0.062050241976976395, 0.011012375354766846, 0.022855721414089203, 0.37507450580596924, 0.5061303973197937, 0.04399299621582031, 0.0802583396434784, 0.029824692755937576, 0.028151296079158783, 0.20268389582633972, 0.20972715318202972, 0.2072349488735199, 0.489559143781662, 0.3051183223724365, 0.03226349502801895, 0.3452526032924652, 0.12483328580856323, 0.16439133882522583, -0.035442739725112915, 0.16745077073574066, 0.03165581077337265, -0.18319052457809448, 0.2061861753463745, 0.2945716381072998, 0.4087428152561188, -0.13321375846862793, 0.22083629667758942, 0.3663199841976166, 0.2579679489135742, 0.1693945974111557, 0.12378917634487152, 0.1577717810869217, -0.1595863401889801, 0.10377319157123566, 0.0900026485323906, 0.0900411456823349, 0.28578922152519226, -0.03639078885316849, 0.20291545987129211, -0.05979970842599869, 0.20201998949050903, 0.04176813364028931, 0.10754944384098053, 0.22881245613098145, 0.2106301188468933, -0.15553425252437592, 0.22969520092010498, -0.037703804671764374, 0.40124088525772095, 0.06336081027984619, -0.12494323402643204, 0.033374540507793427, 0.16610512137413025, -0.06129078567028046, -0.0787622332572937, 0.20022034645080566, 0.23536905646324158, -0.090711310505867, 0.3887704908847809, -0.016349807381629944, 0.14949670433998108, 0.23987334966659546, 0.21583834290504456, 0.3238780200481415, 0.28474634885787964, 0.0008874712511897087, 0.16595160961151123, 0.18435509502887726, 0.1559762954711914, -0.15470626950263977, 0.15016071498394012, 0.08994971215724945, -0.033952467143535614, -0.06882825493812561, 0.07156054675579071, -0.08095405995845795, 0.03633701056241989, 0.19129028916358948, -0.20929169654846191, 0.24744078516960144, 0.14642739295959473, -0.006537407636642456, 0.22453972697257996, -0.012799635529518127, 0.34279492497444153, 0.4225412607192993, 0.48744601011276245, 0.24216046929359436, 0.1986699104309082, 0.1344834715127945, 0.03481476008892059, -0.03048340603709221, -0.055384911596775055, -0.17583268880844116, 0.10873795300722122, -0.04906204715371132, 0.035755306482315063, -0.020117081701755524, 0.04198993742465973, 0.2342885434627533, 0.12335366755723953, 0.15071216225624084, 0.13001561164855957, 0.2688031792640686, -0.03145507723093033, -0.20105108618736267, 0.02523229457437992, -0.0013994313776493073, 0.3393229842185974, 0.22566837072372437, -0.003186739981174469, -0.0009085573256015778, 0.15077106654644012, 0.26946327090263367, 0.17421862483024597, -0.18419061601161957, 0.10173830389976501, -0.08282891660928726, 0.2401062250137329, 0.08610139042139053, 0.1441747099161148, 0.13677182793617249, 0.06700398772954941, 0.13022029399871826, -0.049591585993766785, 0.3855307400226593, 0.004433028399944305, 0.05128948763012886, -0.05679541081190109, 0.15903472900390625, 0.06307455152273178, 0.36177685856819153, 0.17374944686889648, 0.09148827195167542, 0.2906346619129181, 0.09053124487400055, 0.10231932997703552, 0.16236457228660583, 0.1755424439907074, 0.17402179539203644, -0.08719292283058167, 0.027792997658252716, 0.03825290501117706, -0.12250581383705139, 0.020042628049850464, 0.2791084349155426, 0.3736671209335327, 0.129705548286438, 0.22646193206310272, 0.2954506278038025, -0.01553284376859665, 0.13424953818321228, 0.17647965252399445, 0.2583821415901184, 0.13539829850196838, 0.13217702507972717, 0.09769771993160248], "y": [-0.04660508781671524, -0.021513190120458603, -0.12889710068702698, 0.1115218997001648, -0.04965122044086456, 0.16819848120212555, -0.21083462238311768, -0.029072407633066177, 0.15317481756210327, 0.1991211622953415, -0.14922849833965302, 0.12428570538759232, -0.06602834910154343, 0.2577870488166809, 0.14777442812919617, 0.06377620249986649, -0.039024967700242996, -0.14360377192497253, -0.059584811329841614, 0.02237539179623127, 0.11467339843511581, 0.1487206369638443, 0.06339385360479355, 0.006825082004070282, 0.07244144380092621, 0.24473807215690613, 0.07780589163303375, -0.12837770581245422, -0.1583399772644043, 0.1914486587047577, 0.12784263491630554, 0.21492831408977509, 0.10102663934230804, -0.023138608783483505, -0.20594753324985504, -0.15452538430690765, 0.14545658230781555, -0.2284674048423767, -0.47682899236679077, -0.00515403226017952, 0.05676012858748436, 0.08051688969135284, 0.15283910930156708, -0.07292477786540985, 0.04218514263629913, 0.02517181634902954, 0.10018845647573471, -0.0124799944460392, -0.08152232319116592, 0.13902898132801056, 0.17104822397232056, 0.10072048008441925, -0.1269175112247467, -0.20839524269104004, 0.09041807055473328, 0.04103546589612961, -0.10704696178436279, 0.17575478553771973, -0.11530923843383789, -0.2918323278427124, 0.07447267323732376, 0.03896272927522659, 0.2870565950870514, -0.0779404416680336, -0.18341732025146484, 0.21903759241104126, -0.16162444651126862, 0.06542447209358215, -0.3074988126754761, -0.2481893002986908, 0.03169335424900055, 0.10888376086950302, -0.03095231205224991, 0.05923571065068245, -0.0061658695340156555, -0.011158060282468796, -0.09365596622228622, -0.2305566370487213, 0.24290060997009277, -0.24049122631549835, 0.21217447519302368, -0.06910213828086853, -0.09626998007297516, 0.06356874108314514, 0.06284107267856598, 0.195238396525383, 0.14445355534553528, -0.018634133040905, 0.13597433269023895, 0.031403347849845886, -0.06197425723075867, 0.11489054560661316, -0.1989031732082367, -0.1162756085395813, 0.30836623907089233, 0.1379299759864807, -0.05021713674068451, 0.07769365608692169, 0.2030826210975647, 0.08402013778686523, 0.039909668266773224, -0.004506655037403107, 0.13661479949951172, -0.1112087219953537, -0.23675553500652313, 0.08818389475345612, 0.02132265269756317, 0.063527412712574, -0.15875068306922913, -0.02040671929717064, 0.14215624332427979, 0.251015841960907, -0.09222722053527832, 0.1689184308052063, 0.0993267148733139, 0.14324602484703064, 0.37458112835884094, 0.21758593618869781, 0.23087091743946075, -0.02182740718126297, 0.21735543012619019, 0.18734483420848846, -0.19206729531288147, -0.046862777322530746, 0.2654598355293274, -0.11003348976373672, -0.06019405275583267, 0.3892594575881958, -0.06084102764725685, 0.09785796701908112, 0.20306077599525452, 0.1217377558350563, 0.06728167831897736, 0.13841454684734344, 0.11210376024246216, 0.14338546991348267, -0.10435013473033905, -0.1785762459039688, 0.04838533326983452, 0.13105246424674988, 0.3188212215900421, 0.07511693239212036, 0.17587928473949432, 0.03648913651704788, 0.022302523255348206, -0.00029634684324264526, 0.09598471224308014, -0.07307988405227661, -0.037413425743579865, 0.03758968785405159, 0.07119394093751907, -0.03265001252293587, 0.25914695858955383, -0.14581167697906494, 0.12445801496505737, -0.06375487148761749, 0.12194108963012695, -0.2792980372905731, 0.28071117401123047, -0.035519860684871674, -0.2425963580608368, -0.12835846841335297, 0.23807351291179657, -0.19454152882099152, -0.22544413805007935, -0.2574251592159271, -0.005689635872840881, -0.16803103685379028, 0.15113870799541473, 0.059935521334409714, 0.05003096163272858, -0.20178796350955963, 0.08362463861703873, 0.01925378479063511, 0.010361742228269577, -0.20200631022453308, 0.27053898572921753, -0.26032155752182007, -0.15131770074367523, 0.13349036872386932, 0.07756440341472626, 0.326627254486084, -0.010563461109995842, 0.00586111843585968, 0.06420152634382248, 0.16119810938835144, -0.10134708881378174, -0.075065977871418, -0.09872760623693466, -0.01707608252763748, 0.13047146797180176, -0.01957843452692032, -0.199989914894104, 0.23420041799545288, 0.12959571182727814, 0.02326206862926483, 0.07743415236473083, 0.03707021474838257, 0.0709521695971489, -0.056003764271736145, 0.18871928751468658, -0.021057208999991417, -0.09134382009506226, -0.09856279194355011, -0.025483902543783188, 0.04369496926665306, 0.06477434933185577, -0.0758870393037796, -0.16785259544849396, 0.2927016019821167, 0.007022585719823837, 0.023076683282852173, -0.18878887593746185, -0.28057634830474854, 0.12642920017242432, 0.023533795028924942, -0.11204448342323303, -0.006558313965797424, 0.010648272931575775, -0.010420817881822586, 0.1327056884765625, -0.1646815538406372, -0.10021991282701492, 0.17455066740512848, -0.0045227669179439545, 0.12439381331205368, 0.08948023617267609, -0.032367728650569916, -0.06010529026389122, 0.12160078436136246, 0.283590167760849, 0.012926939874887466, 0.06445562094449997, -0.1977117359638214, 0.31435737013816833, 0.18247844278812408, 0.039975788444280624, 0.08855389058589935, -0.03987407311797142], "z": [-0.2149137556552887, 0.004564434289932251, 0.15824098885059357, -0.021065417677164078, -0.15719498693943024, -0.06040385738015175, 0.017461443319916725, -0.05145309865474701, 0.1589219719171524, -0.07411517202854156, -0.043994657695293427, -0.143626406788826, -0.03232390433549881, -0.11604193598031998, -0.033118002116680145, -0.3206919729709625, 0.037333130836486816, 0.09155765175819397, 0.11830854415893555, 0.06146259605884552, -0.14151515066623688, -0.12440169602632523, -0.3759843707084656, 8.553266525268555e-05, -0.07122928649187088, -0.05829797312617302, -0.20981842279434204, 0.021162450313568115, 0.02616894245147705, -0.10312407463788986, -0.1928825080394745, -0.1461019068956375, -0.09717076271772385, -0.06306850165128708, -0.08274827152490616, 0.17574144899845123, -0.1527007818222046, 0.10185075551271439, 0.10857043415307999, -0.09519452601671219, 0.2006026804447174, -0.1318873018026352, -0.1221543550491333, -0.10465842485427856, -0.18525761365890503, 0.05136322230100632, 0.11805222183465958, -0.06001030653715134, -0.18255536258220673, 0.015226965770125389, -0.043065208941698074, -0.11597955971956253, -0.10983551293611526, -0.22311286628246307, 0.07649489492177963, -0.1523360013961792, 0.06520915776491165, -0.12004277855157852, -0.03288227692246437, 0.021753501147031784, -0.0718977153301239, -0.07551244646310806, 0.10794775933027267, 0.15063613653182983, -0.019876888021826744, 0.10570734739303589, 0.047485075891017914, -0.11540543287992477, -0.0674218237400055, -0.06716829538345337, 0.04145614057779312, 0.029067128896713257, -0.16572055220603943, -0.05203825235366821, 0.09944457560777664, -0.020986519753932953, 0.1065714955329895, -0.1492517590522766, -0.09826785326004028, 0.14823341369628906, -0.05825698375701904, -0.14883628487586975, 0.0866478681564331, -0.19310376048088074, -0.004953563213348389, -0.04265144094824791, 0.10743798315525055, -0.09233103692531586, -0.08643686771392822, 0.030053425580263138, -0.26311779022216797, -0.13994194567203522, -0.007654862478375435, 0.08110105991363525, -0.08169224858283997, -0.02573012188076973, 0.029479488730430603, -0.046705834567546844, -0.05600995197892189, -0.10851161181926727, -0.16524408757686615, -0.11191963404417038, -0.14065007865428925, -0.13090834021568298, -0.09124073386192322, -0.21757872402668, 0.25026705861091614, -0.10425911098718643, -0.03536734730005264, 0.010416664183139801, -0.05346950516104698, -0.1023695170879364, -0.016697879880666733, -0.16207052767276764, -0.009047523140907288, -0.2262175977230072, -0.03682895749807358, 0.13874825835227966, -0.12050285935401917, 0.026895321905612946, -0.2915448546409607, -0.06273636966943741, -0.25050705671310425, -0.07865488529205322, -0.14302197098731995, 0.14225441217422485, 0.05620484799146652, 0.07496197521686554, -0.060332998633384705, -0.15705853700637817, 0.059676315635442734, 0.050677649676799774, -0.002866595983505249, -0.045860063284635544, -0.08929566293954849, -0.17910999059677124, -0.023558223620057106, 0.15864400565624237, -0.07553470134735107, -0.11074227094650269, -0.01938091218471527, -0.12818202376365662, -0.07328349351882935, -0.053613051772117615, -0.10085520148277283, 0.2774384617805481, -0.10470137000083923, -0.005864316131919622, -0.07688992470502853, -0.02397587150335312, -0.053292416036129, 0.014729520305991173, -0.22818616032600403, 0.06138332933187485, -0.04894743859767914, 0.023669030517339706, -0.11097262799739838, -0.24198287725448608, -0.12307623028755188, 0.06192822754383087, -0.006003467366099358, 0.003137648105621338, -0.12559957802295685, -0.07396918535232544, 0.024501383304595947, 0.18114948272705078, -0.08895948529243469, 0.2896652817726135, -0.12827657163143158, 0.006058752536773682, -0.17742595076560974, -0.08246392756700516, -0.0560227632522583, -0.2604292333126068, -0.007364929653704166, 0.05227616801857948, -0.10240017622709274, -0.08630113303661346, 0.10792932659387589, 0.019322529435157776, -0.18499478697776794, -0.07971588522195816, 0.0022426918148994446, -0.08809622377157211, -0.11367350816726685, -0.19216883182525635, -0.04193684831261635, 0.10932977497577667, -0.03766658157110214, -0.056916967034339905, 0.07803351432085037, 0.003708082716912031, -0.05474747717380524, 0.1557290256023407, 0.015255710110068321, -0.23514045774936676, -0.09628018736839294, -0.1096198558807373, 0.1751730591058731, -0.08648563921451569, -0.21255940198898315, -0.05667603015899658, -0.08090831339359283, 0.044439271092414856, -0.06172661855816841, -0.11138699948787689, -0.118268683552742, -0.09518636018037796, 0.002320326864719391, -0.32902973890304565, -0.06821245700120926, -0.06138203665614128, -0.013522117398679256, -0.03063908964395523, -0.07797408103942871, -0.10759283602237701, -0.05823566019535065, 0.14035336673259735, -0.04770388826727867, -0.026409734040498734, -0.23622387647628784, 0.07517753541469574, -0.02706281840801239, 0.11679240316152573, -0.1024063378572464, -0.09056411683559418, 0.06293230503797531, 0.1994171142578125, 0.030378974974155426, -0.1573466658592224, -0.060691554099321365, -0.09332703799009323, -0.17095056176185608, 0.23505020141601562, -0.10103360563516617, -0.0400640107691288, -0.09793617576360703, -0.10980850458145142, -0.1395168900489807]}, {"hovertext": "teddy", "marker": {"color": "blue", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "teddy", "type": "scatter3d", "x": [-0.01949150860309601, -0.015970563516020775, 0.021611392498016357, 0.04952796548604965, -0.018900573253631592, 0.13903363049030304, 0.09149109572172165, 0.0447603240609169, 0.08763372898101807, -0.02054346725344658, 0.10124330222606659, -0.13681736588478088, -0.008216563612222672, -0.10934622585773468, -0.07566727697849274, -0.000980369746685028, 0.07772301137447357, -0.0430302619934082, -0.03304270654916763, -0.08880658447742462, 0.04351623356342316, -0.0594407394528389, 0.061593197286129, 0.0009437017142772675, 0.028625614941120148, -0.044315993785858154, -0.07627721130847931, -0.10076014697551727, -0.261305570602417, 0.08290332555770874, 0.036862388253211975, 0.06482064723968506, -0.0013989955186843872, 0.035463035106658936, -0.03109288029372692, 0.12020286172628403, -0.18447916209697723, -0.1309589147567749, 0.04545913264155388, -0.052521005272865295, -0.11616593599319458, -0.08348291367292404, -0.15845632553100586, -0.17724424600601196, -0.20968204736709595, 0.012808305211365223, -0.08209152519702911, 0.01644177734851837, -0.04079192876815796, -0.008879616856575012, -0.010366186499595642, 0.013912167400121689, 0.10608527064323425, -0.15270249545574188, 0.04266978055238724, 0.016818752512335777, -0.12188921868801117, -0.05268508195877075, -0.12041781842708588, 0.010562792420387268, -0.056705474853515625, -0.08118177950382233, 0.016168102622032166, -0.13821955025196075, -0.1905490756034851, -0.105684295296669, 0.025271743535995483, -0.08662663400173187, -0.034126684069633484, -0.185060515999794, -0.018215510994195938, 0.07543735206127167, 0.08614258468151093, -0.029046624898910522, -0.03333893045783043, -0.06736554205417633, -0.12620314955711365, 0.007224201690405607, 0.049758605659008026, -0.055775344371795654, -0.10012330114841461, 0.1343686580657959, -0.04950407147407532, 0.10073348879814148, 0.029475703835487366, 0.036845047026872635, -0.13897287845611572, -0.1024065911769867, 0.024492323398590088, 0.004758860915899277, -0.1582525074481964, -0.1985601782798767, 0.009531328454613686, -0.16274353861808777, 0.0721435472369194, -0.07040359079837799, 0.0019323751330375671, -0.14122959971427917, -0.10638488829135895, 0.08787252008914948, -0.05898213014006615, -0.1271878331899643, 0.17279896140098572, -0.026618167757987976, -0.012908995151519775, -0.26578858494758606, -0.04454152286052704, 0.03493967652320862, -0.13373351097106934, 0.056816160678863525, -0.05339130014181137, 0.08646200597286224, -0.10714351385831833, -0.09169243276119232, -0.03135436773300171, -0.07485830783843994, -0.09712379425764084, -0.0836637020111084, -0.07236570119857788, -0.2572648823261261, 0.0012185834348201752, -0.016974568367004395, 0.06066916882991791, -0.04284512996673584, -0.0723375603556633, 0.01878010854125023, -0.16008222103118896, -0.09587128460407257, -0.017802003771066666, 0.024694889783859253, 0.14989906549453735, -0.012361109256744385, -0.058717407286167145, 0.10148512572050095, 0.09426340460777283, -0.2030431479215622, -0.07248887419700623, -0.16098544001579285, 0.04383815452456474, -0.13481339812278748, -0.22220692038536072, 0.05326235294342041, 0.020822465419769287, -0.12229546159505844, -0.1540236473083496, -0.0958075001835823, -0.16801100969314575, -0.020548813045024872, 0.01628870517015457, 0.04525374248623848, 0.010655820369720459, 0.02748909965157509, 0.090300053358078, -0.1123892217874527, 0.06935913860797882, 0.012413270771503448, -2.4769455194473267e-05, -0.12941023707389832, 0.0013763494789600372, -0.1081341803073883, -0.0064871907234191895, -0.14807157218456268, -0.03452445566654205, -0.05983509123325348, -0.21448001265525818, -0.08607422560453415, -0.037364937365055084, 0.038830481469631195, -0.017008423805236816, 0.021723922342061996, -0.15788999199867249, 0.055326640605926514, -0.03876291215419769, -0.17495393753051758, -0.029078543186187744, -0.12647657096385956, -0.0739583820104599, -0.17739447951316833, -0.11080364882946014, -0.19902350008487701, -0.00012265890836715698, -0.27980393171310425, -0.03301582485437393, -0.20486631989479065, -0.11000190675258636, -0.04721692204475403, -0.10023218393325806, -0.1535533368587494, -0.04741587117314339, -0.1654333770275116, -0.09961466491222382, -0.14159418642520905, 0.16486047208309174, -0.12125001102685928, -0.08584436774253845, -0.013435110449790955, 0.009593427181243896, -0.0886557474732399, -0.05400846153497696, 0.016350746154785156, 0.040951021015644073, -0.04773405194282532, 0.06953197717666626, -0.013396680355072021, -0.13812953233718872, -0.036769840866327286, -0.11370432376861572, 0.0035371407866477966, -0.006019338965415955, 0.005180224776268005, 0.10603384673595428, 0.1535326987504959, -0.06199383735656738, -0.04372173547744751, 0.06800909340381622, -0.04007942974567413, -0.024726415053009987, -0.11128586530685425, 0.07001495361328125, 0.04699982702732086, -0.05868152901530266, -0.0803493931889534, 0.0237533301115036, 0.04150757938623428, -0.1182803362607956, 0.01737978681921959, 0.04887890815734863, -0.08180361986160278, -0.024493064731359482, 0.00033907219767570496, -0.045492179691791534, -0.000490918755531311, -0.012863561511039734, 0.08354765176773071], "y": [-0.1024344265460968, 0.04907764494419098, -0.27990859746932983, -0.24971455335617065, 0.09544093906879425, -0.3718201518058777, 0.03435984253883362, -0.0748031735420227, -0.127811998128891, -0.20771683752536774, -0.295297771692276, 0.05179760605096817, -0.19776713848114014, -0.04919484630227089, 0.25162720680236816, 0.022307438775897026, -0.09158322960138321, -0.18941596150398254, -0.021451525390148163, -0.13904976844787598, -0.2608833909034729, -0.14379937946796417, 0.029544934630393982, 0.1497693657875061, -0.1908051073551178, -0.19707459211349487, -0.05776612460613251, 0.07843706011772156, 0.0867210179567337, -0.02022414654493332, -0.38817697763442993, 0.09839905053377151, -0.0881504938006401, -0.4446205496788025, -0.09382691979408264, 0.1047813817858696, 0.24585430324077606, -0.3000648021697998, 0.013133521191775799, 0.07143880426883698, -0.2754346430301666, -0.055798567831516266, -0.3440875709056854, 0.19882354140281677, -0.05709303915500641, 0.09781315922737122, 0.04463846981525421, -0.41912955045700073, -0.29418712854385376, 0.11310632526874542, 0.03291456773877144, 0.18020865321159363, -0.21898958086967468, 0.04954510182142258, 0.14502954483032227, 0.09427722543478012, -0.08457484841346741, -0.002125672996044159, -0.212772935628891, -0.2419472336769104, -0.2643466889858246, -0.16127079725265503, -0.04659540206193924, -0.05514711141586304, -0.09968540817499161, -0.2740577459335327, -0.24533386528491974, -0.12998096644878387, -0.19754362106323242, 0.003014996647834778, -0.05502311512827873, -0.07926301658153534, 0.0011798590421676636, 0.048913873732089996, -0.1925732046365738, -0.007193494588136673, -0.27002108097076416, 0.1538795530796051, 0.1351030319929123, -0.327849417924881, -0.12326851487159729, -0.13581089675426483, -0.27694615721702576, 0.21397094428539276, 0.21627818048000336, -0.05547771602869034, -0.06684055924415588, -0.21512988209724426, -0.005256533622741699, -0.055044177919626236, -0.23258192837238312, -0.09323158115148544, 0.10399695485830307, -0.27490973472595215, -0.146023690700531, -0.0965791642665863, -0.07552895694971085, 0.18487918376922607, -0.21126344799995422, -0.19800908863544464, -0.09702470898628235, -0.2976648807525635, 0.0034576989710330963, -0.1500696837902069, 0.11815503984689713, -0.0796641856431961, -0.07726787775754929, -0.26285526156425476, 0.07672731578350067, -0.10509711503982544, 0.09984033554792404, 0.11418580263853073, 0.011504694819450378, -0.23287594318389893, -0.14835283160209656, -0.10992167145013809, -0.14645087718963623, 0.22968268394470215, 0.05758705735206604, -0.22087152302265167, -0.23731938004493713, -0.24720071256160736, -0.18039289116859436, -0.17299899458885193, -0.24279171228408813, 0.08523771166801453, 0.16027109324932098, -0.14295737445354462, -0.06713361293077469, -0.24208420515060425, -0.15847915410995483, 0.025465063750743866, -0.18858204782009125, -0.32057714462280273, -0.10169833898544312, -0.3885008692741394, 0.004038538783788681, 0.055790308862924576, -0.027316078543663025, 0.16652067005634308, 0.0012235715985298157, -0.13053782284259796, -0.14609332382678986, -0.3052884638309479, -0.22227594256401062, -0.00041441619396209717, -0.05012032389640808, -0.04140515998005867, -0.14123302698135376, 0.07241156697273254, 0.06822335720062256, -0.07169986516237259, -0.11422190815210342, -0.11499864608049393, -0.21901431679725647, -0.2257610261440277, -0.14371974766254425, -0.1558932662010193, -0.23671561479568481, 0.13934749364852905, -0.4276365637779236, 0.08116599917411804, -0.1339017152786255, 0.1676291823387146, -0.1597445011138916, -0.035586416721343994, -0.12028529495000839, -0.16985228657722473, -0.08166006952524185, -0.16744215786457062, -0.030835196375846863, 0.03208846598863602, 0.04053260013461113, -0.1621565967798233, -0.0557255893945694, -0.2203611135482788, -0.245665043592453, 0.09437982738018036, -0.2385782152414322, -0.3048075735569, -0.30133044719696045, 0.12214839458465576, 0.003871716558933258, -0.01740385964512825, -0.27842357754707336, 0.12458129972219467, 0.07487643510103226, -0.2880534827709198, -0.11473271250724792, 0.14508900046348572, -0.015562698245048523, -0.17117741703987122, -0.14916017651557922, -0.3731306195259094, -0.10339923202991486, -0.3943195641040802, 0.018984448164701462, -0.10950016230344772, -0.13596254587173462, -0.42655760049819946, -0.04047957807779312, -0.25101181864738464, -0.021305982023477554, 0.18902073800563812, -0.16830238699913025, -0.1651340276002884, -0.19142764806747437, -0.1994340419769287, -0.19256721436977386, -0.33829328417778015, 0.12417937070131302, -0.0838850736618042, -0.1666886806488037, -0.21211953461170197, 0.062463924288749695, -0.006908544339239597, -0.04475130885839462, -0.2741965353488922, -0.12589029967784882, -0.2611624300479889, -0.03232116997241974, -0.014378078281879425, -0.27393341064453125, -0.04123830795288086, -0.3478674590587616, 0.060059402137994766, -0.04769498109817505, -0.3155328333377838, 0.10606229305267334, -0.02306247502565384, -0.002424333244562149, -0.2442232370376587, -0.0843624472618103, -0.007957853376865387], "z": [0.306138277053833, 0.050229307264089584, 0.01831662654876709, 0.08139704167842865, 0.13257597386837006, 0.13828347623348236, 0.12137474119663239, 0.0980762466788292, 0.2964104115962982, 0.15714672207832336, 0.05112890154123306, 0.04051993787288666, -0.03483173996210098, -0.0757635161280632, 0.21431183815002441, 0.07762318849563599, 0.045811980962753296, 0.06888867169618607, 0.19482947885990143, 0.02286650612950325, 0.08060619235038757, 0.06797866523265839, 0.11869746446609497, 0.12788206338882446, 0.2967213988304138, 0.08287624269723892, 0.07908747345209122, -0.0341319665312767, -0.17680799961090088, 0.05082526057958603, 0.1498086303472519, -0.12423337250947952, -0.030659236013889313, 0.18301120400428772, -0.0741080790758133, -0.026968374848365784, 0.0936289131641388, -0.02854970097541809, 0.0025017820298671722, -0.25195175409317017, -0.06683854013681412, -0.10670921206474304, 0.041441887617111206, -0.05640370398759842, -0.017350591719150543, -0.00865921750664711, -0.04297468066215515, 0.10945400595664978, 0.11388559639453888, 0.1526360809803009, 0.022022794932127, 0.06337656825780869, 0.18455779552459717, 0.08034177124500275, 0.09761126339435577, -0.14414973556995392, -0.04209344834089279, -0.00475485622882843, 0.04687163233757019, 0.2441549152135849, 0.01215527206659317, 0.18275348842144012, 0.09826892614364624, -0.009317226707935333, 0.037201888859272, 0.10010691732168198, 0.09664779156446457, 0.06191129982471466, 0.08533784002065659, -0.09953901171684265, 0.0936380922794342, 0.16410815715789795, 0.05523234233260155, -0.020754791796207428, 0.010674282908439636, 0.07108819484710693, 0.015383511781692505, 0.2564581334590912, 0.13710743188858032, 0.08915682137012482, -0.05946514755487442, 0.15514890849590302, 0.10423299670219421, 0.22345910966396332, 0.049474455416202545, 0.015866655856370926, 0.04621030390262604, 0.10779434442520142, -0.004230126738548279, -0.13138671219348907, -0.02514086663722992, -0.12533527612686157, 0.014274060726165771, -0.05450483411550522, 0.12019661068916321, 0.18132522702217102, 0.1668289452791214, -0.004353625699877739, 0.14769472181797028, 0.13061392307281494, 0.020393282175064087, 0.13139937818050385, 0.2809295952320099, 0.019359774887561798, 0.22882917523384094, -0.06248211860656738, 0.14455610513687134, -0.05631842464208603, 0.01220681518316269, -0.04695555567741394, 0.07039837539196014, 0.2887387275695801, -0.05476858466863632, 0.049208998680114746, 0.033741436898708344, -0.004304781556129456, -0.1230444461107254, 0.054475802928209305, -0.08017203211784363, 0.057977281510829926, 0.04461933672428131, 0.018637828528881073, 0.12317483127117157, -0.0490562841296196, 0.04765522480010986, 0.01601768285036087, -0.12271547317504883, -0.010547898709774017, 0.0031189769506454468, 0.08631813526153564, 0.023790821433067322, 0.0759090781211853, 0.08258584141731262, 0.13899332284927368, 0.08446761965751648, 0.04210537672042847, -0.1442878246307373, -0.13871070742607117, -0.05859185382723808, 0.057648662477731705, -0.06301115453243256, 0.0784003809094429, 0.05588654428720474, 0.04494862258434296, 0.03056100755929947, -0.07640093564987183, 0.1294354796409607, -0.001299634575843811, -0.15954062342643738, 0.16582685708999634, 0.26598435640335083, 0.1240721270442009, 0.12221352756023407, 0.09837015718221664, 0.0026573315262794495, 0.08204157650470734, 0.1441117823123932, 0.043068140745162964, 0.06481829285621643, 0.062349528074264526, 0.025928348302841187, -0.013574905693531036, 0.12814272940158844, 0.020283734425902367, 0.18393385410308838, 0.09252599626779556, 0.0782853364944458, 0.1362457573413849, 0.032891519367694855, 0.01988588273525238, -0.0729445219039917, 0.12023164331912994, 0.1161559522151947, 0.10403048992156982, 0.24412785470485687, 0.06251169741153717, 0.2508488893508911, -0.12465730309486389, -0.027266226708889008, 0.10354208946228027, 0.08932332694530487, -0.19509351253509521, 0.005515150725841522, 0.030713863670825958, 0.011394038796424866, 0.055974818766117096, 0.17164577543735504, -0.05276256799697876, 0.03852454572916031, -0.024260636419057846, -0.06922221183776855, 0.2196916937828064, 0.11031502485275269, -0.009158536791801453, 0.1155560240149498, 0.12975984811782837, 0.1982560008764267, 0.022580668330192566, 0.08033277839422226, 0.18191877007484436, 0.09100659191608429, 0.12142451107501984, 0.045545123517513275, 0.04842008650302887, -0.03195524960756302, 0.01197812333703041, 0.07836396247148514, 0.11908499896526337, 0.06291233748197556, 0.06319412589073181, -0.037157416343688965, 0.07711316645145416, 0.06058157980442047, 0.06643888354301453, -0.027002453804016113, 0.014811422675848007, 0.015139594674110413, 0.09966385364532471, -0.0026023760437965393, 0.1262880563735962, 0.02931918203830719, -0.06544601917266846, 0.07000689208507538, -0.006262913346290588, 0.12427133321762085, 0.02009611949324608, 0.14119747281074524, -0.10362641513347626, 0.07088087499141693, 0.31712329387664795, 0.0811084657907486, 0.1866898536682129, 0.062120772898197174, 0.13631819188594818]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('4817aaba-9e4b-4af4-97ff-b299e4d095d8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
</div>
<p>^TODO: that is the first 3 of 128 dimensions. So it’ll look more “overlappy” than it really is.</p>
</section>
<section id="and-now-do-the-zero-shot" class="level3">
<h3 class="anchored" data-anchor-id="and-now-do-the-zero-shot">And Now: Do the Zero-Shot!</h3>
<p>Give it the spectacled bears, which this model has never seen before!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grizzly'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'teddy'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'spectacled'</span>]</span>
<span id="cb35-2">scrape_for_me(dl_path, [labels[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], search_suffix, erase_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, max_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb35-3"></span>
<span id="cb35-4">subdirs, path, files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels, Path(dl_path), []</span>
<span id="cb35-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> s <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> subdirs: files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> get_image_files(path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>s)</span>
<span id="cb35-6"></span>
<span id="cb35-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(files)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> files ready to load.'</span>)</span>
<span id="cb35-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"files[0] = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>files[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, files[-1] = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>files[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb35-9"></span>
<span id="cb35-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"label_func yields </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>([label_func(fp) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> fp <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sanity check: do we get all the labels we expect?</span></span>
<span id="cb35-11"></span>
<span id="cb35-12">lbl2files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {l: [f <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> files <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> label_func(f) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> l] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> labels}</span>
<span id="cb35-13"></span>
<span id="cb35-14">plot_clusters(labels)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spectacled bear: Got 262 image URLs. Downloading...
   urls =  ['https://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/embed/public/2017/06/28/andean-bear-14218511920.jpg', 'http://4.bp.blogspot.com/-6xZLUXHh8Uc/UUxmEy9QZBI/AAAAAAAAXcY/TMXg3WwS3GA/s1600/Spectacled+Bear+2.jpg', 'https://www.coolearth.org/wp-content/uploads/2016/06/Spectacled-Bear-2.jpg', 'https://s.hdnux.com/photos/01/07/31/01/18714719/5/920x920.jpg', 'https://www.bioexpedition.com/wp-content/uploads/2014/10/Spectacled_Bear_Dave-Pape.jpg', 'http://www.bearsoftheworld.net/images/bears/spectacled_bear_02.jpg', 'https://live.staticflickr.com/7431/9349596216_623a25b335_b.jpg', 'https://wallpapercave.com/wp/wp2676931.jpg', 'http://3.bp.blogspot.com/-Sg8TmR5qh88/UUxmNY4d0HI/AAAAAAAAXcw/dpL2qFHZvp0/s1600/Spectacled+Bear+5.jpg', 'https://wanderlord.com/wp-content/uploads/2017/03/Spectacled-Bear.jpg', 'https://i.natgeofe.com/n/804d9cdb-f8da-449a-93b0-aac7a448b7c0/spectacled-bear_thumb.JPG?w=1200', 'https://img00.deviantart.net/46a0/i/2011/237/1/8/spectacled_bear_by_skarkdahn-d47sr16.jpg', 'https://www.animalphotos.me/mamm1/bear-spec_files/spectacle2.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-5.jpg', 'https://www.activewild.com/wp-content/uploads/2018/03/spectacled-bears-1024x683.jpg', 'https://a-z-animals.com/media/animals/images/original/spectacled_bear4.jpg', 'http://www.rainforest-alliance.org/sites/default/files/2016-09/spectacled-bear-header.jpg', 'https://lh6.googleusercontent.com/-Sptgd7fYIqY/TYk4YVRbndI/AAAAAAAAB7E/MYqqcMu-isw/s1600/Spectacled_Bear_Tennoji_2.jpg', 'https://pre00.deviantart.net/e486/th/pre/i/2012/023/6/5/spectacled_bear_by_shimmichan-d4nd6wh.jpg', 'https://www.vanwageningen.net/i/upload/2014/10/29/20141029132015-bc5e40e5-me.jpg', 'https://live.staticflickr.com/6124/6014296334_89fcc4133a_b.jpg', 'https://farm4.staticflickr.com/3606/3292437597_527cab83ef_z.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-1002804-spectacled-bear-face.jpg', 'https://focusingonwildlife.com/news/wp-content/uploads/003_MTF_0221_spectacled.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear.jpg', 'https://res.cloudinary.com/dk-find-out/image/upload/q_70,c_pad,w_1200,h_630,f_auto/MA_00155387_i4leyu.jpg', 'https://colombiareports.com/wp-content/uploads/2017/07/spectacled_bear.jpg', 'https://i.ytimg.com/vi/wWgdrMOH8d4/maxresdefault.jpg', 'http://1.bp.blogspot.com/-qAm-_Q_k5I0/TfA4AvZt_1I/AAAAAAAABNM/Ov-m-olxu_I/s640/Spectacled-Bear.jpg', 'https://1.bp.blogspot.com/-hq_blqxeAVk/XsFZuPiS06I/AAAAAAAADps/lVr1KiOLbLEfjVO34nufzWmMdo8DJXsOQCPcBGAYYCw/w1200-h630-p-k-no-nu/Spectacled_Bear.jpg', 'http://tenrandomfacts.com/wp-content/uploads/2016/07/Spectacled-Bear.jpg', 'https://live.staticflickr.com/8393/8696456854_49f079714b_b.jpg', 'https://happygringo.com/wp-content/uploads/2020/02/portada-1.jpg', 'https://static1.squarespace.com/static/56a1a14b05caa7ee9f26f47d/t/57390f5520c6471cf068c6cc/1463357302812/', 'https://www.zoochat.com/community/media/spectacled-bears.112852/full?d=1282939786', 'http://3.bp.blogspot.com/-EGI8NqbPcvo/UUxmUJ6t1qI/AAAAAAAAXdA/fDUqD60Tv00/w1200-h630-p-k-no-nu/Spectacled+Bear.jpg', 'https://www.zoochat.com/community/media/spectacled-bear.109154/full?d=1281223819', 'https://nationalzoo.si.edu/sites/default/files/styles/1400x700_scale_and_crop/public/animals/andean-bear-007.jpg?itok=MJoAKHeV', 'https://colombiareports.com/wp-content/uploads/2017/07/andean-bear-2-2017-01-31.jpg', 'https://img.izismile.com/img/img3/20100513/640/cute_spectacled_bear_640_11.jpg', 'https://mma.prnewswire.com/media/1030258/The_Wild_Animal_Sanctuary_Rescued_Spectacled_Bear.jpg?p=facebook', 'https://www.zoochat.com/community/media/spectacled-bear.108090/full?d=1280694438', 'https://natureandculture.org/wp-content/uploads/2019/03/Cloud-Forest-Andean-Bear-768x432.jpg', 'http://featuredcreature.com/wp-content/uploads/2012/10/6a010535647bf3970b0134830b6483970c-800wi2.jpg', 'https://lh6.googleusercontent.com/-Sptgd7fYIqY/TYk4YVRbndI/AAAAAAAAB7E/MYqqcMu-isw/w1200-h630-p-k-no-nu/Spectacled_Bear_Tennoji_2.jpg', 'https://live.staticflickr.com/2900/14021204319_c4d111529b_b.jpg', 'http://theamazonianassignment.weebly.com/uploads/1/2/1/3/12136910/944137409_orig.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-ecuadorian-andes-mountains-328x562.jpg?c14113', 'http://norwichsciencefestival.co.uk/wp-content/uploads/sites/4/SavingSpectacledBear1200x500_1200x500_acf_cropped.jpg', 'https://www.parkgrandhydepark.co.uk/blog/wp-content/uploads/2017/05/shutterstock_492598162.jpg', 'https://www.apex-expeditions.com/wp-content/uploads/2015/04/04-Spectacled-Bear-Papallacta-%C2%A9-Jonathan-Rossouw.jpg', 'https://66.media.tumblr.com/9decce76250961499fe7054e55a907b2/tumblr_omltex2dq01qg5f3ho1_1280.jpg', 'http://i1.treknature.com/photos/2959/bear_0111111.jpg', 'https://nationalzoo.si.edu/sites/default/files/animals/andean-bear-001.jpg', 'https://live.staticflickr.com/4103/4831613245_311f43d099_b.jpg', 'https://imgs.mongabay.com/wp-content/uploads/sites/20/2018/06/15124317/MTF_0409_golden_spectacled_bear_%C2%A9michael_tweddle.jpg', 'https://img.izismile.com/img/img3/20100513/640/cute_spectacled_bear_640_13.jpg', 'http://farm4.staticflickr.com/3419/3774261161_577e09be2c_z.jpg?zz=1', 'http://2.bp.blogspot.com/-vdZv8wGWMdo/UUxmNCvsvhI/AAAAAAAAXco/H5Pzgk5dtOk/s1600/Spectacled+Bear+6.jpg', 'https://www.zoochat.com/community/media/spectacled-bear.342492/full?d=1479072515', 'https://www.si.edu/sites/default/files/newsdesk/photos/20100422-040mm.jpg', 'http://1.bp.blogspot.com/-G-M1STXREJI/UUxmFpUBSoI/AAAAAAAAXcg/qvb2WX5SW0s/s1600/Spectacled+Bear+3.jpg', 'https://www.wisebirding.co.uk/wp-content/uploads/Spectacled-Bear2.jpg', 'https://www.sustainability-times.com/wp-content/uploads/thumbs/AndeanBear_ZN-38o7iv74jqj9grl16xtssg.jpg', 'https://media.sciencephoto.com/image/c0175188/800wm/C0175188-Spectacled_Bear.jpg', 'https://wallpapercave.com/wp/wp2676880.jpg', 'http://www.stlzoo.org/files/1014/0017/1158/ANDEANBEAR9410WINKELMAN2.jpg', 'https://2.bp.blogspot.com/-KBaTMMdVHoY/T_A-HQlM8mI/AAAAAAAAMHE/cBonrzV6sfY/s1600/Spectacled+Bear2.jpg', 'https://www.theanimalfiles.com/images/spectacled_bear_1.jpg', 'https://www.mindenpictures.com/cache/pcache2/00542362.jpg', 'https://www.tourradar.com/days-to-come/wp-content/uploads/2016/01/Spectacled-bear.jpg', 'https://www.zoochat.com/community/media/spectacled-bear.250657/full?d=1393011952', 'https://images.fineartamerica.com/images-medium-large-5/2-spectacled-bear-in-andean-foothills-peru-tui-de-roy.jpg', 'https://images.robertharding.com/preview/RM/RH/HORIZONTAL/1127-16827.jpg', 'https://newyork.cbslocal.com/wp-content/uploads/sites/14578484/2017/05/julie-larsen-maher_1638_andean-bear-and-cub_qz_05-01-17.jpg?w=1024&amp;h=0&amp;crop=1', 'http://2.bp.blogspot.com/-1jh4WfVEyx4/T_A-OoNHGFI/AAAAAAAAMHM/Wm41l9WFfgs/s1600/Spectacled+Bear3.jpg', 'http://blog.nationalgeographic.org/wp-content/uploads/2009/02/Spectacled-Bear-picture-2.jpg', 'http://2.bp.blogspot.com/-und_0cRk_O8/URGtY1vnHGI/AAAAAAAAARQ/9aAIlFO437s/s1600/spectacled-bear3.jpg', 'http://www.rainforest-alliance.org/sites/default/files/styles/750w_585h/public/2016-09/spectacled-bear-header.jpg?itok=0V7_KGpe', 'https://wtop.com/wp-content/uploads/2015/03/16619693699_5bd5ac78d4_b.jpg', 'https://i.pinimg.com/originals/90/88/80/908880871027303cfe43c19ea4655e75.jpg', 'https://www.sustainability-times.com/wp-content/uploads/2019/06/AndeanBear_ZN.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Habitat.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-sitting-820x377.jpg?d8bc0c', 'http://seethewild.org/wp-content/uploads/2016/05/features.jpeg', 'https://i.pinimg.com/originals/24/eb/4e/24eb4e758b8bf55ef1c8a0d10e3d6b4a.jpg', 'https://www.discoveranimals.co.uk/wp-content/uploads/2014/09/spectacled_bear.jpg', 'https://www.shropshirestar.com/resizer/GqPX0-puTDFAn5Ff_V9fBEpM2Jk=/1000x0/filters:quality(100)/arc-anglerfish-arc2-prod-shropshirestar-mna.s3.amazonaws.com/public/4PL5ZCNSKVBPVK6UPFUAPHLMUI.jpg', 'http://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Spectacled_Bear.jpg/436px-Spectacled_Bear.jpg', 'https://d.ibtimes.co.uk/en/full/1613674/spectacled-bear.jpg?w=400', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/1/spectacled-bear-portrait-rose-santuci-sofranko.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-cubs.jpg', 'http://1.bp.blogspot.com/-Srm8EQe_xjU/TwK6I75A_jI/AAAAAAAAEt8/jQqGqztNuls/s1600/spectacled-bear-spectacled-bear.jpg', 'https://st2.depositphotos.com/4380587/11651/i/950/depositphotos_116510914-stock-photo-picture-of-a-spectacled-bear.jpg', 'http://kids.sandiegozoo.org/sites/default/files/2017-07/andean-bear-tree.jpg', 'https://southafricatoday.net/wp-content/uploads/2018/07/1532665810_1-1024x1000.jpg', 'https://wallpapercave.com/wp/wp2676970.jpg', 'https://upload.wikimedia.org/wikipedia/en/c/ce/Spectacled-bear.jpg', 'https://i.pinimg.com/originals/0b/24/7b/0b247b1295ab238a6a9873bfc9465d45.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/6093558068_e2c0675823_o.jpg', 'http://4.bp.blogspot.com/-zHQPWNws7VQ/TwK7vuoleYI/AAAAAAAAEuI/iZJGb0R9CEQ/s1600/spectacled_bear-spectacled_bear.jpg', 'http://www.ecns.cn/hd/2020/05/18/e41ef93a186c40a38726189b8901f6f3.jpg', 'https://lh3.googleusercontent.com/-TijTJ1kPu7U/TYk4Z-b-flI/AAAAAAAAB7M/X8njDXrfBAk/s1600/spectacled-beard.jpg', 'https://vignette.wikia.nocookie.net/vsbattles/images/0/0c/Spectacled_bear_vector_by_phoenixtdm_dcek9fs-fullview.png/revision/latest?cb=20190617023302', 'https://4.bp.blogspot.com/-xKDgjZh9q_Y/Ux2oRtCuyXI/AAAAAAAAMsM/PEgp-j44bS8/s1600/Spectacled-Bear.jpg', 'https://www.naturalhistoryonthenet.com/wp-content/uploads/2017/01/Spectacled-Bear.jpg', 'https://www.saczoo.org/wp-content/uploads/2017/01/Spectacled-Bears.jpg', 'https://images6.alphacoders.com/406/406817.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Baby-Spectacled-Bear.jpg', 'http://www.mammalwatching.com/wp-content/uploads/2018/01/EC-square-fox.jpg', 'https://www.natureplprints.com/p/729/lucas-bustamante/spectacled-andean-bear-tremarctos-ornatus-maquipucuna-15316013_73045.jpg', 'http://4.bp.blogspot.com/-VxZ-1v7UTjY/UEAGEWmRNTI/AAAAAAAAk5w/iLr_Y0Pnrtg/s1600/120813+Spectacled+Bear+small.jpg', 'https://www.bearsinmind.org/Uploaded_files/Content/brilbeer.a3cb36.JPG', 'http://newyorktrendnyc.com/wp-content/uploads/2013/11/andean-bear.jpg', 'https://i.pinimg.com/originals/5b/88/ab/5b88ab3ff6b9d74aea2e1d94e521bc72.jpg', 'http://www.zooborns.com/.a/6a010535647bf3970b0192aac4e2da970d-500wi', 'https://home.bt.com/images/spectacled-bears-and-snow-leopards-among-creatures-getting-funding-boost-136427641293802601-180606124211.jpg', 'http://2qn4774cz98e17p2h549htbt.wpengine.netdna-cdn.com/wp-content/uploads/2013/11/Male-Andean-Bear-face.jpg', 'https://nationalzoo.si.edu/sites/default/files/animals/andeanbear-006.jpg', 'https://live.staticflickr.com/250/515823267_281f36649e_b.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/5409184198_ccc4b2c5a4_o.jpg', 'https://www.worldatlas.com/r/w728/upload/73/02/b4/shutterstock-118635484-min.jpg', 'https://4.bp.blogspot.com/-8Na0W3PKG-U/UpRE_rP_gXI/AAAAAAAABZI/rU-WV9XxIIE/s1600/Spectacled-Bear-gaert.JPG', 'https://www.pitara.com/wordpress/wp-content/uploads/2001/02/spectacled-bear.jpg', 'http://3.bp.blogspot.com/-EGI8NqbPcvo/UUxmUJ6t1qI/AAAAAAAAXdA/fDUqD60Tv00/s1600/Spectacled+Bear.jpg', 'https://www.si.edu/sites/default/files/newsdesk/photos/bernardo-021mm.jpg', 'https://lh6.googleusercontent.com/-cc05A4QkDxc/TYk4S3w1qFI/AAAAAAAAB7A/3vb0t85A7GU/s1600/spectacled_bear_03.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-rocks-820x545.jpg?c14113', 'https://philadelphiazoo.160over90.io/wp-content/uploads/2019/10/Andean.SpectacledBear_Joaquin_0665.jpg', 'https://i.ytimg.com/vi/VXFIYIQgEkg/maxresdefault.jpg', 'https://a4.pbase.com/o6/34/564334/1/70568852.6wuZLzi7.20061119spectacledbear03ccomp.jpg', 'http://www.animalphotos.me/mamm1/bear-spec_files/spectacle1.jpg', 'https://ca-times.brightspotcdn.com/dims4/default/0a24096/2147483647/strip/true/crop/2000x3000+0+0/resize/840x1260!/quality/90/?url=https:%2F%2Fcalifornia-times-brightspot.s3.amazonaws.com%2Faa%2F74%2F245459fb41edb020b50a502e2a3a%2Ft16-0554-017-lg.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-71192249-spectacled-bear.jpg', 'https://farm3.staticflickr.com/2913/14137750328_d101997a4c_z.jpg', 'http://www.realworldholidays.co.uk/blog/wp-content/uploads/2015/12/spectacled-bear1.jpg', 'http://www.facts-about.info/wp-content/uploads/2014/12/Andean-Bear-at-Reid-Park-Zoo.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-2.jpg', 'https://1.bp.blogspot.com/-Tou2SRVCRqw/UpRFIXCbzQI/AAAAAAAABZ8/CTtSSU6GhZI/s1600/Spectacled-Bear.jpg', 'https://img.izismile.com/img/img3/20100513/640/cute_spectacled_bear_640_01.jpg', 'http://www.facts-about.info/wp-content/uploads/2014/12/Andean-Bear1.jpg', 'http://upload.wikimedia.org/wikipedia/commons/6/62/Spectacled_Bear_059.jpg', 'https://media.nbcwashington.com/2019/09/4621594915_9022bfd814_b.jpg?fit=1024%2C702', 'https://philadelphiazoo.org/wp-content/uploads/2019/10/Andean.SpectacledBear_Rosie_3395.jpg', 'https://mma.prnewswire.com/media/1030258/The_Wild_Animal_Sanctuary_Rescued_Spectacled_Bear.jpg?p=publish&amp;w=950', 'https://c1.staticflickr.com/5/4149/4956021357_d3aa0407c1_z.jpg', 'http://images.fineartamerica.com/images-medium-large/spectacled-bear-tremarctos-ornatus-cub-pete-oxford.jpg', 'https://i.pinimg.com/736x/b9/ab/6f/b9ab6f27f50527d8ddd610f0f02e88cb--spectacled-bear-spirit-animal.jpg', 'http://2.bp.blogspot.com/-4bGjmY9K4pk/T_A-Yq5aNGI/AAAAAAAAMHc/pv9gEJ8O6Uo/s1600/Spectacled+Bear5.jpg', 'https://vg5b2ejdwb-flywheel.netdna-ssl.com/wp-content/uploads/2015/06/7oboa0_tu_u.jpg', 'https://resize.hswstatic.com/w_907/gif/types-of-spectacled-bear0.jpg', 'http://1.bp.blogspot.com/-xGs4-W-3iSY/TjaZG6_XnOI/AAAAAAAABUE/AkEJ97L1HQc/s1600/156521.jpg', 'https://www.robertharding.com/watermark.php?type=preview&amp;im=RM/RH/HORIZONTAL/1127-12838', 'https://www.zooportraits.com/wp-content/uploads/2018/05/Spectacled-Bear-Tremarctos-Ornatus.jpg', 'https://i.pinimg.com/736x/fa/40/33/fa403340878f175322c07b860b9d6426--spectacled-bear-bolivia.jpg', 'http://img.izismile.com/img/img3/20100513/640/cute_spectacled_bear_640_03.jpg', 'https://ourplnt.com/wp-content/uploads/2016/03/Spectacled-bear.jpg', 'https://i.pinimg.com/originals/ec/0c/96/ec0c969cd38a1a701a2c1e2a87a96561.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/3956278926_328d1c6a54_o.jpg', 'https://www.rainbowtours.co.uk/upload-files/product-excursions-gallery/EXC-PER-024_1_spectacled-bear.jpg', 'https://2.bp.blogspot.com/-6-AcWMkgynE/VEMIW1x0vtI/AAAAAAAAAEU/xUsNNkFj6rg/s1600/oso.jpg', 'http://cincinnatizoo.org/system/assets/uploads/2014/02/spectaculed-bear.jpg', 'http://3.bp.blogspot.com/-brSuqjGOIG0/URGtpFtyo_I/AAAAAAAAARg/vLE13RVoCsk/s1600/spectacled-bear.jpg', 'https://c2.staticflickr.com/2/1501/24144684635_73b9e79d88_b.jpg', 'https://critter.science/wp-content/uploads/2019/05/sb1.jpg', 'https://reidparkzoo.org/wp-content/uploads/2016/05/andeanbear9768z.jpg', 'https://srcnaut.com/cdn-cgi/image/f=auto,fit=crop,g=0.5x0.5,w=2000,h=1125,q=90,d=1/upload/32/02/df/shutterstock-1188627676.jpg', 'http://i1.chesterchronicle.co.uk/incoming/article8089938.ece/ALTERNATES/s615b/JS50546090.jpg', 'https://conservationnation.org/wp-content/uploads/2020/03/andean-bear-hero.jpg', 'http://seethewild.org/wp-content/uploads/2016/05/dreamstime_15373008-1.jpg', 'https://i1.wp.com/www.bearz.org/en/wp-content/uploads/2015/06/604014_10200989864724976_224585035_n1.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-30167654-spectacled-bear-with-bamboo.jpg', 'https://www.textbooktravel.com/wp-content/uploads/2020/08/Spectacled-Bear-Cub.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Spectacled_Bear_-_Houston_Zoo.jpg/1200px-Spectacled_Bear_-_Houston_Zoo.jpg', 'https://1.bp.blogspot.com/-cloWtyc4dnw/T-5pMXHLd7I/AAAAAAAACog/ebO0-a0x89M/s1600/SpectacledBear.jpg', 'https://www.zoochat.com/community/media/spectacled-bear-at-chester-15-07-12.192796/full?d=1342391273', 'https://res.cloudinary.com/dk-find-out/image/upload/q_80,w_1440,f_auto/MA_00155387_i4leyu.jpg', 'http://2.bp.blogspot.com/-PQGmVUDZAhs/TwK5urRX1LI/AAAAAAAAEtw/s569QHCcx8Y/s1600/spectacled+bear.jpg', 'https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2865567/db2b44df10ba2a567a8e5cc34ddfeed0_original.JPG', 'http://etc.usf.edu/clippix/pix/spectacled-bear-with-piece-of-food-in-its-mouth_medium.jpg', 'https://www.activewild.com/wp-content/uploads/2018/03/spectacled-bear-standing-768x1024.jpg', 'https://www.biolib.cz/IMG/GAL/BIG/28527.jpg', 'http://2.bp.blogspot.com/-1mdQ66udYmw/T_A-UjaJk5I/AAAAAAAAMHU/uJw0kPcz1vc/s1600/Spectacled+Bear4.jpg', 'https://www.apex-expeditions.com/wp-content/uploads/2015/04/02-Spectacled-Bear-Chaparri-JR-5.jpg', 'https://www.factzoo.com/sites/all/img/mammals/bears/spectacled-bear-face.jpg', 'http://images.fineartamerica.com/images-medium-large/andean-or-spectacled-bear-tremarctos-philippe-henry.jpg', 'https://i.pinimg.com/736x/ad/b9/c5/adb9c533cfd5c8f292ce21cabae6f2f9--spectacled-bear-baby-animals.jpg', 'https://4.bp.blogspot.com/-6TV6R9HEc-o/T_A98vwyTEI/AAAAAAAAMG8/ffIXmwgDoXw/s1600/Spectacled+Bear.jpg', 'http://cuencahighlife.com/wp-content/uploads/2015/03/chl-bear2.jpg', 'https://cms.prod.nypr.digital/images/27490/fill-1200x650/', 'https://www.worldatlas.com/upload/43/04/5c/shutterstock-92656222-min.jpg', 'https://c1.staticflickr.com/4/3444/3293260140_4257d5b231.jpg', 'https://www.animalfactsencyclopedia.com/images/bear-spectacledcloseinset.jpg', 'https://i.pinimg.com/originals/9b/34/7e/9b347e3e5fb5b58d954ce84aeccdcc42.jpg', 'https://wallpapercave.com/wp/wp2676943.jpg', 'https://www.si.edu/sites/default/files/newsdesk/photos/andean-bear.jpg', 'https://ecosphere.plus/wp-content/uploads/2018/02/Spectacled-bear_LAM0695-Heinz-Plenge-2-1080x540.jpg', 'https://i2-prod.chesterchronicle.co.uk/incoming/article8089934.ece/ALTERNATES/s1200/JS50546081.jpg', 'https://dancantravel.azurewebsites.net/wp-content/uploads/2017/09/DSC09006-2.jpg', 'https://pre00.deviantart.net/fc19/th/pre/i/2015/204/a/b/an_11dv___spectacled_bear_by_szallonntaidalma-d92d0pi.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-4.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-3.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-ogimage.jpg', 'https://images.freeimages.com/images/large-previews/e0f/spectacled-bear-1561333.jpg', 'https://kentattractions.co.uk/wp-content/uploads/2016/09/Spectacled-Bear.jpg', 'https://i.pinimg.com/originals/7c/48/b1/7c48b17f45853a48890e0a32f02aa875.jpg', 'http://gringosabroad.com/wp-content/uploads/2013/11/Male-Andean-Bear-face.jpg', 'https://rangerplanet.com/wp-content/uploads/2019/10/spectacled-bear.jpg', 'https://2.bp.blogspot.com/-1jh4WfVEyx4/T_A-OoNHGFI/AAAAAAAAMHM/Wm41l9WFfgs/s400/Spectacled+Bear3.jpg', 'http://1.bp.blogspot.com/-qM3UoT_SQRk/TiAwjcnmqiI/AAAAAAAAAKE/mQAIjK3XPRg/s1600/spectacled_bear_2.jpg', 'https://www.wisebirding.co.uk/wp-content/uploads/Spectacled-Bear.jpg', 'http://www.factzoo.com/sites/all/img/mammals/bears/spectacled-bear-south-american.jpg', 'https://s3-eu-west-1.amazonaws.com/images.noahsarkzoofarm.co.uk/uploads/tinymce/rasu.jpg', 'https://i.ytimg.com/vi/2TmnhBSyQoo/maxresdefault.jpg', 'https://reidparkzoo.org/wp-content/uploads/2016/05/andeanbear9646z.jpg', 'https://vistapointe.net/images/spectacled-bear-5.jpg', 'https://www.aboutanimals.com/images/spectacled-bear-tree-820x513.jpg?d8bc0c', 'https://standfirst-whitleyaward-production.imgix.net/content/uploads/1996/12/18134457/Tremarctos_ornatus_portrait.jpg?auto=compress,enhance,format&amp;crop=faces,entropy,edges&amp;fit=crop&amp;fm=pjpg&amp;w=1866&amp;h=1400', 'https://c1.staticflickr.com/7/6037/6304684676_8fe4be5717_b.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/5566818433_9c994ec063_o.jpg', 'https://www.bwallpaperhd.com/wp-content/uploads/2018/12/SpectacledBear.jpg', 'https://cms.prod.nypr.digital/images/27460/fill-661x496/', 'https://i.ytimg.com/vi/lLcCBkNDQxs/maxresdefault.jpg', 'http://justfunfacts.com/wp-content/uploads/2017/11/spectacled-bear-eating-fruit.jpg', 'http://img07.deviantart.net/9fc0/i/2010/201/7/6/spectacled_bear_by_citronvert79.jpg', 'https://critterfacts.com/wp-content/uploads/2019/02/s_158118350.jpg', 'https://images.fineartamerica.com/images-medium-large-5/andean-bear-spectacled-bear-houston-zoo-tessa-fairey.jpg', 'https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/spectacled-bear-david-stasiak.jpg', 'https://media.buzzle.com/media/images-en/photos/mammals/bears/1200-598140-spectacled-bear.jpg', 'http://magarticles.magzter.com/articles/8803/216564/58e38ecbbeeb4/Conservation-Insight-Andean-Bear.jpg', 'https://1.bp.blogspot.com/-DAyv4HJRE4E/XjRg-JFM_SI/AAAAAAAAAPU/NUHh82dMHZYSbMEQR3WEJOUXhO08GI4pACLcBGAsYHQ/s1600/baby-animal-photo-05032016-image-056.jpg', 'http://www.rainforest-alliance.org/sites/default/files/styles/large/public/2016-09/spectacled-bear.jpg?itok=BXWidYtz', 'http://www.parkgrandhydepark.co.uk/blog/wp-content/uploads/2017/05/shutterstock_550667422.jpg', 'https://nationalzoo.si.edu/sites/default/files/animals/andeanbear-005.jpg', 'https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2865571/a3195154ccdac7c9efcbed5727462346_original.JPG', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-in-the-Wild.jpg', 'http://bearlegend.com/wp-content/uploads/2012/04/6862037661_30664cf53f_o.jpg', 'https://www.bwallpaperhd.com/wp-content/uploads/2018/12/SpectacledBear-1024x576.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Eating.jpg', 'http://2.bp.blogspot.com/-3UzekS1270M/TiAwko0VrQI/AAAAAAAAAKI/rOXYR8LXLHM/s1600/spectacled_bear_3.jpg', 'http://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bears-300x225.jpg', 'https://animalia.us-east-1.linodeobjects.com/animals/photos/full/1x1/determined.jpg', 'http://cdn4.awwnews.com/images/2015/03/044_3-Spectacled-Bear-Cubs.jpg', 'http://www.peru-breathtaking-trips.com/imgs/Spectacled%20bear.jpg', 'http://lh4.ggpht.com/-2YrERpe5ZeU/UOUBP6Zr8ZI/AAAAAAAAASQ/7oSIuID4iSs/%25255BUNSET%25255D.jpg', 'https://i.pinimg.com/736x/d2/99/fa/d299fa76c3d1a5c0e017514b086ddd9c--spectacled-bear-teddy-bears.jpg', 'https://c2.staticflickr.com/4/3685/8852797884_8f3a84d84c_b_d.jpg', 'https://www.si.edu/sites/default/files/newsdesk/photos/andean_bear_cubs2.jpg', 'https://critterfacts.com/wp-content/uploads/2019/02/s_1083570302_.jpg', 'https://www.worldlandtrust.org/wp-content/uploads/2017/08/RS26943_Ramiro-Mendoza-scr.jpg', 'http://www.kidzone.ws/lw/bears/images/spectacled-bear.jpg', 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Oso_andino_Porcon.jpg/1200px-Oso_andino_Porcon.jpg', 'https://www.bioexpedition.com/wp-content/uploads/2012/05/Spectacled-Bear.jpg', 'https://www.earlham.ac.uk/sites/default/files/images/articles/Saving-Spectacled-Bear-Deepest-Darkest-Colombia/Saving-Spectacled-Bear-Deepest-Darkest-Colombia-Andean-770.jpg', 'https://featuredcreature.com/wp-content/uploads/2012/10/6a010535647bf3970b0134830b6313970c-800wi2.jpg', 'https://www.apex-expeditions.com/wp-content/uploads/2015/04/01-Spectacled-Bear-Chaparri-JR-2.jpg', 'http://2.bp.blogspot.com/-uKXzB18yA0M/UDBPCtHRm6I/AAAAAAAABrg/cceW2WF1lwQ/w1200-h630-p-k-no-nu/Spectacled-Bear-1.jpg', 'https://www.animalspot.net/wp-content/uploads/2015/12/Spectacled-Bear-Images.jpg', 'https://ptes.org/wp-content/uploads/2018/12/Andean-bear_credit-Tashkin-Meza-Andean-Bear-1000.jpg', 'http://www.telesurtv.net/export/sites/telesur/img/news/2015/11/27/spectacled_bear_2.jpg_1167511010.jpg', 'https://www.worldlandtrust.org/wp-content/uploads/2017/07/RS4817_Spectacled-Bear-2007-Fundacion-Ecominga-Candelaria-Reserve-c-Lou-Jost-1.jpg', 'http://etc.usf.edu/clippix/pix/spectacled-bear_medium.jpg']
    Images downloaded.
After checking images for issues, 958 (total) images remain.
958 files ready to load.
files[0] = scraped_images/grizzly/00000143.jpg, files[-1] = scraped_images/spectacled/00000003.jpg
label_func yields {'teddy', 'grizzly', 'black', 'spectacled'}</code></pre>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">


<meta charset="utf-8">

    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="689de7a1-8899-4b68-9d2f-f26321303ae8" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("689de7a1-8899-4b68-9d2f-f26321303ae8")) {
                    Plotly.newPlot(
                        '689de7a1-8899-4b68-9d2f-f26321303ae8',
                        [{"hovertext": "grizzly", "marker": {"color": "red", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "grizzly", "type": "scatter3d", "x": [0.1427900642156601, -0.008086610585451126, -0.04809732735157013, 0.12226875126361847, -0.07549791038036346, -0.21922582387924194, -0.008332505822181702, -0.02184370905160904, 0.14222785830497742, 0.13639792799949646, 0.014027617871761322, 0.022118479013442993, -0.11797241121530533, -0.09148385375738144, 0.1870245337486267, -0.5595685839653015, 0.05623913183808327, 0.030649248510599136, -0.1057056114077568, 0.0716935470700264, -0.060697365552186966, -0.14838190376758575, 0.08946672827005386, -0.2369043529033661, 0.05138576030731201, -0.11880197376012802, -0.03601909428834915, 0.09612242132425308, -0.00657949224114418, -0.039161767810583115, -0.08706442266702652, -0.13568538427352905, -0.012850619852542877, -0.06143249571323395, -0.16862064599990845, -0.04624880105257034, 0.093388631939888, -0.057557620108127594, 0.03993535041809082, 0.03596166521310806, 0.08057865500450134, 0.07838698476552963, 0.00985343661159277, -0.034711048007011414, -0.18861578404903412, -5.613267421722412e-05, 0.041127365082502365, 0.11228404939174652, 0.06751614809036255, -0.026992017403244972, 0.055520981550216675, 0.22277897596359253, -0.168520987033844, 0.1043577790260315, -0.28193938732147217, 0.23826682567596436, -0.15275561809539795, -0.1420431286096573, -0.2678516209125519, 0.03576759621500969, -0.02152252197265625, 0.007800940424203873, 0.017098318785429, 0.057998426258563995, -0.003067620098590851, 0.0034868940711021423, 0.01398632675409317, 0.09831200540065765, -0.001127399504184723, 0.09573052078485489, 0.08402368426322937, 0.036673810333013535, -0.07469980418682098, 0.22534531354904175, 0.06573735922574997, 0.07181957364082336, -0.15243297815322876, -0.0803726315498352, -0.1183348298072815, -0.1357971727848053, 0.016597166657447815, 0.11185453087091446, 0.07377555966377258, -0.0014940891414880753, -0.33643150329589844, 0.15644672513008118, 0.27862250804901123, 0.20883478224277496, 0.02243272215127945, -0.034015193581581116, 0.051374875009059906, -0.008295569568872452, -0.08960835635662079, 0.03813808783888817, 0.01201985776424408, 0.012274548411369324, 0.0922778844833374, 0.12289564311504364, 0.1053525060415268, -0.09529172629117966, 0.06549838185310364, 0.06815915554761887, 0.10513651371002197, 0.09973422437906265, -0.3062604069709778, 0.1574958860874176, 0.08568673580884933, 0.18573883175849915, 0.01686696708202362, 0.004881709814071655, 0.14250774681568146, -0.12979483604431152, 0.00489005446434021, 0.11997580528259277, 0.1685401201248169, -0.061505720019340515, -0.007397793233394623, 0.03610016405582428, -0.05420726537704468, -0.08667173981666565, -0.07683831453323364, -0.026918254792690277, 0.1059761643409729, 0.20105761289596558, 0.1414174735546112, -0.1291961669921875, -0.45107129216194153, 0.2791084349155426, -0.2280760109424591, 0.013212926685810089, -0.09695209562778473, -0.06750133633613586, 0.07262548804283142, -0.1032860204577446, -0.005809154361486435, 0.13431048393249512, -0.07480621337890625, 0.10018882155418396, -0.13754454255104065, 0.01092991977930069, 0.021759219467639923, 0.08384668827056885, -0.3054458796977997, -0.15833507478237152, 0.07213915139436722, 0.08917178213596344, -0.0006007105112075806, -0.12206323444843292, 0.08328182995319366, -0.10515718162059784, -0.04380457103252411, 0.14290782809257507, -0.14951284229755402, 0.05026068538427353, -0.0003549829125404358, 0.04449620097875595, -0.002394631505012512, 0.05165598914027214, 0.013468608260154724, 0.10981939733028412, -0.15205928683280945, 0.37412264943122864, 0.03566563501954079, -0.04805561155080795, 0.13036304712295532, 0.1060626357793808, -0.05804665386676788, -0.039848968386650085, -0.10456891357898712, 0.03155114874243736, -0.08390314131975174, 0.07797916233539581, 0.102145716547966, -0.05706360936164856, -0.0032813288271427155, -0.008315060287714005, -0.04069563001394272, 0.08080452680587769, 0.0016920790076255798, -0.10215705633163452, 0.03105999156832695, 0.02055564522743225, -0.1550752818584442, -0.1426658183336258, 0.007213988341391087, -0.045855484902858734, -0.13916179537773132, -0.14219467341899872, -0.012359626591205597, 0.014743469655513763, -0.07943621277809143, -0.06878151744604111, -0.04010690748691559, 0.15175460278987885, 0.16683410108089447, -0.06977172195911407, 0.1414276510477066, 0.2847931385040283, 0.05140651762485504, -0.013407677412033081, -0.10878976434469223, -0.07954595237970352, 0.03800201416015625, 0.025890212506055832, -0.09734989702701569, 0.12656861543655396, -0.010379716753959656, -0.19434013962745667, -0.08444765210151672, 0.10804743319749832, -0.11280988156795502, 0.13919766247272491, -0.15572409331798553, -0.20614281296730042, -0.1789826601743698, -0.24618880450725555, 0.08227914571762085, 0.14462298154830933, -0.020571216940879822, -0.22619250416755676, 0.14025306701660156, -0.031661972403526306, -0.04526905342936516, -0.0872156098484993, -0.2863786816596985, -0.17322711646556854, -0.13126757740974426, -0.11529907584190369, -0.14791297912597656, -0.09707922488451004, 0.03886333107948303, -0.13043969869613647, 0.18758642673492432, -0.10152494162321091, -0.07272449135780334, -0.022570274770259857, -0.23020051419734955, -0.274739533662796, 0.08550148457288742, -0.13169918954372406, -0.19088944792747498], "y": [0.05722782015800476, 0.13927599787712097, 0.18799078464508057, 0.1316613107919693, 0.008640521205961704, 0.5045021772384644, 0.3782379925251007, 0.3956988453865051, 0.14994484186172485, 0.07075086981058121, 0.09338309615850449, 0.491913765668869, 0.3830353319644928, -0.0963313952088356, 0.1633121371269226, 0.5440019369125366, -0.07646724581718445, -0.18755613267421722, 0.30704575777053833, 0.11510437726974487, 0.3130701780319214, -0.1176123321056366, 0.3335888981819153, 0.35816043615341187, 0.10413868725299835, 0.03039148822426796, -0.0020784963853657246, 0.4396771192550659, 0.04926253855228424, 0.11140835285186768, 0.4996057450771332, 0.29678794741630554, 0.27388086915016174, -0.07044797390699387, 0.44805240631103516, 0.02568521536886692, 0.3920830190181732, -0.19286862015724182, 0.31266504526138306, 0.08973380923271179, 0.2980270981788635, 0.23133689165115356, 0.18827636539936066, -0.008637458086013794, 0.2153465747833252, 0.24947331845760345, 0.3211005628108978, 0.38170769810676575, 0.15137803554534912, 0.13838902115821838, 0.15339940786361694, 0.25078174471855164, -0.033522363752126694, 0.227567657828331, 0.24197515845298767, 0.02176372893154621, 0.008829357102513313, 0.2095300704240799, 0.23217356204986572, 0.30172795057296753, 0.0331515334546566, -0.4588192403316498, 0.29664358496665955, -0.17260852456092834, 0.12106127291917801, -0.11910193413496017, 0.1601565033197403, 0.3603897988796234, 0.28941458463668823, 0.23164977133274078, 0.18486477434635162, 0.15349292755126953, 0.437697172164917, 0.2998359799385071, 0.15104304254055023, 0.15866482257843018, 0.0670609325170517, 0.23814235627651215, -0.10587938129901886, 0.14853835105895996, 0.1153770238161087, 0.22007699310779572, 0.408374160528183, 0.4088640809059143, 0.03574465215206146, 0.23876598477363586, 0.20122388005256653, 0.30799293518066406, 0.0883401557803154, -0.016978997737169266, 0.14825522899627686, 0.328730970621109, 0.10286550223827362, 0.14193302392959595, 0.18230411410331726, 0.17334231734275818, 0.1944374293088913, 0.11308100074529648, -0.0669303610920906, 0.4329603612422943, 0.18045157194137573, 0.12594515085220337, -0.20737335085868835, 0.14591765403747559, 0.22569787502288818, 0.33100152015686035, 0.291464239358902, 0.04410481080412865, -0.2797071039676666, 0.36254793405532837, -0.008781660348176956, 0.2532775402069092, 0.4061998724937439, 0.3047056198120117, 0.5431411266326904, 0.2839224338531494, 0.05775617063045502, -0.005483545362949371, 0.4272123873233795, 0.15419307351112366, 0.5078697800636292, 0.45117223262786865, 0.2966388165950775, 0.1660088300704956, 0.5417624711990356, 0.5031917095184326, 0.7224544286727905, -0.032367728650569916, 0.30255571007728577, 0.2631358206272125, 0.11550025641918182, 0.06982456892728806, 0.2679813802242279, 0.24869272112846375, 0.1597079187631607, -0.0030101388692855835, 0.34161698818206787, -0.05721328407526016, 0.37360289692878723, 0.03736221045255661, 0.3526099622249603, 0.24438534677028656, -0.07875083386898041, 0.250119686126709, 0.22857284545898438, 0.14072738587856293, 0.011008994653820992, 0.29378122091293335, 0.37133920192718506, 0.4876117408275604, 0.22864121198654175, 0.2725241184234619, 0.13971737027168274, -0.010759145021438599, 0.11541455239057541, 0.1485089808702469, 0.09976880252361298, 0.06670180708169937, 0.17031843960285187, 0.2731316089630127, 0.36886587738990784, 0.3231513798236847, 0.0450209379196167, -0.07675030082464218, -0.04369089752435684, 0.36946505308151245, 0.19929461181163788, 0.2685491740703583, 0.23630034923553467, 0.19558370113372803, 0.21265210211277008, 0.15382933616638184, -0.38077473640441895, 0.11230139434337616, 0.04583855718374252, 0.10972101241350174, 0.20345310866832733, 0.13694468140602112, 0.3042421340942383, -0.135141983628273, 0.3368035852909088, 0.02991168387234211, 0.5527070164680481, 0.16067059338092804, 0.043281327933073044, 0.020756639540195465, -0.07635387778282166, 0.5551255345344543, 0.03906484693288803, 0.03788045048713684, 0.2712031602859497, 0.148781880736351, 0.24862730503082275, 0.1104014664888382, 0.07526995241641998, 0.24223417043685913, 0.18320035934448242, 0.0437537357211113, 0.15103842318058014, -0.1301189810037613, 0.15532274544239044, 0.0477239191532135, 0.12857244908809662, 0.36164018511772156, 0.08818795531988144, -0.1612372100353241, 0.2467685490846634, -0.3759078085422516, 0.5154597163200378, -0.19477933645248413, 0.12036043405532837, -0.012598630040884018, -0.13886989653110504, 0.4329313039779663, 0.30050355195999146, 0.6600281000137329, 0.05175606906414032, -0.07132430374622345, 0.04157370328903198, 0.2695835530757904, 0.25269800424575806, 0.045198455452919006, 0.26741427183151245, 0.46875014901161194, -0.010751426219940186, 0.38574954867362976, -0.08367593586444855, -0.028937840834259987, 0.2861449420452118, 0.23532326519489288, 0.4439052641391754, 0.4891951084136963, 0.15558229386806488, 0.1607816368341446, 0.21674807369709015, 0.2605876922607422, 0.5382767915725708, 0.36765754222869873, 0.0895615741610527, 0.2035488486289978, 0.4130416512489319], "z": [0.032774537801742554, -0.12905427813529968, 0.20856909453868866, -0.014808684587478638, -0.16000500321388245, 0.23034918308258057, 0.22026151418685913, -0.03654388338327408, -0.09792433679103851, -0.06554670631885529, -0.2518603205680847, 0.13812115788459778, 0.07376046478748322, -0.1317448914051056, -0.09888875484466553, 0.30813443660736084, 0.04797740653157234, -0.04196156561374664, 0.06042639911174774, -0.06608185917139053, -0.03506558761000633, -0.19947829842567444, -0.09152418375015259, 0.17202448844909668, -0.11640001833438873, -0.1044171154499054, -0.06688432395458221, 0.13901107013225555, 0.051037661731243134, -0.026456404477357864, 0.16465558111667633, 0.0874117836356163, -0.05423074588179588, -0.13630500435829163, 0.3131140470504761, -0.07381211221218109, -0.14614643156528473, 0.12394827604293823, -0.12735053896903992, 0.012403436005115509, 0.04143206775188446, 0.21146191656589508, -0.08622068166732788, -0.219781294465065, 0.19184841215610504, -0.20090451836585999, -0.15584330260753632, 0.13713496923446655, 0.03963121771812439, 0.19883275032043457, 0.15234476327896118, -0.06916455924510956, -0.07411251217126846, 0.02373853325843811, -0.05971241742372513, -0.09226464480161667, -0.13265198469161987, 0.35679611563682556, -0.062422480434179306, -0.06566444039344788, -0.07548017799854279, 0.03847616910934448, -0.052797283977270126, -0.03084559738636017, -0.23095262050628662, 0.05309629812836647, -0.07940123230218887, 0.10658411681652069, -0.12743186950683594, 0.24503721296787262, -0.09877355396747589, -0.16780893504619598, 0.01694929413497448, 0.05839109793305397, -0.10282424837350845, -0.11959265917539597, -0.140109121799469, 0.048962511122226715, 0.03009694442152977, -0.006186649203300476, 0.0487593337893486, -0.0720137357711792, -0.02511519379913807, -0.14428646862506866, -0.038009658455848694, -0.07720382511615753, -0.07233333587646484, -0.009598016738891602, 0.022319771349430084, -0.11323992908000946, 0.011250630021095276, -0.06606446206569672, -0.015181556344032288, -0.11759891360998154, -0.12090247869491577, -0.032869189977645874, 0.06179709732532501, -0.2141622006893158, -0.22566024959087372, 0.27119991183280945, 0.210627019405365, -0.26659101247787476, 0.014410622417926788, -0.06333161145448685, -0.1265491098165512, -0.03171328455209732, -0.2505541741847992, 0.2866499423980713, -0.028895936906337738, -0.05826522409915924, -0.1219438910484314, -0.021938174962997437, -0.07145783305168152, -0.07064429670572281, 0.09298709034919739, -0.003397218883037567, 0.058452751487493515, -0.09905949234962463, 0.0964621976017952, -0.2738937735557556, 0.22433805465698242, 0.3517459034919739, 0.017422549426555634, 0.14062733948230743, 0.029225889593362808, 0.2619473934173584, 0.4800718426704407, 0.1994171142578125, -0.03612577170133591, -0.15182757377624512, -0.04742546007037163, -0.1116618812084198, -0.0753854364156723, -0.04912276566028595, -0.23097968101501465, -0.2175910621881485, 0.11899790167808533, -0.11233071982860565, 0.13431492447853088, -0.07599897682666779, 0.055169008672237396, 0.14437106251716614, -0.19707411527633667, 0.07855147123336792, -0.00923716090619564, -0.17887623608112335, -0.035081349313259125, 0.3759292662143707, 0.10748393833637238, 0.08823802322149277, 0.05255822092294693, 0.16742953658103943, 0.011698804795742035, -0.11181479692459106, -0.21079754829406738, -0.10334032028913498, -0.1850534975528717, -0.011418966576457024, -0.08024219423532486, -0.02055305801331997, -0.09869466722011566, -0.34102296829223633, -0.23488131165504456, -0.21931183338165283, -0.07465458661317825, -0.1143261045217514, -0.029208920896053314, -0.13416625559329987, 0.21869489550590515, -0.05057577043771744, -0.06507085263729095, 0.007763586938381195, -0.12105954438447952, -0.017999317497015, -0.35475435853004456, -0.3074062168598175, -0.08150994777679443, 0.1972401887178421, 0.03696154057979584, -0.10381679236888885, 0.20102976262569427, -0.09487895667552948, 0.03829128295183182, -0.11512890458106995, -0.08433046191930771, -0.19474922120571136, 0.04785723611712456, 0.06690181791782379, -0.16210421919822693, -0.2587335407733917, -0.048482295125722885, -0.04390355199575424, -0.007456950843334198, -0.10472902655601501, -0.13989637792110443, 0.03439352661371231, -0.2891635298728943, -0.0642368420958519, -0.11987600475549698, -0.016139309853315353, 0.09813019633293152, -0.20017889142036438, -0.0328320637345314, -0.17665407061576843, 0.30690574645996094, -0.10832741856575012, 0.16728568077087402, -0.11186452955007553, 0.1374981701374054, -0.04941564053297043, -0.06158516928553581, -0.24424436688423157, -0.3280077576637268, 0.30437615513801575, -0.08936330676078796, 0.3587783873081207, -0.2243949919939041, -0.07160376012325287, 0.05844755098223686, 0.12576651573181152, -0.13183428347110748, -0.3401293158531189, 0.17671777307987213, -0.07929021120071411, -0.08287186920642853, 0.3413864076137543, 0.10351012647151947, -0.14557236433029175, -0.1438109427690506, -0.13536237180233002, 0.3016898036003113, -0.013503476977348328, -0.0856412872672081, -0.19807696342468262, -0.15415416657924652, -0.12269233167171478, 0.19538067281246185, 0.06799718737602234, 0.01862739771604538, 0.021523959934711456, -0.09981681406497955]}, {"hovertext": "black", "marker": {"color": "green", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "black", "type": "scatter3d", "x": [0.35960954427719116, 0.3360121250152588, 0.06085364893078804, 0.2781960964202881, 0.1412961632013321, 0.0800497904419899, 0.0077080316841602325, 0.13691937923431396, 0.3491545021533966, 0.06473811715841293, 0.36321431398391724, 0.11104047298431396, 0.06951553374528885, 0.02610103040933609, 0.06919564306735992, 0.014490611851215363, 0.05518291890621185, 0.3706645369529724, 0.29811179637908936, 0.09081593155860901, 0.2599934935569763, -0.09432436525821686, -0.09147238731384277, 0.009607434272766113, -0.09742020070552826, 0.0049538761377334595, -0.3212754428386688, 0.06988706439733505, 0.021024800837039948, 0.061530016362667084, 0.32214438915252686, 0.18906797468662262, 0.02326393872499466, 0.122881680727005, -0.007608428597450256, -0.06947677582502365, 0.08927193284034729, 0.20843270421028137, 0.08266203850507736, 0.33714115619659424, 0.32894569635391235, 0.011012375354766846, 0.12165236473083496, 0.003515571355819702, 0.02590090036392212, 0.35280823707580566, -0.09035874158143997, -0.11157292127609253, 0.2036065012216568, 0.02159624546766281, 0.14521196484565735, -0.03851453959941864, 0.04399299621582031, -0.28130581974983215, 0.3613930940628052, 0.05185732990503311, 0.4040604829788208, 0.1556132286787033, 0.17443016171455383, 0.19201475381851196, 0.04572924226522446, -0.123334139585495, 0.4011414349079132, 0.2370625138282776, 0.09155547618865967, 0.29007190465927124, 0.09589442610740662, 0.24244391918182373, 0.11061210930347443, 0.014897570013999939, 0.07335120439529419, 0.3210509121417999, 0.2119196504354477, 0.0435318797826767, 0.14466050267219543, 0.15854202210903168, 0.2659838795661926, 0.02877619117498398, -0.11032897979021072, 0.4035748243331909, 0.15043692290782928, -0.09332184493541718, -0.014608511701226234, 0.062050241976976395, 0.022855721414089203, 0.37507450580596924, 0.5061303973197937, 0.0802583396434784, 0.029824692755937576, 0.028151296079158783, 0.20268389582633972, 0.2072349488735199, 0.489559143781662, 0.3051183223724365, 0.20972715318202972, 0.03226349502801895, 0.3452526032924652, 0.12483328580856323, 0.16439133882522583, -0.035442739725112915, 0.16745077073574066, 0.03165581077337265, -0.18319052457809448, 0.2061861753463745, 0.2945716381072998, 0.4087428152561188, -0.13321375846862793, 0.22083629667758942, 0.3663199841976166, 0.2579679489135742, 0.1693945974111557, 0.12378917634487152, 0.1577717810869217, -0.1595863401889801, 0.10377319157123566, 0.0900026485323906, 0.0900411456823349, 0.28578922152519226, -0.03639078885316849, 0.20291545987129211, 0.024088405072689056, -0.05979970842599869, 0.20201998949050903, 0.04176813364028931, 0.10754944384098053, 0.22881245613098145, 0.2106301188468933, -0.15553425252437592, 0.22969520092010498, -0.037703804671764374, 0.40124088525772095, 0.06336081027984619, -0.12494323402643204, 0.033374540507793427, 0.16610512137413025, -0.06129078567028046, -0.0787622332572937, 0.20022034645080566, 0.23536905646324158, -0.090711310505867, 0.3887704908847809, -0.016349807381629944, 0.14949670433998108, 0.23987334966659546, 0.21583834290504456, 0.3238780200481415, 0.28474634885787964, 0.0008874712511897087, 0.16595160961151123, 0.18435509502887726, 0.1559762954711914, -0.15470626950263977, 0.15016071498394012, 0.08994971215724945, -0.033952467143535614, -0.06882825493812561, 0.07156054675579071, -0.08095405995845795, 0.03633701056241989, 0.19129028916358948, -0.20929169654846191, 0.24744078516960144, 0.14642739295959473, -0.006537407636642456, 0.22453972697257996, -0.012799635529518127, 0.34279492497444153, 0.4225412607192993, 0.48744601011276245, 0.24216046929359436, 0.1986699104309082, 0.1344834715127945, 0.03481476008892059, -0.03048340603709221, -0.055384911596775055, -0.17583268880844116, 0.10873795300722122, -0.04906204715371132, 0.035755306482315063, -0.020117081701755524, 0.06700398772954941, 0.04198993742465973, 0.2342885434627533, 0.12335366755723953, 0.15071216225624084, 0.13001561164855957, 0.2688031792640686, -0.03145507723093033, -0.20105108618736267, 0.02523229457437992, -0.0013994313776493073, 0.3393229842185974, 0.22566837072372437, -0.003186739981174469, -0.0009085573256015778, 0.15077106654644012, 0.26946327090263367, 0.17421862483024597, -0.18419061601161957, 0.10173830389976501, -0.08282891660928726, 0.2401062250137329, 0.08610139042139053, 0.1441747099161148, 0.13677182793617249, 0.13022029399871826, -0.049591585993766785, 0.09148827195167542, 0.3855307400226593, 0.004433028399944305, 0.05128948763012886, -0.05679541081190109, 0.15903472900390625, 0.06307455152273178, 0.36177685856819153, 0.17374944686889648, 0.2906346619129181, 0.09053124487400055, 0.10231932997703552, 0.16236457228660583, 0.1755424439907074, 0.17402179539203644, -0.08719292283058167, 0.027792997658252716, 0.03825290501117706, -0.12250581383705139, 0.020042628049850464, 0.2791084349155426, 0.3736671209335327, 0.129705548286438, 0.22646193206310272, 0.2954506278038025, -0.01553284376859665, 0.13424953818321228, 0.17647965252399445, 0.2583821415901184, 0.13539829850196838, 0.13217702507972717, 0.09769771993160248], "y": [-0.04660508781671524, -0.021513190120458603, -0.12889710068702698, -0.04965122044086456, 0.16819848120212555, -0.21083462238311768, -0.029072407633066177, 0.15317481756210327, 0.1991211622953415, -0.14922849833965302, 0.12428570538759232, -0.06602834910154343, 0.2577870488166809, 0.14777442812919617, 0.06377620249986649, -0.039024967700242996, -0.14360377192497253, -0.059584811329841614, 0.02237539179623127, 0.11467339843511581, 0.1487206369638443, 0.06339385360479355, 0.006825082004070282, 0.07244144380092621, 0.24473807215690613, 0.07780589163303375, -0.12837770581245422, -0.1583399772644043, 0.1914486587047577, 0.12784263491630554, 0.21492831408977509, 0.10102663934230804, -0.023138608783483505, -0.20594753324985504, -0.15452538430690765, 0.14545658230781555, -0.2284674048423767, -0.47682899236679077, -0.00515403226017952, 0.05676012858748436, 0.08051688969135284, 0.06356874108314514, 0.15283910930156708, -0.07292477786540985, 0.02517181634902954, 0.10018845647573471, -0.0124799944460392, -0.08152232319116592, 0.13902898132801056, 0.17104822397232056, 0.10072048008441925, -0.1269175112247467, -0.018634133040905, -0.20839524269104004, 0.09041807055473328, 0.04103546589612961, -0.10704696178436279, 0.17575478553771973, -0.11530923843383789, -0.2918323278427124, 0.07447267323732376, 0.03896272927522659, 0.2870565950870514, -0.0779404416680336, -0.18341732025146484, 0.21903759241104126, -0.16162444651126862, 0.06542447209358215, -0.3074988126754761, -0.2481893002986908, 0.04218514263629913, 0.03169335424900055, 0.10888376086950302, -0.03095231205224991, 0.05923571065068245, -0.0061658695340156555, -0.011158060282468796, -0.09365596622228622, -0.2305566370487213, 0.24290060997009277, -0.24049122631549835, 0.21217447519302368, -0.06910213828086853, -0.09626998007297516, 0.06284107267856598, 0.195238396525383, 0.14445355534553528, 0.13597433269023895, 0.031403347849845886, -0.06197425723075867, 0.11489054560661316, -0.1162756085395813, 0.30836623907089233, 0.1379299759864807, -0.1989031732082367, -0.05021713674068451, 0.07769365608692169, 0.2030826210975647, 0.08402013778686523, 0.039909668266773224, -0.004506655037403107, 0.13661479949951172, -0.1112087219953537, -0.23675553500652313, 0.08818389475345612, 0.02132265269756317, 0.063527412712574, -0.15875068306922913, -0.02040671929717064, 0.14215624332427979, 0.251015841960907, -0.09222722053527832, 0.1689184308052063, 0.0993267148733139, 0.14324602484703064, 0.37458112835884094, 0.21758593618869781, 0.23087091743946075, -0.02182740718126297, 0.21735543012619019, 0.1115218997001648, 0.18734483420848846, -0.19206729531288147, -0.046862777322530746, 0.2654598355293274, -0.11003348976373672, -0.06019405275583267, 0.3892594575881958, -0.06084102764725685, 0.09785796701908112, 0.20306077599525452, 0.1217377558350563, 0.06728167831897736, 0.13841454684734344, 0.11210376024246216, 0.14338546991348267, -0.10435013473033905, -0.1785762459039688, 0.04838533326983452, 0.13105246424674988, 0.3188212215900421, 0.07511693239212036, 0.17587928473949432, 0.03648913651704788, 0.022302523255348206, -0.00029634684324264526, 0.09598471224308014, -0.07307988405227661, -0.037413425743579865, 0.03758968785405159, 0.07119394093751907, -0.03265001252293587, 0.25914695858955383, -0.14581167697906494, 0.12445801496505737, -0.06375487148761749, 0.12194108963012695, -0.2792980372905731, 0.28071117401123047, -0.035519860684871674, -0.2425963580608368, -0.12835846841335297, 0.23807351291179657, -0.19454152882099152, -0.22544413805007935, -0.2574251592159271, -0.005689635872840881, -0.16803103685379028, 0.15113870799541473, 0.059935521334409714, 0.05003096163272858, -0.20178796350955963, 0.08362463861703873, 0.01925378479063511, 0.010361742228269577, -0.20200631022453308, 0.27053898572921753, -0.26032155752182007, -0.15131770074367523, 0.13349036872386932, -0.025483902543783188, 0.07756440341472626, 0.326627254486084, -0.010563461109995842, 0.00586111843585968, 0.06420152634382248, 0.16119810938835144, -0.10134708881378174, -0.075065977871418, -0.09872760623693466, -0.01707608252763748, 0.13047146797180176, -0.01957843452692032, -0.199989914894104, 0.23420041799545288, 0.12959571182727814, 0.02326206862926483, 0.07743415236473083, 0.03707021474838257, 0.0709521695971489, -0.056003764271736145, 0.18871928751468658, -0.021057208999991417, -0.09134382009506226, -0.09856279194355011, 0.04369496926665306, 0.06477434933185577, 0.023533795028924942, -0.0758870393037796, -0.16785259544849396, 0.2927016019821167, 0.007022585719823837, 0.023076683282852173, -0.18878887593746185, -0.28057634830474854, 0.12642920017242432, -0.11204448342323303, -0.006558313965797424, 0.010648272931575775, -0.010420817881822586, 0.1327056884765625, -0.1646815538406372, -0.10021991282701492, 0.17455066740512848, -0.0045227669179439545, 0.12439381331205368, 0.08948023617267609, -0.032367728650569916, -0.06010529026389122, 0.12160078436136246, 0.283590167760849, 0.012926939874887466, 0.06445562094449997, -0.1977117359638214, 0.31435737013816833, 0.18247844278812408, 0.039975788444280624, 0.08855389058589935, -0.03987407311797142], "z": [-0.2149137556552887, 0.004564434289932251, 0.15824098885059357, -0.15719498693943024, -0.06040385738015175, 0.017461443319916725, -0.05145309865474701, 0.1589219719171524, -0.07411517202854156, -0.043994657695293427, -0.143626406788826, -0.03232390433549881, -0.11604193598031998, -0.033118002116680145, -0.3206919729709625, 0.037333130836486816, 0.09155765175819397, 0.11830854415893555, 0.06146259605884552, -0.14151515066623688, -0.12440169602632523, -0.3759843707084656, 8.553266525268555e-05, -0.07122928649187088, -0.05829797312617302, -0.20981842279434204, 0.021162450313568115, 0.02616894245147705, -0.10312407463788986, -0.1928825080394745, -0.1461019068956375, -0.09717076271772385, -0.06306850165128708, -0.08274827152490616, 0.17574144899845123, -0.1527007818222046, 0.10185075551271439, 0.10857043415307999, -0.09519452601671219, 0.2006026804447174, -0.1318873018026352, -0.19310376048088074, -0.1221543550491333, -0.10465842485427856, 0.05136322230100632, 0.11805222183465958, -0.06001030653715134, -0.18255536258220673, 0.015226965770125389, -0.043065208941698074, -0.11597955971956253, -0.10983551293611526, -0.09233103692531586, -0.22311286628246307, 0.07649489492177963, -0.1523360013961792, 0.06520915776491165, -0.12004277855157852, -0.03288227692246437, 0.021753501147031784, -0.0718977153301239, -0.07551244646310806, 0.10794775933027267, 0.15063613653182983, -0.019876888021826744, 0.10570734739303589, 0.047485075891017914, -0.11540543287992477, -0.0674218237400055, -0.06716829538345337, -0.18525761365890503, 0.04145614057779312, 0.029067128896713257, -0.16572055220603943, -0.05203825235366821, 0.09944457560777664, -0.020986519753932953, 0.1065714955329895, -0.1492517590522766, -0.09826785326004028, 0.14823341369628906, -0.05825698375701904, -0.14883628487586975, 0.0866478681564331, -0.004953563213348389, -0.04265144094824791, 0.10743798315525055, -0.08643686771392822, 0.030053425580263138, -0.26311779022216797, -0.13994194567203522, 0.08110105991363525, -0.08169224858283997, -0.02573012188076973, -0.007654862478375435, 0.029479488730430603, -0.046705834567546844, -0.05600995197892189, -0.10851161181926727, -0.16524408757686615, -0.11191963404417038, -0.14065007865428925, -0.13090834021568298, -0.09124073386192322, -0.21757872402668, 0.25026705861091614, -0.10425911098718643, -0.03536734730005264, 0.010416664183139801, -0.05346950516104698, -0.1023695170879364, -0.016697879880666733, -0.16207052767276764, -0.009047523140907288, -0.2262175977230072, -0.03682895749807358, 0.13874825835227966, -0.12050285935401917, 0.026895321905612946, -0.2915448546409607, -0.021065417677164078, -0.06273636966943741, -0.25050705671310425, -0.07865488529205322, -0.14302197098731995, 0.14225441217422485, 0.05620484799146652, 0.07496197521686554, -0.060332998633384705, -0.15705853700637817, 0.059676315635442734, 0.050677649676799774, -0.002866595983505249, -0.045860063284635544, -0.08929566293954849, -0.17910999059677124, -0.023558223620057106, 0.15864400565624237, -0.07553470134735107, -0.11074227094650269, -0.01938091218471527, -0.12818202376365662, -0.07328349351882935, -0.053613051772117615, -0.10085520148277283, 0.2774384617805481, -0.10470137000083923, -0.005864316131919622, -0.07688992470502853, -0.02397587150335312, -0.053292416036129, 0.014729520305991173, -0.22818616032600403, 0.06138332933187485, -0.04894743859767914, 0.023669030517339706, -0.11097262799739838, -0.24198287725448608, -0.12307623028755188, 0.06192822754383087, -0.006003467366099358, 0.003137648105621338, -0.12559957802295685, -0.07396918535232544, 0.024501383304595947, 0.18114948272705078, -0.08895948529243469, 0.2896652817726135, -0.12827657163143158, 0.006058752536773682, -0.17742595076560974, -0.08246392756700516, -0.0560227632522583, -0.2604292333126068, -0.007364929653704166, 0.05227616801857948, -0.10240017622709274, -0.08630113303661346, 0.10792932659387589, 0.019322529435157776, -0.06172661855816841, -0.18499478697776794, -0.07971588522195816, 0.0022426918148994446, -0.08809622377157211, -0.11367350816726685, -0.19216883182525635, -0.04193684831261635, 0.10932977497577667, -0.03766658157110214, -0.056916967034339905, 0.07803351432085037, 0.003708082716912031, -0.05474747717380524, 0.1557290256023407, 0.015255710110068321, -0.23514045774936676, -0.09628018736839294, -0.1096198558807373, 0.1751730591058731, -0.08648563921451569, -0.21255940198898315, -0.05667603015899658, -0.08090831339359283, 0.044439271092414856, -0.11138699948787689, -0.118268683552742, -0.10759283602237701, -0.09518636018037796, 0.002320326864719391, -0.32902973890304565, -0.06821245700120926, -0.06138203665614128, -0.013522117398679256, -0.03063908964395523, -0.07797408103942871, -0.05823566019535065, 0.14035336673259735, -0.04770388826727867, -0.026409734040498734, -0.23622387647628784, 0.07517753541469574, -0.02706281840801239, 0.11679240316152573, -0.1024063378572464, -0.09056411683559418, 0.06293230503797531, 0.1994171142578125, 0.030378974974155426, -0.1573466658592224, -0.060691554099321365, -0.09332703799009323, -0.17095056176185608, 0.23505020141601562, -0.10103360563516617, -0.0400640107691288, -0.09793617576360703, -0.10980850458145142, -0.1395168900489807]}, {"hovertext": "teddy", "marker": {"color": "blue", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "teddy", "type": "scatter3d", "x": [-0.17724424600601196, -0.01949150860309601, -0.015970563516020775, 0.06935913860797882, 0.021611392498016357, 0.04952796548604965, -0.018900573253631592, 0.09149109572172165, 0.0447603240609169, 0.08763372898101807, -0.02054346725344658, 0.10124330222606659, -0.13681736588478088, -0.008216563612222672, -0.10934622585773468, -0.07566727697849274, -0.000980369746685028, 0.07772301137447357, -0.03304270654916763, -0.08880658447742462, -0.05400846153497696, 0.04351623356342316, 0.061593197286129, -0.14122959971427917, 0.0009437017142772675, 0.028625614941120148, -0.044315993785858154, -0.07627721130847931, -0.10076014697551727, 0.010655820369720459, 0.08290332555770874, -0.14159418642520905, 0.036862388253211975, 0.06482064723968506, -0.0013989955186843872, 0.035463035106658936, -0.03109288029372692, 0.12020286172628403, -0.18447916209697723, -0.1309589147567749, -0.052521005272865295, -0.11616593599319458, -0.08348291367292404, -0.15845632553100586, -0.20968204736709595, 0.012808305211365223, -0.08209152519702911, 0.01644177734851837, -0.04079192876815796, -0.008879616856575012, -0.010366186499595642, 0.013912167400121689, 0.10608527064323425, -0.15270249545574188, 0.04266978055238724, 0.016818752512335777, -0.12188921868801117, -0.05268508195877075, -0.12041781842708588, -0.04741587117314339, -0.03452445566654205, -0.056705474853515625, -0.08118177950382233, 0.016168102622032166, -0.13821955025196075, -0.1905490756034851, -0.105684295296669, 0.025271743535995483, -0.08662663400173187, -0.034126684069633484, -0.185060515999794, -0.018215510994195938, 0.07543735206127167, 0.08614258468151093, -0.029046624898910522, -0.03333893045783043, -0.06736554205417633, -0.12620314955711365, 0.007224201690405607, 0.009593427181243896, 0.049758605659008026, -0.055775344371795654, -0.10012330114841461, 0.1343686580657959, -0.04950407147407532, 0.10073348879814148, 0.029475703835487366, 0.036845047026872635, 0.08354765176773071, -0.1024065911769867, 0.024492323398590088, 0.004758860915899277, -0.1582525074481964, -0.1985601782798767, 0.009531328454613686, -0.16274353861808777, 0.0721435472369194, -0.07040359079837799, 0.0019323751330375671, -0.10638488829135895, -0.05898213014006615, -0.1271878331899643, 0.17279896140098572, -0.026618167757987976, -0.012908995151519775, -0.26578858494758606, -0.04454152286052704, 0.03493967652320862, -0.13373351097106934, 0.056816160678863525, -0.05339130014181137, 0.08646200597286224, -0.10714351385831833, -0.09169243276119232, -0.03135436773300171, -0.07485830783843994, -0.09712379425764084, -0.0836637020111084, -0.07236570119857788, -0.2572648823261261, 0.0012185834348201752, -0.016974568367004395, 0.06066916882991791, -0.04284512996673584, -0.0723375603556633, 0.01878010854125023, -0.16008222103118896, -0.09587128460407257, -0.017802003771066666, 0.024694889783859253, 0.14989906549453735, -0.012361109256744385, -0.058717407286167145, 0.10148512572050095, 0.09426340460777283, -0.2030431479215622, -0.07248887419700623, -0.16098544001579285, 0.04383815452456474, -0.13481339812278748, -0.261305570602417, -0.22220692038536072, 0.05326235294342041, 0.08787252008914948, 0.020822465419769287, -0.12229546159505844, -0.1540236473083496, 0.13903363049030304, -0.0958075001835823, -0.16801100969314575, -0.020548813045024872, 0.01628870517015457, 0.040951021015644073, 0.04525374248623848, 0.02748909965157509, 0.090300053358078, -0.1123892217874527, -0.0430302619934082, 0.012413270771503448, -0.0594407394528389, -0.10023218393325806, -2.4769455194473267e-05, -0.12941023707389832, 0.0013763494789600372, -0.0064871907234191895, -0.1081341803073883, -0.14807157218456268, -0.05983509123325348, -0.21448001265525818, -0.08607422560453415, 0.038830481469631195, -0.037364937365055084, -0.017008423805236816, 0.021723922342061996, -0.15788999199867249, 0.055326640605926514, -0.03876291215419769, -0.17495393753051758, -0.029078543186187744, -0.12647657096385956, -0.0739583820104599, -0.17739447951316833, -0.11080364882946014, -0.19902350008487701, -0.00012265890836715698, -0.27980393171310425, -0.03301582485437393, -0.20486631989479065, -0.11000190675258636, -0.04721692204475403, -0.1535533368587494, -0.1654333770275116, -0.09961466491222382, 0.16486047208309174, -0.12125001102685928, -0.08584436774253845, -0.013435110449790955, -0.0886557474732399, 0.016350746154785156, -0.13897287845611572, -0.04773405194282532, 0.06953197717666626, -0.013396680355072021, -0.13812953233718872, -0.036769840866327286, -0.11370432376861572, 0.04545913264155388, -0.006019338965415955, 0.005180224776268005, 0.10603384673595428, 0.1535326987504959, -0.06199383735656738, -0.04372173547744751, 0.06800909340381622, -0.04007942974567413, -0.024726415053009987, -0.11128586530685425, 0.010562792420387268, 0.07001495361328125, 0.04699982702732086, -0.05868152901530266, -0.0803493931889534, 0.0237533301115036, 0.04150757938623428, 0.0035371407866477966, -0.1182803362607956, 0.01737978681921959, 0.04887890815734863, -0.08180361986160278, -0.024493064731359482, -0.045492179691791534, -0.000490918755531311, -0.012863561511039734, 0.00033907219767570496], "y": [0.19882354140281677, -0.1024344265460968, 0.04907764494419098, -0.21901431679725647, -0.27990859746932983, -0.24971455335617065, 0.09544093906879425, 0.03435984253883362, -0.0748031735420227, -0.127811998128891, -0.20771683752536774, -0.295297771692276, 0.05179760605096817, -0.19776713848114014, -0.04919484630227089, 0.25162720680236816, 0.022307438775897026, -0.09158322960138321, -0.021451525390148163, -0.13904976844787598, -0.13596254587173462, -0.2608833909034729, 0.029544934630393982, 0.18487918376922607, 0.1497693657875061, -0.1908051073551178, -0.19707459211349487, -0.05776612460613251, 0.07843706011772156, 0.06822335720062256, -0.02022414654493332, -0.17117741703987122, -0.38817697763442993, 0.09839905053377151, -0.0881504938006401, -0.4446205496788025, -0.09382691979408264, 0.1047813817858696, 0.24585430324077606, -0.3000648021697998, 0.07143880426883698, -0.2754346430301666, -0.055798567831516266, -0.3440875709056854, -0.05709303915500641, 0.09781315922737122, 0.04463846981525421, -0.41912955045700073, -0.29418712854385376, 0.11310632526874542, 0.03291456773877144, 0.18020865321159363, -0.21898958086967468, 0.04954510182142258, 0.14502954483032227, 0.09427722543478012, -0.08457484841346741, -0.002125672996044159, -0.212772935628891, -0.11473271250724792, -0.1339017152786255, -0.2643466889858246, -0.16127079725265503, -0.04659540206193924, -0.05514711141586304, -0.09968540817499161, -0.2740577459335327, -0.24533386528491974, -0.12998096644878387, -0.19754362106323242, 0.003014996647834778, -0.05502311512827873, -0.07926301658153534, 0.0011798590421676636, 0.048913873732089996, -0.1925732046365738, -0.007193494588136673, -0.27002108097076416, 0.1538795530796051, 0.018984448164701462, 0.1351030319929123, -0.327849417924881, -0.12326851487159729, -0.13581089675426483, -0.27694615721702576, 0.21397094428539276, 0.21627818048000336, -0.05547771602869034, -0.007957853376865387, -0.21512988209724426, -0.005256533622741699, -0.055044177919626236, -0.23258192837238312, -0.09323158115148544, 0.10399695485830307, -0.27490973472595215, -0.146023690700531, -0.0965791642665863, -0.07552895694971085, -0.21126344799995422, -0.09702470898628235, -0.2976648807525635, 0.0034576989710330963, -0.1500696837902069, 0.11815503984689713, -0.0796641856431961, -0.07726787775754929, -0.26285526156425476, 0.07672731578350067, -0.10509711503982544, 0.09984033554792404, 0.11418580263853073, 0.011504694819450378, -0.23287594318389893, -0.14835283160209656, -0.10992167145013809, -0.14645087718963623, 0.22968268394470215, 0.05758705735206604, -0.22087152302265167, -0.23731938004493713, -0.24720071256160736, -0.18039289116859436, -0.17299899458885193, -0.24279171228408813, 0.08523771166801453, 0.16027109324932098, -0.14295737445354462, -0.06713361293077469, -0.24208420515060425, -0.15847915410995483, 0.025465063750743866, -0.18858204782009125, -0.32057714462280273, -0.10169833898544312, -0.3885008692741394, 0.004038538783788681, 0.055790308862924576, -0.027316078543663025, 0.16652067005634308, 0.0867210179567337, 0.0012235715985298157, -0.13053782284259796, -0.19800908863544464, -0.14609332382678986, -0.3052884638309479, -0.22227594256401062, -0.3718201518058777, -0.00041441619396209717, -0.05012032389640808, -0.04140515998005867, -0.14123302698135376, -0.04047957807779312, 0.07241156697273254, -0.07169986516237259, -0.11422190815210342, -0.11499864608049393, -0.18941596150398254, -0.2257610261440277, -0.14379937946796417, 0.07487643510103226, -0.14371974766254425, -0.1558932662010193, -0.23671561479568481, -0.4276365637779236, 0.13934749364852905, 0.08116599917411804, 0.1676291823387146, -0.1597445011138916, -0.035586416721343994, -0.16985228657722473, -0.12028529495000839, -0.08166006952524185, -0.16744215786457062, -0.030835196375846863, 0.03208846598863602, 0.04053260013461113, -0.1621565967798233, -0.0557255893945694, -0.2203611135482788, -0.245665043592453, 0.09437982738018036, -0.2385782152414322, -0.3048075735569, -0.30133044719696045, 0.12214839458465576, 0.003871716558933258, -0.01740385964512825, -0.27842357754707336, 0.12458129972219467, -0.2880534827709198, 0.14508900046348572, -0.015562698245048523, -0.14916017651557922, -0.3731306195259094, -0.10339923202991486, -0.3943195641040802, -0.10950016230344772, -0.42655760049819946, -0.06684055924415588, -0.25101181864738464, -0.021305982023477554, 0.18902073800563812, -0.16830238699913025, -0.1651340276002884, -0.19142764806747437, 0.013133521191775799, -0.19256721436977386, -0.33829328417778015, 0.12417937070131302, -0.0838850736618042, -0.1666886806488037, -0.21211953461170197, 0.062463924288749695, -0.006908544339239597, -0.04475130885839462, -0.2741965353488922, -0.2419472336769104, -0.12589029967784882, -0.2611624300479889, -0.03232116997241974, -0.014378078281879425, -0.27393341064453125, -0.04123830795288086, -0.1994340419769287, -0.3478674590587616, 0.060059402137994766, -0.04769498109817505, -0.3155328333377838, 0.10606229305267334, -0.002424333244562149, -0.2442232370376587, -0.0843624472618103, -0.02306247502565384], "z": [-0.05640370398759842, 0.306138277053833, 0.050229307264089584, 0.0026573315262794495, 0.01831662654876709, 0.08139704167842865, 0.13257597386837006, 0.12137474119663239, 0.0980762466788292, 0.2964104115962982, 0.15714672207832336, 0.05112890154123306, 0.04051993787288666, -0.03483173996210098, -0.0757635161280632, 0.21431183815002441, 0.07762318849563599, 0.045811980962753296, 0.19482947885990143, 0.02286650612950325, 0.08033277839422226, 0.08060619235038757, 0.11869746446609497, -0.004353625699877739, 0.12788206338882446, 0.2967213988304138, 0.08287624269723892, 0.07908747345209122, -0.0341319665312767, 0.26598435640335083, 0.05082526057958603, 0.2196916937828064, 0.1498086303472519, -0.12423337250947952, -0.030659236013889313, 0.18301120400428772, -0.0741080790758133, -0.026968374848365784, 0.0936289131641388, -0.02854970097541809, -0.25195175409317017, -0.06683854013681412, -0.10670921206474304, 0.041441887617111206, -0.017350591719150543, -0.00865921750664711, -0.04297468066215515, 0.10945400595664978, 0.11388559639453888, 0.1526360809803009, 0.022022794932127, 0.06337656825780869, 0.18455779552459717, 0.08034177124500275, 0.09761126339435577, -0.14414973556995392, -0.04209344834089279, -0.00475485622882843, 0.04687163233757019, 0.03852454572916031, 0.12814272940158844, 0.01215527206659317, 0.18275348842144012, 0.09826892614364624, -0.009317226707935333, 0.037201888859272, 0.10010691732168198, 0.09664779156446457, 0.06191129982471466, 0.08533784002065659, -0.09953901171684265, 0.0936380922794342, 0.16410815715789795, 0.05523234233260155, -0.020754791796207428, 0.010674282908439636, 0.07108819484710693, 0.015383511781692505, 0.2564581334590912, 0.1982560008764267, 0.13710743188858032, 0.08915682137012482, -0.05946514755487442, 0.15514890849590302, 0.10423299670219421, 0.22345910966396332, 0.049474455416202545, 0.015866655856370926, 0.13631819188594818, 0.10779434442520142, -0.004230126738548279, -0.13138671219348907, -0.02514086663722992, -0.12533527612686157, 0.014274060726165771, -0.05450483411550522, 0.12019661068916321, 0.18132522702217102, 0.1668289452791214, 0.14769472181797028, 0.020393282175064087, 0.13139937818050385, 0.2809295952320099, 0.019359774887561798, 0.22882917523384094, -0.06248211860656738, 0.14455610513687134, -0.05631842464208603, 0.01220681518316269, -0.04695555567741394, 0.07039837539196014, 0.2887387275695801, -0.05476858466863632, 0.049208998680114746, 0.033741436898708344, -0.004304781556129456, -0.1230444461107254, 0.054475802928209305, -0.08017203211784363, 0.057977281510829926, 0.04461933672428131, 0.018637828528881073, 0.12317483127117157, -0.0490562841296196, 0.04765522480010986, 0.01601768285036087, -0.12271547317504883, -0.010547898709774017, 0.0031189769506454468, 0.08631813526153564, 0.023790821433067322, 0.0759090781211853, 0.08258584141731262, 0.13899332284927368, 0.08446761965751648, 0.04210537672042847, -0.1442878246307373, -0.13871070742607117, -0.05859185382723808, 0.057648662477731705, -0.17680799961090088, -0.06301115453243256, 0.0784003809094429, 0.13061392307281494, 0.05588654428720474, 0.04494862258434296, 0.03056100755929947, 0.13828347623348236, -0.07640093564987183, 0.1294354796409607, -0.001299634575843811, -0.15954062342643738, 0.09100659191608429, 0.16582685708999634, 0.1240721270442009, 0.12221352756023407, 0.09837015718221664, 0.06888867169618607, 0.08204157650470734, 0.06797866523265839, 0.17164577543735504, 0.1441117823123932, 0.043068140745162964, 0.06481829285621643, 0.025928348302841187, 0.062349528074264526, -0.013574905693531036, 0.020283734425902367, 0.18393385410308838, 0.09252599626779556, 0.1362457573413849, 0.0782853364944458, 0.032891519367694855, 0.01988588273525238, -0.0729445219039917, 0.12023164331912994, 0.1161559522151947, 0.10403048992156982, 0.24412785470485687, 0.06251169741153717, 0.2508488893508911, -0.12465730309486389, -0.027266226708889008, 0.10354208946228027, 0.08932332694530487, -0.19509351253509521, 0.005515150725841522, 0.030713863670825958, 0.011394038796424866, 0.055974818766117096, -0.05276256799697876, -0.024260636419057846, -0.06922221183776855, 0.11031502485275269, -0.009158536791801453, 0.1155560240149498, 0.12975984811782837, 0.022580668330192566, 0.18191877007484436, 0.04621030390262604, 0.12142451107501984, 0.045545123517513275, 0.04842008650302887, -0.03195524960756302, 0.01197812333703041, 0.07836396247148514, 0.0025017820298671722, 0.06291233748197556, 0.06319412589073181, -0.037157416343688965, 0.07711316645145416, 0.06058157980442047, 0.06643888354301453, -0.027002453804016113, 0.014811422675848007, 0.015139594674110413, 0.09966385364532471, 0.2441549152135849, -0.0026023760437965393, 0.1262880563735962, 0.02931918203830719, -0.06544601917266846, 0.07000689208507538, -0.006262913346290588, 0.11908499896526337, 0.12427133321762085, 0.02009611949324608, 0.14119747281074524, -0.10362641513347626, 0.07088087499141693, 0.0811084657907486, 0.1866898536682129, 0.062120772898197174, 0.31712329387664795]}, {"hovertext": "spectacled", "marker": {"color": "orange", "opacity": 0.6, "size": 5}, "mode": "markers", "name": "spectacled", "type": "scatter3d", "x": [-0.0019831880927085876, 0.21010331809520721, -0.12321239709854126, -0.12749820947647095, 0.0646824985742569, 0.18697023391723633, 0.17393040657043457, 0.08604935556650162, 0.019962601363658905, 0.2669169008731842, -0.1838706135749817, 0.05490736663341522, -0.005287874490022659, 0.12668345868587494, 0.27842265367507935, -0.05552119016647339, 0.12749721109867096, -0.041524309664964676, 0.33389782905578613, 0.25359830260276794, 0.016271419823169708, -0.08685726672410965, 0.1920011341571808, 0.08300147205591202, 0.0922856256365776, 0.08178533613681793, 0.001128997653722763, 0.25523072481155396, 0.17935864627361298, 0.30784302949905396, 0.06780336797237396, 0.08095425367355347, -0.20057402551174164, 0.07771780341863632, 0.1854538917541504, 0.03633341193199158, -0.13537700474262238, 0.11364467442035675, 0.2957380712032318, 0.13904091715812683, -0.01235911250114441, -0.07152565568685532, 0.139600932598114, 0.09839362651109695, 0.21155889332294464, 0.09556777775287628, 0.04028012603521347, -0.03448927402496338, 0.060217808932065964, -0.06621171534061432, -0.16964712738990784, -0.0012673772871494293, 0.05729304999113083, -0.07061712443828583, 0.2882898449897766, 0.20023733377456665, 0.09049409627914429, 0.005268600769340992, 0.1671956330537796, 0.0723796933889389, -0.06339932978153229, 0.17964261770248413, -0.0861627534031868, 0.22750797867774963, 0.536736011505127, -0.010454759001731873, 0.053080081939697266, 0.12435054779052734, 0.06059844791889191, -0.14493389427661896, 0.013998255133628845, -0.16452321410179138, 0.20598360896110535, 0.10364880412817001, -0.10480426996946335, 0.008415672928094864, 0.05259266123175621, 0.12988689541816711, -0.002073138952255249, -0.06166262552142143, 0.029644634574651718, -0.033803634345531464, 0.20199856162071228, 0.10907217860221863, 0.011356603354215622, -0.08036558330059052, 0.059877172112464905, 0.08714514970779419, 0.19516992568969727, 0.2661333382129669, 0.2676577568054199, -0.11130451411008835, 0.08308929204940796, -0.0940493643283844, 0.12679974734783173, -0.19023561477661133, -0.06422971189022064, 0.16911303997039795, -0.09197759628295898, -0.0950828492641449, 0.16655787825584412, 0.07379056513309479, 0.135918527841568, 0.44512128829956055, -0.0043703168630599976, 0.19907094538211823, 0.13466721773147583, 0.03060220554471016, -0.17893177270889282, -0.10923049598932266, 0.04541090130805969, 0.0444713830947876, -0.41354691982269287, 0.3551223576068878, 0.15599265694618225, 0.1782345026731491, -0.19255183637142181, 0.0668092742562294, 0.04463319852948189, 0.06410960853099823, 0.07171206921339035, 0.054224494844675064, 0.2611081004142761, 0.14434665441513062, 0.3453119397163391, -0.11413265764713287, 0.061457060277462006, 0.12098792940378189, 0.02584557607769966, 0.059627715498209, 0.2337750792503357, 0.05885056406259537, -0.06706134974956512, 0.07669387757778168, 0.00025854911655187607, -0.01162542961537838, -0.11594834178686142, 0.04768499359488487, 0.2261316180229187, 0.06199359893798828, 0.16655787825584412, 0.4285939037799835, 0.13719859719276428, 0.22087465226650238, -0.08897630870342255, -0.11467450112104416, 0.3124375343322754, -0.07038546353578568, 0.28890615701675415, 0.197671577334404, 0.05203203484416008, -0.17380104959011078, -0.04834878072142601, 0.3097832202911377, 0.09203437715768814, 0.09502246230840683, -0.010594967752695084, -0.01956169679760933, 0.10436548292636871, 0.1234540119767189, -0.021746095269918442, 0.22546139359474182, 0.2005602866411209, 0.024832535535097122, 0.1902359426021576, 0.21748006343841553, 0.11503854393959045, 0.09178003668785095, 0.3223457932472229, 0.012838736176490784, -0.17489677667617798, 0.3045276403427124, 0.09135867655277252, -0.09871275722980499, 0.0671951025724411, 0.2629253566265106, 0.04577784240245819, 0.3076951503753662, 0.20904919505119324, -0.028694048523902893, -0.17995189130306244, -0.15674152970314026, -0.1718534380197525, 0.028069863095879555, 0.2957380712032318, -0.045962072908878326, 0.21958084404468536, -0.11320789903402328, -0.09230202436447144, 0.08684518933296204, 0.3089348077774048, 0.44907018542289734, 0.3677886426448822, 0.07617148011922836, -0.10564197599887848, 0.09069812297821045, 0.0626477301120758, 0.0921890139579773, 0.31044989824295044, 0.06967268884181976, 0.1111593097448349, 0.42268824577331543, -0.07971374690532684, 0.022187285125255585, 0.007870703935623169, 0.07933185249567032, 0.23101107776165009, 0.21550729870796204, 0.17132839560508728, -0.08446871489286423, 0.11274324357509613, 0.32957836985588074, 0.10436548292636871, 0.15054652094841003, 0.36392396688461304, 0.1279454529285431, 0.009724251925945282, 0.17649827897548676, 0.002730146050453186, 0.04160933569073677, 0.2707281708717346, 0.12748458981513977, 0.4150204062461853, 0.17138849198818207, 0.37077444791793823, 0.162870854139328, 0.1958957463502884, -0.047286201268434525, 0.08323299884796143, 0.010212243534624577, 0.2367132604122162, 0.09056629240512848, 0.16164441406726837, 0.24837277829647064, 0.16236615180969238, 0.15498989820480347, 0.10504186153411865, 0.13679082691669464, 0.2986033260822296, 0.02769571542739868, 0.2563261389732361, 0.19068372249603271, -0.20890337228775024, 0.12688830494880676], "y": [0.26937368512153625, 0.07604014128446579, 0.24877171218395233, -0.12055740505456924, -0.03799276798963547, -0.10970336198806763, -0.051019519567489624, -0.049824293702840805, 0.18344177305698395, 0.15433888137340546, 0.0020543718710541725, 0.04334823042154312, 0.14262931048870087, 0.2347979098558426, 0.22928285598754883, 0.1879711002111435, -0.18573617935180664, 0.19705410301685333, 0.13681045174598694, 0.12035319954156876, 0.1617884337902069, 0.09583410620689392, 0.15686793625354767, -0.13708734512329102, -0.11591921746730804, 0.23062331974506378, 0.25243738293647766, 0.035129353404045105, 0.1678159236907959, -0.10728106647729874, 0.2130124568939209, 0.1376081258058548, -0.042601291090250015, -0.23328179121017456, 0.17071926593780518, -0.031021760776638985, 0.22824831306934357, 0.04244507849216461, -0.12003522366285324, -0.032354120165109634, 0.11511813849210739, 0.1915639191865921, -0.11163760721683502, 0.15483716130256653, -0.20619329810142517, 0.07225456833839417, 0.122012659907341, -0.41073065996170044, 0.11088110506534576, -0.18685226142406464, 0.20951366424560547, -0.3188842236995697, 0.19902551174163818, -0.20300284028053284, -0.1112857311964035, 0.17069478332996368, -0.2294592261314392, 0.29735231399536133, 0.020275678485631943, -0.11820589005947113, 0.14021335542201996, 0.10740680247545242, -0.07686972618103027, 0.022940559312701225, 0.38775816559791565, 0.06685959547758102, 0.2551659345626831, 0.06716752052307129, 0.08448179811239243, 0.04066053032875061, 0.2259286344051361, -0.18859536945819855, 0.06818942725658417, 0.19568908214569092, 0.3113332688808441, 0.09755218774080276, 0.152080237865448, 0.11675919592380524, 0.06229794770479202, -0.22342462837696075, -0.24472035467624664, 0.13985852897167206, 0.21973863244056702, 0.26756802201271057, -0.08352096378803253, 0.1472000628709793, 0.17203237116336823, -0.002737021539360285, 0.26222559809684753, -0.08238328993320465, 0.19974862039089203, -0.09844844043254852, 0.09842339158058167, 0.27648186683654785, 0.08386967331171036, 0.043396059423685074, 0.1708914041519165, -0.14539584517478943, 0.0469558984041214, 0.11135464161634445, 0.05147412791848183, 0.15031009912490845, 0.3152555525302887, -0.23287391662597656, 0.062135592103004456, 0.20835524797439575, 0.09010711312294006, 0.022692428901791573, 0.10583183914422989, 0.35358700156211853, 0.004460261203348637, 0.05571981519460678, -0.05056171119213104, 0.010430917143821716, -0.16386081278324127, -0.09732852876186371, -0.04006291180849075, -0.09552930295467377, 0.11706455796957016, 0.09562857449054718, 0.14257293939590454, 0.1490982472896576, 0.21880094707012177, 0.19061386585235596, -0.07399407774209976, 0.13088834285736084, -0.12526863813400269, -0.14147064089775085, 0.19430112838745117, 0.21758168935775757, 0.07241752743721008, 0.18684962391853333, -0.20245420932769775, 0.3017581105232239, 0.18414708971977234, 0.28660324215888977, 0.127916157245636, 0.10551518946886063, 0.15743334591388702, 0.1280156970024109, 0.05147412791848183, -0.045267701148986816, -0.003921793773770332, -0.37270450592041016, 0.13638290762901306, 0.021380901336669922, 0.1245068907737732, -0.036746203899383545, 0.17408189177513123, 0.19716092944145203, 0.03806323558092117, -0.3107951581478119, 0.10405623912811279, -0.00507059320807457, -0.008932165801525116, -0.17187441885471344, 0.20072129368782043, 0.08050628006458282, 0.14804205298423767, 0.06472963094711304, -0.12586873769760132, 0.1064959168434143, 0.234488382935524, 0.2313188761472702, 0.07625174522399902, 0.04395446926355362, -0.12448284029960632, 0.2404836267232895, -0.012182198464870453, 0.26807892322540283, 0.12774065136909485, 0.01296924240887165, 0.20497244596481323, 0.013835066929459572, 0.1240006759762764, 0.08094383776187897, 0.2748739421367645, 0.20600461959838867, 0.020814405754208565, 0.1535036861896515, -0.22812126576900482, 0.19621732831001282, 0.1577797681093216, 0.09350214898586273, -0.12003522366285324, 0.12903670966625214, 0.17755256593227386, 0.050469331443309784, -0.20373743772506714, 0.120283342897892, 0.20261740684509277, 0.14312298595905304, 0.17664378881454468, -0.15872842073440552, -0.11897633969783783, 0.3782126307487488, 0.014644368551671505, 0.2720400094985962, 0.05713241174817085, -0.10285615921020508, -0.10627156496047974, 0.1470041424036026, 0.27322790026664734, 0.043537385761737823, 0.03920929878950119, -0.04697590321302414, 0.011890151537954807, 0.16503596305847168, 0.052016742527484894, -0.05405949428677559, 0.033553384244441986, 0.23720605671405792, 0.14804205298423767, 0.08990064263343811, -0.2370591014623642, -0.12893103063106537, -0.02122492529451847, 0.007264584302902222, 0.2136765718460083, 0.07129686325788498, -0.025674816220998764, -0.3115008473396301, 0.25565284490585327, 0.047960661351680756, -0.10308432579040527, 0.20296256244182587, -0.16104909777641296, -0.3806487023830414, 0.05991887301206589, -0.009372994303703308, 0.01908325031399727, 0.12173610925674438, -0.2893699109554291, 0.18885867297649384, 0.19252127408981323, 0.2638195753097534, 0.09424827992916107, -0.10507934540510178, 0.313990980386734, -0.01756911724805832, 0.12066224217414856, 0.22639857232570648, -0.1856752634048462, 0.30244535207748413], "z": [0.054456643760204315, -0.172240749001503, -0.009286411106586456, -0.0016822069883346558, -0.11563049256801605, 0.033093683421611786, -0.02332170121371746, -0.08567021787166595, -0.27432283759117126, -0.1202116310596466, -0.13417549431324005, -0.047418203204870224, -0.05029558390378952, -0.04192379489541054, 0.0945805236697197, -0.11481182277202606, -0.12145452201366425, -0.07192099094390869, -0.002164458855986595, -0.054778728634119034, -0.1381361037492752, -0.0890362486243248, 0.06904719769954681, 0.023590194061398506, -0.2182311862707138, -0.025803253054618835, -0.11494133621454239, -0.04560217633843422, -0.11594913899898529, -0.04974450170993805, 0.0008123964071273804, -0.20181874930858612, 0.0883110910654068, -0.09357313811779022, 0.04482343792915344, -0.14306296408176422, -0.12026607245206833, -0.11993054300546646, 0.02983338013291359, -0.04723558574914932, -0.08003239333629608, 0.07231958210468292, -0.03146187961101532, -0.09630755335092545, -0.0073378607630729675, -0.12052249908447266, -0.019256502389907837, 0.022905007004737854, -0.04374578967690468, -0.1139741912484169, -0.17043012380599976, 0.04440245032310486, -0.17841938138008118, -0.01960504800081253, 0.015021303668618202, -0.10962504893541336, -0.20380710065364838, -0.12038244307041168, -0.02089894749224186, 0.05285924673080444, -0.19919277727603912, 0.11679131537675858, -0.09348797053098679, -0.07373854517936707, 0.060125596821308136, 0.01785886287689209, -0.0242861807346344, -0.08939763158559799, -0.2091563642024994, 0.15218229591846466, -0.3122842311859131, 0.049034688621759415, 0.04899179935455322, 0.11394055187702179, 0.04192287474870682, -0.07795439660549164, -0.13560351729393005, -0.09743107855319977, -0.15093082189559937, -0.04383544251322746, 0.0330689400434494, 0.023719459772109985, -0.15325221419334412, -0.02115742117166519, 0.03973831981420517, -0.06515893340110779, -0.0892038345336914, -0.06265704333782196, -0.10836855322122574, 0.1651829183101654, -0.025458376854658127, -0.18179365992546082, -0.17220771312713623, -0.055097468197345734, -0.046120110899209976, 0.07384028285741806, -0.09758971631526947, -0.07985416054725647, -0.07513023912906647, 0.03860189765691757, -0.18080195784568787, 0.044814132153987885, -0.09403336048126221, 0.21270065009593964, -0.08559168875217438, -0.15799245238304138, 0.050389282405376434, -0.11223330348730087, -0.21070830523967743, 0.028065234422683716, -0.12854617834091187, -0.04943114519119263, 0.12657776474952698, -0.19518014788627625, -0.06973883509635925, -0.09011852741241455, -0.057271577417850494, -0.13406458497047424, 0.20507973432540894, -0.05390775948762894, -0.03216731920838356, -0.20531627535820007, -0.11021251976490021, -0.06605304032564163, 0.11743965744972229, 0.024307668209075928, 0.018429545685648918, -0.08038059622049332, 0.037764403969049454, 0.0032951384782791138, -0.1292329728603363, -0.13360868394374847, -0.04581871256232262, -0.08697657287120819, 0.09984180331230164, -0.12553031742572784, 0.04687100648880005, -0.16510364413261414, 0.014513857662677765, -0.10260099172592163, -0.18080195784568787, -0.0287820715457201, -0.16005581617355347, -0.03171341121196747, -0.1767350286245346, 0.011814914643764496, 0.18804456293582916, -0.16539189219474792, -0.12063530087471008, -0.04573095962405205, 0.09671614319086075, 0.07285025715827942, -0.08025573194026947, -0.02177012339234352, -0.15478242933750153, 0.07515401393175125, -0.13004252314567566, -0.12962445616722107, -0.11345545947551727, -0.1662694364786148, 0.10692815482616425, -0.023154601454734802, -0.12494383752346039, 0.08305297046899796, -0.1554749310016632, -0.023877520114183426, -0.1055985540151596, 0.0667819231748581, -0.06757227331399918, -0.07083360105752945, -0.020174294710159302, 0.008073993027210236, 0.10131286829710007, -0.0949774906039238, -0.21713019907474518, -0.052571751177310944, 0.029996614903211594, -0.07977420091629028, -0.19661687314510345, 0.08373153209686279, 0.04110123962163925, -0.0013895854353904724, 0.1613670289516449, -0.005591176450252533, 0.02983338013291359, -0.18713346123695374, -0.07691051065921783, -0.07396255433559418, -0.02456071227788925, 0.02141757123172283, -0.09091860055923462, -0.011404793709516525, -0.06417952477931976, 0.0778513103723526, -0.07578650861978531, 0.04502284899353981, -0.24304255843162537, 0.11485107243061066, 0.1262761652469635, 0.18202896416187286, -0.36085692048072815, -0.1239648386836052, 0.2243303507566452, -0.03887667879462242, -0.09230658411979675, -0.004808975383639336, -0.019894331693649292, -0.07514312863349915, -0.14703789353370667, -0.06673882156610489, -0.1180228739976883, -0.21612749993801117, -0.11345545947551727, -0.06581266224384308, 0.18303009867668152, 0.10989920794963837, -0.013382747769355774, 0.02185036987066269, -0.11632010340690613, 0.03241463750600815, -0.17905530333518982, -0.05100720375776291, -0.17257437109947205, -0.07316119968891144, 0.05106165260076523, -0.1649419367313385, 0.04980391263961792, -0.10986992716789246, -0.2574574649333954, -0.10898202657699585, 0.12484827637672424, 0.0336482897400856, -0.06264351308345795, 0.01260492205619812, -0.04720332473516464, -0.25641486048698425, -0.118936687707901, 0.05821632221341133, -0.19835403561592102, -0.25479641556739807, -0.2142835259437561, -0.08735129982233047, 0.2648014426231384, -0.0948004499077797]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('689de7a1-8899-4b68-9d2f-f26321303ae8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>


</div>
</div>
<p><strong>TODO: Woops! Forgot to score how the model did on the spectacled bears! Will add that soon. ;-) Watch this space.</strong></p>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">3. Discussion</h2>
<p>From this example, it looks like the contrastive loss method is worse than traditional classification in a couple ways: it requires more data (or else the model tends to overfit), it runs slower, and it’s less accurate. (And we completely left out the challenge of training CL models which typically need to have their positive and negative examples <a href="https://arxiv.org/abs/2010.04592">“mined” to find “hard” cases</a> so that the model “learns” more per iteration.) Why would anyone ever want to use it?</p>
<p>Well, we already mentioned the use case of “produces semantically meaningful embeddings” that can then be used for other downstream tasks. For example, word embeddings like Word2Vec or GloVe can be used for lots of NLP tasks. Jeremy Howard in the FastAI course shows how to embeddings of tabular data and how that can work better and be more meaningful than one-hot encoded tabular data.</p>
<p>Furthermore, regarding accuracy: <strong><a href="https://openai.com/blog/clip/">OpenAI’s CLIP</a> became <a href="https://www.urbandictionary.com/define.php?term=SOTA">SOTA</a> on ImageNet</strong> in early 2020! They used a TON of pre-training data, and ended up classifying images via contrastive losses better than any other method!</p>
<p>Are contrastive loss methods right for you and your use case, and your dataset? I don’t know. Hopefully after this, you at least have some clue of how to implement such a thing, and how it compares and constrasts with the sort of vanilla classification most people who work with neural networks are used to.</p>
</section>
<section id="fastai-details-how-i-wrote-my-first-callback" class="level2">
<h2 class="anchored" data-anchor-id="fastai-details-how-i-wrote-my-first-callback">4. FastAI Details: How I Wrote My First Callback</h2>
<p>I wrote a Callback to use <a href="https://github.com/drscotthawley/mrspuff">my visualization routines</a>. It’s generic enough that you could easily pass in some other visualization routine – in fact, mine is generic enough that I must assume someone else (LOL, as in Jeremy) has probably already written one at least as good, but this one is mine!</p>
<p>The basic structure of the callback is very simple. In the following I’ve removed all the URL-bookkeeping so you can see the structure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> VizPreds_Structure(Callback):</span>
<span id="cb37-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Structure of my Progress-like callback: call the bokeh triangle plot (or some other routine) </span></span>
<span id="cb37-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    with each batch of training. Scroll down to next code block for 'full' VizPreds routine."""</span></span>
<span id="cb37-4">    order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ProgressCallback.order<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run it after the main fastai ProgressCallback</span></span>
<span id="cb37-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb37-6">        method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># method is a plotting function, must have a .do_plot(preds,targs) and not mind unexpected kwargs. Or 'auto'</span></span>
<span id="cb37-7">        activation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>F.softmax, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PyTorch activation for preds. For trad. classification, 'preds' are logits &amp; need softmax. or None</span></span>
<span id="cb37-8">    ):</span>
<span id="cb37-9">        store_attr()    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one of my favorite fastai routines ever, sets all the "self." vars</span></span>
<span id="cb37-10"></span>
<span id="cb37-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> before_fit(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up stuff </span></span>
<span id="cb37-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>: <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># added the 'auto' thing so it choose which default method to use based on num. of dimensions</span></span>
<span id="cb37-13">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TrianglePlot2D_Bokeh <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.vocab) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> TrianglePlot3D_Plotly</span>
<span id="cb37-14"></span>
<span id="cb37-15">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> before_epoch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove our accumulated info over batches</span></span>
<span id="cb37-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only operated on validation datasets</span></span>
<span id="cb37-17">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stuff that's gonna get plotted</span></span>
<span id="cb37-18"></span>
<span id="cb37-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> after_batch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make predictions after each val batch and accumulate them to plot at the end</span></span>
<span id="cb37-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only operated on validation datasets</span></span>
<span id="cb37-21">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb37-22">                preds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.pred, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> preds </span>
<span id="cb37-23">                preds, targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.detach().cpu().numpy().copy() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [preds, y]] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uh...I probly don't need "copy" do I?</span></span>
<span id="cb37-24">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> preds <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> np.vstack((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, preds))</span>
<span id="cb37-25">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> targs <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> np.hstack((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs, targs))</span>
<span id="cb37-26"></span>
<span id="cb37-27">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> after_epoch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):          </span>
<span id="cb37-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:</span>
<span id="cb37-29">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>learn<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: Plotting </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.valid.items)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">?) points:"</span>)</span>
<span id="cb37-30">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># call whatever the plotting method is and make the plot</span></span>
<span id="cb37-31">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dls.vocab,</span>
<span id="cb37-32">                comment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>learn<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, thumb_height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.thumb_height).do_plot()</span></code></pre></div>
</div>
<p>That’s the idea. If you only cared about plotting the very last batch of predictions, you could put all that code currently in <code>after batch</code> into the start of <code>after_epoch</code> – which is how I had it initially until I started wondering, “Hey where’s the rest of my validation data?!”</p>
<p>It’s important that this viz routine gets registered as a callback for the <strong>fit, not the Learner.</strong> If you make a callback for the Learner, it will be executing lots of times when you don’t want it to, such if/when you call the LRFinder. Don’t do that.</p>
<p>In order to implement the mouseover-image-thumbnail preview feature that my <code>mrspuff</code> routine <code>TrianglePlot2D_Bokeh</code> provides, there’s a bunch of extra bookkeeping needed to generate and then hang on to the thumbnail URLs. If we include all that, then the full Callback is below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> VizPreds(Callback):</span>
<span id="cb38-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Progress-like callback: call the bokeh triangle plot (or some other routine) </span></span>
<span id="cb38-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    with each batch of training"""</span></span>
<span id="cb38-4">    order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ProgressCallback.order<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run it after the main fastai ProgressCallback</span></span>
<span id="cb38-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb38-6">        method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># method is a plotting function, must have a .do_plot(preds,targs) and not mind unexpected kwargs. Or 'auto'</span></span>
<span id="cb38-7">        activation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>F.softmax, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PyTorch activation for preds. For trad. classification, 'preds' are logits &amp; need softmax. or None</span></span>
<span id="cb38-8">        gen_urls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate thumbnail urls (if they don't exist) (2D_Bokeh only)</span></span>
<span id="cb38-9">        thumb_height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lets you vary the height of image thumbnails (2D_Bokeh only)</span></span>
<span id="cb38-10">        force_new_urls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if False, keeps whatever thumbnail urls are in learn.dls (2D_Bokeh only)</span></span>
<span id="cb38-11">    ):</span>
<span id="cb38-12">        store_attr()</span>
<span id="cb38-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.we_made_the_thumbs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so that we don't force-gen new urls a 2nd time after un-freezing</span></span>
<span id="cb38-14"></span>
<span id="cb38-15">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> before_fit(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up the plotting method and generate thumbnail URLs if applicable</span></span>
<span id="cb38-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>:</span>
<span id="cb38-17">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TrianglePlot2D_Bokeh <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.vocab) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> TrianglePlot3D_Plotly</span>
<span id="cb38-18"></span>
<span id="cb38-19">        dv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.valid       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dv is just a shorthand for "dls.valid"</span></span>
<span id="cb38-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.gen_urls <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>TrianglePlot2D_Bokeh <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> ((<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'url_dict'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span>(dv)) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.force_new_urls) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.we_made_the_thumbs:</span>
<span id="cb38-21">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.we_made_the_thumbs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># as in "I made the donuts", https://www.youtube.com/watch?v=IYRurPB4WA0</span></span>
<span id="cb38-22">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#url_dict maps filenames to urls.  if you're on regular-Jupyter instead of Colab, you can use filenames as urls </span></span>
<span id="cb38-23">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.valid.url_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(dv.items, get_thumb_urls(dv.items, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.thumb_height,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.thumb_height))))</span>
<span id="cb38-24"></span>
<span id="cb38-25">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> before_epoch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb38-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:</span>
<span id="cb38-27">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb38-28"></span>
<span id="cb38-29">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> after_batch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make predictions after each val batch and accumulate them to plot at the end</span></span>
<span id="cb38-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:</span>
<span id="cb38-31">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb38-32">                preds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.pred, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> preds </span>
<span id="cb38-33">                preds, targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.detach().cpu().numpy().copy() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [preds, y]] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove copy()?</span></span>
<span id="cb38-34">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> preds <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> np.vstack((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, preds))</span>
<span id="cb38-35">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> targs <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> np.hstack((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs, targs))</span>
<span id="cb38-36"></span>
<span id="cb38-37">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> after_epoch(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now that we have all our pred/targ batches and urls ready (if applicable), plot!</span></span>
<span id="cb38-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.training:</span>
<span id="cb38-39">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>learn<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: Plotting </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (= </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.valid.items)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">?) points:"</span>)</span>
<span id="cb38-40">            urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb38-41">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>TrianglePlot2D_Bokeh:</span>
<span id="cb38-42">                dv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.dls.valid       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dv is just a shorthand for "dls.valid"</span></span>
<span id="cb38-43">                urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [dv.url_dict[f] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> dv.items] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'url_dict'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span>(dv) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> dv.items <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># image urls or filenames</span></span>
<span id="cb38-44">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.method(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_preds, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learn.viz_targs, urls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>urls, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dls.vocab,</span>
<span id="cb38-45">                comment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>learn<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, thumb_height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.thumb_height).do_plot()</span></code></pre></div>
</div>
<p>TrianglePlot2D_Bokeh is my <code>mrspuff</code> routine that allows for image-thumbnail previews, and these require that we generate and hang on to URLs that point to the images. (If you were to cut out all the URL-related stuff, this callback is really <em>trivial</em>.)</p>
<p>On regular-Jupyter (on your local machine, or on Paperspace Gradient, or Binder, etc.) the Jupyter server lets us just use filenames and it <em>converts them all to URLs automatically for us</em>! But on Colab, we need to generate the “sharing URLs”, and then remember those. So that’s what a lot of the extra verbiage in this callback is for: it’s about managing the image thumbnail URLs (if we’re plotting in 2D, i.e.&nbsp;3 classes where we’re in the plane of the “triangle” that forms).</p>
<p>If there are in 4 or more dimensions, then we automatically trigger the Plotly-based plotter, which will automatically PCA-down to a 3D projection – so for 4 classes, we get a 3D tetrahedron. And there are no thumnail URLs because sadly Plotly doesn’t support those.</p>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements:</h2>
<p>Special thanks to <a href="https://twitter.com/TheZachMueller">Zach Mueller</a> for assistance in interfacing with fastai!</p>


</section>

 ]]></description>
  <category>classification</category>
  <category>ssl</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-06-17-contrasting-contrastive-loss.html</guid>
  <pubDate>Thu, 17 Jun 2021 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/vizpreds_preview.png" medium="image" type="image/png" height="127" width="144"/>
</item>
<item>
  <title>Typical (Neural-Network-Based) Classification vs. Zero-Shot, Part 1 - The Joy of 3D</title>
  <dc:creator>Scott H. Hawley</dc:creator>
  <link>https://drscotthawley.github.io/blog/posts/2021-05-04-the-joy-of-3d.html</link>
  <description><![CDATA[ 




<p><em>(This blog post is an extended treatment of a talk I recently gave. To see the slides for the talk, <a href="https://mybinder.org/v2/gh/drscotthawley/talks/HEAD?filepath=SoTL_3DClass_April_2021%2FJoy-Of-3D-Slides.ipynb">click here</a>.)</em></p>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>We’re going to explore the difference between what I term “traditional” neural network (NN)-based classification and so-called “zero-shot” (or “few shot”) classifiers that rely on <a href="https://arxiv.org/abs/1604.06737">embedding</a> semantically meaningful features as clusters in space by means of contrastive losses. These “zero-shot” (or “few shot”) or “contrastive loss” methods are <a href="https://app.dimensions.ai/analytics/publication/overview/timeline?search_mode=content&amp;search_text=%22contrastive%20loss%22&amp;search_type=kws&amp;search_field=full_search">increasingly prevalent in the literature</a>, and have the nice property that, unlike traditional ML classifiers, they <em>don’t need to be re-trained</em> whenever new classes are introduced. If we want to understand these embedding-based / zero-shot / contrastive loss methods, it will be helpful to first consider traditional classification <em>as an embedding method</em> of it own.</p>
<p>There is also a strong pedagogical point that I wish to make in this post. Often in teaching ML, many authors will spend some time on binary classification via logistic regression (see my post <a href="https://hedges.belmont.edu/naughty">“Naughty by Numbers: Classifications at Christmas”</a>) and then jump <em>immediately</em> into multi-class classification where the number of classes is 10, or 1000, or 1000 and up. There is an opportunity that is being passed over. The opportunity is <em>visualization</em>, and what is being passed over is the special case of <em>three</em> classes. (Or, as we’ll see, we can squeeze an extra 4th class.)</p>
</section>
<section id="viz-matters" class="level2">
<h2 class="anchored" data-anchor-id="viz-matters">Viz Matters</h2>
<p>Visualization is an important part of the teaching process as well as for researchers wanting to understand their data. Much of my own teaching work has involved building data visualization apps for students to use in learning acoustics, and seeing <a href="https://news.kaist.ac.kr/newsen/html/news/?skey=prof&amp;sval=Yang+Hann+Kim">Yang Hann Kim</a>’s speech when he received on <a href="https://www.eurekalert.org/pub_releases/2015-06/tkai-yhk060315.php">Rossing Prize in Acoustics Education</a> for his visualization efforts only further inspired me to continue developing such tools for students and instructors. (cf.&nbsp;<em>The Physics Teacher</em> featured my “Polar Pattern Plotter” app on the cover of its <a href="https://aapt.scitation.org/toc/pte/56/2">February 2018 issue</a>.)</p>
<p>Humans cannot visualize beyond 3 dimensions, so problems involving more than 3 semantic features invariably rely on projection methods such a Principal Component Analysis (see my blog post, <a href="https://drscotthawley.github.io/blog/2019/12/21/PCA-From-Scratch.html">“PCA from Scratch”</a>) or nonlinear embedding methods like t-SNE or UMAP. The problem with PCA is that projected data points tend to overlap, and with the latter methods twist and distort the space so much that the global structure is completely obfuscated. But in 3D the representations are <em>exact!</em></p>
<blockquote class="blockquote">
<p><em>Math point, for those who are interested: When we move from two classes to more than two, we typically switch from the logistic sigmoid activation and Binary Cross Entropy loss to softmax activation and Cross Entropy (~ K-L divergence) loss. Softmax contains more complexity than sigmoid (even if the latter is just two-class softmax with a coordinate transformation, and along each axis softmax acts like a sigmoid), yet for the case of 3 classes softmax contains all the complexity of higher numbers of classes, <strong>while still being visualizable</strong>.</em> <br></p>
</blockquote>
<p>We’re going to make use of a little code library I’m in the process of putting together called <a href="https://github.com/drscotthawley/mrspuff">mrspuff</a>! It’s geared toward teaching via visualization and running on <a href="https://colab.research.google.com">Google Colab</a>, and (increasingly, as I learn) built to work on &amp; with <a href="https://github.com/fastai/fastai">fast.ai</a>.</p>
<center>
<a href="https://github.com/drscotthawley/mrspuff"><img src="https://drscotthawley.github.io/blog/posts/https:/github.com/drscotthawley/mrspuff/raw/master/images/mrspuff_logo.png" width="60%"></a>
</center>
</section>
<section id="dimensions-and-embeddings" class="level2">
<h2 class="anchored" data-anchor-id="dimensions-and-embeddings">Dimensions and Embeddings</h2>
<p>People who are not mathematicians, physicists, data scientists, etc. may be unaccustomed to this talk of “dimensions” when dealing with data. Let’s dive in to the specific case of <em>three-class classification</em>. Say we’re developing a computer program to guess (“predict”) whether a given image contains a cat, a dog, or a horse. Traditionally the “ground truth” or “target” values are expressed as “one hot encoded” vectors, such as…</p>
<pre>   cat: (1,0,0)           dog: (0,1,0)         horse: (0,0,1)</pre>
<p>Then given an image of an animal, our neural network model will produce a set of 3 probabilities for each class, say…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np </span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mrspuff.viz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mrspuff.utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mrspuff.scrape <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pio</span>
<span id="cb1-6">pio.renderers.default <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cat'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dog'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horse'</span>]</span>
<span id="cb1-9">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>]])</span>
<span id="cb1-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb1-11">    image_and_bars(data[i], labels, CDH_SAMPLE_URLS[i]).show(config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'displayModeBar'</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>})</span>
<span id="cb1-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="eaa31567-8439-4e5e-897d-b64cab173d3a" class="plotly-graph-div" style="height:225px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eaa31567-8439-4e5e-897d-b64cab173d3a")) {                    Plotly.newPlot(                        "eaa31567-8439-4e5e-897d-b64cab173d3a",                        [{"marker":{"color":["red","green","blue"]},"x":["cat","dog","horse"],"y":[0.7,0.2,0.1],"type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"images":[{"sizex":1,"sizey":1,"source":"https:\u002f\u002fupload.wikimedia.org\u002fwikipedia\u002fcommons\u002fthumb\u002f4\u002f4f\u002fFelis_silvestris_catus_lying_on_rice_straw.jpg\u002f220px-Felis_silvestris_catus_lying_on_rice_straw.jpg","x":-0.2,"xanchor":"right","xref":"paper","y":0.5,"yanchor":"middle","yref":"paper"}],"margin":{"r":20,"l":275.0,"t":30,"b":20},"yaxis":{"range":[0,1]},"title":{"text":"Probabilities","y":0.9,"x":0.76,"xanchor":"center","yanchor":"bottom"},"autosize":false,"height":225,"width":500,"bargap":0.15,"bargroupgap":0.1,"barmode":"stack","hovermode":"x"},                        {"displayModeBar": false, "responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eaa31567-8439-4e5e-897d-b64cab173d3a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="e8a8e05c-2652-4f18-af27-ef6e6d739158" class="plotly-graph-div" style="height:225px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e8a8e05c-2652-4f18-af27-ef6e6d739158")) {                    Plotly.newPlot(                        "e8a8e05c-2652-4f18-af27-ef6e6d739158",                        [{"marker":{"color":["red","green","blue"]},"x":["cat","dog","horse"],"y":[0.15,0.6,0.25],"type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"images":[{"sizex":1,"sizey":1,"source":"https:\u002f\u002fupload.wikimedia.org\u002fwikipedia\u002fcommons\u002fe\u002fe3\u002fPerfect_Side_View_Of_Black_Labrador_North_East_England.JPG","x":-0.2,"xanchor":"right","xref":"paper","y":0.5,"yanchor":"middle","yref":"paper"}],"margin":{"r":20,"l":275.0,"t":30,"b":20},"yaxis":{"range":[0,1]},"title":{"text":"Probabilities","y":0.9,"x":0.76,"xanchor":"center","yanchor":"bottom"},"autosize":false,"height":225,"width":500,"bargap":0.15,"bargroupgap":0.1,"barmode":"stack","hovermode":"x"},                        {"displayModeBar": false, "responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e8a8e05c-2652-4f18-af27-ef6e6d739158');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="60ba7582-12a6-4170-a72c-57bc2fd9b009" class="plotly-graph-div" style="height:225px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("60ba7582-12a6-4170-a72c-57bc2fd9b009")) {                    Plotly.newPlot(                        "60ba7582-12a6-4170-a72c-57bc2fd9b009",                        [{"marker":{"color":["red","green","blue"]},"x":["cat","dog","horse"],"y":[0.05,0.15,0.8],"type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"images":[{"sizex":1,"sizey":1,"source":"https:\u002f\u002fupload.wikimedia.org\u002fwikipedia\u002fcommons\u002fthumb\u002fe\u002fea\u002fSilverMorgan.jpg\u002f250px-SilverMorgan.jpg","x":-0.2,"xanchor":"right","xref":"paper","y":0.5,"yanchor":"middle","yref":"paper"}],"margin":{"r":20,"l":275.0,"t":30,"b":20},"yaxis":{"range":[0,1]},"title":{"text":"Probabilities","y":0.9,"x":0.76,"xanchor":"center","yanchor":"bottom"},"autosize":false,"height":225,"width":500,"bargap":0.15,"bargroupgap":0.1,"barmode":"stack","hovermode":"x"},                        {"displayModeBar": false, "responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('60ba7582-12a6-4170-a72c-57bc2fd9b009');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>…the goal (of training the neural network model) is to get the predicted values to match up with the target values.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>we’ll be using image-based examples, but for everything you’ll see in these posts, similar methods have been applied to audio, text, and tabular data.</p>
</div>
</div>
<p>These numbers can be viewed as the strength of an attribute in an image, e.g.&nbsp;measures of cat-ness, dog-ness, and horse-ness (or measure of the likelihood of being a cat, dog, or horse, respectively), where a value of 1 means 100% of that property. Notice in each case, the three “class” probabilities add up to 1. This is always the case: probabilities always have to sum up to 1, i.e.&nbsp;1 is “100% certainty” that gets split among the 3 classes. (This summing to 1 is an important property that we’ll come back to in a bit.)</p>
<p>One thing that scientists like to do is take different variables and view them as <em>coordinates of a single point in a multi-dimensional space</em>. So for 3 classes we have 3 coordinates for 3 dimensions. We could make the “cat-ness” prediction probability be the “x” coordinate, and “dog-ness” be the “y” values, and “horse-ness” could be along the “z” axis. Then instead of drawing bar graphs, we could plot points in 3D space, where the coordinates of each point tell us the predictions:</p>
<p><em>All the 3D plots in this post can be rotated &amp; zoomed with the mouse or your finger. Try it!</em></p>
<div class="cell">
<div class="cell-output cell-output-display">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="13942d35-6be8-4b23-a330-405bab3a7e19" class="plotly-graph-div" style="height:525px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("13942d35-6be8-4b23-a330-405bab3a7e19")) {                    Plotly.newPlot(                        "13942d35-6be8-4b23-a330-405bab3a7e19",                        [{"marker":{"color":[[1.0,0.0,0.0],[0.0,1.0,0.0],[0.0,0.0,1.0],[0.7,0.2,0.1],[0.15,0.6,0.25],[0.05,0.15,0.8]],"opacity":0.6,"size":5},"mode":"markers","x":[1.0,0.0,0.0,0.7,0.15,0.05],"y":[0.0,1.0,0.0,0.2,0.6,0.15],"z":[0.0,0.0,1.0,0.1,0.25,0.8],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"margin":{"r":20,"b":10,"l":10,"t":0},"scene":{"xaxis":{"title":{"text":"cat - ness"}},"yaxis":{"title":{"text":"dog - ness"}},"zaxis":{"title":{"text":"horse - ness"}},"annotations":[{"text":"cat","x":1.0,"xanchor":"center","y":0.0,"z":0.0},{"text":"dog","x":0.0,"xanchor":"center","y":1.0,"z":0.0},{"text":"horse","x":0.0,"xanchor":"center","y":0.0,"z":1.0}]},"width":700,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('13942d35-6be8-4b23-a330-405bab3a7e19');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>(Here we also used the 3 class probabilities to set the R,G,B color values of the points. There’s no new information contained in this; it just looks cool.)</p>
<p>What scientists tend to do is, even in cases where there are more then 3 variables (say, 10), we regard these as dimensions in some fancy abstract mathematical space where the laws may or may not conform to those of our universe – for example, the idea of “distance” may be totally up for grabs. In cases where the number of values is infinite (say, as coefficients in a infinite series, or as a function of a continuous variable) we might even work in <em>infinite</em> dimensions! Often when we talk like this, it doesn’t mean that we’re actually picturing geometrical spaces in our heads – we can’t, for anything beyond 3 dimensions – but it’s a handy way of encapsulating a particular way of viewing the data or functions involved. And sometimes we <em>do</em> try to see what kinds of geometrical insights we can glean – which is what we’re going to do here!</p>
<p>Remember when we said that the individual class probabilities have to add up to 1? Look what happens when we plot a <em>lot</em> of such points…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">prob, targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_prob(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb3-2">TrianglePlot3D_Plotly(prob, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>).do_plot()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="67477139-71fa-4505-9589-8a3714b1f7c2" class="plotly-graph-div" style="height:525px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("67477139-71fa-4505-9589-8a3714b1f7c2")) {                    Plotly.newPlot(                        "67477139-71fa-4505-9589-8a3714b1f7c2",                        [{"marker":{"color":[[1.0,0.0,0.0],[0.0,1.0,0.0],[0.0,0.0,1.0],[0.11087444611850987,0.3409300897091717,0.5481954641723185],[0.12137606261023932,0.5861637867552141,0.2924601506345466],[0.011995587876667881,0.024158116263293873,0.9638462958600383],[0.874738360785139,0.07960409141505488,0.0456575477998062],[0.7475297845873572,0.2014435668481134,0.051026648564529424],[0.032187543641063084,0.08163390968524488,0.8861785466736921],[0.23445288510250253,0.5738765725170176,0.19167054238047995],[0.34198012229930663,0.06809245279265047,0.5899274249080428],[0.031913269751871934,0.5581018598805536,0.40998487036757447],[0.03453953762883764,0.5069446755965114,0.45851578677465094],[0.7104609140589137,0.27744712882063577,0.012091957120450606],[0.6760628856684605,0.1273841186784779,0.1965529956530616],[0.08982834522483304,0.3448973081084529,0.5652743466667141],[0.3481640730606804,0.5529420588782186,0.09889386806110091],[0.9053247729513771,0.0858170297636688,0.008858197284954038],[0.09197212912262046,0.8265449348073306,0.08148293607004892],[0.7822716251729558,0.19382213748425617,0.02390623734278802],[0.25560019314622845,0.11190168281970993,0.6324981240340616],[0.9252060948731571,0.026611366155797886,0.04818253897104506],[0.1418089349165547,0.03634832877928678,0.8218427363041585],[0.16948349105562907,0.15144084275486758,0.6790756661895033],[0.41648389397624963,0.013258171184324518,0.5702579348394259],[0.23509281664856718,0.7159151960896569,0.048991987261775866],[0.9328886388595966,0.03656123719418844,0.030550123946214765],[0.05186641433174604,0.2822249111830161,0.6659086744852378],[0.37878483583075107,0.4406526035488458,0.1805625606204032],[0.684940331170667,0.26178405384353687,0.0532756149857963],[0.11916408961626505,0.7028710605510945,0.17796484983264038],[0.8240645824518738,0.06836930936933182,0.10756610817879445],[0.13745051971381322,0.06687162391822443,0.7956778563679624],[0.7980018703422587,0.15183861095304044,0.05015951870470075],[0.5767361328648142,0.15327880709496072,0.269985060040225],[0.6752425237744674,0.2716251516242655,0.05313232460126716],[0.1054981417656628,0.3380178161141655,0.5564840421201718],[0.272335976625514,0.008775733543038126,0.7188882898314479],[0.20772807169644344,0.10114068676866028,0.6911312415348962],[0.017591100659084424,0.9723382659265355,0.010070633414380118],[0.08729262702064076,0.2199376212901974,0.6927697516891618],[0.49382637084598663,0.2550823246747832,0.25109130447923034],[0.2139737216865069,0.01864117435018208,0.767385103963311],[0.6832765562262268,0.09160083633785215,0.22512260743592094],[0.014889693762845357,0.7843018710650013,0.20080843517215347],[0.06782510361715002,0.4738761558386092,0.45829874054424075],[0.02547916838809994,0.008311845497222359,0.9662089861146778],[0.059773922096766685,0.899116829367356,0.041109248535877295],[0.013351608680490859,0.02527951733201509,0.9613688739874942],[0.030791470547630977,0.3615499472042121,0.6076585822481569],[0.019965256991807658,0.06769635058094764,0.9123383924272448],[0.6663606511329295,0.12624680989269693,0.20739253897437346],[0.8010835270042209,0.09714060898026096,0.10177586401551808],[0.4160232402457245,0.23408184999243808,0.34989490976183746],[0.5901203980292316,0.0558051854847818,0.35407441648598664],[0.2855785545570601,0.008063769660225883,0.706357675782714],[0.04107296390548315,0.04332726668503533,0.9155997694094815],[0.4533818533691966,0.5306917747677007,0.01592637186310263],[0.009760553870607008,0.9777474025992018,0.012492043530191073],[0.653294437212728,0.07245149117515318,0.2742540716121188],[0.23466471866493427,0.5725250538874993,0.19281022744756635],[0.17658119414440673,0.016651669624560096,0.8067671362310332],[0.3352345002617187,0.316234961763377,0.34853053797490435],[0.10621382839494538,0.5705569869879304,0.32322918461712413],[0.08135717707939512,0.5815797816019254,0.33706304131867953],[0.8609808360595599,0.1093033407167849,0.02971582322365508],[0.12598856753185733,0.7070434216948761,0.16696801077326648],[0.043224984887314404,0.7086524937224473,0.24812252139023822],[0.04808335816127273,0.7003907352054706,0.2515259066332566],[0.3919355759509596,0.5097255018303785,0.09833892221866182],[0.38665892497195525,0.19179714469020454,0.4215439303378402],[0.4550843709737628,0.5347423885180757,0.010173240508161562],[0.059253034814458067,0.8730716852599687,0.06767527992557335],[0.32854240358397274,0.0511406499518226,0.6203169464642047],[0.28434526789946774,0.39740472106548763,0.3182500110350446],[0.20266704942548677,0.6742591968980319,0.12307375367648128],[0.29190185394987017,0.04840894504306726,0.6596892010070625],[0.8286587041049289,0.033194981527782726,0.1381463143672884],[0.29837397233185947,0.6848855698959045,0.01674045777223601],[0.01594599751659127,0.49539568046619775,0.4886583220172111],[0.3918289792104823,0.42315721441882437,0.18501380637069317],[0.037849830221325,0.8884445139313767,0.07370565584729837],[0.042549169821250926,0.3715752479622832,0.5858755822164659],[0.718930719099962,0.13151425757869492,0.14955502332134307],[0.47302730679420824,0.22369488833086504,0.30327780487492667],[0.972589769739215,0.01672637313095293,0.010683857129832075],[0.2733104819293519,0.6066500014849351,0.12003951658571294],[0.12035744195773236,0.7000231597847438,0.17961939825752377],[0.22592005792694295,0.7335937478319824,0.04048619424107459],[0.33436689284826765,0.1987846456843847,0.4668484614673476],[0.05739800557443345,0.5702070718735748,0.3723949225519917],[0.18759836401014698,0.032181030482527136,0.7802206055073257],[0.0470514599654225,0.2495460705270557,0.7034024695075217],[0.7248870020771208,0.25242552902812154,0.022687468894757593],[0.19417492526109742,0.14635027743834703,0.6594747973005555],[0.23663754147086868,0.033458651433669925,0.7299038070954614],[0.09281343289282618,0.7941489328903341,0.11303763421683978],[0.8280215510786615,0.009756817269731648,0.16222163165160688],[0.28565510955802825,0.33640785176937327,0.37793703867259854],[0.6654388828157796,0.05899261336493724,0.2755685038192832],[0.06860957482320429,0.6064490972951119,0.32494132788168384],[0.1776871059457116,0.7968308793300288,0.025482014724259656],[0.4366241138795705,0.08545705165223696,0.47791883446819244],[0.033696783013771214,0.9205501157494772,0.045753101236751456],[0.0210365504259945,0.9710377840881507,0.007925665485854827],[0.04154093795409048,0.08795767427554534,0.8705013877703643],[0.018565116225192926,0.1226277414806817,0.8588071422941252],[0.5443573339721626,0.22257676470114549,0.23306590132669197],[0.9470364484225613,0.012337192711227943,0.040626358866210764],[0.7538494914055729,0.14803051595937972,0.09811999263504732],[0.03013860780888553,0.7989965808473238,0.17086481134379053],[0.12603410270548415,0.3852138461925833,0.4887520511019326],[0.24590125353531578,0.42079115132545686,0.3333075951392275],[0.5089850473416137,0.30532555374724746,0.185689398911139],[0.025331337035936298,0.007453454928253716,0.96721520803581],[0.19327927303456738,0.7953298946431804,0.011390832322252235],[0.4005196689201137,0.023256726158657936,0.5762236049212283],[0.4213443925968353,0.554887415719022,0.023768191684142594],[0.8422814474064355,0.13435423192653329,0.023364320667031292],[0.43349323153047115,0.5444920826591365,0.022014685810392353],[0.20754653547784788,0.572349439566942,0.22010402495521017],[0.45739409850067103,0.15871090822378195,0.38389499327554705],[0.00833776498390144,0.3809493860095756,0.6107128490065229],[0.5166266935670677,0.394159990691662,0.08921331574127027],[0.18227939912322524,0.08765106327984815,0.7300695375969267],[0.23171790447678423,0.24220881849736042,0.5260732770258554],[0.690214905084086,0.11325743305167199,0.196527661864242],[0.9283293991699096,0.021451650088008613,0.05021895074208171],[0.7417196785226242,0.2503608005184236,0.00791952095895223],[0.48590824784780584,0.0461303805946849,0.46796137155750916],[0.2237005370086403,0.15784789228254006,0.6184515707088197],[0.07342274964804017,0.810972428472828,0.11560482187913172],[0.06893295039477243,0.6603358612029041,0.27073118840232346],[0.12065694345496568,0.010858920218409743,0.8684841363266246],[0.5631436688296863,0.3791675130317606,0.05768881813855305],[0.5531952777471251,0.3622487895947758,0.08455593265809917],[0.1868904398499111,0.6535862871141157,0.15952327303597322],[0.9540061316546468,0.03157075295974758,0.014423115385605674],[0.39551502828338025,0.39226436538365705,0.2122206063329626],[0.20401244406448413,0.6215180214382555,0.1744695344972603],[0.8055810212778339,0.047742632914796954,0.14667634580736905],[0.08953483424925443,0.7354056925291076,0.17505947322163787],[0.03676853565828598,0.9149758857128547,0.04825557862885938],[0.5451058565990774,0.007651131495894242,0.4472430119050284],[0.7324037960780253,0.090314085901701,0.17728211802027366],[0.14934597887313247,0.841495358673543,0.009158662453324591],[0.17923208584270992,0.6636222896220291,0.15714562453526104],[0.6186039639729233,0.22249815432695488,0.15889788170012192],[0.023976168075640958,0.7761428156950978,0.19988101622926127],[0.16409610746021663,0.01459036222658968,0.8213135303131937],[0.07998133543536046,0.05335716508153868,0.8666614994831008],[0.2067902073032566,0.05330387872337892,0.7399059139733645],[0.2969618003240617,0.6007879338400214,0.10225026583591693],[0.36010115572671825,0.019563473644129855,0.6203353706291519],[0.05826863548449201,0.8682318336604815,0.07349953085502661],[0.2601849485714544,0.2221722116570457,0.5176428397714998],[0.899239100278732,0.05598979639326303,0.0447711033280049],[0.15779484728768214,0.6512143355700527,0.1909908171422651],[0.01056474065031126,0.4576590438932671,0.5317762154564216],[0.06362219579383567,0.01798923601085156,0.9183885681953127],[0.2658850460990658,0.03889142219867676,0.6952235317022575],[0.15343894403139957,0.7344474546265,0.1121136013421004],[0.7213958760281715,0.12372005851822407,0.15488406545360447],[0.04979743458087942,0.8364201694991281,0.11378239591999265],[0.06982705804867038,0.41696903150046427,0.5132039104508654],[0.1748533980760058,0.36963667499546604,0.45550992692852826],[0.9391029154691531,0.021856096872214275,0.0390409876586327],[0.6714785644265214,0.2782690283503469,0.05025240722313164],[0.5723450554138797,0.19359994290190857,0.2340550016842118],[0.2913918048719022,0.04962522691307845,0.6589829682150193],[0.8632188946855931,0.02617501141766433,0.11060609389674249],[0.14303997576088573,0.28323098061077023,0.573729043628344],[0.10910645624443391,0.48098144596633075,0.4099120977892354],[0.19500681270726403,0.5891501121151663,0.21584307517756968],[0.13852271566131694,0.10724300586861056,0.7542342784700726],[0.008204248777687955,0.8456484915010277,0.1461472597212843],[0.40611639861473453,0.5433658453144782,0.05051775607078715],[0.8676638833467727,0.042514550362398505,0.08982156629082881],[0.09806435734767148,0.11405239870608408,0.7878832439462443],[0.06493647616605248,0.39936831371541337,0.5356952101185342],[0.24582326019074285,0.20439578761351462,0.5497809521957425],[0.06692832085483284,0.05026997209277358,0.8828017070523937],[0.012253963931982637,0.3227090564847182,0.6650369795832992],[0.9015408366300122,0.08235676129716155,0.01610240207282634],[0.11509656053055203,0.03661198787841078,0.8482914515910372],[0.012490639572334922,0.711875551842374,0.27563380858529096],[0.7249150185900635,0.025816279944439923,0.24926870146549643],[0.17652073434229368,0.17812309925644706,0.6453561664012593],[0.3203172143910015,0.4101955054363322,0.2694872801726662],[0.249364391168208,0.039402650482999776,0.7112329583487922],[0.019208378850216187,0.9502873141789459,0.030504306970838],[0.37855607332193814,0.5463004766598949,0.07514345001816698],[0.4378420189571786,0.4375161597492879,0.12464182129353342],[0.02096290647949737,0.8821640329260189,0.09687306059448378],[0.19666681660026278,0.0156929316767384,0.7876402517229989],[0.1770757536346735,0.686344978150664,0.13657926821466249],[0.1360865312772067,0.015017556579803248,0.8488959121429901],[0.10372505739551739,0.566906253147977,0.32936868945650555],[0.15638512104498,0.7913542518389132,0.05226062711610692],[0.5473892040800676,0.39573034438019367,0.05688045153973871],[0.010575912940361223,0.6807386252182894,0.30868546184134943],[0.3234038442364814,0.6358145207303937,0.040781635033124854],[0.011812559930757272,0.30100367201091965,0.6871837680583232],[0.03219942374453054,0.7578576355028397,0.20994294075262984],[0.10974991806182048,0.741908924198279,0.14834115773990045],[0.7217317049749489,0.09209465368616855,0.18617364133888262],[0.03307842761494553,0.944631562034261,0.022290010350793463],[0.26319003699019566,0.2601722051158374,0.47663775789396695],[0.5744965871779188,0.20594010654886463,0.21956330627321652],[0.9508547245071453,0.03693348925186926,0.01221178624098555],[0.925086435864057,0.036075353587643355,0.038838210548299716],[0.193429137634676,0.6607621568138026,0.14580870555152134],[0.39515550216049394,0.563736694498386,0.041107803341119936],[0.05783950663128046,0.8957549734450496,0.04640551992366995],[0.08157695991958035,0.7576563905096024,0.1607666495708172],[0.2029310789774172,0.11829840679396228,0.6787705142286204],[0.02758825418197007,0.8098228826707401,0.16258886314728976],[0.07479537734044013,0.3743360261213312,0.5508685965382286],[0.7921203388637735,0.18312151667234747,0.024758144463879077],[0.026356016455272427,0.5131161678928233,0.4605278156519043],[0.5948683679523608,0.1296178436064851,0.2755137884411542],[0.17613797617661453,0.06755002673934915,0.7563119970840363],[0.8386199852053398,0.01911351290325771,0.1422665018914025],[0.15669879633043413,0.692442198778378,0.15085900489118775],[0.6969259598018396,0.1881250988485758,0.11494894134958465],[0.4608494653155968,0.4944574736217005,0.04469306106270261],[0.7404211101076893,0.09854468013226259,0.16103420976004826],[0.31449414783150287,0.10206365535113333,0.5834421968173638],[0.30913855075990904,0.3840210465016116,0.3068404027384795],[0.8527011328351376,0.04810089463757706,0.09919797252728538],[0.06156005455802543,0.15544236018949756,0.7829975852524771],[0.4358744785791394,0.016487079941705472,0.5476384414791551],[0.36099273405737997,0.4323905285596845,0.20661673738293557],[0.9411077266914858,0.02992181465829592,0.028970458650218498],[0.42640118948253136,0.03928840942938995,0.5343104010880787],[0.4498106268350037,0.3364449345023147,0.21374443866268156],[0.2698650465723529,0.6765705345062526,0.0535644189213946],[0.042135626502444,0.8009574824924961,0.15690689100505992],[0.3459620381304495,0.5331106972247973,0.1209272646447532],[0.34972795208098784,0.03237821181973746,0.6178938360992747],[0.006886903534331193,0.2815323110446161,0.7115807854210527],[0.316154751589768,0.29526294611850434,0.3885823022917276],[0.30472624107407653,0.2823213352268805,0.41295242369904284],[0.3643620920236348,0.6306540784158918,0.004983829560473452],[0.04862167246432664,0.9254059485212592,0.025972379014414224],[0.20280522083297856,0.13579317586329773,0.6614016033037238],[0.1975207529616076,0.7682355692541257,0.03424367778426686],[0.7375639557278455,0.047615132691110416,0.21482091158104413],[0.3427755060069151,0.11021459716938917,0.5470098968236957],[0.10177732813843669,0.6200089848121217,0.2782136870494415],[0.008311741730699167,0.8777911928201272,0.11389706544917351],[0.08127457012074907,0.41619538327857913,0.5025300466006718],[0.8730695062250488,0.03735657447565048,0.08957391929930081],[0.716084279914907,0.2375864660752468,0.046329254009846166],[0.45492998358071673,0.45842807018548426,0.08664194623379903],[0.2370868816165861,0.6842440238894144,0.07866909449399952],[0.7082729093306449,0.10004674096999337,0.19168034969936162],[0.061905825859104216,0.5537170583819393,0.3843771157589565],[0.023210248687132774,0.455214826788985,0.5215749245238821],[0.7083213893182913,0.13550874176323582,0.1561698689184729],[0.29023298379554824,0.4671176688366591,0.24264934736779262],[0.3391994615503471,0.39330055096111,0.2674999874885429],[0.08649303831944717,0.16971066392323822,0.7437962977573146],[0.24691013802442843,0.7108281139261758,0.04226174804939561],[0.05160856325126911,0.9257588463501238,0.022632590398606982],[0.5262788430053034,0.2442451167099481,0.22947604028474838],[0.3238701251717705,0.1994287056118789,0.4767011692163506],[0.636394017819674,0.29238905824657463,0.07121692393375141],[0.027572236430601957,0.508051237698945,0.464376525870453],[0.03188082566892901,0.714055159277834,0.25406401505323706],[0.5968779529402604,0.023786186385953305,0.37933586067378644],[0.02185791574874514,0.9628217836270112,0.015320300624243754],[0.046577870365514584,0.9253070080926771,0.028115121541808313],[0.5114601616442264,0.04224444764026329,0.4462953907155104],[0.033019029781832215,0.19148092691931193,0.7755000432988558],[0.9337299983257499,0.0239990169932642,0.042270984680985974],[0.270684822920584,0.10949933595364976,0.6198158411257662],[0.4546539037494041,0.08885884190331982,0.4564872543472761],[0.026245519453948683,0.9524630558533242,0.021291424692727087],[0.08812894490343276,0.11021296232331794,0.8016580927732493],[0.13470983963675295,0.6413244235605641,0.22396573680268292],[0.008815069561855883,0.9480841507054563,0.04310077973268804],[0.0728255661973169,0.07558354812782249,0.8515908856748606],[0.08474998147301308,0.872460661752964,0.04278935677402298],[0.14720971929933185,0.7048292743578036,0.14796100634286455],[0.056986951797083255,0.9274792634057009,0.015533784797216002],[0.39858526774659253,0.30730255189734373,0.2941121803560637],[0.7808628217141423,0.014531358103545954,0.20460582018231174],[0.08465913472296849,0.10321649840830233,0.8121243668687291],[0.05371046360427353,0.3155407831668459,0.6307487532288806],[0.44152671031912266,0.15724503097762796,0.4012282587032493],[0.8095502639507012,0.17643464550333976,0.014015090545959102],[0.2813569921995966,0.673757496697623,0.04488551110278052],[0.7163510397728395,0.14754737027987244,0.13610158994728805],[0.4650960536224381,0.007392073972834606,0.5275118724047273],[0.4508358438647673,0.2099530644327433,0.3392110917024892],[0.45171678043762015,0.46783083800031566,0.08045238156206437],[0.029910343155298922,0.7543277929935004,0.21576186385120083],[0.48503458088711854,0.2762115676675281,0.23875385144535338],[0.3591343810090356,0.029321311260095972,0.6115443077308684],[0.18276549572327003,0.5079583099787766,0.3092761942979535],[0.25920767648865095,0.12063887711797817,0.6201534463933709],[0.5104674231489946,0.06804866449349412,0.4214839123575113],[0.5868835444579048,0.3647034040349672,0.048413051507127935],[0.03255323188209424,0.5153107177890048,0.45213605032890086],[0.07200025623614333,0.03425955417445806,0.8937401895893986],[0.8203570659905344,0.11968036041934628,0.059962573590119195],[0.10596148788900722,0.7988047063864855,0.09523380572450729],[0.5194747998340851,0.03769548587999423,0.4428297142859208],[0.2311781241148482,0.012662460691223527,0.7561594151939283],[0.475854198301692,0.5094366655219527,0.014709136176355306],[0.023764036914323432,0.5232106382420615,0.45302532484361496],[0.5173927398878883,0.11734360100398937,0.3652636591081224],[0.05605170479867204,0.6839895086873893,0.2599587865139387],[0.7366165072238705,0.23861874693354818,0.02476474584258136],[0.07081979345021314,0.010894882257048074,0.9182853242927388],[0.1299663851151134,0.5827460513573378,0.2872875635275487],[0.19194017787226977,0.6915818423911961,0.11647797973653409],[0.3316741879449069,0.6436104702233711,0.02471534183172199],[0.2512690759885759,0.2706432562987842,0.4780876677126398],[0.8340522709172964,0.024670152683738625,0.14127757639896488],[0.16921276785801873,0.7401638292137328,0.09062340292824843],[0.7013642923833247,0.05907207126521339,0.2395636363514619],[0.01218537327530503,0.9608401198830223,0.026974506841672692],[0.4922825726213558,0.49281090973326097,0.014906517645383213],[0.21755889869036715,0.024959756788373526,0.7574813445212593],[0.13627380477828557,0.768049151276782,0.09567704394493236],[0.3268564810955138,0.31356780255897154,0.3595757163455147],[0.2593125891936485,0.7175525202437153,0.023134890562636234],[0.3266902515625065,0.43586745697118817,0.23744229146630538],[0.6056075036993538,0.29605159526238206,0.09834090103826403],[0.13576232683444625,0.8052133396472292,0.05902433351832456],[0.6353237330392473,0.0286145910914561,0.33606167586929664],[0.03322623920822832,0.9290082996477294,0.037765461144042174],[0.8800420854814139,0.06424242185021359,0.05571549266837229],[0.8925952616251975,0.06251805497733852,0.044886683397464114],[0.8317009681530799,0.13411608631115968,0.034182945535760526],[0.02853226790197036,0.9182434592170668,0.053224272880962764],[0.7347170193763587,0.010480407137194715,0.2548025734864467],[0.7011145270899071,0.20608099694880247,0.0928044759612905],[0.7592577912321381,0.07262799252333024,0.16811421624453163],[0.09865523890937229,0.7950047536000505,0.10634000749057725],[0.2944899069008691,0.06568744615388407,0.6398226469452468],[0.8239102839792671,0.03155549512619275,0.1445342208945401],[0.023454057244590834,0.03084375429534722,0.9457021884600619],[0.8144400257122304,0.05179147300868745,0.1337685012790823],[0.5564568039160681,0.1455210906255521,0.2980221054583797],[0.9702248695135204,0.01341737036107617,0.016357760125403506],[0.5965358184194983,0.07866661888252217,0.3247975626979794],[0.028627555592116265,0.771971978703074,0.19940046570480977],[0.4656569882611679,0.0582822629812802,0.476060748757552],[0.8237389373481564,0.07491806771385057,0.10134299493799302],[0.1188434260204549,0.039936865708173876,0.8412197082713713],[0.775552078220566,0.05224271916463621,0.17220520261479771],[0.42348861525449394,0.3854621641281027,0.1910492206174033],[0.03418156840451178,0.897054195250922,0.0687642363445663],[0.05510622021298805,0.1553067644042648,0.7895870153827472],[0.1567842559493414,0.4764939014788845,0.36672184257177415],[0.007791772268557743,0.9379943203557379,0.054213907375704314],[0.1436309775416373,0.2095359538747212,0.6468330685836414],[0.276515037717443,0.36085259668177916,0.3626323656007778],[0.10153212105081232,0.8455672751573434,0.05290060379184431],[0.5092481736316845,0.4591014048119269,0.03165042155638868],[0.025982566319444064,0.9618236888860144,0.01219374479454155],[0.314043703354124,0.583623009177491,0.10233328746838488],[0.704780260736938,0.2537123256756495,0.041507413587412396],[0.551093109770942,0.3724792889059505,0.07642760132310746],[0.024040710486759778,0.6552672895304685,0.3206919999827717],[0.05459991910071983,0.28420806408032273,0.6611920168189575],[0.2931785270283363,0.2604150875272711,0.44640638544439254],[0.6209948667262972,0.3724624828738691,0.006542650399833623],[0.9281751785195109,0.015827163593211693,0.05599765788727733],[0.8701337605899596,0.044674867194669225,0.08519137221537122],[0.2911286125028612,0.6781312573944602,0.030740130102678575],[0.47879408402363166,0.04874530726770317,0.4724606087086653],[0.06658855410067738,0.8959726068281558,0.037438839071166886],[0.12961026388748245,0.2018297526701912,0.6685599834423265],[0.08678850312002763,0.028101527509040884,0.8851099693709316],[0.2511009138178387,0.27428721709182924,0.4746118690903321],[0.9577266433446154,0.010323359819915858,0.03194999683546871],[0.8146177407375826,0.03265668132314137,0.15272557793927594],[0.17034167938168526,0.8156727065717483,0.013985614046566428],[0.4442980277660393,0.20152523503680927,0.3541767371971515],[0.4836398906575668,0.3187739643128915,0.19758614502954172],[0.09657794480488881,0.09447727552750049,0.8089447796676107],[0.026040665234492905,0.7956519689369818,0.1783073658285254],[0.08946202387248697,0.46300682038287233,0.44753115574464064],[0.342212510051669,0.4153766309043888,0.24241085904394208],[0.3209388393909775,0.06887724769392256,0.6101839129151],[0.8675748287099061,0.05074187213675351,0.08168329915334038],[0.2302998585832399,0.3033162833649669,0.46638385805179317],[0.04689083176801221,0.2365882202609109,0.7165209479710769],[0.12066247382599252,0.8069141772664805,0.07242334890752702],[0.8334876309270297,0.15032411993727196,0.0161882491356984],[0.07556795578603798,0.6592130924244531,0.2652189517895089],[0.4923678093622984,0.046890212196525886,0.46074197844117576],[0.470811074357526,0.07942982255307367,0.44975910308940026],[0.7000972813494284,0.06872626396107293,0.23117645468949868],[0.23822624803059675,0.5094146153172247,0.2523591366521786],[0.9034034655136226,0.03635826351682382,0.0602382709695536],[0.1337049924437743,0.010873784615872758,0.8554212229403529],[0.025138805203665838,0.9276670305306681,0.04719416426566607],[0.7329090983996478,0.012506480450239506,0.2545844211501128]],"opacity":0.6,"size":5},"mode":"markers","x":[1.0,0.0,0.0,0.11087444611850987,0.12137606261023932,0.011995587876667881,0.874738360785139,0.7475297845873572,0.032187543641063084,0.23445288510250253,0.34198012229930663,0.031913269751871934,0.03453953762883764,0.7104609140589137,0.6760628856684605,0.08982834522483304,0.3481640730606804,0.9053247729513771,0.09197212912262046,0.7822716251729558,0.25560019314622845,0.9252060948731571,0.1418089349165547,0.16948349105562907,0.41648389397624963,0.23509281664856718,0.9328886388595966,0.05186641433174604,0.37878483583075107,0.684940331170667,0.11916408961626505,0.8240645824518738,0.13745051971381322,0.7980018703422587,0.5767361328648142,0.6752425237744674,0.1054981417656628,0.272335976625514,0.20772807169644344,0.017591100659084424,0.08729262702064076,0.49382637084598663,0.2139737216865069,0.6832765562262268,0.014889693762845357,0.06782510361715002,0.02547916838809994,0.059773922096766685,0.013351608680490859,0.030791470547630977,0.019965256991807658,0.6663606511329295,0.8010835270042209,0.4160232402457245,0.5901203980292316,0.2855785545570601,0.04107296390548315,0.4533818533691966,0.009760553870607008,0.653294437212728,0.23466471866493427,0.17658119414440673,0.3352345002617187,0.10621382839494538,0.08135717707939512,0.8609808360595599,0.12598856753185733,0.043224984887314404,0.04808335816127273,0.3919355759509596,0.38665892497195525,0.4550843709737628,0.059253034814458067,0.32854240358397274,0.28434526789946774,0.20266704942548677,0.29190185394987017,0.8286587041049289,0.29837397233185947,0.01594599751659127,0.3918289792104823,0.037849830221325,0.042549169821250926,0.718930719099962,0.47302730679420824,0.972589769739215,0.2733104819293519,0.12035744195773236,0.22592005792694295,0.33436689284826765,0.05739800557443345,0.18759836401014698,0.0470514599654225,0.7248870020771208,0.19417492526109742,0.23663754147086868,0.09281343289282618,0.8280215510786615,0.28565510955802825,0.6654388828157796,0.06860957482320429,0.1776871059457116,0.4366241138795705,0.033696783013771214,0.0210365504259945,0.04154093795409048,0.018565116225192926,0.5443573339721626,0.9470364484225613,0.7538494914055729,0.03013860780888553,0.12603410270548415,0.24590125353531578,0.5089850473416137,0.025331337035936298,0.19327927303456738,0.4005196689201137,0.4213443925968353,0.8422814474064355,0.43349323153047115,0.20754653547784788,0.45739409850067103,0.00833776498390144,0.5166266935670677,0.18227939912322524,0.23171790447678423,0.690214905084086,0.9283293991699096,0.7417196785226242,0.48590824784780584,0.2237005370086403,0.07342274964804017,0.06893295039477243,0.12065694345496568,0.5631436688296863,0.5531952777471251,0.1868904398499111,0.9540061316546468,0.39551502828338025,0.20401244406448413,0.8055810212778339,0.08953483424925443,0.03676853565828598,0.5451058565990774,0.7324037960780253,0.14934597887313247,0.17923208584270992,0.6186039639729233,0.023976168075640958,0.16409610746021663,0.07998133543536046,0.2067902073032566,0.2969618003240617,0.36010115572671825,0.05826863548449201,0.2601849485714544,0.899239100278732,0.15779484728768214,0.01056474065031126,0.06362219579383567,0.2658850460990658,0.15343894403139957,0.7213958760281715,0.04979743458087942,0.06982705804867038,0.1748533980760058,0.9391029154691531,0.6714785644265214,0.5723450554138797,0.2913918048719022,0.8632188946855931,0.14303997576088573,0.10910645624443391,0.19500681270726403,0.13852271566131694,0.008204248777687955,0.40611639861473453,0.8676638833467727,0.09806435734767148,0.06493647616605248,0.24582326019074285,0.06692832085483284,0.012253963931982637,0.9015408366300122,0.11509656053055203,0.012490639572334922,0.7249150185900635,0.17652073434229368,0.3203172143910015,0.249364391168208,0.019208378850216187,0.37855607332193814,0.4378420189571786,0.02096290647949737,0.19666681660026278,0.1770757536346735,0.1360865312772067,0.10372505739551739,0.15638512104498,0.5473892040800676,0.010575912940361223,0.3234038442364814,0.011812559930757272,0.03219942374453054,0.10974991806182048,0.7217317049749489,0.03307842761494553,0.26319003699019566,0.5744965871779188,0.9508547245071453,0.925086435864057,0.193429137634676,0.39515550216049394,0.05783950663128046,0.08157695991958035,0.2029310789774172,0.02758825418197007,0.07479537734044013,0.7921203388637735,0.026356016455272427,0.5948683679523608,0.17613797617661453,0.8386199852053398,0.15669879633043413,0.6969259598018396,0.4608494653155968,0.7404211101076893,0.31449414783150287,0.30913855075990904,0.8527011328351376,0.06156005455802543,0.4358744785791394,0.36099273405737997,0.9411077266914858,0.42640118948253136,0.4498106268350037,0.2698650465723529,0.042135626502444,0.3459620381304495,0.34972795208098784,0.006886903534331193,0.316154751589768,0.30472624107407653,0.3643620920236348,0.04862167246432664,0.20280522083297856,0.1975207529616076,0.7375639557278455,0.3427755060069151,0.10177732813843669,0.008311741730699167,0.08127457012074907,0.8730695062250488,0.716084279914907,0.45492998358071673,0.2370868816165861,0.7082729093306449,0.061905825859104216,0.023210248687132774,0.7083213893182913,0.29023298379554824,0.3391994615503471,0.08649303831944717,0.24691013802442843,0.05160856325126911,0.5262788430053034,0.3238701251717705,0.636394017819674,0.027572236430601957,0.03188082566892901,0.5968779529402604,0.02185791574874514,0.046577870365514584,0.5114601616442264,0.033019029781832215,0.9337299983257499,0.270684822920584,0.4546539037494041,0.026245519453948683,0.08812894490343276,0.13470983963675295,0.008815069561855883,0.0728255661973169,0.08474998147301308,0.14720971929933185,0.056986951797083255,0.39858526774659253,0.7808628217141423,0.08465913472296849,0.05371046360427353,0.44152671031912266,0.8095502639507012,0.2813569921995966,0.7163510397728395,0.4650960536224381,0.4508358438647673,0.45171678043762015,0.029910343155298922,0.48503458088711854,0.3591343810090356,0.18276549572327003,0.25920767648865095,0.5104674231489946,0.5868835444579048,0.03255323188209424,0.07200025623614333,0.8203570659905344,0.10596148788900722,0.5194747998340851,0.2311781241148482,0.475854198301692,0.023764036914323432,0.5173927398878883,0.05605170479867204,0.7366165072238705,0.07081979345021314,0.1299663851151134,0.19194017787226977,0.3316741879449069,0.2512690759885759,0.8340522709172964,0.16921276785801873,0.7013642923833247,0.01218537327530503,0.4922825726213558,0.21755889869036715,0.13627380477828557,0.3268564810955138,0.2593125891936485,0.3266902515625065,0.6056075036993538,0.13576232683444625,0.6353237330392473,0.03322623920822832,0.8800420854814139,0.8925952616251975,0.8317009681530799,0.02853226790197036,0.7347170193763587,0.7011145270899071,0.7592577912321381,0.09865523890937229,0.2944899069008691,0.8239102839792671,0.023454057244590834,0.8144400257122304,0.5564568039160681,0.9702248695135204,0.5965358184194983,0.028627555592116265,0.4656569882611679,0.8237389373481564,0.1188434260204549,0.775552078220566,0.42348861525449394,0.03418156840451178,0.05510622021298805,0.1567842559493414,0.007791772268557743,0.1436309775416373,0.276515037717443,0.10153212105081232,0.5092481736316845,0.025982566319444064,0.314043703354124,0.704780260736938,0.551093109770942,0.024040710486759778,0.05459991910071983,0.2931785270283363,0.6209948667262972,0.9281751785195109,0.8701337605899596,0.2911286125028612,0.47879408402363166,0.06658855410067738,0.12961026388748245,0.08678850312002763,0.2511009138178387,0.9577266433446154,0.8146177407375826,0.17034167938168526,0.4442980277660393,0.4836398906575668,0.09657794480488881,0.026040665234492905,0.08946202387248697,0.342212510051669,0.3209388393909775,0.8675748287099061,0.2302998585832399,0.04689083176801221,0.12066247382599252,0.8334876309270297,0.07556795578603798,0.4923678093622984,0.470811074357526,0.7000972813494284,0.23822624803059675,0.9034034655136226,0.1337049924437743,0.025138805203665838,0.7329090983996478],"y":[0.0,1.0,0.0,0.3409300897091717,0.5861637867552141,0.024158116263293873,0.07960409141505488,0.2014435668481134,0.08163390968524488,0.5738765725170176,0.06809245279265047,0.5581018598805536,0.5069446755965114,0.27744712882063577,0.1273841186784779,0.3448973081084529,0.5529420588782186,0.0858170297636688,0.8265449348073306,0.19382213748425617,0.11190168281970993,0.026611366155797886,0.03634832877928678,0.15144084275486758,0.013258171184324518,0.7159151960896569,0.03656123719418844,0.2822249111830161,0.4406526035488458,0.26178405384353687,0.7028710605510945,0.06836930936933182,0.06687162391822443,0.15183861095304044,0.15327880709496072,0.2716251516242655,0.3380178161141655,0.008775733543038126,0.10114068676866028,0.9723382659265355,0.2199376212901974,0.2550823246747832,0.01864117435018208,0.09160083633785215,0.7843018710650013,0.4738761558386092,0.008311845497222359,0.899116829367356,0.02527951733201509,0.3615499472042121,0.06769635058094764,0.12624680989269693,0.09714060898026096,0.23408184999243808,0.0558051854847818,0.008063769660225883,0.04332726668503533,0.5306917747677007,0.9777474025992018,0.07245149117515318,0.5725250538874993,0.016651669624560096,0.316234961763377,0.5705569869879304,0.5815797816019254,0.1093033407167849,0.7070434216948761,0.7086524937224473,0.7003907352054706,0.5097255018303785,0.19179714469020454,0.5347423885180757,0.8730716852599687,0.0511406499518226,0.39740472106548763,0.6742591968980319,0.04840894504306726,0.033194981527782726,0.6848855698959045,0.49539568046619775,0.42315721441882437,0.8884445139313767,0.3715752479622832,0.13151425757869492,0.22369488833086504,0.01672637313095293,0.6066500014849351,0.7000231597847438,0.7335937478319824,0.1987846456843847,0.5702070718735748,0.032181030482527136,0.2495460705270557,0.25242552902812154,0.14635027743834703,0.033458651433669925,0.7941489328903341,0.009756817269731648,0.33640785176937327,0.05899261336493724,0.6064490972951119,0.7968308793300288,0.08545705165223696,0.9205501157494772,0.9710377840881507,0.08795767427554534,0.1226277414806817,0.22257676470114549,0.012337192711227943,0.14803051595937972,0.7989965808473238,0.3852138461925833,0.42079115132545686,0.30532555374724746,0.007453454928253716,0.7953298946431804,0.023256726158657936,0.554887415719022,0.13435423192653329,0.5444920826591365,0.572349439566942,0.15871090822378195,0.3809493860095756,0.394159990691662,0.08765106327984815,0.24220881849736042,0.11325743305167199,0.021451650088008613,0.2503608005184236,0.0461303805946849,0.15784789228254006,0.810972428472828,0.6603358612029041,0.010858920218409743,0.3791675130317606,0.3622487895947758,0.6535862871141157,0.03157075295974758,0.39226436538365705,0.6215180214382555,0.047742632914796954,0.7354056925291076,0.9149758857128547,0.007651131495894242,0.090314085901701,0.841495358673543,0.6636222896220291,0.22249815432695488,0.7761428156950978,0.01459036222658968,0.05335716508153868,0.05330387872337892,0.6007879338400214,0.019563473644129855,0.8682318336604815,0.2221722116570457,0.05598979639326303,0.6512143355700527,0.4576590438932671,0.01798923601085156,0.03889142219867676,0.7344474546265,0.12372005851822407,0.8364201694991281,0.41696903150046427,0.36963667499546604,0.021856096872214275,0.2782690283503469,0.19359994290190857,0.04962522691307845,0.02617501141766433,0.28323098061077023,0.48098144596633075,0.5891501121151663,0.10724300586861056,0.8456484915010277,0.5433658453144782,0.042514550362398505,0.11405239870608408,0.39936831371541337,0.20439578761351462,0.05026997209277358,0.3227090564847182,0.08235676129716155,0.03661198787841078,0.711875551842374,0.025816279944439923,0.17812309925644706,0.4101955054363322,0.039402650482999776,0.9502873141789459,0.5463004766598949,0.4375161597492879,0.8821640329260189,0.0156929316767384,0.686344978150664,0.015017556579803248,0.566906253147977,0.7913542518389132,0.39573034438019367,0.6807386252182894,0.6358145207303937,0.30100367201091965,0.7578576355028397,0.741908924198279,0.09209465368616855,0.944631562034261,0.2601722051158374,0.20594010654886463,0.03693348925186926,0.036075353587643355,0.6607621568138026,0.563736694498386,0.8957549734450496,0.7576563905096024,0.11829840679396228,0.8098228826707401,0.3743360261213312,0.18312151667234747,0.5131161678928233,0.1296178436064851,0.06755002673934915,0.01911351290325771,0.692442198778378,0.1881250988485758,0.4944574736217005,0.09854468013226259,0.10206365535113333,0.3840210465016116,0.04810089463757706,0.15544236018949756,0.016487079941705472,0.4323905285596845,0.02992181465829592,0.03928840942938995,0.3364449345023147,0.6765705345062526,0.8009574824924961,0.5331106972247973,0.03237821181973746,0.2815323110446161,0.29526294611850434,0.2823213352268805,0.6306540784158918,0.9254059485212592,0.13579317586329773,0.7682355692541257,0.047615132691110416,0.11021459716938917,0.6200089848121217,0.8777911928201272,0.41619538327857913,0.03735657447565048,0.2375864660752468,0.45842807018548426,0.6842440238894144,0.10004674096999337,0.5537170583819393,0.455214826788985,0.13550874176323582,0.4671176688366591,0.39330055096111,0.16971066392323822,0.7108281139261758,0.9257588463501238,0.2442451167099481,0.1994287056118789,0.29238905824657463,0.508051237698945,0.714055159277834,0.023786186385953305,0.9628217836270112,0.9253070080926771,0.04224444764026329,0.19148092691931193,0.0239990169932642,0.10949933595364976,0.08885884190331982,0.9524630558533242,0.11021296232331794,0.6413244235605641,0.9480841507054563,0.07558354812782249,0.872460661752964,0.7048292743578036,0.9274792634057009,0.30730255189734373,0.014531358103545954,0.10321649840830233,0.3155407831668459,0.15724503097762796,0.17643464550333976,0.673757496697623,0.14754737027987244,0.007392073972834606,0.2099530644327433,0.46783083800031566,0.7543277929935004,0.2762115676675281,0.029321311260095972,0.5079583099787766,0.12063887711797817,0.06804866449349412,0.3647034040349672,0.5153107177890048,0.03425955417445806,0.11968036041934628,0.7988047063864855,0.03769548587999423,0.012662460691223527,0.5094366655219527,0.5232106382420615,0.11734360100398937,0.6839895086873893,0.23861874693354818,0.010894882257048074,0.5827460513573378,0.6915818423911961,0.6436104702233711,0.2706432562987842,0.024670152683738625,0.7401638292137328,0.05907207126521339,0.9608401198830223,0.49281090973326097,0.024959756788373526,0.768049151276782,0.31356780255897154,0.7175525202437153,0.43586745697118817,0.29605159526238206,0.8052133396472292,0.0286145910914561,0.9290082996477294,0.06424242185021359,0.06251805497733852,0.13411608631115968,0.9182434592170668,0.010480407137194715,0.20608099694880247,0.07262799252333024,0.7950047536000505,0.06568744615388407,0.03155549512619275,0.03084375429534722,0.05179147300868745,0.1455210906255521,0.01341737036107617,0.07866661888252217,0.771971978703074,0.0582822629812802,0.07491806771385057,0.039936865708173876,0.05224271916463621,0.3854621641281027,0.897054195250922,0.1553067644042648,0.4764939014788845,0.9379943203557379,0.2095359538747212,0.36085259668177916,0.8455672751573434,0.4591014048119269,0.9618236888860144,0.583623009177491,0.2537123256756495,0.3724792889059505,0.6552672895304685,0.28420806408032273,0.2604150875272711,0.3724624828738691,0.015827163593211693,0.044674867194669225,0.6781312573944602,0.04874530726770317,0.8959726068281558,0.2018297526701912,0.028101527509040884,0.27428721709182924,0.010323359819915858,0.03265668132314137,0.8156727065717483,0.20152523503680927,0.3187739643128915,0.09447727552750049,0.7956519689369818,0.46300682038287233,0.4153766309043888,0.06887724769392256,0.05074187213675351,0.3033162833649669,0.2365882202609109,0.8069141772664805,0.15032411993727196,0.6592130924244531,0.046890212196525886,0.07942982255307367,0.06872626396107293,0.5094146153172247,0.03635826351682382,0.010873784615872758,0.9276670305306681,0.012506480450239506],"z":[0.0,0.0,1.0,0.5481954641723185,0.2924601506345466,0.9638462958600383,0.0456575477998062,0.051026648564529424,0.8861785466736921,0.19167054238047995,0.5899274249080428,0.40998487036757447,0.45851578677465094,0.012091957120450606,0.1965529956530616,0.5652743466667141,0.09889386806110091,0.008858197284954038,0.08148293607004892,0.02390623734278802,0.6324981240340616,0.04818253897104506,0.8218427363041585,0.6790756661895033,0.5702579348394259,0.048991987261775866,0.030550123946214765,0.6659086744852378,0.1805625606204032,0.0532756149857963,0.17796484983264038,0.10756610817879445,0.7956778563679624,0.05015951870470075,0.269985060040225,0.05313232460126716,0.5564840421201718,0.7188882898314479,0.6911312415348962,0.010070633414380118,0.6927697516891618,0.25109130447923034,0.767385103963311,0.22512260743592094,0.20080843517215347,0.45829874054424075,0.9662089861146778,0.041109248535877295,0.9613688739874942,0.6076585822481569,0.9123383924272448,0.20739253897437346,0.10177586401551808,0.34989490976183746,0.35407441648598664,0.706357675782714,0.9155997694094815,0.01592637186310263,0.012492043530191073,0.2742540716121188,0.19281022744756635,0.8067671362310332,0.34853053797490435,0.32322918461712413,0.33706304131867953,0.02971582322365508,0.16696801077326648,0.24812252139023822,0.2515259066332566,0.09833892221866182,0.4215439303378402,0.010173240508161562,0.06767527992557335,0.6203169464642047,0.3182500110350446,0.12307375367648128,0.6596892010070625,0.1381463143672884,0.01674045777223601,0.4886583220172111,0.18501380637069317,0.07370565584729837,0.5858755822164659,0.14955502332134307,0.30327780487492667,0.010683857129832075,0.12003951658571294,0.17961939825752377,0.04048619424107459,0.4668484614673476,0.3723949225519917,0.7802206055073257,0.7034024695075217,0.022687468894757593,0.6594747973005555,0.7299038070954614,0.11303763421683978,0.16222163165160688,0.37793703867259854,0.2755685038192832,0.32494132788168384,0.025482014724259656,0.47791883446819244,0.045753101236751456,0.007925665485854827,0.8705013877703643,0.8588071422941252,0.23306590132669197,0.040626358866210764,0.09811999263504732,0.17086481134379053,0.4887520511019326,0.3333075951392275,0.185689398911139,0.96721520803581,0.011390832322252235,0.5762236049212283,0.023768191684142594,0.023364320667031292,0.022014685810392353,0.22010402495521017,0.38389499327554705,0.6107128490065229,0.08921331574127027,0.7300695375969267,0.5260732770258554,0.196527661864242,0.05021895074208171,0.00791952095895223,0.46796137155750916,0.6184515707088197,0.11560482187913172,0.27073118840232346,0.8684841363266246,0.05768881813855305,0.08455593265809917,0.15952327303597322,0.014423115385605674,0.2122206063329626,0.1744695344972603,0.14667634580736905,0.17505947322163787,0.04825557862885938,0.4472430119050284,0.17728211802027366,0.009158662453324591,0.15714562453526104,0.15889788170012192,0.19988101622926127,0.8213135303131937,0.8666614994831008,0.7399059139733645,0.10225026583591693,0.6203353706291519,0.07349953085502661,0.5176428397714998,0.0447711033280049,0.1909908171422651,0.5317762154564216,0.9183885681953127,0.6952235317022575,0.1121136013421004,0.15488406545360447,0.11378239591999265,0.5132039104508654,0.45550992692852826,0.0390409876586327,0.05025240722313164,0.2340550016842118,0.6589829682150193,0.11060609389674249,0.573729043628344,0.4099120977892354,0.21584307517756968,0.7542342784700726,0.1461472597212843,0.05051775607078715,0.08982156629082881,0.7878832439462443,0.5356952101185342,0.5497809521957425,0.8828017070523937,0.6650369795832992,0.01610240207282634,0.8482914515910372,0.27563380858529096,0.24926870146549643,0.6453561664012593,0.2694872801726662,0.7112329583487922,0.030504306970838,0.07514345001816698,0.12464182129353342,0.09687306059448378,0.7876402517229989,0.13657926821466249,0.8488959121429901,0.32936868945650555,0.05226062711610692,0.05688045153973871,0.30868546184134943,0.040781635033124854,0.6871837680583232,0.20994294075262984,0.14834115773990045,0.18617364133888262,0.022290010350793463,0.47663775789396695,0.21956330627321652,0.01221178624098555,0.038838210548299716,0.14580870555152134,0.041107803341119936,0.04640551992366995,0.1607666495708172,0.6787705142286204,0.16258886314728976,0.5508685965382286,0.024758144463879077,0.4605278156519043,0.2755137884411542,0.7563119970840363,0.1422665018914025,0.15085900489118775,0.11494894134958465,0.04469306106270261,0.16103420976004826,0.5834421968173638,0.3068404027384795,0.09919797252728538,0.7829975852524771,0.5476384414791551,0.20661673738293557,0.028970458650218498,0.5343104010880787,0.21374443866268156,0.0535644189213946,0.15690689100505992,0.1209272646447532,0.6178938360992747,0.7115807854210527,0.3885823022917276,0.41295242369904284,0.004983829560473452,0.025972379014414224,0.6614016033037238,0.03424367778426686,0.21482091158104413,0.5470098968236957,0.2782136870494415,0.11389706544917351,0.5025300466006718,0.08957391929930081,0.046329254009846166,0.08664194623379903,0.07866909449399952,0.19168034969936162,0.3843771157589565,0.5215749245238821,0.1561698689184729,0.24264934736779262,0.2674999874885429,0.7437962977573146,0.04226174804939561,0.022632590398606982,0.22947604028474838,0.4767011692163506,0.07121692393375141,0.464376525870453,0.25406401505323706,0.37933586067378644,0.015320300624243754,0.028115121541808313,0.4462953907155104,0.7755000432988558,0.042270984680985974,0.6198158411257662,0.4564872543472761,0.021291424692727087,0.8016580927732493,0.22396573680268292,0.04310077973268804,0.8515908856748606,0.04278935677402298,0.14796100634286455,0.015533784797216002,0.2941121803560637,0.20460582018231174,0.8121243668687291,0.6307487532288806,0.4012282587032493,0.014015090545959102,0.04488551110278052,0.13610158994728805,0.5275118724047273,0.3392110917024892,0.08045238156206437,0.21576186385120083,0.23875385144535338,0.6115443077308684,0.3092761942979535,0.6201534463933709,0.4214839123575113,0.048413051507127935,0.45213605032890086,0.8937401895893986,0.059962573590119195,0.09523380572450729,0.4428297142859208,0.7561594151939283,0.014709136176355306,0.45302532484361496,0.3652636591081224,0.2599587865139387,0.02476474584258136,0.9182853242927388,0.2872875635275487,0.11647797973653409,0.02471534183172199,0.4780876677126398,0.14127757639896488,0.09062340292824843,0.2395636363514619,0.026974506841672692,0.014906517645383213,0.7574813445212593,0.09567704394493236,0.3595757163455147,0.023134890562636234,0.23744229146630538,0.09834090103826403,0.05902433351832456,0.33606167586929664,0.037765461144042174,0.05571549266837229,0.044886683397464114,0.034182945535760526,0.053224272880962764,0.2548025734864467,0.0928044759612905,0.16811421624453163,0.10634000749057725,0.6398226469452468,0.1445342208945401,0.9457021884600619,0.1337685012790823,0.2980221054583797,0.016357760125403506,0.3247975626979794,0.19940046570480977,0.476060748757552,0.10134299493799302,0.8412197082713713,0.17220520261479771,0.1910492206174033,0.0687642363445663,0.7895870153827472,0.36672184257177415,0.054213907375704314,0.6468330685836414,0.3626323656007778,0.05290060379184431,0.03165042155638868,0.01219374479454155,0.10233328746838488,0.041507413587412396,0.07642760132310746,0.3206919999827717,0.6611920168189575,0.44640638544439254,0.006542650399833623,0.05599765788727733,0.08519137221537122,0.030740130102678575,0.4724606087086653,0.037438839071166886,0.6685599834423265,0.8851099693709316,0.4746118690903321,0.03194999683546871,0.15272557793927594,0.013985614046566428,0.3541767371971515,0.19758614502954172,0.8089447796676107,0.1783073658285254,0.44753115574464064,0.24241085904394208,0.6101839129151,0.08168329915334038,0.46638385805179317,0.7165209479710769,0.07242334890752702,0.0161882491356984,0.2652189517895089,0.46074197844117576,0.44975910308940026,0.23117645468949868,0.2523591366521786,0.0602382709695536,0.8554212229403529,0.04719416426566607,0.2545844211501128],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"margin":{"r":20,"b":10,"l":10,"t":0},"scene":{"xaxis":{"title":{"text":"cat - ness"}},"yaxis":{"title":{"text":"dog - ness"}},"zaxis":{"title":{"text":"horse - ness"}},"annotations":[{"text":"cat","x":1.0,"xanchor":"center","y":0.0,"z":0.0},{"text":"dog","x":0.0,"xanchor":"center","y":1.0,"z":0.0},{"text":"horse","x":0.0,"xanchor":"center","y":0.0,"z":1.0}]},"width":700,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('67477139-71fa-4505-9589-8a3714b1f7c2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even though these are points in 3D space, they make up a <em>triangle</em> which lies along a <em>plane</em> – a 2D :subspace” of 3D. This is a consequence of having the “constraint” that all class probabilities add up to 1.</p>
</div>
</div>
<p>We can color the points by their expected class values by choosing the triangle point (or “pole”) that they’re nearest to – i.e.&nbsp;by which “bar” is largest among the class probabilities. And we can include the boundaries between classes:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">TrianglePlot3D_Plotly(prob, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>targ, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).do_plot()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="ec59f2e2-b7dc-4243-b363-bae15f809ee5" class="plotly-graph-div" style="height:525px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ec59f2e2-b7dc-4243-b363-bae15f809ee5")) {                    Plotly.newPlot(                        "ec59f2e2-b7dc-4243-b363-bae15f809ee5",                        [{"hovertext":["cat","dog","horse","horse","dog","horse","cat","cat","horse","dog","horse","dog","dog","cat","cat","horse","dog","cat","dog","cat","horse","cat","horse","horse","horse","dog","cat","horse","dog","cat","dog","cat","horse","cat","cat","cat","horse","horse","horse","dog","horse","cat","horse","cat","dog","dog","horse","dog","horse","horse","horse","cat","cat","cat","cat","horse","horse","dog","dog","cat","dog","horse","horse","dog","dog","cat","dog","dog","dog","dog","horse","dog","dog","horse","dog","dog","horse","cat","dog","dog","dog","dog","horse","cat","cat","cat","dog","dog","dog","horse","dog","horse","horse","cat","horse","horse","dog","cat","horse","cat","dog","dog","horse","dog","dog","horse","horse","cat","cat","cat","dog","horse","dog","cat","horse","dog","horse","dog","cat","dog","dog","cat","horse","cat","horse","horse","cat","cat","cat","cat","horse","dog","dog","horse","cat","cat","dog","cat","cat","dog","cat","dog","dog","cat","cat","dog","dog","cat","dog","horse","horse","horse","dog","horse","dog","horse","cat","dog","horse","horse","horse","dog","cat","dog","horse","horse","cat","cat","cat","horse","cat","horse","dog","dog","horse","dog","dog","cat","horse","horse","horse","horse","horse","cat","horse","dog","cat","horse","dog","horse","dog","dog","cat","dog","horse","dog","horse","dog","dog","cat","dog","dog","horse","dog","dog","cat","dog","horse","cat","cat","cat","dog","dog","dog","dog","horse","dog","horse","cat","dog","cat","horse","cat","dog","cat","dog","cat","horse","dog","cat","horse","horse","dog","cat","horse","cat","dog","dog","dog","horse","horse","horse","horse","dog","dog","horse","dog","cat","horse","dog","dog","horse","cat","cat","dog","dog","cat","dog","horse","cat","dog","dog","horse","dog","dog","cat","horse","cat","dog","dog","cat","dog","dog","cat","horse","cat","horse","horse","dog","horse","dog","dog","horse","dog","dog","dog","cat","cat","horse","horse","cat","cat","dog","cat","horse","cat","dog","dog","cat","horse","dog","horse","cat","cat","dog","horse","cat","dog","cat","horse","dog","dog","cat","dog","cat","horse","dog","dog","dog","horse","cat","dog","cat","dog","dog","horse","dog","horse","dog","dog","cat","dog","cat","dog","cat","cat","cat","dog","cat","cat","cat","dog","horse","cat","horse","cat","cat","cat","cat","dog","horse","cat","horse","cat","cat","dog","horse","dog","dog","horse","horse","dog","cat","dog","dog","cat","cat","dog","horse","horse","cat","cat","cat","dog","cat","dog","horse","horse","horse","cat","cat","dog","cat","cat","horse","dog","dog","dog","horse","cat","horse","horse","dog","cat","dog","cat","cat","cat","dog","cat","horse","dog","cat"],"marker":{"color":["red","green","blue","blue","green","blue","red","red","blue","green","blue","green","green","red","red","blue","green","red","green","red","blue","red","blue","blue","blue","green","red","blue","green","red","green","red","blue","red","red","red","blue","blue","blue","green","blue","red","blue","red","green","green","blue","green","blue","blue","blue","red","red","red","red","blue","blue","green","green","red","green","blue","blue","green","green","red","green","green","green","green","blue","green","green","blue","green","green","blue","red","green","green","green","green","blue","red","red","red","green","green","green","blue","green","blue","blue","red","blue","blue","green","red","blue","red","green","green","blue","green","green","blue","blue","red","red","red","green","blue","green","red","blue","green","blue","green","red","green","green","red","blue","red","blue","blue","red","red","red","red","blue","green","green","blue","red","red","green","red","red","green","red","green","green","red","red","green","green","red","green","blue","blue","blue","green","blue","green","blue","red","green","blue","blue","blue","green","red","green","blue","blue","red","red","red","blue","red","blue","green","green","blue","green","green","red","blue","blue","blue","blue","blue","red","blue","green","red","blue","green","blue","green","green","red","green","blue","green","blue","green","green","red","green","green","blue","green","green","red","green","blue","red","red","red","green","green","green","green","blue","green","blue","red","green","red","blue","red","green","red","green","red","blue","green","red","blue","blue","green","red","blue","red","green","green","green","blue","blue","blue","blue","green","green","blue","green","red","blue","green","green","blue","red","red","green","green","red","green","blue","red","green","green","blue","green","green","red","blue","red","green","green","red","green","green","red","blue","red","blue","blue","green","blue","green","green","blue","green","green","green","red","red","blue","blue","red","red","green","red","blue","red","green","green","red","blue","green","blue","red","red","green","blue","red","green","red","blue","green","green","red","green","red","blue","green","green","green","blue","red","green","red","green","green","blue","green","blue","green","green","red","green","red","green","red","red","red","green","red","red","red","green","blue","red","blue","red","red","red","red","green","blue","red","blue","red","red","green","blue","green","green","blue","blue","green","red","green","green","red","red","green","blue","blue","red","red","red","green","red","green","blue","blue","blue","red","red","green","red","red","blue","green","green","green","blue","red","blue","blue","green","red","green","red","red","red","green","red","blue","green","red"],"opacity":0.6,"size":5},"mode":"markers","x":[1.0,0.0,0.0,0.11087444611850987,0.12137606261023932,0.011995587876667881,0.874738360785139,0.7475297845873572,0.032187543641063084,0.23445288510250253,0.34198012229930663,0.031913269751871934,0.03453953762883764,0.7104609140589137,0.6760628856684605,0.08982834522483304,0.3481640730606804,0.9053247729513771,0.09197212912262046,0.7822716251729558,0.25560019314622845,0.9252060948731571,0.1418089349165547,0.16948349105562907,0.41648389397624963,0.23509281664856718,0.9328886388595966,0.05186641433174604,0.37878483583075107,0.684940331170667,0.11916408961626505,0.8240645824518738,0.13745051971381322,0.7980018703422587,0.5767361328648142,0.6752425237744674,0.1054981417656628,0.272335976625514,0.20772807169644344,0.017591100659084424,0.08729262702064076,0.49382637084598663,0.2139737216865069,0.6832765562262268,0.014889693762845357,0.06782510361715002,0.02547916838809994,0.059773922096766685,0.013351608680490859,0.030791470547630977,0.019965256991807658,0.6663606511329295,0.8010835270042209,0.4160232402457245,0.5901203980292316,0.2855785545570601,0.04107296390548315,0.4533818533691966,0.009760553870607008,0.653294437212728,0.23466471866493427,0.17658119414440673,0.3352345002617187,0.10621382839494538,0.08135717707939512,0.8609808360595599,0.12598856753185733,0.043224984887314404,0.04808335816127273,0.3919355759509596,0.38665892497195525,0.4550843709737628,0.059253034814458067,0.32854240358397274,0.28434526789946774,0.20266704942548677,0.29190185394987017,0.8286587041049289,0.29837397233185947,0.01594599751659127,0.3918289792104823,0.037849830221325,0.042549169821250926,0.718930719099962,0.47302730679420824,0.972589769739215,0.2733104819293519,0.12035744195773236,0.22592005792694295,0.33436689284826765,0.05739800557443345,0.18759836401014698,0.0470514599654225,0.7248870020771208,0.19417492526109742,0.23663754147086868,0.09281343289282618,0.8280215510786615,0.28565510955802825,0.6654388828157796,0.06860957482320429,0.1776871059457116,0.4366241138795705,0.033696783013771214,0.0210365504259945,0.04154093795409048,0.018565116225192926,0.5443573339721626,0.9470364484225613,0.7538494914055729,0.03013860780888553,0.12603410270548415,0.24590125353531578,0.5089850473416137,0.025331337035936298,0.19327927303456738,0.4005196689201137,0.4213443925968353,0.8422814474064355,0.43349323153047115,0.20754653547784788,0.45739409850067103,0.00833776498390144,0.5166266935670677,0.18227939912322524,0.23171790447678423,0.690214905084086,0.9283293991699096,0.7417196785226242,0.48590824784780584,0.2237005370086403,0.07342274964804017,0.06893295039477243,0.12065694345496568,0.5631436688296863,0.5531952777471251,0.1868904398499111,0.9540061316546468,0.39551502828338025,0.20401244406448413,0.8055810212778339,0.08953483424925443,0.03676853565828598,0.5451058565990774,0.7324037960780253,0.14934597887313247,0.17923208584270992,0.6186039639729233,0.023976168075640958,0.16409610746021663,0.07998133543536046,0.2067902073032566,0.2969618003240617,0.36010115572671825,0.05826863548449201,0.2601849485714544,0.899239100278732,0.15779484728768214,0.01056474065031126,0.06362219579383567,0.2658850460990658,0.15343894403139957,0.7213958760281715,0.04979743458087942,0.06982705804867038,0.1748533980760058,0.9391029154691531,0.6714785644265214,0.5723450554138797,0.2913918048719022,0.8632188946855931,0.14303997576088573,0.10910645624443391,0.19500681270726403,0.13852271566131694,0.008204248777687955,0.40611639861473453,0.8676638833467727,0.09806435734767148,0.06493647616605248,0.24582326019074285,0.06692832085483284,0.012253963931982637,0.9015408366300122,0.11509656053055203,0.012490639572334922,0.7249150185900635,0.17652073434229368,0.3203172143910015,0.249364391168208,0.019208378850216187,0.37855607332193814,0.4378420189571786,0.02096290647949737,0.19666681660026278,0.1770757536346735,0.1360865312772067,0.10372505739551739,0.15638512104498,0.5473892040800676,0.010575912940361223,0.3234038442364814,0.011812559930757272,0.03219942374453054,0.10974991806182048,0.7217317049749489,0.03307842761494553,0.26319003699019566,0.5744965871779188,0.9508547245071453,0.925086435864057,0.193429137634676,0.39515550216049394,0.05783950663128046,0.08157695991958035,0.2029310789774172,0.02758825418197007,0.07479537734044013,0.7921203388637735,0.026356016455272427,0.5948683679523608,0.17613797617661453,0.8386199852053398,0.15669879633043413,0.6969259598018396,0.4608494653155968,0.7404211101076893,0.31449414783150287,0.30913855075990904,0.8527011328351376,0.06156005455802543,0.4358744785791394,0.36099273405737997,0.9411077266914858,0.42640118948253136,0.4498106268350037,0.2698650465723529,0.042135626502444,0.3459620381304495,0.34972795208098784,0.006886903534331193,0.316154751589768,0.30472624107407653,0.3643620920236348,0.04862167246432664,0.20280522083297856,0.1975207529616076,0.7375639557278455,0.3427755060069151,0.10177732813843669,0.008311741730699167,0.08127457012074907,0.8730695062250488,0.716084279914907,0.45492998358071673,0.2370868816165861,0.7082729093306449,0.061905825859104216,0.023210248687132774,0.7083213893182913,0.29023298379554824,0.3391994615503471,0.08649303831944717,0.24691013802442843,0.05160856325126911,0.5262788430053034,0.3238701251717705,0.636394017819674,0.027572236430601957,0.03188082566892901,0.5968779529402604,0.02185791574874514,0.046577870365514584,0.5114601616442264,0.033019029781832215,0.9337299983257499,0.270684822920584,0.4546539037494041,0.026245519453948683,0.08812894490343276,0.13470983963675295,0.008815069561855883,0.0728255661973169,0.08474998147301308,0.14720971929933185,0.056986951797083255,0.39858526774659253,0.7808628217141423,0.08465913472296849,0.05371046360427353,0.44152671031912266,0.8095502639507012,0.2813569921995966,0.7163510397728395,0.4650960536224381,0.4508358438647673,0.45171678043762015,0.029910343155298922,0.48503458088711854,0.3591343810090356,0.18276549572327003,0.25920767648865095,0.5104674231489946,0.5868835444579048,0.03255323188209424,0.07200025623614333,0.8203570659905344,0.10596148788900722,0.5194747998340851,0.2311781241148482,0.475854198301692,0.023764036914323432,0.5173927398878883,0.05605170479867204,0.7366165072238705,0.07081979345021314,0.1299663851151134,0.19194017787226977,0.3316741879449069,0.2512690759885759,0.8340522709172964,0.16921276785801873,0.7013642923833247,0.01218537327530503,0.4922825726213558,0.21755889869036715,0.13627380477828557,0.3268564810955138,0.2593125891936485,0.3266902515625065,0.6056075036993538,0.13576232683444625,0.6353237330392473,0.03322623920822832,0.8800420854814139,0.8925952616251975,0.8317009681530799,0.02853226790197036,0.7347170193763587,0.7011145270899071,0.7592577912321381,0.09865523890937229,0.2944899069008691,0.8239102839792671,0.023454057244590834,0.8144400257122304,0.5564568039160681,0.9702248695135204,0.5965358184194983,0.028627555592116265,0.4656569882611679,0.8237389373481564,0.1188434260204549,0.775552078220566,0.42348861525449394,0.03418156840451178,0.05510622021298805,0.1567842559493414,0.007791772268557743,0.1436309775416373,0.276515037717443,0.10153212105081232,0.5092481736316845,0.025982566319444064,0.314043703354124,0.704780260736938,0.551093109770942,0.024040710486759778,0.05459991910071983,0.2931785270283363,0.6209948667262972,0.9281751785195109,0.8701337605899596,0.2911286125028612,0.47879408402363166,0.06658855410067738,0.12961026388748245,0.08678850312002763,0.2511009138178387,0.9577266433446154,0.8146177407375826,0.17034167938168526,0.4442980277660393,0.4836398906575668,0.09657794480488881,0.026040665234492905,0.08946202387248697,0.342212510051669,0.3209388393909775,0.8675748287099061,0.2302998585832399,0.04689083176801221,0.12066247382599252,0.8334876309270297,0.07556795578603798,0.4923678093622984,0.470811074357526,0.7000972813494284,0.23822624803059675,0.9034034655136226,0.1337049924437743,0.025138805203665838,0.7329090983996478],"y":[0.0,1.0,0.0,0.3409300897091717,0.5861637867552141,0.024158116263293873,0.07960409141505488,0.2014435668481134,0.08163390968524488,0.5738765725170176,0.06809245279265047,0.5581018598805536,0.5069446755965114,0.27744712882063577,0.1273841186784779,0.3448973081084529,0.5529420588782186,0.0858170297636688,0.8265449348073306,0.19382213748425617,0.11190168281970993,0.026611366155797886,0.03634832877928678,0.15144084275486758,0.013258171184324518,0.7159151960896569,0.03656123719418844,0.2822249111830161,0.4406526035488458,0.26178405384353687,0.7028710605510945,0.06836930936933182,0.06687162391822443,0.15183861095304044,0.15327880709496072,0.2716251516242655,0.3380178161141655,0.008775733543038126,0.10114068676866028,0.9723382659265355,0.2199376212901974,0.2550823246747832,0.01864117435018208,0.09160083633785215,0.7843018710650013,0.4738761558386092,0.008311845497222359,0.899116829367356,0.02527951733201509,0.3615499472042121,0.06769635058094764,0.12624680989269693,0.09714060898026096,0.23408184999243808,0.0558051854847818,0.008063769660225883,0.04332726668503533,0.5306917747677007,0.9777474025992018,0.07245149117515318,0.5725250538874993,0.016651669624560096,0.316234961763377,0.5705569869879304,0.5815797816019254,0.1093033407167849,0.7070434216948761,0.7086524937224473,0.7003907352054706,0.5097255018303785,0.19179714469020454,0.5347423885180757,0.8730716852599687,0.0511406499518226,0.39740472106548763,0.6742591968980319,0.04840894504306726,0.033194981527782726,0.6848855698959045,0.49539568046619775,0.42315721441882437,0.8884445139313767,0.3715752479622832,0.13151425757869492,0.22369488833086504,0.01672637313095293,0.6066500014849351,0.7000231597847438,0.7335937478319824,0.1987846456843847,0.5702070718735748,0.032181030482527136,0.2495460705270557,0.25242552902812154,0.14635027743834703,0.033458651433669925,0.7941489328903341,0.009756817269731648,0.33640785176937327,0.05899261336493724,0.6064490972951119,0.7968308793300288,0.08545705165223696,0.9205501157494772,0.9710377840881507,0.08795767427554534,0.1226277414806817,0.22257676470114549,0.012337192711227943,0.14803051595937972,0.7989965808473238,0.3852138461925833,0.42079115132545686,0.30532555374724746,0.007453454928253716,0.7953298946431804,0.023256726158657936,0.554887415719022,0.13435423192653329,0.5444920826591365,0.572349439566942,0.15871090822378195,0.3809493860095756,0.394159990691662,0.08765106327984815,0.24220881849736042,0.11325743305167199,0.021451650088008613,0.2503608005184236,0.0461303805946849,0.15784789228254006,0.810972428472828,0.6603358612029041,0.010858920218409743,0.3791675130317606,0.3622487895947758,0.6535862871141157,0.03157075295974758,0.39226436538365705,0.6215180214382555,0.047742632914796954,0.7354056925291076,0.9149758857128547,0.007651131495894242,0.090314085901701,0.841495358673543,0.6636222896220291,0.22249815432695488,0.7761428156950978,0.01459036222658968,0.05335716508153868,0.05330387872337892,0.6007879338400214,0.019563473644129855,0.8682318336604815,0.2221722116570457,0.05598979639326303,0.6512143355700527,0.4576590438932671,0.01798923601085156,0.03889142219867676,0.7344474546265,0.12372005851822407,0.8364201694991281,0.41696903150046427,0.36963667499546604,0.021856096872214275,0.2782690283503469,0.19359994290190857,0.04962522691307845,0.02617501141766433,0.28323098061077023,0.48098144596633075,0.5891501121151663,0.10724300586861056,0.8456484915010277,0.5433658453144782,0.042514550362398505,0.11405239870608408,0.39936831371541337,0.20439578761351462,0.05026997209277358,0.3227090564847182,0.08235676129716155,0.03661198787841078,0.711875551842374,0.025816279944439923,0.17812309925644706,0.4101955054363322,0.039402650482999776,0.9502873141789459,0.5463004766598949,0.4375161597492879,0.8821640329260189,0.0156929316767384,0.686344978150664,0.015017556579803248,0.566906253147977,0.7913542518389132,0.39573034438019367,0.6807386252182894,0.6358145207303937,0.30100367201091965,0.7578576355028397,0.741908924198279,0.09209465368616855,0.944631562034261,0.2601722051158374,0.20594010654886463,0.03693348925186926,0.036075353587643355,0.6607621568138026,0.563736694498386,0.8957549734450496,0.7576563905096024,0.11829840679396228,0.8098228826707401,0.3743360261213312,0.18312151667234747,0.5131161678928233,0.1296178436064851,0.06755002673934915,0.01911351290325771,0.692442198778378,0.1881250988485758,0.4944574736217005,0.09854468013226259,0.10206365535113333,0.3840210465016116,0.04810089463757706,0.15544236018949756,0.016487079941705472,0.4323905285596845,0.02992181465829592,0.03928840942938995,0.3364449345023147,0.6765705345062526,0.8009574824924961,0.5331106972247973,0.03237821181973746,0.2815323110446161,0.29526294611850434,0.2823213352268805,0.6306540784158918,0.9254059485212592,0.13579317586329773,0.7682355692541257,0.047615132691110416,0.11021459716938917,0.6200089848121217,0.8777911928201272,0.41619538327857913,0.03735657447565048,0.2375864660752468,0.45842807018548426,0.6842440238894144,0.10004674096999337,0.5537170583819393,0.455214826788985,0.13550874176323582,0.4671176688366591,0.39330055096111,0.16971066392323822,0.7108281139261758,0.9257588463501238,0.2442451167099481,0.1994287056118789,0.29238905824657463,0.508051237698945,0.714055159277834,0.023786186385953305,0.9628217836270112,0.9253070080926771,0.04224444764026329,0.19148092691931193,0.0239990169932642,0.10949933595364976,0.08885884190331982,0.9524630558533242,0.11021296232331794,0.6413244235605641,0.9480841507054563,0.07558354812782249,0.872460661752964,0.7048292743578036,0.9274792634057009,0.30730255189734373,0.014531358103545954,0.10321649840830233,0.3155407831668459,0.15724503097762796,0.17643464550333976,0.673757496697623,0.14754737027987244,0.007392073972834606,0.2099530644327433,0.46783083800031566,0.7543277929935004,0.2762115676675281,0.029321311260095972,0.5079583099787766,0.12063887711797817,0.06804866449349412,0.3647034040349672,0.5153107177890048,0.03425955417445806,0.11968036041934628,0.7988047063864855,0.03769548587999423,0.012662460691223527,0.5094366655219527,0.5232106382420615,0.11734360100398937,0.6839895086873893,0.23861874693354818,0.010894882257048074,0.5827460513573378,0.6915818423911961,0.6436104702233711,0.2706432562987842,0.024670152683738625,0.7401638292137328,0.05907207126521339,0.9608401198830223,0.49281090973326097,0.024959756788373526,0.768049151276782,0.31356780255897154,0.7175525202437153,0.43586745697118817,0.29605159526238206,0.8052133396472292,0.0286145910914561,0.9290082996477294,0.06424242185021359,0.06251805497733852,0.13411608631115968,0.9182434592170668,0.010480407137194715,0.20608099694880247,0.07262799252333024,0.7950047536000505,0.06568744615388407,0.03155549512619275,0.03084375429534722,0.05179147300868745,0.1455210906255521,0.01341737036107617,0.07866661888252217,0.771971978703074,0.0582822629812802,0.07491806771385057,0.039936865708173876,0.05224271916463621,0.3854621641281027,0.897054195250922,0.1553067644042648,0.4764939014788845,0.9379943203557379,0.2095359538747212,0.36085259668177916,0.8455672751573434,0.4591014048119269,0.9618236888860144,0.583623009177491,0.2537123256756495,0.3724792889059505,0.6552672895304685,0.28420806408032273,0.2604150875272711,0.3724624828738691,0.015827163593211693,0.044674867194669225,0.6781312573944602,0.04874530726770317,0.8959726068281558,0.2018297526701912,0.028101527509040884,0.27428721709182924,0.010323359819915858,0.03265668132314137,0.8156727065717483,0.20152523503680927,0.3187739643128915,0.09447727552750049,0.7956519689369818,0.46300682038287233,0.4153766309043888,0.06887724769392256,0.05074187213675351,0.3033162833649669,0.2365882202609109,0.8069141772664805,0.15032411993727196,0.6592130924244531,0.046890212196525886,0.07942982255307367,0.06872626396107293,0.5094146153172247,0.03635826351682382,0.010873784615872758,0.9276670305306681,0.012506480450239506],"z":[0.0,0.0,1.0,0.5481954641723185,0.2924601506345466,0.9638462958600383,0.0456575477998062,0.051026648564529424,0.8861785466736921,0.19167054238047995,0.5899274249080428,0.40998487036757447,0.45851578677465094,0.012091957120450606,0.1965529956530616,0.5652743466667141,0.09889386806110091,0.008858197284954038,0.08148293607004892,0.02390623734278802,0.6324981240340616,0.04818253897104506,0.8218427363041585,0.6790756661895033,0.5702579348394259,0.048991987261775866,0.030550123946214765,0.6659086744852378,0.1805625606204032,0.0532756149857963,0.17796484983264038,0.10756610817879445,0.7956778563679624,0.05015951870470075,0.269985060040225,0.05313232460126716,0.5564840421201718,0.7188882898314479,0.6911312415348962,0.010070633414380118,0.6927697516891618,0.25109130447923034,0.767385103963311,0.22512260743592094,0.20080843517215347,0.45829874054424075,0.9662089861146778,0.041109248535877295,0.9613688739874942,0.6076585822481569,0.9123383924272448,0.20739253897437346,0.10177586401551808,0.34989490976183746,0.35407441648598664,0.706357675782714,0.9155997694094815,0.01592637186310263,0.012492043530191073,0.2742540716121188,0.19281022744756635,0.8067671362310332,0.34853053797490435,0.32322918461712413,0.33706304131867953,0.02971582322365508,0.16696801077326648,0.24812252139023822,0.2515259066332566,0.09833892221866182,0.4215439303378402,0.010173240508161562,0.06767527992557335,0.6203169464642047,0.3182500110350446,0.12307375367648128,0.6596892010070625,0.1381463143672884,0.01674045777223601,0.4886583220172111,0.18501380637069317,0.07370565584729837,0.5858755822164659,0.14955502332134307,0.30327780487492667,0.010683857129832075,0.12003951658571294,0.17961939825752377,0.04048619424107459,0.4668484614673476,0.3723949225519917,0.7802206055073257,0.7034024695075217,0.022687468894757593,0.6594747973005555,0.7299038070954614,0.11303763421683978,0.16222163165160688,0.37793703867259854,0.2755685038192832,0.32494132788168384,0.025482014724259656,0.47791883446819244,0.045753101236751456,0.007925665485854827,0.8705013877703643,0.8588071422941252,0.23306590132669197,0.040626358866210764,0.09811999263504732,0.17086481134379053,0.4887520511019326,0.3333075951392275,0.185689398911139,0.96721520803581,0.011390832322252235,0.5762236049212283,0.023768191684142594,0.023364320667031292,0.022014685810392353,0.22010402495521017,0.38389499327554705,0.6107128490065229,0.08921331574127027,0.7300695375969267,0.5260732770258554,0.196527661864242,0.05021895074208171,0.00791952095895223,0.46796137155750916,0.6184515707088197,0.11560482187913172,0.27073118840232346,0.8684841363266246,0.05768881813855305,0.08455593265809917,0.15952327303597322,0.014423115385605674,0.2122206063329626,0.1744695344972603,0.14667634580736905,0.17505947322163787,0.04825557862885938,0.4472430119050284,0.17728211802027366,0.009158662453324591,0.15714562453526104,0.15889788170012192,0.19988101622926127,0.8213135303131937,0.8666614994831008,0.7399059139733645,0.10225026583591693,0.6203353706291519,0.07349953085502661,0.5176428397714998,0.0447711033280049,0.1909908171422651,0.5317762154564216,0.9183885681953127,0.6952235317022575,0.1121136013421004,0.15488406545360447,0.11378239591999265,0.5132039104508654,0.45550992692852826,0.0390409876586327,0.05025240722313164,0.2340550016842118,0.6589829682150193,0.11060609389674249,0.573729043628344,0.4099120977892354,0.21584307517756968,0.7542342784700726,0.1461472597212843,0.05051775607078715,0.08982156629082881,0.7878832439462443,0.5356952101185342,0.5497809521957425,0.8828017070523937,0.6650369795832992,0.01610240207282634,0.8482914515910372,0.27563380858529096,0.24926870146549643,0.6453561664012593,0.2694872801726662,0.7112329583487922,0.030504306970838,0.07514345001816698,0.12464182129353342,0.09687306059448378,0.7876402517229989,0.13657926821466249,0.8488959121429901,0.32936868945650555,0.05226062711610692,0.05688045153973871,0.30868546184134943,0.040781635033124854,0.6871837680583232,0.20994294075262984,0.14834115773990045,0.18617364133888262,0.022290010350793463,0.47663775789396695,0.21956330627321652,0.01221178624098555,0.038838210548299716,0.14580870555152134,0.041107803341119936,0.04640551992366995,0.1607666495708172,0.6787705142286204,0.16258886314728976,0.5508685965382286,0.024758144463879077,0.4605278156519043,0.2755137884411542,0.7563119970840363,0.1422665018914025,0.15085900489118775,0.11494894134958465,0.04469306106270261,0.16103420976004826,0.5834421968173638,0.3068404027384795,0.09919797252728538,0.7829975852524771,0.5476384414791551,0.20661673738293557,0.028970458650218498,0.5343104010880787,0.21374443866268156,0.0535644189213946,0.15690689100505992,0.1209272646447532,0.6178938360992747,0.7115807854210527,0.3885823022917276,0.41295242369904284,0.004983829560473452,0.025972379014414224,0.6614016033037238,0.03424367778426686,0.21482091158104413,0.5470098968236957,0.2782136870494415,0.11389706544917351,0.5025300466006718,0.08957391929930081,0.046329254009846166,0.08664194623379903,0.07866909449399952,0.19168034969936162,0.3843771157589565,0.5215749245238821,0.1561698689184729,0.24264934736779262,0.2674999874885429,0.7437962977573146,0.04226174804939561,0.022632590398606982,0.22947604028474838,0.4767011692163506,0.07121692393375141,0.464376525870453,0.25406401505323706,0.37933586067378644,0.015320300624243754,0.028115121541808313,0.4462953907155104,0.7755000432988558,0.042270984680985974,0.6198158411257662,0.4564872543472761,0.021291424692727087,0.8016580927732493,0.22396573680268292,0.04310077973268804,0.8515908856748606,0.04278935677402298,0.14796100634286455,0.015533784797216002,0.2941121803560637,0.20460582018231174,0.8121243668687291,0.6307487532288806,0.4012282587032493,0.014015090545959102,0.04488551110278052,0.13610158994728805,0.5275118724047273,0.3392110917024892,0.08045238156206437,0.21576186385120083,0.23875385144535338,0.6115443077308684,0.3092761942979535,0.6201534463933709,0.4214839123575113,0.048413051507127935,0.45213605032890086,0.8937401895893986,0.059962573590119195,0.09523380572450729,0.4428297142859208,0.7561594151939283,0.014709136176355306,0.45302532484361496,0.3652636591081224,0.2599587865139387,0.02476474584258136,0.9182853242927388,0.2872875635275487,0.11647797973653409,0.02471534183172199,0.4780876677126398,0.14127757639896488,0.09062340292824843,0.2395636363514619,0.026974506841672692,0.014906517645383213,0.7574813445212593,0.09567704394493236,0.3595757163455147,0.023134890562636234,0.23744229146630538,0.09834090103826403,0.05902433351832456,0.33606167586929664,0.037765461144042174,0.05571549266837229,0.044886683397464114,0.034182945535760526,0.053224272880962764,0.2548025734864467,0.0928044759612905,0.16811421624453163,0.10634000749057725,0.6398226469452468,0.1445342208945401,0.9457021884600619,0.1337685012790823,0.2980221054583797,0.016357760125403506,0.3247975626979794,0.19940046570480977,0.476060748757552,0.10134299493799302,0.8412197082713713,0.17220520261479771,0.1910492206174033,0.0687642363445663,0.7895870153827472,0.36672184257177415,0.054213907375704314,0.6468330685836414,0.3626323656007778,0.05290060379184431,0.03165042155638868,0.01219374479454155,0.10233328746838488,0.041507413587412396,0.07642760132310746,0.3206919999827717,0.6611920168189575,0.44640638544439254,0.006542650399833623,0.05599765788727733,0.08519137221537122,0.030740130102678575,0.4724606087086653,0.037438839071166886,0.6685599834423265,0.8851099693709316,0.4746118690903321,0.03194999683546871,0.15272557793927594,0.013985614046566428,0.3541767371971515,0.19758614502954172,0.8089447796676107,0.1783073658285254,0.44753115574464064,0.24241085904394208,0.6101839129151,0.08168329915334038,0.46638385805179317,0.7165209479710769,0.07242334890752702,0.0161882491356984,0.2652189517895089,0.46074197844117576,0.44975910308940026,0.23117645468949868,0.2523591366521786,0.0602382709695536,0.8554212229403529,0.04719416426566607,0.2545844211501128],"type":"scatter3d"},{"line":{"color":"black","width":5},"mode":"lines","x":[0.333,0.5],"y":[0.333,0.5],"z":[0.333,0],"type":"scatter3d"},{"line":{"color":"black","width":5},"mode":"lines","x":[0.333,0],"y":[0.333,0.5],"z":[0.333,0.5],"type":"scatter3d"},{"line":{"color":"black","width":5},"mode":"lines","x":[0.333,0.5],"y":[0.333,0],"z":[0.333,0.5],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"margin":{"r":20,"b":10,"l":10,"t":0},"scene":{"xaxis":{"title":{"text":"cat - ness"}},"yaxis":{"title":{"text":"dog - ness"}},"zaxis":{"title":{"text":"horse - ness"}},"annotations":[{"text":"cat","x":1.0,"xanchor":"center","y":0.0,"z":0.0},{"text":"dog","x":0.0,"xanchor":"center","y":1.0,"z":0.0},{"text":"horse","x":0.0,"xanchor":"center","y":0.0,"z":1.0}]},"width":700,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ec59f2e2-b7dc-4243-b363-bae15f809ee5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="showing-3d-3-class-classification-in-2d" class="level2">
<h2 class="anchored" data-anchor-id="showing-3d-3-class-classification-in-2d">Showing (3D) 3-Class Classification in 2D</h2>
<p>Since these points lie along a plane, we can change coordinates and just use a 2D plot instead of a 3D plot.</p>
<blockquote class="blockquote">
<p><strong><em>(Optional) Math Trivia:</em></strong> <em>Typically this would involve calculating a coordinate transformation either by hand or using something like PCA to do it for us, but in this case there’s a simple “hack” transformation that will get us from <img src="https://latex.codecogs.com/png.latex?x">, <img src="https://latex.codecogs.com/png.latex?y">, and <img src="https://latex.codecogs.com/png.latex?z"> in 3D to our 2D coordinates <img src="https://latex.codecogs.com/png.latex?x'"> and <img src="https://latex.codecogs.com/png.latex?y'"></em>: <img src="https://latex.codecogs.com/png.latex?%20x'%20=%20y%20-%20x,%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20y'%20=%20z%20"></p>
</blockquote>
<p>In a 2D version of our triangle plot, we can even enable “image tooltips” so that when the mouse hovers over a datapoint, you can see the image it represents:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> duckduckgo_search <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DDGS</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> grab_urls(targ, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cat'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dog'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horse'</span>]):</span>
<span id="cb5-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""grabs a set of urls, in order of images that match the labels corresponding to targets"""</span></span>
<span id="cb5-5">    dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> targ.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-6">    url_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(dim)]</span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(dim): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for each set of targets, scrape that many urls for the label</span></span>
<span id="cb5-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> DDGS() <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ddgs:</span>
<span id="cb5-9">            label, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels[t], np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> t )<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># count how many of each target there are</span></span>
<span id="cb5-10">            search_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ddgs.images(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>label<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, max_results<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n)</span>
<span id="cb5-11">            urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(search_results).get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"image"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n)]</span>
<span id="cb5-12">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print("'hey, urls = ",urls)</span></span>
<span id="cb5-13">            url_store[t] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> urls</span>
<span id="cb5-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> [ url_store[targ[t]].pop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(targ)) ] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># supply a url matching each target</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">urls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grab_urls(targ, labels)</span>
<span id="cb6-2">TrianglePlot2D_Bokeh(prob, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>targ, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, urls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>urls).do_plot()</span></code></pre></div>
<div class="cell-output cell-output-display">

<script type="application/javascript">
(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    const el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.3.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
          for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script>
</div>
<div class="cell-output cell-output-display">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</div>
<div class="cell-output cell-output-display">

  <div class="bk-root" id="1fe4465b-0ca7-4117-a00e-01e75a6f1078" data-root-id="1002"></div>
</div>
<div class="cell-output cell-output-display">

<script type="application/javascript">
(function(root) {
  function embed_document(root) {
  const docs_json = {"221677d8-144b-44a1-b816-ac47a5c33278":{"defs":[],"roots":{"references":[{"attributes":{"below":[{"id":"1013"}],"center":[{"id":"1016"},{"id":"1020"},{"id":"1071"},{"id":"1072"},{"id":"1073"}],"height":350,"left":[{"id":"1017"}],"renderers":[{"id":"1050"},{"id":"1056"},{"id":"1062"},{"id":"1069"}],"title":{"id":"1003"},"toolbar":{"id":"1029"},"width":400,"x_range":{"id":"1005"},"x_scale":{"id":"1009"},"y_range":{"id":"1007"},"y_scale":{"id":"1011"}},"id":"1002","subtype":"Figure","type":"Plot"},{"attributes":{"source":{"id":"1046"}},"id":"1051","type":"CDSView"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1059","type":"Line"},{"attributes":{},"id":"1086","type":"Selection"},{"attributes":{"coordinates":null,"data_source":{"id":"1058"},"glyph":{"id":"1059"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"1061"},"nonselection_glyph":{"id":"1060"},"view":{"id":"1063"}},"id":"1062","type":"GlyphRenderer"},{"attributes":{},"id":"1007","type":"DataRange1d"},{"attributes":{"data":{"x":[0,0],"y":[0.333,0]},"selected":{"id":"1082"},"selection_policy":{"id":"1081"}},"id":"1046","type":"ColumnDataSource"},{"attributes":{},"id":"1026","type":"HelpTool"},{"attributes":{"callback":null,"tooltips":"\n            <div>\n                <div>\n                    <img\n                        src=\"@imgs\" height=\"100\" alt=\"@imgs\" \n                        style=\"float: left; margin: 0px 15px 15px 0px;\"\n                        border=\"2\"\n                    ></img>\n                </div>\n                <div>\n                    <span style=\"font-size: 17px; font-weight: bold;\">@desc</span>\n                    <span style=\"font-size: 15px; color: #966;\">[$index]</span>\n                </div>\n                <!---commenting-out coordinate values <div>\n                    <span style=\"font-size: 10px; color: #696;\">($x, $y)</span>\n                </div> -->\n            </div>\n        "},"id":"1028","type":"HoverTool"},{"attributes":{},"id":"1040","type":"AllLabels"},{"attributes":{},"id":"1042","type":"BasicTickFormatter"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"1027","type":"BoxAnnotation"},{"attributes":{},"id":"1005","type":"DataRange1d"},{"attributes":{"coordinates":null,"formatter":{"id":"1042"},"group":null,"major_label_policy":{"id":"1043"},"ticker":{"id":"1014"}},"id":"1013","type":"LinearAxis"},{"attributes":{"data":{"x":[0,-0.5],"y":[0.333,0.5]},"selected":{"id":"1086"},"selection_policy":{"id":"1085"}},"id":"1058","type":"ColumnDataSource"},{"attributes":{},"id":"1084","type":"Selection"},{"attributes":{"axis":{"id":"1017"},"coordinates":null,"dimension":1,"group":null,"ticker":null},"id":"1020","type":"Grid"},{"attributes":{"coordinates":null,"data_source":{"id":"1064"},"glyph":{"id":"1066"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"1068"},"nonselection_glyph":{"id":"1067"},"view":{"id":"1070"}},"id":"1069","type":"GlyphRenderer"},{"attributes":{},"id":"1083","type":"UnionRenderers"},{"attributes":{"coordinates":null,"formatter":{"id":"1039"},"group":null,"major_label_policy":{"id":"1040"},"ticker":{"id":"1018"}},"id":"1017","type":"LinearAxis"},{"attributes":{"source":{"id":"1058"}},"id":"1063","type":"CDSView"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1060","type":"Line"},{"attributes":{"source":{"id":"1064"}},"id":"1070","type":"CDSView"},{"attributes":{"coordinates":null,"group":null,"text":"horse","text_align":"center","x":0,"y":1},"id":"1073","type":"Label"},{"attributes":{"overlay":{"id":"1027"}},"id":"1023","type":"BoxZoomTool"},{"attributes":{},"id":"1024","type":"SaveTool"},{"attributes":{"line_alpha":0.2,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1055","type":"Line"},{"attributes":{},"id":"1025","type":"ResetTool"},{"attributes":{},"id":"1082","type":"Selection"},{"attributes":{},"id":"1081","type":"UnionRenderers"},{"attributes":{"fill_color":{"field":"colors"},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1066","type":"Circle"},{"attributes":{},"id":"1087","type":"UnionRenderers"},{"attributes":{"coordinates":null,"group":null,"text":"cat","text_align":"right","x":-1,"y":0},"id":"1071","type":"Label"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"field":"colors"},"hatch_alpha":{"value":0.2},"line_alpha":{"value":0.2},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1068","type":"Circle"},{"attributes":{},"id":"1039","type":"BasicTickFormatter"},{"attributes":{"coordinates":null,"data_source":{"id":"1052"},"glyph":{"id":"1053"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"1055"},"nonselection_glyph":{"id":"1054"},"view":{"id":"1057"}},"id":"1056","type":"GlyphRenderer"},{"attributes":{"coordinates":null,"group":null,"text":"Mouse over the dots"},"id":"1003","type":"Title"},{"attributes":{},"id":"1018","type":"BasicTicker"},{"attributes":{},"id":"1088","type":"Selection"},{"attributes":{},"id":"1009","type":"LinearScale"},{"attributes":{},"id":"1021","type":"PanTool"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1054","type":"Line"},{"attributes":{"line_alpha":0.2,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1061","type":"Line"},{"attributes":{},"id":"1014","type":"BasicTicker"},{"attributes":{"source":{"id":"1052"}},"id":"1057","type":"CDSView"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"colors"},"hatch_alpha":{"value":0.1},"line_alpha":{"value":0.1},"line_color":{"field":"colors"},"size":{"value":6},"x":{"field":"x"},"y":{"field":"y"}},"id":"1067","type":"Circle"},{"attributes":{},"id":"1022","type":"WheelZoomTool"},{"attributes":{},"id":"1011","type":"LinearScale"},{"attributes":{"coordinates":null,"group":null,"text":"dog","x":1,"y":0},"id":"1072","type":"Label"},{"attributes":{"line_alpha":0.1,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1048","type":"Line"},{"attributes":{"axis":{"id":"1013"},"coordinates":null,"group":null,"ticker":null},"id":"1016","type":"Grid"},{"attributes":{},"id":"1085","type":"UnionRenderers"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1053","type":"Line"},{"attributes":{"data":{"colors":["blue","green","blue","red","red","blue","green","blue","green","green","red","red","blue","green","red","green","red","blue","red","blue","blue","blue","green","red","blue","green","red","green","red","blue","red","red","red","blue","blue","blue","green","blue","red","blue","red","green","green","blue","green","blue","blue","blue","red","red","red","red","blue","blue","green","green","red","green","blue","blue","green","green","red","green","green","green","green","blue","green","green","blue","green","green","blue","red","green","green","green","green","blue","red","red","red","green","green","green","blue","green","blue","blue","red","blue","blue","green","red","blue","red","green","green","blue","green","green","blue","blue","red","red","red","green","blue","green","red","blue","green","blue","green","red","green","green","red","blue","red","blue","blue","red","red","red","red","blue","green","green","blue","red","red","green","red","red","green","red","green","green","red","red","green","green","red","green","blue","blue","blue","green","blue","green","blue","red","green","blue","blue","blue","green","red","green","blue","blue","red","red","red","blue","red","blue","green","green","blue","green","green","red","blue","blue","blue","blue","blue","red","blue","green","red","blue","green","blue","green","green","red","green","blue","green","blue","green","green","red","green","green","blue","green","green","red","green","blue","red","red","red","green","green","green","green","blue","green","blue","red","green","red","blue","red","green","red","green","red","blue","green","red","blue","blue","green","red","blue","red","green","green","green","blue","blue","blue","blue","green","green","blue","green","red","blue","green","green","blue","red","red","green","green","red","green","blue","red","green","green","blue","green","green","red","blue","red","green","green","red","green","green","red","blue","red","blue","blue","green","blue","green","green","blue","green","green","green","red","red","blue","blue","red","red","green","red","blue","red","green","green","red","blue","green","blue","red","red","green","blue","red","green","red","blue","green","green","red","green","red","blue","green","green","green","blue","red","green","red","green","green","blue","green","blue","green","green","red","green","red","green","red","red","red","green","red","red","red","green","blue","red","blue","red","red","red","red","green","blue","red","blue","red","red","green","blue","green","green","blue","blue","green","red","green","green","red","red","green","blue","blue","red","red","red","green","red","green","blue","blue","blue","red","red","green","red","red","blue","green","green","green","blue","red","blue","blue","green","red","green","red","red","red","green","red","blue","green","red"],"desc":["horse","dog","horse","cat","cat","horse","dog","horse","dog","dog","cat","cat","horse","dog","cat","dog","cat","horse","cat","horse","horse","horse","dog","cat","horse","dog","cat","dog","cat","horse","cat","cat","cat","horse","horse","horse","dog","horse","cat","horse","cat","dog","dog","horse","dog","horse","horse","horse","cat","cat","cat","cat","horse","horse","dog","dog","cat","dog","horse","horse","dog","dog","cat","dog","dog","dog","dog","horse","dog","dog","horse","dog","dog","horse","cat","dog","dog","dog","dog","horse","cat","cat","cat","dog","dog","dog","horse","dog","horse","horse","cat","horse","horse","dog","cat","horse","cat","dog","dog","horse","dog","dog","horse","horse","cat","cat","cat","dog","horse","dog","cat","horse","dog","horse","dog","cat","dog","dog","cat","horse","cat","horse","horse","cat","cat","cat","cat","horse","dog","dog","horse","cat","cat","dog","cat","cat","dog","cat","dog","dog","cat","cat","dog","dog","cat","dog","horse","horse","horse","dog","horse","dog","horse","cat","dog","horse","horse","horse","dog","cat","dog","horse","horse","cat","cat","cat","horse","cat","horse","dog","dog","horse","dog","dog","cat","horse","horse","horse","horse","horse","cat","horse","dog","cat","horse","dog","horse","dog","dog","cat","dog","horse","dog","horse","dog","dog","cat","dog","dog","horse","dog","dog","cat","dog","horse","cat","cat","cat","dog","dog","dog","dog","horse","dog","horse","cat","dog","cat","horse","cat","dog","cat","dog","cat","horse","dog","cat","horse","horse","dog","cat","horse","cat","dog","dog","dog","horse","horse","horse","horse","dog","dog","horse","dog","cat","horse","dog","dog","horse","cat","cat","dog","dog","cat","dog","horse","cat","dog","dog","horse","dog","dog","cat","horse","cat","dog","dog","cat","dog","dog","cat","horse","cat","horse","horse","dog","horse","dog","dog","horse","dog","dog","dog","cat","cat","horse","horse","cat","cat","dog","cat","horse","cat","dog","dog","cat","horse","dog","horse","cat","cat","dog","horse","cat","dog","cat","horse","dog","dog","cat","dog","cat","horse","dog","dog","dog","horse","cat","dog","cat","dog","dog","horse","dog","horse","dog","dog","cat","dog","cat","dog","cat","cat","cat","dog","cat","cat","cat","dog","horse","cat","horse","cat","cat","cat","cat","dog","horse","cat","horse","cat","cat","dog","horse","dog","dog","horse","horse","dog","cat","dog","dog","cat","cat","dog","horse","horse","cat","cat","cat","dog","cat","dog","horse","horse","horse","cat","cat","dog","cat","cat","horse","dog","dog","dog","horse","cat","horse","horse","dog","cat","dog","cat","cat","cat","dog","cat","horse","dog","cat"],"imgs":["http://upload.wikimedia.org/wikipedia/commons/0/04/Puerto_rican-Paso-Fino-Horse-chestnut.jpg","http://www.publicdomainpictures.net/pictures/170000/velka/dog-1463218026uIC.jpg","https://upload.wikimedia.org/wikipedia/commons/0/03/American_quarter_horse.jpg","https://cattitudedaily.com/wp-content/uploads/2021/04/ragamuffin-cat-tabby-2048x1910.jpg","http://images.fineartamerica.com/images-medium-large/portrait-gray-tabby-cat-maika-777.jpg","https://images.pexels.com/photos/1848725/pexels-photo-1848725.jpeg?cs=srgb&dl=brown-horse-1848725.jpg&fm=jpg","https://www.rd.com/wp-content/uploads/2016/01/04-dog-breeds-dalmation.jpg","https://petkeen.com/wp-content/uploads/2021/03/camargue-horses_AB-Photographie_Shutterstock.jpg","https://www.petfriendlyhouse.com/wp-content/uploads/2019/09/Beagle-medium-sized-dog.jpg","https://i1.wp.com/www.smartdogguide.com/wp-content/uploads/2019/11/bluetickcoonhoundp2999433.jpg","http://www.bombadillokittens.com/sites/default/files/2018-10/IMG_4975 (1).JPG","https://i.pinimg.com/originals/e6/9b/6f/e69b6feb89a524682cf149d527026893.jpg","https://petkeen.com/wp-content/uploads/2021/02/Friesian-horse.jpg","https://1.bp.blogspot.com/-ch-4qlvZwCA/VB8f0HHRQyI/AAAAAAABLvA/wszcnHtPcyo/s1600/cute-dog-picture-039-06.jpg","https://i.pinimg.com/originals/37/3e/0f/373e0fc741e65f1cd73407c64bbe9881.jpg","https://thehappypuppysite.com/wp-content/uploads/2017/01/pomsky-pup-2.jpg","https://www.thesprucepets.com/thmb/zDe9ogiPL6LIBS3lyyl3bIbnTJo=/960x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-584178259-5a721010119fa80037ed3cce.jpg","https://wallup.net/wp-content/uploads/2016/01/209224-animals-horse-nature.jpg","https://novacatclinic.com/wp-content/uploads/2019/03/IMG_8668.jpg","http://www.wallpapers13.com/wp-content/uploads/2016/06/Brown-horse-HD-Desktop-Wallpaper-2880x1800.jpg","https://learn.zoner.com/wp-content/uploads/2020/02/photographing_horses_2.jpg?fidl=2019-06-mag-en","https://cmkt-image-prd.global.ssl.fastly.net/0.1.0/ps/5381214/1820/2161/m1/fpnw/wm1/spxxmju2chz0lzeqvzurjc25zg3d4hfdsmrhijwzqz1yodur8st9kg3qtbrlptme-.jpg?1542325213&s=f9635c6d8fba8cdae496f5ec89b47fe8","https://www.mydomaine.com/thmb/jjDL2MmYDrGi2MJ1Qa6Twvhte-I=/2121x1414/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-570112893-65d8c6056fbe4b55800b2672282c5cb5.jpg","https://i.pinimg.com/originals/0c/61/5a/0c615ae50ba457a1dcb0c4a235c56b7b.jpg","http://images4.fanpop.com/image/photos/22400000/Beautiful-Horse-horses-22410589-1280-800.jpg","http://wallpaper.1000webgames.com/wallpapers/lhasa_apso_dog_wallpaper-1024x768.jpg","https://i.pinimg.com/originals/a9/2e/f5/a92ef54a7c98db9856c70aa91a5d4a71.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/argentine-dogo-puppy-845537.jpg","https://www.rover.com/blog/wp-content/uploads/2019/10/tabby1.jpg","http://wallpapercave.com/wp/gbpDqB4.jpg","http://images2.fanpop.com/image/photos/9400000/Funny-Cats-cats-9474018-1600-1200.jpg","https://i.pinimg.com/originals/1e/53/f4/1e53f4e398a2c278f4f560ff37b3473d.jpg","https://i.redd.it/l5p0irttviqy.jpg","https://wallpaperaccess.com/full/3625270.jpg","https://3.bp.blogspot.com/-N6p7e0PHRAk/UYqthpMt_NI/AAAAAAAABAI/-MxAhFIuT3o/s1600/Horses.jpg","https://www.thesprucepets.com/thmb/wL1w-MchvvOK6S1CbL-KXN8NFBo=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-200419190-001-a3183e5bcbeb4073b26631ac0e72f9d5.jpg","https://1187604958.rsc.cdn77.org/data/images/full/34136/bulldog-puppy_1-jpg.jpg","https://images.unsplash.com/flagged/photo-1557296126-ae91316e5746?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1000&q=80","http://images4.fanpop.com/image/photos/16100000/Cute-Kitten-kittens-16123796-1280-800.jpg","https://i2.wp.com/ihearthorses.com/wp-content/uploads/2015/12/Canva-Horse-showing-its-teeth-scaled.jpg","http://www.animals-wallpapers.com/animal/eyes-lying-turquoise-cat.jpg","http://mydoggy.rocks/wp-content/uploads/2014/09/English-bulldog-face.jpg","http://3.bp.blogspot.com/-ZMpwMhvN1vc/VFZ330hGsBI/AAAAAAABN2A/92P-ImlDTmI/s1600/cute-dogs-045-18.jpg","http://www.wallpaperup.com/uploads/wallpapers/2014/10/22/489751/8453e5d82fa99f7888bf1016c37151a1.jpg","http://ghk.h-cdn.co/assets/cm/15/11/55003aaaddd3e-ghk-dogs-basset-hound-xl.jpg","https://i.pinimg.com/originals/4f/5f/09/4f5f090538d12e87fe9074ba050f1040.jpg","https://i.pinimg.com/originals/d4/7d/1b/d47d1bcfb80d97283777cf4a02821622.jpg","https://i2.wp.com/ihearthorses.com/wp-content/uploads/2019/12/Canva-Bashkir-Curly-Horse.jpg","http://www.zastavki.com/pictures/originals/2012/Animals_Cats_A_sad_cat_035924_.jpg","https://i.pinimg.com/originals/69/2b/75/692b75549f5e526c64cafa3b3f4514fb.jpg","https://serik.red/images/cat.jpg","https://i.pinimg.com/originals/88/a8/d5/88a8d5983fbfcfadf37e8af2cc928fde.jpg","https://cdn.globetrotting.com.au/20210101183944/apha-holley-3-e1609491034295.jpg","https://s-media-cache-ak0.pinimg.com/originals/93/2d/a0/932da09eae85aba47b8f065884098a92.jpg","https://www.rd.com/wp-content/uploads/2020/11/GettyImages-664712247.jpg?w=2122","https://cdn.fotofits.com/petzlover/gallery/img/l/cane-corso-puppy-850362.jpg","https://external-preview.redd.it/i5CeFNrTceC57C_VKC8yT7eXN7iY0M7c4oI9JOJ1nFg.jpg?auto=webp&s=0e759250e2b3321f15850e93d699284079c205ed","https://thehappypuppysite.com/wp-content/uploads/2016/07/boxer1.jpg","http://getwallpapers.com/wallpaper/full/a/3/e/851711-white-horse-wallpaper-1920x1080-high-resolution.jpg","https://www.pixelstalk.net/wp-content/uploads/2016/10/Arabian-Horse-Desktop-Background.jpg","https://img2.thepetowners.com/89/2016/1019/6d/3/012383/original.jpg","https://247wallst.com/wp-content/uploads/2019/10/imageforentry7-xfe.jpg","https://img2.goodfon.com/wallpaper/nbig/1/e9/cat-kot-koshka-trava-chernyy.jpg","https://cdn.hiconsumption.com/wp-content/uploads/2018/09/Beagle.jpg","https://wallpaperaccess.com/full/769179.jpg","https://windows10wall.com/wp-content/uploads/2014/06/Cute-Puppy-Small-Dog-HD-Free-Wallpaper.jpg","https://www.rd.com/wp-content/uploads/2021/07/GettyImages-1193273602.jpg?w=2121","https://www.hdwallpaper.nu/wp-content/uploads/2015/12/running-horses-desktop-wallpapers-in-high-resolution-animal-new-images.jpg","https://www.rover.com/blog/wp-content/uploads/2019/06/bernese-mountain-dog-1177074_1920.jpg","http://4.bp.blogspot.com/-SMl_snap74g/U4t4jVyI9pI/AAAAAAAA97k/-HWtPxIU97E/s1600/cute-dogs-023-010.jpg","https://wallpapercave.com/wp/AZi61P5.jpg","https://4.bp.blogspot.com/-Dggam2dsVY8/U53tP5KuZ0I/AAAAAAAA-nE/_l0e93v91G8/s1600/cute-dog-pictures-025-022.jpg","http://theilovedogssite.com/wp-content/uploads/2014/07/shutterstock_78199090.jpg","http://1.bp.blogspot.com/-10xJzh1bx7M/UH5r1yKH1sI/AAAAAAAAFpU/MVGHtZaURoc/s1600/Camargue-Horses-Galloping-On-The-Beach-1600x1200-white+horse-wallpapers-jokuci.jpg","https://dm0qx8t0i9gc9.cloudfront.net/thumbnails/video/HJpjKMlmgiw923pte/videoblocks-close-up-portrait-of-a-grey-cat-with-big-green-eyes_bgpfjoda7_thumbnail-1080_01.png","https://i.pinimg.com/originals/a0/f6/de/a0f6de8f6e0cdf1e76bf4befac1faf04.jpg","http://echomon.co.uk/wp-content/uploads/2013/02/Sad-Puppy-Face-Image.jpg","https://static01.nyt.com/images/2018/07/17/science/28MUTTS1/merlin_140330187_46f7d2a6-b0dd-4030-b8f4-357596850678-articleLarge.jpg?quality=90&auto=webp","https://res.cloudinary.com/jerrick/image/upload/f_auto,fl_progressive,q_auto,c_fit,w_680/sssqnncnvjsro6fjwdkp","http://cdn.wallpapersafari.com/21/2/csMvD6.jpg","https://nationalcatgroomers.com/wp-content/uploads/2017/11/angrycat.jpg","https://cdn.wallpapersafari.com/28/58/Iwsf7S.jpg","http://www.toledoblade.com/image/2014/05/28/800x_b1_cCM_z/n4fletchercat.jpg","https://petkeen.com/wp-content/uploads/2021/05/Italian-Greyhound_Linn-Currie_Shutterstock.jpg","https://freeaddon.com/wp-content/uploads/2017/10/cutest-dogs-5.jpg","https://images.wagwalkingweb.com/media/articles/dog/why-is-my-dog-barking/why-is-my-dog-barking.jpg","https://www.pixel-creation.com/wp-content/uploads/beauty-in-motion-white-horse-running-beautiful-horses-oh-my-800x800.jpg","https://wallpapercave.com/wp/wp2199359.jpg","http://3.bp.blogspot.com/-wPaSvc1DDZ4/VO-WvaOvjaI/AAAAAAAAqqw/rfAwFSjxF1E/s1600/754efe5928b7fee7d004d72d39948fb4+(1).jpg","https://www.horsespirit.site/wp-content/uploads/2019/10/ahw-cover.jpg","https://3.bp.blogspot.com/-7ABAaAViPyw/W84wG4scmQI/AAAAAAAAFUU/7jbp2CidXKYRRH81GIFOeEa7-D3GabJqgCLcBGAs/s1600/cat.jpg","https://wallpapercave.com/wp/0K6goRX.jpg","http://buzzsharer.com/wp-content/uploads/2015/06/girl-riding-horse.jpg","https://wallpaperset.com/w/full/2/8/c/6846.jpg","http://coleandmarmalade.com/wp-content/uploads/2018/04/bigstock-Kitten-736.jpg","https://horseracingsense.com/wp-content/uploads/2020/07/spotted1.jpg","https://i.pinimg.com/originals/6a/e7/f3/6ae7f382c0bdd7c0306fb5d5c8982418.jpg","https://i.pinimg.com/originals/9e/06/ca/9e06ca7e1da8f9980300af01b0c5f2c0.jpg","https://mediaproxy.salon.com/width/1200/https://media.salon.com/2009/02/praise_be_to_dog.jpg","https://extension.msstate.edu/sites/default/files/news/2017/20171121_auction.jpg","https://i2.wp.com/www.tor.com/wp-content/uploads/2017/03/blanco-patrick-stewart-dog.jpg?type=vertical","https://getwallpapers.com/wallpaper/full/1/2/f/1189248-large-weiner-dog-wallpaper-1920x1080-for-pc.jpg","https://i.pinimg.com/originals/6c/74/a6/6c74a6cdaa4965af1b22351f393df66f.jpg","https://fthmb.tqn.com/bk3gO3g8MLXsfzsrF6SHi9PFrqc=/4272x2848/filters:fill(auto,1)/close-up-of-horse-against-blue-sky-686788685-5aa9b26943a1030036c214ba.jpg","https://4.bp.blogspot.com/-9R6Zp7ihIm4/T92-zffEIpI/AAAAAAAAAJQ/-_9dhGEdgO8/s1600/American_Curl_Cat.jpg","http://www.petsamaritans.co.uk/wp-content/uploads/2013/03/IMG_0021.jpg","http://img1.wikia.nocookie.net/__cb20130404145553/darksouls/images/5/5b/Angry_Cat_Face_Wallpaper.jpg","http://1.bp.blogspot.com/_cUuIMoP_aeE/S73Lj3zCtyI/AAAAAAAACTQ/Z3k9Cyz2OfU/s1600/dog.jpg","http://www.whateats.com/wp-content/uploads/2010/04/horse-Seviwurst.jpg","https://canecorso-dog.com/wp-content/uploads/2020/04/cane-corso-puppy.jpg","https://1.bp.blogspot.com/-n0pl5uhddtE/XnbQjOnmefI/AAAAAAAAo_E/wTu7wR7rHv4J8m97S5SlwAVgbPld3f0vwCLcBGAsYHQ/s2560/kitten-cute-4k-if-1080x1920.jpg","https://wallpapercave.com/wp/wp3752965.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/canadian-eskimo-dog-puppies-850359.jpg","https://s3-eu-west-1.amazonaws.com/fei-fan-production/s3fs-public/jumping-level-6.jpg","https://www.swremovals.com.au/wp-content/uploads/2018/01/dog.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Cat_November_2010-1a.jpg/1200px-Cat_November_2010-1a.jpg","http://res.publicdomainfiles.com/pdf_view/186/14007042616491.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/beauceron-dog-851530.jpg","http://24.media.tumblr.com/e3ecdec281e922403ad07226e523e7de/tumblr_mzv0c2BbYh1spbqkko1_1280.jpg","https://i.pinimg.com/originals/bd/09/e5/bd09e5f86b6ddee9b7bdeefa7cd1310f.jpg","https://i.pinimg.com/originals/e2/dc/46/e2dc4613fb58e35eeccc1418057ceb0f.jpg","https://i.pinimg.com/originals/7b/00/11/7b001112943212347184d632b881180a.jpg","http://wallpapercave.com/wp/OZY1C4c.jpg","https://i.pinimg.com/originals/6e/98/4d/6e984d07c7b24f3a015cd93e9c0475cc.jpg","http://wallpaper.1000webgames.com/wallpapers/russian_blue_cat_wallpaper-1024x768.jpg","http://petcarelive.com/cats/1280x1024/www.PetCareLive.com_113.jpg","http://uploads.neatorama.com/images/posts/558/88/88558/1456422050-0.jpg","https://www.storypick.com/wp-content/uploads/2021/03/horse.jpg","https://content.thriveglobal.com/wp-content/uploads/2018/07/happy-dog.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/canadian-eskimo-dog-dog-850358.jpg","https://i.pinimg.com/originals/73/50/d6/7350d6fad6f10e20c1b6079161fb9f11.jpg","https://i.pinimg.com/originals/42/26/00/422600045dc93960e3ef2feb104f56b0.jpg","https://catvills.com/wp-content/uploads/2020/12/cat-breeds-with-short-ears-a.jpg","https://dogstodaymagazine.co.uk/wp-content/uploads/2017/04/dog-513109_960_720.jpg","https://blog.seattlepi.com/lifestyle/files/2020/07/load-image-2.jpg","http://3.bp.blogspot.com/-8wXZ_DBVneY/TuTUuyJVfVI/AAAAAAAAC2I/Tpdp4Jd6ieU/s1600/cat.jpg","https://www.myconfinedspace.com/wp-content/uploads/2018/07/crazy-hair-dog-1000x1392.jpg","http://i.huffpost.com/gen/1255643/images/o-POLYDACTYL-CAT-facebook.jpg","https://2.bp.blogspot.com/-hj3v8mWs-7A/VxPic152kyI/AAAAAAABmS4/s0ax-9fAmnUw0QbUAgYUjfx5jC_IZ2SLACLcB/s1600/cute-dogs-121-09.jpg","https://www.lifewithdogs.tv/wp-content/uploads/2015/03/3.13.15-Beautiful-Frosted-Faces10.jpg","https://graffitiwallpaper.com/pics/listings/327_wide.jpg","https://lh3.googleusercontent.com/-eZdHL13VpTk/TYYZh7BFCWI/AAAAAAAAALY/553luA1hfAc/s1600/chincilla+cat.jpg","https://spot-and-tango.s3.amazonaws.com/production/media/Cane_Corso_2019-08-29T203106.jpg","https://firstvet.com/uploaded/images/articles/dog-haircut.jpg","http://img0.joyreactor.com/pics/post/full/cat-photo-cuteness-overload-sandbox-1039162.png","https://www.thesprucepets.com/thmb/vmNFp9rgmOXtTMjqx_A1ttL5YJc=/1500x1000/filters:fill(auto,1)/GettyImages-1153579373-c04e0cd078d04eaf8d60d41611638c9d.jpg","http://wallpapercave.com/wp/OnzEo4S.jpg","http://upload.wikimedia.org/wikipedia/commons/d/d4/Nokota_Horses.jpg","http://3.bp.blogspot.com/-dUwi1QoodX0/UPECUd6aOVI/AAAAAAAAF1A/YbZupELj5J4/s1600/Beauity+of+the+Wild+Horses.jpeg","https://img.dog-learn.com/dog-breeds/bavarian-mountain-hound/bavarian-mountian-hound-i3.jpg","http://tailandfur.com/wp-content/uploads/2016/08/10-Best-Horse-Breeds-List-1.jpg","https://www.pupvine.com/wp-content/uploads/2021/03/the-little-dog-is-lying.jpg","https://www.desktopbackground.org/download/800x600/2012/07/30/428769_horses-beautiful-horse-horses-wallpaper-backgrounds-free-for-hd-16_1024x768_h.jpg","https://wallpaperset.com/w/full/4/6/6/79207.jpg","https://images.wagwalkingweb.com/media/articles/dog/why-is-my-dog-dragging-back-leg/why-is-my-dog-dragging-back-leg.jpg","https://wallpapertag.com/wallpaper/full/c/c/d/922066-amazing-cute-horse-wallpapers-1920x1200-mobile.jpg","https://wallpaperaccess.com/full/1765868.jpg","https://images8.alphacoders.com/999/999039.jpg","https://i.pinimg.com/originals/75/f6/b4/75f6b49f1f98176c5f0279c486da68b4.jpg","https://thewondrous.com/wp-content/uploads/2015/05/adorable-kittens-765x1024.jpg","https://pngimg.com/uploads/dog/dog_PNG50410.png","https://cdn.britannica.com/00/1300-050-49EB3BE5/Arabian-horse-mountain-slope-endurance-race.jpg","https://i.pinimg.com/originals/31/0a/01/310a01342164636621033e7d7ddc1f14.jpg","http://www.wallpaperup.com/uploads/wallpapers/2012/04/21/2320/54531e03997b80ed51f8e01c226b3b13.jpg","http://i.imgur.com/twGxY.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/ragdoll-697072.jpg","https://wallpapercave.com/wp/wp3353528.jpg","https://3.bp.blogspot.com/-qvHpXlkIlC0/UJUpflVKqtI/AAAAAAAAAoE/A6TK1pHl4mo/s1600/Shocked+Cat+Face.jpg","https://i.pinimg.com/originals/7e/37/43/7e3743267beab1a855fdde40da891482.jpg","https://www.publicdomainpictures.net/pictures/60000/velka/dog-great-dane.jpg","https://ipupster.com/wp-content/uploads/2021/03/Chow_Chow_Dog_Breed_DP35427885.jpg","https://www.wallpaperup.com/uploads/wallpapers/2016/02/14/893771/ee18d158cf4e3e271cf7bc467332a7c8.jpg","https://img.buzzfeed.com/buzzfeed-static/static/2015-10/27/9/enhanced/webdr12/grid-cell-8465-1445952942-8.jpg","http://wallpaper.1000webgames.com/walls/boxer_dog_picture_wallpaper-other.jpg","http://3.bp.blogspot.com/_9dghOljNcaU/TLtoTq03NsI/AAAAAAAABOk/rNRLobWyCB4/s1600/cat6.jpeg","http://2.bp.blogspot.com/-BhQ1BvOGEwI/T8uJbjt9X7I/AAAAAAAANNU/mNf4QHYgqsk/s1600/horse+(16).jpg","https://i.pinimg.com/originals/b6/c5/43/b6c543430c1d8cb7a828026b249e6a46.jpg","https://i.pinimg.com/736x/16/1f/38/161f38fe1a9a0a9e6e628f872c2e2c12--american-paint-horse-painted-horses.jpg","https://cdn.wallpapersafari.com/31/79/1Iykad.jpg","https://i.pinimg.com/originals/0e/ad/e0/0eade044a788554bb77ca4f34becbb94.jpg","https://images.pexels.com/photos/3919680/pexels-photo-3919680.jpeg?cs=srgb&dl=photo-of-cat-sleeping-on-the-couch-3919680.jpg&fm=jpg","https://horseyhooves.com/wp-content/uploads/2019/09/Fastest-horse-breed-the-thoroughbred-1024x649.jpg","https://pngimg.com/uploads/dog/dog_PNG50409.png","https://1.bp.blogspot.com/-9e6MDPAf-Ps/Te6A73o9JdI/AAAAAAAAASw/5sY8eRMGpdE/s1600/catblog1.jpg","http://t.wallpaperweb.org/wallpaper/animals/1600x1200/S4wQuarterHorses005.jpg","https://www.rover.com/blog/wp-content/uploads/2015/03/pink-haired-dog.jpg","http://www.publicdomainpictures.net/pictures/90000/velka/horse-1400502729BYL.jpg","https://free4kwallpapers.com/uploads/originals/2015/10/08/cute-husky-puppy.jpg","http://1.bp.blogspot.com/-Y3RJkQrGMgM/Ta1CEGS0c6I/AAAAAAAAAfM/I1FihEonFCI/s1600/dogs_a3591a39.jpg","https://www.shropshirestar.com/resizer/D5xUVAljbihVRyd-P2HDKQGjsF8=/1200x0/cloudfront-us-east-1.images.arcpublishing.com/mna/D3XGPWQCFZHSTINJGJ77Q2MW7A.jpg","https://media-be.chewy.com/wp-content/uploads/2020/01/03114844/how_old_is_the_oldest_dog-1.jpg","https://i.pinimg.com/736x/77/bf/49/77bf49ce84e426ac9d495d4112524a8c--horse-face-horse-head.jpg","http://3.bp.blogspot.com/-ne00ibGTLgE/T7cCATEIsAI/AAAAAAAAlOQ/3MI5fEFUtmo/s1600/dog+Farley+by+asterisk+The+Happy-Snapper+on+Flickr.jpg","http://www.yurtopic.com/science/nature/images/horse-myths/White-Horse2.jpg","https://i.pinimg.com/originals/b8/21/47/b82147bbb08c48006a22160f3519768a.jpg","https://i.pinimg.com/originals/b7/bd/5a/b7bd5ab248a84a313db5073cb7684939.jpg","http://getwallpapers.com/wallpaper/full/2/c/2/1179567-free-download-cat-hd-wallpapers-1080p-1920x1200-for-tablet.jpg","https://i.ytimg.com/vi/dRBD4mFabGA/maxresdefault.jpg","https://i.pinimg.com/736x/8b/5f/2d/8b5f2d06b1717e60314cc272a626d2db.jpg","https://i.pinimg.com/originals/39/f5/f9/39f5f93fd2f4102b4c3cc46e02588229.jpg","https://postmediatorontosun.files.wordpress.com/2017/11/dog1000.jpg","http://elelur.com/data_images/dog-breeds/pekingese/pekingese-02.jpg","https://i.pinimg.com/originals/cd/0f/88/cd0f88d9b23cdb47487002e41adefe7c.jpg","http://animalsbreeds.com/wp-content/uploads/2015/12/Australian-kelpie-6.jpg","https://i.pinimg.com/originals/70/ae/2b/70ae2bbf08cbd3730fb6dc08072b65af.jpg","http://www.koalie.net/Walks/200310-CA-J9-11/20031007160316.jpg","http://cdn0.wideopenpets.com/wp-content/uploads/2018/02/cat-1208013_1280.jpg","https://cdn.mos.cms.futurecdn.net/XpUWN4UcUkE3NYGt9MF7AP-1200-80.jpg","https://i.pinimg.com/originals/dd/24/ca/dd24ca12a9e626bedc65f351aa096aac.jpg","http://4.bp.blogspot.com/-GOOCS9LbwP8/Taz7HOWknfI/AAAAAAAAACs/V7sR0wpvMKM/s1600/Cute+Puppy+Dog.jpg","https://i0.wp.com/allbigdogbreeds.com/wp-content/uploads/2015/06/English-Pointer-1.jpg?ssl=1","https://api.time.com/wp-content/uploads/2015/06/ugly-dog.jpg","https://i.pinimg.com/736x/bf/3b/d3/bf3bd388c44d7b214961902e93074a25.jpg","https://muisephoto.files.wordpress.com/2020/09/dogs-0900.jpg","http://www.hedweb.com/animimag/horse-sea.jpg","https://img.wallpapersafari.com/desktop/1680/1050/62/97/j7DWvq.jpg","https://cdn.wallpapersafari.com/76/99/cKvf4L.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/tuxedo-kitten-891973.jpg","http://www.holisticanimalstudies.org/uploads/8/2/1/7/8217904/rio-with-saddle_orig.jpg","https://purrfectnpawesome.com/wp-content/uploads/2020/05/why-cant-my-cat-retract-its-claws.jpg","http://www.petpaw.com.au/wp-content/uploads/2014/05/Greyhound-5.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/himalayan-persian-616448.jpg","https://doggiebreeds.com/wp-content/uploads/2017/05/Small-Dog-Breeds-Short-Hair.jpg","https://excitedcats.com/wp-content/uploads/2021/03/diluted-calico-cat_Seattle-Cat-Photo_Shutterstock.jpg","https://i.pinimg.com/originals/5b/e1/45/5be1454051488d7767e9468d250df6d3.jpg","https://res.cloudinary.com/petrescue/image/upload/petrescue-production-s3/uploads/pet_photos/226224_a8618_orig.jpg","https://static.independent.co.uk/s3fs-public/thumbnails/image/2017/03/31/12/istock-168282777.jpg","https://1.bp.blogspot.com/_CFzTCGYYd38/S_omlJvYrqI/AAAAAAAAAD0/ilSuGDA55Cg/s1600/horse-776493.jpg","https://i.pinimg.com/736x/08/f4/17/08f4179d77aed5d3a56ce40ca1544b7e.jpg","http://www.siacybox.co.uk/images/razor boxer head .JPG","https://cdn.wallpapersafari.com/65/58/U4Na2l.jpg","https://i.pinimg.com/originals/bc/53/9e/bc539e547595c51b98c38c9a38ebecc1.jpg","https://i.pinimg.com/originals/48/f2/d7/48f2d71f3a8194226e7a63d8af1cba84.jpg","https://img.dog-learn.com/dog-breeds/carolina-dog/carolina-dog-i3.jpg","https://i.pinimg.com/originals/24/bc/1b/24bc1b4f7fe377849b845c3182f47b4c.png","https://i.pinimg.com/originals/2d/d4/d8/2dd4d831f4f81e638faf1b32aa664a97.jpg","https://i.ytimg.com/vi/SVIPAWLyCPY/maxresdefault.jpg","https://i.pinimg.com/736x/64/ca/7a/64ca7ac1152c573438bd21357ab931a4--blue-roan-horses-black-horses.jpg","http://wallpapercave.com/wp/b8Towec.jpg","https://www.thesprucepets.com/thmb/1VDMSFCGdgVVmuPHJ7BQrnrk8sg=/960x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-543346155_medium-56a4dd9d5f9b58b7d0d993a2.jpg","https://i.pinimg.com/originals/92/5f/ef/925fefa5b028849fc7328ad6e5064be3.jpg","https://petstruggles.com/wp-content/uploads/2019/06/Best_Frisbee_for_dogs_pet_Struggles.jpg","https://fthmb.tqn.com/NDZqhMC38DXIIU7ZQBUKbc-ucc0=/5447x3632/filters:fill(auto,1)/thoroughbred-horse-in-stable-523757961-582d22cd3df78c6f6a004282.jpg","https://animalcorner.org/wp-content/uploads/2020/05/American-Bully-2-1024x896.jpg","https://cdn.pixabay.com/photo/2016/04/04/14/32/cat-1307332_960_720.jpg","https://www.zooborns.com/.a/6a010535647bf3970b022ad37eeb02200d-800wi","http://2.bp.blogspot.com/-z6SeA8Av-rU/VYrAw0obSEI/AAAAAAAAApk/YdwLCFNaeb4/s1600/beautiful-golden-retriever-dog-wide-hd-wallpapers-free-download-dog-pictures.jpg","https://thehappypuppysite.com/wp-content/uploads/2017/03/shar-pei-6.jpg","https://wallpapercave.com/wp/UxvWbn9.jpg","https://cdn.shopify.com/s/files/1/0344/6469/files/maine_coon_ears.png?v=1497986283","https://www.hdwallpapers.in/download/blue_eyes_cat_kitten_on_chair_hd_cute_cat-HD.jpg","https://forums.steroid.com/attachments/anabolic-lounge-off-topic-discussion/99867d1243783859-dogs-imag0001.jpg","https://s3.amazonaws.com/petcentral.com/wp-content/uploads/2016/12/21132924/cute-japanese-dog-breed-dogs.jpg","http://tensorflow.org/images/blogs/serving/cat.jpg","https://i.pinimg.com/originals/e3/f4/8a/e3f48aa871540fadf6cb5a1a6af76c5c.jpg","https://www.pixelstalk.net/wp-content/uploads/2016/07/Black-Horse-Pictures-HD.jpg","https://i2.wp.com/www.petfriendlyhouse.com/wp-content/uploads/2018/10/popular-cats-that-dont-shed.jpg?fit=955,637&ssl=1","https://imgix.bustle.com/uploads/image/2019/9/23/e3a3eb20-0820-4dcf-a53b-c8613ac1673f-it_dog_costume.png","http://wallpaper.1000webgames.com/wallpapers/rottweiler_dog_wallpaper_white-1600x1200.jpg","https://i.pinimg.com/originals/40/e8/5f/40e85f39baea65c0bfc8535372478763.jpg","https://cdn3-www.dogtime.com/assets/uploads/gallery/german-shepherd-dog-breed-pictures/standing-7.jpg","https://hips.hearstapps.com/ghk.h-cdn.co/assets/18/02/768x1151/gallery-portuguese-podengo.jpg?resize=480:*","https://i.pinimg.com/736x/99/84/ea/9984ea3de835bffcda9b81eb9f37f48b--asian-leopard-cat-the-wild.jpg","http://www.wallpapers13.com/wp-content/uploads/2016/03/Brown-and-red-horse-running-in-a-field-of-green-grass-desktop-wallpaper-HD.jpg","https://images.fineartamerica.com/images-medium-large/bengal-cat-sitting-on-weathered-deck-itsabreeze-photography.jpg","https://i.pinimg.com/originals/b2/f2/04/b2f20496fdb5cb2ef937316e9f195a5d.jpg","https://d2434a0nr1d7t1.cloudfront.net/p/D985_48_165/D985_48_165_1200.jpg","https://s-media-cache-ak0.pinimg.com/originals/8b/c8/b4/8bc8b49b51f74998469b595850b4bb97.jpg","http://www.animal-photos.org/_photo/5077810.jpg","http://wallpaper.1000webgames.com/wallpapers/funny_pomeranian_dog_wallpaper-1600x1200.jpg","https://nypost.com/wp-content/uploads/sites/2/2015/03/japan-cats_-2.jpg?quality=90&strip=all","http://www.animal-photos.org/_photo/5330628.jpg","https://3.bp.blogspot.com/-VDl8FW59RfY/T92-QmKibfI/AAAAAAAAAIQ/16nIT8pYSfQ/s1600/800px-American_curl_large.jpg","https://torange.biz/photofxnew/179/HD/horse-standing-hind-legs-179368.jpg","https://i.pinimg.com/originals/b4/9f/f8/b49ff8398f184770132196fbcf11ec25.jpg","http://cdn.akc.org/content/hero/small_dogs_basenji.jpg","https://i.pinimg.com/originals/ed/af/24/edaf24ca38b4480353ac358c09e0d7d6.png","http://doggiebreeds.com/wp-content/uploads/2017/03/Best-Large-Dog-Breeds-For-Families.jpg","http://earstoday.com/wp-content/uploads/2020/07/ear-muff-dog-parking.jpg","https://2.bp.blogspot.com/-uLQMp1pqCDY/UyX6-93SEbI/AAAAAAAAAbo/SnIt3rVLfsY/s1600/Charles+horse+Photo.jpg","https://usercontent1.hubstatic.com/6935118_f520.jpg","http://1.bp.blogspot.com/-Ay1hAfPfC7Q/UgtQ6_AnxmI/AAAAAAAAAOA/JgAAmMjrA0M/s1600/Papillon-Puppies-02.jpg","https://www.professorshouse.com/wp-content/uploads/2015/03/dog-131.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/smoke-cat-892716.jpg","http://zezete2.z.e.pic.centerblog.net/o/5b11c009.jpg","https://i.ytimg.com/vi/t9SSm9x4ViA/maxresdefault.jpg","http://getwallpapers.com/wallpaper/full/7/1/8/510559.jpg","https://excitedcats.com/wp-content/uploads/2021/02/cat-rubbing-itself-on-cat-tree_chie-hidaka_Shutterstock.jpg","https://wallpaperaccess.com/full/275898.jpg","https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/chinese-dog-breeds-chow-chow-1570542227.jpg","https://i.pinimg.com/736x/a3/20/6e/a3206e2bf3657b92c025f77fe3be9580.jpg","https://ihearthorses.com/wp-content/uploads/2019/12/Artboard-1-100-3.jpg","http://static.boredpanda.com/blog/wp-content/uploads/2016/02/big-cute-eyes-cat-black-scottish-fold-gimo-1room1cat-122.jpg","https://4.bp.blogspot.com/--9PfDjxbw14/VXSYmBs4qoI/AAAAAAABYQA/_-fUQO1sxzY/s1600/cute-dogs-076-31.jpg","https://i.pinimg.com/originals/6e/03/ce/6e03ce84682b3d4845b191ff8a4f8397.jpg","http://wallpaper.1000webgames.com/wallpapers/black_cat_wallpaper-800x600.jpg","http://cdn.wallpapersafari.com/59/69/2sUkYT.jpg","https://img.dog-learn.com/dog-breeds/anatolian-shepherd-dog/anatolian-shepherd-dog-puppy-i2.jpg","http://upload.wikimedia.org/wikipedia/commons/9/98/Horse-and-pony.jpg","https://images.gutefrage.net/media/fragen/bilder/welche-katzenrasse-soll-das-sein/0_original.jpg?v=1484412515000","http://www.baltana.com/files/wallpapers-13/Cat-Black-Background-HD-Wallpaper-34135.jpg","https://petsinthecity.me/wp-content/uploads/2018/09/orig_82888.jpg","https://blog.fansbet.com/wp-content/uploads/2020/02/PA-42006913-min.jpg","https://i.pinimg.com/originals/70/0f/8c/700f8c7a096c10000199874bc054b755.jpg","https://external-preview.redd.it/fIm6xlH_z-wAsB4KG2Olr0-HHaRpEVSe3X4UgqyyIMw.jpg?auto=webp&s=2203699163179a165d5659c5a8e81a8c8432d6c6","https://i.redd.it/fb3o2iphysh01.jpg","http://cloudfront.horsenetwork.com/sites/4/2016/04/statue1.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/cockachon-dog-842155.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/alaskan-malamute-dog-658586.jpg","https://cdn.wallpapersafari.com/95/45/GWwTV8.jpg","https://i.pinimg.com/originals/21/99/10/21991071134a7b7e214272afa47c9fb6.jpg","https://i.ytimg.com/vi/96wvCn3Hqfc/maxresdefault.jpg","https://i.pinimg.com/originals/3d/34/25/3d342570cfa3e245179a9603f0f13e72.jpg","http://wallpaper.1000webgames.com/wallpapers/samoyed_dog_desktop_wallpaper-800x600.jpg","https://1.bp.blogspot.com/-mLI73ZAShgM/V0IGRvSvOPI/AAAAAAABnQw/Zd-tYv3NrF0kQM5hTe8Ptcwa8oM9qHA4QCLcB/s1600/cute-dogs-126-09.jpg","https://images.wagwalkingweb.com/media/training_guides/become-a-therapy-dog/hero/become-a-therapy-dog.jpg","https://i.pinimg.com/originals/1e/41/a3/1e41a3c6c01f6ffa74c76c32bab5fc86.jpg","https://e7.pngegg.com/pngimages/582/702/png-clipart-grumpy-cat-meme-humour-mouse-cat-animals-cat-like-mammal.png","http://images6.fanpop.com/image/photos/39000000/Dogs-dogs-39079730-500-667.jpg","https://i.ytimg.com/vi/VlPGHW0gdHQ/maxresdefault.jpg","https://www.thoughtco.com/thmb/ei8Wd-haYjOKljZ70_u4-ljJVAs=/768x0/filters:no_upscale():max_bytes(150000):strip_icc()/10175702-56a133883df78cf7726858ed.jpg","https://wedding-pictures.onewed.com/match/images/214289/Dog.full.jpg","https://i.pinimg.com/originals/b9/8c/78/b98c78ed99f540336b9be0c10a12b747.jpg","http://4.bp.blogspot.com/--CsI1VpbQkk/T8Wkadbv4ZI/AAAAAAAABCc/8ZWwyjreVwQ/s640/dogs11image.jpg","https://cdn.wallpapersafari.com/41/5/A8lOdy.jpg","http://i1.wp.com/www.dogshaming.com/wp-content/uploads/2013/02/DSCN1780.jpg","http://2.bp.blogspot.com/-ZpXkgRYehUw/VODq5jHgmVI/AAAAAAABS3Q/-iI0Pv-LhW4/s1600/cute-dogs-060-30.jpg","https://i.pinimg.com/736x/f6/a1/0e/f6a10e9769f71a59c3462fc6f4938264--grey-tabby-cats-kitty-cats.jpg","http://4.bp.blogspot.com/-6hmpBg6rl9c/VT1C1Qg3XFI/AAAAAAABWRU/LYkBlh7I1uE/s1600/cute-dogs-070-22.jpg","https://www.sickchirpse.com/wp-content/uploads/2012/06/cat.jpg","https://tailandfur.com/wp-content/uploads/2015/12/15-Types-of-Large-Dog-Breeds-with-Pictures-6.jpg","http://seniors101.ca/wp-content/uploads/2012/03/mivh-march2012-ringworm-cat.jpg","http://wallpaper.1000webgames.com/wallpapers/mean_angry_cat_pc_wallpaper-1920x1200.jpg","http://1.bp.blogspot.com/_en3tE7aKwk8/S_Fe1eIsQ3I/AAAAAAAAB9U/WjcQfzigCxE/s1600/massive+cat.jpg","https://www.gannett-cdn.com/-mm-/85449fbc41c398e7c5b48c70a65989a2f9e202e5/c=142-0-2437-1721&r=x404&c=534x401/local/-/media/2017/08/21/AsburyPark/B9328985188Z.1_20170821134903_000_G6AJCHE3R.1-0.jpg","https://i.pinimg.com/originals/d0/6e/51/d06e51d78ea72955085249dfefae46a7.jpg","https://www.wallpapergeeks.com/wp-content/uploads/2015/01/sand-cat-family-wallpaper.jpg","https://i.pinimg.com/originals/53/11/31/531131ab46b89268f86578d6ee8640ac.png","http://d.ibtimes.co.uk/en/full/380140/dogs.jpg?w=720","https://i.pinimg.com/originals/34/0b/a1/340ba1bc2e1829ffb90b9ee343e59079.jpg","https://coleandmarmalade.com/wp-content/uploads/2018/09/Prego-to-the-max.jpg","https://img.wallpapersafari.com/desktop/1920/1080/22/70/9YJtzh.jpg","https://i.pinimg.com/originals/72/c2/61/72c261989b3fb33dcaa5c04e935c1ffa.jpg","https://purrpetrators.com/wp-content/uploads/2018/08/h1.jpg","https://cdn.shopify.com/s/files/1/0344/6469/files/cat_holiday_costume.png?v=1507227808","https://extraordinarynews.weebly.com/uploads/2/6/4/3/26430154/7985025_orig.jpg","http://1.bp.blogspot.com/-wFiY9BiG7aE/UyXophWZHOI/AAAAAAAA5dE/cxECaA36JTo/s1600/cute-dog-pictures-013-004.jpg","http://discoverstclair.com/wp-content/gallery/aradon_shangrila/aradon-horses-4.jpg","https://i.redd.it/rfqazte2jnc01.jpg","https://i.pinimg.com/originals/7c/bb/2c/7cbb2cb75e44afe22eb0f26df14db9e7.jpg","https://i.ytimg.com/vi/z3TTafZ0KZU/maxresdefault.jpg","https://wallpapercave.com/wp/wp3249459.jpg","https://media-cldnry.s-nbcnews.com/image/upload/t_fit-760w,f_auto,q_auto:best/MSNBC/Components/Photo/_new/dog.jpg","http://www.blackhillsphoto.com/blackhills/harney/P3136666.jpg","https://manofmany.com/wp-content/uploads/2019/11/Best-Hunting-Dog-Breeds.jpg","https://usercontent2.hubstatic.com/7781875_f120.jpg","https://i.pinimg.com/originals/c5/97/69/c59769b4ea86b261e1ffb6a4c4376612.jpg","https://i.pinimg.com/originals/ad/73/06/ad7306aecbcd2286057fb36760e73fb0.jpg","http://pluspng.com/img-png/dog-png-png-file-name-dog-800.png","https://www.1800flowers.com/blog/wp-content/uploads/2016/08/kitten-cat-with-daisies.jpg","https://www.dogster.com/wp-content/uploads/2018/01/Dogs-with-wide-eyes-Whale-eye-in-dogs.jpg","http://wallpaper.1000webgames.com/wallpapers/fox_terrier_dog_wallpaper-1024x768.jpg","http://i.imgur.com/vKtqzcw.png","https://catvills.com/wp-content/uploads/2019/01/orange-cat-names.jpg","https://i.pinimg.com/736x/e2/54/2f/e2542f74bc3e3447e35749102b1a9961--amazing-dogs-beautiful-dogs.jpg","http://www.myhorse.ca/images/Belgian-horse.jpg","http://3.bp.blogspot.com/-GPV8c4J1OqQ/T_1zSVREqYI/AAAAAAAAMsA/KpOTJzLYWlw/s1600/Horse.jpg","https://i.pinimg.com/originals/24/02/5d/24025db2da137073dbe6755dbbc90db2.jpg","https://www.petsecure.com.au/wp-content/uploads/2015/01/Persian-Cat.jpg","https://m.media-amazon.com/images/M/MV5BMjA5YTFlNzYtZmU5Ni00Y2Y2LWFmMTktNGFlZjE0MWIwMDJmXkEyXkFqcGdeQXVyMjMwODE4ODI@._V1_.jpg","https://i.pinimg.com/736x/5e/db/3e/5edb3e02c74eccd5df0c3fa5fd5209bd--burmese-mountain-dogs-weheartit.jpg","https://pluspng.com/img-png/png-cute-cat--828.png","http://doggies.com/blog/wp-content/uploads/2011/04/dreamstime_2260248-247x350.jpg","http://1.bp.blogspot.com/_pq6ZtsfBob0/TLJj50aVkDI/AAAAAAAAA-A/JLUz60Xdk9Y/s1600/20101001-IMG_7984.jpg","https://i.pinimg.com/originals/21/49/9d/21499dc2f0954a9d2b7d78506523ab28.jpg","https://steemitimages.com/DQmTfhFqoCEWmvLJFqMyyBif68gMu86MZETRSHmmpNJYQ82/4488662-funny-horse-wallpapers.jpeg","http://www.lifewithcats.tv/wp-content/uploads/2016/01/cat-singing-41.jpg","https://www.professorshouse.com/wp-content/uploads/2015/03/cat-145.jpg","https://dogeducated.com/wp-content/uploads/2015/10/intermediate-1.jpg","https://loveandkissespetsitting.net/wp-content/uploads/2017/12/Cat-under-Christmas-tree-1024x773-1.jpg","https://cdn.wallpapersafari.com/52/59/LZCIJc.jpeg","http://images.fineartamerica.com/images-medium-5/horse-jocelyn-banfield.jpg","https://i.pinimg.com/originals/be/0a/f9/be0af9f23ea73fc87b677cb3902d9d29.jpg","https://cdn.fotofits.com/petzlover/gallery/img/l/miniature-poodle-puppies-817189.jpeg","https://cdn.abcotvs.com/dip/images/820049_063015-cc-dog-walk-thumb.jpg?w=1280&r=16:9","https://i.pinimg.com/736x/59/e7/6a/59e76ae39a740363956d687c45e30de6.jpg","https://images6.fanpop.com/image/photos/38100000/Cats-cats-38192830-540-469.jpg","https://i.pinimg.com/736x/be/c1/19/bec119580aa05c9c5ba6466509f8da44--beauty.jpg","https://s3-us-west-2.amazonaws.com/courses-images/wp-content/uploads/sites/1087/2017/01/16194026/Red_roan_Quarter_Horse.jpg","https://www.security-guard.ca/wp-content/uploads/2015/03/6053652632_a21cb49ac5_o.jpg","https://lookaside.fbsbx.com/lookaside/crawler/media/?media_id=100063494021160","https://bloximages.chicago2.vip.townnews.com/tucson.com/content/tncms/assets/v3/editorial/d/11/d11a29e4-78a5-51fe-87f1-983b2fcf1324/58016c5fd7f0b.image.jpg?resize=1200,1175","http://4everstatic.com/pictures/850xX/animals/cats/cat-138841.jpg","https://i.imgur.com/OQiW0Mt.jpg","https://i.pinimg.com/736x/cb/ca/32/cbca324e455120f45b7d832f1038355f.jpg","https://singularityhub.com/wp-content/uploads/2013/02/dogB.jpg","https://iheartcats.com/wp-content/uploads/2015/04/shutterstock_191341337.jpg","http://2.bp.blogspot.com/-vlOzughAuaw/UO6_1WeTibI/AAAAAAAAAak/o1JLHnzTk6I/s1600/black+horse+30.jpg","https://freepngimg.com/thumb/dog/15-dog-png-image-picture-download-dogs.png","http://4.bp.blogspot.com/-mRmtKED3jlM/UhXB2VQKa5I/AAAAAAAAA2M/MXf9XFJk7Vo/s1600/cat.jpg"],"x":{"__ndarray__":"Qra9nHZyzT9lPLICFb/dP/MBQu2q6Ig/nfJbbL1x6b98kL/NiXnhv0mxIboIUak/aLc7IR651T95wtMlYIfRv3MxRHSJ1uA/TCWCwuI73j9RMpRzf7bbvxppB8bGjuG/htNzxQxT0D9MdwNAKjbKP0/reU1oOeq/IUwe1J6B5z/GER8FlNTiv2IMK3m2ZMK/nl6Gu0nB7L8mO2Bed/+6v5g9iqHFeZK/owYTQ3PO2b+8mbg6y8XeP7Irlc22ruy/fHwqIWN8zT/4LQ3OIa2vP3blDRH+FNu/FpjTPbqt4j+qM3Tapy7ovyzXOmF1EbK/uYJekl6t5L+LuFvB7Bnbv5DiXvXd1Nm/Dm+AZjTDzT+vKSTIK97Qv35VbpRPSbu/lLdY7UmN7j9G1C7cgvrAP6LDNTcqj86/krJTK6gAyb8cQFjrAe/iv28FVUkGn+g/Jgtzjb382T9ROIGJT5SRv25qG6jl2+o/7DSLzKhtiD/OWAeaJSvVP6Ny77s1cKg/rsyH0pxI4b8rPWVMs4bmvxacdgDbSce/R0d0NxwZ4b/IdFJfzcLRv/Cm1Jadd2I/lBoQQJXKsz/Q6keOv/nuP2b/KvJDluK/e2CZ9ICf1T8PIb0WknjEv8A39XGddJO/O84RXsy33T9cneTV0gHgP3pddPa9Dei/qv15WQCY4j/cx4mhLkvlPxYFa7iz3+Q/UEtzB3snvj9gdcYWO/HIv3yON8R3ZLQ/8zkRac0K6j8mAO1I88DRv/QI2t128bw/unqc1JAu3j8eBEiQxirPv77xM1ZwdOm/gvzDI5u82D/5Jha5Ta/ePxCMUiNBCqA/0/SVVxI46z9iZkllww7VP1O1a5sdzOK/iPqQ6x/qz7/jB3zVbpbuv0IovUdvVdU/eL2VHp+M4j850eXk3D7gPy5YvlLCWsG/ghsbj+5o4D+Hx10Wt+TDv4g+/ehX68k/UmPXC8883r/8z67keHyov7pC+Q/EAcq/WmuAJVdx5j91vuWFOS/qv4jI9W9D/Kk/glLCAQJo479Ra/A6+zXhP0ylRpoG0OM/DLnsaYV51r/QWY49GmHsP7yit/xoZu4/VbT5OO/Dpz9tTjUk2aO6P0p3YIcNmNS/4gXcaQ7p7b/Wzdp53mLjv5MBLwl8mug/QgSEomaW0D98aLTLymLGPxz9QKiDEcq/PJ/lW5ROkr8KDkuq/0PjP5TNSXgTJdi/DJp1EvAXwT+h5835Vqfmv6i+fbNrarw/XBqjR+5Y1z/yqoYZoB3Tv1uMmmne2Nc/pOWyU/pZv7+04rgHkDm4v3D5/KRCfIU/VvwxhG924r8H3Dh8JAXtv5wl6IFsct+/jNVWEVIl3L8qJnQLuNuwv99Jt8gBmuc/ocMVzMXs4j+mafcmuRu8v5KsMtqHjMe/CEDzPO9wyL/3cEtCWN7dP/1fBTOXhO2/ADkHWyKhar/S8i1QabjaP92FtUo2QOi/ogu4XPmq5D8V6/JMRhrsP1DDbEDUMuG/GMZJuP+L5L/xD8Z0FibmP3IJ78Q/AN8/oNeLLsxZ2b9aXBXKvxHoPzXYKxcBI8O/GKrP011Dm7+VHNGkcKXDv1rBxyrjcdM/Vmzmj17L1b9jJOTwN+vpP/j2wctndqO/6ALS9uX76r8EcFhVL5TfP34Cqmwxndw/gnPGCzRdp7+2voaHIA7NvxqE9iifl+I/1xY6CSkg479TchhxAyzpP7bWwveSN9Y/KqEWjqjuyD8WfAcAFlrtv0UKe1RYKtm/d4/wI1w92L91q8wMNfLOv6p7/kAQyeq/WgaDYsfxwT+Wk8PBzMzXPxo/OdGkOdk/NhQt5eQDoL8gDFfeV8zqP2IYfM5jkcE/wn3vkp9n6r/EwAtLK1+QPxABQctUZ9U/UBHAT/s1pb94uo3c4g6Rv3MAWQl/3tM/zayehcE26r9AD8igkBe0vy+AsHdcYeY/vAxlUQRf5r8AU8M5zkBaPwT6qIBDArc/5LzTvAbgyr+SZycNZsvtPyI3NgumeMU/APwXpAJbNb+rtyuq9Y7rP/ualvomKse/iPkE+e5L4D+ktuJWYP6+v1hB+L3CpN0/+ldXyKpR5D9WoUe5jmnDv31vhxL5ceU/EJudWYn+0z8bZytwG4LSP8ts8pGXOOc/ZEsnhqU65D9yU/SZ/CXkv0q2nHpxK+0/gPWQJtq4aL8Y9sHrbZbXv5lSEb/XPu2/lBSFXsdy7L9Nx23AyOjdP2bt54kRlMU/BOPYGDTQ6j8BPXxUcaLlP452M598qrW/Jg5l6hAI6T8HipWKrCvTP5OrExnrfOO/AubaDBQn3z/2yqAiqsbdvyqgkntrzLu/jboso2U56r9T+RFZzyThP7QRP74YSOC/KOgdoRE1oT+IKlpwQIrkv5os8CDsMMu/iONAzn8rsz/UMa3/SL/pv045XLirCLg/lSVgPj7X2r9g2GQ4IEeyP39FmFtvKO2/0keMrnTG2L8Iqw61iAW9v5rocXR2B9o/FvTexURI6D8Gdia9fPTHPww89Eh1T9S/hTXQVMqT0T8AjgNVqWSVv8DfiMdP8Za/uHYvi+0K0T9Q+OnlnQ7sP1g2lY2zJ7G/XDXqt0tD4j8xaNuNDxTmv82B5EyOxM2/xkoljlqV4D/XI9+RxtLrP4zO0LRXb9U/fqfWCym+6r+KhmlLtZ/ev4AZHfIEqGw/9gOP/Tie3D++xbW5lnbjvwJt39HVed8/6Nyqh/al2z8Ofn8we1TivzQZtUgopMY/OPdkUyOzqz8tR2sUwE21P8KRoQXVsN0/8Fu2Awr56z8qr7Mv1wzSv3YNR5Nk27+/E8/BYC0E1r+HLzf/KsDeP7qqoERf1OU/yaRei8RW4r93J+hBYBzuP/ySkpGMHuw/1aSaWKEH3r88De+8ekjEP3RknyWEHO2/yHCO3bmhxL/js+qwL2nXv+0kevWSo+0/nK9UUjGdlj8tJLTJLzbgP8b7NAh+Du4/IC85RuiXZj/GZFAH7TTpPzbCEvcE2OE/GOk4sRLb6z+8OEPXTV63v3FOw4/Jhei/EJKDmLMAkz+s1uf008HQP1rq58irMdK/9C56r3tC5L/pL3ABFx3ZP5MlysCjM+K/rgX2oQVL3b+GQeo1P9XOv5BX8xg0gJA/Ep72gG0u5z+eFDdmtrrKvzBdF0eoG9W/WMiHhfXP1D/YgcVWn7zBv5b848SWUNy/UvZ3GmZwzL+go3enf+XeP1aBKtK/UqO/q+nvjfFr5r80d5aKxSvmP+OdVOd41d6/JrsIPlL4y794KtycuDGhP1dDs+Du9t8/2ycTtGea2b+l+HMFERjkP1Vne/8x39+/iKiUW3qurr8ud7OQV/rcP4z6NAgh+t8/1pi0mMP20z/Az0Y709aTP4P4+FN15um//nQEKTtF4j/8rYVqqI3kv5AC/DJhW+4/AHL2TgNQQT/+ddqzFqfIv90pdO6AN+Q/AKXFPRg3i7+KNGWTzVPdPzDvso4J87s/pU3BlcPP079lwsmHJGzlPxMzW0opauO/AMy9Iz+q7D8kSGzlBxvqv5Ck9hL+j+q/Bz62h51S5r9ZrLKag3jsP+NBhELyLOe/UEmYHaGu37+EOj0O3/jlv2jSBcd+SOY/NIkTJ2ZJzb98fh5u+Frpv1DHkLKoRH4/qIIG8J1n6L801lVOxUzav2isrcIqnu6/jr5zbWKS4L8bnl0+esnnP5LSknBtEtq/LYg0L1f2579GKftnODO0v2wmQatZJee/wAvx9zN4o7/8Zx0Op5zrP67KVyy+prk/DvjwcR921D/9FlYiOMTtPyCH/gUm37A/GIiTcSWXtT+mx77PIs/nP9hvKVjWrKm/cpz1FGny7T/CJIyPyUDRP/gyVwtM3ty/YEedU9Hcxr9feisVAjPkP1STyrjMY80/oLZSml7GoL8CUVK+6M/Pvyq61Xb0Me2/aGfqxChq6r9HmNG9psTYP0V/9k3rhdu/EDvJbFCK6j9uoHT2+XyyP6qS5iE4DK6/wJIbeSa+lz87ktuwIFHuv/jGHTPTBem/VgMcQY2m5D95uJDKLRPPvxoE8KBTGsW/YDUTO2w1Yb91F4Hip6DoP92YJm8o6Nc/7JJNQuK6sj/bqDrxxiHQv43aWN5+I+q/+iOCVDSxsj92V9sHAUjIP+w84yHG9eU/grAwuXnc5b8ym8qQOK3iP7Reu3e0gty/ZyEx82MM2b9RaOr9MDTkvxpPI3QmW9E/31tXlNW+679VjIy03XG/v3Xib9+C4ew/qnSByokN578=","dtype":"float64","order":"little","shape":[400]},"y":{"__ndarray__":"0/DNNtGK4T9985bHqrfSPwve4i/U1+4/OkA7FW1gpz9/R541KiCqP48rjByTW+w/M7yQC6mIyD8Uy596r+DiP5ZYhS4xPdo/v2U5mVJY3T+vCAQDq8OIP5hfIQimKMk/FHEGOroW4j8R7RjJG1G5P6yGHx0/JII/5Fia0RDctD+xEjtu4HqYP6M+sLRsPeQ/Xt48umGrqD9aNVwjiUzqP/ViOeT8uuU/Rm+NkY0/4j88WhxOehWpP9Jx8xyISJ8/hC1htR9P5T80kl+KrBzHP8eZEwDxRqs/7DLvXI3Hxj8SMsnUc4m7P50OaGgxduk/t+7WKIKuqT/ZAdJqb0fRP2G5C/koNKs/Yt00n7fO4T/EtckDIgHnPzZc9EO/HeY/lXFRiemfhD84N2V4KyvmP+YWQ0PhEdA/KrieNGuO6D8AhkNO0dDMP5ak6T4XtMk/Sd+bPcRU3T/v144bL+vuP0OpDHxFDKU/cGUlqIjD7j9Hdzxp8HHjPwKHy0jgMe0/yycqttaLyj/YAnin+w26P5KxnZ6tZNY/DRbKvSep1j+RfZhpe5rmP/rXOuOXTO0/PRAvuQBPkD9ECGGzbZWJP+6bF/NgjdE/A16cagGuyD8XMjNQCdHpP6ebkAdTTtY/VsVCdsmv1D+N28nccJLVPyNhrSPTbZ4/3+rfMDVfxT9G1WKResLPP6KKxR0AGdA/2WDaVr0suT9+Nqhkk/raP2wVNzq11YQ/4ikHyipTsT+o/MbsotnjP8w3Vks1XtQ/lVQJ88KBvz/GMPuGLBzlP7udIkfHrsE/aHebGmkkkT+v2/6NLUbfP1fW1UuIrsc/7/VktV/esj84oSQmfr/iP1QQD3eeJMM/N5diT+do0z+t+70Ha+GFP/SZ9uXour4/RiOfuMT9xj8h62hAm7qkP9ArjF7Y4N0/Gqpjg1HV1z+ONwo0kffoP/O7TuVFguY/gV66Q2I7lz/OJd7jahrlP8VtljpfW+c/obQtzgjwvD9V3lKtrcPEP/7vQtUeMNg/xIjtE+qi0T+muBe21svUP1LugQ/1F5o/lbsL4TiW3j/OPQFT82ynP4B7fNBUO4A/IRXzuSXb6z/+LrcdWXvrP1ZlAXwa1c0/2zJfZfrMpD+vh3NPZB65PwkgYezl3sU/dXzVrrZH3z+0aChh6VTVP0jExJOrxMc//aTWTm3z7j9852KiE1SHP588SnxscOI/x7HfV7BWmD+686EE0eyXP2NyWY4Ei5Y/t0ZzYl4szD8D3U1OvJHYPy1cN6z1iuM/c/p5Ea/Wtj/LG3nKulznP+QEBKCX1eA/ma47hNEnyT8PQideTLapPwxFJhwcOIA/Il+oQBTz3T+1VcvyWsrjPyMUOxFHmL0/Dn4M6KhT0T/bw1M+n8rrP/r8f4Zjia0/QwZzJXWltT8X+FE0QmvEP7HTGcfdiY0/+WHeeQsqyz+rM2iIBFXGP6pyK15KxsI/HcQrTFloxj/Z+h6I9LSoP+HIXyehn9w/JgaIMS6xxj9kcrLdxsGCPwxSCwtZHcQ/MiGnCsRWxD/J4OV9s5XJP5ujDlAzSOo/gG6f5bC76z8tPtQqT63nPxrHxcsSLbo/lu8skMnZ4z/CLkuB3dCyPxh4ereHkOA/GwEz8Tzspj8dLrsYY3LIP6KhxY1PBOE/i2ktbHBj7T8eRIJrRT/mP3t7Mxt6s7w/hbrltT3Twz+SPlbV1yC9P94acpsqbOA/B1TKGxMn3T9MDWUqLv2jP8IiI/uuuqk/CXbZqIP1zT8xWCNzYxblPzlaBlSuULw/YsXkAv1b4j9LVI/z/zvaP2ZVevK+oMs/xKLx7K8i6D9Zk3MS9LTCP9T2YZx23ak/r9Gx0Yv+tj+nGLrrVjbpP4ynAkhqJOE/XZ80Oc6X4T98k5Rd6T/sP8UbvqH7R+U/p8ko6SV9kD956kEdNCXrP4ztYvz7o9E/CfhabAnozz8W5J75wabkP9DkwZNHP9E/qED+nmvC5j9PvU5jhTyfP+UtVuSZPLM/EWsrwobovz9K4h1DrMy4P0s7RVRZNOk/SJQl8W17wT9nl4vCJyrrP0yxYmlgFNU/8gyqqOfBqj8aL0o+bx+tP/v91qqAwdM/lUZ9mVThpD+r4UTQaP3lP4+ARwhp38o/HWOS0tf8wj8BwHayidTHP3zH70Ux05Y/6V+MpzuB3j8gLOyBphrMP1YHPzR+Aok/b7xHGJrioz+vbugS3KnCP+zH6/0UDKU/xCHa3HbCpz/82RhnAJTEP547A/F8uOU/tqn0PLbPxD+1zdAtt6DhP67FIPMyWpk/Q+PHqEl53T+f6ryVBKLRP1uMoTe1M+g/gk546sk1wj/oSSgOWU/DP+dozjdLbb0/SrA+RwLipj89cjrcxJzEP677TfiOq+I/dZu27UWj0z/yjdXPCWW5Pxw0sPNQDuk/pO6FDUGG4T/C1u7QanLKPxmtz5Fuqp0/B8BSIBIZ4T9ECeFO+lvLP7xG/qbLbKs/Vx+xZoYVxD8+DdjWFvW+P6hITkvJxeM/pA07EUXF5j9HbglOiN7YP0LYpQDQbdo/TYKJj+xpdD9Mat3ZgJiaP0bE9rEzKuU/cjtbKGOIoT8lZt5qQH/LP4NGLuYageE/0lLLx0DO0T8t7jarWyi9Px8IbeS5FOA/4Az3/VDutj8IB6TNd7inP340iaUqLrY/6cIOZKgjtD8bT59Q+4jIP1r+YHmimdg/vMxn5b2w4D+uDtDPX/3DP6eSq0EiD88/mWV8RLge0T8JHbjkLc3nP3vmfPNUo6U/3tZXbv8slz+OiR6MeF/NP7Hy755Fgt4/PZk3t0U7sj9HMulRWLjdP2qf77aVQtA/rM/y6glH2D8TCivxP2CPPwg3Lt41ypw/WqLeihqQ3D9FfIB35dDoPwySjOGKpKU/VrHlB4jV4z+2lx1RFjfdPyxI9lJrzZU/aB1h3y6n6T8L/H7F6KrMP/aaxC5OEaY/SnJxhztA6z8jMOyPfOilP4O1qeFi8MI/u0V/TS3Qjz/SAv/ku9LSP2+MIAWGMMo/eYx/Pez86T/Pi2MCGC/kP4oiV0q5rdk/luxcnPGzjD8UWoDUO/umPxTs4OLGa8E/ZVwHlGDh4D+WXlNworXVP+HCsfuGmLQ/PoJ7shWeyz8iPOB3fI/OPw5KOF7FkeM/Mjr8YC7L0z/kW1gKTNjjP6tm16iX+do/QGnYcZjJqD/XVWALzO/cP6gIrQaFmew/mGsbGWqzrj/UdA8hPmG4PwCGI3FSV9w/x0DaOnUy6D/Si6PW0h+OP3mjne5d/tw/8FiS03pg1z9Tp5gtKqPQP51X8/XtW5k/e32H55di7T94fnlg62LSPzItrDmA0b0/Zr+Bg/pOmT/IllwE/ZjeP0hWJTViFcI/Hz3UZxgztz/nXbhvBarOPwLF14I0n5s/yPlF7k6Hjj+7kEGEST3oPz+wuG5Kfrg/zfGI3UkD1z9wxnM5rLCXP419RE6CZM4/S4rRid4suT/MQEL8bziuP5ML09QIgtU/6WQQmf5Voz+iSci1vYasP5qfbypj+6Y/omdQUm2AoT8wFcE+NkCrPzPmA3SvTtA/4RgtvQjCtz/dp2FCxITFPzetbUYZObs/9Nb7V2155D++i/LrGIDCP4shZjwxQ+4/hkIdhVMfwT+GcRtPyxLTP8wBGbMWwJA/5e5mt3vJ1D+lMYFX9IXJP1qrtIDHd94/t/fvUJ3xuT+i1viXRevqP/4+t/DRCsY/STA9BU10yD/Y/DtyiJqxP+VIDf1LROk/v8Yk5F541z8RhFXe7MGrP9Q3cUPbsuQ/QX6uYV411z8JAnO2yRWrP+aF+up7NKA/INrduAj5iD+ACPiqgzK6P/GIzK91QKU/+cgxYMKQsz8X8wC9N4bUP3ejEyl8KOU/IWSNFuyR3D8icvFXd8x6P1aRjpq5q6w/cf6QDRrPtT/z99w1V3qfP3tTw2vLPN4/ZV3S+i4roz8tkgno12TlP435eSTSUuw/iVQCdgpg3j8tAgj/v1ugP5aFQQGDjMM/EkyOV32kjD8WAtHn1KrWP0e1hbeASsk/byeeKeDi6T9OSW+YxtLGP+xQd7dZpNw/2/3kq1EHzz9XgNBpoIbjPwg0floy6bQ/mL5trjvZ3T8B6c1Wve3mP+JNBitWirI/BCR4AqeTkD8nyA3pWPnQP+ElU+zLfN0/njm2Z9rI3D9VkT+oMJfNP04lse+mJtA/kkqQ94zXrj8XqRpUnF/rP3aKKmDVKag/9kq6dBxL0D8=","dtype":"float64","order":"little","shape":[400]}},"selected":{"id":"1088"},"selection_policy":{"id":"1087"}},"id":"1064","type":"ColumnDataSource"},{"attributes":{"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1047","type":"Line"},{"attributes":{"line_alpha":0.2,"line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1049","type":"Line"},{"attributes":{},"id":"1043","type":"AllLabels"},{"attributes":{"data":{"x":[0,0.5],"y":[0.333,0.5]},"selected":{"id":"1084"},"selection_policy":{"id":"1083"}},"id":"1052","type":"ColumnDataSource"},{"attributes":{"coordinates":null,"data_source":{"id":"1046"},"glyph":{"id":"1047"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"1049"},"nonselection_glyph":{"id":"1048"},"view":{"id":"1051"}},"id":"1050","type":"GlyphRenderer"},{"attributes":{"active_scroll":{"id":"1022"},"tools":[{"id":"1021"},{"id":"1022"},{"id":"1023"},{"id":"1024"},{"id":"1025"},{"id":"1026"},{"id":"1028"}]},"id":"1029","type":"Toolbar"}],"root_ids":["1002"]},"title":"Bokeh Application","version":"2.4.3"}};
  const render_items = [{"docid":"221677d8-144b-44a1-b816-ac47a5c33278","root_ids":["1002"],"roots":{"1002":"1fe4465b-0ca7-4117-a00e-01e75a6f1078"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script>
</div>
</div>
</section>
<section id="how-traditional-nn-classification-training-proceeds" class="level2">
<h2 class="anchored" data-anchor-id="how-traditional-nn-classification-training-proceeds">How Traditional NN Classification Training Proceeds</h2>
<p>When we start training our classifier, the data (points) get mapped all over the place; it’s a big jumble. The classifier will ultimately be scored by how many points lie on the “correct side of the line” for the class boundaries, but that’s a discontinuous (either-or) criterion that’s no good for training neural networks. So instead we use a loss function and a gradient descent on this loss function to try to <em>minimize the distance</em> from the mapped point to the “pole” of the target class point. In other words, training proceeds by trying to <em>collapse all the data points</em> onto the 3 (or 4) points corresponding to 100% certainty about each class prediction: The following a cartoon example time-lapse of ten training steps (we’ll show <em>real</em> NN training in <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a> of this blog series):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ipywidgets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> interact, interactive, fixed, interact_manual</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ipywidgets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> widgets</span>
<span id="cb7-3"></span>
<span id="cb7-4">probs, tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_prob(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span>)</span>
<span id="cb7-5">targs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>probs.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb7-6">targs_3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> one_hot(targs)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># not used for plotting but for compiting gradients</span></span>
<span id="cb7-7">maxsteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sequence(step):</span>
<span id="cb7-10">    lr, grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>maxsteps, targs_3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>probs</span>
<span id="cb7-11">    TrianglePlot2D_MPL(probs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>grad, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>targs, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, comment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Step </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:'</span>).do_plot()</span>
<span id="cb7-12"></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Could be interactive fun in Jupyter/Colab, but not easy to do in the blog:</span></span>
<span id="cb7-14">do_interact <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span> </span>
<span id="cb7-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> do_interact:</span>
<span id="cb7-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Move the slider below to advance the training step."</span>)</span>
<span id="cb7-17">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(Note, this is just a 'cartoon' for now; to see actual NN training steps, wait until post Part 2."</span>)</span>
<span id="cb7-18">    interact(sequence, step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>widgets.IntSlider(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>,step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb7-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> step <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(maxsteps):</span>
<span id="cb7-21">        sequence(step) </span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-9.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-9-output-10.png" class="img-fluid"></p>
</div>
</div>
<p>As the training proceeds, it tries to get the groups of data points to collapse to single locations at each target “pole”.</p>
</section>
<section id="loss-vs.-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="loss-vs.-accuracy">Loss vs.&nbsp;Accuracy</h2>
<p>This method of visualization also allows us to visually “see” the concepts of loss and accuracy. For 3-classes with a softmax activation and categorical cross-entropy, the loss is nearly linear in the difference between the prediction and the target, i.e.:</p>
<blockquote class="blockquote">
<p>Loss: ~distance from target</p>
</blockquote>
<p>This is a continuous variable, which makes it suitable for training models via gradient descent.</p>
<p>In contrast to loss, <em>accuracy</em> is how many classifications the model gets correct, expressed as a percentage of the total number of data points. This is determined by what side of the decision boundary each prediction is on.</p>
<blockquote class="blockquote">
<p>Accuracy: % of points on the correct side of decision boundary (discontinuous)<br></p>
</blockquote>
<p>It is instructive to view two configurations of data points with <em>nearly identical loss values</em> but wildly different accuracies:</p>
<p><strong>Nearly identical losses:</strong><br></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate and save images that we'll load in the next cell </span></span>
<span id="cb8-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>mkdir images</span>
<span id="cb8-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb8-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate data along boundaries</span></span>
<span id="cb8-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> gen_bound(x, y, z, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, ind0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ind0=1 skips the "first point"</span></span>
<span id="cb8-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.linspace(np.array([x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],y[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],z[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]), np.array([x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],y[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],z[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]), num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>ind0)[ind0:]</span>
<span id="cb8-9">  </span>
<span id="cb8-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> gen_bound_data(n_per<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, ind0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>):</span>
<span id="cb8-11">    bdata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((n_per<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb8-12">    bdata[:n_per] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_bound(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_per, ind0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ind0) </span>
<span id="cb8-13">    bdata[n_per:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_per] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_bound(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_per, ind0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ind0)</span>
<span id="cb8-14">    bdata[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n_per:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_bound(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.333</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_per, ind0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ind0)</span>
<span id="cb8-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> bdata</span>
<span id="cb8-16"></span>
<span id="cb8-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> gen_near_bound_data(n_per<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>):</span>
<span id="cb8-18">    bdata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_bound_data(n_per<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_per)</span>
<span id="cb8-19">    lower, right, left <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bdata[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:n_per,:], bdata[n_per:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_per,:], bdata[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n_per:,:]</span>
<span id="cb8-20"></span>
<span id="cb8-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shift data a bit</span></span>
<span id="cb8-22">    lower_catty <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(lower<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([eps,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])) )</span>
<span id="cb8-23">    lower_doggy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(lower<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,eps,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])) )</span>
<span id="cb8-24"></span>
<span id="cb8-25">    left_catty <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(left<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([eps,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])) )</span>
<span id="cb8-26">    left_horsey <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(left<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,eps])) )</span>
<span id="cb8-27"></span>
<span id="cb8-28">    right_horsey <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(right<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,eps])) )</span>
<span id="cb8-29">    right_doggy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax( scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(right<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,eps,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])) )</span>
<span id="cb8-30"></span>
<span id="cb8-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.vstack((lower_catty, lower_doggy, left_catty, left_horsey, right_horsey, right_doggy))</span>
<span id="cb8-32"></span>
<span id="cb8-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move boundary a bit toward the "correct" side</span></span>
<span id="cb8-34">eps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.007</span></span>
<span id="cb8-35">acc_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_near_bound_data(eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eps)</span>
<span id="cb8-36">btarg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmax(acc_data, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-37">TrianglePlot2D_MPL(acc_data, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>btarg, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, comment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'100% Accuracy:'</span>).do_plot()</span>
<span id="cb8-38">plt.savefig(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/acc_100.png"</span>)</span>
<span id="cb8-39"></span>
<span id="cb8-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move boundary a bit toward the "wrong" side (keeping labels the same as before)</span></span>
<span id="cb8-41">inacc_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gen_near_bound_data(eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>eps)</span>
<span id="cb8-42">ibtarg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> btarg.copy()</span>
<span id="cb8-43">TrianglePlot2D_MPL(inacc_data, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ibtarg, show_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, comment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0% Accuracy:'</span>).do_plot()</span>
<span id="cb8-44">plt.savefig(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images/acc_0.png"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>mkdir: images: File exists</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2021-05-04-The-Joy-Of-3D_files/figure-html/cell-10-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>Thus visualization can serve as a valuable teaching tool.</p>
<p>Furthermore, by letting us track which points are “not where they should be” on a plot, we can “see” the “confusion matrix” typically provided as a classification metric. More on that in <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a>.</p>
<section id="aside-even-4-classes" class="level3">
<h3 class="anchored" data-anchor-id="aside-even-4-classes">Aside: Even 4 Classes?</h3>
<p>Just as 3 class probabilities form a triangular 2D subspace (in 3D) that we can then plot in 2D, so too 4 classes form a <em>tetrahedron</em> (a pyramid made up of triangles), which is a 3D shape embedded in 4D space! So if we restrict our attention to this 3D subspace and use a 3D plotting program then we can actually represent 4 classes. Say we add another animal class, say “bird” symbolized by dark-colored points. Then our diagram could look like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">prob4, targ4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_prob(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4d probabilities</span></span>
<span id="cb10-2">TrianglePlot3D_Plotly(prob4, targ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>targ4, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bird'</span>], show_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, show_axes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, add_poles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).do_plot()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="07e63ea1-08e9-4c94-ab06-0a6181794ed5" class="plotly-graph-div" style="height:525px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("07e63ea1-08e9-4c94-ab06-0a6181794ed5")) {                    Plotly.newPlot(                        "07e63ea1-08e9-4c94-ab06-0a6181794ed5",                        [{"hovertext":["cat","dog","horse","bird","dog","horse","horse","horse","dog","horse","cat","bird","cat","cat","bird","bird","dog","horse","bird","cat","dog","bird","dog","dog","dog","horse","bird","dog","cat","dog","cat","cat","dog","horse","bird","bird","bird","bird","dog","dog","cat","horse","cat","dog","bird","dog","bird","dog","dog","bird","dog","dog","horse","cat","dog","cat","bird","dog","bird","bird","horse","horse","horse","dog","bird","bird","cat","horse","bird","dog","horse","horse","bird","bird","dog","bird","dog","cat","bird","dog","bird","dog","horse","dog","bird","cat","horse","cat","horse","bird","cat","bird","bird","horse","cat","cat","dog","bird","dog","bird","bird","cat","bird","cat","bird","cat","dog","dog","horse","dog","cat","dog","horse","cat","dog","horse","bird","horse","dog","bird","cat","dog","dog","dog","dog","horse","cat","dog","cat","dog","horse","bird","dog","dog","dog","bird","dog","cat","dog","horse","cat","dog","dog","dog","bird","cat","bird","cat","cat","cat","cat","cat","dog","horse","horse","bird","cat","bird","horse","bird","horse","horse","cat","bird","horse","dog","horse","dog","bird","bird","dog","dog","horse","cat","horse","horse","dog","cat","dog","cat","horse","cat","bird","cat","horse","horse","dog","cat","horse","bird","horse","horse","horse","horse","dog","horse","cat","cat","horse","dog","bird","horse","cat","horse","bird","horse","dog","cat","cat","dog","bird","cat","cat","cat","dog","cat","bird","horse","horse","dog","bird","horse","cat","horse","horse","dog","cat","dog","dog","cat","cat","dog","horse","horse","bird","bird","horse","dog","cat","horse","bird","cat","horse","bird","bird","cat","horse","bird","horse","bird","cat","horse","dog","dog","bird","dog","horse","dog","horse","cat","horse","horse","horse","cat","horse","bird","dog","dog","horse","horse","dog","dog","horse","horse","bird","cat","dog","cat","horse","dog","dog","dog","bird","horse","dog","dog","horse","horse","horse","dog","bird","bird","cat","horse","dog","dog","dog","cat","horse","dog","dog","bird","horse","dog","cat","dog","dog","dog","horse","bird","horse","bird","bird","dog","horse","horse","dog","cat","horse","cat","bird","horse","cat","bird","horse","horse","cat","cat","horse","horse","cat","horse","bird","dog","bird","bird","dog","cat","cat","dog","bird","bird","horse","cat","horse","bird","horse","bird","dog","cat","bird","cat","bird","bird","bird","dog","horse","dog","cat","dog","cat","bird","bird","horse","bird","cat","bird","bird","cat","dog","bird","bird","dog","cat","horse","horse","cat","horse","bird","bird","dog","cat","cat","cat","bird","cat","cat","bird","dog","horse","horse","bird","dog","horse","bird","dog","dog","bird","cat","dog","bird","bird","horse","horse","bird","dog","bird","cat","dog","bird","dog","dog","dog","bird","horse","dog","bird","bird","horse","bird","horse","cat","bird","cat","dog","cat","bird","dog","cat","horse","cat","bird","cat","cat","cat","horse","bird","horse","dog","cat","horse","dog","cat","dog","dog","horse","horse","bird","bird","cat","horse","horse","dog","dog","dog","horse","cat","cat","cat","bird","bird","horse","bird","bird","bird","bird","cat","cat","cat","horse","cat","horse","bird","bird","horse","dog","horse","bird","horse","bird","cat","dog","bird","dog","bird","cat","horse","dog","horse","dog","dog","horse","horse","horse","dog","dog","dog","bird","horse","bird","dog","horse","dog","bird"],"marker":{"color":["red","green","blue","orange","green","blue","blue","blue","green","blue","red","orange","red","red","orange","orange","green","blue","orange","red","green","orange","green","green","green","blue","orange","green","red","green","red","red","green","blue","orange","orange","orange","orange","green","green","red","blue","red","green","orange","green","orange","green","green","orange","green","green","blue","red","green","red","orange","green","orange","orange","blue","blue","blue","green","orange","orange","red","blue","orange","green","blue","blue","orange","orange","green","orange","green","red","orange","green","orange","green","blue","green","orange","red","blue","red","blue","orange","red","orange","orange","blue","red","red","green","orange","green","orange","orange","red","orange","red","orange","red","green","green","blue","green","red","green","blue","red","green","blue","orange","blue","green","orange","red","green","green","green","green","blue","red","green","red","green","blue","orange","green","green","green","orange","green","red","green","blue","red","green","green","green","orange","red","orange","red","red","red","red","red","green","blue","blue","orange","red","orange","blue","orange","blue","blue","red","orange","blue","green","blue","green","orange","orange","green","green","blue","red","blue","blue","green","red","green","red","blue","red","orange","red","blue","blue","green","red","blue","orange","blue","blue","blue","blue","green","blue","red","red","blue","green","orange","blue","red","blue","orange","blue","green","red","red","green","orange","red","red","red","green","red","orange","blue","blue","green","orange","blue","red","blue","blue","green","red","green","green","red","red","green","blue","blue","orange","orange","blue","green","red","blue","orange","red","blue","orange","orange","red","blue","orange","blue","orange","red","blue","green","green","orange","green","blue","green","blue","red","blue","blue","blue","red","blue","orange","green","green","blue","blue","green","green","blue","blue","orange","red","green","red","blue","green","green","green","orange","blue","green","green","blue","blue","blue","green","orange","orange","red","blue","green","green","green","red","blue","green","green","orange","blue","green","red","green","green","green","blue","orange","blue","orange","orange","green","blue","blue","green","red","blue","red","orange","blue","red","orange","blue","blue","red","red","blue","blue","red","blue","orange","green","orange","orange","green","red","red","green","orange","orange","blue","red","blue","orange","blue","orange","green","red","orange","red","orange","orange","orange","green","blue","green","red","green","red","orange","orange","blue","orange","red","orange","orange","red","green","orange","orange","green","red","blue","blue","red","blue","orange","orange","green","red","red","red","orange","red","red","orange","green","blue","blue","orange","green","blue","orange","green","green","orange","red","green","orange","orange","blue","blue","orange","green","orange","red","green","orange","green","green","green","orange","blue","green","orange","orange","blue","orange","blue","red","orange","red","green","red","orange","green","red","blue","red","orange","red","red","red","blue","orange","blue","green","red","blue","green","red","green","green","blue","blue","orange","orange","red","blue","blue","green","green","green","blue","red","red","red","orange","orange","blue","orange","orange","orange","orange","red","red","red","blue","red","blue","orange","orange","blue","green","blue","orange","blue","orange","red","green","orange","green","orange","red","blue","green","blue","green","green","blue","blue","blue","green","green","green","orange","blue","orange","green","blue","green","orange"],"opacity":0.6,"size":5},"mode":"markers","x":[-0.03974587470293045,0.605739414691925,-0.7684479355812073,0.20245441794395447,0.05396556481719017,-0.6085259318351746,-0.20575767755508423,-0.5176934003829956,0.2658997178077698,-0.14475798606872559,-0.20419032871723175,0.18708838522434235,0.008653800003230572,0.11549675464630127,0.1483721137046814,0.1648699939250946,0.33480772376060486,-0.29715996980667114,0.13785699009895325,0.2391706258058548,0.22618457674980164,0.2548283636569977,0.3304736912250519,0.2826918959617615,0.32786086201667786,-0.2513398826122284,0.31825438141822815,0.2840925455093384,-0.10989634692668915,0.477215439081192,0.0588824488222599,-0.03934140130877495,0.18934929370880127,-0.09982171654701233,0.2020874172449112,0.22622358798980713,0.09438510239124298,-0.045690372586250305,0.25492462515830994,0.11236169189214706,-0.13323664665222168,-0.07776899635791779,0.12790575623512268,0.4202531576156616,0.0035918131470680237,0.17338965833187103,0.2679766118526459,0.14528630673885345,0.3906809091567993,-0.16826200485229492,0.1505470722913742,0.1316337287425995,-0.23738913238048553,0.0812576413154602,0.35318562388420105,-0.026355603709816933,0.08107315003871918,0.04561641439795494,-0.050025492906570435,0.22153346240520477,-0.23140119016170502,-0.39246562123298645,-0.40231192111968994,0.3922191858291626,0.05176315829157829,0.1717590093612671,0.03779027983546257,-0.16614648699760437,0.17722775042057037,0.2137882262468338,-0.2591443359851837,-0.14054399728775024,-0.1628212034702301,0.015396742150187492,0.5525264739990234,0.17900530993938446,0.05678597092628479,0.16491995751857758,0.06139376387000084,0.4889361262321472,0.16783879697322845,0.1713729202747345,-0.43689244985580444,0.5327548980712891,0.16893547773361206,-0.07177195698022842,-0.33890530467033386,-0.023070717230439186,-0.2243519127368927,-0.17615990340709686,0.1689291000366211,0.03560991212725639,0.09616920351982117,-0.09478646516799927,-0.03385542333126068,0.15525642037391663,0.5107744932174683,0.1350153684616089,0.40890398621559143,0.22997072339057922,-0.2272387444972992,-0.014113081619143486,0.16503895819187164,-0.3192104697227478,0.17423810064792633,0.08761757612228394,0.37627270817756653,0.438468873500824,-0.4771263301372528,0.3694796562194824,0.20357246696949005,0.5662776231765747,-0.09134793281555176,-0.025773603469133377,0.5656523704528809,-0.5331030488014221,0.3424646556377411,-0.3691563904285431,0.57329261302948,0.17450638115406036,-0.017952321097254753,0.1079472154378891,0.25320056080818176,0.20844653248786926,0.24932385981082916,-0.6258536577224731,-0.03618179261684418,0.5102628469467163,-0.20756010711193085,0.37713009119033813,-0.705318033695221,-0.08115791529417038,0.20950011909008026,0.07008503377437592,0.42329537868499756,0.15090811252593994,0.1806444674730301,-0.0961543619632721,-0.04923073574900627,-0.4703933596611023,-0.09446996450424194,0.3666258454322815,0.3881395757198334,0.2947305142879486,0.11983133852481842,0.16243751347064972,0.2173582762479782,-0.0011090198531746864,-0.16684983670711517,0.08782641589641571,0.05090942233800888,-0.05446143448352814,0.17685261368751526,-0.12434200197458267,-0.4847894608974457,0.26015815138816833,-0.033336613327264786,0.019765006378293037,-0.38752156496047974,0.16733674705028534,-0.47294458746910095,-0.19839225709438324,0.09464506804943085,0.13844510912895203,-0.2798443138599396,0.5005414485931396,-0.23528745770454407,0.0672333836555481,-0.1662256419658661,0.0620165653526783,0.36243632435798645,0.4078238904476166,-0.5910704731941223,0.10078141838312149,-0.07278864830732346,-0.20936641097068787,0.2083919197320938,-0.03763476386666298,0.2787626087665558,0.014859010465443134,-0.7259658575057983,-0.017743727192282677,0.2746201753616333,0.1942385584115982,-0.1167479008436203,-0.6568750143051147,0.3066478967666626,-0.039630044251680374,-0.3870672583580017,0.2045673429965973,-0.2784394323825836,-0.43062445521354675,-0.45273250341415405,-0.27259379625320435,-0.0011648833751678467,-0.18859030306339264,0.13799403607845306,-0.02979072742164135,-0.7151687741279602,0.23747211694717407,0.06015259400010109,-0.44755494594573975,-0.2941049337387085,-0.6536145210266113,-0.12510891258716583,-0.2685210108757019,0.2006908506155014,0.13500367105007172,0.06099395081400871,0.38423770666122437,0.14770102500915527,0.05860694870352745,0.09780777990818024,-0.0597594790160656,0.2706293761730194,-0.12707161903381348,0.12510035932064056,-0.379565566778183,-0.5869752168655396,0.5157970190048218,0.04430660977959633,-0.3416954576969147,0.15713447332382202,-0.29386159777641296,-0.5369053483009338,0.3342783749103546,-0.024443041533231735,0.4398428797721863,0.013320477679371834,-0.1695151925086975,-0.27969273924827576,0.4745386242866516,-0.41387009620666504,-0.34589117765426636,0.10496426373720169,0.08636129647493362,-0.5396673083305359,0.24769264459609985,0.12327174097299576,-0.6120990514755249,0.08627063781023026,-0.13920080661773682,-0.11993404477834702,0.19353017210960388,0.2531485855579376,0.040049098432064056,-0.2997514605522156,0.13785286247730255,-0.5194105505943298,0.002998514799401164,0.1159612238407135,-0.6901187300682068,0.2878788709640503,0.398139625787735,0.09187029302120209,0.36643338203430176,-0.5968983769416809,0.25690075755119324,-0.3583194613456726,0.055830810219049454,-0.6742444038391113,-0.3057807981967926,-0.1967649608850479,0.007633950095623732,-0.6689097285270691,0.2724142074584961,0.4133867919445038,0.40295425057411194,-0.38651344180107117,-0.7199939489364624,0.34492427110671997,0.4789492189884186,-0.5330872535705566,-0.4459730386734009,-0.01822132058441639,-0.18371029198169708,0.39604198932647705,0.015409084036946297,-0.6483097076416016,0.46766552329063416,0.12779036164283752,0.47564929723739624,0.05502081662416458,-0.29485243558883667,0.20032142102718353,0.04985089972615242,-0.3445605933666229,-0.39481958746910095,-0.40822842717170715,0.21245069801807404,0.3483040928840637,-0.2660577893257141,-0.052870314568281174,-0.6629399657249451,-0.052393846213817596,0.5093788504600525,0.24416334927082062,-0.34087109565734863,-0.7269847393035889,0.5115426778793335,0.4716549813747406,0.018591077998280525,-0.23838181793689728,0.3752317428588867,-0.15583673119544983,0.33419543504714966,0.025975987315177917,0.46131256222724915,-0.4254322052001953,0.07427442818880081,-0.49349865317344666,-0.056614670902490616,0.3307860195636749,0.3412787616252899,-0.5154756903648376,-0.3712781071662903,0.3583819270133972,0.08015172928571701,-0.6145448684692383,-0.11562485247850418,0.17438100278377533,-0.05920384079217911,-0.030894404277205467,0.0947369635105133,-0.41315603256225586,-0.34162160754203796,0.06198813021183014,-0.028633279725909233,-0.5720832943916321,-0.42138245701789856,-0.018896138295531273,-0.20077303051948547,0.06857158988714218,0.17305612564086914,-0.1539001613855362,0.061161722987890244,0.2567348778247833,-0.11955956369638443,-0.20247825980186462,0.06135682016611099,0.13794681429862976,0.1894214004278183,-0.29748544096946716,0.12285438925027847,-0.15465275943279266,-0.133806049823761,-0.38624703884124756,0.06112686172127724,0.02340863086283207,-0.059630412608385086,0.11891969293355942,0.10538044571876526,0.14144808053970337,-0.09078548103570938,0.20539706945419312,0.34256649017333984,-0.4371260106563568,0.4307721257209778,0.20302802324295044,0.02487058751285076,0.05895719677209854,-0.17677266895771027,-0.20434893667697906,-0.20564673840999603,0.13218972086906433,-0.10843780636787415,0.1582450568675995,0.15236234664916992,-0.17455926537513733,0.37664881348609924,0.07743042707443237,-0.06836193799972534,-0.028518887236714363,-0.02595246210694313,-0.06896699965000153,-0.3612651824951172,-0.02417239174246788,-0.5640138387680054,0.04573281854391098,-0.11930549889802933,0.49737682938575745,-0.0033409518655389547,0.16075511276721954,-0.1799042522907257,0.016849009320139885,0.09288293123245239,0.1472090780735016,0.1384076029062271,0.38825723528862,-0.2837670147418976,-0.6658579111099243,0.033931370824575424,0.23823042213916779,-0.16618622839450836,0.08355230838060379,0.3373541533946991,0.4454421103000641,0.1623723804950714,-0.23225831985473633,0.43900927901268005,-0.03224184736609459,0.07801232486963272,-0.5362001061439514,-0.2479599118232727,0.30308210849761963,0.355112224817276,0.1778486669063568,-0.008628052659332752,0.39895352721214294,-0.04839514568448067,0.3648562431335449,0.2523508071899414,0.2949828505516052,-0.05747425928711891,-0.4983319640159607,0.25654616951942444,0.050210725516080856,0.18132463097572327,-0.6577481031417847,0.2080530971288681,-0.6655092835426331,-0.0717061460018158,0.1800289899110794,-0.038003478199243546,0.34579750895500183,-0.04787829890847206,-0.021796343848109245,0.22524914145469666,0.015601713210344315,-0.12087546288967133,-0.034554146230220795,-0.04068853706121445,-0.1360611617565155,-0.14976002275943756,0.009160473011434078,-0.22527767717838287,-0.20358361303806305,-0.5419638156890869,0.32577189803123474,-0.03944728150963783,-0.4049510657787323,0.2566415071487427,0.011538935825228691,0.15376605093479156,0.22033998370170593,-0.7069488763809204,-0.6280269622802734,0.09516863524913788,0.11327927559614182,-0.33945003151893616,-0.015013046562671661,-0.2945636510848999,0.2403179556131363,0.20424869656562805,0.5205501317977905,-0.0054674637503921986,-0.22934590280056,-0.3488118350505829,0.1927044838666916,0.014013318344950676,0.2242129147052765,-0.23134657740592957,0.205476313829422,0.01053351815789938,-0.1424941122531891,0.3401363492012024,-0.12648610770702362,-0.02880844660103321,0.11424263566732407,-0.2007206529378891,0.006146650295704603,-0.36696287989616394,0.23395143449306488,-0.07813208550214767,-0.5767430067062378,0.32674744725227356,-0.5822546482086182,0.14226758480072021,-0.4532785713672638,0.18975995481014252,-0.018796740099787712,0.06789208203554153,-0.008167528547346592,0.4222826659679413,0.10729511827230453,-0.03706582263112068,-0.09795451909303665,0.16193822026252747,-0.5606802701950073,0.2795467674732208,0.29813137650489807,-0.16210608184337616,-0.34075483679771423,-0.13878531754016876,0.27718859910964966,0.052024200558662415,0.2511727809906006,-0.13181310892105103,-0.11806473881006241,0.21334820985794067,0.5222135782241821,-0.3628952205181122,0.42085638642311096,0.27675458788871765],"y":[-0.1544657051563263,0.5987532734870911,0.2872377932071686,-0.7315253615379333,0.365096777677536,0.19579830765724182,0.25532206892967224,0.1429385244846344,0.10788799077272415,0.23167206346988678,-0.016024675220251083,-0.5657830238342285,-0.27416282892227173,0.03880946338176727,-0.5223576426506042,-0.5576047301292419,0.4250320494174957,0.04014058783650398,-0.46402525901794434,0.21105344593524933,0.08439738303422928,-0.5303211808204651,0.2602262794971466,0.11498284339904785,0.3066573739051819,-0.17311246693134308,-0.18299798667430878,0.27344566583633423,-0.13437245786190033,0.5412450432777405,-0.35222551226615906,-0.020648961886763573,0.19461093842983246,-0.0015596462180837989,-0.16339515149593353,-0.5570665001869202,-0.33295372128486633,-0.4402564764022827,0.24701525270938873,0.12546095252037048,-0.043162137269973755,0.06249488890171051,-0.11937303841114044,0.4890229403972626,-0.49443286657333374,0.1521724909543991,-0.4170832931995392,0.4265119433403015,0.020452143624424934,-0.23299528658390045,0.4414285719394684,0.3786311447620392,0.24612876772880554,-0.2976662814617157,0.3310161828994751,-0.2010146826505661,-0.4187871515750885,0.20288804173469543,-0.3264272212982178,-0.30520203709602356,-0.11230379343032837,0.12577882409095764,0.03679466247558594,0.21644341945648193,0.023848047479987144,-0.654228925704956,0.11380277574062347,0.24218346178531647,-0.6152393221855164,0.46580925583839417,0.11632554978132248,0.3207910656929016,-0.3334363102912903,-0.16118037700653076,0.5177562832832336,-0.632542073726654,0.19866661727428436,0.20605506002902985,-0.20163781940937042,0.3761851191520691,-0.561582088470459,0.31899189949035645,0.10627097636461258,0.42827993631362915,-0.48258739709854126,-0.09207817167043686,-0.12919607758522034,-0.08878570795059204,0.3212251663208008,-0.32099592685699463,0.0375194251537323,-0.034091271460056305,-0.36570292711257935,0.38337454199790955,-0.08499837666749954,-0.1920759081840515,0.5114643573760986,-0.3833520710468292,0.3203752934932709,-0.30951112508773804,-0.24280989170074463,0.018860435113310814,-0.38751810789108276,-0.018249239772558212,-0.6616321802139282,-0.09495674073696136,0.3351743817329407,0.4981793463230133,0.1312575340270996,0.4344482719898224,0.10558610409498215,0.5527764558792114,0.22913676500320435,-0.21672925353050232,0.5593814253807068,0.2261391431093216,-0.19491292536258698,0.08096267282962799,0.565159261226654,-0.3427618443965912,-0.15254060924053192,0.3115710914134979,0.3056938648223877,0.49757397174835205,0.06389158964157104,0.29776066541671753,-0.19333146512508392,0.5478199124336243,-0.08447223156690598,0.4156133830547333,0.2566918134689331,-0.4146242141723633,0.20182454586029053,0.021479664370417595,0.25698748230934143,-0.1903688609600067,0.1919490247964859,-0.1518959403038025,0.377949982881546,-0.0017206459306180477,-0.1058960109949112,0.12387892603874207,0.25841134786605835,0.232207790017128,-0.5431744456291199,-0.1813286989927292,-0.23297685384750366,-0.16959689557552338,-0.09059327095746994,0.11094140261411667,-0.11193308234214783,-0.1998109668493271,0.3011215031147003,-0.05924353376030922,0.15251962840557098,-0.13472948968410492,-0.1794174611568451,-0.18405041098594666,0.24261987209320068,-0.5453807711601257,0.14799663424491882,-0.04829266294836998,-0.32041695713996887,-0.5391138195991516,0.3461163341999054,0.5455856919288635,0.35791292786598206,0.2502579689025879,-0.2077965885400772,-0.3625609576702118,0.14782734215259552,-0.014967266470193863,0.20776213705539703,0.004182890988886356,0.009145056828856468,0.3857497572898865,0.23567815124988556,-0.22624850273132324,0.37240004539489746,-0.14936606585979462,0.28191855549812317,-0.18772704899311066,-0.2707308232784271,0.14018253982067108,0.38461214303970337,0.2445889115333557,0.029174327850341797,-0.06057466194033623,0.1934138685464859,-0.47230133414268494,0.0007645942969247699,0.2004852294921875,0.2746936082839966,0.11633665859699249,0.3646143972873688,0.35187098383903503,0.041490767151117325,-0.23078887164592743,0.25771215558052063,0.2539358139038086,-0.1549234837293625,0.14772847294807434,0.02780977077782154,0.21979662775993347,-0.16853414475917816,-0.08053279668092728,0.10255038738250732,-0.11549721658229828,-0.40774741768836975,0.48906803131103516,-0.4378598928451538,0.09802442789077759,0.04837198182940483,-0.1632976233959198,0.2838415503501892,0.032361019402742386,-0.5290296673774719,0.02110985852777958,0.19148510694503784,0.5214782953262329,-0.09175805747509003,-0.06354263424873352,-0.1805451512336731,-0.03731813281774521,0.15620219707489014,0.30900809168815613,-0.1254320740699768,0.3989697992801666,0.3334294557571411,-0.08225613832473755,-0.01521272398531437,0.26595696806907654,0.1432504802942276,0.14312784373760223,-0.5154937505722046,-0.4800025224685669,0.20223990082740784,0.28289657831192017,-0.1519826054573059,0.23465611040592194,-0.4805178940296173,0.12281155586242676,0.37747228145599365,-0.6999796628952026,-0.21466758847236633,-0.35418644547462463,0.3067113161087036,-0.6138836741447449,0.17272378504276276,-0.45137688517570496,-0.1027219146490097,0.2376750111579895,0.3981671929359436,0.005678978282958269,-0.39320623874664307,0.14021502435207367,0.14464089274406433,-0.0092932702973485,0.2864668667316437,-0.02806493081152439,0.24298012256622314,-0.1849304735660553,0.2643749713897705,0.11331076920032501,0.25573045015335083,-0.38494673371315,0.14750690758228302,0.020057039335370064,0.2652303874492645,0.2781694233417511,0.23941569030284882,0.5012066960334778,0.09739557653665543,0.09393829852342606,-0.3566117584705353,-0.04548937454819679,0.13469959795475006,-0.1713731437921524,0.2159145474433899,0.43796056509017944,0.07308834046125412,0.5297567248344421,-0.05483897030353546,0.12494217604398727,0.242818683385849,0.2951268255710602,0.023932425305247307,0.11968109756708145,0.07818444818258286,0.019031357020139694,-0.10941387712955475,-0.21147404611110687,-0.14699730277061462,0.2679797410964966,0.42330873012542725,0.4719008803367615,0.05045622959733009,0.06832946836948395,0.2760255038738251,0.4959554374217987,0.23411186039447784,-0.3716258406639099,-0.15804168581962585,0.4433090388774872,-0.12667764723300934,0.3582521378993988,0.2090185284614563,0.39480364322662354,0.07561298459768295,-0.4038231670856476,0.24456234276294708,-0.031982727348804474,-0.10812313854694366,0.01207863911986351,0.13298587501049042,0.35418105125427246,0.3772464692592621,-0.2944250702857971,0.28111135959625244,0.03732895106077194,-0.546298086643219,0.06633169949054718,-0.1286737322807312,-0.500296413898468,0.116207554936409,0.20662550628185272,-0.04423898085951805,-0.07144125550985336,0.17611980438232422,-0.019743729382753372,-0.1712837666273117,-0.05976452678442001,-0.4862450361251831,0.12977658212184906,-0.16556552052497864,-0.32882577180862427,0.2620094418525696,0.11924660205841064,-0.01494792103767395,0.16160719096660614,-0.4323281943798065,-0.651359498500824,0.2234102487564087,-0.24815136194229126,0.22708573937416077,-0.25603628158569336,0.0595303550362587,-0.41459494829177856,0.2833338677883148,-0.1195349171757698,-0.3926130533218384,-0.1755060851573944,-0.5970334410667419,-0.1618867963552475,-0.288249671459198,0.30085131525993347,0.10328687727451324,0.40287476778030396,0.1184445172548294,0.3809942305088043,-0.06545384973287582,-0.2795095145702362,-0.159383162856102,-0.12020976841449738,-0.5605317950248718,-0.1632893830537796,-0.49711647629737854,-0.6305708885192871,-0.19707699120044708,-0.04268962889909744,-0.37366703152656555,-0.3129432499408722,0.19540798664093018,-0.14272265136241913,0.3302009105682373,0.11285661160945892,-0.27642086148262024,0.1631578803062439,-0.4578399062156677,-0.38005322217941284,0.46899667382240295,0.01605459861457348,0.04065980389714241,-0.16989487409591675,-0.4526616930961609,-0.024557773023843765,0.08352478593587875,-0.12809064984321594,0.2683980464935303,0.07811067253351212,0.2440909892320633,-0.3824770152568817,0.12691308557987213,0.15351398289203644,-0.43738624453544617,0.2055370956659317,0.20754948258399963,-0.6486457586288452,-0.03860289976000786,0.49264901876449585,-0.19973011314868927,-0.09873699396848679,0.1695057600736618,0.3440673351287842,-0.305105060338974,0.13260212540626526,-0.5715809464454651,-0.0638182982802391,0.35523852705955505,-0.2231930047273636,0.485185831785202,0.37959790229797363,0.45925572514533997,-0.024415187537670135,0.3194947838783264,0.49918293952941895,-0.5088804960250854,-0.10570269823074341,0.23465436697006226,-0.353877454996109,0.24176549911499023,-0.02045382373034954,-0.43632233142852783,-0.13455674052238464,0.29957315325737,0.141029492020607,-0.13623252511024475,0.261732280254364,0.002240782370790839,-0.0622178353369236,-0.11184176057577133,-0.324144184589386,-0.09330809861421585,-0.13636675477027893,0.22445151209831238,-0.09871407598257065,-0.18927797675132751,0.15269459784030914,0.051362376660108566,-0.302362859249115,-0.03504275903105736,0.2533057928085327,-0.09830894321203232,0.0713370218873024,0.31868818402290344,0.25903165340423584,0.19868265092372894,-0.048020124435424805,-0.3796522319316864,0.03370555862784386,0.15400484204292297,0.3767392039299011,0.4483879506587982,0.37693148851394653,0.5019596815109253,0.10930992662906647,-0.0054596238769590855,0.03532211855053902,0.10194256901741028,-0.37238937616348267,-0.5327155590057373,0.10124339908361435,-0.5471239686012268,-0.47534504532814026,-0.2201160341501236,-0.18860158324241638,0.060853395611047745,-0.12958911061286926,-0.043088559061288834,-0.02672056294977665,-0.09216093271970749,-0.0863967016339302,-0.17288179695606232,-0.2777867019176483,0.26310694217681885,0.2817681133747101,0.1425217092037201,-0.4613061249256134,0.08235765248537064,-0.15402692556381226,-0.12947118282318115,0.15557052195072174,-0.2427724450826645,0.4781501591205597,-0.6055940389633179,0.03442734479904175,0.3750661313533783,0.09873231500387192,0.22641538083553314,0.11875975877046585,0.4086310565471649,0.04385078698396683,0.20332011580467224,0.34777912497520447,0.4245768189430237,0.3670206069946289,0.37562549114227295,-0.28003695607185364,-0.09171038120985031,-0.5123871564865112,0.38928210735321045,0.06638698279857635,0.07543051987886429,-0.18659043312072754],"z":[0.8512112498283386,-0.15676192939281464,-0.277456670999527,-0.4169926643371582,-0.163161963224411,-0.10692699998617172,0.0022405933123081923,-0.003072162391617894,-0.10875799506902695,-0.11315567791461945,0.4699138104915619,-0.34869396686553955,0.5406835675239563,0.4225492477416992,-0.31395259499549866,-0.3205644488334656,-0.16708959639072418,0.0543706938624382,-0.059561822563409805,0.3379365801811218,-0.23758794367313385,-0.3700820505619049,-0.21775312721729279,0.17977552115917206,0.19589683413505554,-0.2579484283924103,-0.2977273762226105,0.22307740151882172,0.525479257106781,-0.16678261756896973,0.35381239652633667,0.6050233244895935,0.2290804386138916,-0.26418429613113403,-0.08467942476272583,-0.37160423398017883,-0.20825237035751343,-0.32235589623451233,-0.22603864967823029,0.004922186024487019,0.49043869972229004,-0.24614404141902924,0.3677605092525482,-0.14383433759212494,-0.36718130111694336,-0.11674857139587402,-0.3431333899497986,-0.13594160974025726,-0.26742151379585266,-0.01101252157241106,-0.17260442674160004,-0.20460158586502075,-0.08848705142736435,0.236099511384964,0.055644694715738297,0.6822289824485779,0.19447754323482513,-0.015527329407632351,0.10862911492586136,-0.3180469274520874,-0.27695634961128235,0.058499451726675034,0.12636692821979523,-0.06316579878330231,-0.2803003489971161,-0.3511562645435333,0.18311826884746552,0.04951171576976776,-0.26218780875205994,-0.1687566041946411,0.18933752179145813,-0.07599892467260361,-0.35011258721351624,-0.23261205852031708,-0.15570159256458282,-0.28614890575408936,0.10392076522111893,0.28358691930770874,-0.31050023436546326,-0.15585044026374817,-0.362657368183136,-0.1741165965795517,-0.1322082132101059,-0.17727981507778168,-0.24297429621219635,0.6727334260940552,-0.32262006402015686,0.6882089972496033,-0.1812639981508255,-0.3411373496055603,0.3761766254901886,0.001552480855025351,-0.3340877890586853,-0.15017253160476685,0.5094301104545593,0.2442607581615448,-0.14188215136528015,-0.30727502703666687,-0.16324734687805176,-0.27270257472991943,-0.34355756640434265,0.3853454887866974,-0.04469529539346695,0.2511921226978302,-0.39731231331825256,0.4161553680896759,0.12460827082395554,-0.1110653281211853,-0.20254792273044586,-0.10734306275844574,0.3858087360858917,-0.11935987323522568,-0.005277050659060478,0.4397447109222412,-0.13289587199687958,-0.20462347567081451,-0.29761630296707153,0.1268048882484436,-0.1516554057598114,-0.020201312378048897,0.7738368511199951,-0.06983187049627304,0.17481958866119385,-0.18069352209568024,-0.08631262183189392,-0.2627331614494324,0.43942388892173767,-0.15798786282539368,0.21998576819896698,-0.029300790280103683,-0.212556853890419,-0.341031938791275,0.21441809833049774,0.031063998118042946,-0.17744843661785126,0.09553390741348267,0.19685184955596924,0.5959175229072571,-0.12178321927785873,-0.27394989132881165,0.6787540912628174,-0.0061084129847586155,-0.21358856558799744,0.0647832602262497,-0.3691146969795227,0.22723309695720673,0.007261375896632671,0.6935124397277832,0.11593206971883774,0.43440765142440796,0.08536315709352493,0.5306947231292725,-0.20773567259311676,-0.2321401685476303,0.0040376679971814156,-0.03121628426015377,0.7031357288360596,-0.04622603580355644,-0.0674549862742424,-0.1565653681755066,0.015737349167466164,-0.29171425104141235,0.27910128235816956,-0.2413378208875656,-0.2101118415594101,-0.15192988514900208,-0.161361426115036,0.18633262813091278,-0.22605925798416138,-0.2834879457950592,0.015221550129354,-0.2582477629184723,-0.258882075548172,0.47498008608818054,-0.0715542733669281,-0.199588805437088,-0.18134458363056183,0.3691180348396301,-0.12094772607088089,0.6548807621002197,-0.26598265767097473,0.5896905064582825,-0.17400704324245453,0.4088352620601654,-0.21840234100818634,-0.18152493238449097,-0.15305151045322418,0.5680006146430969,-0.14465218782424927,-0.19763588905334473,-0.2267024666070938,-0.1042708307504654,-0.13439686596393585,0.015731194987893105,-0.13348524272441864,-0.1959811896085739,0.5321155786514282,0.21129825711250305,-0.2611086070537567,-0.1997474730014801,-0.016467543318867683,-0.11268462240695953,0.2667922079563141,-0.15582482516765594,-0.002980600344017148,0.03275933116674423,-0.11930257827043533,0.3938925564289093,0.2426711916923523,-0.12791582942008972,-0.34384775161743164,0.4051729142665863,0.5303434729576111,0.41819337010383606,0.03859196975827217,0.441418319940567,-0.3426959216594696,-0.19712010025978088,-0.10429860651493073,-0.10824867337942123,-0.2743998169898987,-0.09717046469449997,0.11451559513807297,0.1648191213607788,-0.27744945883750916,-0.10407008975744247,0.66874098777771,0.0780545100569725,-0.10856107622385025,0.20618565380573273,0.37821927666664124,-0.15867359936237335,-0.15538620948791504,0.14504267275333405,-0.0349610410630703,-0.3498864471912384,-0.26029399037361145,0.13351848721504211,0.31511828303337097,-0.2728390097618103,-0.13331186771392822,0.2718659043312073,-0.16523848474025726,-0.3831561803817749,-0.27714160084724426,0.31089213490486145,-0.18710894882678986,-0.3900132477283478,-0.23597921431064606,-0.2871227264404297,0.2990213930606842,-0.21523495018482208,-0.05828191339969635,-0.23740462958812714,0.1651788204908371,-0.23735398054122925,-0.2734561562538147,-0.27371954917907715,-0.17140422761440277,0.4892288148403168,-0.2366412878036499,-0.31079524755477905,-0.033962927758693695,0.36366569995880127,-0.2564791738986969,-0.27731963992118835,-0.20892050862312317,-0.2558651864528656,-0.257074773311615,-0.2519688010215759,0.06122171878814697,-0.15103183686733246,-0.2776137888431549,0.017269747331738472,-0.3199540674686432,0.5611873269081116,-0.1386706829071045,0.6343835592269897,-0.19130492210388184,-0.05237869173288345,-0.2545219957828522,-0.12281426042318344,-0.24210889637470245,-0.017049267888069153,-0.23044097423553467,-0.22553597390651703,-0.006053544115275145,0.18256834149360657,0.007337616290897131,0.07959774136543274,-0.2901122272014618,-0.3188192546367645,0.6927573084831238,-0.2533920407295227,-0.20587359368801117,-0.1720549762248993,-0.21818907558918,0.2717631757259369,-0.2533624768257141,-0.04184505715966225,-0.20272186398506165,0.17249420285224915,-0.25555112957954407,-0.09725948423147202,0.1545741707086563,-0.07630134373903275,-0.06888342648744583,-0.17288121581077576,0.11224329471588135,0.15462824702262878,-0.12203150987625122,-0.25272613763809204,-0.19646477699279785,-0.27126801013946533,-0.02227581851184368,-0.23772285878658295,-0.09260537475347519,0.3330709636211395,-0.21994633972644806,0.27093008160591125,-0.1726067066192627,-0.2607952356338501,0.7509841918945312,-0.34698566794395447,0.12014947086572647,-0.18526631593704224,0.42053598165512085,0.6692202091217041,-0.06353851407766342,-0.29855799674987793,0.7217680215835571,0.014375952072441578,-0.11157487332820892,0.19333413243293762,0.0037270633038133383,0.07305510342121124,0.16505280137062073,0.3059254586696625,0.5069105625152588,-0.050322022289037704,0.016458092257380486,-0.3801599442958832,0.01487420778721571,0.23067457973957062,0.10697117447853088,-0.2280116081237793,0.08975633978843689,0.16808973252773285,-0.06552550196647644,0.7521719932556152,0.15081381797790527,0.19189946353435516,-0.171518936753273,-0.1539703905582428,-0.0019859028980135918,0.22328895330429077,0.17595480382442474,0.06453412026166916,0.44803035259246826,-0.12532015144824982,0.2707028090953827,-0.2752693295478821,-0.3021763861179352,-0.1728186011314392,-0.2800058126449585,0.5005674362182617,-0.29291683435440063,-0.3429408073425293,0.10968174785375595,-0.2293630838394165,0.052812330424785614,-0.08652235567569733,-0.16630959510803223,0.17537958920001984,-0.13649781048297882,0.17553141713142395,0.2438572645187378,-0.015118894167244434,-0.36249440908432007,-0.3499792516231537,-0.06390421837568283,0.3359956443309784,0.4566781520843506,0.2159109115600586,-0.11497727036476135,0.4588301181793213,0.31590574979782104,0.07212147861719131,-0.19773343205451965,0.07823699712753296,-0.25610628724098206,-0.2766593396663666,0.0871439278125763,-0.016505997627973557,0.1687953770160675,0.1417226642370224,-0.1448572278022766,-0.2921910583972931,0.482488214969635,-0.14975506067276,-0.19012604653835297,-0.19941705465316772,-0.056037694215774536,-0.13488595187664032,-0.3203812539577484,-0.11847598850727081,-0.20603381097316742,0.6332603693008423,0.09361714869737625,-0.18414799869060516,-0.16936886310577393,-0.1065085381269455,-0.17541329562664032,-0.26100534200668335,-0.2423928827047348,-0.1737302541732788,-0.233878031373024,-0.22358228266239166,-0.1795320361852646,-0.24563883244991302,-0.208782359957695,0.455955445766449,-0.22503219544887543,0.7726165652275085,0.19880178570747375,0.2611614763736725,-0.3095667064189911,0.2243366241455078,0.5786280632019043,-0.2751099765300751,0.20817941427230835,-0.29447993636131287,0.5117422938346863,0.20627900958061218,0.17834340035915375,-0.10539154708385468,-0.22020328044891357,-0.251064658164978,-0.18930350244045258,0.2315681278705597,-0.26657575368881226,0.21770715713500977,0.6747596859931946,-0.1071612611413002,-0.12428685277700424,-0.26959893107414246,-0.15680484473705292,-0.289254367351532,-0.019230680540204048,0.33614248037338257,-0.2370293289422989,-0.2338915914297104,-0.09127775579690933,-0.18060103058815002,-0.04452601075172424,-0.23754452168941498,0.29651138186454773,0.31652113795280457,0.20380659401416779,-0.0031727708410471678,-0.31044310331344604,-0.09204655885696411,-0.35299205780029297,-0.30544909834861755,-0.08653894066810608,-0.29075783491134644,0.3950999677181244,0.7734788060188293,0.486083984375,-0.2769741415977478,0.7078995704650879,-0.2601097822189331,-0.23685365915298462,-0.27349141240119934,-0.22659678757190704,-0.16295213997364044,-0.2490246593952179,-0.05844062566757202,-0.12548193335533142,-0.17518070340156555,0.5049634575843811,0.011485994793474674,-0.08212592452764511,-0.08951333165168762,-0.3832958936691284,0.22619426250457764,-0.11501205712556839,-0.020297344774007797,-0.2664793133735657,0.11127592623233795,-0.05495789647102356,-0.23577968776226044,-0.022775089368224144,-0.12278273701667786,-0.12727348506450653,-0.08650971949100494,-0.08715840429067612,-0.3220382630825043,-0.12305167317390442,-0.2510277032852173,-0.18519918620586395,0.2440413236618042,-0.248433917760849,-0.2768550515174866],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"margin":{"r":20,"b":10,"l":10,"t":0},"scene":{"xaxis":{"title":{"text":""},"showticklabels":false},"yaxis":{"title":{"text":""},"showticklabels":false},"zaxis":{"title":{"text":""},"showticklabels":false},"annotations":[{"text":"cat","x":-0.03974587470293045,"xanchor":"center","y":-0.1544657051563263,"z":0.8512112498283386},{"text":"dog","x":0.605739414691925,"xanchor":"center","y":0.5987532734870911,"z":-0.15676192939281464},{"text":"horse","x":-0.7684479355812073,"xanchor":"center","y":0.2872377932071686,"z":-0.277456670999527},{"text":"bird","x":0.20245441794395447,"xanchor":"center","y":-0.7315253615379333,"z":-0.4169926643371582}]},"width":700,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('07e63ea1-08e9-4c94-ab06-0a6181794ed5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="metric-based-embedding-methods" class="level2">
<h2 class="anchored" data-anchor-id="metric-based-embedding-methods">Metric-Based Embedding Methods</h2>
<p>In contrast to all this, metric-based embedding methods don’t try to collapse all the data to a predefined set of 3 (or 4, or more) “poles.” Rather, they try to get similar data to end up as points that are near each other, and dissimilar data points far away from each other. This tends to produce “clusters” but they are not (typically) along the “axes” of the space, they’re just “somewhere out there.”</p>
<p>Deep Learning experts <a href="http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf">Raia Hadsell, Sumit Chopra, and Yann LeCun</a> described it this way (I’m paraphrasing): Imagine all the data points are connected to each other via special kinds of springs. Similar kinds of points are connected by attractive springs that pull them together. Dissimilar kinds of points are connected by repulsive springs that push them further away from each other — except these repulsive springs are special in that they only apply a force when they’re close together; beyond a certain distance (called the “margin”), no repulsion occurs. (Why this special property is stipulated is a fine point we can get to later).</p>
<center>
<img src="https://drscotthawley.github.io/blog/posts/https:/raw.githubusercontent.com/drscotthawley/talks/main/SoTL_3DClass_April_2021/images/CL_springs_transp.png" width="60%">
</center>
<p>This picture of springs is the essence of a “<a href="https://arxiv.org/abs/2004.11362">contrastive loss</a>” function. Unlike traditional NN classification where the loss is based on the “distance” to a “target” (or “ground truth”) value, with these metric-based methods we send in two (or even 3) data points together, and then either let them attract or repel each other, and we do this over and over and over until we reach some stopping criterion. Eventually, what we’ll have is a space that contains clusters of similar points, separated by a “margin” distance that we specify.</p>
<section id="contrastive-loss-cartoon-demo" class="level3">
<h3 class="anchored" data-anchor-id="contrastive-loss-cartoon-demo">Contrastive Loss Cartoon Demo</h3>
<p>Below is a JavaScript animation of the “springs” cartoon above:</p>
<div class="cell">
<div class="cell-output cell-output-display">

        <iframe width="750" height="600" src="https://hedges.belmont.edu/~shawley/classy/classification_exercises/cldemo_raw.html" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can think of the margin as the amount of “push.”</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>(A computational aside) In this scenario, we don’t try to connect every point to every other point at the same time, as in some kind of N-body simulation. That could be computationally expensive and require something like a <a href="https://en.wikipedia.org/wiki/Barnes%E2%80%93Hut_simulation">Barnes-Hut</a>/octtree algorithm to make it efficient. Rather, we’re just randomly pairing two points at a time. Also, other metric learning schemes using “triplet loss” will group three points, setting one to be the “anchor” and then grabbing a positive and a negative example. For more on that, see a <a href="https://arxiv.org/abs/2010.04592">recent paper</a> or some <a href="https://github.com/adambielski/siamese-triplet">code from a couple years ago</a>. <strong>Update:</strong> You’ll see that I just added a “Triplets” checkbox above! Note that it will internally drop the number of steps by a factor of 2 for “honest” comparison with the non-triplet case.</p>
</div>
</div>
<p><strong>The cool thing</strong> about these methods is that the embedding that gets learned tends to work for classes the method has <strong>never seen before</strong>. So, for example, the embedding learned for grouping images of cats, dogs, and horses together would map images of birds to nearby points in the space. Then “all we have to do” if we want to predict a class is see whether a new instance is “nearby” (according to some distance measure we decide) to other similar points. We could even look at the “center points” of various clusters and regard these as the “class prototype” and use that in the future.</p>
<p>This fits (somewhat) with the notions of “prototypes” in human classification advanced by Eleanor Rosch in her revolutionary psychology work in the early 1970s. We can say more about this later. ;-)</p>
<p>This same method of contrastive losses and metrics is used not for classification <em>per se</em> but for things like photographic identity verification (an example that is given in Andrew Ng’s Machine Learning course on Coursera): Say you want to have a facial recognition system (highly problematic for ethical reasons but it’s a good example of the method so bear with me) for a company where there can be turnover in employees: You probably don’t want to train a traditional classifier with separate a class for each employee because then you’d have to re-train it every time someone joins or leaves the company. Instead, you can store an image of each employee, and then when they appear in front of a camera for identity verification, you could compare the “distance” between the embedded data point for the new photo from the data point for the stored photo(s). If the distance is small enough, then you can have confidence it’s the same person.</p>
<p>This is the idea behind a “<a href="https://docs.fast.ai/tutorial.siamese.html">Siamese Network</a>”, so called because like Siamese twins, it uses two <em>identical</em> branches consisting of the same network (or just the same network run twice):</p>
<center>
<img src="https://drscotthawley.github.io/blog/posts/https:/people.kth.se/~rosun/deep-learning/figures/siamese-arch.svg" width="65%">
<p style="font-size:90%; text-align: center;">
Example of a Siamese Network (source: <a href="https://people.kth.se/~rosun/deep-learning">Sundin et al</a>)
</p>
</center>
<p>So in using metric-based learning for classification, we’re essentially adopting this identity-verification app and applying it to entire classes instead of individuals.</p>
<p>What’s nice about this is that, after you’ve trained your embedding system, it can typically still be used to measure similarity between pairs of things it’s never seen before, because in the process of training it was forced to learn “semantically meaningful” ways of grouping points together. This use of the linguistic work “semantic” is not accidental: the language model systems that rely on “word embeddings” can learn to group similar words together, and even have mathematical-like relationships in analogies (e.g., gender: “king - man + woman = queen”, or countries-and-capitals: “Russia - Moscow + France = Paris”) by treating the embedded data points as <em>vectors</em> that point from the origin of the coordinate system to the data point. We can say more about this and the distance metric they use (“cosine similarity”) another time.</p>
</section>
</section>
<section id="how-well-do-they-work" class="level2">
<h2 class="anchored" data-anchor-id="how-well-do-they-work">How well do they work?</h2>
<p>So, how do traditional ML classification and metric-based zero-shot methods stack up? Which one is more accurate?</p>
<p>Well, <em>depends</em> on what you want it for, but for example in 2016, a group of researchers scored pretty high on a Kaggle competition for classification using “<a href="https://arxiv.org/abs/1604.06737">entity embeddings</a>.” They said:</p>
<blockquote class="blockquote">
<p>“Entity embedding not only reduces memory usage and speeds up neural networks compared with one-hot encoding, but more importantly by mapping similar values close to each other in the embedding space it reveals the intrinsic properties of the categorical variables. We applied it successfully in a recent Kaggle competition and were able to reach the third position with relative simple features.”</p>
</blockquote>
<p>As far as our own demonstrations, we’ll explore that in <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a>. As a teaser, here’s an image from my own <a href="https://colab.research.google.com/drive/1rSTOsj4coDu9mZCw57S7R6jBipm462R2?usp=sharing">Contrastive Loss Modification</a> of the <a href="https://docs.fast.ai/tutorial.siamese.html">FastAI tutorial on Siamese Networks</a>:</p>
<center>
<img src="https://drscotthawley.github.io/blog/posts/https:/raw.githubusercontent.com/drscotthawley/talks/main/SoTL_3DClass_April_2021/images/my_pets_preds3.png" width="80%">
</center>
<p>…the model achieved an accuracy of 88 to 90% in identifying pet breeds – here’s the kicker – that it had <strong>never seen before</strong>. The model was trained on a completely different set of breeds, which would have stumped a traditional NN classifier, but the similarity-based embedding method was able to apply the “semantically meaningful” representations learned during training to group new pet breeds by similarity!</p>
<p>There’s an <strong>important point / “confession”</strong> that needs to be made here: These “pet breeds” results were obtained using way more than 3 dimensions – 128 dimensions to be exact. In the real world, such high dimensions are typically necessary. In <a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html">Part 2</a>, we’ll explore more carefully how the dimensionality of the embedding can affect our accuracy.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>The “Joy of 3D” referred to in this blog post is about 3D as a <em>teaching tool</em> to motivate our understanding of both traditional NN classification and contrastive-loss based metric learning as <strong>both being types of embeddings.</strong></p>
<p>The types of “triangle plots” introduced here give students a visual interpretation of “where the data points are” in terms of…</p>
<ol type="1">
<li>prediction/probability values (via locations of dots)</li>
<li>losses (~ distance from target)</li>
<li>accuracies (which side of “the line” they’re on).
<ul>
<li>Thus it also gives you a visual representation of the “confusion matrix”.</li>
</ul></li>
<li>You can inspect the data points by mousing over the dots to see the images.
<ul>
<li>Thus it allows you to track “top losses” visually, i.e.&nbsp;points that are “not where they’re supposed to be”.</li>
</ul></li>
</ol>
<p><a href="https://drscotthawley.github.io/blog/scottergories/2021/06/17/Contrasting-Contrastive-Loss.html"><strong>Next time</strong>, in Part 2</a>, I’ll walk you through the specifics and show you some real training examples (that you can run on your own) with these sorts of “triangle plots”, via my new FastAI callback <code>VizPreds</code> (that I learned how to write)!</p>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements:</h2>
<p>Special thanks to <a href="https://twitter.com/TheZachMueller">Zach Mueller</a>, <a href="https://twitter.com/iScienceLuvr">Tanishq Abraham</a> and <a href="https://twitter.com/isaac_flath">Isaac Flath</a> for assistance in interfacing with fastai!</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References:</h2>
<ul>
<li><a href="https://github.com/adambielski/siamese-triplet">“Siamese and triplet learning with online pair/triplet mining”</a> by Adam Bielski</li>
<li><a href="https://twitter.com/jeremyphoward/status/1133252425949753344/photo/1">Example of new <code>Pipeline</code> class to create data for a Siamese model,“</a> by Jeremy Howard</li>
<li><a href="https://towardsdatascience.com/siamese-network-triplet-loss-b4ca82c1aec8">“Siamese Network &amp; Triplet Loss”</a> by Rohith Gandhi</li>
<li><a href="https://github.com/KevinMusgrave/pytorch-metric-learning">pytorch-metric-learning</a> by Kevin Musgrave</li>
<li><a href="https://towardsdatascience.com/contrastive-loss-explaned-159f2d4a87ec">“Contrastive Loss Explained”</a> by Brian Williams</li>
<li><a href="https://arxiv.org/abs/2006.07733">“Bootstrap Your Own Latent (BYOL)”</a> by Grill et al</li>
<li><b><a href="https://www.cs.cmu.edu/~rsalakhu/papers/oneshot1.pdf">“Siamese Neural Networks for One-shot Image Recognition”</a> by Koch et al</b></li>
<li><a href="https://msiam.github.io/Few-Shot-Learning/">“Few Shot Learning”</a> by msiam</li>
<li><a href="https://katefvision.github.io/katefSlides/oneshotlearning_katef.pdf">“Learning to learn, Low shot learning”</a> by Katerina Fragkiadaki</li>
<li><a href="http://proceedings.mlr.press/v37/romera-paredes15.pdf">“Embarassingly Simple”: </a> <span style="color:blue">“We describe a zero-shot learning approach that can be implemented in just one line of code, yet it is able to outperform state of the art approaches on standard datasets”</span></li>
</ul>


</section>

 ]]></description>
  <category>classification</category>
  <category>ssl</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-05-04-the-joy-of-3d.html</guid>
  <pubDate>Tue, 04 May 2021 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/cat_dog_horse_triangle_fullcolor.png" medium="image" type="image/png" height="105" width="144"/>
</item>
<item>
  <title>Scottergories: Making GPT-3 Generate 3 of a Kind</title>
  <link>https://drscotthawley.github.io/blog/posts/2021-02-15-Making-GPT3-Generate-3-Of-A-Kind.html</link>
  <description><![CDATA[ 




<p>{{ page.content | number_of_words | minus: 26}} words, {{ page.content | number_of_words | divided_by: 180 | append: ” minute read” }}, {{ page.content | number_of_words | divided_by: 275 | append: ” paperback pages” }}</p>
<p><em>I’m a computational physicist who spent most of his life only interested in curve-fitting, i.e.&nbsp;“regression.” Recently I’ve become fascinated in “classification” to the point where I’m in the process of writing a popular-level book on classification and categories. (For a couple recent works that include some of this, see {% cite hawleywhoserules %} and {% cite hawleykruger %}.)</em></p>
<p>In June of 2020, I applied for OpenAI API “GPT-3” {% cite gpt3 %} access immediately upon its announcement… and just heard back eight months later (shortly after I <a href="https://twitter.com/drscotthawley/status/1358991822945681409?s=20">tweeted something nice about OpenAI’s “CLIP” paper</a>). My proposal was to explore the GPT-3 language model’s capacity for handling categories, something I’ll refer to loosely by the shorthand of “categorical reasoning” (but don’t take this to mean that I assert GPT-3 actually “reasons” anything). On the form to request access, I wrote:</p>
<blockquote class="blockquote">
<p>“I’m interested in the modeling and representation of categories using machine learning and how this task compares with human traditions in philosophy and psychology, particularly how concepts are intertwined with language. My sabbatical this fall includes writing a popular-level book about the history of classification with a goal towards relating this to the societal impact of deployed machine learning models. (I gave a <a href="https://hedges.belmont.edu/~shawley/classy/Wheaton2019talk">talk at Wheaton on this</a> last fall.) This interdisciplinary work began in Oxford two years ago and has been partially supported by a grant from the Templeton and Blankmeyer foundations.</p>
<p>One concrete problem related to this effort is the fairly well-posed question of to what extent sophisticated language models contain sufficient categorical ‘knowledge’ and ‘reasoning’ capacity to play (or officiate) a game such as “Scattergories” — in which unusual, <strong>never-before-seen</strong> categories are introduced during play (e.g., “things you’d find under a bed”). Humans do this well, but my experiments so far with Word2Vec embeddings and with GPT-2 (via the <a href="https://transformer.huggingface.co/">HuggingFace API</a>) have indicate that both are poorly-suited to this task. I am applying for access to the OpenAI API because I’m curious to see how GPT-3 fares. Categorical reasoning is foundational to intelligence, so such a task is relevant both for understanding human intelligence as well as for advancing the development of general artificial intelligence” [the mission of OpenAI].</p>
</blockquote>
<p>For examples of just how poorly GPT-2—the older, smaller model—performs at this task, see the “Discussion” below. Believe me when I say the results were disappointing.</p>
<p><em>“GPT-2 had 1.5 billion parameters. GPT-3 has 175 billion.”</em></p>
<p>Now, with GPT-3 access, we can begin to see how this newer, bigger model performs. The essence of using the API is the “Prompt”. So, my job is to craft prompts, and then see how well the model responds. My first experiment with the API involves getting the model to generate “three of a kind”:</p>
<p><strong><em>Update</em>:</strong> <em>Oh, hey, there’s a <a href="https://arxiv.org/abs/2102.07350">new paper on GPT-3 prompt-writing</a> that came out the same day I wrote this post! Guess I’ll read that soon.</em></p>
<section id="three-of-a-kind" class="level2">
<h2 class="anchored" data-anchor-id="three-of-a-kind">Three of a Kind</h2>
<p>Let’s see if GPT-3 can expound in threes. <strong>I’ll write my prompt in bold</strong>, and then <u>underlined text will show the model’s completion/output</u>. <em>(Additional commentary from me will be in italics.)</em></p>
<p><strong>This application generates example members of a category. Examples of fruits are apples, oranges and bananas. Examples of birds are</strong> <u>quails, crows and sparrows</u>. <em>(Whoa! Not bad! This is with the “davinci” model, with Response Length = 10 tokens, Temperature = 0.7, Top P = 1, etc..all defaults.)</em></p>
<p><em>(Ok, I wasn’t always getting three examples when I’d re-try, so let’s make the “three” explicit:)</em></p>
<p><strong>This application generates three example members of a category. Three examples of fruits are apples, oranges and bananas. Three examples of dogs are</strong> <u>Labrador, Rottweiler and Husky</u>. <em>(Had to increase response length to 15 and then truncate the extra text which read “The input is”)</em></p>
<p><em>(For the following, just assume that I’m truncating unwanted extra text. Also, to save space, I’ll refrain from printing the entire prompt I use, and just list the categories…)</em></p>
<p><strong>fish:</strong> <u>salmon, bass and tuna.</u></p>
<p><strong>U.S. Presidents:</strong> <u>George Washington, Franklin Delano Roosevelt and Ronald Reagan</u> <em>(Whoah, this one triggered the “This completion may contain sensitive content” warning!)</em></p>
<p><strong>philosophers:</strong> <u>Plato, Descartes and Kant.</u></p>
<p><strong>things you’d find in a refrigerator:</strong> <u>milk, orange juice and apple juice.</u> (<em>Sure. But since it’s a random sample, let’s go again:</em>) <u>milk, cheese and vegetable salsa.</u> <em>(Not bad!)</em></p>
<p><strong>things you’d find under a bed:</strong> <u>a mouse, a handkerchief and a ball.</u> <em>(Ok, I guess…why not? Again:)</em> <u>socks, shoes and books.</u> <em>(ok…I can buy that.)</em></p>
<p><strong>80’s power ballads:</strong> <u>“Faith” by George Michael, “I Want to Know What Love Is” by Foreigner and “The Power of Love” by Huey Lewis and the News.</u> <em>(uh…if you say so. At least these are all in the 80s!)</em></p>
<p><strong>household chores:</strong> <u>cleaning, cooking and sweeping.</u> <em>(or again:)</em> <u>washing, cleaning and ironing. Three examples of sports are swimming, running and cycling.</u> <em>(The model added that second sentence all by itself! Note all of these are gerunds, i.e.&nbsp;-ing words; it didn’t say, for example, something odd/wrong like “clean, mop, broom”)</em></p>
<p><strong>things you don’t want your mom to know about you:</strong>: <u>a. how drunk you were at the last party b. that you smoke pot c.&nbsp;that you plagiarized on that paper for your English class.</u> <em>(Whoa, have we reached AGI? ;-) And extra points for the use of “a. b. c.”)</em></p>
<p><strong>items you take on a trip:</strong> <u>a car, a suitcase and a book.</u> <em>(You CAN “take” a car, can’t you? hah! Nice linguistic anomaly.)</em></p>
<p><strong>fruits of the Holy Spirit:</strong> <u>faith, hope and love.</u> <em>(I mean, I want share this on <span class="citation" data-cites="FaithTechHub">@FaithTechHub</span>, so…right? LOL)</em></p>
<p><em>OK, I am sufficiently impressed and have now gone to get my official Hasbro(TM) Scattorgories game…The following prompts are from the game</em></p>
<p><strong>things that are sticky:</strong> <u>gum, tape and bubble gum.</u> <em>(<a href="https://www.youtube.com/watch?v=SAfq55aiqPc">Nooice!</a>)</em></p>
<p><strong>things you add water to:</strong> <u>eggs, rice and pasta.</u> <em>(eggs? Hmm…go again:)</em> <u>tea, coffee and milk.</u> <em>(nice. …wait, milk?. Again:)</em> <u>urns, cups, and buckets.</u> <em>(whoa!)</em></p>
<p><strong>terms of measurement:</strong> <u>kilometers, centimeters and grams. Three examples of colors are red, blue and green. Three examples of adjectives are red, blue and green. Three examples of verbs are run, jump</u> <em>(See? It will keep generating categories if you set Response Length longer. Let me make the Response Length even longer, to 200…)</em></p>
<p><strong>terms of measurement:</strong> <u>3, 4 and 5 meters. Three examples of angles are 20 degrees, 40 degrees and 60 degrees. Three examples of countries are Japan, France and Germany.</u> <em>(Ok and beyond that it just repeats itself and/or repeats similar sentences, like: “The application generates the following sentences. This application generates verbs. The application generates the following sentences. This application generates pronouns.” and so on)</em></p>
<p><strong>things found in the ocean:</strong> <u>fish, coral and whales. Three examples of things found in the sky are clouds, stars and planets.</u> <em>(that second sentence was generated by the model)</em></p>
<p><strong>things that are bright:</strong> <u>the sun, the moon and the stars. Three examples of things that are made of wood are tables, chairs and fences.</u> <em>(Again, the second sentence was generated. Just in case it’s got a heavenly-body fixation, let’s go again:)</em> <strong>things that are bright:</strong> <u>the moon, the sun and an electric bulb. Three examples of furniture that a household might have are a sofa, a chair and a table.</u> <em>(Good job! “furniture” is a tricky category as described by George Lakoff {% cite Lakoff87 %})</em></p>
<p><strong>leisure activities:</strong> <u>simple relaxation, snowboarding and surfing. Three examples of countries are USA, Canada and Mexico.</u> <em>(Not bad)</em></p>
<p><strong>reptiles/amphibians:</strong> <u>lizards, frogs and crocodiles.</u> <em>(Ok, that “slashed” construction of “reptiles/amphibians” was literally what was printed on the card. I had not expected GPT-3 to pull that off, but mixing reptiles (lizards &amp; crocodiles) with amphibians (frogs) is pretty cool. Let’s try just reptiles:)</em> <strong>reptiles:</strong> <u>lizards, snakes and turtles. Three examples of mammals are cows, sheep and giraffes. In each example, the category is written in bold letters and</u> <em>(Ok, now that’s just cheeky!)</em></p>
<p><strong>things you do online:</strong> <u>search, chat and email.</u> <em>(Note how it generates only things that are…arguably..verbs. Again:)</em> <u>checking email, shopping and playing games.</u> <em>(My goodness, it’s full of gerunds!)</em></p>
<p><em>(Yea, let’s try gerunds, and let’s bump the Response Length up to 145…)</em></p>
<p><strong>gerunds:</strong> <u>eating, running and swimming. Three examples of adjectives are large, strong and important. Three examples of verbs are write, jump and try. Three examples of adverbs are quickly, happily and carefully. Three examples of adjectives are big, wide and dangerous. Three examples of prepositions are to, in and on. This application generates a category. All examples are of the same gender, number and case. Three examples of nouns are dog, cat and bird. Three examples of adjectives are tall, small and large. Three examples of prepositions are by, for and under. Three examples of adverbs are quickly, slowly and</u> <em>(SHOW OFF!)</em></p>
<p><strong>terms of endearment:</strong> <u>honey, sweetheart and dear.</u> <em>(awww)</em></p>
<p><em>Ok, I’ve now gone and grabbed my boxed copy of <a href="https://www.thegameofthings.com/">The Game of Things</a>. Now, keep in mind, some of these things can be of a “suggestive” nature…</em></p>
<p><strong>things you would like to do with chocolate:</strong> <u>eat it, cook with</u> <u>it and share it with your friend.</u> <em>(Uh…ok, that was not at all suggestive, haha!)</em></p>
<p><strong>things you shouldn’t do on your honeymoon:</strong> <u>drink, drive and shop. Three examples of good economic policies are low interest rates, an independent central bank and low taxes. (COMPLETION MAY CONTAIN SENSITIVE CONTENT)</u> <em>(All very sensible, though not likely to be what you’ll hear if you play in a group of humans. Note that the “goal” of the humans would be to make each other laugh, whereas GPT-3 is just trying to generate high-probability matches. It’s basically playing <a href="https://www.familyfeud.com/">Family Feud</a>.)</em></p>
<p><strong>things that warrant an apology:</strong> <u>spilling a drink on someone, saying something rude to someone, and being late for an appointment.</u> <em>(Yeah, good job GPT-3!)</em></p>
<p><strong>things that would get you fired:</strong> <u>stealing, sleeping on the job and talking back to your boss.</u> <em>(Sure!)</em></p>
<p><strong>things you would do if you had super-human powers:</strong> <u>play baseball, run in the Olympics and fly to the moon.</u> <em>(again:)</em> <u>catch a falling satellite, fly from New York to Tokyo, and make a million dollars.</u> <em>(Ok. Sensible answers, and note that all the verb-usage matches.)</em></p>
<p><strong>things you shouldn’t try to hold on to:</strong> <u>a pen, a balloon and a cork. The idea is that you decide whether the example is an example of the category, or not. You click</u> <em>(Ok, wait a sec.&nbsp;Not sure about the pen, balloon and cork??, but it seems like it’s scraped some aspect of category-naming-games and included it in here! Let’s re-do a bunch)</em></p>
<p><strong>things you shouldn’t try to hold on to:</strong> * <u>a taxi, a dead rat and a Volkswagen.</u> * <u>a hot potato, a hot date and a hot temper.</u> * <u>a rock, a bird and a balloon.</u> * <u>a ball, a cat and a balloon. Three examples of things you should be careful with are an axe, a knife and a gun.</u> <em>(2nd sentence is part of the output)</em> * <u>a balloon, a basketball and a cactus. In the example, the Generate action is used to randomly generate a member of the category. This</u> <em>(Ok, kudos on the cactus. Not sure where it’s getting its category-gaming info from)</em></p>
<p><em>(Speaking of <a href="https://www.youtube.com/watch?v=5OAaa7B_GmE">Something To Hold On To</a>, let’s give it an obscure music task just to see how it does:)</em></p>
<p><strong>songs by Trevor Rabin:</strong> <u>“Racing in the Street”, “Big Generator” and “Can I Play With Madness”.</u> <em>(hahaaaha. The first is a Springsteen tune, the 2nd the <a href="https://www.youtube.com/watch?v=8W_VC_BgMjo">title track off Yes’ Big Generator album</a> when Rabin was in the band and supposedly they all shared writing credits, and I would PAY MONEY to see Trevor Rabin cover Iron Maiden’s “<a href="https://www.youtube.com/watch?v=Kvqr366Op3k">Can I Play With Madness</a>”!)</em></p>
<p><em>(BTW, if you want to hear an incredible cover of “Something To Hold On To,” please give <a href="https://soundcloud.com/rextunes/something-to-hold-on-to-master">my good friend Rex Schnelle’s version a listen</a>. Moving on…)</em></p>
<p><strong>things you shouldn’t share:</strong> <u>toothbrushes, clothes and pencils.</u> <em>(I did this over &amp; over and “toothbrushes” was in every output, no matter how high I made the Temperature)</em></p>
<p><strong>things you shouldn’t try to do in the dark:</strong> <u>play tennis, play football and drive a car.</u> <em>(All my retries on this were similarly boring; GPT-3 rarely surprises one with its off-the-wall hilarity)</em></p>
<p><em>(Speaking of lack of originality, it’s amazing how many cards in The Game of Things start with “Things you shouldn’t…”)</em></p>
<p><strong>things you wouldn’t want to find in your sandwich:</strong> <u>a brick, a piece of glass and a dead rat.</u> <em>(Spot on)</em></p>
<p><em>(As a resident of Nashville, I’m curious to see if we can make it write a country song; many country songs are just lists of nostalgia for bygone rural America…)</em></p>
<p><strong>things you remember about growin’ up on the farm:</strong> <u>mud, worms, and tractors.</u> <em>(ok, sure)</em></p>
<p><strong>things Daddy used to tell you</strong>: <u>“Don’t do that!”, “Be nice.”, and “Look out!”. Three examples of things you are going to do when you grow up are: “travel to the moon.”, “write a book”, and “learn how to dance”. The full Python code is shown below: def make_things(): fruits = [“apple”, “orange”, “banana”] people = [“Daddy”, “Mommy”, “Grandpa”] things = [“Don’t do that!”, “Be nice.”, “Look out!”] things = [“travel to the moon.”, “write a book.”, “learn how to dance.”] return fruits, people, things What is the purpose of this application</u> <em>(Whooooaaa! What IS this thing? Is there a human being on the other end of this? ;-) .)</em></p>
<p><strong>things you like about your truck:</strong> <u>leather seats, size, and the sound system.</u> <em>(Eh. Technically valid answers, sensible, high-probability examples. Nothing “creative” though, of course. Again, only this time I’ll crank the Temperature up to 0.97:)</em> <u>safety rating, engine, and CD player.</u> <em>(The “trying to win at Family Feud” analogy is apt. Ok, forget the country song. Moving on.)</em></p>
<p><strong>things you wouldn’t want a doctor to say to you:</strong></p>
<ul>
<li><u>“you don’t have anything to worry about”, “one more time” and “we’ll see how it goes”.</u> <em>(The model knew to use quotation marks! First example seems wrong.)</em></li>
<li><u>I have good news and bad news, surgery is now a day care procedure and it’s not cancer, it’s a tumor.</u> <em>(Uh.. huh?)</em></li>
<li><u>, “You’re dead”, “You’re pregnant”, “You’re infected”. Three examples of things you wouldn’t want a doctor to say to your wife are</u> <em>(Nice comma usage, and Whoa! Let’s do that last one…)</em></li>
</ul>
<p><strong>things you wouldn’t want a doctor to say to your wife:</strong> * <u>“I’m sorry” “I love you” and “I’m sorry I love you.”</u> <em>(hahaha!)</em> * <u>, “I’m afraid you have cancer”, “I’m afraid you have AIDS” and “I’m afraid you have syphilis.” Three examples of names of big cities are London, Paris and Los Angeles. Three examples of books to read are “War and Peace”, “Mein Kampf” and “The Catcher in the Rye”.</u> <em>(Ok, I think it’s got the hang of this 3’s-generating now! LOL)</em></p>
<p><em>Last up: I mentioned this to my friend Heather and she asked me how long I get to ‘keep playing with it’. I said “My free trial tokens expire May 15, 2021, and I’ve already used 6000 out of 300k tokens. So it’s basically like joining the Chuck E. Cheese club.” She said, “Nice! I wonder if you can teach it to win at skee ball 😅” Which means now I have to do…</em></p>
<p><strong>things you’d find at Chuck E. Cheese:</strong> <u>video games, a ball pit and tokens. Three examples of dinosaurs are Tyrannosaurus Rex, Triceratops and Velociraptor.</u> <em>(NOT BAD! I’m going to go again, and if it mentions skee ball, WE’RE DONE.)</em> * <u>tokens, pizza and soda.</u> <em>(good)</em> * <u>Chuck E. Cheese himself, his brother, and a clown.</u> <em>(Ohhh-kay that’s enough for now! haha)</em></p>
</section>
<section id="discussion-preliminary-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="discussion-preliminary-thoughts">Discussion (Preliminary Thoughts)</h2>
<p>“Surely this is not a very ‘intelligent’ task,” you say. “All it does is generate words that have some suitably high probability of being associated with the word in the prompt.” “Since it was trained on the internet, such lists-of-things-in-a-category probably already exist as web pages somewhere anyway”</p>
<p>Right, one could imagine scraping a ton of web pages for text and then training some kind of non-Transformer-based method, maybe even a Bayesian bag-of-words model (like in a simple spam detector) to rank “related words” and pick the top choices.</p>
<p>That’s not exactly what’s happened here. Yes, GPT-3 was trained on tons of web pages, yes it “knows” (has a probabilistic model for) word associations, but also…</p>
<p>It is a “few shot learner” so it essentially <em>instantly</em> starts giving me outputs like what I want, without having been pre-trained on the task I want it to do. The fact that it gets singular vs.&nbsp;plural right, and verbs vs.&nbsp;nouns, and <em>gerunds</em> correct in its answers is noteworthy.</p>
<p>So far, this is just my first night of access to the API, and it blows away what I could get GPT-2 to do. One can try out various GPT-2 model sizes using the friendly interfaces at <a href="https://transformer.huggingface.co/">HuggingFace.com</a>. For the smallest GPT-2 model, I got</p>
<p><strong>dogs:</strong> <u>cats.</u>” <em>(<a href="https://media.giphy.com/media/1AHESbqpjV1AFSNJdA/giphy.gif">Womp womp!</a>)</em></p>
<p>The largest GPT-2 model size, however, with suitably adjusted parameters, <u>could generate 3 dog breeds or 3 U.S. Presidents correctly</u>. But any of the more “challenging,” “speculative” categories (e.g.&nbsp;“things you might…”) give even the largest GPT-2 at HuggingFace a hard time:</p>
<p><strong>things that would get you fired:</strong> <u>the fire alarm, the bathroom sink and the bathroom mirror.</u> <em>(?? The other various completions generated by GPT-2 when I re-ran it were similarly irrelevant.)</em></p>
<p>One further possible remark to my post here: “You realize you aren’t really playing Scattergories(tm), right?” Yes of course. Scattergories involves rolling the dice and getting a letter and having to name a bunch of things that start with that letter. <em>Pace.</em> I was never actually wanting to replicate the Scattergories(tm) game engine itself, rather the name of the game was a placeholder for the idea of “categorical reasoning.” Now…could we get GPT-3 to <em>actually</em> <em>play</em> Scattergories? …I’m not sure I even …care? I’m not sure how you’d write the prompt for that, but I’m open to trying it. For now, at just my first night of trying things out, this seems remarkably encouraging.</p>
<p>Which means….based on my experience with AI models: If the initial trial is encouraging, that means there’s a TON of failure modes you just haven’t discovered yet! ;-) We can probe for those too, another time – so far I’ve only used up 1.6% of my free tokens. There’s a lot more that one can do to use the API, and so far I haven’t used any of the advanced prompt-making utilities. <strong>Still, for the first foray into the OpenAI API, this was a GREAT experience!</strong></p>
<p><strong>P.S.-</strong> OH GEEZ I JUST NOTICED THAT I TAUGHT GPT-3 TO <em>NOT</em> USE THE OXFORD COMMA! May a large millstone be tied around my neck… <strong>Wait wait!</strong> : All that was needed to get it to start generating Oxford-comma-style examples was to add the comma to my one example: “apples, oranges, and bananas.” Wow.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>


</section>

 ]]></description>
  <category>classification</category>
  <category>language_models</category>
  <guid>https://drscotthawley.github.io/blog/posts/2021-02-15-Making-GPT3-Generate-3-Of-A-Kind.html</guid>
  <pubDate>Tue, 16 Feb 2021 01:33:31 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/gpt3-3s.png" medium="image" type="image/png" height="124" width="144"/>
</item>
<item>
  <title>Naughty by Numbers: Classifications at Christmas</title>
  <link>https://drscotthawley.github.io/blog/posts/2020-12-11-Naughty-by-Numbers.html</link>
  <description><![CDATA[ 




<section id="head-over-to-httpshedges.belmont.edushawleynaughty-to-see-this-post." class="level2">
<h2 class="anchored" data-anchor-id="head-over-to-httpshedges.belmont.edushawleynaughty-to-see-this-post.">Head over to <a href="https://hedges.belmont.edu/~shawley/naughty/">https://hedges.belmont.edu/~shawley/naughty/</a> to see this post.</h2>
<p>(It uses enough JavaScript that this blogging platform will mangle it.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/hedges.belmont.edu/naughty/naughty2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">preview image</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>classification</category>
  <category>foundations</category>
  <guid>https://drscotthawley.github.io/blog/posts/2020-12-11-Naughty-by-Numbers.html</guid>
  <pubDate>Fri, 11 Dec 2020 22:25:13 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/naughty2.png" medium="image" type="image/png" height="84" width="144"/>
</item>
<item>
  <title>Citations in Fastpages via BibTeX and jekyll-scholar</title>
  <link>https://drscotthawley.github.io/blog/posts/2020-07-01-Citations-Via-Bibtex.html</link>
  <description><![CDATA[ 




<p><em>(N.B.: The following was created as a Markdown file in <code>_posts/</code>. For Jupyter notebooks, the same things apply; one simply enters the Liquid codes into Markdown cells. <a href="https://drscotthawley.github.io/devblog4/jupyter/2020/07/01/BibTeX-Check-For-Jupyter.html">Quick Jupyter example.</a></em>)</p>
<section id="how-to-cite" class="level2">
<h2 class="anchored" data-anchor-id="how-to-cite">How to Cite</h2>
<p>For demonstration purposes, I’ll take the liberty of citing a couple of my recent papers, namely the first SignalTrain paper {% cite signaltrain %} and the new one by Billy Mitchell {% cite billy_signaltrain2 %}. Instead of using the LaTeX code {% raw %}\cite{ &lt;whatever&gt; }{% endraw %}, I use the Liquid code {% raw %}{% cite &lt;whatever&gt; %}{% endraw %}. For example, the first citation above is written as “{% raw %}{% cite signaltrain %}{% endraw %}” in the Markdown file that generates this HTML page.</p>
<p>The two citation markings above point to the References section at the end of this post where the full references are printed out in the bibliography style of my choice.</p>
</section>
<section id="drawing-from-the-bibliography" class="level2">
<h2 class="anchored" data-anchor-id="drawing-from-the-bibliography">Drawing from the Bibliography</h2>
<p>In the main blog directory, create a new directory called <code>_bibliography/</code>, and place your BibTeX file there as <a href="../_bibliography/references.bib">references.bib</a>. In the case of this demo, the references file looks like this:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bibtex code-with-copy"><code class="sourceCode bibtex"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">@conference</span>{<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">signaltrain</span>,</span>
<span id="cb1-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span> = {Profiling Audio Compressors with Deep Neural Networks},</span>
<span id="cb1-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">author</span> = {Hawley, Scott H. and Colburn, Benjamin and Mimilakis, Stylianos Ioannis},</span>
<span id="cb1-4">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">booktitle</span> = {Audio Engineering Society Convention 147},</span>
<span id="cb1-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">month</span> = {Oct},</span>
<span id="cb1-6">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">year</span> = {2019},</span>
<span id="cb1-7">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">url</span> = {http://www.aes.org/e-lib/browse.cfm?elib=20595}</span>
<span id="cb1-8">}<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">               </span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">@article</span>{<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">billy_signaltrain2</span>, </span>
<span id="cb1-11">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span>={Exploring Quality and Generalizability in Parameterized Neural Audio Effects},</span>
<span id="cb1-12">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">author</span>={William Mitchell and Scott H. Hawley},</span>
<span id="cb1-13">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">journal</span>={ArXiv},  </span>
<span id="cb1-14">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">year</span>={2020},</span>
<span id="cb1-15">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">volume</span>={abs/2006.05584} </span>
<span id="cb1-16">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">url</span> = {https://arxiv.org/abs/2006.05584}</span>
<span id="cb1-17">}<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> </span></span></code></pre></div>
<p>Note that this (single) references file is for your entire blog. The great thing about this is that all your Jupyter notebooks and Markdown posts will draw from this same file, which could be hundreds of references long, and jekyll-scholar will only include the ones you need for each post.</p>
<p>Finally, at the end of your post, you signal the creation of the list of references by using the Liquid tag</p>
<pre class="liquid"><code>{% raw %}{% bibliography --cited %}{% endraw %}</code></pre>
<p>…so I’ll put that at the very bottom of this file. (Currently that’ll generate an error, because we haven’t enabled jekyll-scholar yet, but we’ll do that next.) The optional argument <code>--cited</code> means it’ll only list the references cited in your post.</p>
</section>
<section id="enabling-jekyll-scholar" class="level2">
<h2 class="anchored" data-anchor-id="enabling-jekyll-scholar">Enabling Jekyll-Scholar</h2>
<p>To enable jekyll-scholar, all we need to do is make the following two changes, and perhaps a third.</p>
<ol type="1">
<li><p>In <code>_config.yml</code>, add “<code>- jekyll-scholar</code>” to the list of <code>plugins:</code>.</p></li>
<li><p>Edit the <code>Gemfile</code> to include <code>gem 'jekyll-scholar'</code> where the other plugins are listed.</p></li>
<li><p>Optional: The default citation format is “apa”. If you want to change that, you can add the following to your <code>_config.yml</code> file:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scholar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb3-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> &lt;name&gt;</span></span></code></pre></div>
<p>…naming one of the styles in the <a href="https://github.com/citation-style-language/styles">CSL style repository</a> (but leaving off the <code>.csl</code> ending). Tip from the CSL maintainers:</p>
<blockquote class="blockquote">
<p>To quickly search the styles in the GitHub <a href="https://github.com/citation-style-language/styles">CSL style repository</a> by file name, press “t” to activate GitHub’s <a href="https://github.com/blog/793-introducing-the-file-finder">File Finder</a> and start typing.</p>
</blockquote>
<p>Note however that the <code>csl-styles</code> Gem package used by jekyll-scholar <strong>lags behind the official CSL style repository</strong>, so some names you choose may not work. In that case, you can supply a CSL file yourself. For this demo, I found the file <code>physical-review-d.csl</code>, added it to my main blog directory, and then specified the style name <code>physical-review-d</code> in <code>_config.yml</code>. This produced the bracketed-number citation markers above, and the reference format you see below in the References section. (EDIT: Actually I customized the CSL file a bit after that, so my new file is <code>custom.csl</code>.)</p></li>
</ol>
<p>The convenience of this BibTeX/jekyll-scholar approach is that instead of having to manually edit references on each individual page – say, if you wanted to change citation formats (or alternatively, update information about a paper cited in multiple posts) – now you only change <strong>one line</strong> in <code>_config.yml</code> (or update one spot in <code>references.bib</code>) and the system “builds out” the change “everywhere.”</p>
<p>Happy blogging!</p>
</section>
<section id="references" class="level1">
<h1>References</h1>


</section>

 ]]></description>
  <guid>https://drscotthawley.github.io/blog/posts/2020-07-01-Citations-Via-Bibtex.html</guid>
  <pubDate>Wed, 01 Jul 2020 05:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/book_image_smaller.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Mac =&gt; Linux Switch Notes</title>
  <link>https://drscotthawley.github.io/blog/posts/2020-01-13-Mac-Linux-Switch-Notes.html</link>
  <description><![CDATA[ 




<p><em>Mac and I aren’t breaking up, we’re just seeing other people.</em></p>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>I’d been jonesing for a laptop with a real GPU for a couple years. Granted, most of my computation occurs on remote servers, but sometimes when I’m traveling, those connections can be spotty. And heck, I might want to play the occasional video game (without NVIDIA GeForce NOW).</p>
<p>Twenty years ago, I switched from Linux/Windows dual-boot to Mac so I could get shiny apps, and to not have to worry about device drivers, etc. But with Apple dragging their feet re. hardware upgrades, I finally took the plunge – <em>before</em> my Mac died, so I’d have plenty of time to transition.</p>
<p>Got a <a href="https://system76.com/laptops/oryx">System76 Oryx Pro</a>. With Pop!_OS 19.10 — I’m used to Ubuntu, so this is a bit new. I’m so impressed with the System76 folks that I want to try to stay with their Pop!_OS because I know they’ve been doing the tweaking so it’ll work well with their laptops, and also so I can legit bug them when I hit problems. ;-) Like Ubuntu, Pop!_OS is a Debian variant, so much of the same actions apply.</p>
<p>Similar posts by others:</p>
<ul>
<li>https://www.theportlandcompany.com/2017/08/14/switching-mac-ubuntu-gnome-17-04/</li>
<li>http://www.matthewbuscemi.com/blog/2019-06-05-the-great-linux-migration-of-2019.html</li>
</ul>
</section>
<section id="syncing-with-apple-ecosystem" class="level2">
<h2 class="anchored" data-anchor-id="syncing-with-apple-ecosystem">Syncing with Apple Ecosystem</h2>
<p><em>(from within Linux. See below for alleged VirtualBox installation of MacOS)</em></p>
<p>I still have an iPad &amp; iPhone, so finding a solution that could sync with what I already have (rather than, e.g., going with Google Calendars) was helpful.</p>
<p>One could simply use iCloud.com via a web browser, but I'd like to integrate a bit more with the Linux ecosystem.</p>
<ul>
<li><p><strong>Mail:</strong></p>
<p>I tried Geary, Thunderbird &amp; Evolution. Found more online instructions for using Evolution. Evolution doesn’t to do like Mac’s Mail.app does, namely integrate all your inboxes into one unified Inbox – you have to go an check each inbox for each account. <a href="https://www.svenbit.com/2011/05/create-a-unified-inbox-folder-in-evolution/">But here’s a workaround to fake it</a>. (Thunderbird supports a <a href="https://support.mozilla.org/en-US/questions/1009047">nice unified inbox</a> view. Note that Thunderbird’s font size is minuscule, but <a href="https://support.mozilla.org/en-US/questions/1276127">you can rescale it</a>.)</p>
<p>My account types: Gmail and Microsoft Exchange.</p></li>
<li><p><strong>Calendar:</strong></p>
<p>Evolution will integrate with Apple: https://ar.al/2018/08/05/using-icloud-calendars-on-gnu-linux/</p>
<p>Note that accounts added in Evolution will propagate to default Gnome Calendar app too, but there’s no way to get Gnome to add new Apple calendars; only Evolution provides this functionality, it seems.</p></li>
<li><p><strong>Contacts:</strong></p>
<p>Evolution again: https://ar.al/2018/08/05/getting-your-icloud-contacts-on-gnu-linux/</p>
<p>Sadly, unlike the Mac, when you try to <em>use</em> the contacts, for example when you start addressing an email, it won’t prioritize the search/matching list by the most recent people you’ve actually contacted. Rather the names of people you haven’t interacted with in years will dominate the list of names.</p></li>
<li><p><strong>Notes (wrapper to web app):</strong></p>
<p>iCloud Notes Snap: https://www.addictivetips.com/ubuntu-linux-tips/use-icloud-on-linux/</p>
<p>All this thing is is a web browser that connects to Apple's iCloud notes page. So no using this offline. Note that you have to log out &amp; back in before you see Snap apps. <strong>Also note</strong> that Hide/Minimize on this window will make it <em>almost impossible to recover</em>. (??) Thus I tend to move the window to another desktop.</p></li>
<li><p><strong>Messages (SMS)</strong></p>
<p>TL/DR: It’s a no-go.</p>
<p>There is no iCloud version of Messages. Apple won't allow 3rd party apps.</p>
<p><a href="https://wiki.gnome.org/Attic/PhoneManager">Gnome Phone Manager</a> was supposed to let you pair with your phone via Bluetooth and then send &amp; receive messages, but it’s obsolete now and I couldn’t get it to work.</p>
<p>KDE has a "Connect" app, but I'm not abandoning all the Gnome setup I’ve done to switch to KDE! And it probably only works with Android.</p>
<p><a href="https://wammu.eu/">Wammu</a> is unable to connect to my (Bluetooth-paired) phone.</p>
<p>You could configure your old Mac as a remote Messages server, but this implementation is insecure: https://github.com/cvincent/umessage</p>
<p>Verizon doesn't offer a Linux version of their Message+ app, but you can send/receive via their web site.</p>
<p>…One could always use some alternate messaging ‘ecosystem’ like <a href="https://web.whatsapp.com/">WhatsApp’s web app</a> or Signal, but I was looking for ways to get ‘regular’ SMS messages for my existing number. :-/</p></li>
<li><p><strong>Files</strong>:</p>
<p>Honestly Dropbox is fine! I turned on ssh ‘sharing’ on my Mac so I can <code>scp</code> files if I need to, but Dropbox on Linux is as easy as one would imagine.</p></li>
<li><p><strong>Music</strong>:</p>
<p>For actual audio production, I’ll need to keep the Mac around for Logic &amp; Pro Tools. As far as casual listening to music,…eh. I’m fine with Pandora. (I’m not a Spotify user.) <strong>Note:</strong> Did get <a href="https://twitter.com/drscotthawley/status/1214424186464194560">studio audio working under Linux</a> though! See below under “Audio”.</p></li>
<li><p><strong>Backups:</strong></p>
<p>I have an Apple “Time Capsule” WiFi-cum-backup server. <a href="https://apple.stackexchange.com/questions/160250/backup-of-a-debian-machine-to-an-apple-time-capsule">It’s not going to be possible to back up <em>both</em> the Mac and the Linux machine to the same device</a>. I’ll need to choose which machine to back up there. Some have suggested getting a Raspberry Pi and mount a $30 2TB HD to it for backing up the Linux machine. <strong>TODO.</strong></p></li>
</ul>
</section>
<section id="cuda-tensorflow-pytorch" class="level2">
<h2 class="anchored" data-anchor-id="cuda-tensorflow-pytorch">CUDA / Tensorflow / PyTorch</h2>
<p>TL/DR: this was the grand hope of buying this computer. Still not able to run yet, but I’ll never give up. ;-)</p>
<p>This main challenge, as with any system really, is grabbing a version of CUDA that will allow you to grab at least a few binaries:</p>
<ul>
<li><p>Latest CUDA via <a href="https://support.system76.com/articles/cuda/">system76's distro</a> is 10.2. They don’t offer 10.1 anymore.</p></li>
<li><p>PyTorch builds only support up to 10.1. To get CUDA 10.2 support, I built PyTorch from source. My research code isn’t running…I suspect because something in PyTorch changed re. multiprocessing support. :-(.</p></li>
<li><p>System76 made a "<a href="https://github.com/pop-os/tensorman">tensorman</a>" docker util. I confess to my shame that I still find docker to be rather confusing. Using tensorman, I was able to run their tiny demo but not my own research codes. I tried building my own docker image but….didn't enjoy it. Went back to what I know: Anaconda. Still no success. TODO: Will update.</p></li>
<li><p>Tensorflow binaries go up to CUDA 10.0. I'd built tensorflow-gpu from source multiple times on Ubuntu systems...but I spent 3 days on this thing and still haven't gotten it to build. Some kind of error with grpc at gettid. :-/ <strong>OOoo! Got it!</strong> Uh, at least, it compiles.</p></li>
</ul>
</section>
<section id="document-editing" class="level2">
<h2 class="anchored" data-anchor-id="document-editing">Document Editing</h2>
<ul>
<li><p><strong>Markdown</strong>: Over the years, I’ve tried a number of Markdown editors – Haroopad, Mou, Ghost, StackEdit. Then today I discovered <a href="https://typora.io">Typora</a>. It is my favorite by far!</p></li>
<li><p><strong>Code:</strong> I like Atom or VSCode for code (same as I did on the Mac).</p></li>
<li><p><strong>Office:</strong> LibreOffice seems, so far, to be able to read &amp; write my Microsoft Office files without mangling them! It’s <em>uglier</em>, but that’s par for the course.</p></li>
<li><p><strong>(Nonfiction) Book authorship:</strong></p>
<ul>
<li>I’d been working on a book using Scrivener 3. Scrivener released a(n unofficial) <a href="https://www.steinberg.net/forums/viewtopic.php?f=157&amp;t=62290&amp;sid=83ae2e7f166857420498e68412dfea4f&amp;start=25">Linux port</a> but it’s old. Linux users now typically either run the Windows or Mac versions however they can. See “MacOS on Linux via VirtualBox”, below. (<strong>Score!</strong> Mac license key successfully-hypothetically accepted in VirtualBox guest OS.)</li>
<li>Alternatives: <a href="https://www.theologeek.ch/manuskript/">Manuskript</a> (cf.&nbsp;novelist <a href="http://matthewbuscemi.com/blog/2019-06-07-hello-manuskript.html">Matthew Buscemi’s notes on switching from Scrivener to Manuskript</a>), or <a href="https://github.com/Sigil-Ebook/Sigil">Sigil</a> for EPUBs, <a href="https://www.scribus.net/">Scribus</a> for print layout,…? …Well and of course LaTeX! ;-)</li>
</ul></li>
</ul>
</section>
<section id="peripherals" class="level2">
<h2 class="anchored" data-anchor-id="peripherals">Peripherals</h2>
<p>One doesn’t hope for much with Linux, but I’ve succeeded with more than I’d hoped for. As follows…</p>
<section id="audio" class="level3">
<h3 class="anchored" data-anchor-id="audio">Audio</h3>
<ul>
<li><p><strong>Bluetooth pairing</strong> to a Bose Soundlink works fine: Ooo, and the volume buttons on the keyboard control the Bluetooth speaker volume!</p></li>
<li><p>My <strong>Focusrite</strong> 2i2 USB box works right away – <em>sort of</em>. The OS recognizes it but then ignores it and just keeps using the laptop defaults regardless of what you set for the System Settings. Yet Audacity will actually use it correctly. ¯\_(ツ)_/¯. Officially, Focusrite claims <a href="https://support.focusrite.com/hc/en-gb/articles/208530735-Is-my-Focusrite-Product-compatible-with-Linux-">no Linux support</a>, but allows that you might get lucky since they are USB class-compliant. <strong>UPDATE:</strong> If you manually set the Sound setting to Internal Speakers and <em>then</em> set it to the Focusrite, then the Focusrite gets used for everything. (Seems that the Plug’n’Play is a bit messed up.)</p></li>
<li><p>My <strong>Steinberg UR44</strong> USB audio interface… was not recognized at first. There’s a <a href="https://www.steinberg.net/forums/viewtopic.php?f=157&amp;t=62290&amp;sid=f9bd688247495effd78eecc481c321a2&amp;start=25">thread from 2014 on the Steinberg forums</a> for setting up both the UR22 and UR44 on Linux. They say you need to flip the switch on the back of the device to “Class Compliant (CC)” mode. Then turn the Steinberg off &amp; on (i.e.&nbsp;unplug the power cable &amp; plug it in) and…voila! It now shows up! <strong><a href="https://twitter.com/drscotthawley/status/1214424186464194560">I have studio-quality audio I/O!!</a></strong></p></li>
</ul>
</section>
<section id="video" class="level3">
<h3 class="anchored" data-anchor-id="video">Video</h3>
<ul>
<li><p><strong>External Displays (HDMI):</strong> One thing that will require getting used to will be the fact that you can only use the HDMI port on the Oryx Pro when the NVIDIA GPU is fully enabled. You can’t use it with the Intel Graphics or Hybrid Graphics. And switching graphics modes requires a reboot. :-/ But after rebooting, it works! Too bad the battery life isn’t so hot with the NVIDIA card, but that’s ok. ;-)</p>
<p>….Uh, and apparently it refuses to route audio through HDMI even though it should. Hmm. Found this out the hard way when teaching a university class to audio engineering students. :-(</p></li>
</ul>
</section>
<section id="apple-wireless-keyboard" class="level3">
<h3 class="anchored" data-anchor-id="apple-wireless-keyboard">Apple Wireless Keyboard</h3>
<ul>
<li><p>The Pop!_OS/Gnome GUI-based Bluetooth pairing method wasn’t working super great, so I started out following <a href="http://freewisdoms.com/apple-wireless-keyboard-on-ubuntu/">these command-line instructions</a> and then switched over to to Pop!_OS GUI once the scan was in progress.</p>
<blockquote class="blockquote">
<p>Currently typing these words on my wireless keyboard, with the laptop in the closet, looking at my external monitor connected via HDMI, listening to external monitor speakers controlled by the Steinberg UR44! :)</p>
</blockquote></li>
</ul>
</section>
</section>
<section id="customization" class="level2">
<h2 class="anchored" data-anchor-id="customization">Customization</h2>
<ul>
<li><p><strong>Gnome:</strong></p>
<ul>
<li>System76 posted a <a href="https://support.system76.com/articles/customize-gnome/">list of handy Gnome extensions</a>.</li>
<li><a href="https://itsfoss.com/gnome-tweak-tool/">Gnome Tweaks</a>, e.g.&nbsp;for adding Minimize/Maximize buttons to the windows! The default Gnome desktop…I do not understand what those developers are thinking, other than “Let’s waste screen real estate.”</li>
</ul></li>
<li><p><strong>Keyboard Colors (on Oryx Pro):</strong> There are a few utilities out there. I went with <a href="https://github.com/davemcphee/oryx-kb-leds">this one</a>. Note that there are only three "zones" of color definable, not controls for each key. Also had to use <code>sudo</code> to enable user writing to appropriate <code>/sys/</code> devices.</p></li>
<li><p><strong>Scrolling:</strong> Unlike the Mac, the trackpad scrolling behavior seems to be app-specific. As I write this, Typora doesn’t offer any inertia – also called “coasting” – whereas a few Gnome apps (except Terminal!) offer near-perfect Mac-like inertia scrolling, whereas Thunderbird, Atom &amp; VSCode offer none. <strong>SOLUTION:</strong> Install the “Synaptics” (legacy) driver:</p>
<p><code>sudo apt install xserver-xorg-input-synaptics</code></p>
<p>…then log out &amp; log back in. Now things are <em>much</em> better; it’s a <strong>pretty buggy</strong> and sometimes the kinetic scrolling won’t kick in, and other times it will. But this is a vast improvement. (Note: I did <em>not</em> uninstall <code>libinput</code> but rather left it in.)</p>
<p><strong>Oh but wait!</strong> On reboot the trackpad was dead! The only solution was to <em>uninstall</em> the synaptics driver :-( and now the trackpad works again.</p></li>
</ul>
</section>
<section id="macos-on-linux-via-virtualbox" class="level2">
<h2 class="anchored" data-anchor-id="macos-on-linux-via-virtualbox">MacOS on Linux via VirtualBox</h2>
<p>(Given Apple’s EULA, the following is purely a hypothetical scenario <em>for discussion purposes only.</em>..)</p>
<p>Sometimes one may simply need a particular Mac app. This <a href="https://en.wikibooks.org/wiki/VirtualBox/Setting_up_a_Virtual_Machine/Mac_OS_X">“semi-automated install script” described on the VirtualBox Wikibooks page</a> is…I am told, hypothetically…awesome! It will – allegedly, mind you – automatically grab the MacOS ISO and set everything up! <em>(Note that the first time that hypothetical-me might have tried this, hypothetical-me may have missed a bunch of the prompts from the script because the VirtualBox window had obscured the Terminal. Don’t be like said hypothetical-me – hypothetically you should follow the script, and just press enter at the appropriate moments.)</em> And it allegedly mostly “just works.”</p>
<p>Also: Catalina won’t work yet; only Mojave for now.</p>
<ul>
<li><p><strong>Main Issues:</strong></p>
<ul>
<li><p><strong>Guest Additions</strong> don’t get set up. For a long time, VirtualBox didn’t have Guest Additions for Mac guests, and then it did, and now the newest VirtualBox (version 6.1) doesn’t. <em>But</em> the above script installs version 6.0.14, and for versions 6.0.12 to 6.0.14 there <em>were</em> Guest Additions for Mac! <a href="https://download.virtualbox.org/virtualbox/6.0.14/VBoxGuestAdditions_6.0.14.iso">Still available for download here</a>. Then <a href="https://stackoverflow.com/questions/41691803/how-to-install-guest-addition-in-mac-os-as-guest-and-windows-machine-as-host">following these instructions</a>, one might download this .iso file from within the macOS guest, then mount it (via the Finder), then double-click on the file <code>VBoxDarwinAdditions.pkg</code> to install them. Doing this will enable shared clipboards and…</p></li>
<li><p><strong>Shared Folders – not.</strong> Once the Guest Additions are up, one may try to create a directory on the Mac client, e.g.&nbsp;<code>mkdir ~/linux</code> as a mount point, and set up a shared folder in Virtual Box that could auto-mount to this location…. and then one can hypothetically waste HOURS AND HOURS and never it get it to work, at which point one may give up and just use Dropbox or some ****. Really I just wanted this for Scrivener, so syncing <code>~/Dropbox/Documents</code> would be sufficient.</p>
<p><em>Alternatively,</em> you could use “File Sharing” to setup a Samba server, but…Not gonna.</p></li>
<li><p><strong>Insanely Slow Execution.</strong> Lots of issues with the Mac guest, one of which is that it’ll only utilize 1 CPU!</p></li>
<li><p><strong>Low Display Resolution</strong> by default. But fixable by changing the EFI resolution, such as by running on the host system the command</p>
<p><code>$ VBoxManage setextradata "macOS" VBoxInternal2/EfiGraphicsResolution 1600x900</code></p></li>
</ul></li>
<li><p>For some reason, iMessages won’t hypothetically login, even though other aspects of iCloud &amp; AppleID link. No errors, just…doesn’t seem to work….so I’m told.</p></li>
<li><p>“Obviously”, hardware-stuff like the Facetime camera probably will never work. Don’t care.</p></li>
</ul>
</section>
<section id="dual-boot---adding-windows" class="level2">
<h2 class="anchored" data-anchor-id="dual-boot---adding-windows">Dual Boot - adding Windows</h2>
<p><em>(Let’s be honest: this is just for playing video games.)</em></p>
<p>The <a href="https://pop.system76.com/docs/dual-booting-windows/">System76 instructions</a> seem to start in the middle of something; pretty confusing. And there’s a <a href="https://pop.system76.com/docs/dual-booting-windows/">second set of System76 instructions</a> with almost the same title. Turns out the former is for adding Pop!_OS to Windows, and the latter is for adding Windows to Pop!_OS. The latter is what I wanted… but… wasn’t able to follow what they did. So….here’s what I did:</p>
<ol type="1">
<li><p>You can’t repartition your hard drive while it’s being used. So create a bootable USB image of either <a href="https://support.system76.com/articles/pop-live-disk/">all of Pop!_OS</a> or else just the <a href="https://gparted.org/liveusb.php">GParted partitioning tool</a>. The Popsicle utility is good for flashing USBs.</p></li>
<li><p>Restart the machine, hold F7, and select the USB from the boot menu. Then you can run GParted. My version looked like the following, where /dev/sda3 is the main partition that started as all Pop!_OS:</p>
<img src="https://drscotthawley.github.io/blog/posts/https:/i.imgur.com/ebIVLhK.png" class="img-fluid" alt="gparted screenshot"></li>
<li><p>All you need to do is resize the big partition to a smaller size. I made mine such that it would free up 120 GB. You don’t need to create a new partition in the newly-unallocated space or format it; Windows will do that.</p></li>
<li><p>Get a legit bootable Windows 10 ISO somehow, e.g.&nbsp;by downloading from Microsoft or (mumble mumble). Mine was super-old which made what follows extra-fun. (I used a second USB stick by the way). At least it still had a valid Activation Key. :-)</p></li>
<li><p>Restart with with Windows ISO USB inserted, hold F7, boot to the Windows installer. In the installer, when choosing a partition, choose the empty space that was leftover after you shrunk (shrank?) your main Linux partition. Install Windows there.</p></li>
<li><p>Windows installs itself at the <em>front</em> of the machine’s <em>rudimentary</em> boot-loading menu (the F7 thing), meaning that, congratulations, your machine now boots to Windows by default, and I haven’t figured out how to change that. Good news is, the Windows install process will require restarting a <em>bunch</em> of times, so at least that will happen automatically (without you having to choose not-Linux over &amp; over).</p></li>
<li><p>When Windows finally came up, it couldn’t detect the WiFI device on the laptop! That was a bit scary, and made it rather challenging to download any sort of updates. Thankfully the Ethernet jack worked, and so I was able to download enough updates so that eventually (after many incremental update-installs and reboot cycles) the WiFi device started working.</p></li>
<li><p>Managed to install everything I wanted, included Steam and Uplay. Got “Rise of the Tomb Raider” for $12 and played it on max settings at 80 to 100 FPS with no trouble. :-) (Well, note that the machine gets super-hot and the fan runs like crazy, but what do you expect?)</p></li>
<li><p>Now, every time I want to boot to Linux, I have to remember to hold F7. …Oh well.</p></li>
</ol>
</section>
<section id="trouble" class="level2">
<h2 class="anchored" data-anchor-id="trouble">Trouble!</h2>
<p>When I came back to Linux from Windows, the system started hanging intermittently. I though maybe it was limited to the trackpad but it seems there are <a href="https://askubuntu.com/questions/1185491/ubuntu-19-10-freezes-and-lags-reguarly">many reports of freezing with Ubuntu 19.10</a> (which Pop!_OS inherits from) for certain video drivers, and in fact I was in “full NVIDIA mode” when I came back to Linux from Windows. Tonight I’ve been typing the rest of this in Hybrid Graphics mode with not a single hang. So…maybe that’s all I can hope for for now.</p>
<p>I’ll get by.</p>
<p>….How about we stop there for now. I’ll post another edit of this once PyTorch &amp; Tensorflow are working to my satisfaction.</p>
<p><strong>P.S.-</strong> Oh hey. I was going to end that last line with a fingers-crossed emoji, only to find out that <a href="https://www.omgubuntu.co.uk/2014/11/see-install-use-emoji-symbols-ubuntu-linux">Ubuntu and most Linux distributions don’t supoort emoji</a> by default, but there is a <a href="https://wiki.gnome.org/Design/Apps/CharacterMap">Gnome Characters</a> package, which after installing, will let you do this: 🤞😃👍</p>
<hr>
<p>-SH, 1/13/2020.</p>


</section>

 ]]></description>
  <category>computer_usage</category>
  <guid>https://drscotthawley.github.io/blog/posts/2020-01-13-Mac-Linux-Switch-Notes.html</guid>
  <pubDate>Mon, 13 Jan 2020 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/gparted.png" medium="image" type="image/png" height="100" width="144"/>
</item>
<item>
  <title>Principal Component Analysis (PCA) from Scratch</title>
  <link>https://drscotthawley.github.io/blog/posts/2019-12-21-pca-from-scratch.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/i.imgur.com/vKiH8As.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">splash pic i made</figcaption>
</figure>
</div>
<section id="relevance" class="level3">
<h3 class="anchored" data-anchor-id="relevance">Relevance</h3>
<p>Principal Component Analysis (PCA) is a data-reduction technique that finds application in a wide variety of fields, including biology, sociology, physics, medicine, and audio processing. PCA may be used as a “front end” processing step that feeds into additional layers of machine learning, or it may be used by itself, for example when doing data visualization. It is so useful and ubiquitious that is is worth learning not only what it is for and what it is, but how to actually <em>do</em> it.</p>
<p>In this interactive worksheet, we work through how to perform PCA on a few different datasets, writing our own code as we go.</p>
</section>
<section id="other-better-treatments" class="level3">
<h3 class="anchored" data-anchor-id="other-better-treatments">Other (better?) treatments</h3>
<p>My treatment here was written several months after viewing… - the <a href="http://setosa.io/ev/principal-component-analysis/">excellent demo page at setosa.io</a> - this quick <a href="https://www.youtube.com/watch?v=BfTMmoDFXyE">1m30s video of a teapot</a>, - this <a href="https://www.youtube.com/watch?v=FgakZw6K1QQ">great StatsQuest video</a> - this <a href="https://www.youtube.com/watch?v=rng04VJxUt4">lecture from Andrew Ng’s course</a></p>
</section>
<section id="basic-idea" class="level2">
<h2 class="anchored" data-anchor-id="basic-idea">Basic Idea</h2>
<p>Put simply, PCA involves making a coordinate transformation (i.e., a rotation) from the arbitrary axes (or “features”) you started with to a set of axes ‘aligned with the data itself,’ and doing this almost always means that you can get rid of a few of these ‘components’ of data that have small variance without suffering much in the way of accurcy while saving yourself a <em>ton</em> of computation.</p>
<p><small>Once you “get it,” you’ll find PCA to be almost no big deal, if it weren’t for the fact that it’s so darn useful!</small></p>
<p>We’ll define the following terms as we go, but here’s the process in a nutshell: 1. Covariance: Find the <em>covariance matrix</em> for your dataset 2. Eigenvectors: Find the <em>eigenvectors</em> of that matrix (these are the “components” btw) 3. Ordering: Sort the eigenvectors/‘dimensions’ from biggest to smallest variance 4. Projection / Data reduction: Use the eigenvectors corresponding to the largest variance to project the dataset into a reduced- dimensional space 6. (Check: How much did we lose by that truncation?)</p>
</section>
<section id="caveats" class="level1">
<h1>Caveats</h1>
<p>Since PCA will involve making linear transformations, there are some situations where PCA won’t help but…pretty much it’s handy enough that it’s worth giving it a shot!</p>
</section>
<section id="covariance" class="level1">
<h1>Covariance</h1>
<p>If you’ve got two data dimensions and they vary together, then they are co-variant.</p>
<p><strong>Example:</strong> Two-dimensional data that’s somewhat co-linear:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pio</span>
<span id="cb1-5">pio.renderers.default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotly.offline <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb1-8">init_notebook_mode(connected<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10"></span>
<span id="cb1-11"></span>
<span id="cb1-12">N <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> </span>
<span id="cb1-13">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.normal(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N)</span>
<span id="cb1-14">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(np.random.normal(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N))</span>
<span id="cb1-15"></span>
<span id="cb1-16">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, </span>
<span id="cb1-17">                marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span> )])</span>
<span id="cb1-18">fig.update_layout( xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span id="cb1-19">    yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(scaleanchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,scaleratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb1-20">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="3bdb5c36-5bbc-403d-a398-14ca4fafff99" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3bdb5c36-5bbc-403d-a398-14ca4fafff99")) {                    Plotly.newPlot(                        "3bdb5c36-5bbc-403d-a398-14ca4fafff99",                        [{"marker":{"opacity":0.5,"size":8},"mode":"markers","name":"data","x":[1.2214740721971764,-0.262351905402463,0.23633115127050536,1.0154495092132236,0.2694485934826468,-1.1368479312891389,2.0464631297999087,0.4112142272380193,0.1976131457258491,1.235541822225317,0.9081253149749453,0.09034132258873272,0.08775596191855999,0.4207178463292917,-1.6431336007343758,1.4693111099508014,-1.1118096033422649,0.6936261016767549,-0.5838476060698145,-1.4505218308578844,-1.4517796114237855,0.5746923934158749,-0.6743872098914783,-1.393485532175332,-1.3546554247544296,-0.1812110015983382,0.3544943019702085,1.9206978011404419,-0.24750581511304726,-1.002136981949171,-1.2613043117904796,-1.169916476106986,-0.9931438199720944,-0.7428147472097185,-1.1983381176497587,-0.5663436897505136,-0.13884187557887032,-0.4111641738305355,1.4700298610082319,-0.34340851536337025,-0.3572843315516205,-2.460116803968732,0.25078732412308896,1.731814031990643,-1.1943774849173279,-0.32153846013414644,0.5617415146156319,1.892175398650563,-0.11288354309033531,-0.06694969761357147,-0.4397300570995506,-0.45758826102507577,0.18809369400896453,1.0968225433185166,0.7857186486234096,-1.5348157924636159,-2.213535843700092,-0.28246326008550027,1.1301219768696276,-0.5595828974467897,-0.7876640368616754,1.682232446286685,-0.9373730885217983,-0.5038993135222677,-2.0988806143032486,0.9430151393141994,1.7710049056634387,-0.9279569392920959,-0.9895496272652479,-0.7393814381347807,-2.721169579174817,0.48609685513140993,0.3949448218813944,0.6567877590178082,0.2749872696793256,-0.7588857299556473,-2.408105674886543,-1.74930889027474,-2.101637661745484,0.3087539672612252,0.5968440297118323,2.446932103827735,-1.2824827444174116,-1.8591482683757319,1.1520353783527295,1.8327681221997199,1.1519050716205994,-1.3194327084409294,0.08670838441956133,-1.5988542010719546,1.256606797321212,1.2608325988879392,1.4897485189316475,1.0983888222086322,0.5118688694221056,-0.4481819040246332,-0.9268023057221961,2.2852296939400136,-0.012590582965170845,-0.4102143502181873],"y":[0.7908230355674897,-0.30572599937529377,0.24853800282522975,0.43612615675745453,0.009681145106891748,-0.7295945364250151,0.8980702008580311,0.438048071827967,-0.0642062103362864,0.7959274466964424,0.19313561981266286,0.38671782594960924,-0.17528228574916932,0.005736527924502716,-1.0782709010869895,0.9054899061283701,-0.8833499774126277,0.41330188582423105,-0.031431660727717414,-0.8547902977553501,-0.7451715324553764,0.2704280316926488,0.05799714626975322,-0.5979941947983194,-0.6174529439940697,0.10911709645889009,0.44669329857163675,1.0737027849684435,-0.3517995729312752,-0.40606665021679256,-0.4304344619228515,-0.369456089071298,-0.3818774430299863,-0.38751100777056147,-0.3081739884306813,-0.21181486676068018,0.01067322239431294,-0.06259480326733591,0.8481556715600059,0.2374695718078053,-0.1587611154863185,-1.3063405858651511,0.2886385864588253,0.5819756853709659,-0.5841312227248698,-0.1102444823017234,0.39491579162969126,0.48067205980535976,-0.12437963486407289,-0.18328089695487126,-0.5742957657860729,-0.8545809764922241,0.148962601846519,0.7265653597493453,0.5207058350253286,-0.7512145640204221,-0.8034153236637016,-0.1809044564125489,1.10255280347134,-0.4153999535529673,-0.7357173592408807,0.8053686208193916,-0.47836403365976765,-0.32468254500025956,-0.48935719410226863,0.4411357900628094,0.6710544675305129,-0.2544283272291655,-0.3417457541531168,-0.10861626469011088,-1.4697592607906975,0.08158441910862399,0.221409322400645,0.5697635774031435,0.009239247514519044,-0.00495878721502252,-1.03342884687371,-0.9767909480013531,-1.1967574349510417,0.06928440964951878,0.09426621402853091,1.1730258565109022,-0.42076097857604905,-0.7104458969602576,0.37936953541534646,0.7961539020606831,0.20135900619110297,-0.7779468333981943,0.18843477573245887,-1.442349282430461,0.7830815922922162,0.9773054483039401,0.736731171402257,1.1157967140931602,0.4792130969200423,-0.32775296155070976,-0.5071994837707813,1.263332271574214,0.5220742463484108,-0.28551002817349597],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"y"},"scaleanchor":"x","scaleratio":1},"xaxis":{"title":{"text":"x"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3bdb5c36-5bbc-403d-a398-14ca4fafff99');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<section id="variance" class="level3">
<h3 class="anchored" data-anchor-id="variance">Variance</h3>
<p>So, for just the <img src="https://latex.codecogs.com/png.latex?x"> component of the above data, there’s some <em>mean</em> value (which in this case is zero), and there’s some <em>variance</em> about this mean: technically <strong>the variance is the average of the squared differences from the mean.</strong> If you’re familiar with the standard deviation, usually denoted by <img src="https://latex.codecogs.com/png.latex?%5Csigma">, the variance is just the square of the standard deviation. If <img src="https://latex.codecogs.com/png.latex?x"> had units of meters, the variance <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> would have units of meters^2.</p>
<p>Think of the variance as the “spread,” or “extent” of the data, about some particular axis (or input, or “feature”).</p>
<p>Similarly we can look at the variance in just the <img src="https://latex.codecogs.com/png.latex?y"> component of the data. For the above data, the variances in <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?y"> are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance in x ="</span>,np.var(x))</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variance in y ="</span>,np.var(y))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance in x = 1.3787878226116232
Variance in y = 0.39082752915445373</code></pre>
</div>
</div>
</section>
<section id="covariance-1" class="level3">
<h3 class="anchored" data-anchor-id="covariance-1">Covariance</h3>
<p>You’ll notice in the above graph that as <img src="https://latex.codecogs.com/png.latex?x"> varies, so does <img src="https://latex.codecogs.com/png.latex?y"> – pretty much. So <img src="https://latex.codecogs.com/png.latex?y"> is “<em>covariant</em>” with <img src="https://latex.codecogs.com/png.latex?x">. <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.cov.html">“Covariance indicates the level to which two variables vary together.”</a> To compute it, it’s kind of like the regular variance, except that instead of squaring the deviation from the mean for one variable, we multiply the deviations for the two variables:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B%5Crm%20Cov%7D(x,y)%20=%20%7B1%5Cover%20N-1%7D%5Csum_%7Bj=1%7D%5EN%20(x_j-%5Cmu_x)(y_j-%5Cmu_j),"> where <img src="https://latex.codecogs.com/png.latex?%5Cmu_x"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu_y"> are the means for the x- and y- componenets of the data, respectively. Note that you can reverse <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?y"> and get the same result, and the covariance of a variable with itself is just the regular variance – but with one caveat!</p>
<p>The caveat is that we’re dividing by <img src="https://latex.codecogs.com/png.latex?N-1"> instead of <img src="https://latex.codecogs.com/png.latex?N">, so unlike the regular variance we’re not quite taking the mean. Why this? Well, for large datasets this makes essentially no difference, but for small numbers of data points, using <img src="https://latex.codecogs.com/png.latex?N"> can give values that tend to be a bit too small for most people’s tastes, so the <img src="https://latex.codecogs.com/png.latex?N-1"> was introduced to “reduce small sample bias.”</p>
<p>In Python code, the covariance calculation looks like</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> covariance(a,b):</span>
<span id="cb4-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ( (a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a.mean())<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b.mean()) ).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(a)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of x &amp; y ="</span>,covariance(x,y))</span>
<span id="cb4-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of y &amp; x ="</span>,covariance(x,y))</span>
<span id="cb4-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of x with itself ="</span>,covariance(x,x),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", variance of x ="</span>,np.var(x))</span>
<span id="cb4-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Covariance of y with itself ="</span>,covariance(y,y),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", variance of x ="</span>,np.var(y))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance of x &amp; y = 0.6883243158931873
Covariance of y &amp; x = 0.6883243158931873
Covariance of x with itself = 1.3927149723349728 , variance of x = 1.3787878226116232
Covariance of y with itself = 0.3947752819741957 , variance of x = 0.39082752915445373</code></pre>
</div>
</div>
</section>
<section id="covariance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="covariance-matrix">Covariance matrix</h2>
<p>So what we do is we take the covariance of every variable with every variable (including itself) and make a matrix out of it. Along the diagonal will be the variance of each variable (except for that <img src="https://latex.codecogs.com/png.latex?N-1"> in the denominator), and the rest of the matrix will be the covariances. Note that since the order of the variables doesn’t matter when computing covariance, the matrix will be <em>symmetric</em> (i.e.&nbsp;it will equal its own transpose, i.e.&nbsp;will have a reflection symmetry across the diagonal) and thus will be a <em>square</em> matrix.</p>
<p>Numpy gives us a handy thing to call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.stack((x,y),axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pack the x &amp; y data together in one 2D array</span></span>
<span id="cb6-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.shape ="</span>,data.shape)</span>
<span id="cb6-3">cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cov(data.T)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .T b/c numpy wants varibles along rows rather than down columns?</span></span>
<span id="cb6-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"covariance matrix =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,cov)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data.shape = (100, 2)
covariance matrix =
 [[1.39271497 0.68832432]
 [0.68832432 0.39477528]]</code></pre>
</div>
</div>
</section>
</section>
<section id="some-3d-data-to-work-with" class="level1">
<h1>Some 3D data to work with</h1>
<p>Now that we know what a covariance matrix is, let’s generate some 3D data that we can use for what’s coming next. Since there are 3 variables or 3 dimensions, the covariance matrix will now be 3x3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.uniform(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N)</span>
<span id="cb8-2">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.stack((x,y,z)).T</span>
<span id="cb8-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.shape ="</span>,data.shape)</span>
<span id="cb8-4">cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cov(data.T)</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"covariance matrix =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,cov)</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot our data</span></span>
<span id="cb8-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotly.graph_objects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> go</span>
<span id="cb8-9">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z,mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span> )])</span>
<span id="cb8-10">fig.update_layout( xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(scaleanchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,scaleratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb8-11">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data.shape = (100, 3)
covariance matrix =
 [[ 1.39271497  0.68832432 -0.75976119]
 [ 0.68832432  0.39477528 -0.39059862]
 [-0.75976119 -0.39059862  0.74872195]]</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="709e01e1-4812-4380-bef5-15f5ebf2faad" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("709e01e1-4812-4380-bef5-15f5ebf2faad")) {                    Plotly.newPlot(                        "709e01e1-4812-4380-bef5-15f5ebf2faad",                        [{"marker":{"opacity":0.5,"size":8},"mode":"markers","name":"data","x":[1.2214740721971764,-0.262351905402463,0.23633115127050536,1.0154495092132236,0.2694485934826468,-1.1368479312891389,2.0464631297999087,0.4112142272380193,0.1976131457258491,1.235541822225317,0.9081253149749453,0.09034132258873272,0.08775596191855999,0.4207178463292917,-1.6431336007343758,1.4693111099508014,-1.1118096033422649,0.6936261016767549,-0.5838476060698145,-1.4505218308578844,-1.4517796114237855,0.5746923934158749,-0.6743872098914783,-1.393485532175332,-1.3546554247544296,-0.1812110015983382,0.3544943019702085,1.9206978011404419,-0.24750581511304726,-1.002136981949171,-1.2613043117904796,-1.169916476106986,-0.9931438199720944,-0.7428147472097185,-1.1983381176497587,-0.5663436897505136,-0.13884187557887032,-0.4111641738305355,1.4700298610082319,-0.34340851536337025,-0.3572843315516205,-2.460116803968732,0.25078732412308896,1.731814031990643,-1.1943774849173279,-0.32153846013414644,0.5617415146156319,1.892175398650563,-0.11288354309033531,-0.06694969761357147,-0.4397300570995506,-0.45758826102507577,0.18809369400896453,1.0968225433185166,0.7857186486234096,-1.5348157924636159,-2.213535843700092,-0.28246326008550027,1.1301219768696276,-0.5595828974467897,-0.7876640368616754,1.682232446286685,-0.9373730885217983,-0.5038993135222677,-2.0988806143032486,0.9430151393141994,1.7710049056634387,-0.9279569392920959,-0.9895496272652479,-0.7393814381347807,-2.721169579174817,0.48609685513140993,0.3949448218813944,0.6567877590178082,0.2749872696793256,-0.7588857299556473,-2.408105674886543,-1.74930889027474,-2.101637661745484,0.3087539672612252,0.5968440297118323,2.446932103827735,-1.2824827444174116,-1.8591482683757319,1.1520353783527295,1.8327681221997199,1.1519050716205994,-1.3194327084409294,0.08670838441956133,-1.5988542010719546,1.256606797321212,1.2608325988879392,1.4897485189316475,1.0983888222086322,0.5118688694221056,-0.4481819040246332,-0.9268023057221961,2.2852296939400136,-0.012590582965170845,-0.4102143502181873],"y":[0.7908230355674897,-0.30572599937529377,0.24853800282522975,0.43612615675745453,0.009681145106891748,-0.7295945364250151,0.8980702008580311,0.438048071827967,-0.0642062103362864,0.7959274466964424,0.19313561981266286,0.38671782594960924,-0.17528228574916932,0.005736527924502716,-1.0782709010869895,0.9054899061283701,-0.8833499774126277,0.41330188582423105,-0.031431660727717414,-0.8547902977553501,-0.7451715324553764,0.2704280316926488,0.05799714626975322,-0.5979941947983194,-0.6174529439940697,0.10911709645889009,0.44669329857163675,1.0737027849684435,-0.3517995729312752,-0.40606665021679256,-0.4304344619228515,-0.369456089071298,-0.3818774430299863,-0.38751100777056147,-0.3081739884306813,-0.21181486676068018,0.01067322239431294,-0.06259480326733591,0.8481556715600059,0.2374695718078053,-0.1587611154863185,-1.3063405858651511,0.2886385864588253,0.5819756853709659,-0.5841312227248698,-0.1102444823017234,0.39491579162969126,0.48067205980535976,-0.12437963486407289,-0.18328089695487126,-0.5742957657860729,-0.8545809764922241,0.148962601846519,0.7265653597493453,0.5207058350253286,-0.7512145640204221,-0.8034153236637016,-0.1809044564125489,1.10255280347134,-0.4153999535529673,-0.7357173592408807,0.8053686208193916,-0.47836403365976765,-0.32468254500025956,-0.48935719410226863,0.4411357900628094,0.6710544675305129,-0.2544283272291655,-0.3417457541531168,-0.10861626469011088,-1.4697592607906975,0.08158441910862399,0.221409322400645,0.5697635774031435,0.009239247514519044,-0.00495878721502252,-1.03342884687371,-0.9767909480013531,-1.1967574349510417,0.06928440964951878,0.09426621402853091,1.1730258565109022,-0.42076097857604905,-0.7104458969602576,0.37936953541534646,0.7961539020606831,0.20135900619110297,-0.7779468333981943,0.18843477573245887,-1.442349282430461,0.7830815922922162,0.9773054483039401,0.736731171402257,1.1157967140931602,0.4792130969200423,-0.32775296155070976,-0.5071994837707813,1.263332271574214,0.5220742463484108,-0.28551002817349597],"z":[-0.026115464509558706,1.9104810505538206,1.0421443357217821,0.7188574582859563,1.6976821178062487,2.4968359389432004,-0.7199497172777474,1.299603132979989,1.3772896684949325,0.6967760518119067,0.3254757937317607,0.5571813934910945,1.9526013257015886,0.2366227942903805,0.9173386297492114,-0.6783247925113812,1.2390689069599716,0.6107735181189998,1.940018852441848,1.2333261001160833,1.9141507784261942,1.153252833796296,0.6585595762790333,2.0115303921410295,1.8131264723438556,0.8215109423918696,0.28262597649821253,0.7018983970928626,1.3092410766928841,2.278754932827861,2.467334806669397,1.720725867846492,2.019295439000692,1.3336384357087978,2.5750662133893454,1.1134897735971547,0.8310526011384304,1.8308710547269833,0.3505059418686146,1.2285845361957914,1.1106718474571202,2.2843914958558122,0.18834533301353437,0.3850325087966686,2.117411542835332,1.1486413946993563,-0.18046511779456975,0.5889700876786484,1.9131812031786573,0.1244298252479734,1.8745385195309985,2.1252702186469774,0.6801150352856388,1.357774955889644,1.5725609286986444,2.4718413892932447,1.816166235713498,0.19037734506613951,0.5049663933855072,0.748454986121432,1.8054730057460608,-0.7458350897763233,0.8867523433317759,1.242116253417567,1.4471041938173308,-0.23751718139435007,0.9677226899191632,1.275783737299712,0.6082178681119041,0.5228105959405334,2.2468917067292358,-0.05346850762653729,0.039828859567577896,1.20977115558495,0.13967589401252636,0.6064807375329213,2.858565395807668,1.779731213590917,2.6437960644973413,1.0699031687801073,0.6260329335812217,0.571938292336813,2.4875756226763093,2.3371824559814502,0.5309053347662401,-0.8932518631355097,0.8941572125074952,1.9726300535394157,1.4813515496144056,2.037055463944263,1.029486922567446,0.35313376482079917,-0.11810833322778702,0.7484193382038524,1.1213000218551346,1.203117377478851,1.8809620652969548,-1.1357259324058029,1.0148007256703158,1.511165548116362],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"y"},"scaleanchor":"x","scaleratio":1},"xaxis":{"title":{"text":"x"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('709e01e1-4812-4380-bef5-15f5ebf2faad');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>(Note that even though our <img src="https://latex.codecogs.com/png.latex?z"> data didn’t explicitly depend on <img src="https://latex.codecogs.com/png.latex?y">, the fact that <img src="https://latex.codecogs.com/png.latex?y"> is covariant with <img src="https://latex.codecogs.com/png.latex?x"> means that <img src="https://latex.codecogs.com/png.latex?y"> and <img src="https://latex.codecogs.com/png.latex?z"> ‘coincidentally’ have a nonzero covariance. This sort of thing shows up in many datasets where two variables are correlated and may give rise to ‘confounding’ factors.)</p>
<p>So now we have a covariance matrix. The next thing in PCA is find the ‘principal components’. This means the directions along which the data varies the most. You can kind of estimate these by rotating the 3D graph above. See also <a href="https://www.youtube.com/watch?v=BfTMmoDFXyE">this great YouTube video of a teapot</a> (1min 30s) that explains PCA in this manner.</p>
<p>To do Principal Component Analysis, we need to find the aforementioned “components,” and this requires finding <em>eigenvectors</em> for our dataset’s covariance matrix.</p>
</section>
<section id="what-is-an-eigenvector-really" class="level1">
<h1>What is an eigenvector, <em>really</em>?</h1>
<p>First a <strong>definition</strong>. (Stay with me! We’ll flesh this out in what comes after this.)</p>
<p>Given some matrix (or ‘linear operator’) <img src="https://latex.codecogs.com/png.latex?%7B%5Cbf%20A%7D"> with dimensions <img src="https://latex.codecogs.com/png.latex?n%5Ctimes%20n"> (i.e., <img src="https://latex.codecogs.com/png.latex?n"> rows and <img src="https://latex.codecogs.com/png.latex?n"> columns), there exist a set of <img src="https://latex.codecogs.com/png.latex?n"> vectors <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bv%7D_i"> (each with dimension <img src="https://latex.codecogs.com/png.latex?n">, and <img src="https://latex.codecogs.com/png.latex?i%20=%201...n"> counts which vector we’re talking about) <strong>such that</strong> multiplying one of these vectors by <img src="https://latex.codecogs.com/png.latex?%7B%5Cbf%20A%7D"> results in a vector (anti)parallel to <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bv%7D_i">, with a length that’s multiplied by some constant <img src="https://latex.codecogs.com/png.latex?%5Clambda_i">. In equation form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B%5Cbf%20A%7D%5Cvec%7Bv%7D_i%20=%20%5Clambda_i%20%5Cvec%7Bv%7D_i,%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20(1)"></p>
<p>where the constants <img src="https://latex.codecogs.com/png.latex?%5Clambda_i"> are called <em>eigenvalues</em> and the vectors <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bv%7D_i"> are called <em>eigenvectors</em>.</p>
<p><span style="text-align:right; font-style:italic; font-size:70%;">(Note that I’m departing a bit from common notation that uses <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bx%7D_i"> instead of <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bv%7D_i">; I don’t want people to get confused when I want to use <img src="https://latex.codecogs.com/png.latex?x">’s for coordinate variables.)</span></p>
<p>A graphical version of this is shown in Figure 1:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://drscotthawley.github.io/blog/posts/https:/i.imgur.com/rUcGpVn.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">picture of eigenvectors</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>Figure 1. “An eigenvector is a vector that a linear operator sends to a multiple of itself” – <a href="https://www.quora.com/What-does-Eigen-mean/answer/Daniel-McLaury">Daniel McLaury</a></p>
</blockquote>
<section id="brief-q-a-before-we-go-on" class="level3">
<h3 class="anchored" data-anchor-id="brief-q-a-before-we-go-on">Brief Q &amp; A before we go on:</h3>
<ol type="1">
<li>“So what’s with the ‘eigen’ part?” That’s a German prefix, which in this context means “inherent” or “own”.</li>
<li>“Can a non-square matrix have eigenvectors?” Well,…no, and think of it this way: If <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BA%7D"> were an <img src="https://latex.codecogs.com/png.latex?n%5Ctimes%20m"> matrix (where <img src="https://latex.codecogs.com/png.latex?m%20%3C%3E%20n">), then it would be mapping from <img src="https://latex.codecogs.com/png.latex?n"> dimensions into <img src="https://latex.codecogs.com/png.latex?m"> dimensions, but on the “other side” of the equation with the <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%5Cvec%7Bv%7D_i">, <em>that</em> would still have <img src="https://latex.codecogs.com/png.latex?n"> dimensions, so… you’d be saying an <img src="https://latex.codecogs.com/png.latex?n">-dimensional object equals an <img src="https://latex.codecogs.com/png.latex?m">-dimensional object, which is a no-go.</li>
<li>“But my dataset has many more rows than columns, so what am I supposed to do about that?” Just wait! It’ll be ok. We’re not actually going to take the eigenvectors of the dataset ‘directly’, we’re going to take the eigenvectors of the <em>covariance matrix</em> of the dataset.</li>
<li>“Are eigenvectors important?” You bet! They get used in many areas of science. I first encountered them in quantum mechanics.* They describe the “principal vectors” of many objects, or “normal modes” of oscillating systems. They get used in <a href="https://www.visiondummy.com/2014/03/eigenvalues-eigenvectors/">computer vision</a>, and… lots of places. You’ll see them almost anywhere matrices &amp; tensors are employed, such as our topic for today: Data science!</li>
</ol>
<p>*<small>Ok that’s not quite true: I first encountered them in an extremely boring Linear Algebra class taught by an extremely boring NASA engineer who thought he wanted to try teaching. But it wasn’t until later that I learned anything about their relevance for…anything. Consquently I didn’t “learn them” very well so writing this is a helpful review for me.</small></p>
</section>
</section>
<section id="how-to-find-the-eigenvectors-of-a-matrix" class="level1">
<h1>How to find the eigenvectors of a matrix</h1>
<p>You call a library routine that does it for you, of course! ;-)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> linalg <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> LA</span>
<span id="cb10-2">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LA.eig(cov)</span>
<span id="cb10-3">lambdas, vs</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([2.23494234, 0.25770373, 0.04356613]),
 array([[-0.77200047, -0.44874891, -0.45015518],
        [-0.39455037, -0.21693649,  0.89289896],
        [ 0.49834253, -0.86692731,  0.00957898]]))</code></pre>
</div>
</div>
<p>Ok sort of kidding; we’ll do it “from scratch”. But, one caveat before we start: Some matrices can be “weird” or “problematic” and have things like “singular values.” There are sophisticated numerical libraries for doing this, and joking aside, for real-world numerical applications you’re better off calling a library routine that other very smart and very careful people have written for you. But for now, we’ll do the straightforward way which works pretty well for many cases. We’ll follow the basic two steps:</p>
<ol type="1">
<li>Find the eigenvalues<br>
</li>
<li>‘Plug in’ each eigenvalue to get a system of linear equations for the values of the components of the corresponding eigenvector</li>
<li>Solve this linear system.</li>
</ol>
<section id="find-the-eigenvalues" class="level2">
<h2 class="anchored" data-anchor-id="find-the-eigenvalues">1. Find the eigenvalues</h2>
<p>Ok I’m hoping you at least can recall what a <a href="https://en.wikipedia.org/wiki/Determinant">determinant</a> of a matrix is. Many people, even if they don’t know what a determinant is good for (e.g.&nbsp;tons of proofs &amp; properties all rest on the determinant), they still at least remember how to calculate one.</p>
<p>The way to get the eigenvalues is to take the determinant of the difference between a <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BA%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Clambda"> times the <em>identity matrix</em> <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BI%7D"> (which is just ones along the diagonal and zeros otherwise) and set that difference equal to zero…</p>
<p><img src="https://latex.codecogs.com/png.latex?det(%20%5Cbf%7BA%7D%20-%20%5Clambda%20I)%20=%200%20"></p>
<blockquote class="blockquote">
<p><small>Just another observation: Since <img src="https://latex.codecogs.com/png.latex?%7B%5Cbf%20I%7D"> is a square matrix, that means <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BA%7D"> has to be a square matrix too.</small></p>
</blockquote>
<p>Then solving for <img src="https://latex.codecogs.com/png.latex?%5Clambda"> will give you a <em>polynomial equation</em> in <img src="https://latex.codecogs.com/png.latex?%5Clambda">, the solutions to (or roots of) which are the eigenvectors <img src="https://latex.codecogs.com/png.latex?%5Clambda_i">.</p>
<p>Let’s do an example:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cbf%20A%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A-2%20&amp;%202%20&amp;%201%5C%5C%0A-5%20&amp;%205%20&amp;%201%5C%5C%0A-4%20&amp;%202%20&amp;%203%0A%5Cend%7Bbmatrix%7D%0A"> To find the eigenvalues we set <img src="https://latex.codecogs.com/png.latex?%0Adet(%20%5Cbf%7BA%7D%20-%20%5Clambda%20I)%20=%0A%5Cbegin%7Bvmatrix%7D%0A-2-%5Clambda%20&amp;%202%20&amp;%201%5C%5C%0A-5%20&amp;%205-%5Clambda%20&amp;%201%5C%5C%0A-4%20&amp;%202%20&amp;%203-%5Clambda%0A%5Cend%7Bvmatrix%7D%20=%200."></p>
<p>This gives us the equation… <img src="https://latex.codecogs.com/png.latex?0%20=%20%5Clambda%5E3%20-%206%5Clambda%5E2%20+%20%5Clambda%20-%206"></p>
<p>which has the 3 solutions (in descending order) <img src="https://latex.codecogs.com/png.latex?%20%5Clambda%20=%203,%202,%201."></p>
<p><small><em>(Aside: to create an integer matrix with integer eigenvalues, I used <a href="https://ericthewry.github.io/integer_matrices/">this handy web tool</a>)</em>.</small></p>
<p>Just to check that against the numpy library:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]])</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sorted_eig(A):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For now we sort 'by convention'. For PCA the sorting is key. </span></span>
<span id="cb12-4">    lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LA.eig(A)</span>
<span id="cb12-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Next line just sorts values &amp; vectors together in order of decreasing eigenvalues</span></span>
<span id="cb12-6">    lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(lambdas), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(vs.T)),key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], reverse<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span>
<span id="cb12-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> lambdas, np.array(vs).T  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># un-doing the list-casting from the previous line</span></span>
<span id="cb12-8"></span>
<span id="cb12-9">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(A)</span>
<span id="cb12-10">lambdas <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hold off on printing out the eigenvectors until we do the next part!</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(3.0000000000000013, 1.999999999999999, 1.0000000000000004)</code></pre>
</div>
</div>
<p>Close enough!</p>
</section>
</section>
<section id="use-the-eigenvalues-to-get-the-eigenvectors" class="level1">
<h1>2. Use the eigenvalues to get the eigenvectors</h1>
<p>Although it was anncounced in mid 2019 that <a href="https://arxiv.org/abs/1908.03795">you can get eigenvectors directly from eigenvalues</a>, the usual way people have done this for a very long time is to go back to the matrix <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BA%7D"> and solve the <em>linear system</em> of equation (1) above, for each of the eigenvalues. For example, for <img src="https://latex.codecogs.com/png.latex?%5Clambda_1=-1">, we have</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cbf%7DA%20%5Cvec%7Bv%7D_1%20=%20-%5Cvec%7Bv%7D_1%0A"> i.e.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A-2%20&amp;%202%20&amp;%201%5C%5C%0A-5%20&amp;%205%20&amp;%201%5C%5C%0A-4%20&amp;%202%20&amp;%203%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0Av_%7B1x%7D%5C%5C%0Av_%7B1y%7D%5C%5C%0Av_%7B1z%7D%5C%5C%0A%5Cend%7Bbmatrix%7D%0A=%0A-%5Cbegin%7Bbmatrix%7D%0Av_%7B1x%7D%5C%5C%0Av_%7B1y%7D%5C%5C%0Av_%7B1z%7D%5C%5C%0A%5Cend%7Bbmatrix%7D%0A"> This amounts to 3 equations for 3 unknowns,…which I’m going to assume you can handle… For the other eigenvalues things proceed similarly. The solutions we get for the 3 eigenvalues are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_1%20=%203:%20%5C%20%5C%20%5C%20%5Cvec%7Bv%7D_1%20=%20(1,2,1)%5ET"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_2%20=%202:%20%5C%20%5C%20%5C%20%5Cvec%7Bv%7D_2%20=%20(1,1,2)%5ET"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_3%20=%201:%20%5C%20%5C%20%5C%20%5Cvec%7Bv%7D_3%20=%20(1,1,1)%5ET"></p>
<p>Since our original equation (1) allows us to scale eigenvectors by any artibrary constant, often we’ll express eigenvectors as <em>unit</em> vectors <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bv%7D_i">. This will amount to dividing by the length of each vector, i.e.&nbsp;in our example multiplying by <img src="https://latex.codecogs.com/png.latex?(1/%5Csqrt%7B6%7D,1/%5Csqrt%7B6%7D,1/%5Csqrt%7B3%7D)">.</p>
<p>In this setting</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_1%20=%203:%20%5C%20%5C%20%5C%20%5Chat%7Bv%7D_1%20=%20(1/%5Csqrt%7B6%7D,2/%5Csqrt%7B6%7D,1/%5Csqrt%7B6%7D)%5ET"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_2%20=%202:%20%5C%20%5C%20%5C%20%5Chat%7Bv%7D_2%20=%20(1/%5Csqrt%7B6%7D,1/%5Csqrt%7B6%7D,2/%5Csqrt%7B6%7D)%5ET"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clambda_3%20=%201:%20%5C%20%5C%20%5C%20%5Chat%7Bv%7D_3%20=%20(1,1,1)%5ET/%5Csqrt%7B3%7D"></p>
<p>Checking our answers (left) with numpy’s answers (right):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ours"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Numpy"</span>)</span>
<span id="cb14-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb14-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb14-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Ours                              Numpy
[0.40824829 0.81649658 0.40824829] [-0.40824829 -0.81649658 -0.40824829]
[0.40824829 0.40824829 0.81649658] [0.40824829 0.40824829 0.81649658]
[0.57735027 0.57735027 0.57735027] [0.57735027 0.57735027 0.57735027]</code></pre>
</div>
</div>
<p>The fact that the first one differs by a multiplicative factor of -1 is not an issue. Remember: eigenvectors can be multiplied by an arbitrary constant. (Kind of odd that numpy doesn’t choose the positive version though!)</p>
<p>One more check: let’s multiply our eigenvectors times A to see what we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A*v_1 / 3 = "</span>,np.matmul(A, np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).T)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dividing by eigenvalue </span></span>
<span id="cb16-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A*v_2 / 2 = "</span>,np.matmul(A, np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]).T)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    to get vector back</span></span>
<span id="cb16-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A*v_3 / 1 = "</span>,np.matmul(A, np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).T) )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A*v_1 / 3 =  [1. 2. 1.]
A*v_2 / 2 =  [1. 1. 2.]
A*v_3 / 1 =  [1 1 1]</code></pre>
</div>
</div>
<p>Great! Let’s move on. Back to our data!</p>
</section>
<section id="eigenvectors-for-our-sample-3d-dataset" class="level1">
<h1>Eigenvectors for our sample 3D dataset</h1>
<p>Recall we named our 3x3 covariance matrix ‘cov’. So now we’ll compute its eigenvectors, and then re-plot our 3D data and also plot the 3 eigenvectors with it…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now that we know we can get the same answers as the numpy library, let's use it</span></span>
<span id="cb18-2">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(cov)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute e'vals and e'vectors of cov matrix </span></span>
<span id="cb18-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambdas, vs =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,lambdas,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,vs)</span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-plot our data</span></span>
<span id="cb18-6">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>z,mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>,  </span>
<span id="cb18-7">        marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span> ) ])</span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Draw some extra 'lines' showing eigenvector directions</span></span>
<span id="cb18-10">n_ev_balls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the lines will be made of lots of balls in a line</span></span>
<span id="cb18-11">ev_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># size of balls</span></span>
<span id="cb18-12">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_ev_balls)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># parameterizer for drawing along vec directions</span></span>
<span id="cb18-13"></span>
<span id="cb18-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do this for each eigenvector </span></span>
<span id="cb18-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uncomment the next line to scale (unit) vector by size of the eigenvalue</span></span>
<span id="cb18-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vs[:,i] *= lambdas[i] </span></span>
<span id="cb18-17">    ex, ey, ez <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>vs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,i], t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>vs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,i],  t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>vs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i]</span>
<span id="cb18-18">    fig.add_trace(go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ex, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ey, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ez,mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>,</span>
<span id="cb18-19">                marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ev_size,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v_"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb18-20"></span>
<span id="cb18-21">fig.update_layout( xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(scaleanchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,scaleratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb18-22">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lambdas, vs =
 (2.2349423420072574, 0.2577037297303398, 0.043566129727355414) 
 [[-0.77200047 -0.44874891 -0.45015518]
 [-0.39455037 -0.21693649  0.89289896]
 [ 0.49834253 -0.86692731  0.00957898]]</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="654d645d-2ee2-430f-8966-9841b27249f5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("654d645d-2ee2-430f-8966-9841b27249f5")) {                    Plotly.newPlot(                        "654d645d-2ee2-430f-8966-9841b27249f5",                        [{"marker":{"opacity":0.5,"size":8},"mode":"markers","name":"data","x":[1.2214740721971764,-0.262351905402463,0.23633115127050536,1.0154495092132236,0.2694485934826468,-1.1368479312891389,2.0464631297999087,0.4112142272380193,0.1976131457258491,1.235541822225317,0.9081253149749453,0.09034132258873272,0.08775596191855999,0.4207178463292917,-1.6431336007343758,1.4693111099508014,-1.1118096033422649,0.6936261016767549,-0.5838476060698145,-1.4505218308578844,-1.4517796114237855,0.5746923934158749,-0.6743872098914783,-1.393485532175332,-1.3546554247544296,-0.1812110015983382,0.3544943019702085,1.9206978011404419,-0.24750581511304726,-1.002136981949171,-1.2613043117904796,-1.169916476106986,-0.9931438199720944,-0.7428147472097185,-1.1983381176497587,-0.5663436897505136,-0.13884187557887032,-0.4111641738305355,1.4700298610082319,-0.34340851536337025,-0.3572843315516205,-2.460116803968732,0.25078732412308896,1.731814031990643,-1.1943774849173279,-0.32153846013414644,0.5617415146156319,1.892175398650563,-0.11288354309033531,-0.06694969761357147,-0.4397300570995506,-0.45758826102507577,0.18809369400896453,1.0968225433185166,0.7857186486234096,-1.5348157924636159,-2.213535843700092,-0.28246326008550027,1.1301219768696276,-0.5595828974467897,-0.7876640368616754,1.682232446286685,-0.9373730885217983,-0.5038993135222677,-2.0988806143032486,0.9430151393141994,1.7710049056634387,-0.9279569392920959,-0.9895496272652479,-0.7393814381347807,-2.721169579174817,0.48609685513140993,0.3949448218813944,0.6567877590178082,0.2749872696793256,-0.7588857299556473,-2.408105674886543,-1.74930889027474,-2.101637661745484,0.3087539672612252,0.5968440297118323,2.446932103827735,-1.2824827444174116,-1.8591482683757319,1.1520353783527295,1.8327681221997199,1.1519050716205994,-1.3194327084409294,0.08670838441956133,-1.5988542010719546,1.256606797321212,1.2608325988879392,1.4897485189316475,1.0983888222086322,0.5118688694221056,-0.4481819040246332,-0.9268023057221961,2.2852296939400136,-0.012590582965170845,-0.4102143502181873],"y":[0.7908230355674897,-0.30572599937529377,0.24853800282522975,0.43612615675745453,0.009681145106891748,-0.7295945364250151,0.8980702008580311,0.438048071827967,-0.0642062103362864,0.7959274466964424,0.19313561981266286,0.38671782594960924,-0.17528228574916932,0.005736527924502716,-1.0782709010869895,0.9054899061283701,-0.8833499774126277,0.41330188582423105,-0.031431660727717414,-0.8547902977553501,-0.7451715324553764,0.2704280316926488,0.05799714626975322,-0.5979941947983194,-0.6174529439940697,0.10911709645889009,0.44669329857163675,1.0737027849684435,-0.3517995729312752,-0.40606665021679256,-0.4304344619228515,-0.369456089071298,-0.3818774430299863,-0.38751100777056147,-0.3081739884306813,-0.21181486676068018,0.01067322239431294,-0.06259480326733591,0.8481556715600059,0.2374695718078053,-0.1587611154863185,-1.3063405858651511,0.2886385864588253,0.5819756853709659,-0.5841312227248698,-0.1102444823017234,0.39491579162969126,0.48067205980535976,-0.12437963486407289,-0.18328089695487126,-0.5742957657860729,-0.8545809764922241,0.148962601846519,0.7265653597493453,0.5207058350253286,-0.7512145640204221,-0.8034153236637016,-0.1809044564125489,1.10255280347134,-0.4153999535529673,-0.7357173592408807,0.8053686208193916,-0.47836403365976765,-0.32468254500025956,-0.48935719410226863,0.4411357900628094,0.6710544675305129,-0.2544283272291655,-0.3417457541531168,-0.10861626469011088,-1.4697592607906975,0.08158441910862399,0.221409322400645,0.5697635774031435,0.009239247514519044,-0.00495878721502252,-1.03342884687371,-0.9767909480013531,-1.1967574349510417,0.06928440964951878,0.09426621402853091,1.1730258565109022,-0.42076097857604905,-0.7104458969602576,0.37936953541534646,0.7961539020606831,0.20135900619110297,-0.7779468333981943,0.18843477573245887,-1.442349282430461,0.7830815922922162,0.9773054483039401,0.736731171402257,1.1157967140931602,0.4792130969200423,-0.32775296155070976,-0.5071994837707813,1.263332271574214,0.5220742463484108,-0.28551002817349597],"z":[-0.026115464509558706,1.9104810505538206,1.0421443357217821,0.7188574582859563,1.6976821178062487,2.4968359389432004,-0.7199497172777474,1.299603132979989,1.3772896684949325,0.6967760518119067,0.3254757937317607,0.5571813934910945,1.9526013257015886,0.2366227942903805,0.9173386297492114,-0.6783247925113812,1.2390689069599716,0.6107735181189998,1.940018852441848,1.2333261001160833,1.9141507784261942,1.153252833796296,0.6585595762790333,2.0115303921410295,1.8131264723438556,0.8215109423918696,0.28262597649821253,0.7018983970928626,1.3092410766928841,2.278754932827861,2.467334806669397,1.720725867846492,2.019295439000692,1.3336384357087978,2.5750662133893454,1.1134897735971547,0.8310526011384304,1.8308710547269833,0.3505059418686146,1.2285845361957914,1.1106718474571202,2.2843914958558122,0.18834533301353437,0.3850325087966686,2.117411542835332,1.1486413946993563,-0.18046511779456975,0.5889700876786484,1.9131812031786573,0.1244298252479734,1.8745385195309985,2.1252702186469774,0.6801150352856388,1.357774955889644,1.5725609286986444,2.4718413892932447,1.816166235713498,0.19037734506613951,0.5049663933855072,0.748454986121432,1.8054730057460608,-0.7458350897763233,0.8867523433317759,1.242116253417567,1.4471041938173308,-0.23751718139435007,0.9677226899191632,1.275783737299712,0.6082178681119041,0.5228105959405334,2.2468917067292358,-0.05346850762653729,0.039828859567577896,1.20977115558495,0.13967589401252636,0.6064807375329213,2.858565395807668,1.779731213590917,2.6437960644973413,1.0699031687801073,0.6260329335812217,0.571938292336813,2.4875756226763093,2.3371824559814502,0.5309053347662401,-0.8932518631355097,0.8941572125074952,1.9726300535394157,1.4813515496144056,2.037055463944263,1.029486922567446,0.35313376482079917,-0.11810833322778702,0.7484193382038524,1.1213000218551346,1.203117377478851,1.8809620652969548,-1.1357259324058029,1.0148007256703158,1.511165548116362],"type":"scatter3d"},{"marker":{"opacity":0.8,"size":3},"mode":"markers","name":"v_1","x":[-0.0,-0.01575511167275067,-0.03151022334550134,-0.04726533501825201,-0.06302044669100268,-0.07877555836375334,-0.09453067003650402,-0.11028578170925468,-0.12604089338200536,-0.141796005054756,-0.15755111672750668,-0.17330622840025736,-0.18906134007300804,-0.2048164517457587,-0.22057156341850936,-0.23632667509126,-0.2520817867640107,-0.2678368984367614,-0.283592010109512,-0.2993471217822627,-0.31510223345501337,-0.33085734512776405,-0.3466124568005147,-0.3623675684732654,-0.3781226801460161,-0.39387779181876675,-0.4096329034915174,-0.42538801516426805,-0.44114312683701873,-0.4568982385097694,-0.47265335018252,-0.4884084618552707,-0.5041635735280214,-0.5199186852007721,-0.5356737968735228,-0.5514289085462734,-0.567184020219024,-0.5829391318917747,-0.5986942435645254,-0.6144493552372761,-0.6302044669100267,-0.6459595785827774,-0.6617146902555281,-0.6774698019282788,-0.6932249136010294,-0.7089800252737801,-0.7247351369465308,-0.7404902486192815,-0.7562453602920322,-0.7720004719647828],"y":[-0.0,-0.008052048426258927,-0.016104096852517853,-0.02415614527877678,-0.032208193705035706,-0.04026024213129463,-0.04831229055755356,-0.05636433898381249,-0.06441638741007141,-0.07246843583633034,-0.08052048426258926,-0.08857253268884818,-0.09662458111510712,-0.10467662954136604,-0.11272867796762498,-0.12078072639388389,-0.12883277482014283,-0.13688482324640175,-0.14493687167266067,-0.15298892009891962,-0.16104096852517852,-0.16909301695143747,-0.17714506537769636,-0.18519711380395532,-0.19324916223021424,-0.2013012106564732,-0.20935325908273208,-0.217405307508991,-0.22545735593524996,-0.23350940436150888,-0.24156145278776778,-0.2496135012140267,-0.25766554964028565,-0.2657175980665446,-0.2737696464928035,-0.2818216949190624,-0.28987374334532134,-0.2979257917715803,-0.30597784019783925,-0.3140298886240981,-0.32208193705035704,-0.330133985476616,-0.33818603390287494,-0.34623808232913383,-0.35429013075539273,-0.3623421791816517,-0.37039422760791063,-0.3784462760341696,-0.3864983244604285,-0.39455037288668743],"z":[0.0,0.010170255659703304,0.020340511319406607,0.030510766979109913,0.040681022638813215,0.05085127829851652,0.061021533958219826,0.07119178961792312,0.08136204527762643,0.09153230093732972,0.10170255659703303,0.11187281225673633,0.12204306791643965,0.13221332357614293,0.14238357923584624,0.15255383489554955,0.16272409055525286,0.17289434621495617,0.18306460187465945,0.19323485753436279,0.20340511319406607,0.21357536885376938,0.22374562451347266,0.233915880173176,0.2440861358328793,0.2542563914925826,0.26442664715228587,0.2745969028119892,0.2847671584716925,0.29493741413139585,0.3051076697910991,0.3152779254508024,0.3254481811105057,0.335618436770209,0.34578869242991234,0.3559589480896156,0.3661292037493189,0.37629945940902226,0.38646971506872557,0.3966399707284288,0.40681022638813213,0.41698048204783544,0.42715073770753875,0.43732099336724206,0.4474912490269453,0.4576615046866487,0.467831760346352,0.4780020160060553,0.4881722716657586,0.4983425273254619],"type":"scatter3d"},{"marker":{"opacity":0.8,"size":3},"mode":"markers","name":"v_2","x":[-0.0,-0.00915814111774131,-0.01831628223548262,-0.02747442335322393,-0.03663256447096524,-0.04579070558870655,-0.05494884670644786,-0.06410698782418917,-0.07326512894193048,-0.08242327005967179,-0.0915814111774131,-0.1007395522951544,-0.10989769341289572,-0.11905583453063702,-0.12821397564837833,-0.13737211676611963,-0.14653025788386095,-0.15568839900160228,-0.16484654011934358,-0.1740046812370849,-0.1831628223548262,-0.1923209634725675,-0.2014791045903088,-0.21063724570805012,-0.21979538682579144,-0.22895352794353277,-0.23811166906127404,-0.24726981017901536,-0.25642795129675666,-0.265586092414498,-0.27474423353223926,-0.2839023746499806,-0.2930605157677219,-0.30221865688546323,-0.31137679800320456,-0.3205349391209458,-0.32969308023868715,-0.3388512213564285,-0.3480093624741698,-0.3571675035919111,-0.3663256447096524,-0.3754837858273937,-0.384641926945135,-0.3938000680628763,-0.4029582091806176,-0.4121163502983589,-0.42127449141610024,-0.43043263253384156,-0.4395907736515829,-0.4487489147693242],"y":[-0.0,-0.00442727540525699,-0.00885455081051398,-0.01328182621577097,-0.01770910162102796,-0.02213637702628495,-0.02656365243154194,-0.03099092783679893,-0.03541820324205592,-0.03984547864731291,-0.0442727540525699,-0.048700029457826886,-0.05312730486308388,-0.057554580268340864,-0.06198185567359786,-0.06640913107885485,-0.07083640648411184,-0.07526368188936884,-0.07969095729462582,-0.08411823269988282,-0.0885455081051398,-0.0929727835103968,-0.09740005891565377,-0.10182733432091078,-0.10625460972616776,-0.11068188513142477,-0.11510916053668173,-0.11953643594193873,-0.12396371134719572,-0.12839098675245272,-0.1328182621577097,-0.13724553756296667,-0.14167281296822368,-0.14610008837348068,-0.15052736377873768,-0.15495463918399466,-0.15938191458925163,-0.16380918999450864,-0.16823646539976564,-0.17266374080502261,-0.1770910162102796,-0.1815182916155366,-0.1859455670207936,-0.19037284242605057,-0.19480011783130755,-0.19922739323656455,-0.20365466864182155,-0.20808194404707855,-0.21250921945233553,-0.21693649485759253],"z":[-0.0,-0.0176923941742471,-0.0353847883484942,-0.053077182522741295,-0.0707695766969884,-0.08846197087123549,-0.10615436504548259,-0.1238467592197297,-0.1415391533939768,-0.15923154756822389,-0.17692394174247097,-0.19461633591671806,-0.21230873009096518,-0.23000112426521227,-0.2476935184394594,-0.2653859126137065,-0.2830783067879536,-0.3007707009622007,-0.31846309513644777,-0.3361554893106949,-0.35384788348494195,-0.37154027765918907,-0.38923267183343613,-0.40692506600768324,-0.42461746018193036,-0.44230985435617753,-0.46000224853042454,-0.47769464270467166,-0.4953870368789188,-0.5130794310531659,-0.530771825227413,-0.54846421940166,-0.5661566135759072,-0.5838490077501542,-0.6015414019244014,-0.6192337960986484,-0.6369261902728955,-0.6546185844471426,-0.6723109786213898,-0.6900033727956368,-0.7076957669698839,-0.7253881611441311,-0.7430805553183781,-0.7607729494926253,-0.7784653436668723,-0.7961577378411194,-0.8138501320153665,-0.8315425261896137,-0.8492349203638607,-0.8669273145381079],"type":"scatter3d"},{"marker":{"opacity":0.8,"size":3},"mode":"markers","name":"v_3","x":[-0.0,-0.009186840333329076,-0.018373680666658152,-0.027560520999987233,-0.036747361333316304,-0.04593420166664538,-0.05512104199997447,-0.06430788233330353,-0.07349472266663261,-0.08268156299996168,-0.09186840333329076,-0.10105524366661985,-0.11024208399994893,-0.119428924333278,-0.12861576466660707,-0.13780260499993613,-0.14698944533326522,-0.1561762856665943,-0.16536312599992337,-0.17454996633325245,-0.18373680666658151,-0.1929236469999106,-0.2021104873332397,-0.21129732766656878,-0.22048416799989787,-0.22967100833322693,-0.238857848666556,-0.24804468899988508,-0.25723152933321414,-0.26641836966654325,-0.27560520999987226,-0.2847920503332014,-0.29397889066653043,-0.30316573099985955,-0.3123525713331886,-0.32153941166651767,-0.33072625199984673,-0.33991309233317585,-0.3490999326665049,-0.35828677299983397,-0.36747361333316303,-0.37666045366649215,-0.3858472939998212,-0.3950341343331503,-0.4042209746664794,-0.41340781499980844,-0.42259465533313756,-0.4317814956664666,-0.44096833599979574,-0.4501551763331248],"y":[0.0,0.018222427842924167,0.036444855685848335,0.05466728352877251,0.07288971137169667,0.09111213921462084,0.10933456705754502,0.12755699490046918,0.14577942274339334,0.1640018505863175,0.1822242784292417,0.20044670627216585,0.21866913411509004,0.23689156195801417,0.25511398980093836,0.2733364176438625,0.2915588454867867,0.3097812733297109,0.328003701172635,0.3462261290155592,0.3644485568584834,0.38267098470140753,0.4008934125443317,0.41911584038725586,0.43733826823018007,0.45556069607310423,0.47378312391602834,0.49200555175895255,0.5102279796018767,0.5284504074448009,0.546672835287725,0.5648952631306492,0.5831176909735734,0.6013401188164975,0.6195625466594218,0.6377849745023458,0.65600740234527,0.6742298301881943,0.6924522580311184,0.7106746858740425,0.7288971137169667,0.7471195415598909,0.7653419694028151,0.7835643972457392,0.8017868250886634,0.8200092529315876,0.8382316807745117,0.8564541086174359,0.8746765364603601,0.8928989643032843],"z":[0.0,0.000195489290577266,0.000390978581154532,0.0005864678717317981,0.000781957162309064,0.00097744645288633,0.0011729357434635962,0.001368425034040862,0.001563914324618128,0.001759403615195394,0.00195489290577266,0.002150382196349926,0.0023458714869271924,0.002541360777504458,0.002736850068081724,0.00293233935865899,0.003127828649236256,0.0033233179398135223,0.003518807230390788,0.0037142965209680545,0.00390978581154532,0.004105275102122586,0.004300764392699852,0.0044962536832771184,0.004691742973854385,0.00488723226443165,0.005082721555008916,0.005278210845586182,0.005473700136163448,0.005669189426740715,0.00586467871731798,0.0060601680078952455,0.006255657298472512,0.006451146589049778,0.0066466358796270445,0.00684212517020431,0.007037614460781576,0.007233103751358843,0.007428593041936109,0.0076240823325133735,0.00781957162309064,0.008015060913667906,0.008210550204245172,0.008406039494822439,0.008601528785399704,0.00879701807597697,0.008992507366554237,0.009187996657131502,0.00938348594770877,0.009578975238286035],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"y"},"scaleanchor":"x","scaleratio":1},"xaxis":{"title":{"text":"x"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('654d645d-2ee2-430f-8966-9841b27249f5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Things to note from the above graph:</p>
<ol type="1">
<li>The first (red) eigenvector points along the direction of biggest variance</li>
<li>The second (greenish) eigenvector points along the direction of second-biggest variance</li>
<li>The third (purple) eigenvector points along the direction of smallest variance.</li>
</ol>
<p>(If you edit the above code to rescale the vector length by the eigenvector, you’ll really see these three point become apparent!)</p>
<section id="principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis">“Principal Component” Analysis</h2>
<p>Now we have our components (=eigenvectors), and we have them “ranked” by their “significance.” Next we will <em>eliminate</em> one or more of the less-significant directions of variance. In other words, we will <em>project</em> the data onto the various <em>principal components</em> by projecting <em>along</em> the less-significant components. Or even simpler: We will “squish” the data along the smallest-variance directions.</p>
<p>For the above 3D dataset, we’re going to squish it into a 2D pancake – by projecting along the direction of the 3rd (purple) eigenvector onto the plane defined by the 1st (red) and 2nd (greenish) eigenvectors.</p>
<p>Yea, but how to do this projection?</p>
</section>
<section id="projecting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="projecting-the-data">Projecting the data</h2>
<p>It’s actually not that big of a deal. All we have to do is multiply by the eigenvector (matrix)!</p>
<p><strong>OH WAIT! Hey, you want to see a cool trick!?</strong> Check this out:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(cov)  </span>
<span id="cb20-2"></span>
<span id="cb20-3">proj_cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs.T <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> vs   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># project the covariance matrix, using eigenvectors</span></span>
<span id="cb20-4">proj_cov</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[2.23494234e+00, 1.70482998e-16, 2.02405702e-16],
       [5.45916585e-17, 2.57703730e-01, 1.33554659e-16],
       [2.12481941e-16, 1.73636845e-16, 4.35661297e-02]])</code></pre>
</div>
</div>
<p>What was THAT? Let me clean that up a bit for you…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">proj_cov[np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(proj_cov) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-15</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb22-2">proj_cov</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[2.23494234, 0.        , 0.        ],
       [0.        , 0.25770373, 0.        ],
       [0.        , 0.        , 0.04356613]])</code></pre>
</div>
</div>
<p><strong>Important point:</strong> What you just saw is the whole reason eigenvectors get used for so many things, because they give you a ‘coordinate system’ where different ‘directions’ <em>decouple</em> from each other. See, the system has its own (German: eigen) inherent set of orientations which are different the ‘arbitrary’ coordinates that we ‘humans’ may have assigned initially.</p>
<p>The numbers in that matrix are the covariances <em>in the directions</em> of the eigenvectors, instead of in the directions of the original x, y, and z.</p>
<p>So really all we have to do is make a <em>coordinate transformation</em> using the matrix of eigenvectors, and then in order to project we’ll literally just <em>drop</em> a whole index’s-worth of data-dimension in this new coordinate system. :-)</p>
<p>So, instead of <img src="https://latex.codecogs.com/png.latex?x">, <img src="https://latex.codecogs.com/png.latex?y"> and <img src="https://latex.codecogs.com/png.latex?z">, let’s have three coordinates which (following physicist-notation) we’ll call <img src="https://latex.codecogs.com/png.latex?q_1">, <img src="https://latex.codecogs.com/png.latex?q_2"> and <img src="https://latex.codecogs.com/png.latex?q_3">, and these will run along the directions given by the three eigenvectors.</p>
<p>Let’s write our data as a N-by-3 matrix, where N is the number of data points we have.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.stack((x,y,z),axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-2">data.shape   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we had a 100 data points, so expecting 100x3 matrix </span></span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(100, 3)</code></pre>
</div>
</div>
<p>There are two ways of doing this, and I’ll show you that they’re numerically equivalent:</p>
<ol type="1">
<li>Use <em>all</em> the eigenvectors to “rotate” the full dataset into the new coordinate system. Then perform a projection by truncating the last column of the rotated data.</li>
<li>Truncate the last eigenvector, which will make a 3x2 projection matrix which will project the data onto the 2D plane defined by those two eigenvectors.</li>
</ol>
<p>Let’s show them both:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 1. All data, rotated into new coordinate system"</span>)</span>
<span id="cb26-2">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep the all the eigenvectors</span></span>
<span id="cb26-3">new_data_all <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># project all the data </span></span>
<span id="cb26-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checking: new_data_all.shape ="</span>,new_data_all.shape)</span>
<span id="cb26-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New covariance matrix = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,np.cov(new_data_all.T) )</span>
<span id="cb26-6"></span>
<span id="cb26-7"></span>
<span id="cb26-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 2. Truncated data projected onto principal axes of coordinate system"</span>)</span>
<span id="cb26-9"></span>
<span id="cb26-10">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep only the first and 2nd eigenvectors </span></span>
<span id="cb26-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"W.shape = "</span>,W.shape) </span>
<span id="cb26-12">new_data_proj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># project </span></span>
<span id="cb26-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Checking: new_data_proj.shape ="</span>,new_data_proj.shape)</span>
<span id="cb26-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New covariance matrix in projected space = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,np.cov(new_data_proj.T) )</span>
<span id="cb26-15"></span>
<span id="cb26-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Difference between them</span></span>
<span id="cb26-17">diff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_data_all[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> new_data_proj</span>
<span id="cb26-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Absolute maximum difference between the two methods = "</span>,np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(diff)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1. All data, rotated into new coordinate system
Checking: new_data_all.shape = (100, 3)
New covariance matrix = 
 [[2.23494234e+00 4.35665465e-17 3.01388743e-16]
 [4.35665465e-17 2.57703730e-01 9.62562340e-17]
 [3.01388743e-16 9.62562340e-17 4.35661297e-02]]

 2. Truncated data projected onto principal axes of coordinate system
W.shape =  (3, 2)
Checking: new_data_proj.shape = (100, 2)
New covariance matrix in projected space = 
 [[2.23494234e+00 4.35665465e-17]
 [4.35665465e-17 2.57703730e-01]]

 Absolute maximum difference between the two methods =  0.0</code></pre>
</div>
</div>
<p>…Nada. The 2nd method will be faster computationally though, because it doesn’t calculate stuff you’re going to throw away.</p>
<p>One more comparison between the two methods. Let’s take a look at the “full” dataset (in blue) vs.&nbsp;the projected dataset (in red):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[(go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_all[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_all[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_all[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb28-2">        mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full data"</span> ))])</span>
<span id="cb28-3">fig.add_trace(go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_proj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_proj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>new_data_proj[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb28-4">        mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"projected"</span> ) )</span>
<span id="cb28-5">fig.update_layout(scene_aspectmode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data'</span>)</span>
<span id="cb28-6">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="0f6ea661-5eea-4bed-90f0-3560dc99ca1f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0f6ea661-5eea-4bed-90f0-3560dc99ca1f")) {                    Plotly.newPlot(                        "0f6ea661-5eea-4bed-90f0-3560dc99ca1f",                        [{"marker":{"opacity":0.5,"size":4},"mode":"markers","name":"full data","x":[-1.2680125303854723,1.2752340569866334,0.23883632008948996,-0.597763995594326,0.634193056432064,2.409788468039979,-2.2929859963464594,0.15735790222093296,0.5591371567200343,-0.9206392021352005,-0.6150764729470661,0.055343977704302966,0.974474326693091,-0.20913852383242654,2.1510809525273658,-1.8296083419008389,1.8243243321176357,-0.3941736723853825,1.429925898886887,2.0716802144851085,2.3686849878057346,0.024354652144323526,0.8259326922734181,2.3141414604687425,2.1929689451414522,0.5062366269200467,-0.30906823253130505,-1.556623622027968,0.9823277658001536,2.069464463678806,2.373133464762115,1.9064559872392262,1.923678177780243,1.3909546966313724,2.3299727592591597,1.075688538370506,0.5171237231915092,1.2545166478417586,-1.2948318660672413,0.7836737506320268,0.8919579453895276,3.5530379304680406,-0.213629905238705,-1.374701900189915,2.207725393445806,0.864141700204356,-0.6794123301476489,-1.3569007992179258,1.089639735881546,0.18600741798086828,1.5002226835481023,1.749546128423851,0.13494857490305562,-0.4567771516619,-0.028345861361362974,2.713094187601158,2.930911403530462,0.3843108181189236,-1.0558210905638488,0.9688814168768761,1.798098547335988,-1.988124075750466,1.3542975784896885,1.136113480021716,2.5345664494978783,-1.0204233355427228,-1.1497240423710515,1.4525452784443584,1.2018695235742916,0.8741961606306292,3.800359955575868,-0.43410179578602587,-0.3724063050688492,-0.1289604767044547,-0.14632921250014652,0.8900517765542174,3.6913431583112675,2.6227762726114734,3.4121623714960405,0.2674838510142823,-0.18597780821263152,-2.0668293540355567,2.395753407688001,2.8802874461345866,-0.7744795411704302,-2.1741660652865535,-0.5231209648192469,2.308587333204438,0.5969345503670661,2.8185470132503343,-0.7660290600049517,-1.1829780176178313,-1.4996225233970077,-0.9152255142573454,-0.025445228078548904,1.0748762491896329,1.8529709523086864,-2.828627152603193,0.30945370578237974,1.1824118185093835],"y":[-0.6970533321908156,-1.4721949471042364,-1.063433701159021,-1.1734907108726862,-1.5947819569262942,-1.4961403185672186,-0.4890282351212715,-1.406222005531907,-1.2687600481195764,-1.3311679537547656,-0.7315822697708996,-0.6074695493008113,-1.6941186916484678,-0.395175902837614,0.17600481512876098,-0.26772728165684145,-0.3836284792760937,-0.9304204686657592,-1.4130356799803918,-0.23284877544338137,-0.8462901685328643,-1.3163446793646862,-0.2808744539773266,-0.9887987560954395,-0.8300006344325087,-0.6545435152747667,-0.5009991905938529,-1.703331265021808,-0.9476307185251572,-1.4377163355304325,-1.4796140534669977,-0.8865969976777306,-1.2220670068134758,-0.7387649962043411,-1.6277881224529591,-0.6652182082744393,-0.660472470209351,-1.3891435527244218,-1.147533398201568,-0.9625051105987258,-0.7680997260879238,-0.5930336910814242,-0.33843849652037566,-1.2371966315757776,-1.1729469224258473,-0.8275825130642962,-0.18130240272724824,-1.463981224982332,-1.580950193220276,-0.03806769474270164,-1.3031745483791852,-1.4517227661610548,-0.7063325668880964,-1.82690866469419,-1.8288465124503344,-1.2911940419407055,-0.40687220558798876,0.0009565395967470765,-1.184094110607385,-0.30762844333040146,-1.0521465374783756,-0.2830290188616712,-0.24433005472877461,-0.7802647445695032,-0.20650432028204407,-0.3129653402078862,-1.7792579663014294,-0.6343973103470628,-0.009084235672235182,-0.09787933624083216,-0.4079254754943043,-0.18948076440038497,-0.2597915488094661,-1.4671189665893025,-0.2464934165168872,-0.18414982743981173,-1.1733451820384115,-0.5459955310228624,-1.08925103930143,-1.0811116056431929,-0.8310079425965623,-1.8483591716527807,-1.4897561026443977,-1.0377548996481836,-1.0595300592232655,-0.22078310382694705,-1.335767578832134,-0.9492678196451045,-1.3640127939604372,-0.7355967376261369,-1.6262702455425226,-1.0839517852258613,-0.7259555689763812,-1.383782987107323,-1.30574502593145,-0.7707925954235615,-1.1047257849145855,-0.3149653873581547,-0.987365414513,-1.0640499012091598],"z":[0.1560220336612576,-0.1365829092885396,0.12551630902606867,-0.06080734141018231,-0.09638733970373285,-0.11577909532862088,-0.12623639935115244,0.21847132290763646,-0.1330932155406119,0.16117164651196003,-0.23322899182550338,0.3099695590394101,-0.17730925216873797,-0.18199957257104785,-0.21433471102198592,0.14059534118999548,-0.2763864215293663,0.06264803009375537,0.25334011730126754,-0.09846746084362624,0.006498820328503301,-0.0061888659400689,0.3616728110964242,0.1126047280766278,0.07584995098509834,0.18687284576907937,0.24198180587391782,0.10081951467839971,-0.1901642626123977,0.11036879547827673,0.20708271865006578,0.2132397887896441,0.12543363904040167,0.0011486155710611794,0.28893636705736786,0.07647935933951738,0.07999113049330701,0.1467347146621006,0.0989332571447979,0.37839203635878893,0.029714853805967594,-0.0371137128823571,0.14663603807549083,-0.25625134736179983,0.03636767628110712,0.05730782562970299,0.098020379872998,-0.41693923597704785,-0.04191702053401093,-0.1323216599179403,-0.296885175019722,-0.5367108336943992,0.05485200799711223,0.16801520450677215,0.12630590617819773,0.043824274972956136,0.29646291903631067,-0.0325534832428767,0.4805750591119617,-0.11184161864688753,-0.28505564346596596,-0.04529717193629945,0.0033267764779751447,-0.05117762299076981,0.5217372164853753,-0.03288862745784009,-0.1887733948624042,0.20276653059324318,0.14613256091172977,0.24086102116553815,-0.06587502996753009,-0.14648454572186453,0.02029121838232123,0.22467326663024262,-0.11419927640507414,0.34299810758370786,0.18865581479614021,-0.0676671726227109,-0.09719554494176774,-0.06687464299650048,-0.17850547059430955,-0.04862699755407861,0.22544762926059944,0.22493662386397217,-0.17477049456819033,-0.12270150012907036,-0.33017767275547305,-0.0817826838591954,0.1434108178252392,-0.5486267817831033,0.14340611803256606,0.3084473613086139,-0.01392286411609083,0.5090174067516395,0.20820936189036993,-0.07937424431281699,-0.01765534934813431,0.08844101043827689,0.48154802097172766,-0.05579607793111217],"type":"scatter3d"},{"marker":{"opacity":0.5,"size":4},"mode":"markers","name":"projected","x":[-1.2680125303854723,1.2752340569866334,0.23883632008948996,-0.597763995594326,0.634193056432064,2.409788468039979,-2.2929859963464594,0.15735790222093296,0.5591371567200343,-0.9206392021352005,-0.6150764729470661,0.055343977704302966,0.974474326693091,-0.20913852383242654,2.1510809525273658,-1.8296083419008389,1.8243243321176357,-0.3941736723853825,1.429925898886887,2.0716802144851085,2.3686849878057346,0.024354652144323526,0.8259326922734181,2.3141414604687425,2.1929689451414522,0.5062366269200467,-0.30906823253130505,-1.556623622027968,0.9823277658001536,2.069464463678806,2.373133464762115,1.9064559872392262,1.923678177780243,1.3909546966313724,2.3299727592591597,1.075688538370506,0.5171237231915092,1.2545166478417586,-1.2948318660672413,0.7836737506320268,0.8919579453895276,3.5530379304680406,-0.213629905238705,-1.374701900189915,2.207725393445806,0.864141700204356,-0.6794123301476489,-1.3569007992179258,1.089639735881546,0.18600741798086828,1.5002226835481023,1.749546128423851,0.13494857490305562,-0.4567771516619,-0.028345861361362974,2.713094187601158,2.930911403530462,0.3843108181189236,-1.0558210905638488,0.9688814168768761,1.798098547335988,-1.988124075750466,1.3542975784896885,1.136113480021716,2.5345664494978783,-1.0204233355427228,-1.1497240423710515,1.4525452784443584,1.2018695235742916,0.8741961606306292,3.800359955575868,-0.43410179578602587,-0.3724063050688492,-0.1289604767044547,-0.14632921250014652,0.8900517765542174,3.6913431583112675,2.6227762726114734,3.4121623714960405,0.2674838510142823,-0.18597780821263152,-2.0668293540355567,2.395753407688001,2.8802874461345866,-0.7744795411704302,-2.1741660652865535,-0.5231209648192469,2.308587333204438,0.5969345503670661,2.8185470132503343,-0.7660290600049517,-1.1829780176178313,-1.4996225233970077,-0.9152255142573454,-0.025445228078548904,1.0748762491896329,1.8529709523086864,-2.828627152603193,0.30945370578237974,1.1824118185093835],"y":[-0.6970533321908156,-1.4721949471042364,-1.063433701159021,-1.1734907108726862,-1.5947819569262942,-1.4961403185672186,-0.4890282351212715,-1.406222005531907,-1.2687600481195764,-1.3311679537547656,-0.7315822697708996,-0.6074695493008113,-1.6941186916484678,-0.395175902837614,0.17600481512876098,-0.26772728165684145,-0.3836284792760937,-0.9304204686657592,-1.4130356799803918,-0.23284877544338137,-0.8462901685328643,-1.3163446793646862,-0.2808744539773266,-0.9887987560954395,-0.8300006344325087,-0.6545435152747667,-0.5009991905938529,-1.703331265021808,-0.9476307185251572,-1.4377163355304325,-1.4796140534669977,-0.8865969976777306,-1.2220670068134758,-0.7387649962043411,-1.6277881224529591,-0.6652182082744393,-0.660472470209351,-1.3891435527244218,-1.147533398201568,-0.9625051105987258,-0.7680997260879238,-0.5930336910814242,-0.33843849652037566,-1.2371966315757776,-1.1729469224258473,-0.8275825130642962,-0.18130240272724824,-1.463981224982332,-1.580950193220276,-0.03806769474270164,-1.3031745483791852,-1.4517227661610548,-0.7063325668880964,-1.82690866469419,-1.8288465124503344,-1.2911940419407055,-0.40687220558798876,0.0009565395967470765,-1.184094110607385,-0.30762844333040146,-1.0521465374783756,-0.2830290188616712,-0.24433005472877461,-0.7802647445695032,-0.20650432028204407,-0.3129653402078862,-1.7792579663014294,-0.6343973103470628,-0.009084235672235182,-0.09787933624083216,-0.4079254754943043,-0.18948076440038497,-0.2597915488094661,-1.4671189665893025,-0.2464934165168872,-0.18414982743981173,-1.1733451820384115,-0.5459955310228624,-1.08925103930143,-1.0811116056431929,-0.8310079425965623,-1.8483591716527807,-1.4897561026443977,-1.0377548996481836,-1.0595300592232655,-0.22078310382694705,-1.335767578832134,-0.9492678196451045,-1.3640127939604372,-0.7355967376261369,-1.6262702455425226,-1.0839517852258613,-0.7259555689763812,-1.383782987107323,-1.30574502593145,-0.7707925954235615,-1.1047257849145855,-0.3149653873581547,-0.987365414513,-1.0640499012091598],"z":[-0.0,0.0,0.0,-0.0,0.0,0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,0.0,-0.0,0.0,-0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0,-0.0,0.0,0.0],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"scene":{"aspectmode":"data"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('0f6ea661-5eea-4bed-90f0-3560dc99ca1f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p><small>(Darn it, <a href="https://community.plot.ly/t/orthographic-projection-for-3d-plots/3897">if only Plot.ly would support orthographic projections</a> [<a href="https://community.plot.ly/t/orthographic-projection-instead-of-perspective-for-3d-plots/10035">2</a>] it’d be a lot easier to visually compare the two datasets!)</small></p>
</section>
</section>
<section id="beyond-3d" class="level1">
<h1>Beyond 3D</h1>
<p>So typically we use PCA to throw out many more dimensions than just one. Often this is used for data visualization but it’s also done for feature reduction, i.e.&nbsp;to send less data into your machine learning algorithm. (PCA can even be used just as a “multidimensional linear regression” algorithm, but you wouldn’t want to!)</p>
<section id="how-do-you-know-how-many-dimensions-to-throw-out" class="level2">
<h2 class="anchored" data-anchor-id="how-do-you-know-how-many-dimensions-to-throw-out">How do you know how many dimensions to throw out?</h2>
<p>In other words, how many ‘components’ should you choose to keep when doing PCA? There are a few ways to make this <em>judgement call</em> – it will involve a trade-off between accuracy and computational speed. You can make a graph of the amount of variance you get as a function of how many components you keep, and often there will be a an ‘elbow’ at some point on the graph indicating a good cut-off point to choose. Stay tuned as we do the next example; we’ll make such a graph. For more on this topic, see <a href="https://towardsdatascience.com/an-approach-to-choosing-the-number-of-components-in-a-principal-component-analysis-pca-3b9f3d6e73fe">this post by Arthur Gonsales</a>.</p>
</section>
<section id="example-handwritten-digits" class="level2">
<h2 class="anchored" data-anchor-id="example-handwritten-digits">Example: Handwritten Digits</h2>
<p>The <a href="https://scikit-learn.org/stable/auto_examples/classification/plot_digits_classification.html">scikit-learn library</a> uses this as an example and I like it. It goes as follows: 1. Take a dataset of tiny 8x8 pixel images of handwritten digits. 2. Run PCA to break it down from 8x8=64 dimensions to just two or 3 dimensions. 3. Show on a plot how the different digits cluster in different regions of the space. 4. (This part we’ll save for the Appendix: Draw boundaries between the regions and use this as a classifier.)</p>
<p>To be clear: In what follows, <em>each pixel</em> of the image counts as a “feature,” i.e.&nbsp;as a dimension. Thus an entire image can be represented as a single point in a multidimensional space, in which distance from the origin along each dimension is given by the pixel intensity. In this example, the input space is <em>not</em> a 2D space that is 8 units wide and 8 units long, rather it consists of 8x8= 64 dimensions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_digits </span>
<span id="cb29-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb29-3">digits  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_digits()</span>
<span id="cb29-4">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> digits.data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">255.0</span> </span>
<span id="cb29-5">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> digits.target</span>
<span id="cb29-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(X.shape, Y.shape,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb29-7"></span>
<span id="cb29-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's look a a few examples</span></span>
<span id="cb29-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show 8 examples </span></span>
<span id="cb29-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is supposed to be a '"</span>,Y[i],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"':"</span>,sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb29-11">    plt.imshow(X[i].reshape([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>]))</span>
<span id="cb29-12">    plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1797, 64) (1797,) 

This is supposed to be a '0':
This is supposed to be a '1':
This is supposed to be a '2':
This is supposed to be a '3':
This is supposed to be a '4':
This is supposed to be a '5':
This is supposed to be a '6':
This is supposed to be a '7':</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-2.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-3.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-4.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-5.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-6.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-7.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-8.png" width="407" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-17-output-9.png" width="407" height="411"></p>
</div>
</div>
<p>Now let’s do the PCA thang… First we’ll try going down to 2 dimensions. This isn’t going to work super great but we’ll try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">digits_cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cov(X.T)</span>
<span id="cb31-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"digits_cov.shape = "</span>,digits_cov.shape)</span>
<span id="cb31-3">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(np.array(digits_cov)) </span>
<span id="cb31-4"></span>
<span id="cb31-5">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just keep two dimensions</span></span>
<span id="cb31-6">proj_digits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W</span>
<span id="cb31-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proj_digits.shape = "</span>, proj_digits.shape)</span>
<span id="cb31-8"></span>
<span id="cb31-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the plot </span></span>
<span id="cb31-10">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_digits[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_digits[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># z=Y, #z=proj_digits[:,2],</span></span>
<span id="cb31-11">                mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Y), text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'digit='</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(j) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> Y] )])</span>
<span id="cb31-12">fig.update_layout( xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q_1"</span>, yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q_2"</span>, yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(scaleanchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,scaleratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb31-13">fig.update_layout(scene_camera<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), center<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), eye<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)))</span>
<span id="cb31-14">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>digits_cov.shape =  (64, 64)
proj_digits.shape =  (1797, 2)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="77781919-d999-468a-8a86-6bdd7f4477e2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("77781919-d999-468a-8a86-6bdd7f4477e2")) {                    Plotly.newPlot(                        "77781919-d999-468a-8a86-6bdd7f4477e2",                        [{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,3,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,2,5,7,9,5,4,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8],"opacity":0.7,"size":6},"mode":"markers","text":["digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=3","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8"],"x":[0.003641879188461759,-0.03250352375315516,-0.02871651068332173,0.0610796784255883,-0.09269668495878615,0.05394627110035249,-0.08507528153637658,0.010281645884827875,0.01931116472095592,0.020193770836006566,-0.04527790864176921,-0.013097919949390916,0.00817022048094989,0.08990129893719988,-0.09720596859569498,0.004195838080465048,-0.06861749447059971,-0.02332094436512398,0.009860265258180019,0.052708125236181375,-0.02653392740508787,-0.001398629523279912,0.03042373093040231,0.07395682874807838,-0.07007669164944558,-0.02526354313562728,-0.0849607965920045,-0.020026032224075684,-0.003041282027298858,0.05569975865622116,-0.0022420207344286945,0.05215553655776693,0.01839001673185042,0.022349937152196925,-0.0719111215726857,0.011195245710153297,-0.025353532817550088,0.05115379972139105,-0.0012264662609987177,0.08005125452882639,0.015914084895434933,-0.09951322519632781,-0.012373786259719004,-0.02350823940884747,0.012679651659722204,0.08047534029180652,-0.013100033297392568,-0.007744279816659831,-0.020977510096650297,-0.0167426675721841,-0.0051501632089279575,-0.02586735549653923,-0.02834663859579463,-0.007857541774474288,-0.04329879650540013,-0.04177867852028993,-0.014057952345307994,-0.027414831265071653,-0.08924488808024819,0.07480722025315241,0.09111654652404244,-0.020003103772932518,0.09239718281886757,0.08325721338876639,-0.11181336202750353,-0.08518601421574348,-0.0850799502211484,-0.0592128900455909,-0.07755832320592605,0.028945284639232974,-0.032333697579332306,0.02282301290417043,-0.026034762012550467,0.07095532831236,0.0037059866584825346,-0.013024114516740596,-0.012080765519419156,-0.027040528596930843,0.012151666490349206,0.003662959094359653,-0.0020488047628436355,-0.006541457272511597,-0.08637996277074297,0.07808412923288574,0.013331462874125531,-0.030705243689442673,-0.026885104776597817,-0.07267147312128443,-0.08784150973620658,0.09319721879721053,-0.013592029640108458,0.07951075571388713,0.07782232758613812,-0.050546967142353634,-0.0006806403804907507,-0.08027398087938925,-0.013513050546871045,-0.08979974719813906,0.09550920213499099,-0.07942369268615489,-0.09060043794233115,-0.03485645240874155,-0.001242404064831306,0.05492350817057599,-0.09738494063849816,0.06316467150555354,-0.0721534318889931,0.001808473572357399,-0.015736264728584692,-0.004653864528558717,-0.06730586625292782,-0.07481902574847987,-0.010590309999289322,0.006562470225087588,-0.015457381336814102,-0.012416480619450535,0.01825031258028431,0.011200296179799335,-0.0024357635898066246,0.045481597032490356,0.01172235075777478,-0.06682930998844451,-0.0014929097550856205,0.013025213627620323,-0.09740323172128586,0.06219803767962538,-0.03130932442581995,-0.008242528710424805,0.05891836005140188,-0.01823701995022786,-0.009207576816229883,0.014024531795111008,0.03180984637481837,0.07569368373193415,-0.07352312983079155,0.002596991588503277,-0.05837857976847352,-0.0054918523064982384,-0.006048015141568839,0.07045934909391911,-0.015261764495193019,-0.012284474794892376,0.0380279666221496,0.10440861484755014,-0.08920484348984264,0.015742631247507372,-0.0719051213042168,-0.020414146130505798,-0.017803421808288707,0.07097541021686321,-0.03299086881140459,0.007449932610844278,0.04587531953319229,0.06508943825299673,-0.0783220357122611,-0.02592660358551402,-0.07982472878707447,-0.01643378210764255,-0.029427643021446643,0.06222692558974496,-0.02491963845720444,0.04952903917206209,-0.007415446192151452,-0.021092369994520393,-0.07265952081565985,-0.010788563181858895,-0.018117317851318083,0.0556123374814513,-0.015627379067787748,0.06511493337312932,-0.017163563512838903,-0.10066482424613,0.007776475226108433,-0.001793264503380579,0.00744349083857463,0.08318679747202329,0.00842831662893695,0.0062448847299686324,-0.012315507603262894,-0.043580031118985015,0.036266380250669306,0.0368489545137655,-0.00432931676998263,0.01867201152923453,-0.002228820105281665,-0.043104167000806874,-0.009406852371501663,0.011410438108331521,-0.06285801614025352,0.10093771355914406,0.07377538732708816,-0.03627523698730336,0.08449530343079532,0.08901318607283926,-0.08121795064978331,-0.09425063580988396,-0.07362865988338284,-0.07540518501773226,-0.08402665270699992,0.03909982830872647,-0.02956282020554487,-0.0007403237353110947,-0.02369261112615194,0.05728253238992803,-0.01265908340524485,0.03392196470839722,-0.0009723679580710389,0.019885487656130293,-0.059321256034302605,-0.04566874922851654,-0.00694355369510762,-0.005732830638868169,-0.0692555210898716,0.07888203638160488,0.019346305838977604,-0.005517457617268076,-0.02371387409028128,0.07048651224771067,0.005098806600136532,0.07651739597372081,0.05379484541454274,-0.031032053881598663,0.005160902361751227,-0.0776593851637883,-0.008321139702629547,-0.10423860416196283,0.06871302505602796,-0.016659518659031633,-0.09872933935141072,-0.0018390794540775418,-0.00010976802333817457,0.0517382010434937,-0.06983972633389858,0.053376877935761236,-0.04024079997679585,-0.03867110152918262,-0.0004953409713403628,-0.0314752769962467,-0.08285480249550387,-0.08858289283776341,-0.022952564947159415,-0.007154773517597172,-0.022567827687185495,0.0038805537481539478,0.015463805197998049,-0.01878699467169279,-0.013735131806791116,-0.07010728542040931,-0.006618967342385435,0.00015521274187014158,-0.09030799923198192,0.03388468136708964,-0.03250102479304573,0.005622791991609138,0.014628990992859537,-0.021970720580630536,-0.023447782537123384,-0.04383863288062963,0.04040177288486107,0.07506827649390385,-0.083327872901409,0.044117506568579844,-0.05841783956713271,0.021070090034178545,0.024871180359482402,0.029843135138306304,-0.013650743614041106,-0.03568554269909267,0.04091138448949027,0.06013656044566609,-0.10503415501728959,0.023061646020471862,-0.07338359873185378,-0.005490042290782174,-0.008160561508986554,0.015595857162430145,-0.0038360022749607263,-0.05396959831569905,0.050740968697758876,0.08695267129614681,-0.09304346929699829,0.033576611396919386,-0.06002172031601086,-0.030716683777123693,-0.028976547661808724,0.09055417296437136,-0.024112715547704798,0.06673777746529373,0.028112003645961284,0.02631219329292367,-0.0709418842392729,0.03221728212422196,0.011097199771558605,0.058085764205403345,0.009099535417994983,0.06160052487011136,0.002967873267476858,-0.10940006528234285,-0.05687276455177326,0.015274695315074027,-0.006608620028668642,0.07925984329370712,0.026466368916415062,-0.03940850417908791,-0.0156623823843504,0.0011357912427894471,0.04719901513311296,0.038193748112241584,0.019302131018522475,0.030596898684126718,0.050790467934459606,-0.00566751372304126,-0.023230049712156857,0.04715395899076579,-0.022851492541528646,0.06268750942534536,0.08007222368393964,-0.0087103417318325,0.09840379730895127,0.07883282221603546,-0.11458824187366894,-0.05668765921537526,-0.058809853075165355,-0.07651089312977778,-0.10314701915672143,0.011358893632465974,-0.045968980175821156,-0.022194560470829648,-0.009074504914383831,0.025835765725098814,0.020282781932366642,0.05965070327521085,0.017545746027036603,0.05769597432818158,-0.014786197167520228,-0.0033461931636346175,-0.033764855285562854,-0.011647348287443415,-0.0819090452902874,0.07896976072763104,0.061530477198855765,-0.0282628786248815,-0.005072428189571861,-0.10488006468689508,-0.05603019133191284,0.09761314677436832,-0.04414828893012452,0.06138245206715205,0.027074597601059232,-0.041021652240086505,0.0064487350324723405,-0.06932138414286301,-0.008908899822385408,-0.12050890070631758,0.039611756829252553,-0.01489526753607038,-0.08244700245601724,-0.005961550602114324,0.03874859376855582,0.08641368683824499,-0.06839947554864624,0.02964357785533726,-0.05995802419284271,-0.060931178085948376,-0.018430338025092145,0.02954472188330207,-0.11685713573287519,-0.11147832928361495,-0.00187116212924028,0.0524729113432501,0.02628720023903217,0.043561589863854853,0.049438820280538844,0.05150037694197925,-0.021601219285695576,-0.004474139939673383,0.007295004629729689,-0.11444537072432112,0.025656548597704835,0.018035734342929443,-0.10654236644758315,-0.010296774630798327,-0.011015562831044177,-0.014708179762219295,-0.0009116660264417691,0.09162102850011142,0.01940544273944997,0.02247879318664233,0.028678434201314797,0.08219876861372147,-0.07102740167898662,0.03865842976859919,-0.08295971117396922,-0.011315803589020994,-0.0018336822030573764,0.07475519142591815,0.0018160461506426667,-0.011130047697043562,0.026756381856905175,0.0668479380706981,-0.08751622915953423,0.0046770659609432505,-0.05645332565742726,-0.014534563369302592,0.013466201654326571,0.05231172551719766,-0.01910178935124131,-0.018945743240114058,0.02249336034679358,0.03516515786485049,-0.08796329888506808,0.00039788080511648507,-0.06465340458300774,-0.02580683239656638,-0.021255631987294524,0.05607214988149333,-0.03075030640496974,0.04050342151366537,0.05840026446326552,0.012250787782586644,-0.04063146943725781,0.04682784617231313,0.009149938918555131,0.050623966452438086,0.017641915305287005,0.07985926727232247,0.02024870241111681,-0.0765312152182462,0.0038207334427869093,-0.029525932148987657,0.015775654831393694,0.07974487643210908,0.0048566067159261745,-0.00721875058849491,-0.012298975455149417,-0.022338046397723743,0.03947654095101741,0.04437331719693544,-0.011221448618105964,0.026217771293768625,0.047570788226776635,0.01989497053367121,-0.00030908268040201025,0.044832478447019555,-0.04505617483998035,0.054331380117037024,0.04336832919775413,-0.02551637880075303,0.053271254662220796,0.04902797859154004,-0.08983850846407498,-0.077361015659697,-0.06726457242638884,-0.07029802464901755,-0.08057691176518667,0.08146185163420205,0.0005632493505324762,0.019594178558517313,-0.00981235911226661,0.04556433487144732,0.021390269310664085,0.02060052396296103,0.025518807346026535,0.03404301454544698,0.002249387928260197,-0.0016451828536890695,-0.02649251460369305,-0.03595023881206644,-0.08392084978486007,0.05188723472035217,0.022353066945158418,-0.050953213997032114,0.019416033354406958,-0.0693364906550753,-0.05457261292368504,0.048965476786658337,4.619612013508766e-05,0.06129613102463938,0.04499698768422772,-0.006823015937140457,0.004770003726483162,-0.051421402411076844,0.007712454864198969,-0.08480638476438176,0.058215879467676854,-0.006463238112778506,-0.08281791066461701,-0.01252588145928433,0.02634534813605241,0.04593685551764607,-0.08311344267443027,0.024573214701498532,-0.08418285500887136,-0.010206811225922405,-0.020220294293809615,0.018413268481230288,-0.05988999618936164,-0.08591163811463473,-0.012563693481120578,0.024227220605336143,0.004501181824947186,0.04239375698826365,-0.013338559697289738,-0.0032516062925705886,0.0041534134543015425,0.04214296678846387,-0.03444226847127903,-0.0809664381086835,0.008620908565738125,-0.003656927770229839,-0.07586318850523933,0.049051046525479015,-0.0036855191145223685,0.021939360239080313,0.05648618476700289,0.02984359289153675,0.012517506123863271,0.0021440729905661568,0.010931740963381597,0.05358189844648631,-0.07724881667292001,0.0063818831016010675,-0.056188599654003954,0.02158503897028031,-0.015229954469925347,0.029883213815327825,-0.0018061681614777534,-0.0004442824123330405,0.0188738963722918,0.07411076017142726,-0.04773301573009015,0.03790476758053555,-0.05079377825715916,0.027018525078607997,-0.016361957845138386,0.03271301616821883,0.024071986571033415,-0.007641481058784313,0.030817356336776243,0.0460387327365289,-0.08881293994924573,0.05221475319416386,-0.05265557558644001,0.008349426698117538,0.0137099266648808,0.05232807343287594,-0.0021112369459249975,0.022589469882150253,0.045337448951430236,0.04301082164932139,-0.05650312089765821,0.04392111540893367,0.023171709687039837,0.07496115598377567,-0.024892951773250797,0.0315532818865321,-0.0025777228363733397,-0.07648400951019207,-0.030376353024432586,-0.01609701363924962,0.015619547156523639,0.06892147911317903,0.05089713042757353,-0.048201774234119886,0.00854354297161144,0.018205557761612427,0.039206638717562386,0.018264266360411934,0.021228301838335416,-0.013916369832455582,0.04852852663851958,-0.015619303385034212,-0.03925886548261834,0.02335778387035555,-0.052126271520992834,0.0579156020394793,0.07560729008696426,0.004157315730423816,0.041691396333916865,0.0448628122300859,-0.09831128248567794,-0.05138717045037338,-0.07329595575755986,-0.0502384855701369,-0.05881276103964955,0.0535991448103648,-0.04875926937717459,0.03166980568684411,-0.008031029778010982,0.07375532553713479,0.029951910727838555,0.03999074423999045,-0.005424622531251533,0.04949737428330443,0.032553408122097616,0.005483381725694246,-0.033702402411308036,0.020203352773350596,-0.057824067556185015,0.05447119548246627,0.011413102668360996,-0.020777127184752435,0.006908636854197466,-0.0673803647295762,-0.07075738712663442,0.03547470708411122,-0.03637669482534864,0.03103863051773932,0.0387836811967854,-0.002984113279663231,-0.01181938538383211,-0.06542990160407111,-0.010492278071820111,-0.07404672223076297,0.07500878183082103,-0.03233330041898194,-0.07905171621352321,0.032891438715996306,0.04370867642121877,0.06521783411005913,-0.06989589083643213,0.03475250106637888,-0.05814432563748767,-0.0004967369758230158,0.0168749541287461,0.04033635835059975,-0.06269639981846203,-0.09695475859751783,0.010324371744229607,0.02867694190142237,-0.02686048200623999,0.0730883637332469,0.027771711155384203,0.005844026871030217,0.0237106156924155,0.08033536251800698,0.046612587999127986,-0.0499633292370421,-0.009526947778828038,-0.015614655870187462,-0.06034668848659266,0.07101137346384837,0.010246713466426199,-0.01082743358640874,0.0527681180446207,-0.02370930473349136,-0.013527008834274762,-0.04168151405927207,0.042890355528505036,0.060921041965130505,-0.09252917813941848,-0.018744876819194223,-0.06713756415860694,0.0048895096947635,0.021836643874783353,-0.010582628501468051,0.0022602481369145317,-0.055027263182817275,0.04017169063927172,0.07177190546021325,-0.10781450809739032,-0.011007001607102001,-0.07699279071020541,-0.009647273337692773,0.0036407994809587937,-0.031079059590055195,-0.030897099206970775,-0.07244023326710441,0.055433037585620126,0.055967584388275066,-0.06821828685523203,-0.004350746849930919,-0.06921169742091743,-0.01706126265778582,0.011405330814463979,-0.008120461739795007,-0.020684091650393973,-0.041757899893967027,-0.07280371538665234,-0.02600684785540286,-0.08078713859333266,-0.03429080752377078,-0.0010764926794965275,-0.0051774348501249755,0.012920289005028007,-0.03453535051347558,0.013153325629365822,-0.07330002051201392,-0.0414904751067037,-0.05858098551353511,-0.03257886694080544,0.04471729718387706,-0.018635182776052646,-0.04197549404585573,-0.03147098212269646,-0.0011427980955584186,0.05787046780137799,0.04171646012135628,-0.017479673683613382,0.000776511894984215,0.03831063137905016,-0.05842287530393902,-0.003519420876094792,0.03687490808882546,-0.04779029673053682,0.09432613093395842,0.08464756241176713,-0.003500581937036073,0.09414816914116574,0.09038010301718041,-0.0629712200371365,-0.06182111939479766,-0.07006566697949021,-0.060899632334510075,-0.08898107735744225,-0.0220957785108358,-0.06070053879339292,-0.0394313589084657,-0.03428844322771976,-0.021763097105725868,-0.04644546835967237,0.052014911662604274,0.012004608555157337,0.022722440485535032,-0.023859246067619636,-0.016503662138881423,-0.0038843453894978706,-0.016131206691286495,-0.07167346862287265,0.08074044174286078,0.03697889561381334,-0.032836302875487104,-0.03964141322071275,-0.10007093324399664,-0.07948206744217362,0.08215379028700984,-0.040082265874910025,0.018921533706361102,-0.00538429065308605,-0.05557826727892366,-0.031586459540005274,-0.06091125455403315,-0.002668622939462164,-0.07787012531225657,0.03660386047464617,-0.059327729018914574,-0.0317240857278293,-0.017838897247816104,0.012998897629737188,0.06467168494155334,-0.09186407788594629,-0.039884590923825174,-0.07280326973003202,-0.04340846798738698,-0.023694919311860973,-0.005144142657173151,-0.05993335346625802,-0.06403013090894953,-0.05109397896106502,0.052972667195932195,-0.041011939178400285,0.050921221052885456,0.04731509187974996,-0.03212556879980636,0.008065459050098785,-0.037397803940213935,-0.0163941363998913,-0.09308987926121232,0.009211670157375989,-0.029665691848185034,-0.055459149846157164,-0.007635689359195899,-0.014495367132533174,0.0026189084788119914,-0.03401299656669007,-0.015208810403958889,0.011492361027351305,-0.01112692169863027,0.04401477796518141,0.019838948822954245,-0.11197243248187086,0.01366832246944123,-0.03692320638719548,0.007889056957304146,-0.018177101936628588,0.07518060910736543,0.014739349393306546,0.008560324724611759,0.051786435955314555,0.08137019325822278,-0.11821032260793163,0.004473062611846125,-0.032917076427375215,0.010026647370431548,-0.03389595204340501,0.0335687234850989,-0.01802810816595651,-0.01773960669272065,0.03737171594395851,0.08563364196217127,-0.10225416655581784,0.003985817497241768,-0.058432896739502964,0.025477459416462952,-0.041759208959767785,0.043157538752963624,-0.01672380923253096,0.06346332869314675,0.029340711601081475,-0.03356282372949613,-0.04508937716496031,0.016250225781247796,-0.015300612535348429,0.04202977210533357,0.021283566602068166,0.06812553753218879,0.02050681314817067,-0.11483932719261686,-0.04992520649758398,0.030678528134650624,0.0110118214572762,0.07905210195770347,0.0037854848435306745,-0.030850425465139268,-0.00836597345543757,-0.02233127196592535,0.0480278560828041,-0.0006257453887465927,-0.012295681373187992,-0.005123301360320262,0.035499685282083165,-0.015644108135024225,-0.0011702142876125119,0.027811994090940723,-0.08160712997072088,0.0529917032055631,0.04708420800090746,0.027720901473732892,0.07198133297894775,0.06270672957391456,-0.10709019047329867,-0.07847471838371246,-0.05570119916876546,-0.04541729680907115,-0.11447285705314897,0.0638163199486916,-0.004579717902292253,0.010437978925052698,-0.027740009156604063,0.04778115877650762,0.01327288992299449,0.013581762630891362,0.022694366819061264,0.011123648388939426,-0.046992907068826584,0.018860390485055195,-0.044472398171300435,0.019274794164806666,-0.0758151618857976,0.08266124663130245,0.044952170319805626,-0.03787553517291506,-0.004429848278915949,-0.10048411433485153,-0.044757808374116935,0.0739018611810244,-0.04182280043492358,0.08290416654211623,0.048141615453241624,-0.036640488301359166,0.003407910997229981,-0.05337009436242625,-0.009145343559441138,-0.10095908971957253,0.05339931719506889,-0.023747754368149968,-0.10198927959554356,0.009948791966037594,0.015385620762044137,0.06703982558636941,-0.07517591175212526,0.06507955401697772,-0.06958444529475279,-0.025678539555693332,-0.0012663420050461139,-0.007841895209363665,-0.1082404531071176,-0.11406961856031139,0.007774095946896172,0.014758149855982073,0.00495742144096142,0.02769001121599918,0.05135684235682766,0.03517311869402216,0.029448945435404158,0.05672844040626529,0.0069821407256833185,-0.11720922799328957,0.00544036045867508,-0.0019004302155458319,-0.10495033724134596,0.04367816036390926,-0.02792022663538578,-0.005390001843493851,0.08051109527890164,-0.042178664873419695,-0.012689342918685717,0.04683059912523386,0.07422720906479177,-0.11199379165398649,0.03574471611561533,-0.05043082314046988,-0.021610543922433494,0.033816439368742665,0.07535261689441954,0.012974184055180091,0.006089167801281746,0.02636335378368482,0.06918129695403387,-0.11409444025553833,0.05023852727143977,-0.063138822570787,0.010896591204894874,0.03606052234144723,0.07754964664662946,0.016105127430319298,-0.03169540851414678,0.06121512701593387,0.0779648249098527,-0.08142292295020281,0.050350586204091316,-0.04180668071143681,-0.0026175912832158846,0.026926256464052823,0.0842035931605002,-0.003956856784278965,0.09653532816338249,0.057783900648117385,0.05294008626100816,-0.06134423502611318,0.06094131870331955,0.023945754734226016,0.06825004352962159,0.04340388666506536,0.08191896333845186,0.024184773010020852,-0.09031639742517442,0.02965955234708202,-0.015118247775687505,-0.012304135872250547,0.05510719150735151,0.05621900760421701,0.01907826703676117,0.05369417548475337,-0.01074944081875085,0.043943332063858656,0.05019725965140213,0.01671625576175734,-0.00014927954806504204,0.042813878808496714,-0.03921031631576875,0.07744750075562205,0.07575927549364302,-0.0034944185336615967,0.05331213358468338,0.0656535919566594,-0.06710221764935288,-0.0696485232659194,-0.056228291591527375,-0.053223794325127936,-0.07929536564142725,0.07051938022447943,0.018637865376737457,0.05501342267514775,0.03908468819033264,0.08123141183369235,0.05705629672472774,0.06262771557536335,0.03299132651281594,0.04626104076744993,0.02612849156770844,0.026908517611603153,0.008599219200520111,0.00875909614820536,-0.04300787004894621,0.029708896961328744,0.0456345668468486,-0.016128945756378268,-0.08621238775485997,-0.07944320481545995,0.08354026561993798,0.0064090780996329776,0.04878189435566079,0.052623121441406885,0.007347130541416011,-0.022302991240576775,-0.06623246898770416,0.023909149323287655,-0.05493012102675957,0.06598285495547625,0.014125716025911733,-0.08934449997460182,0.01494089544038478,0.046922208250445865,0.06697019419352837,-0.0627746117791018,0.08767074213824413,-0.06367549378213827,0.00016361586332226628,-0.014082946099889398,0.05276573010740827,-0.10810756227357211,-0.081816088782384,0.00440268878281937,0.04655319953160671,0.029342247378740017,0.04265460122768292,0.05217851053626081,0.04808406889663652,-0.006366510693981881,0.06791278373924141,0.0647173121748952,-0.05469235136543198,-0.09716231907995597,0.04119200641262981,0.047166493345769576,0.034416519550693025,0.0817812209007156,0.0448137270840228,-0.0052432284436802245,-0.026959207353834367,0.04390922093390541,0.08943130724697737,-0.06797813819307195,-0.00813508871162559,-0.051438218748800724,0.019722403063652947,-0.007298651105683382,0.04920879290641339,-0.016025589124924994,-0.036009172550101186,0.03270956487718278,0.09044674587869773,-0.05811989589235903,0.01681240522033946,-0.04491179215882304,-0.0011534940113243298,0.04266750487764557,0.04145989154173247,-0.009670284799200258,-0.03538697619746685,0.05825767055500247,0.09510999484197784,-0.08466140929041381,0.01451762962199542,-0.06876412257347983,0.0036483472774921847,0.03128038865614997,0.04693447764927395,0.009820415984285834,0.029772011451866597,-0.014550087117587754,-0.006242894616226434,-0.07537087303456513,-0.03717257561222686,-0.02921910671072763,0.04991182569215494,0.01641682900396349,0.03225748400679459,0.013743619575462803,-0.06590346416227841,-0.037224194749850295,0.018166584779387596,0.010578389623512938,0.0935141877808144,0.02478834401753448,-0.0505919745237908,-0.019767143685258875,-0.0024715338801271722,0.020469990181596794,0.03576414908416626,0.059505383426071264,0.018671566784571516,-0.06858295966984965,0.054685717353378835,-0.0663657149179554,0.12093771320588367,0.110087959816201,0.013633036384856393,0.11187212727262826,0.11177455602741461,-0.07226339074563387,-0.06147364353704061,-0.06907118590478711,-0.07891772359686752,-0.021319914749080873,0.03660868866222512,-0.02842624544844012,-0.01609501128452834,0.011679784739273854,0.043001764321025676,-0.010704027274329498,0.0496809314822259,0.038750558998345244,0.07378113076513639,-0.00677436582425783,0.0013817209989367884,-0.05294283303238482,0.016401233253846167,-0.09424473738441422,0.09596838529984429,0.06466903501398788,-0.021688744897489117,-0.010301489403096874,-0.06928783138946372,-0.07089172036534465,0.10802072261335821,-0.0062002599816578085,0.011232691411317795,0.02907847054937624,-0.032547696197740554,-0.007012084871897741,-0.05473462687972172,0.023886495280647038,-0.08049145409626296,0.10489666357706434,-0.05786325747756466,-0.09276026602348227,0.0016941923826367152,-0.006743221619179279,0.10647903482190109,-0.07739448719010668,0.07526281602266381,-0.06048470644285887,-0.04694656092120155,0.02905800251488154,-0.014543053308022967,-0.1034340345414942,-0.05758619560902724,0.007256973090775032,0.05854759049961431,0.018940526464936002,0.02242969020770863,0.03448375846046946,-0.009103374672015047,0.027803931207727006,0.06586441691322532,-0.03785883110525702,-0.09450676405187508,0.022212112192904556,0.03207111617488197,-0.07023828969686922,0.007679603250237495,9.843431161122178e-05,0.0002524296179247595,0.06694356304162934,0.015734042643188267,-0.0028723308531148762,-0.02373966427366397,0.046546880579610116,0.10125192906605729,-0.10625003173534095,0.0019264854223098532,-0.022397334123926117,0.026276870238853178,0.045906776266212666,0.05587616795046257,-0.010349343012889657,-0.025531639092221288,0.06315713915398333,0.0980845643893816,-0.10832557390504038,0.020566137350369332,-0.07154244762117755,0.004223757136548197,-0.0014172084358420143,0.06563353193130642,-0.01052636283943439,-0.034177626086155564,0.06947447701855522,0.10009237738906425,-0.08371867109001349,0.014102816453201411,-0.07113658272488352,0.000937173755542993,0.011401939961213546,0.024336092041916207,0.0025231201558835953,0.06934127535711729,0.02451677971013365,0.034899646812427805,-0.06991776483347399,0.022291204740637564,-0.012942368945247742,0.0631480533462558,0.01588392892119734,0.06922648431844643,0.011107576590503524,-0.11106307915558376,-0.0222620507895901,0.02188119543766107,0.022331069112265456,0.04375364826225788,-0.03324371330534009,-0.020539173005264394,0.0017265729506892305,3.3721015713482108e-06,0.07254470941279202,0.05894112043366498,0.005594917150236757,0.00769758337342052,0.04961470144063172,-0.0033454389507513254,-0.028606517555650673,0.07272832774890799,-0.05538890447121117,0.1026042735062804,0.09221921525281179,0.015653584877670757,0.0905082880342149,0.1100422414060318,-0.10389700772702079,-0.06245985431155762,-0.07586758962042382,-0.07738298985069518,-0.10859685367268823,0.06623019687071563,-0.04052397370316667,-0.03280912182766558,-0.012060150536900108,0.055308991433884215,0.023129878538194697,0.0766245707154751,0.03352661750091458,0.06571157951828582,0.01366174001040496,0.012219986132635509,-0.02287325131699923,0.029885751201871386,-0.05426941851167664,0.09145328879773343,0.07621200582263873,-0.0017843098367549665,0.009152124402044182,-0.1149627171039445,-0.06113609002153992,0.08883316255976983,-0.04355031829338439,0.08495803559986112,0.07495250243006166,-0.04998612995701034,0.007488367883623799,-0.0686513575792853,0.03990576710375876,-0.11031162425991538,0.08965059569238797,-0.05862920652790641,-0.11704569730764587,-0.011393911261045605,0.011894227721147132,0.08999840731442946,-0.06168000863405421,0.08622522450552271,-0.06607176107167152,-0.054170417007955815,0.033495809962158965,0.00083825171544947,-0.09498015194844558,-0.11885429945763652,0.001678709542443516,0.0346040602694948,0.0040097107992208645,0.06061316315317241,0.08460600796637763,-0.020255017038368364,0.028189021624206164,0.07176967980233064,0.012792687915236212,-0.11158729537542379,-0.005227237273705643,0.015141694330564342,-0.0655056789774483,0.0902835734905738,0.008899031996805182,0.019286113352662886,0.04618598062350284,0.01657721479126508,-0.013580215008401139,0.0053120531283163295,0.041775742932711774,0.11735314428188115,-0.09329496692166721,0.036240356374513005,-0.038010179338968705,0.016804865029328188,-0.012005806059134568,0.0794414661764869,-0.0337604485332179,-0.02759836009569122,0.03221796952109352,0.10007855919021215,-0.0818090402573108,0.04794384820644225,-0.04381085251480478,0.03342042888861714,-0.007856874590664734,0.08236340060218098,-0.021828305128374137,0.008871832139198328,0.038363799883704225,0.0819509274789046,-0.0733432800813745,-0.009160557562231011,-0.04441430882197199,0.04847554421279191,-0.012362351239374417,0.07775659639408568,0.009546460644682517,0.07457444667369893,0.018153689043490618,-0.006511672502591375,-0.0482976405200522,0.022565085561183,-0.037939293386827416,0.05408083424987609,0.004669463482840082,0.04474727747348374,-0.012348413365694163,-0.09755993884709224,-0.041597334679468204,0.03445564146942967,0.04848590100906045,0.10311757331728306,0.014750256150091335,-0.023585227171580472,-0.026606874114255247,-0.02677825063637778,0.06833146227993092,0.05815616965891515,0.03811147381108542,0.001660917834178746,0.04715086087247712,0.0012334035493704136,-0.009045788657965147,0.05818743295641414,-0.06736508078872386,0.06975300423421865,0.0939124769748145,0.02351590765265456,0.09870217964549302,0.10993916752855107,-0.09310576166283095,-0.052660858631691745,-0.05499953980416613,-0.05975277715596147,-0.11690145672829216,0.05666325100008388,-0.01741951931719915,0.00029706257674360037,-0.02093776796813929,0.07478297502901346,-0.036147002702349176,0.06792332857551653,-0.013179448273197078,0.048429173747185486,0.004264144470562227,0.0022664578038825265,-0.018415582814942367,0.03155510346610328,-0.05559105732955573,0.09716564022441275,0.03898044412575811,-0.006838172773299614,0.0045211297078101,-0.09834459927936655,-0.06677535108168092,0.08423668663286886,-0.011396970058312316,0.09153210004716442,0.07577997560332678,-0.031448264079557045,-0.001404745621811721,-0.04747498431459187,0.024941306307971835,-0.08364799302919608,0.08734415468891846,-0.043584687425744076,-0.11440319796856245,-0.021682095833226753,-0.042420527743578004,0.102215994501558,-0.0461178080131985,0.06969038352335204,-0.042160285181647814,-0.04508676567274925,0.00960420525954117,0.00619536452611057,-0.10012240991611512,-0.1050672504371741,-0.003965407492939926,0.052357401074630126,0.029530275495184437,0.0540023862327508,0.05608833374923425,0.002720357572517915,0.024811931580100817,0.07273195952523318,0.04336653910485416,-0.10077784024625033,-0.020601828388878796,-0.015675224958109468,-0.11357080889158773,0.03828808290021864,-0.037576039687254245,0.012235966278896854,0.027334631248611175,0.017934780160252753,0.03701421232953129,0.06813264155732186,-0.07223799563735629,0.04783654345982848,-0.04719012489159974,-0.024289458778030865,0.047697035724477505,0.08283649705092234,0.013029729551701145,0.02038808780303967,0.024227975938639814,0.08257883759297889,-0.10243321908386768,0.04990493453065493,-0.03968409115150029,-0.007912367581145857,0.030056948329457177,0.08872439700801074,0.004208726925927249,0.010933317913184188,0.0509055050921873,0.07156286690670273,-0.09946770790848129,0.03235122515453415,-0.04546881318487216,-0.010993008903568968,0.03183441329630906,0.08563345379246558,0.0009185938689611223,0.09495454996917166,0.05336535139549943,0.0532027270308518,-0.052967515428561346,0.03034568304819928,0.0057542842759355775,0.07949815936596669,0.014703259273104589,0.08646362031721033,0.026491363391444887,-0.10596067147939058,0.018806637829489214,0.010584693002104944,-0.02289581934391133,0.08284343730356483,0.06413062591963843,0.025379225130153543,0.005312371030560285,0.013591069373512794,0.05906490408905164,0.049232735306491346,-0.026023138273346874,-0.017858468379586507,0.051515135679600386,0.019496196203011813,0.02859193440904688,0.043332233657016876,-0.04262259036618697,0.07081616967161944,0.07734219068730129,0.0020972107791289497,0.0897621352936571,0.10801788450144595,-0.09400440888396198,-0.0649930993020892,-0.04295438340418402,-0.06845778920635819,-0.10223086402131074,0.08391052445138882,0.027484733300442116,0.02380786318995079,0.02120792184360195,0.09646088809102969,0.013772169493985872,0.044271701199220095,0.026514237691161697,0.05512554127751356,0.024621833049639698,0.002582859596523217,0.028995824569261874,0.016788189833937033,-0.058005153010014805,0.07912138034587089,0.024252246279935732,0.03232488789834432,0.0045917642594082075,-0.10620232180951635,-0.056719681596305964,0.08507215409336356,0.010399861040538645,0.08236301087150562,0.0735335684160075,0.027508586392175377,0.007932099801988335,-0.05880805284589872,0.021112395895073032,-0.09970903835825118,0.07485443840094277,0.019324732560802037,-0.09702045168122053,0.008432933830597369,0.056046599921637255,0.08386766204747961,-0.0680839400108281,0.09404105312126326,-0.07350225326289342,0.028551868014381004,-0.008024679991743148,0.05697920615762481,-0.10618988779731571,-0.07420905586234983,0.0003267433514565453,0.0649530207896165,0.0018488516895231208,0.07113905700337902,0.04224215846674044,0.01947490644834197,-0.010770051647467705,0.08833067107570555,0.032731607372507195,-0.10721308648710769,-0.006555500169164481,0.012124450518184528,-0.10923045824129822,0.06426341509633987,0.011888001969524203,-0.012805366474878704,0.07754231271062832,-0.0003626116788376379,-0.027410754588190502,-0.04019457203247674,0.018089071403534718,0.06391315340027671,-0.08856516186651982,-0.01441455936794413,-0.027151963731019677,0.02697993923691536,-0.039983989075080696,-0.003333057504683231,-0.027259508949554773,-0.03799956424439556,0.014142680125701586,0.06761777947172382,-0.09572624017058824,-0.05003441329778224,-0.061288337188046556,0.03276996396136079,-0.03114066813125801,-0.06905578965724134,0.016437780459031746,0.08987708492456514,-0.08176611662284844,-0.0012274145914961346,-0.07629729504925081,0.03037640310301459,-0.01102534191786166,0.021308186512042696,-0.0800904398824091,0.014822824073591517,0.011002239723282129,-0.004020895688189848,-0.0689016234919966,-0.03157727461309843,-0.01709182583814473,-0.004814076575382666,-0.06056801052620194,0.027128463917868415,-0.01640662739339641,-0.10830494346184931,-0.02536146683028313,-0.0019889936543599405,0.011387545115631888,0.06342984314098989,-0.007341219206397799,-0.037472138460795675,-0.06334341924928971,-0.0030091643845742587,0.026370215082191388,0.06406600836211387,-0.026375265951700994,-0.011721206288657521,0.01728113085733651,-0.04291049351003082,-0.06484686031479175,0.03882325682188162,-0.06358003619747059,0.045744508149445584,0.05169598578097008,0.026506967648173535,0.028202332668317384,0.05334372146547964,-0.0645670966168339,-0.08489762729644082,-0.08731527588916284,-0.06915681154702068,0.026441705356247108,0.002381153397553079,-0.0575553248495841,-0.00807783964261538,-0.06936014361776946,0.06987114045403439,-0.03239981421001125,0.03354667252013256,-0.011546451386653616,-0.010619052650999708,-0.04215654774322953,-0.0013557481637221688,-0.06250428142734478,0.08757095976197171,0.03461812486080777,-0.019812296147949188,-0.007355501768986311,0.003441477959235839,-0.057772305102541464,0.06460779678007794,-0.030322945025615878,0.052060654993362356,-0.0028584456893847605,-0.03573109951652088,0.03471273296215727,-0.07654372459528348,-0.03183123098731582,-0.11223938622463825,0.07956175091959262,-0.02580635297649074,-0.1043674021505808,-0.04516994102373763,-0.019228360754953936,0.07587768329117338,-0.07136508490035257,0.07300076428806702,-0.08425825660985653,-0.021183834752457335,-0.03498933258391516,0.00083852593295071,-0.09445027235823691,-0.06594065905102847,-0.018994801526191644,0.009339232403239865,0.05600080961304759,-0.04014184973122911,0.007388650001760853,0.047397691915384524,-0.03586234828433015,0.02915747117614452,-0.1059078547675769,0.005691951044403723,-0.011488126387713677,-0.03583501765860309,-0.00330406001335607,-0.03897219412392772,0.008434275918293538,-0.04407366502263773,0.04910162760932065,0.024028925276735398,-0.05675146836424483,0.021098533744846416,-0.081378783257846,0.010607408819773208,0.039401507894349604,0.08558579795168259,-0.0013703160350813095,-0.06493117035897508,0.0025683707498208304,0.030983222032152858,-0.11540006223294813,-0.006329816626357478,-0.06392069223694334,-0.03541785573080324,0.001765235703263527,0.07515914507021976,-0.010646471749692145,-0.04710239246783626,0.029898680392310053,0.017270201631891205,-0.11027043935484222,-0.03298110259376082,-0.0858787823404231,-0.0012073043428540717,0.019234191866335792,0.06456782851764442,-0.0011672857503784628,0.06352180515227879,-0.01272940779927146,-0.005700028264231874,-0.06427113652281344,0.008974573454312013,-0.04180062910131312,0.08370145384864318,-0.0030144934924959087,0.08938549770713163,0.0011422344521985414,-0.1075874834098961,-0.03668773272511863,-0.01959252628373456,-0.01603367731141491,0.013576855888475745,-0.009757101912479277,-0.043237005059108366,-0.005321585013891725,-0.014971249930490345,0.02179839063602397,0.04264075406355601,-0.01895517625993181,0.025233613993012168,0.026417990030439646,-0.03886568391752267,-0.04173126845571368,0.015424910448151908,-0.07824167805144952,0.03354050707018383,0.01810075990855821,-0.017983374172630354,-0.0011883381953288529,0.030051342213188805,-0.11501167578213418,-0.08289937414597512,-0.07034883297278337,-0.05280975185851764,-0.09996176113098691,0.06957542121488887,-0.041417401874058346,0.01316562771232915,-0.008410437034040113,0.07715577925420405,-0.027638947959293,0.038676778133640115,-0.0006311257910757584,0.055795677962618084,-0.01735780821386344,0.0044205182494403104,-0.051505968844986205,-0.044491327137929484,-0.09091177883731334,0.0594043742880619,0.0360307567934734,-0.008742213141681391,-0.05097571306156821,-0.09387220269318701,-0.09586114483144936,0.07649705321072607,-0.019072712789785243,0.04169442337289245,0.07379553921283559,-0.06859020453115917,0.0011850947705761335,-0.07011610626460603,-0.0020514045887118594,-0.1128098460880183,0.004424506764275036,-0.05054724570017549,-0.09385951376150263,-0.040676861991863864,0.03161808016131802,0.07196264447663377,-0.09712142963523335,0.0741246997218094,-0.06361667312611143,-0.04248952336892439,0.010950093937749955,0.0022952049670461943,-0.08063377457711622,-0.10640808896764672,-0.014430510046897393,0.03861948050004034,-0.002492147525483399,0.025559947656273754,0.02955317933178116,-0.007481918815100933,-0.01653929042993276,0.06401610966372352,0.014281047227581401,-0.11181171917050842,-0.015231811072792936,-0.0018253252148113402,-0.1256114218997594,0.055983690623666586,-0.02664847578970252,-0.043655180206273285,0.01780906994276206,5.334264216144781e-05],"y":[-0.07668477045855053,0.08819202341119281,0.04578922910407929,-0.006322342244010379,-0.009995269863483616,-0.024290907694817877,-0.013992441844547716,0.08938012277531007,0.002105518052266767,-0.024925714346058163,-0.059606255295035625,0.053784613806694186,0.025772279030114004,0.014223614942189886,-0.0036902873362238612,0.06894730554607713,0.016115574955639794,0.05743772702699065,0.06278395160753064,-0.027945643225885403,-0.06963466230650191,0.0472835425235513,0.041302834825440594,0.024454134189962284,-0.011401806601529212,0.02816537314321268,-0.025039849100680984,0.027065340450884094,0.035694169633358155,-0.03024453312793142,-0.0975401830098401,-0.02215825636848018,0.020857096640558105,0.05073735441730936,-0.006880071178772666,0.044354652662887406,-0.05560670579154298,-0.03244516391887906,0.05254616106227343,-0.04353982592063978,0.04899676083273098,0.0037217131967729436,0.04316545678539602,0.047407632193045356,0.08094393722026068,-0.005325079801598644,0.051414464404012594,0.04885624781950317,-0.07472319807635042,-0.07514460473668826,0.03343155714040539,0.03521387045986655,0.058986534745315664,0.04592793760279581,0.042857371148366505,-0.04811721683561091,0.04436755503095041,0.05272073521599444,-0.0346539405399698,0.038649029200663355,-0.007454855954191696,0.05279913740494803,0.004421335817089717,0.04133261709259792,-0.022379344879849133,-0.03708347800618382,-0.02575679616388098,-0.06047689752475965,0.024043618991648388,0.08199256567321693,0.04931754295974951,0.029121741426891348,-0.07208597531962758,-0.039535545387379925,0.0029537774725477556,0.0429836633501418,0.051024869376686766,0.0613627349170151,-0.08283654820587667,-0.08659682842935996,0.06782262180085993,0.08370048405743225,-0.0213931885908251,0.027754096064986425,0.015871360197382188,0.08856662963436072,0.021312505252946257,0.05856164776288418,-0.0020192277278194247,0.013855371522696523,0.06204290687603336,0.06501850298772377,-0.04032220579177079,0.08610806843966456,0.0752362679760628,0.025117934375641023,0.04745989992815977,0.004053665749169854,0.0271991509922319,0.08203073533575087,-0.012809616407691118,-0.08547704633232373,0.02206553700202562,0.09722379286968884,0.0017717612399423131,-0.038563774172128217,0.012282034675851452,0.04293350775157488,0.051215619859334774,0.034483611929094334,0.012189612801384652,-0.003804921098499569,0.07599285032352614,0.048050763860326216,0.05108488912881924,0.03610787553209487,0.02453305649082122,0.0702813268967633,0.0692800885022528,-0.038421774421836766,0.021154670950039107,0.05426342716558402,0.0803497633927823,0.06549474250376242,0.0019442553372189886,0.008784526640153658,-0.07595734625084836,0.04898489692353778,-0.047690041870304886,0.06787484311044954,-0.08790451638260878,-0.008269201311846476,0.03662697693447653,0.05379023599438959,0.06538980515134274,0.05844360598434901,-0.06050666869455052,0.07723770691875946,0.02737400673421674,-0.04828981513216414,-0.07768140350461294,0.035241464403796274,0.05221027385579854,0.0035450431183446087,0.04938397928830692,0.07562729481972372,-0.03404830498906409,0.0867432213332681,0.0075953868648549715,-0.03982800137009315,-0.08061309101414758,0.016611190378657603,0.0623770698187306,0.03812943651513099,0.05543429502710751,0.015534207939065273,-0.020049592250266805,0.0837421841525616,0.05485929632547786,-0.03880306110560906,-0.07497719972385641,-0.025732411791298284,0.0670427414657298,0.04985933087144943,-0.053778693502439134,0.04710050235713797,-0.08179722686232076,-0.04158273143199059,0.033423156017217945,-0.04289176109423337,0.055916910735353084,0.05611631752429048,0.020125921591632387,0.08519739059462558,0.08337596927988679,0.04059560036392238,0.04445646789414789,-0.007563671881251408,-0.08842880978473448,-0.05667620965756107,0.04507334924170559,0.05592760391282232,0.09378262612149768,0.010544968049291946,0.025097992406805467,-0.07741043107720494,0.03573817363190431,0.0416382976185728,-0.045274636074676244,-0.0070142992691212954,0.015335005245827331,0.08941316168184929,-0.0021850046853812127,0.016198167596314733,0.04771093929185183,-0.014688815614301156,-0.04573530414723225,-0.058591903209065564,0.05687851947403309,-0.034243667639216935,0.04543284959108579,0.055279552169375246,-0.08904130859154477,-0.014181011195048257,0.0225325421178519,0.0548913365063704,0.06472120957542428,0.05600836971044393,-0.05711319916024774,-0.07418511204644057,0.02816500896556758,0.09936858829290361,-0.05553546597691559,0.03303853593972932,0.04321708135778325,0.04861985625555533,0.08425445458345353,0.04410329198835007,0.007677646733852405,0.041177649299750686,-0.013690150719399854,0.04946453729627825,0.09206872248357052,-0.0021114289558605737,-0.004882556485845163,0.05304713410751007,0.0425765556449121,0.049917354720405316,0.05811872384005849,-0.09162612721878921,0.04997804995020493,0.04216471561234391,-0.047181913171510596,-0.0306646651039976,-0.07787330544878839,0.045031543142295995,0.08862466081063719,0.040884403797740665,0.057217683511750786,0.06944574320603868,0.08702042020933144,0.0012736942911901793,0.06859146831688698,0.008828026899739798,0.054266908345032096,0.05001365820172408,0.05690451631065057,0.03898676528836033,0.03633564238007045,0.038252180063039654,0.05882819988129566,-0.043012947643813124,-0.08427606430122128,0.018030459632217263,-0.026192112682837193,0.027781559860255607,-0.06695953117365132,0.09011559065824103,0.023588724418971873,-0.0063676983288104335,0.01299427284956756,-0.037280106305663606,-0.054527108524812955,0.0944053944041711,7.273626485865152e-05,0.04099237918173241,-0.07495084246371106,0.07962617071641227,0.03268725167083762,0.0115725381083883,0.022212737903741262,0.07540429416471936,-0.052690894641158885,0.07642968216841113,0.042912055219416156,0.07367153802324654,-0.07491397541981605,0.0774090193264745,0.02722122626950563,0.0035216025373769463,0.010730160798332541,0.0005960145684482453,-0.053328080701996204,0.06318165852204057,0.03682804793990213,-0.027495258260523132,-0.065793774691492,-0.035011204789240156,-0.013455146909870484,-0.04345230041864401,-0.03268094927732988,-0.04987292519786009,-0.06764766075109076,-0.01947683896651701,0.013703124787841253,-0.04764584824011287,0.013618723985852602,-0.009452126938663725,0.08051503579455413,0.07626170504696786,0.060552246161528586,0.006581179032509463,0.0011734621439605409,0.0727878953160105,-0.07379510144903262,-0.09069792234502128,0.012735460406684796,0.027777335860747376,0.08342113427702666,-0.010473809500045438,0.041495742018497594,-0.07692309693671474,0.05207980779479251,0.02088227114456738,-0.04666042224317076,0.019945888797672565,0.014309321657913257,0.07204598401199142,0.0045859143583296975,0.013446900689911381,-0.004008274921976115,-0.05963129456214147,-0.051974985201203305,-0.037133183154770634,-0.003347372872656343,0.05124025886771609,0.0867852539976716,0.0024882707307955884,-0.07453375353801266,0.06019398136399681,-0.004127217735605159,0.03743453043318284,-0.010982147885340769,0.021419475918991085,-0.08964582307512842,-0.06382338340670905,0.10613841549733204,0.06263882098105487,-0.013916121948207134,0.009026732767316269,0.03139716147368722,0.08759861012093688,0.062446735860249,0.02307928509322831,-0.05916691669453007,0.017434132883832127,0.0973418905952378,0.017458103727712025,0.030552389077212697,0.08806700206409435,0.07502065424515124,-0.03734817198707829,0.024181994274883892,-0.023880278578185695,0.002639804553847953,0.10578906087269559,0.031802003182400375,-0.07291443920430012,-0.038914242842633874,-0.008439356669184495,-0.06229129615162904,0.058936981306838505,-0.054669580328256036,0.056161165654725856,0.07348093180170398,0.011835052815235371,-0.030035675851945765,0.009520075992239108,0.0694813138032958,0.02658103713633573,0.002249909757914781,0.03324536692378826,0.05026915188938932,-0.03805595023223292,0.05346602853173109,0.010601585718897726,0.06139317709790247,0.00017568487618307643,-0.025734787974749682,-2.6975422757943116e-05,0.011571011131171654,-0.02301231407209146,-0.08761939379930728,0.05363878275720493,0.03915589061097143,0.013904449311041497,-0.09130115546215434,-0.0027706203005729946,0.05070955036584067,-0.00013568660121615842,0.021536256013661118,0.018255618267367844,-0.03618177558332143,0.04032412457622414,0.010952834121867193,-0.031291538611271416,-0.09108003528327663,0.04775885264948703,0.014168903583061367,-0.02582954574160608,0.044877001791822774,0.03834041732983485,-0.024897286821299217,0.02819650094595264,0.03899599271350952,-0.03649479823720062,-0.08751189125080833,0.039941167797318114,0.029961639180304513,-0.04671613445830329,0.038571592907557406,0.030025006580129795,-0.033135491283154433,0.025179189365465874,-0.020208463456505826,-0.03778672643951553,-0.059880744356730464,-0.03561196020539269,0.0022997982130300585,0.004785301792255748,-0.03687692388183823,-0.013859496897228906,-0.08174229968671712,-0.03335302862138066,0.0007339248110001768,-0.03941734625143692,0.014041464096425416,0.031714550852652804,0.020170779061435638,0.014257981883226037,0.07183827916038056,-0.019203293599305574,0.024125204837947747,0.037282540546845565,-0.09725970298817162,-0.07742932611689207,0.031127870785100098,0.04021376969375494,0.034621348888697764,-0.0035410159232727766,0.02689518936335017,-0.09582423716087209,0.019908863557705984,0.014476253369416481,-0.02201279784709842,-0.011086635658442553,-0.03136854787432995,0.009261557629092905,-0.031214632494308267,-0.029243225511719702,0.025613058849932493,-0.043355296859763734,-0.0247828271991052,-0.03997614004596668,0.030832038677461412,-0.035935585373596125,0.03841235911355562,-0.01734906947161505,-0.06716606525515981,-0.02085145246108374,0.005950274885663321,0.04557334083545245,0.020565226925860727,0.03966061891550176,-0.08677654479948647,-0.09944330767779677,0.05669877715604524,0.00404819076280824,-0.030104136401949037,-0.025667527289928216,0.018035027556808594,0.05413112656787225,0.06215835544908947,0.0026054759539636276,-0.03612131789456674,-0.02473194002459986,0.04836843284400672,-0.008348160530572567,-0.02817446638902112,0.050734443262317755,0.015714544221311584,-0.04524514108512826,-0.029193825693270656,0.02426923240141446,-0.006725569521230862,0.029672203342785898,0.034728959922956874,-0.08122962853445843,0.019097076111373505,-0.018283926348383023,-0.037284703451959604,-0.03560881491392533,0.022092613424091214,0.0210077593984677,0.031184412363168282,0.014850566080687126,0.01995836161933499,0.022788935643780806,0.01583378578859463,0.022942238487229104,-0.025201356885885515,0.03354629500906853,0.04526247482998533,0.04552943135254307,0.050753235229808145,-0.045367792393124086,0.0121817244579277,0.014004040292875997,0.022604691029970987,0.04365261915610577,0.04398181747400857,-0.03033731536464706,-0.08082075214767774,-0.02755928003267683,-0.04287812065508308,0.015584207770263564,-0.0873925110913066,0.02888541233523257,0.02171586336636956,-0.046021752688829125,0.031958886505396564,-0.017871796602021293,-0.04135064903880617,0.07918497668841828,0.03803848232589972,-0.03227786208942382,-0.07931905087672003,0.022433916502536805,0.03601677715197682,-0.018477507922861673,0.03671739712630742,-0.0499761091857712,-0.05056426766977036,0.09392070195425956,0.01795985364994684,-0.04839583645088435,-0.06503342141878644,0.032020963291778316,0.01852445947558491,-0.002195125559637346,0.011971916009239332,-0.036045566596723595,-0.0609483212438632,0.06949576315563137,0.015293003449338866,-0.029841591855138332,-0.08025336461414376,0.025642563560400223,-0.0023573694528847334,-0.04975333094681281,-0.03924321500082014,-0.03942710091582051,-0.08409414285894337,-0.04254924827152845,0.013114784837056189,-0.01756189654674041,0.029275556092987154,0.01778382692312232,0.02100157051566307,0.07188769195647508,0.08590786289809739,-0.015521792780482236,-0.04092310929131234,0.017789845530990937,-0.09006716758315675,-0.10770839337210819,0.03900504645235748,0.027440759872562167,0.07199528797242866,0.005829503120563832,0.028149894449074474,-0.0764288298428312,0.01822980598433823,0.029290343471262227,-0.025482062898296753,-0.024455872333332466,-0.03356377826615102,0.0824858593337941,-0.023753010113364142,-0.019606538823633814,0.01668864454879023,-0.05273817626870925,-0.041876792120105394,-0.056329902641867075,0.042664179549878674,-0.04807543779584647,0.011070307379129382,-0.022444013350712916,-0.06738832127235404,-0.033293324240124,-0.04637992002805896,0.023217149415665626,0.01136795578313486,0.017974958630725697,-0.06405679619881702,-0.07234461264203192,0.02754948681612424,0.08882895430148194,-0.041946831002423704,-0.016007284490479324,0.007334130046031642,0.025297135085099114,0.08870738096997263,0.03217324533766148,-0.017214484431679087,0.0019733472500738985,0.013647139461755296,-0.010960151640962928,-0.05091237412105426,0.0432012291098152,0.08267918764047202,-0.04975817406379787,0.031134491535342763,0.014754127611005058,-0.010179363452763959,0.05199786566825862,0.020711224018901058,-0.0686309172091696,-0.06052047494533105,-0.01866371568920173,-0.04270145737656528,-0.03761903058283155,-0.047887133942126105,0.03128548564195892,0.08678024550208616,-0.019009296115239376,0.00581791290165794,0.009993600035794708,0.07524898000206495,0.04110169523084202,0.016073749515715805,0.04296526135921095,0.026771093485309882,-0.003272986433727957,0.0938719899246984,-0.0416740123223082,-0.045124709499167116,0.031249183124027927,0.012827215664472433,0.047465701271188876,0.023733571825290265,-0.05742954495030734,-0.08996583963760854,0.033078476488914293,-0.038150397489423754,0.0324752470629361,-0.08507977914088136,0.10905680836836427,0.028733909042154754,0.012428904320060325,0.047703730906229425,0.0004112246857929236,-0.043088812040469535,0.07603015249394994,0.001964341962451128,-0.0032254387593118137,-0.03844391559145313,0.06949664481633737,0.018250152860330854,-0.02375616531814905,0.04315442622908174,0.005720086413871791,-0.04767734206544949,0.08091701110109496,-0.00820435183581038,0.000326397916154488,-0.0761060373526139,0.05044218385742624,0.017692870019265675,0.019509147349218853,0.021300982766426706,0.01727432812564955,-0.047269537188954276,0.05720763111455664,-0.0069254134435285655,-0.021752988862416986,-0.06911925342547347,-0.005249932023530755,-0.005638415133347422,0.06018693353010503,-0.0645985768536454,0.038529285381101445,-0.09132093244358623,0.0242368151118829,0.0166825263326776,0.0016955611844524773,0.006352575295447534,0.048388442837667536,0.09384573315787743,0.035083793765877926,0.03956558204657885,-0.019605325435211714,0.04469869067307393,0.08337794105236082,-0.08114348297170323,-0.04502468807661636,0.029879415499492707,0.038898008204581655,0.07032591429813399,0.031168115293556772,0.03989753043108843,-0.030157050834886154,0.1016704422843919,0.01886865232538922,-0.0642938944979283,-0.01899281500103015,0.007119106163356918,0.07356964285250196,-0.018256096807778312,0.02283745026988138,0.0299178410405046,-0.0511716860780198,-0.027407215234212273,-0.05517927622293607,0.0330025575660128,0.007929673533574612,0.06232276605322362,-0.016787191158077197,-0.0718775376694529,0.0188673641014885,-0.00048259540993580416,0.04541707095845045,-0.00024339782398092092,0.028722046793843423,-0.06310129290215494,-0.08410450197121237,0.1099237393466881,0.05984192248854431,-0.05461827155376063,-0.0018053880265468097,0.0013848489551136435,0.06531730374500971,0.0456019375770616,0.03321226355998641,-0.0277120156459602,-0.011912254990475884,0.07300665861400996,0.02112506408749234,-0.0032799008567154114,0.07919757190989352,0.06399574811607123,-0.05938696521449852,0.04069515067070407,0.028699503434184228,0.007406703847384107,0.07550141082556677,0.053067274461972506,-0.08189534348048627,-0.020083013855554294,0.041982010033154396,-0.034529077892317746,0.01761887939010728,-0.025172927562724656,0.0939453760715624,0.05573532809816722,0.05032679403714223,0.009378445323305767,0.04544205050838665,0.03902832693836952,0.045250157923500844,0.043811636119977244,0.035878382358134134,0.04043606558201834,0.03953265495579276,0.08469793238566643,0.008116377207223932,0.007436236635706602,-0.003322555282864564,-0.012227296694700431,0.025303103112747746,0.05118223735664358,-0.007423840743893478,-0.06104514027765659,-0.01170027972600387,0.05022624210126966,0.02088484599448853,-0.0705372180780339,0.11179527841721687,0.04073765833516346,-0.001115351580212609,-0.005499451064956517,0.08448938480059184,-0.07568935401934639,0.07032987917350501,0.0029492090750508006,-0.04784786382019668,-0.09725446236009562,0.08691516757903384,0.04495794656906064,0.013142740489170912,0.023108432114185985,0.03883805523140489,-0.07085558889703875,0.09027184001304142,0.021765248513197333,-0.05166850928426123,-0.06412393067417609,0.10978728730296883,0.02588653577618142,-5.2407185127633656e-05,-0.002953220409081841,0.047951648217514145,-0.037922378148602116,0.09608721489516452,0.03812420088975866,-0.046632067898031024,-0.09238003522461079,-0.054100114540498956,0.09205464493117362,0.05499107065233456,-0.06576364668460206,0.09114317366547986,-0.08560744488461897,-0.02901519418074084,0.0011177180826988208,-0.050444255038071845,-0.0062358326402533045,-0.0055722234571981815,0.043867950481302674,0.07762626497924721,0.07364911752185915,0.005854645849719963,0.07113814047683217,0.08102625514265299,-0.0630736886983186,-0.06102625096709671,0.053320052696205114,-0.016567870560118752,0.07129788388926755,-0.012926525213174214,0.03310764250730495,-0.078444257215833,0.018633208832165633,0.04142186352008746,-0.017830960451471853,0.032607425470023294,0.029479833407814925,0.08755917084399588,0.01282322487515875,0.03434016631603428,0.010313198321254054,-0.043307969711393376,-0.05236823557143089,-0.0609924328906396,0.009580164750545779,-0.058632107187865705,0.0910849219230536,0.05965774693442809,-0.08113326999730365,-0.03671644820112412,0.07377300594656903,0.021800377338791834,0.03365029806422948,0.01446076309923696,-0.044754392026453156,-0.07659970527519393,0.056954496286688944,0.08008174285193752,-0.06539366253917109,0.008588213489225408,0.05503558900783811,0.08398915158910711,0.07482136898160499,-0.04678237448693381,-0.06164934620774518,0.010264380343526584,0.10595399383512957,0.001929910058061415,-0.025560102540734406,0.09500860076308103,0.09010963312169092,-0.06002427104810262,0.021116753857739312,-0.002453579409005067,0.00033331913186996373,0.10880535195127174,-0.010383551825839023,-0.08250815850663268,0.06402875117307012,0.01350248648445977,-0.002528485941700829,-0.04318196292403676,-0.05679591076673971,0.10917774283117229,0.07965571261379856,0.0538099264878868,0.0089269113558746,0.008160274023888655,0.08218811670380202,0.017584716947940587,0.02828105878669732,0.03405333719212104,0.027517068387557197,0.06580600799075943,0.0858126827084106,-0.04746190163142211,0.05750524043924628,-0.008667190594827553,0.020613686770923283,-0.023474138756337144,-0.030527014143649257,-0.056162819775492506,-0.07528067393182689,0.02380434727106677,-0.04039215311921237,0.033547334034013956,0.02941398635132732,0.050995253614443806,-0.02866742709721421,-0.031010993248534274,-0.006872455233715256,-0.06285343414923643,0.04026321947433796,-0.012889992181381541,-0.03594678477415228,-0.0910778064824773,0.034207436370040166,0.002442892758732659,-0.023930087774272638,-0.02043725116441556,-0.04649954341045325,-0.060566241885029716,0.061355441803781066,0.003310981750384739,-0.04787397486281025,-0.08242642751165065,0.027280966222113644,0.05016351596890248,-0.017188624400326178,-0.014848310182440061,-0.04661001596980933,-0.05591014045810887,0.05809475023848792,-0.00856458916533597,-0.028271861337143538,-0.08920444870779069,-0.04495068191131976,-0.05931758433331319,-0.04303323090000507,-0.05779807076160852,-0.05202452758373398,-0.0826292171767014,-0.05196128792731886,-0.013493861799468654,-0.049178640627702656,0.013502324993378268,-0.007532966748169328,0.0029433211604690092,0.06469202019356984,0.056747648523541215,-0.018682970358075902,-0.06325197282675751,-0.0030292423298914563,0.06020186861061051,0.056420893108934764,-0.008301310880033934,0.03026770543042732,-0.08329664405921586,0.007122328512770871,0.04913196861355003,-0.060392063583732086,-0.011064488618670307,-0.025018615299623147,0.061752491081367655,-0.03565098479824253,-0.042252469217103815,-0.019508602691821076,-0.05604407431801404,-0.05483774928455477,-0.05256441341749925,0.0073134617512244275,-0.035138011958392924,0.020447051489575617,-0.03759383248089399,-0.08767649330627506,-0.032542435375948364,-0.04995830915141664,0.020822515480539164,-0.017380717862454525,0.04792950665616125,-0.07097068077334581,-0.08719170311514197,0.01598728922270285,0.07630090019522105,-0.05833808908779113,-0.04878286242114953,0.050858243182532945,0.024622022504196896,-0.048206478920369646,-0.025497361767879947,-0.026794354534712492,0.028146841789003122,-0.03350368435479704,-0.048866889699252014,0.02969917059002849,0.06212324400512599,-0.03973134142711318,-0.012514794600778655,-0.019502977371474297,-0.009547369242995117,0.012352306109302004,0.012536164478917167,-0.08348756377178933,-0.007667377813716186,-0.040972690489400256,-0.05648741598080115,-0.049880740220159085,-0.058136589846377776,0.010289178124054573,0.05512801213726512,-0.0579017475201054,-0.0055493281242590215,-0.012255311958697774,0.06553195306665338,0.030175289306310922,-0.022306562893529985,0.03541307296017934,0.05087769991494299,-0.06630990782765182,0.06258540977369545,-0.0567987570117095,-0.0433196766689948,0.021994688229018244,0.017938045717863213,-0.021093567417671877,-0.07208995437546462,0.002927333381659001,-0.034467318769076764,-0.011813898703786279,-0.07609619656794017,0.06924219007816808,0.023427169906722025,-0.014590007353230674,0.01403540729512611,0.05385900262323024,-0.058490505670003606,0.07848009637612036,0.022104965026954238,0.010495443743977926,-0.09643577470508452,0.07342599037825978,0.036862523178059596,-0.014247563003012153,0.002624398132252559,0.04817533241637922,-0.06925384535596946,0.06948508193855184,0.06686301017255256,-0.023173534224664716,-0.08304191787077263,0.10385006922143997,0.018781102988155225,-0.0058586194508351685,0.0027528495999589193,-0.017587377285444312,-0.04198974651554,0.06346824249955804,0.003964321249931931,-0.022197449715749634,-0.08725942055862915,0.007304851993605362,0.02552955024481791,0.03682155696305296,-0.016874076072049778,0.049566611907148055,-0.093852884205998,-0.020395848504811697,0.009006731620865563,-0.012510841985822129,0.03219484854544841,-0.01936787919636612,0.08423081788859439,0.06662686443871416,0.06464681790281086,-0.003395603211908613,0.010677290786994767,0.094093638969094,-0.06532131281909605,-0.07186161138106041,0.06626332059031705,0.07499567305451851,0.037962839533917825,-0.10061519007502355,0.052474875029753,0.026902323307280478,-0.021069057223486565,-0.025664480053006623,-0.0057177855490055515,0.08421520388127232,-0.022699845547240076,-0.010531468986799807,0.006167836925138503,-0.042027312382811384,-0.024793533293327126,-0.03692288822941256,0.037392352285967316,-0.03390571547090421,0.10579937865007324,0.0035377587025574244,-0.08019556006383581,0.024251092937126004,0.05630594432808399,0.020932323787568676,0.01623464812158389,0.009728868620482846,-0.10318765276209042,-0.11126250226148515,0.08215686036084563,0.06926596247147675,-0.023134245609047043,-0.0119506191807631,0.03679912133148809,0.09994269573427586,0.06676892911416743,0.01259965403473523,-0.040342276671583986,-0.009930594497783192,0.09410085081161072,0.058036986075096234,-0.012194274073315274,0.09816014744287226,0.0686561252055291,-0.04078370575607394,0.021544504209730225,0.03140039192099395,-0.016843653167513205,0.06806312691569749,-0.004616473178338737,-0.07901545787378979,0.015605036191998664,-0.011616531540413531,-0.024597775495257355,-0.029869115339372875,-0.05557145198033166,0.09164248582825144,0.08341172704884882,-0.03807804965537357,-0.029239133626180278,-0.00582233919097174,0.06527545535294925,0.032098173720163076,0.04588654544995521,0.04476232959454639,0.022270673467330835,0.04399789247731698,0.07780697372039341,0.003962407420181115,-0.0033418940467501786,-0.005918685833762968,0.028113988379640235,0.02745458256438729,0.03502186232781966,-0.0027361421537493258,-0.09587186010244828,0.05318022866492944,0.011513671176558144,0.0342099990844599,-0.08222434148338031,0.06399502591660328,0.032692614795039404,-0.017484370550723237,-0.0005746405510136329,-0.04893637846740676,-0.07012656939141082,0.0811911320825802,-0.0024379640481070435,-0.057627541434873725,-0.06473975023658665,0.049663041218814506,0.05552649276858967,-0.0005607811743473493,-0.028689957398876677,-0.036449194248448856,-0.04605661670606107,0.07353992809511514,0.04166402739273487,-0.03316422757510212,-0.06235828697523766,0.06792674164976588,0.05925399381124303,-0.03564971093383012,0.0026887437794981066,0.0487985392990919,-0.041962030309279134,0.06912952860737512,0.06984529069187437,-0.04274627916199624,-0.04096816965847642,-0.04707481791848957,-0.012361819339733744,0.04716491192403308,-0.04258220865518598,0.07492304085780095,-0.08233034714765744,-0.04117566237211941,0.03789112194812627,-0.038265705033922154,0.04714350185681067,-0.033294855924556395,0.09469494604793881,0.07228768056298333,0.08520726314555213,0.10892124165236447,-0.027356318053676578,0.07209051807308588,-0.08289808929016279,-0.06929190366924444,0.050832405463760555,0.04988653331294273,0.08747473040519249,0.05971266389423776,0.03523313387008793,-0.058232562797212256,0.11043466858342929,0.04269305433993504,-0.04854139157148816,-0.0410390653468271,0.02875819743919883,0.08133662029115378,0.01761280371868044,-0.01877954955304198,-0.04294114561847408,-0.03823109658615016,-0.04047160191294783,-0.03615715350865617,-0.00814712441322858,-0.0375807457874156,0.074794276128984,0.0344950424757427,-0.047065085839668126,-0.02681815853278146,-0.023605742623323968,0.052388124924850364,0.07038576767102492,0.0425938240067582,-0.03943461287736823,-0.06053284220844626,0.11201444570941106,0.07369153346001307,-0.04335175688538845,0.04955334257662389,0.035495437485650906,0.08650713167071371,0.07340097602858822,0.002016655489124619,-0.03677346805274698,0.012042345595690885,0.09513133852019981,0.007579154430509321,-0.037354583007953066,0.08267197206592188,0.08016847180663801,-0.03073059921827332,0.06468775257322079,-0.01883088348604606,0.0030281599748842127,0.03754715994671779,-0.019959701099903908,-0.06866818849439224,0.0446673760573623,0.057285205532242464,-0.047627510901217744,-0.03633308630364905,-0.03873612979515556,0.02022231879769633,0.07376807861760794,0.03915834588492735,-0.017313441644047908,-0.024658438727182836,0.08040212113922462,0.008307920868790744,0.028706334967897436,0.0307142623406996,0.04906146645634508,0.013116695021534732,0.09009783345258295,-0.023404080155906924,0.04213552832623683,-0.03244821333454506,0.07472338951619142,0.05737909660389609,-0.00014359868877207376,-0.04629373948738416,-0.02222277760331896,0.07590903828205214,-0.027995735569356688,0.05799293508642956,-0.08772889450893581,-0.0010690157348468925,0.02785109330685361,0.006161402866456428,-0.03672448669256113,-0.05642983350280223,0.0031990004354580134,0.07928274524219141,0.04600063768273564,-0.047748287889855356,-0.08888258941806393,0.0738882320645976,0.006193878128989118,-0.01642104464175227,-0.06328361531649714,-0.017308931300666523,-0.004129277050650365,0.074326123562785,0.05908167154440052,-0.03884163562747346,-0.102690401855231,-0.021464540336717595,0.028583206589303793,-0.017398635988370652,-0.021757612502212368,-0.011127426804724932,-0.027516793259466446,0.07890731479196081,0.06079172621189309,-0.04590150375845368,-0.1069223231596499,-0.044318736763488346,-0.013001788949121061,-0.009155770605890632,-0.028508995024698815,0.023883257584498958,-0.0467810559704347,-0.037359398010932014,0.0654128854089667,-0.03661141286955019,0.06174841836643779,-0.04210811311896535,0.09911673575133616,0.05780562033029309,0.06956167421345645,-0.012751816570754753,-0.01868749223566076,0.1121658216360469,-0.09575904281928638,-0.0924216590828311,0.00835768036432583,-0.02650594987981974,0.08189245125088579,0.0589622506256846,0.0031353169763646436,-0.0897901082320565,4.331666803507887e-05,0.0001547402106059189,-0.03988264373093365,0.018216398668685983,-0.017606609826159338,0.08176816727599681,-0.029086891687333902,-0.04047387183525157,-0.0353756432535233,-0.03706648145589346,-0.03739006998978923,-0.03727077497050288,-0.019419195943020582,-0.03614360966594631,0.10262375477197663,-0.04643976615407563,-0.07298751035844822,-0.04547418198882495,-0.022920559758125937,0.036967667374095035,0.03303472785577795,-0.035692079689164505,-0.08017151357646016,-0.08241386080303625,0.037251964546844235,0.08716371053271757,-0.010150859528729322,-0.0018528435248856574,0.027203479309092456,0.08506433673269267,0.07922341903265857,-0.033668164530398045,-0.01180748632803352,0.04182806015741846,0.10612559756645394,-0.006398577860641516,-0.04764690691395489,0.09764956613387844,0.06719302513989805,-0.0003535996592040854,0.07121241993210171,-0.045249697130963294,-0.029917579114891853,0.09265114800634934,-0.0011234263031866558,-0.09823807130724932,0.020604141536499414,0.0013123280868020486,-0.023279328123600833,-0.03580162942257739,-0.0500840749907948,0.0768845056225083,0.07531331411958593,0.035355246886161235,-0.037331096527162703,-0.037220856046764006,0.06558411269726373,-0.015181436693417177,0.056786582030051366,0.016969465522769855,0.017751131025287907,-0.04660332223276026,0.07828223771236967,-0.022720276363821013,0.01630423061677511,-0.028751559669473917,0.07773638889954494,0.04953426915203906,-0.03139963556415848,-0.03562682714076215,-0.05852177659695066,0.05254738256091718,-0.07152577043789096,0.012179392646828978,0.025667320723653585,-0.013741826316250922,0.018335271583271726,-0.020989865000769076,-0.06607521203234594,0.04946426459862382,-0.009302178270967321,-0.03398020260598994,-0.06854325233640006,-0.011641637305860495,0.025184542829618534,-0.022270227999106263,0.008879534471208967,-0.043834378932105546,-0.07110070148950881,0.04749218402428866,0.007636555835124742,-0.035412140526888417,-0.06443986666187076,0.010000416856427689,0.03549425450656151,0.002743457715808718,0.021301197539365532,-0.05301286720308648,-0.07069667770620704,0.05732318748704286,0.004138865467499279,-0.03565128550977154,-0.07457735830143185,-0.04623335535303615,-0.046305504739798733,-0.03974232188413885,-0.055098272708332806,-0.04120056213794498,-0.07782925215887423,-0.039591543008000746,-0.011361362633227214,-0.045159128699735415,-0.003352658302979931,0.004138043634990701,-0.03383264568149494,0.06492900686465336,0.04417386844535439,-0.006270131892855249,-0.04830560247292187,-0.03523586988476452,-0.08234861287123561,-0.07294446480840011,0.055422116678008865,0.03906721833344192,0.05086904304700796,-0.013261814451868333,0.04417740731143501,-0.1054927802778593,-0.03444082799140309,0.05029305564380484,-0.09041599235071955,-0.005444985014166809,-0.0191454642403355,0.07257341333964948,-0.01334050572010577,-0.015286302991502701,0.015473083542889236,-0.056449931961985216,-0.07250811481643873,-0.05420878307278147,0.01668245602643053,-0.04520858575965993,-0.03428258325912433,-0.039222957588368794,-0.08864519047912209,-0.03671330845307865,-0.036458324181850486,0.04880745915991472,0.0060809819504236895,0.0447622997184662,-0.0990662028351194,-0.07444626621299835,-0.048567341245902736,0.05062233716037193,-0.07444569898849819,-0.0060402296806453155,0.011160964853637842,0.007766803288173602,0.06005511184632597,0.0028942368430044003,-0.06374660379054929,0.002842515374772177,0.006043567301210612,-0.0181549217264315,-0.04507892530649878,-0.017592422079197267,0.052762068502115525,-0.06641246103338666,0.010429211878284389,0.022868887455559234,-0.024373869720055005,-0.049018835899089716,0.026320377712922914,-0.0831173735358702,-0.035819148758845155,0.004651885393517349,-0.06057623713779632,-0.03495503031565547,-0.04611985748895769,-0.010542456416388284,0.03942275766342063,-0.04112033302200205,0.006627135162661016,0.03578308753038428,0.05793907613073748,0.050308249847613014,-0.0016309865620729525,0.03967383203835964,0.0483825346349707,-0.03980189383941257,0.04763942109650808,-0.04531267144294215,-0.011329829569857404,0.01577333393718375,0.012459468844427243,0.04106251534116568,0.028325254688227584,-0.011144350908348834,-0.0695274377942453,0.03668029091337877,-0.030087032166516585,0.02130258849521587,-0.08635666905869092,0.09973294640269838,0.031643591847600044,0.033006929181784536,0.01241037294903906,0.040961824961322425,0.024475181218039474,0.0802475849298849,0.028584290824498537,-0.006288995026874521,-0.08541829095306026,0.08036665510312498,-0.004459420079121018,0.027918086046341155,0.008788299198942438,0.03620549714382504,-0.010536316822260888,0.027673501043307,-0.06778414625856992,0.062473476024480216,0.03306880074507721,0.0323591225754675,0.015125872131654974,0.050104051968088835,0.024927343567115966,0.0907639326222879,0.027889771812473145,0.01118537612530964,-0.011296762240530204,0.0036030160867318484,0.08496421893749016,0.03657449707265888,-0.02178776575226617,0.0466311178203307,-0.0916048558291784,0.05257024262844224,0.03268202585093762,0.08100619269008498,0.005136332100907395,0.002115706334932522,0.10698194609459745,0.07692232435643964,0.06447694141083499,0.10580216379213936,0.004956428664510421,0.09705775927852513,-0.04434687252519302,-0.0473677202285091,-0.037797580342692774,0.049933799154031774,0.03819050695760952,0.044737421866692224,-0.005080140448517787,-0.07056315010187666,0.08602282861820004,0.026455932832532045,-0.00259884982250219,0.09112746245991428,0.11456750808414821,0.07297782303186914,0.08805483980891891,0.08186635594663465,0.0314457566774158,-0.020532433399008117,0.0008675736057959355,-0.02037663645040397,0.07719005738493873,0.015237885784154368,0.09477844309362772,0.05733276185015356,-0.052961982943183224,-0.04061463512076514,0.02963304379263332,0.010703678714595686,0.03733094696771198,-0.10618001029601314,0.09575570486649913,0.07688135002020668,-0.018281061647247843,0.043506127695881455,0.04261248627653181,0.09482140082873287,0.062215253924350705,0.07344175599595279,-0.0005413942548831546,0.01653798023383734,0.10992785850041203,0.026950554721780328,0.05954503089528147,0.10791802269316618,0.06900568900281195,-0.020090573257069574,0.010326984831335225,-0.010178764109543378,0.027931110688285618,0.11069711857051447,0.018658609584012144,-0.07476655447638156,0.05181488192998956,0.007174625393610919,0.013934883619919224,-0.04314114417527102,0.013899822320187058,0.10161380268128618,0.07851151846462548,0.07155099869572198,0.006199077606667387,0.045028070125756145,0.08199439076008168,0.0336728699311173,0.017017877379077742,0.030623015059223765,0.058918541070860926,0.003629720371965889,0.05150204510002941,0.061551261871604875,0.0038054918245222585,0.0673928252196575,-0.07539903458424763,0.04293143242073958,0.06862018555858501,0.051785973689187,-0.07652374583741836,0.042807931487516965,0.03898542946508508,-0.0018060677732979463,0.018021756443712296,-0.027491351567237858,-0.03776269297633176,0.09211243020909986,0.019497194128994543,-0.0421580700403045,-0.08564948182001796,0.0736298485260617,0.04862939666747166,0.06133328082241093,-0.010738981949883476,-0.005820191898681332,-0.05289541348058903,0.058798824185690574,0.04504916439383559,-0.0425490230818442,-0.07451456388021206,0.04711642797123941,0.049626921871998624,0.025075478727645976,-0.014096386268883104,-0.02721570011845512,-0.04255270915105941,0.09732457193704656,0.009820612801252007,-0.04155789586015458,-0.08663875872326846,-0.04025744700730435,6.0160688670880705e-05,0.0017169306136794302,-0.05619001367718443,0.017063405322050553,-0.07260152098459025,-0.024326337122407397,-0.013974764414873234,-0.04351511585017205,0.0429774924503056,-0.001771748881507306,0.05511095586521319,0.06335752730965301,0.06909569816369131,0.09087044935895333,-0.012050018065829548,0.0863838837466892,-0.06554339857722702,-0.08393757390588899,-0.005925433980946041,0.045461438159914457,0.07773966939982922,0.05282318572598071,0.01731300970920419,-0.03478647023351851,0.06959336116431955,0.01735512452310534,-0.044794954086996484,0.05318769353178042,0.067324721458668,0.07456345464146664,-0.023981391441614444,0.06692968085386103,0.007704864541883961,-0.023379122928867166,-0.03990388042182703,-0.07891256116896808,0.00597063175937953,-0.05337762841204256,0.07926875015449705,-0.014320394481424017,-0.05948300340662334,-0.03343140295729818,-0.04060639479393771,0.058080277936220795,0.012612666855722715,0.04515344978741508,-0.06509818242095097,-0.06396525761524949,0.05100820583920275,0.06860860670606167,-0.03268243561954776,0.06972373648537745,0.04051861120164277,0.07880937073028763,0.08117367446075457,-0.017133508249320657,-0.017133295588324098,0.037542695204573824,0.09556485564764827,0.010959725909692302,-0.043008024547202275,0.06519930076979463,0.08831132721378701,-0.05003394370124183,0.053933215831551695,-0.04131037405871357,0.02122312260017696,0.05829147674016768,-0.006629090253852507,-0.05993966692526537,-0.04332246114769234,0.02111594595206757,0.004473822177510936,-0.013377018564664587,-0.05996061381088585,0.062195357883995224,0.0997136580898556,-0.03258181597489585,-0.0025486601352820853,-0.0020086816906819955,0.08272253525436254,0.04620910128468394,0.00871250143462199,0.05291811199975237,0.03654028052367882,-0.03830319128692143,0.08026488480339466,-0.024398398040402294,-0.04826176658607484,-0.023773590796440414,0.07722548924624943,0.07987265057080793,-0.004169798029609956,-0.04558375434704922,-0.07390992803379993,0.034041251955188194,-0.04197524158335071,-0.01821679286193302],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"q_2"},"scaleanchor":"x","scaleratio":1},"xaxis":{"title":{"text":"q_1"}},"scene":{"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":0,"y":0,"z":0},"eye":{"x":0,"y":0,"z":1.5}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('77781919-d999-468a-8a86-6bdd7f4477e2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>This is ‘sort of ok’: There are some regions that are mostly one kind of digit. But you may say there’s there’s too much intermingling between classes for a lot of this plot. So let’s try it again with 3 dimensions for PCA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just three dimensions</span></span>
<span id="cb33-2">proj_digits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W</span>
<span id="cb33-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proj_digits.shape = "</span>, proj_digits.shape)</span>
<span id="cb33-4"></span>
<span id="cb33-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the plot, separate them by "z" which is the digit of interest.  </span></span>
<span id="cb33-6">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_digits[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_digits[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_digits[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb33-7">                mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Y, showscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>), </span>
<span id="cb33-8">                text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'digit='</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(j) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> Y] )])</span>
<span id="cb33-9">fig.update_layout(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8x8 Handwritten Digits"</span>, xaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q_1"</span>, yaxis_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q_2"</span>, yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(scaleanchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,scaleratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb33-10">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>proj_digits.shape =  (1797, 3)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="be9780d4-7b16-46e9-bc4a-9e115581190f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("be9780d4-7b16-46e9-bc4a-9e115581190f")) {                    Plotly.newPlot(                        "be9780d4-7b16-46e9-bc4a-9e115581190f",                        [{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,3,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,2,5,7,9,5,4,4,9,0,8,9,8,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,9,5,5,6,5,0,9,8,9,8,4,1,7,7,3,5,1,0,0,2,2,7,8,2,0,1,2,6,3,3,7,3,3,4,6,6,6,4,9,1,5,0,9,5,2,8,2,0,0,1,7,6,3,2,1,7,4,6,3,1,3,9,1,7,6,8,4,3,1,4,0,5,3,6,9,6,1,7,5,4,4,7,2,8,2,2,5,7,9,5,4,8,8,4,9,0,8,9,8],"opacity":0.8,"showscale":true,"size":4},"mode":"markers","text":["digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=3","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=1","digit=2","digit=3","digit=4","digit=5","digit=6","digit=7","digit=8","digit=9","digit=0","digit=9","digit=5","digit=5","digit=6","digit=5","digit=0","digit=9","digit=8","digit=9","digit=8","digit=4","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=2","digit=2","digit=7","digit=8","digit=2","digit=0","digit=1","digit=2","digit=6","digit=3","digit=3","digit=7","digit=3","digit=3","digit=4","digit=6","digit=6","digit=6","digit=4","digit=9","digit=1","digit=5","digit=0","digit=9","digit=5","digit=2","digit=8","digit=2","digit=0","digit=0","digit=1","digit=7","digit=6","digit=3","digit=2","digit=1","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=9","digit=1","digit=7","digit=6","digit=8","digit=4","digit=3","digit=1","digit=4","digit=0","digit=5","digit=3","digit=6","digit=9","digit=6","digit=1","digit=7","digit=5","digit=4","digit=4","digit=7","digit=2","digit=8","digit=2","digit=2","digit=5","digit=7","digit=9","digit=5","digit=4","digit=8","digit=8","digit=4","digit=9","digit=0","digit=8","digit=9","digit=8"],"x":[0.003641879188461759,-0.03250352375315516,-0.02871651068332173,0.0610796784255883,-0.09269668495878615,0.05394627110035249,-0.08507528153637658,0.010281645884827875,0.01931116472095592,0.020193770836006566,-0.04527790864176921,-0.013097919949390916,0.00817022048094989,0.08990129893719988,-0.09720596859569498,0.004195838080465048,-0.06861749447059971,-0.02332094436512398,0.009860265258180019,0.052708125236181375,-0.02653392740508787,-0.001398629523279912,0.03042373093040231,0.07395682874807838,-0.07007669164944558,-0.02526354313562728,-0.0849607965920045,-0.020026032224075684,-0.003041282027298858,0.05569975865622116,-0.0022420207344286945,0.05215553655776693,0.01839001673185042,0.022349937152196925,-0.0719111215726857,0.011195245710153297,-0.025353532817550088,0.05115379972139105,-0.0012264662609987177,0.08005125452882639,0.015914084895434933,-0.09951322519632781,-0.012373786259719004,-0.02350823940884747,0.012679651659722204,0.08047534029180652,-0.013100033297392568,-0.007744279816659831,-0.020977510096650297,-0.0167426675721841,-0.0051501632089279575,-0.02586735549653923,-0.02834663859579463,-0.007857541774474288,-0.04329879650540013,-0.04177867852028993,-0.014057952345307994,-0.027414831265071653,-0.08924488808024819,0.07480722025315241,0.09111654652404244,-0.020003103772932518,0.09239718281886757,0.08325721338876639,-0.11181336202750353,-0.08518601421574348,-0.0850799502211484,-0.0592128900455909,-0.07755832320592605,0.028945284639232974,-0.032333697579332306,0.02282301290417043,-0.026034762012550467,0.07095532831236,0.0037059866584825346,-0.013024114516740596,-0.012080765519419156,-0.027040528596930843,0.012151666490349206,0.003662959094359653,-0.0020488047628436355,-0.006541457272511597,-0.08637996277074297,0.07808412923288574,0.013331462874125531,-0.030705243689442673,-0.026885104776597817,-0.07267147312128443,-0.08784150973620658,0.09319721879721053,-0.013592029640108458,0.07951075571388713,0.07782232758613812,-0.050546967142353634,-0.0006806403804907507,-0.08027398087938925,-0.013513050546871045,-0.08979974719813906,0.09550920213499099,-0.07942369268615489,-0.09060043794233115,-0.03485645240874155,-0.001242404064831306,0.05492350817057599,-0.09738494063849816,0.06316467150555354,-0.0721534318889931,0.001808473572357399,-0.015736264728584692,-0.004653864528558717,-0.06730586625292782,-0.07481902574847987,-0.010590309999289322,0.006562470225087588,-0.015457381336814102,-0.012416480619450535,0.01825031258028431,0.011200296179799335,-0.0024357635898066246,0.045481597032490356,0.01172235075777478,-0.06682930998844451,-0.0014929097550856205,0.013025213627620323,-0.09740323172128586,0.06219803767962538,-0.03130932442581995,-0.008242528710424805,0.05891836005140188,-0.01823701995022786,-0.009207576816229883,0.014024531795111008,0.03180984637481837,0.07569368373193415,-0.07352312983079155,0.002596991588503277,-0.05837857976847352,-0.0054918523064982384,-0.006048015141568839,0.07045934909391911,-0.015261764495193019,-0.012284474794892376,0.0380279666221496,0.10440861484755014,-0.08920484348984264,0.015742631247507372,-0.0719051213042168,-0.020414146130505798,-0.017803421808288707,0.07097541021686321,-0.03299086881140459,0.007449932610844278,0.04587531953319229,0.06508943825299673,-0.0783220357122611,-0.02592660358551402,-0.07982472878707447,-0.01643378210764255,-0.029427643021446643,0.06222692558974496,-0.02491963845720444,0.04952903917206209,-0.007415446192151452,-0.021092369994520393,-0.07265952081565985,-0.010788563181858895,-0.018117317851318083,0.0556123374814513,-0.015627379067787748,0.06511493337312932,-0.017163563512838903,-0.10066482424613,0.007776475226108433,-0.001793264503380579,0.00744349083857463,0.08318679747202329,0.00842831662893695,0.0062448847299686324,-0.012315507603262894,-0.043580031118985015,0.036266380250669306,0.0368489545137655,-0.00432931676998263,0.01867201152923453,-0.002228820105281665,-0.043104167000806874,-0.009406852371501663,0.011410438108331521,-0.06285801614025352,0.10093771355914406,0.07377538732708816,-0.03627523698730336,0.08449530343079532,0.08901318607283926,-0.08121795064978331,-0.09425063580988396,-0.07362865988338284,-0.07540518501773226,-0.08402665270699992,0.03909982830872647,-0.02956282020554487,-0.0007403237353110947,-0.02369261112615194,0.05728253238992803,-0.01265908340524485,0.03392196470839722,-0.0009723679580710389,0.019885487656130293,-0.059321256034302605,-0.04566874922851654,-0.00694355369510762,-0.005732830638868169,-0.0692555210898716,0.07888203638160488,0.019346305838977604,-0.005517457617268076,-0.02371387409028128,0.07048651224771067,0.005098806600136532,0.07651739597372081,0.05379484541454274,-0.031032053881598663,0.005160902361751227,-0.0776593851637883,-0.008321139702629547,-0.10423860416196283,0.06871302505602796,-0.016659518659031633,-0.09872933935141072,-0.0018390794540775418,-0.00010976802333817457,0.0517382010434937,-0.06983972633389858,0.053376877935761236,-0.04024079997679585,-0.03867110152918262,-0.0004953409713403628,-0.0314752769962467,-0.08285480249550387,-0.08858289283776341,-0.022952564947159415,-0.007154773517597172,-0.022567827687185495,0.0038805537481539478,0.015463805197998049,-0.01878699467169279,-0.013735131806791116,-0.07010728542040931,-0.006618967342385435,0.00015521274187014158,-0.09030799923198192,0.03388468136708964,-0.03250102479304573,0.005622791991609138,0.014628990992859537,-0.021970720580630536,-0.023447782537123384,-0.04383863288062963,0.04040177288486107,0.07506827649390385,-0.083327872901409,0.044117506568579844,-0.05841783956713271,0.021070090034178545,0.024871180359482402,0.029843135138306304,-0.013650743614041106,-0.03568554269909267,0.04091138448949027,0.06013656044566609,-0.10503415501728959,0.023061646020471862,-0.07338359873185378,-0.005490042290782174,-0.008160561508986554,0.015595857162430145,-0.0038360022749607263,-0.05396959831569905,0.050740968697758876,0.08695267129614681,-0.09304346929699829,0.033576611396919386,-0.06002172031601086,-0.030716683777123693,-0.028976547661808724,0.09055417296437136,-0.024112715547704798,0.06673777746529373,0.028112003645961284,0.02631219329292367,-0.0709418842392729,0.03221728212422196,0.011097199771558605,0.058085764205403345,0.009099535417994983,0.06160052487011136,0.002967873267476858,-0.10940006528234285,-0.05687276455177326,0.015274695315074027,-0.006608620028668642,0.07925984329370712,0.026466368916415062,-0.03940850417908791,-0.0156623823843504,0.0011357912427894471,0.04719901513311296,0.038193748112241584,0.019302131018522475,0.030596898684126718,0.050790467934459606,-0.00566751372304126,-0.023230049712156857,0.04715395899076579,-0.022851492541528646,0.06268750942534536,0.08007222368393964,-0.0087103417318325,0.09840379730895127,0.07883282221603546,-0.11458824187366894,-0.05668765921537526,-0.058809853075165355,-0.07651089312977778,-0.10314701915672143,0.011358893632465974,-0.045968980175821156,-0.022194560470829648,-0.009074504914383831,0.025835765725098814,0.020282781932366642,0.05965070327521085,0.017545746027036603,0.05769597432818158,-0.014786197167520228,-0.0033461931636346175,-0.033764855285562854,-0.011647348287443415,-0.0819090452902874,0.07896976072763104,0.061530477198855765,-0.0282628786248815,-0.005072428189571861,-0.10488006468689508,-0.05603019133191284,0.09761314677436832,-0.04414828893012452,0.06138245206715205,0.027074597601059232,-0.041021652240086505,0.0064487350324723405,-0.06932138414286301,-0.008908899822385408,-0.12050890070631758,0.039611756829252553,-0.01489526753607038,-0.08244700245601724,-0.005961550602114324,0.03874859376855582,0.08641368683824499,-0.06839947554864624,0.02964357785533726,-0.05995802419284271,-0.060931178085948376,-0.018430338025092145,0.02954472188330207,-0.11685713573287519,-0.11147832928361495,-0.00187116212924028,0.0524729113432501,0.02628720023903217,0.043561589863854853,0.049438820280538844,0.05150037694197925,-0.021601219285695576,-0.004474139939673383,0.007295004629729689,-0.11444537072432112,0.025656548597704835,0.018035734342929443,-0.10654236644758315,-0.010296774630798327,-0.011015562831044177,-0.014708179762219295,-0.0009116660264417691,0.09162102850011142,0.01940544273944997,0.02247879318664233,0.028678434201314797,0.08219876861372147,-0.07102740167898662,0.03865842976859919,-0.08295971117396922,-0.011315803589020994,-0.0018336822030573764,0.07475519142591815,0.0018160461506426667,-0.011130047697043562,0.026756381856905175,0.0668479380706981,-0.08751622915953423,0.0046770659609432505,-0.05645332565742726,-0.014534563369302592,0.013466201654326571,0.05231172551719766,-0.01910178935124131,-0.018945743240114058,0.02249336034679358,0.03516515786485049,-0.08796329888506808,0.00039788080511648507,-0.06465340458300774,-0.02580683239656638,-0.021255631987294524,0.05607214988149333,-0.03075030640496974,0.04050342151366537,0.05840026446326552,0.012250787782586644,-0.04063146943725781,0.04682784617231313,0.009149938918555131,0.050623966452438086,0.017641915305287005,0.07985926727232247,0.02024870241111681,-0.0765312152182462,0.0038207334427869093,-0.029525932148987657,0.015775654831393694,0.07974487643210908,0.0048566067159261745,-0.00721875058849491,-0.012298975455149417,-0.022338046397723743,0.03947654095101741,0.04437331719693544,-0.011221448618105964,0.026217771293768625,0.047570788226776635,0.01989497053367121,-0.00030908268040201025,0.044832478447019555,-0.04505617483998035,0.054331380117037024,0.04336832919775413,-0.02551637880075303,0.053271254662220796,0.04902797859154004,-0.08983850846407498,-0.077361015659697,-0.06726457242638884,-0.07029802464901755,-0.08057691176518667,0.08146185163420205,0.0005632493505324762,0.019594178558517313,-0.00981235911226661,0.04556433487144732,0.021390269310664085,0.02060052396296103,0.025518807346026535,0.03404301454544698,0.002249387928260197,-0.0016451828536890695,-0.02649251460369305,-0.03595023881206644,-0.08392084978486007,0.05188723472035217,0.022353066945158418,-0.050953213997032114,0.019416033354406958,-0.0693364906550753,-0.05457261292368504,0.048965476786658337,4.619612013508766e-05,0.06129613102463938,0.04499698768422772,-0.006823015937140457,0.004770003726483162,-0.051421402411076844,0.007712454864198969,-0.08480638476438176,0.058215879467676854,-0.006463238112778506,-0.08281791066461701,-0.01252588145928433,0.02634534813605241,0.04593685551764607,-0.08311344267443027,0.024573214701498532,-0.08418285500887136,-0.010206811225922405,-0.020220294293809615,0.018413268481230288,-0.05988999618936164,-0.08591163811463473,-0.012563693481120578,0.024227220605336143,0.004501181824947186,0.04239375698826365,-0.013338559697289738,-0.0032516062925705886,0.0041534134543015425,0.04214296678846387,-0.03444226847127903,-0.0809664381086835,0.008620908565738125,-0.003656927770229839,-0.07586318850523933,0.049051046525479015,-0.0036855191145223685,0.021939360239080313,0.05648618476700289,0.02984359289153675,0.012517506123863271,0.0021440729905661568,0.010931740963381597,0.05358189844648631,-0.07724881667292001,0.0063818831016010675,-0.056188599654003954,0.02158503897028031,-0.015229954469925347,0.029883213815327825,-0.0018061681614777534,-0.0004442824123330405,0.0188738963722918,0.07411076017142726,-0.04773301573009015,0.03790476758053555,-0.05079377825715916,0.027018525078607997,-0.016361957845138386,0.03271301616821883,0.024071986571033415,-0.007641481058784313,0.030817356336776243,0.0460387327365289,-0.08881293994924573,0.05221475319416386,-0.05265557558644001,0.008349426698117538,0.0137099266648808,0.05232807343287594,-0.0021112369459249975,0.022589469882150253,0.045337448951430236,0.04301082164932139,-0.05650312089765821,0.04392111540893367,0.023171709687039837,0.07496115598377567,-0.024892951773250797,0.0315532818865321,-0.0025777228363733397,-0.07648400951019207,-0.030376353024432586,-0.01609701363924962,0.015619547156523639,0.06892147911317903,0.05089713042757353,-0.048201774234119886,0.00854354297161144,0.018205557761612427,0.039206638717562386,0.018264266360411934,0.021228301838335416,-0.013916369832455582,0.04852852663851958,-0.015619303385034212,-0.03925886548261834,0.02335778387035555,-0.052126271520992834,0.0579156020394793,0.07560729008696426,0.004157315730423816,0.041691396333916865,0.0448628122300859,-0.09831128248567794,-0.05138717045037338,-0.07329595575755986,-0.0502384855701369,-0.05881276103964955,0.0535991448103648,-0.04875926937717459,0.03166980568684411,-0.008031029778010982,0.07375532553713479,0.029951910727838555,0.03999074423999045,-0.005424622531251533,0.04949737428330443,0.032553408122097616,0.005483381725694246,-0.033702402411308036,0.020203352773350596,-0.057824067556185015,0.05447119548246627,0.011413102668360996,-0.020777127184752435,0.006908636854197466,-0.0673803647295762,-0.07075738712663442,0.03547470708411122,-0.03637669482534864,0.03103863051773932,0.0387836811967854,-0.002984113279663231,-0.01181938538383211,-0.06542990160407111,-0.010492278071820111,-0.07404672223076297,0.07500878183082103,-0.03233330041898194,-0.07905171621352321,0.032891438715996306,0.04370867642121877,0.06521783411005913,-0.06989589083643213,0.03475250106637888,-0.05814432563748767,-0.0004967369758230158,0.0168749541287461,0.04033635835059975,-0.06269639981846203,-0.09695475859751783,0.010324371744229607,0.02867694190142237,-0.02686048200623999,0.0730883637332469,0.027771711155384203,0.005844026871030217,0.0237106156924155,0.08033536251800698,0.046612587999127986,-0.0499633292370421,-0.009526947778828038,-0.015614655870187462,-0.06034668848659266,0.07101137346384837,0.010246713466426199,-0.01082743358640874,0.0527681180446207,-0.02370930473349136,-0.013527008834274762,-0.04168151405927207,0.042890355528505036,0.060921041965130505,-0.09252917813941848,-0.018744876819194223,-0.06713756415860694,0.0048895096947635,0.021836643874783353,-0.010582628501468051,0.0022602481369145317,-0.055027263182817275,0.04017169063927172,0.07177190546021325,-0.10781450809739032,-0.011007001607102001,-0.07699279071020541,-0.009647273337692773,0.0036407994809587937,-0.031079059590055195,-0.030897099206970775,-0.07244023326710441,0.055433037585620126,0.055967584388275066,-0.06821828685523203,-0.004350746849930919,-0.06921169742091743,-0.01706126265778582,0.011405330814463979,-0.008120461739795007,-0.020684091650393973,-0.041757899893967027,-0.07280371538665234,-0.02600684785540286,-0.08078713859333266,-0.03429080752377078,-0.0010764926794965275,-0.0051774348501249755,0.012920289005028007,-0.03453535051347558,0.013153325629365822,-0.07330002051201392,-0.0414904751067037,-0.05858098551353511,-0.03257886694080544,0.04471729718387706,-0.018635182776052646,-0.04197549404585573,-0.03147098212269646,-0.0011427980955584186,0.05787046780137799,0.04171646012135628,-0.017479673683613382,0.000776511894984215,0.03831063137905016,-0.05842287530393902,-0.003519420876094792,0.03687490808882546,-0.04779029673053682,0.09432613093395842,0.08464756241176713,-0.003500581937036073,0.09414816914116574,0.09038010301718041,-0.0629712200371365,-0.06182111939479766,-0.07006566697949021,-0.060899632334510075,-0.08898107735744225,-0.0220957785108358,-0.06070053879339292,-0.0394313589084657,-0.03428844322771976,-0.021763097105725868,-0.04644546835967237,0.052014911662604274,0.012004608555157337,0.022722440485535032,-0.023859246067619636,-0.016503662138881423,-0.0038843453894978706,-0.016131206691286495,-0.07167346862287265,0.08074044174286078,0.03697889561381334,-0.032836302875487104,-0.03964141322071275,-0.10007093324399664,-0.07948206744217362,0.08215379028700984,-0.040082265874910025,0.018921533706361102,-0.00538429065308605,-0.05557826727892366,-0.031586459540005274,-0.06091125455403315,-0.002668622939462164,-0.07787012531225657,0.03660386047464617,-0.059327729018914574,-0.0317240857278293,-0.017838897247816104,0.012998897629737188,0.06467168494155334,-0.09186407788594629,-0.039884590923825174,-0.07280326973003202,-0.04340846798738698,-0.023694919311860973,-0.005144142657173151,-0.05993335346625802,-0.06403013090894953,-0.05109397896106502,0.052972667195932195,-0.041011939178400285,0.050921221052885456,0.04731509187974996,-0.03212556879980636,0.008065459050098785,-0.037397803940213935,-0.0163941363998913,-0.09308987926121232,0.009211670157375989,-0.029665691848185034,-0.055459149846157164,-0.007635689359195899,-0.014495367132533174,0.0026189084788119914,-0.03401299656669007,-0.015208810403958889,0.011492361027351305,-0.01112692169863027,0.04401477796518141,0.019838948822954245,-0.11197243248187086,0.01366832246944123,-0.03692320638719548,0.007889056957304146,-0.018177101936628588,0.07518060910736543,0.014739349393306546,0.008560324724611759,0.051786435955314555,0.08137019325822278,-0.11821032260793163,0.004473062611846125,-0.032917076427375215,0.010026647370431548,-0.03389595204340501,0.0335687234850989,-0.01802810816595651,-0.01773960669272065,0.03737171594395851,0.08563364196217127,-0.10225416655581784,0.003985817497241768,-0.058432896739502964,0.025477459416462952,-0.041759208959767785,0.043157538752963624,-0.01672380923253096,0.06346332869314675,0.029340711601081475,-0.03356282372949613,-0.04508937716496031,0.016250225781247796,-0.015300612535348429,0.04202977210533357,0.021283566602068166,0.06812553753218879,0.02050681314817067,-0.11483932719261686,-0.04992520649758398,0.030678528134650624,0.0110118214572762,0.07905210195770347,0.0037854848435306745,-0.030850425465139268,-0.00836597345543757,-0.02233127196592535,0.0480278560828041,-0.0006257453887465927,-0.012295681373187992,-0.005123301360320262,0.035499685282083165,-0.015644108135024225,-0.0011702142876125119,0.027811994090940723,-0.08160712997072088,0.0529917032055631,0.04708420800090746,0.027720901473732892,0.07198133297894775,0.06270672957391456,-0.10709019047329867,-0.07847471838371246,-0.05570119916876546,-0.04541729680907115,-0.11447285705314897,0.0638163199486916,-0.004579717902292253,0.010437978925052698,-0.027740009156604063,0.04778115877650762,0.01327288992299449,0.013581762630891362,0.022694366819061264,0.011123648388939426,-0.046992907068826584,0.018860390485055195,-0.044472398171300435,0.019274794164806666,-0.0758151618857976,0.08266124663130245,0.044952170319805626,-0.03787553517291506,-0.004429848278915949,-0.10048411433485153,-0.044757808374116935,0.0739018611810244,-0.04182280043492358,0.08290416654211623,0.048141615453241624,-0.036640488301359166,0.003407910997229981,-0.05337009436242625,-0.009145343559441138,-0.10095908971957253,0.05339931719506889,-0.023747754368149968,-0.10198927959554356,0.009948791966037594,0.015385620762044137,0.06703982558636941,-0.07517591175212526,0.06507955401697772,-0.06958444529475279,-0.025678539555693332,-0.0012663420050461139,-0.007841895209363665,-0.1082404531071176,-0.11406961856031139,0.007774095946896172,0.014758149855982073,0.00495742144096142,0.02769001121599918,0.05135684235682766,0.03517311869402216,0.029448945435404158,0.05672844040626529,0.0069821407256833185,-0.11720922799328957,0.00544036045867508,-0.0019004302155458319,-0.10495033724134596,0.04367816036390926,-0.02792022663538578,-0.005390001843493851,0.08051109527890164,-0.042178664873419695,-0.012689342918685717,0.04683059912523386,0.07422720906479177,-0.11199379165398649,0.03574471611561533,-0.05043082314046988,-0.021610543922433494,0.033816439368742665,0.07535261689441954,0.012974184055180091,0.006089167801281746,0.02636335378368482,0.06918129695403387,-0.11409444025553833,0.05023852727143977,-0.063138822570787,0.010896591204894874,0.03606052234144723,0.07754964664662946,0.016105127430319298,-0.03169540851414678,0.06121512701593387,0.0779648249098527,-0.08142292295020281,0.050350586204091316,-0.04180668071143681,-0.0026175912832158846,0.026926256464052823,0.0842035931605002,-0.003956856784278965,0.09653532816338249,0.057783900648117385,0.05294008626100816,-0.06134423502611318,0.06094131870331955,0.023945754734226016,0.06825004352962159,0.04340388666506536,0.08191896333845186,0.024184773010020852,-0.09031639742517442,0.02965955234708202,-0.015118247775687505,-0.012304135872250547,0.05510719150735151,0.05621900760421701,0.01907826703676117,0.05369417548475337,-0.01074944081875085,0.043943332063858656,0.05019725965140213,0.01671625576175734,-0.00014927954806504204,0.042813878808496714,-0.03921031631576875,0.07744750075562205,0.07575927549364302,-0.0034944185336615967,0.05331213358468338,0.0656535919566594,-0.06710221764935288,-0.0696485232659194,-0.056228291591527375,-0.053223794325127936,-0.07929536564142725,0.07051938022447943,0.018637865376737457,0.05501342267514775,0.03908468819033264,0.08123141183369235,0.05705629672472774,0.06262771557536335,0.03299132651281594,0.04626104076744993,0.02612849156770844,0.026908517611603153,0.008599219200520111,0.00875909614820536,-0.04300787004894621,0.029708896961328744,0.0456345668468486,-0.016128945756378268,-0.08621238775485997,-0.07944320481545995,0.08354026561993798,0.0064090780996329776,0.04878189435566079,0.052623121441406885,0.007347130541416011,-0.022302991240576775,-0.06623246898770416,0.023909149323287655,-0.05493012102675957,0.06598285495547625,0.014125716025911733,-0.08934449997460182,0.01494089544038478,0.046922208250445865,0.06697019419352837,-0.0627746117791018,0.08767074213824413,-0.06367549378213827,0.00016361586332226628,-0.014082946099889398,0.05276573010740827,-0.10810756227357211,-0.081816088782384,0.00440268878281937,0.04655319953160671,0.029342247378740017,0.04265460122768292,0.05217851053626081,0.04808406889663652,-0.006366510693981881,0.06791278373924141,0.0647173121748952,-0.05469235136543198,-0.09716231907995597,0.04119200641262981,0.047166493345769576,0.034416519550693025,0.0817812209007156,0.0448137270840228,-0.0052432284436802245,-0.026959207353834367,0.04390922093390541,0.08943130724697737,-0.06797813819307195,-0.00813508871162559,-0.051438218748800724,0.019722403063652947,-0.007298651105683382,0.04920879290641339,-0.016025589124924994,-0.036009172550101186,0.03270956487718278,0.09044674587869773,-0.05811989589235903,0.01681240522033946,-0.04491179215882304,-0.0011534940113243298,0.04266750487764557,0.04145989154173247,-0.009670284799200258,-0.03538697619746685,0.05825767055500247,0.09510999484197784,-0.08466140929041381,0.01451762962199542,-0.06876412257347983,0.0036483472774921847,0.03128038865614997,0.04693447764927395,0.009820415984285834,0.029772011451866597,-0.014550087117587754,-0.006242894616226434,-0.07537087303456513,-0.03717257561222686,-0.02921910671072763,0.04991182569215494,0.01641682900396349,0.03225748400679459,0.013743619575462803,-0.06590346416227841,-0.037224194749850295,0.018166584779387596,0.010578389623512938,0.0935141877808144,0.02478834401753448,-0.0505919745237908,-0.019767143685258875,-0.0024715338801271722,0.020469990181596794,0.03576414908416626,0.059505383426071264,0.018671566784571516,-0.06858295966984965,0.054685717353378835,-0.0663657149179554,0.12093771320588367,0.110087959816201,0.013633036384856393,0.11187212727262826,0.11177455602741461,-0.07226339074563387,-0.06147364353704061,-0.06907118590478711,-0.07891772359686752,-0.021319914749080873,0.03660868866222512,-0.02842624544844012,-0.01609501128452834,0.011679784739273854,0.043001764321025676,-0.010704027274329498,0.0496809314822259,0.038750558998345244,0.07378113076513639,-0.00677436582425783,0.0013817209989367884,-0.05294283303238482,0.016401233253846167,-0.09424473738441422,0.09596838529984429,0.06466903501398788,-0.021688744897489117,-0.010301489403096874,-0.06928783138946372,-0.07089172036534465,0.10802072261335821,-0.0062002599816578085,0.011232691411317795,0.02907847054937624,-0.032547696197740554,-0.007012084871897741,-0.05473462687972172,0.023886495280647038,-0.08049145409626296,0.10489666357706434,-0.05786325747756466,-0.09276026602348227,0.0016941923826367152,-0.006743221619179279,0.10647903482190109,-0.07739448719010668,0.07526281602266381,-0.06048470644285887,-0.04694656092120155,0.02905800251488154,-0.014543053308022967,-0.1034340345414942,-0.05758619560902724,0.007256973090775032,0.05854759049961431,0.018940526464936002,0.02242969020770863,0.03448375846046946,-0.009103374672015047,0.027803931207727006,0.06586441691322532,-0.03785883110525702,-0.09450676405187508,0.022212112192904556,0.03207111617488197,-0.07023828969686922,0.007679603250237495,9.843431161122178e-05,0.0002524296179247595,0.06694356304162934,0.015734042643188267,-0.0028723308531148762,-0.02373966427366397,0.046546880579610116,0.10125192906605729,-0.10625003173534095,0.0019264854223098532,-0.022397334123926117,0.026276870238853178,0.045906776266212666,0.05587616795046257,-0.010349343012889657,-0.025531639092221288,0.06315713915398333,0.0980845643893816,-0.10832557390504038,0.020566137350369332,-0.07154244762117755,0.004223757136548197,-0.0014172084358420143,0.06563353193130642,-0.01052636283943439,-0.034177626086155564,0.06947447701855522,0.10009237738906425,-0.08371867109001349,0.014102816453201411,-0.07113658272488352,0.000937173755542993,0.011401939961213546,0.024336092041916207,0.0025231201558835953,0.06934127535711729,0.02451677971013365,0.034899646812427805,-0.06991776483347399,0.022291204740637564,-0.012942368945247742,0.0631480533462558,0.01588392892119734,0.06922648431844643,0.011107576590503524,-0.11106307915558376,-0.0222620507895901,0.02188119543766107,0.022331069112265456,0.04375364826225788,-0.03324371330534009,-0.020539173005264394,0.0017265729506892305,3.3721015713482108e-06,0.07254470941279202,0.05894112043366498,0.005594917150236757,0.00769758337342052,0.04961470144063172,-0.0033454389507513254,-0.028606517555650673,0.07272832774890799,-0.05538890447121117,0.1026042735062804,0.09221921525281179,0.015653584877670757,0.0905082880342149,0.1100422414060318,-0.10389700772702079,-0.06245985431155762,-0.07586758962042382,-0.07738298985069518,-0.10859685367268823,0.06623019687071563,-0.04052397370316667,-0.03280912182766558,-0.012060150536900108,0.055308991433884215,0.023129878538194697,0.0766245707154751,0.03352661750091458,0.06571157951828582,0.01366174001040496,0.012219986132635509,-0.02287325131699923,0.029885751201871386,-0.05426941851167664,0.09145328879773343,0.07621200582263873,-0.0017843098367549665,0.009152124402044182,-0.1149627171039445,-0.06113609002153992,0.08883316255976983,-0.04355031829338439,0.08495803559986112,0.07495250243006166,-0.04998612995701034,0.007488367883623799,-0.0686513575792853,0.03990576710375876,-0.11031162425991538,0.08965059569238797,-0.05862920652790641,-0.11704569730764587,-0.011393911261045605,0.011894227721147132,0.08999840731442946,-0.06168000863405421,0.08622522450552271,-0.06607176107167152,-0.054170417007955815,0.033495809962158965,0.00083825171544947,-0.09498015194844558,-0.11885429945763652,0.001678709542443516,0.0346040602694948,0.0040097107992208645,0.06061316315317241,0.08460600796637763,-0.020255017038368364,0.028189021624206164,0.07176967980233064,0.012792687915236212,-0.11158729537542379,-0.005227237273705643,0.015141694330564342,-0.0655056789774483,0.0902835734905738,0.008899031996805182,0.019286113352662886,0.04618598062350284,0.01657721479126508,-0.013580215008401139,0.0053120531283163295,0.041775742932711774,0.11735314428188115,-0.09329496692166721,0.036240356374513005,-0.038010179338968705,0.016804865029328188,-0.012005806059134568,0.0794414661764869,-0.0337604485332179,-0.02759836009569122,0.03221796952109352,0.10007855919021215,-0.0818090402573108,0.04794384820644225,-0.04381085251480478,0.03342042888861714,-0.007856874590664734,0.08236340060218098,-0.021828305128374137,0.008871832139198328,0.038363799883704225,0.0819509274789046,-0.0733432800813745,-0.009160557562231011,-0.04441430882197199,0.04847554421279191,-0.012362351239374417,0.07775659639408568,0.009546460644682517,0.07457444667369893,0.018153689043490618,-0.006511672502591375,-0.0482976405200522,0.022565085561183,-0.037939293386827416,0.05408083424987609,0.004669463482840082,0.04474727747348374,-0.012348413365694163,-0.09755993884709224,-0.041597334679468204,0.03445564146942967,0.04848590100906045,0.10311757331728306,0.014750256150091335,-0.023585227171580472,-0.026606874114255247,-0.02677825063637778,0.06833146227993092,0.05815616965891515,0.03811147381108542,0.001660917834178746,0.04715086087247712,0.0012334035493704136,-0.009045788657965147,0.05818743295641414,-0.06736508078872386,0.06975300423421865,0.0939124769748145,0.02351590765265456,0.09870217964549302,0.10993916752855107,-0.09310576166283095,-0.052660858631691745,-0.05499953980416613,-0.05975277715596147,-0.11690145672829216,0.05666325100008388,-0.01741951931719915,0.00029706257674360037,-0.02093776796813929,0.07478297502901346,-0.036147002702349176,0.06792332857551653,-0.013179448273197078,0.048429173747185486,0.004264144470562227,0.0022664578038825265,-0.018415582814942367,0.03155510346610328,-0.05559105732955573,0.09716564022441275,0.03898044412575811,-0.006838172773299614,0.0045211297078101,-0.09834459927936655,-0.06677535108168092,0.08423668663286886,-0.011396970058312316,0.09153210004716442,0.07577997560332678,-0.031448264079557045,-0.001404745621811721,-0.04747498431459187,0.024941306307971835,-0.08364799302919608,0.08734415468891846,-0.043584687425744076,-0.11440319796856245,-0.021682095833226753,-0.042420527743578004,0.102215994501558,-0.0461178080131985,0.06969038352335204,-0.042160285181647814,-0.04508676567274925,0.00960420525954117,0.00619536452611057,-0.10012240991611512,-0.1050672504371741,-0.003965407492939926,0.052357401074630126,0.029530275495184437,0.0540023862327508,0.05608833374923425,0.002720357572517915,0.024811931580100817,0.07273195952523318,0.04336653910485416,-0.10077784024625033,-0.020601828388878796,-0.015675224958109468,-0.11357080889158773,0.03828808290021864,-0.037576039687254245,0.012235966278896854,0.027334631248611175,0.017934780160252753,0.03701421232953129,0.06813264155732186,-0.07223799563735629,0.04783654345982848,-0.04719012489159974,-0.024289458778030865,0.047697035724477505,0.08283649705092234,0.013029729551701145,0.02038808780303967,0.024227975938639814,0.08257883759297889,-0.10243321908386768,0.04990493453065493,-0.03968409115150029,-0.007912367581145857,0.030056948329457177,0.08872439700801074,0.004208726925927249,0.010933317913184188,0.0509055050921873,0.07156286690670273,-0.09946770790848129,0.03235122515453415,-0.04546881318487216,-0.010993008903568968,0.03183441329630906,0.08563345379246558,0.0009185938689611223,0.09495454996917166,0.05336535139549943,0.0532027270308518,-0.052967515428561346,0.03034568304819928,0.0057542842759355775,0.07949815936596669,0.014703259273104589,0.08646362031721033,0.026491363391444887,-0.10596067147939058,0.018806637829489214,0.010584693002104944,-0.02289581934391133,0.08284343730356483,0.06413062591963843,0.025379225130153543,0.005312371030560285,0.013591069373512794,0.05906490408905164,0.049232735306491346,-0.026023138273346874,-0.017858468379586507,0.051515135679600386,0.019496196203011813,0.02859193440904688,0.043332233657016876,-0.04262259036618697,0.07081616967161944,0.07734219068730129,0.0020972107791289497,0.0897621352936571,0.10801788450144595,-0.09400440888396198,-0.0649930993020892,-0.04295438340418402,-0.06845778920635819,-0.10223086402131074,0.08391052445138882,0.027484733300442116,0.02380786318995079,0.02120792184360195,0.09646088809102969,0.013772169493985872,0.044271701199220095,0.026514237691161697,0.05512554127751356,0.024621833049639698,0.002582859596523217,0.028995824569261874,0.016788189833937033,-0.058005153010014805,0.07912138034587089,0.024252246279935732,0.03232488789834432,0.0045917642594082075,-0.10620232180951635,-0.056719681596305964,0.08507215409336356,0.010399861040538645,0.08236301087150562,0.0735335684160075,0.027508586392175377,0.007932099801988335,-0.05880805284589872,0.021112395895073032,-0.09970903835825118,0.07485443840094277,0.019324732560802037,-0.09702045168122053,0.008432933830597369,0.056046599921637255,0.08386766204747961,-0.0680839400108281,0.09404105312126326,-0.07350225326289342,0.028551868014381004,-0.008024679991743148,0.05697920615762481,-0.10618988779731571,-0.07420905586234983,0.0003267433514565453,0.0649530207896165,0.0018488516895231208,0.07113905700337902,0.04224215846674044,0.01947490644834197,-0.010770051647467705,0.08833067107570555,0.032731607372507195,-0.10721308648710769,-0.006555500169164481,0.012124450518184528,-0.10923045824129822,0.06426341509633987,0.011888001969524203,-0.012805366474878704,0.07754231271062832,-0.0003626116788376379,-0.027410754588190502,-0.04019457203247674,0.018089071403534718,0.06391315340027671,-0.08856516186651982,-0.01441455936794413,-0.027151963731019677,0.02697993923691536,-0.039983989075080696,-0.003333057504683231,-0.027259508949554773,-0.03799956424439556,0.014142680125701586,0.06761777947172382,-0.09572624017058824,-0.05003441329778224,-0.061288337188046556,0.03276996396136079,-0.03114066813125801,-0.06905578965724134,0.016437780459031746,0.08987708492456514,-0.08176611662284844,-0.0012274145914961346,-0.07629729504925081,0.03037640310301459,-0.01102534191786166,0.021308186512042696,-0.0800904398824091,0.014822824073591517,0.011002239723282129,-0.004020895688189848,-0.0689016234919966,-0.03157727461309843,-0.01709182583814473,-0.004814076575382666,-0.06056801052620194,0.027128463917868415,-0.01640662739339641,-0.10830494346184931,-0.02536146683028313,-0.0019889936543599405,0.011387545115631888,0.06342984314098989,-0.007341219206397799,-0.037472138460795675,-0.06334341924928971,-0.0030091643845742587,0.026370215082191388,0.06406600836211387,-0.026375265951700994,-0.011721206288657521,0.01728113085733651,-0.04291049351003082,-0.06484686031479175,0.03882325682188162,-0.06358003619747059,0.045744508149445584,0.05169598578097008,0.026506967648173535,0.028202332668317384,0.05334372146547964,-0.0645670966168339,-0.08489762729644082,-0.08731527588916284,-0.06915681154702068,0.026441705356247108,0.002381153397553079,-0.0575553248495841,-0.00807783964261538,-0.06936014361776946,0.06987114045403439,-0.03239981421001125,0.03354667252013256,-0.011546451386653616,-0.010619052650999708,-0.04215654774322953,-0.0013557481637221688,-0.06250428142734478,0.08757095976197171,0.03461812486080777,-0.019812296147949188,-0.007355501768986311,0.003441477959235839,-0.057772305102541464,0.06460779678007794,-0.030322945025615878,0.052060654993362356,-0.0028584456893847605,-0.03573109951652088,0.03471273296215727,-0.07654372459528348,-0.03183123098731582,-0.11223938622463825,0.07956175091959262,-0.02580635297649074,-0.1043674021505808,-0.04516994102373763,-0.019228360754953936,0.07587768329117338,-0.07136508490035257,0.07300076428806702,-0.08425825660985653,-0.021183834752457335,-0.03498933258391516,0.00083852593295071,-0.09445027235823691,-0.06594065905102847,-0.018994801526191644,0.009339232403239865,0.05600080961304759,-0.04014184973122911,0.007388650001760853,0.047397691915384524,-0.03586234828433015,0.02915747117614452,-0.1059078547675769,0.005691951044403723,-0.011488126387713677,-0.03583501765860309,-0.00330406001335607,-0.03897219412392772,0.008434275918293538,-0.04407366502263773,0.04910162760932065,0.024028925276735398,-0.05675146836424483,0.021098533744846416,-0.081378783257846,0.010607408819773208,0.039401507894349604,0.08558579795168259,-0.0013703160350813095,-0.06493117035897508,0.0025683707498208304,0.030983222032152858,-0.11540006223294813,-0.006329816626357478,-0.06392069223694334,-0.03541785573080324,0.001765235703263527,0.07515914507021976,-0.010646471749692145,-0.04710239246783626,0.029898680392310053,0.017270201631891205,-0.11027043935484222,-0.03298110259376082,-0.0858787823404231,-0.0012073043428540717,0.019234191866335792,0.06456782851764442,-0.0011672857503784628,0.06352180515227879,-0.01272940779927146,-0.005700028264231874,-0.06427113652281344,0.008974573454312013,-0.04180062910131312,0.08370145384864318,-0.0030144934924959087,0.08938549770713163,0.0011422344521985414,-0.1075874834098961,-0.03668773272511863,-0.01959252628373456,-0.01603367731141491,0.013576855888475745,-0.009757101912479277,-0.043237005059108366,-0.005321585013891725,-0.014971249930490345,0.02179839063602397,0.04264075406355601,-0.01895517625993181,0.025233613993012168,0.026417990030439646,-0.03886568391752267,-0.04173126845571368,0.015424910448151908,-0.07824167805144952,0.03354050707018383,0.01810075990855821,-0.017983374172630354,-0.0011883381953288529,0.030051342213188805,-0.11501167578213418,-0.08289937414597512,-0.07034883297278337,-0.05280975185851764,-0.09996176113098691,0.06957542121488887,-0.041417401874058346,0.01316562771232915,-0.008410437034040113,0.07715577925420405,-0.027638947959293,0.038676778133640115,-0.0006311257910757584,0.055795677962618084,-0.01735780821386344,0.0044205182494403104,-0.051505968844986205,-0.044491327137929484,-0.09091177883731334,0.0594043742880619,0.0360307567934734,-0.008742213141681391,-0.05097571306156821,-0.09387220269318701,-0.09586114483144936,0.07649705321072607,-0.019072712789785243,0.04169442337289245,0.07379553921283559,-0.06859020453115917,0.0011850947705761335,-0.07011610626460603,-0.0020514045887118594,-0.1128098460880183,0.004424506764275036,-0.05054724570017549,-0.09385951376150263,-0.040676861991863864,0.03161808016131802,0.07196264447663377,-0.09712142963523335,0.0741246997218094,-0.06361667312611143,-0.04248952336892439,0.010950093937749955,0.0022952049670461943,-0.08063377457711622,-0.10640808896764672,-0.014430510046897393,0.03861948050004034,-0.002492147525483399,0.025559947656273754,0.02955317933178116,-0.007481918815100933,-0.01653929042993276,0.06401610966372352,0.014281047227581401,-0.11181171917050842,-0.015231811072792936,-0.0018253252148113402,-0.1256114218997594,0.055983690623666586,-0.02664847578970252,-0.043655180206273285,0.01780906994276206,5.334264216144781e-05],"y":[-0.07668477045855053,0.08819202341119281,0.04578922910407929,-0.006322342244010379,-0.009995269863483616,-0.024290907694817877,-0.013992441844547716,0.08938012277531007,0.002105518052266767,-0.024925714346058163,-0.059606255295035625,0.053784613806694186,0.025772279030114004,0.014223614942189886,-0.0036902873362238612,0.06894730554607713,0.016115574955639794,0.05743772702699065,0.06278395160753064,-0.027945643225885403,-0.06963466230650191,0.0472835425235513,0.041302834825440594,0.024454134189962284,-0.011401806601529212,0.02816537314321268,-0.025039849100680984,0.027065340450884094,0.035694169633358155,-0.03024453312793142,-0.0975401830098401,-0.02215825636848018,0.020857096640558105,0.05073735441730936,-0.006880071178772666,0.044354652662887406,-0.05560670579154298,-0.03244516391887906,0.05254616106227343,-0.04353982592063978,0.04899676083273098,0.0037217131967729436,0.04316545678539602,0.047407632193045356,0.08094393722026068,-0.005325079801598644,0.051414464404012594,0.04885624781950317,-0.07472319807635042,-0.07514460473668826,0.03343155714040539,0.03521387045986655,0.058986534745315664,0.04592793760279581,0.042857371148366505,-0.04811721683561091,0.04436755503095041,0.05272073521599444,-0.0346539405399698,0.038649029200663355,-0.007454855954191696,0.05279913740494803,0.004421335817089717,0.04133261709259792,-0.022379344879849133,-0.03708347800618382,-0.02575679616388098,-0.06047689752475965,0.024043618991648388,0.08199256567321693,0.04931754295974951,0.029121741426891348,-0.07208597531962758,-0.039535545387379925,0.0029537774725477556,0.0429836633501418,0.051024869376686766,0.0613627349170151,-0.08283654820587667,-0.08659682842935996,0.06782262180085993,0.08370048405743225,-0.0213931885908251,0.027754096064986425,0.015871360197382188,0.08856662963436072,0.021312505252946257,0.05856164776288418,-0.0020192277278194247,0.013855371522696523,0.06204290687603336,0.06501850298772377,-0.04032220579177079,0.08610806843966456,0.0752362679760628,0.025117934375641023,0.04745989992815977,0.004053665749169854,0.0271991509922319,0.08203073533575087,-0.012809616407691118,-0.08547704633232373,0.02206553700202562,0.09722379286968884,0.0017717612399423131,-0.038563774172128217,0.012282034675851452,0.04293350775157488,0.051215619859334774,0.034483611929094334,0.012189612801384652,-0.003804921098499569,0.07599285032352614,0.048050763860326216,0.05108488912881924,0.03610787553209487,0.02453305649082122,0.0702813268967633,0.0692800885022528,-0.038421774421836766,0.021154670950039107,0.05426342716558402,0.0803497633927823,0.06549474250376242,0.0019442553372189886,0.008784526640153658,-0.07595734625084836,0.04898489692353778,-0.047690041870304886,0.06787484311044954,-0.08790451638260878,-0.008269201311846476,0.03662697693447653,0.05379023599438959,0.06538980515134274,0.05844360598434901,-0.06050666869455052,0.07723770691875946,0.02737400673421674,-0.04828981513216414,-0.07768140350461294,0.035241464403796274,0.05221027385579854,0.0035450431183446087,0.04938397928830692,0.07562729481972372,-0.03404830498906409,0.0867432213332681,0.0075953868648549715,-0.03982800137009315,-0.08061309101414758,0.016611190378657603,0.0623770698187306,0.03812943651513099,0.05543429502710751,0.015534207939065273,-0.020049592250266805,0.0837421841525616,0.05485929632547786,-0.03880306110560906,-0.07497719972385641,-0.025732411791298284,0.0670427414657298,0.04985933087144943,-0.053778693502439134,0.04710050235713797,-0.08179722686232076,-0.04158273143199059,0.033423156017217945,-0.04289176109423337,0.055916910735353084,0.05611631752429048,0.020125921591632387,0.08519739059462558,0.08337596927988679,0.04059560036392238,0.04445646789414789,-0.007563671881251408,-0.08842880978473448,-0.05667620965756107,0.04507334924170559,0.05592760391282232,0.09378262612149768,0.010544968049291946,0.025097992406805467,-0.07741043107720494,0.03573817363190431,0.0416382976185728,-0.045274636074676244,-0.0070142992691212954,0.015335005245827331,0.08941316168184929,-0.0021850046853812127,0.016198167596314733,0.04771093929185183,-0.014688815614301156,-0.04573530414723225,-0.058591903209065564,0.05687851947403309,-0.034243667639216935,0.04543284959108579,0.055279552169375246,-0.08904130859154477,-0.014181011195048257,0.0225325421178519,0.0548913365063704,0.06472120957542428,0.05600836971044393,-0.05711319916024774,-0.07418511204644057,0.02816500896556758,0.09936858829290361,-0.05553546597691559,0.03303853593972932,0.04321708135778325,0.04861985625555533,0.08425445458345353,0.04410329198835007,0.007677646733852405,0.041177649299750686,-0.013690150719399854,0.04946453729627825,0.09206872248357052,-0.0021114289558605737,-0.004882556485845163,0.05304713410751007,0.0425765556449121,0.049917354720405316,0.05811872384005849,-0.09162612721878921,0.04997804995020493,0.04216471561234391,-0.047181913171510596,-0.0306646651039976,-0.07787330544878839,0.045031543142295995,0.08862466081063719,0.040884403797740665,0.057217683511750786,0.06944574320603868,0.08702042020933144,0.0012736942911901793,0.06859146831688698,0.008828026899739798,0.054266908345032096,0.05001365820172408,0.05690451631065057,0.03898676528836033,0.03633564238007045,0.038252180063039654,0.05882819988129566,-0.043012947643813124,-0.08427606430122128,0.018030459632217263,-0.026192112682837193,0.027781559860255607,-0.06695953117365132,0.09011559065824103,0.023588724418971873,-0.0063676983288104335,0.01299427284956756,-0.037280106305663606,-0.054527108524812955,0.0944053944041711,7.273626485865152e-05,0.04099237918173241,-0.07495084246371106,0.07962617071641227,0.03268725167083762,0.0115725381083883,0.022212737903741262,0.07540429416471936,-0.052690894641158885,0.07642968216841113,0.042912055219416156,0.07367153802324654,-0.07491397541981605,0.0774090193264745,0.02722122626950563,0.0035216025373769463,0.010730160798332541,0.0005960145684482453,-0.053328080701996204,0.06318165852204057,0.03682804793990213,-0.027495258260523132,-0.065793774691492,-0.035011204789240156,-0.013455146909870484,-0.04345230041864401,-0.03268094927732988,-0.04987292519786009,-0.06764766075109076,-0.01947683896651701,0.013703124787841253,-0.04764584824011287,0.013618723985852602,-0.009452126938663725,0.08051503579455413,0.07626170504696786,0.060552246161528586,0.006581179032509463,0.0011734621439605409,0.0727878953160105,-0.07379510144903262,-0.09069792234502128,0.012735460406684796,0.027777335860747376,0.08342113427702666,-0.010473809500045438,0.041495742018497594,-0.07692309693671474,0.05207980779479251,0.02088227114456738,-0.04666042224317076,0.019945888797672565,0.014309321657913257,0.07204598401199142,0.0045859143583296975,0.013446900689911381,-0.004008274921976115,-0.05963129456214147,-0.051974985201203305,-0.037133183154770634,-0.003347372872656343,0.05124025886771609,0.0867852539976716,0.0024882707307955884,-0.07453375353801266,0.06019398136399681,-0.004127217735605159,0.03743453043318284,-0.010982147885340769,0.021419475918991085,-0.08964582307512842,-0.06382338340670905,0.10613841549733204,0.06263882098105487,-0.013916121948207134,0.009026732767316269,0.03139716147368722,0.08759861012093688,0.062446735860249,0.02307928509322831,-0.05916691669453007,0.017434132883832127,0.0973418905952378,0.017458103727712025,0.030552389077212697,0.08806700206409435,0.07502065424515124,-0.03734817198707829,0.024181994274883892,-0.023880278578185695,0.002639804553847953,0.10578906087269559,0.031802003182400375,-0.07291443920430012,-0.038914242842633874,-0.008439356669184495,-0.06229129615162904,0.058936981306838505,-0.054669580328256036,0.056161165654725856,0.07348093180170398,0.011835052815235371,-0.030035675851945765,0.009520075992239108,0.0694813138032958,0.02658103713633573,0.002249909757914781,0.03324536692378826,0.05026915188938932,-0.03805595023223292,0.05346602853173109,0.010601585718897726,0.06139317709790247,0.00017568487618307643,-0.025734787974749682,-2.6975422757943116e-05,0.011571011131171654,-0.02301231407209146,-0.08761939379930728,0.05363878275720493,0.03915589061097143,0.013904449311041497,-0.09130115546215434,-0.0027706203005729946,0.05070955036584067,-0.00013568660121615842,0.021536256013661118,0.018255618267367844,-0.03618177558332143,0.04032412457622414,0.010952834121867193,-0.031291538611271416,-0.09108003528327663,0.04775885264948703,0.014168903583061367,-0.02582954574160608,0.044877001791822774,0.03834041732983485,-0.024897286821299217,0.02819650094595264,0.03899599271350952,-0.03649479823720062,-0.08751189125080833,0.039941167797318114,0.029961639180304513,-0.04671613445830329,0.038571592907557406,0.030025006580129795,-0.033135491283154433,0.025179189365465874,-0.020208463456505826,-0.03778672643951553,-0.059880744356730464,-0.03561196020539269,0.0022997982130300585,0.004785301792255748,-0.03687692388183823,-0.013859496897228906,-0.08174229968671712,-0.03335302862138066,0.0007339248110001768,-0.03941734625143692,0.014041464096425416,0.031714550852652804,0.020170779061435638,0.014257981883226037,0.07183827916038056,-0.019203293599305574,0.024125204837947747,0.037282540546845565,-0.09725970298817162,-0.07742932611689207,0.031127870785100098,0.04021376969375494,0.034621348888697764,-0.0035410159232727766,0.02689518936335017,-0.09582423716087209,0.019908863557705984,0.014476253369416481,-0.02201279784709842,-0.011086635658442553,-0.03136854787432995,0.009261557629092905,-0.031214632494308267,-0.029243225511719702,0.025613058849932493,-0.043355296859763734,-0.0247828271991052,-0.03997614004596668,0.030832038677461412,-0.035935585373596125,0.03841235911355562,-0.01734906947161505,-0.06716606525515981,-0.02085145246108374,0.005950274885663321,0.04557334083545245,0.020565226925860727,0.03966061891550176,-0.08677654479948647,-0.09944330767779677,0.05669877715604524,0.00404819076280824,-0.030104136401949037,-0.025667527289928216,0.018035027556808594,0.05413112656787225,0.06215835544908947,0.0026054759539636276,-0.03612131789456674,-0.02473194002459986,0.04836843284400672,-0.008348160530572567,-0.02817446638902112,0.050734443262317755,0.015714544221311584,-0.04524514108512826,-0.029193825693270656,0.02426923240141446,-0.006725569521230862,0.029672203342785898,0.034728959922956874,-0.08122962853445843,0.019097076111373505,-0.018283926348383023,-0.037284703451959604,-0.03560881491392533,0.022092613424091214,0.0210077593984677,0.031184412363168282,0.014850566080687126,0.01995836161933499,0.022788935643780806,0.01583378578859463,0.022942238487229104,-0.025201356885885515,0.03354629500906853,0.04526247482998533,0.04552943135254307,0.050753235229808145,-0.045367792393124086,0.0121817244579277,0.014004040292875997,0.022604691029970987,0.04365261915610577,0.04398181747400857,-0.03033731536464706,-0.08082075214767774,-0.02755928003267683,-0.04287812065508308,0.015584207770263564,-0.0873925110913066,0.02888541233523257,0.02171586336636956,-0.046021752688829125,0.031958886505396564,-0.017871796602021293,-0.04135064903880617,0.07918497668841828,0.03803848232589972,-0.03227786208942382,-0.07931905087672003,0.022433916502536805,0.03601677715197682,-0.018477507922861673,0.03671739712630742,-0.0499761091857712,-0.05056426766977036,0.09392070195425956,0.01795985364994684,-0.04839583645088435,-0.06503342141878644,0.032020963291778316,0.01852445947558491,-0.002195125559637346,0.011971916009239332,-0.036045566596723595,-0.0609483212438632,0.06949576315563137,0.015293003449338866,-0.029841591855138332,-0.08025336461414376,0.025642563560400223,-0.0023573694528847334,-0.04975333094681281,-0.03924321500082014,-0.03942710091582051,-0.08409414285894337,-0.04254924827152845,0.013114784837056189,-0.01756189654674041,0.029275556092987154,0.01778382692312232,0.02100157051566307,0.07188769195647508,0.08590786289809739,-0.015521792780482236,-0.04092310929131234,0.017789845530990937,-0.09006716758315675,-0.10770839337210819,0.03900504645235748,0.027440759872562167,0.07199528797242866,0.005829503120563832,0.028149894449074474,-0.0764288298428312,0.01822980598433823,0.029290343471262227,-0.025482062898296753,-0.024455872333332466,-0.03356377826615102,0.0824858593337941,-0.023753010113364142,-0.019606538823633814,0.01668864454879023,-0.05273817626870925,-0.041876792120105394,-0.056329902641867075,0.042664179549878674,-0.04807543779584647,0.011070307379129382,-0.022444013350712916,-0.06738832127235404,-0.033293324240124,-0.04637992002805896,0.023217149415665626,0.01136795578313486,0.017974958630725697,-0.06405679619881702,-0.07234461264203192,0.02754948681612424,0.08882895430148194,-0.041946831002423704,-0.016007284490479324,0.007334130046031642,0.025297135085099114,0.08870738096997263,0.03217324533766148,-0.017214484431679087,0.0019733472500738985,0.013647139461755296,-0.010960151640962928,-0.05091237412105426,0.0432012291098152,0.08267918764047202,-0.04975817406379787,0.031134491535342763,0.014754127611005058,-0.010179363452763959,0.05199786566825862,0.020711224018901058,-0.0686309172091696,-0.06052047494533105,-0.01866371568920173,-0.04270145737656528,-0.03761903058283155,-0.047887133942126105,0.03128548564195892,0.08678024550208616,-0.019009296115239376,0.00581791290165794,0.009993600035794708,0.07524898000206495,0.04110169523084202,0.016073749515715805,0.04296526135921095,0.026771093485309882,-0.003272986433727957,0.0938719899246984,-0.0416740123223082,-0.045124709499167116,0.031249183124027927,0.012827215664472433,0.047465701271188876,0.023733571825290265,-0.05742954495030734,-0.08996583963760854,0.033078476488914293,-0.038150397489423754,0.0324752470629361,-0.08507977914088136,0.10905680836836427,0.028733909042154754,0.012428904320060325,0.047703730906229425,0.0004112246857929236,-0.043088812040469535,0.07603015249394994,0.001964341962451128,-0.0032254387593118137,-0.03844391559145313,0.06949664481633737,0.018250152860330854,-0.02375616531814905,0.04315442622908174,0.005720086413871791,-0.04767734206544949,0.08091701110109496,-0.00820435183581038,0.000326397916154488,-0.0761060373526139,0.05044218385742624,0.017692870019265675,0.019509147349218853,0.021300982766426706,0.01727432812564955,-0.047269537188954276,0.05720763111455664,-0.0069254134435285655,-0.021752988862416986,-0.06911925342547347,-0.005249932023530755,-0.005638415133347422,0.06018693353010503,-0.0645985768536454,0.038529285381101445,-0.09132093244358623,0.0242368151118829,0.0166825263326776,0.0016955611844524773,0.006352575295447534,0.048388442837667536,0.09384573315787743,0.035083793765877926,0.03956558204657885,-0.019605325435211714,0.04469869067307393,0.08337794105236082,-0.08114348297170323,-0.04502468807661636,0.029879415499492707,0.038898008204581655,0.07032591429813399,0.031168115293556772,0.03989753043108843,-0.030157050834886154,0.1016704422843919,0.01886865232538922,-0.0642938944979283,-0.01899281500103015,0.007119106163356918,0.07356964285250196,-0.018256096807778312,0.02283745026988138,0.0299178410405046,-0.0511716860780198,-0.027407215234212273,-0.05517927622293607,0.0330025575660128,0.007929673533574612,0.06232276605322362,-0.016787191158077197,-0.0718775376694529,0.0188673641014885,-0.00048259540993580416,0.04541707095845045,-0.00024339782398092092,0.028722046793843423,-0.06310129290215494,-0.08410450197121237,0.1099237393466881,0.05984192248854431,-0.05461827155376063,-0.0018053880265468097,0.0013848489551136435,0.06531730374500971,0.0456019375770616,0.03321226355998641,-0.0277120156459602,-0.011912254990475884,0.07300665861400996,0.02112506408749234,-0.0032799008567154114,0.07919757190989352,0.06399574811607123,-0.05938696521449852,0.04069515067070407,0.028699503434184228,0.007406703847384107,0.07550141082556677,0.053067274461972506,-0.08189534348048627,-0.020083013855554294,0.041982010033154396,-0.034529077892317746,0.01761887939010728,-0.025172927562724656,0.0939453760715624,0.05573532809816722,0.05032679403714223,0.009378445323305767,0.04544205050838665,0.03902832693836952,0.045250157923500844,0.043811636119977244,0.035878382358134134,0.04043606558201834,0.03953265495579276,0.08469793238566643,0.008116377207223932,0.007436236635706602,-0.003322555282864564,-0.012227296694700431,0.025303103112747746,0.05118223735664358,-0.007423840743893478,-0.06104514027765659,-0.01170027972600387,0.05022624210126966,0.02088484599448853,-0.0705372180780339,0.11179527841721687,0.04073765833516346,-0.001115351580212609,-0.005499451064956517,0.08448938480059184,-0.07568935401934639,0.07032987917350501,0.0029492090750508006,-0.04784786382019668,-0.09725446236009562,0.08691516757903384,0.04495794656906064,0.013142740489170912,0.023108432114185985,0.03883805523140489,-0.07085558889703875,0.09027184001304142,0.021765248513197333,-0.05166850928426123,-0.06412393067417609,0.10978728730296883,0.02588653577618142,-5.2407185127633656e-05,-0.002953220409081841,0.047951648217514145,-0.037922378148602116,0.09608721489516452,0.03812420088975866,-0.046632067898031024,-0.09238003522461079,-0.054100114540498956,0.09205464493117362,0.05499107065233456,-0.06576364668460206,0.09114317366547986,-0.08560744488461897,-0.02901519418074084,0.0011177180826988208,-0.050444255038071845,-0.0062358326402533045,-0.0055722234571981815,0.043867950481302674,0.07762626497924721,0.07364911752185915,0.005854645849719963,0.07113814047683217,0.08102625514265299,-0.0630736886983186,-0.06102625096709671,0.053320052696205114,-0.016567870560118752,0.07129788388926755,-0.012926525213174214,0.03310764250730495,-0.078444257215833,0.018633208832165633,0.04142186352008746,-0.017830960451471853,0.032607425470023294,0.029479833407814925,0.08755917084399588,0.01282322487515875,0.03434016631603428,0.010313198321254054,-0.043307969711393376,-0.05236823557143089,-0.0609924328906396,0.009580164750545779,-0.058632107187865705,0.0910849219230536,0.05965774693442809,-0.08113326999730365,-0.03671644820112412,0.07377300594656903,0.021800377338791834,0.03365029806422948,0.01446076309923696,-0.044754392026453156,-0.07659970527519393,0.056954496286688944,0.08008174285193752,-0.06539366253917109,0.008588213489225408,0.05503558900783811,0.08398915158910711,0.07482136898160499,-0.04678237448693381,-0.06164934620774518,0.010264380343526584,0.10595399383512957,0.001929910058061415,-0.025560102540734406,0.09500860076308103,0.09010963312169092,-0.06002427104810262,0.021116753857739312,-0.002453579409005067,0.00033331913186996373,0.10880535195127174,-0.010383551825839023,-0.08250815850663268,0.06402875117307012,0.01350248648445977,-0.002528485941700829,-0.04318196292403676,-0.05679591076673971,0.10917774283117229,0.07965571261379856,0.0538099264878868,0.0089269113558746,0.008160274023888655,0.08218811670380202,0.017584716947940587,0.02828105878669732,0.03405333719212104,0.027517068387557197,0.06580600799075943,0.0858126827084106,-0.04746190163142211,0.05750524043924628,-0.008667190594827553,0.020613686770923283,-0.023474138756337144,-0.030527014143649257,-0.056162819775492506,-0.07528067393182689,0.02380434727106677,-0.04039215311921237,0.033547334034013956,0.02941398635132732,0.050995253614443806,-0.02866742709721421,-0.031010993248534274,-0.006872455233715256,-0.06285343414923643,0.04026321947433796,-0.012889992181381541,-0.03594678477415228,-0.0910778064824773,0.034207436370040166,0.002442892758732659,-0.023930087774272638,-0.02043725116441556,-0.04649954341045325,-0.060566241885029716,0.061355441803781066,0.003310981750384739,-0.04787397486281025,-0.08242642751165065,0.027280966222113644,0.05016351596890248,-0.017188624400326178,-0.014848310182440061,-0.04661001596980933,-0.05591014045810887,0.05809475023848792,-0.00856458916533597,-0.028271861337143538,-0.08920444870779069,-0.04495068191131976,-0.05931758433331319,-0.04303323090000507,-0.05779807076160852,-0.05202452758373398,-0.0826292171767014,-0.05196128792731886,-0.013493861799468654,-0.049178640627702656,0.013502324993378268,-0.007532966748169328,0.0029433211604690092,0.06469202019356984,0.056747648523541215,-0.018682970358075902,-0.06325197282675751,-0.0030292423298914563,0.06020186861061051,0.056420893108934764,-0.008301310880033934,0.03026770543042732,-0.08329664405921586,0.007122328512770871,0.04913196861355003,-0.060392063583732086,-0.011064488618670307,-0.025018615299623147,0.061752491081367655,-0.03565098479824253,-0.042252469217103815,-0.019508602691821076,-0.05604407431801404,-0.05483774928455477,-0.05256441341749925,0.0073134617512244275,-0.035138011958392924,0.020447051489575617,-0.03759383248089399,-0.08767649330627506,-0.032542435375948364,-0.04995830915141664,0.020822515480539164,-0.017380717862454525,0.04792950665616125,-0.07097068077334581,-0.08719170311514197,0.01598728922270285,0.07630090019522105,-0.05833808908779113,-0.04878286242114953,0.050858243182532945,0.024622022504196896,-0.048206478920369646,-0.025497361767879947,-0.026794354534712492,0.028146841789003122,-0.03350368435479704,-0.048866889699252014,0.02969917059002849,0.06212324400512599,-0.03973134142711318,-0.012514794600778655,-0.019502977371474297,-0.009547369242995117,0.012352306109302004,0.012536164478917167,-0.08348756377178933,-0.007667377813716186,-0.040972690489400256,-0.05648741598080115,-0.049880740220159085,-0.058136589846377776,0.010289178124054573,0.05512801213726512,-0.0579017475201054,-0.0055493281242590215,-0.012255311958697774,0.06553195306665338,0.030175289306310922,-0.022306562893529985,0.03541307296017934,0.05087769991494299,-0.06630990782765182,0.06258540977369545,-0.0567987570117095,-0.0433196766689948,0.021994688229018244,0.017938045717863213,-0.021093567417671877,-0.07208995437546462,0.002927333381659001,-0.034467318769076764,-0.011813898703786279,-0.07609619656794017,0.06924219007816808,0.023427169906722025,-0.014590007353230674,0.01403540729512611,0.05385900262323024,-0.058490505670003606,0.07848009637612036,0.022104965026954238,0.010495443743977926,-0.09643577470508452,0.07342599037825978,0.036862523178059596,-0.014247563003012153,0.002624398132252559,0.04817533241637922,-0.06925384535596946,0.06948508193855184,0.06686301017255256,-0.023173534224664716,-0.08304191787077263,0.10385006922143997,0.018781102988155225,-0.0058586194508351685,0.0027528495999589193,-0.017587377285444312,-0.04198974651554,0.06346824249955804,0.003964321249931931,-0.022197449715749634,-0.08725942055862915,0.007304851993605362,0.02552955024481791,0.03682155696305296,-0.016874076072049778,0.049566611907148055,-0.093852884205998,-0.020395848504811697,0.009006731620865563,-0.012510841985822129,0.03219484854544841,-0.01936787919636612,0.08423081788859439,0.06662686443871416,0.06464681790281086,-0.003395603211908613,0.010677290786994767,0.094093638969094,-0.06532131281909605,-0.07186161138106041,0.06626332059031705,0.07499567305451851,0.037962839533917825,-0.10061519007502355,0.052474875029753,0.026902323307280478,-0.021069057223486565,-0.025664480053006623,-0.0057177855490055515,0.08421520388127232,-0.022699845547240076,-0.010531468986799807,0.006167836925138503,-0.042027312382811384,-0.024793533293327126,-0.03692288822941256,0.037392352285967316,-0.03390571547090421,0.10579937865007324,0.0035377587025574244,-0.08019556006383581,0.024251092937126004,0.05630594432808399,0.020932323787568676,0.01623464812158389,0.009728868620482846,-0.10318765276209042,-0.11126250226148515,0.08215686036084563,0.06926596247147675,-0.023134245609047043,-0.0119506191807631,0.03679912133148809,0.09994269573427586,0.06676892911416743,0.01259965403473523,-0.040342276671583986,-0.009930594497783192,0.09410085081161072,0.058036986075096234,-0.012194274073315274,0.09816014744287226,0.0686561252055291,-0.04078370575607394,0.021544504209730225,0.03140039192099395,-0.016843653167513205,0.06806312691569749,-0.004616473178338737,-0.07901545787378979,0.015605036191998664,-0.011616531540413531,-0.024597775495257355,-0.029869115339372875,-0.05557145198033166,0.09164248582825144,0.08341172704884882,-0.03807804965537357,-0.029239133626180278,-0.00582233919097174,0.06527545535294925,0.032098173720163076,0.04588654544995521,0.04476232959454639,0.022270673467330835,0.04399789247731698,0.07780697372039341,0.003962407420181115,-0.0033418940467501786,-0.005918685833762968,0.028113988379640235,0.02745458256438729,0.03502186232781966,-0.0027361421537493258,-0.09587186010244828,0.05318022866492944,0.011513671176558144,0.0342099990844599,-0.08222434148338031,0.06399502591660328,0.032692614795039404,-0.017484370550723237,-0.0005746405510136329,-0.04893637846740676,-0.07012656939141082,0.0811911320825802,-0.0024379640481070435,-0.057627541434873725,-0.06473975023658665,0.049663041218814506,0.05552649276858967,-0.0005607811743473493,-0.028689957398876677,-0.036449194248448856,-0.04605661670606107,0.07353992809511514,0.04166402739273487,-0.03316422757510212,-0.06235828697523766,0.06792674164976588,0.05925399381124303,-0.03564971093383012,0.0026887437794981066,0.0487985392990919,-0.041962030309279134,0.06912952860737512,0.06984529069187437,-0.04274627916199624,-0.04096816965847642,-0.04707481791848957,-0.012361819339733744,0.04716491192403308,-0.04258220865518598,0.07492304085780095,-0.08233034714765744,-0.04117566237211941,0.03789112194812627,-0.038265705033922154,0.04714350185681067,-0.033294855924556395,0.09469494604793881,0.07228768056298333,0.08520726314555213,0.10892124165236447,-0.027356318053676578,0.07209051807308588,-0.08289808929016279,-0.06929190366924444,0.050832405463760555,0.04988653331294273,0.08747473040519249,0.05971266389423776,0.03523313387008793,-0.058232562797212256,0.11043466858342929,0.04269305433993504,-0.04854139157148816,-0.0410390653468271,0.02875819743919883,0.08133662029115378,0.01761280371868044,-0.01877954955304198,-0.04294114561847408,-0.03823109658615016,-0.04047160191294783,-0.03615715350865617,-0.00814712441322858,-0.0375807457874156,0.074794276128984,0.0344950424757427,-0.047065085839668126,-0.02681815853278146,-0.023605742623323968,0.052388124924850364,0.07038576767102492,0.0425938240067582,-0.03943461287736823,-0.06053284220844626,0.11201444570941106,0.07369153346001307,-0.04335175688538845,0.04955334257662389,0.035495437485650906,0.08650713167071371,0.07340097602858822,0.002016655489124619,-0.03677346805274698,0.012042345595690885,0.09513133852019981,0.007579154430509321,-0.037354583007953066,0.08267197206592188,0.08016847180663801,-0.03073059921827332,0.06468775257322079,-0.01883088348604606,0.0030281599748842127,0.03754715994671779,-0.019959701099903908,-0.06866818849439224,0.0446673760573623,0.057285205532242464,-0.047627510901217744,-0.03633308630364905,-0.03873612979515556,0.02022231879769633,0.07376807861760794,0.03915834588492735,-0.017313441644047908,-0.024658438727182836,0.08040212113922462,0.008307920868790744,0.028706334967897436,0.0307142623406996,0.04906146645634508,0.013116695021534732,0.09009783345258295,-0.023404080155906924,0.04213552832623683,-0.03244821333454506,0.07472338951619142,0.05737909660389609,-0.00014359868877207376,-0.04629373948738416,-0.02222277760331896,0.07590903828205214,-0.027995735569356688,0.05799293508642956,-0.08772889450893581,-0.0010690157348468925,0.02785109330685361,0.006161402866456428,-0.03672448669256113,-0.05642983350280223,0.0031990004354580134,0.07928274524219141,0.04600063768273564,-0.047748287889855356,-0.08888258941806393,0.0738882320645976,0.006193878128989118,-0.01642104464175227,-0.06328361531649714,-0.017308931300666523,-0.004129277050650365,0.074326123562785,0.05908167154440052,-0.03884163562747346,-0.102690401855231,-0.021464540336717595,0.028583206589303793,-0.017398635988370652,-0.021757612502212368,-0.011127426804724932,-0.027516793259466446,0.07890731479196081,0.06079172621189309,-0.04590150375845368,-0.1069223231596499,-0.044318736763488346,-0.013001788949121061,-0.009155770605890632,-0.028508995024698815,0.023883257584498958,-0.0467810559704347,-0.037359398010932014,0.0654128854089667,-0.03661141286955019,0.06174841836643779,-0.04210811311896535,0.09911673575133616,0.05780562033029309,0.06956167421345645,-0.012751816570754753,-0.01868749223566076,0.1121658216360469,-0.09575904281928638,-0.0924216590828311,0.00835768036432583,-0.02650594987981974,0.08189245125088579,0.0589622506256846,0.0031353169763646436,-0.0897901082320565,4.331666803507887e-05,0.0001547402106059189,-0.03988264373093365,0.018216398668685983,-0.017606609826159338,0.08176816727599681,-0.029086891687333902,-0.04047387183525157,-0.0353756432535233,-0.03706648145589346,-0.03739006998978923,-0.03727077497050288,-0.019419195943020582,-0.03614360966594631,0.10262375477197663,-0.04643976615407563,-0.07298751035844822,-0.04547418198882495,-0.022920559758125937,0.036967667374095035,0.03303472785577795,-0.035692079689164505,-0.08017151357646016,-0.08241386080303625,0.037251964546844235,0.08716371053271757,-0.010150859528729322,-0.0018528435248856574,0.027203479309092456,0.08506433673269267,0.07922341903265857,-0.033668164530398045,-0.01180748632803352,0.04182806015741846,0.10612559756645394,-0.006398577860641516,-0.04764690691395489,0.09764956613387844,0.06719302513989805,-0.0003535996592040854,0.07121241993210171,-0.045249697130963294,-0.029917579114891853,0.09265114800634934,-0.0011234263031866558,-0.09823807130724932,0.020604141536499414,0.0013123280868020486,-0.023279328123600833,-0.03580162942257739,-0.0500840749907948,0.0768845056225083,0.07531331411958593,0.035355246886161235,-0.037331096527162703,-0.037220856046764006,0.06558411269726373,-0.015181436693417177,0.056786582030051366,0.016969465522769855,0.017751131025287907,-0.04660332223276026,0.07828223771236967,-0.022720276363821013,0.01630423061677511,-0.028751559669473917,0.07773638889954494,0.04953426915203906,-0.03139963556415848,-0.03562682714076215,-0.05852177659695066,0.05254738256091718,-0.07152577043789096,0.012179392646828978,0.025667320723653585,-0.013741826316250922,0.018335271583271726,-0.020989865000769076,-0.06607521203234594,0.04946426459862382,-0.009302178270967321,-0.03398020260598994,-0.06854325233640006,-0.011641637305860495,0.025184542829618534,-0.022270227999106263,0.008879534471208967,-0.043834378932105546,-0.07110070148950881,0.04749218402428866,0.007636555835124742,-0.035412140526888417,-0.06443986666187076,0.010000416856427689,0.03549425450656151,0.002743457715808718,0.021301197539365532,-0.05301286720308648,-0.07069667770620704,0.05732318748704286,0.004138865467499279,-0.03565128550977154,-0.07457735830143185,-0.04623335535303615,-0.046305504739798733,-0.03974232188413885,-0.055098272708332806,-0.04120056213794498,-0.07782925215887423,-0.039591543008000746,-0.011361362633227214,-0.045159128699735415,-0.003352658302979931,0.004138043634990701,-0.03383264568149494,0.06492900686465336,0.04417386844535439,-0.006270131892855249,-0.04830560247292187,-0.03523586988476452,-0.08234861287123561,-0.07294446480840011,0.055422116678008865,0.03906721833344192,0.05086904304700796,-0.013261814451868333,0.04417740731143501,-0.1054927802778593,-0.03444082799140309,0.05029305564380484,-0.09041599235071955,-0.005444985014166809,-0.0191454642403355,0.07257341333964948,-0.01334050572010577,-0.015286302991502701,0.015473083542889236,-0.056449931961985216,-0.07250811481643873,-0.05420878307278147,0.01668245602643053,-0.04520858575965993,-0.03428258325912433,-0.039222957588368794,-0.08864519047912209,-0.03671330845307865,-0.036458324181850486,0.04880745915991472,0.0060809819504236895,0.0447622997184662,-0.0990662028351194,-0.07444626621299835,-0.048567341245902736,0.05062233716037193,-0.07444569898849819,-0.0060402296806453155,0.011160964853637842,0.007766803288173602,0.06005511184632597,0.0028942368430044003,-0.06374660379054929,0.002842515374772177,0.006043567301210612,-0.0181549217264315,-0.04507892530649878,-0.017592422079197267,0.052762068502115525,-0.06641246103338666,0.010429211878284389,0.022868887455559234,-0.024373869720055005,-0.049018835899089716,0.026320377712922914,-0.0831173735358702,-0.035819148758845155,0.004651885393517349,-0.06057623713779632,-0.03495503031565547,-0.04611985748895769,-0.010542456416388284,0.03942275766342063,-0.04112033302200205,0.006627135162661016,0.03578308753038428,0.05793907613073748,0.050308249847613014,-0.0016309865620729525,0.03967383203835964,0.0483825346349707,-0.03980189383941257,0.04763942109650808,-0.04531267144294215,-0.011329829569857404,0.01577333393718375,0.012459468844427243,0.04106251534116568,0.028325254688227584,-0.011144350908348834,-0.0695274377942453,0.03668029091337877,-0.030087032166516585,0.02130258849521587,-0.08635666905869092,0.09973294640269838,0.031643591847600044,0.033006929181784536,0.01241037294903906,0.040961824961322425,0.024475181218039474,0.0802475849298849,0.028584290824498537,-0.006288995026874521,-0.08541829095306026,0.08036665510312498,-0.004459420079121018,0.027918086046341155,0.008788299198942438,0.03620549714382504,-0.010536316822260888,0.027673501043307,-0.06778414625856992,0.062473476024480216,0.03306880074507721,0.0323591225754675,0.015125872131654974,0.050104051968088835,0.024927343567115966,0.0907639326222879,0.027889771812473145,0.01118537612530964,-0.011296762240530204,0.0036030160867318484,0.08496421893749016,0.03657449707265888,-0.02178776575226617,0.0466311178203307,-0.0916048558291784,0.05257024262844224,0.03268202585093762,0.08100619269008498,0.005136332100907395,0.002115706334932522,0.10698194609459745,0.07692232435643964,0.06447694141083499,0.10580216379213936,0.004956428664510421,0.09705775927852513,-0.04434687252519302,-0.0473677202285091,-0.037797580342692774,0.049933799154031774,0.03819050695760952,0.044737421866692224,-0.005080140448517787,-0.07056315010187666,0.08602282861820004,0.026455932832532045,-0.00259884982250219,0.09112746245991428,0.11456750808414821,0.07297782303186914,0.08805483980891891,0.08186635594663465,0.0314457566774158,-0.020532433399008117,0.0008675736057959355,-0.02037663645040397,0.07719005738493873,0.015237885784154368,0.09477844309362772,0.05733276185015356,-0.052961982943183224,-0.04061463512076514,0.02963304379263332,0.010703678714595686,0.03733094696771198,-0.10618001029601314,0.09575570486649913,0.07688135002020668,-0.018281061647247843,0.043506127695881455,0.04261248627653181,0.09482140082873287,0.062215253924350705,0.07344175599595279,-0.0005413942548831546,0.01653798023383734,0.10992785850041203,0.026950554721780328,0.05954503089528147,0.10791802269316618,0.06900568900281195,-0.020090573257069574,0.010326984831335225,-0.010178764109543378,0.027931110688285618,0.11069711857051447,0.018658609584012144,-0.07476655447638156,0.05181488192998956,0.007174625393610919,0.013934883619919224,-0.04314114417527102,0.013899822320187058,0.10161380268128618,0.07851151846462548,0.07155099869572198,0.006199077606667387,0.045028070125756145,0.08199439076008168,0.0336728699311173,0.017017877379077742,0.030623015059223765,0.058918541070860926,0.003629720371965889,0.05150204510002941,0.061551261871604875,0.0038054918245222585,0.0673928252196575,-0.07539903458424763,0.04293143242073958,0.06862018555858501,0.051785973689187,-0.07652374583741836,0.042807931487516965,0.03898542946508508,-0.0018060677732979463,0.018021756443712296,-0.027491351567237858,-0.03776269297633176,0.09211243020909986,0.019497194128994543,-0.0421580700403045,-0.08564948182001796,0.0736298485260617,0.04862939666747166,0.06133328082241093,-0.010738981949883476,-0.005820191898681332,-0.05289541348058903,0.058798824185690574,0.04504916439383559,-0.0425490230818442,-0.07451456388021206,0.04711642797123941,0.049626921871998624,0.025075478727645976,-0.014096386268883104,-0.02721570011845512,-0.04255270915105941,0.09732457193704656,0.009820612801252007,-0.04155789586015458,-0.08663875872326846,-0.04025744700730435,6.0160688670880705e-05,0.0017169306136794302,-0.05619001367718443,0.017063405322050553,-0.07260152098459025,-0.024326337122407397,-0.013974764414873234,-0.04351511585017205,0.0429774924503056,-0.001771748881507306,0.05511095586521319,0.06335752730965301,0.06909569816369131,0.09087044935895333,-0.012050018065829548,0.0863838837466892,-0.06554339857722702,-0.08393757390588899,-0.005925433980946041,0.045461438159914457,0.07773966939982922,0.05282318572598071,0.01731300970920419,-0.03478647023351851,0.06959336116431955,0.01735512452310534,-0.044794954086996484,0.05318769353178042,0.067324721458668,0.07456345464146664,-0.023981391441614444,0.06692968085386103,0.007704864541883961,-0.023379122928867166,-0.03990388042182703,-0.07891256116896808,0.00597063175937953,-0.05337762841204256,0.07926875015449705,-0.014320394481424017,-0.05948300340662334,-0.03343140295729818,-0.04060639479393771,0.058080277936220795,0.012612666855722715,0.04515344978741508,-0.06509818242095097,-0.06396525761524949,0.05100820583920275,0.06860860670606167,-0.03268243561954776,0.06972373648537745,0.04051861120164277,0.07880937073028763,0.08117367446075457,-0.017133508249320657,-0.017133295588324098,0.037542695204573824,0.09556485564764827,0.010959725909692302,-0.043008024547202275,0.06519930076979463,0.08831132721378701,-0.05003394370124183,0.053933215831551695,-0.04131037405871357,0.02122312260017696,0.05829147674016768,-0.006629090253852507,-0.05993966692526537,-0.04332246114769234,0.02111594595206757,0.004473822177510936,-0.013377018564664587,-0.05996061381088585,0.062195357883995224,0.0997136580898556,-0.03258181597489585,-0.0025486601352820853,-0.0020086816906819955,0.08272253525436254,0.04620910128468394,0.00871250143462199,0.05291811199975237,0.03654028052367882,-0.03830319128692143,0.08026488480339466,-0.024398398040402294,-0.04826176658607484,-0.023773590796440414,0.07722548924624943,0.07987265057080793,-0.004169798029609956,-0.04558375434704922,-0.07390992803379993,0.034041251955188194,-0.04197524158335071,-0.01821679286193302],"z":[0.027185620177480108,-0.027334225533715027,-0.021526586488983993,-0.048451346018241394,0.012331008232876481,-0.011463591330322634,-0.06909069244555921,0.038243838154601126,-0.03265481612605578,0.009793579207562842,0.029553442810160646,0.045492865946471985,-0.07319487469929181,0.006572143891023551,0.048395677184239545,-0.02493950974787158,-0.07344883950214129,0.0409045170150724,-0.0058710267730849065,-0.05588773853637125,0.030089243428402673,0.04951206661987962,-0.0923138688762182,0.044595079170375536,0.036971822234029575,-0.02324448650638562,-0.08381032242175225,0.09711221803039272,-0.009745526773509594,-0.036016901222742696,0.023721538316655237,-0.015595079207834442,0.013517383243668355,0.008094252110724984,-0.06272887325714425,-0.0047121237112466696,0.022348229514130978,-0.07163428645519769,-0.00896903276926423,-0.0026672371057915576,-0.02665512332365393,0.033998188292994225,0.03779884994783262,0.07226133376624301,0.045614073786488595,-0.012529459921237386,-0.02534111043965915,0.03686404597591281,-0.01529276294341503,-0.015532391621271303,-0.017097711432288158,0.01307898378230508,0.08563075890248142,0.00752296190856989,0.02633633059342493,0.024398604461333212,0.055419435433939436,-0.011288879815481124,-0.07434045080106236,-0.01699263117119776,-0.0056699703650849535,0.04554915062645123,0.0076148850410971206,-0.007308065063917035,0.018556814296235416,-0.07596259086521456,-0.07583022931372882,-0.08566349551901395,0.013080434402644376,-0.0123977474803193,0.017895244760708993,0.01630711658152138,0.001469854167514888,-0.023245398550191646,-0.02769871115803291,0.013798857734259111,-0.04101864427810432,0.040450276378860596,-0.026418524821017628,-0.012868731080825816,0.045006819234785486,0.05344249890830795,-0.08316892567237684,0.034894129708813525,-0.13780851042151837,0.02014063083718337,0.078295143183222,-0.006808962924932846,-0.07324159191313129,0.019561049418414696,0.055020346533366106,0.010458331739409056,0.018818682446719456,-0.018326338176095358,0.026859281174483964,-0.0656964173582425,-0.02788415916600678,0.026957573810918508,0.02184613373763146,-0.05551843942020431,0.03219856138412517,-0.02027052856097848,-0.020526289593520763,-0.009428819362450939,-0.05358805570461744,-0.01286865226379219,-0.07324567616172287,0.059963142403793884,0.05798959407083215,-0.025012569561339505,0.012836746155235437,0.025636415928913848,0.03869366303021763,-0.07786790438709293,-0.02009412901389926,-0.0009273031122361395,-0.024228995026395788,-0.03097902553144325,0.04277407626192662,-0.008973119713550118,-0.0025399827211376263,0.016298950231192173,-0.022934543098824443,-0.06501997160481328,0.03193007442639362,0.0027132600891337532,-0.000676157681812057,-0.02011348251003975,0.02570992463625239,-0.05022946597730179,0.00034923271030577627,0.09714434721581922,-0.12334871351400403,0.03602216417604342,0.02728566101937158,-0.03544288748698684,-0.08605058955160488,0.02643587134674136,-0.028331002417889065,0.0006837011867044907,0.02445887274159317,0.08400391726894366,-0.08654022048342204,0.013552365733692485,-0.00666153433866502,-0.042212535880861365,-0.06342545995126772,0.003333087404138408,-0.03567687905337107,0.02328348049248507,-0.030256783085733395,0.08388179065160219,-0.031800747754140546,0.048661620704675584,0.03048651239944747,-0.032070056194576486,-0.091430214037328,-0.015509798933130065,-0.02334662233971577,0.009896777940724391,0.030169859136366585,0.011857223601945204,-0.03829664008688008,-0.0279418478109096,-0.07709447045355936,-0.03706327123973826,0.024222979589973475,0.016578199064956303,-0.016408023227974543,-0.011288963868764499,-0.047981725634394144,-0.02940512902605479,0.08595719987489692,0.07777204031410048,0.05556888206732896,0.014587515118058154,-0.028209542386649834,0.08864698914927939,-0.012181536355106217,0.015027111957901837,-0.09594949067725618,-0.09566123470834376,0.016825528847030768,-0.04451465933892976,-0.11775449297569476,0.005389039908231574,0.07618457372209736,-0.10704914426237604,-0.09338226810430657,0.0331464844436354,-0.0020172350994825897,-0.036773982072835734,0.07087602048783302,0.004932831255347691,0.0063559679302266315,-0.0695276497036309,-0.07966569398349295,-0.0694029040001252,-0.030108369187218553,0.0015940426962970278,0.044729652181523936,-0.02678135328186186,8.960082233274966e-05,0.027995874424002865,-0.034350388538317955,-0.011091981997555669,-0.058586095687141154,-0.0807480186744258,0.016604176702120707,-0.012788868651205768,0.08404760826318364,-0.006310321846463657,-0.08777401206106351,0.030366618021574546,-0.11491023972461777,0.04803578588397358,-0.03300027076490556,0.022660017862723907,0.08298884737978983,0.014667842201906773,0.026658099389952627,0.038568121561101176,0.056491539674123986,-0.07984553320081969,-0.018968637199090237,-0.016131291139377685,0.06481251810574294,0.06596820220908196,0.0023534453297038814,0.0016682223394531353,-0.03769782575653907,0.06521371609951623,-0.060071301273031216,0.011314380327971373,-0.07358137061713756,0.06645891956833964,0.0007668775349752572,-0.04372364277560546,-0.029842038835356355,0.007152563584286846,-0.021682022587508655,-0.13155463433802905,-0.03444684644711578,-0.12127967567973748,-0.07728288252993501,-0.03198878146060944,-0.027409059132642823,0.02326967286634369,-0.023410237196836436,-0.040978058271339525,0.004304890473372072,0.023755253692825606,0.0031140399246686297,-0.01876630772171266,0.020466012275755507,-0.019220059569759605,0.017796759994640553,-0.04612170807971921,-0.08785706783100349,-0.053318067665799794,0.02843186156478932,0.006114147552729878,-0.0690316277286785,0.06500082912819609,-0.01827986049911903,0.04729120414473823,-0.003885604221808032,0.0022206652541722598,-0.10751448905265154,-0.017715418624980026,0.014881677601485527,-0.03433380609164569,-0.05874362786703491,0.018957726223238422,-0.004438302794155305,0.049082348249998214,0.005562273703238712,-0.004870016491924682,-0.0874347003565164,-0.021385176603363736,0.0038179030846994463,0.00176985818706855,-0.07816913927095083,0.06787220344571859,-0.000656322581871895,0.00626761634835371,0.027249835217906953,0.003646480104916108,0.02205779540065994,-0.026496062485795675,-0.06743792477078668,-0.03821420633439724,0.014063385322902675,0.04557319842760005,-0.017413776146319743,0.016631156022708045,-0.007882358558215995,0.021186047204599687,-0.08501001736880073,0.006661638287825183,0.07502894964055276,-0.013079100597380575,0.004620667168848034,-0.045471521065374755,-0.020496625308503498,-0.007422822660775494,-0.11896402895972688,-0.08584222168963702,0.08113377556144177,0.004037185404288289,-0.08475326327678608,-0.0006624463184762753,0.04798080258379189,-0.12231710888055558,-0.07354987582389709,-0.07117607167846562,0.018370866165065752,0.06735372300580916,-0.010492336648144937,-0.022884506281759972,0.011777014155142039,-0.0748897187326693,-0.07133772420736545,-0.07725193215322455,-0.01672745668336098,0.07143561315447892,-0.05528359883078042,-0.021669782072349947,0.00387055648357608,0.043239121171849484,0.013569005984526353,-0.09587129996543671,-0.017311529186853504,-0.09940026691047663,0.020573702165517516,0.006126018419133585,-0.02234070161418532,0.03474594917321916,-0.06390387463432826,-0.02181634063786089,-0.07672096315790435,-0.01967787118654515,0.03228509034566793,0.005606264771884639,-0.07630838678878532,0.00662496673622441,-0.036881880461338105,-0.06222324893561788,0.0788821166555551,-0.07269758349034154,-0.016259906534481526,-0.06533429399927053,-0.007341909731188659,0.016702853297370757,-0.0772485359797857,-0.025468977400085736,0.030155322306049066,-0.02102056475218048,0.017973835195697764,-0.0042674193944226635,-0.06663138295811394,0.048888816914390544,-0.05769334531090771,-0.07341073046472235,-0.024346679701917274,-0.003972754449461801,-0.00877014051630477,0.01680212066158184,0.03945728186915928,-0.07365709146925213,-0.016005628883770776,-0.10143387127747887,-0.1203991379454955,-0.012273596489896637,0.07359124462985514,0.09425752595944557,-0.038668145787611276,0.0030891786452499495,-0.045959682323739065,-0.002768731646685125,0.03023477887372955,0.09148431582501061,-0.020538125668216282,0.0008178730257032216,0.068251637176674,-0.003081476501212826,-0.015726861655569628,0.0755024906414239,-0.10009765036877592,0.023143863228506013,0.0002835795843017331,0.00983602391472221,-0.041517199627686865,0.06418218050183977,0.025021881628982754,0.01546663221117689,0.020122929549041563,0.024494819080958387,-0.06265471440284766,-0.05985494182121388,-0.009114995480090518,0.0009812867231276665,-0.012491122747435591,0.0718319574443287,0.001407373073284346,-0.012430299516642448,0.012038698192240769,0.057179019953183044,-0.09418545442651452,-0.003707120622831568,0.020692084982910905,0.00915405393412705,-0.03818793933865203,0.05962997050568332,0.020973002193260405,0.00024063426283271874,0.03343980379812254,0.0020249285810079558,-0.010243749437508488,-0.00899822251633432,0.002940629936250976,0.0364433383834363,0.011505436103661608,-0.020843685424745934,-0.0030839978153922435,0.004769710676398725,-0.015929738033998254,0.05060420565439356,0.05741252667415882,0.08962526143478444,0.0387195116122079,-0.03527477906196053,0.029641078724422093,0.0103988130439769,-0.0048252001383798865,0.010863286170518757,-0.08235391464455477,-0.07535163150276893,0.06538094419935848,0.026476579551792032,-0.06191049604849173,0.003147124775651606,-0.07311664148929355,-0.04054485771063128,-0.05166718519038435,-0.00822763037927195,-0.0444573891307097,0.07529093227384764,-0.02000041820773785,-0.04330072127285211,0.023523933629189187,-0.052412460498748,-0.045355422956214454,-0.046303104723351585,0.001722671141790408,0.007333309284499929,0.04416137954750267,0.05571651884862942,0.034075157893937905,0.000618835646998464,0.007773838000400723,-0.09991242002273443,0.020050772288286747,-0.10370562266126487,0.021870069303047256,-0.025322261110831412,-8.684732451013092e-05,0.08126513154655296,-0.06406697983564272,-0.05690497636764921,-0.10274950441486728,-0.00017218517651711635,0.035660196678809014,0.051107980398443914,-0.06067505387126988,-0.054036205664987284,0.029223580327874695,-0.07209577025812898,-0.003286440438045131,0.034986780395541074,0.07741746836908917,-0.03517776618579328,0.009797964429702632,0.018102835065986755,-0.0627656584296276,0.013558960852988963,0.019555819685381448,-0.00036506837484189236,0.0030235836989801175,-0.024030935617312156,-0.050577236581597226,-0.018402965300315616,-0.001756477420226303,0.059932918429471606,0.07842048038270401,-0.010554762968780933,0.05183988392595297,0.022553191811069094,0.06968722388030653,-0.10883734818995267,-0.014602983683055605,-0.10314627509515911,0.004037040623657145,-0.012861130557134058,0.044535931977352484,-0.0015359699023129584,0.012655283127235052,0.04730761619914854,0.008378637398532415,0.010342384134283074,-0.016321577075025694,0.05850035210832282,0.021999061038193258,0.009111728658493795,0.011523047816281058,0.01239963909790065,0.030414990420065607,-0.09169398416395518,-0.017588434584181335,-0.009124221085419819,0.0003674135188507742,0.03554916823521978,-0.0654742069731323,-0.019531016539663482,0.010383673173434376,0.03195614498680694,0.01635861478189615,-0.09173383751747627,-0.06215233707692706,-0.017531110881927835,0.001648890392521091,0.005617813850158302,-0.04541589772288444,0.0356457543674872,-0.03897046797108857,0.03277737683854833,0.03844833097535216,-0.10758774012219588,-0.03641631639788539,-0.04237743906172233,-0.005519812919950763,0.02344203196236302,-0.06387247804017578,0.08767768362452444,-0.03804484311345775,-0.011303014996733536,0.03896811263380742,0.02740979693021695,0.030239841454626354,0.0015699813081087796,-0.060801330656751106,0.03171194452954622,0.00861584150163256,0.03698825169172286,0.0023958507602363315,0.01386308171463096,-0.03890133605007963,0.02624266240187431,-0.09398934632392632,0.04922585553005453,0.052683759533005595,-0.032804794213119715,0.023471759535567717,-0.09525089858015899,0.01124710520199289,-0.0013300786266356994,-0.054613755445530314,-0.07633674823588489,0.015361069427976753,-0.011492619439082787,-0.054066249070513904,0.04484036141544495,-0.10467323822357963,-0.0713593901719709,-0.04398579348329206,-0.027908163368313563,0.010214387473244609,0.06914524641108191,0.0037156154807637012,-0.011954311863199492,0.026984415518882646,-0.04160906186209691,-0.05110501016856207,-0.026249063466422123,-0.013865711321015675,0.04745620579394915,-0.08688145779515104,0.005662801688645047,0.0190518120157058,0.009090010061389387,0.013343675926043172,-0.05139423273090565,-0.0210529896257113,-0.10143194073524897,0.03379968528222878,0.0363716729509352,-0.10504244032294854,0.02164464414435888,-0.030427296701029578,-0.032458644295379924,-0.13093365210537972,-0.08918774514487852,0.052923117056774376,-0.008934384898052136,-0.044852277810116276,-0.019980023887863754,-0.105942944038493,-0.013580348631255368,0.01824273913105171,-0.09249879021316992,0.02310536681940147,-0.05863174836790336,-0.037305256400809776,0.03083488570907964,-0.030317866221652914,-0.05094420261200968,0.038297195552854164,0.05471986781644867,0.008002236446359045,-0.034962969258788654,-0.07381889836048262,0.00993846983795723,-0.036609962217239424,-0.05960752442908267,0.03742610872255897,0.01513395806900587,0.022042751064933426,0.035950212075732804,-0.0306186179543659,-0.09308078400579546,-0.0019697203145153533,-0.08478875162611392,-0.06460699746644134,0.05227855493104285,0.053783094946887613,0.015818731598348644,0.014000994039288844,-0.014001744971151338,0.012639148244203494,-0.02261793663235335,0.019580013369086234,0.04025731304563276,0.030112236522190184,-0.02167946215512019,0.003574576976788157,-0.00839066826019785,0.014061449687578232,-0.015926389021439512,-0.09097748237641512,0.009954302066491652,0.028546432111800968,0.026689903699166864,-0.07621503808088048,0.04865715991543095,-0.028804202952396312,0.09901837048769614,0.03408664786249674,-0.06133030071875474,-0.08249202297684144,0.0009296170528731643,0.018347029317487027,-0.023108501344175268,-0.06483754989719374,0.07568996913944091,-0.02611907544240515,0.08131063456383268,0.01936785595215947,-0.07102874253399406,-0.06806380793326977,-0.017860988794755003,0.06905346363864513,-0.029006571448204118,-0.0721531390840005,0.08252178580884059,-0.020401479907343947,0.0768404688652951,0.01751404382645854,0.08142031116893353,0.031157575775236,-0.011908753782041103,-0.07917832329793432,-0.01369062791995915,0.014440613445445463,0.08733541580802365,-0.0415969538954882,0.07569256742708981,-0.01205997320916846,0.05845486348390147,0.023352323201059337,0.08168483927560423,0.08073500199924631,0.047991817960417044,-0.008145463544354596,0.015617822022702827,0.015043668544773514,0.015505589534114274,-0.025109184059573356,-0.04654494614872446,0.08188168994041935,-0.013364053082316715,-0.009865661763027495,0.04737516133199671,-0.004174816370787377,-0.0050092530542131235,-0.06958977840915155,0.028194993400063696,0.0026511131541124278,0.08248190982656528,0.01829221586876894,0.003094173902337986,0.07075114613996994,-0.07432114225895381,-0.07560701886662238,-0.07328024693877597,0.025597400374362606,0.0783715065052953,-0.02809824628711377,0.005330179675423831,0.03394100910055449,0.06769014874412169,0.030733460914705454,-0.016269772782596264,-0.019098453520839997,-0.07476694124273606,0.02360813863915043,0.0003777025412804175,0.02882610070361062,0.08864712806406798,-0.059129354189567544,0.030011219889304632,-0.10506256944736977,-0.031339257737331205,0.0931502525659621,0.028712432599532354,-0.07672532913170885,0.0015746241644982897,-0.04348421840682553,-0.02386380785764558,0.09181766155774196,-0.02624272991670253,0.08346510936446669,-0.07903958027560523,-0.032852368161051984,0.03472241509971953,-0.034247029380398114,-0.008479698262817982,0.043594720808281105,0.0029858916688500704,-0.02542198452538851,-0.02053683859580861,-0.0661277405518718,0.0885237926630005,-0.07464536850411223,-0.0008408295138857993,0.09206072907959557,-0.009622363406269322,0.016440343736543902,0.04723500473472208,0.09416544503091633,-0.05646027940670521,-0.006348115804017669,-0.05667286818132599,-0.07753204739011962,-0.018657686415864436,0.04698958026469972,0.08575927205313645,-0.03493657545523556,0.04679764720187133,-1.9347570816618048e-06,-0.04886426966077579,0.055902504414516795,0.10498440694569286,0.023394606345778286,-0.03345103840803913,0.08927450151920652,-0.008153479095567134,0.005667249874724358,-0.05168797902198784,-0.11536605222129703,-0.04119666820990405,-0.038102198599142476,-0.0294238896136881,-0.03796192016099686,0.04793613809722741,-0.08301376710824869,-0.006171946827593148,0.014881596955139062,-0.01866542211111238,-0.13305879621270963,-0.03498364229174913,0.0014627034258350388,-0.03936536563625125,-0.018085320295673606,0.012710756226924937,0.009151461174018565,0.041152163819091134,0.002035508775811953,-0.016893630143254894,-0.11900708707791818,-0.021482176851106618,0.011914446489454123,-0.03543300812577871,-0.03150228290596107,0.016279634584645267,-0.00440863798771217,-0.010301610905780979,0.00401483362602834,0.035287916133364426,-0.019085161572768485,-0.010751331888510868,-0.06459866910630604,-0.026398824511204424,0.017808348714942236,-0.031379483039244024,-0.02543617603309532,0.04520932736481338,0.03398558460443744,0.030098737477493136,-0.03406742824687375,-0.017286256177293968,0.06291366651717088,-0.012152348217657795,-0.01605313833710989,-0.05161126362406374,0.010432305017124652,0.03373289261403821,-0.0913957506898104,-0.12053570607705748,-0.044221364791467675,0.042844318907963246,-0.10359917828342592,0.02765671828360168,-0.10950375270392375,-0.11172339805698937,-0.07295669283227019,-0.03234026755655993,-0.026633723807222228,0.0316290313935297,0.05883286709003215,0.03278755022831852,0.032096713518601286,-0.0536626844145155,-0.07481866354291945,-0.02302679372055189,-0.003406583118023155,0.02538346137601099,-0.0013840331336458418,-0.020705315739378553,0.026276527863149584,0.021456502582299745,-0.02061789740117168,-0.12148237097284004,-0.008763781757357501,-0.13244662884796582,0.042000908991438546,0.008388827988595908,-0.10084630739281376,0.01565406578954824,-0.058913142188654184,-0.005853710213830744,-0.006525992377029227,-0.04162905839418687,0.07135482642595099,0.03301070236983164,-0.054849130402947054,-0.040991012188924106,-0.0477932913712442,-0.010593006988343052,0.045915797974714734,-0.05124697080806239,-0.015498575042794324,-0.06148913614746984,-0.06210951159358076,-0.01141315057879645,-0.04024744411133249,-0.04793666007464194,-0.015584527942701489,0.009520512438200091,-0.02633443721229704,-0.01405978018275841,-0.05281043578934964,0.014062412655149627,-0.05769933014581488,0.025480832358610695,0.011457008252377191,-0.03288936906499419,0.006583662631701403,0.008429226065353193,0.026528513881801028,-0.12249551205885129,0.031682656092895264,0.04543303706901766,-0.07049558346681098,-0.0067919157288984814,0.012095663311903163,0.04131124138348166,-0.040749078835452944,-0.019895042613811646,0.03915021650355685,-0.032223565995498346,0.004467997238460783,0.03917262510591705,0.02237966279685325,0.007604688913153667,0.013686087211972469,-0.0631672427799509,-0.09840002415429912,-0.11203462467762283,-0.02668217825700042,0.03790075430918033,-0.009189737985131402,-0.05834973671596644,0.05494495243967931,-0.01518536257434688,-0.01844515131935428,-0.009367136201105738,-0.10666941299336637,-0.138194415697142,-0.028584215318541977,0.04642750575624582,-0.025878238808014962,-0.061058182277737946,0.011969385519666082,-0.05315851421589566,-0.010436738496898506,-0.0023278805390215306,-0.08851367295891725,-0.10048688580150834,-0.03700285179342889,0.05865597991525903,-0.04121259021206173,-0.06502444602610034,0.06209018351894669,-0.055265980118915564,-0.010817620057948781,0.005348256538828938,0.01937695843032962,-0.03216002405914007,0.00122674745133141,-0.07172792332853314,-0.034641278754177225,0.005520493576275867,0.01155192496646544,-0.035496580011353994,-0.014905106449394037,-0.016330885130373434,0.043041173048379344,-0.05786490781576077,0.025639347405944934,0.06722154611188035,-0.04676898814583799,-0.059204102940995366,-0.0828161073721981,-0.10303732188392399,0.02958818839532602,-0.04266414440913388,-0.06212322892821517,0.004154408941054466,-0.07779729118801303,-0.09104546912665488,-0.06812636545377233,-0.04371963003016088,-0.01600832583253478,0.05264182799693947,-0.00318892549363325,-0.04696710625656417,0.03637625651663429,-0.06244997694636911,-0.06647538639458639,-0.06880348797117977,0.06037775941895185,-0.009523500034846163,-0.07032837364975761,-0.008035314491090578,-0.006679201563310214,-0.0222565469908696,-0.014470204711862096,-0.062141916751936685,0.005662955133466691,-0.07038910331862985,0.0005141288177421265,-0.026530505034248034,-0.08053213182325203,0.045710912819856314,-0.06896884715548461,0.007304020313143766,-0.12042546843618322,-0.09832052727830068,-0.0021604933041070476,-0.07219942163326871,-0.025042284901396983,-0.08565451595608245,0.0010603878626575267,-0.007022065474105935,-0.06555381156785416,0.05224666195020255,-0.045715226859167506,0.005936346710261275,0.04757947552439085,-0.02198742727998124,-0.07301308860601921,0.02508920094607755,0.002962614708061012,-0.0009686098963127705,-0.04529698198740785,-0.07265660533567982,-0.0307466670723994,-0.04935727425247887,-0.08718563845702453,0.055446104319185535,-0.014254715326681664,0.037535239603208065,0.056295756509697176,0.039186709785318415,-0.0766864195993879,-0.06441943188694342,-0.053907680414917336,-0.11221437897961813,-0.02234531391611572,0.037837581776725124,0.0016199897760724152,-0.026788363424454727,0.061647269769292176,0.040471664072119454,-4.785246201851046e-05,-0.01546559064709662,-0.008730383061201726,-0.015848472013089865,-0.025757006688205134,0.014011383720904082,0.00962629965029075,-0.13229659992043638,-0.002713030656391048,0.06172184568825298,0.007891016475791355,-0.08251546073006748,0.027318864182253065,0.015255612343500017,-0.0029171018582957982,0.001458658458022206,-0.034426775542900585,-0.06489396986874155,-0.019587536227723936,0.06371109388750855,0.011548383545011573,-0.06430116264583614,0.04192264735911729,-0.03104231584610387,-0.001344568167416997,-0.03218345442987336,-0.05898097887763273,-0.05570436715510587,0.008714333668325943,0.043890484176563396,0.040029326768488464,-0.060955521313121194,0.01788489323023027,-0.04548147305338058,-0.0191491280652874,-0.016475282464906527,0.023761297973916014,0.0021641926347849604,-0.006553719168323718,-0.06697722479961725,0.003611545790700038,-0.01003183127829049,-0.03106696823048158,-0.047908945322402176,0.03823555309228923,-0.013462333932140542,0.06971720935723616,-0.0338301819747722,0.014159954453923242,0.020425137481915226,0.019492308148989855,0.005818077031525092,-0.051623450584486155,-0.022436146337180784,-0.0423780787385134,0.011851950902308672,-0.03614242518167283,-0.025781337997820168,-0.003794872151939675,-0.05043737770345032,-0.056874489889310216,-0.06906543692950273,-0.005614150180962555,0.025312883934595503,-0.01581124506792202,-0.023934410730334952,-0.003608137161659875,0.04157561052114021,-0.0815365653178945,-0.06909364042700718,-0.08621481760213198,0.035208004805886116,-0.0010856112301693979,-0.048928270297415116,0.030909766353994464,0.0033616748728918767,0.009244771592537695,-0.014566058429152937,-0.053271820574196,-0.03367179161818254,0.00492194780075068,-0.0003990878412235238,-0.018690077646979237,-0.06550933862755591,0.011579718692535539,-0.07824564476290874,-0.017269802489039292,-0.11139335290174701,-0.04745306261510446,-0.013234599642371255,0.04549405776126737,-0.08159341783791631,0.0008903758843545119,-0.023492987382623166,0.04156663962079615,-0.03971874608609055,-0.0348340007815136,0.01679996132610915,-0.07110815321881751,-0.03474257755896706,0.03469024623765124,0.005491519904353497,-0.06283384682333441,0.03635932337223288,0.015110041651194462,-0.025691036419525682,-0.009498032518257944,-0.08227632137987967,0.0125407174598539,-0.0713682348455738,-0.06702791591267307,0.036267004211373965,0.004783134961327456,0.028852466123456436,0.04745379486314318,0.0014589072888895225,-0.113310436460589,-0.016216287912768978,-0.07332485348929214,-0.030436177441024743,-0.01246429614720148,0.005105744882140789,0.005158708997377779,0.00389986822222855,0.037507300383168185,-0.05353324605201856,0.021027962010038523,0.04406040543986402,-0.004268902465798893,-0.013836271943103532,-0.03586461532041122,0.007013314529779267,-0.04746196677170101,0.012302557065432882,0.02122044136387419,-0.1260336143307578,-0.03430508496614234,0.03721889479912396,-0.013081144270847899,-0.06426498530562468,0.03044301832191407,-0.04523748337710885,0.014570705291665787,0.02482288882034273,0.036173894357957294,-0.08671121785359698,0.01747297449579843,0.04069228081833533,-0.021760447840511055,-0.06468574037831892,0.055343466959725605,-0.0425470716629632,-0.006397534090442602,0.010160333545093747,-0.044541910287983065,-0.0517824800064987,0.01826620592961474,0.03165171312278077,-0.035840677149844034,-0.06466999127541022,0.08160653824089946,-0.02471386715454272,0.023065261056328938,0.024800847478421425,0.019333128402578614,0.022185576685567587,-0.0013076608483988006,-0.08077442860075307,-0.026748285501108183,0.037066826732443534,0.03609754626726983,-0.014919519412704235,-4.635256067048334e-05,-0.0018772414632065955,0.037131879274779414,-0.03416752161664586,0.012798531198785483,0.028311986860344744,0.00811552380115611,0.011643903303646288,-2.9602243917754937e-05,0.04522505683783659,0.043087155672373915,-0.057484431929093215,-0.0780120652424152,0.026293821888068673,-0.011818177474558973,-0.11542896437331454,0.034318189665149254,-0.05062301227242107,-0.08648513114953198,-0.07339563835093173,0.03170509155939197,0.006035189906269213,0.031340041283476595,0.02440821014634384,0.03186507427905033,0.007833108903865254,-0.06975558171495276,-0.08675398773392569,-0.08453170316437221,0.05130135984146354,0.00977920712828967,-0.07070967911701313,-0.014761797020174067,0.03189538711813627,0.052769421248642576,-0.008440890500778946,-0.06924995037493212,-0.011887283887002713,-0.03413196067683256,0.03498299785869388,0.04257295604703153,-0.046955341196288046,0.015484529911280081,-0.04697346008072883,0.02130635627974885,-0.06393522878028342,-0.013223617377983636,-0.010486455084374595,0.030611951539862355,-0.062172164874839994,0.023322315734223737,-0.05445016634173491,-0.04649523469977542,0.03221384460000771,-0.06098759970206308,0.003441013415266579,-0.07018545494825168,-0.022921611547716787,0.04179723457406001,-0.013746588359711131,-0.07552462483689143,0.027279542160330277,0.0008535762698484762,-0.04586717015620141,0.02068575151892437,-0.06955731137303058,0.04246690853639889,-0.0722026599730874,-0.0631297919719911,0.014852791654149485,-0.041405666797955716,0.04297600880265381,0.032073927420452675,0.07301563490160312,-0.11282076352739687,-0.07545773303793238,-0.09413848131499132,-0.0639521838417974,-0.0322697766686348,0.05548248740270824,0.03645064279911279,-0.025096289674427213,0.02481594859285226,-0.044466420947280365,-0.02396498963022606,0.026141889668785705,0.013399795592221497,0.031830635143066534,-0.01101095681750646,0.04323610532522931,-0.04675864966903504,-0.018888600057708337,0.07160802236114693,-0.008071849503393682,-0.005158490574051848,-0.00523612099479446,-0.0013335566878169703,-0.07170818873411343,-0.010270574260760761,-0.02377835782584571,-0.02224913924765192,0.017856483141952623,-0.025004243824839036,-0.03195263589919861,0.03617236436430708,-0.010357860339075356,0.0018266459726664999,-0.0892139253280357,0.057651610130252225,-0.04742051705097815,0.014973737496993732,-0.005820174336948184,0.07854958664176435,0.0025565318923270737,-0.04827870905371319,-0.008664637002593893,0.004943975892280784,-0.07576950072527172,0.038487612268739466,0.0030905160804055253,0.025690630924917246,-0.01283669919420512,0.022864487405961417,-0.023538609280803584,-0.023668772100181132,-0.0774242823801178,0.005768053299804987,0.023587331794901023,0.0033489016368702194,-0.0017696335542233843,0.02514499794243856,-0.01887835661403552,0.014036806119424221,-0.05828139910426025,0.06611593729935789,0.029452851655318996,-0.020264938737854673,-0.017467253004900218,-0.05726870949955864,0.009568666581592751,0.015166766363996031,0.020408869389515652,0.025069491947624086,0.03191296609372257,-0.02477897828951048,0.011242410497887885,0.026244062522941414,0.06184447098146639,0.013723327696608504,-0.06464228061834312,-0.007729087781927193,0.023300956200203518,0.02861304444260005,0.0048932002705046685,-0.008157964251793349,-0.004083884525915329,-0.05624289437291089,-0.05217585318413651,-0.06720528351385695,0.01979638723591666,0.012464726016739772,-0.05151212117463281,-0.022667903193251893,0.025837877160430484,0.01585372084815826,-0.02476995598588399,-0.05825952342947398,-0.041508220083106916,0.019112459654218313,0.01544603777930531,-0.009548819043863642,0.03310611680854405,0.03137953104316234,-0.048139710915129585,-0.02811024618517867,-0.05577986360663502,-0.039406984656205554,-0.03889563292437391,0.02735636183772769,-0.08109200337979514,-0.007169164254599571,-0.03805155686068263,-0.03884132621964113,-0.013636130539797866,-0.07120431043778133,0.04612913485242286,-0.07113576550388791,-0.03218138791767579,0.0072973065410145725,-0.006255072732106157,-0.06757351585050206,0.032409986364542426,0.010743781915902462,-0.01956485194576514,-0.027462709316143884,-0.05307309290788775,0.04230627935315283,-0.049285982406008774,-0.06456157509355125,-0.003640934694507448,-0.016492847898245056,0.010876630432937651,0.012694929902783906,0.06445666974433956,-0.007353710251149596,-0.02152781883800286,-0.043947389866094484,-0.030893525438916113,-0.01820934195038418,0.03965093459886227,0.034047041839654554,0.009980756493819324,0.0193383731312347,-0.02788393050998627,-0.037356221790201885,0.02123387839918971,0.016042616668012658,0.012794235283797273,-0.00936873306253253,0.0012202426473679473,0.057452717323396664,-0.11904594829611967,-0.04265266983985092,-0.010347304291336259,0.01319171282127162,-0.05847272406641279,0.06943454202624567,0.007002392962091198,0.021082422563916122,0.0016894787303494445,0.07022538761437859,-0.12242089746626185,-0.039063797310539626,0.001611252260731726,-0.006784228597888269,-0.05900308968816783,0.0954044753989125,0.0052310495248944116,0.0202948236468326,-0.0009302869710565211,0.06392369388475791,-0.13167761531137454,-0.04462423803475691,0.018214928404433197,-0.03439335405317657,-0.06417979037546966,0.06991383527083612,-0.019480734746237096,-0.001207275925639278,-0.013948449678385653,-0.00037539674443399715,-0.009687033008659442,-0.006026017274999408,-0.043368720082258484,0.009618633163310006,-0.010034820168118035,0.018372376100309923,0.014008352657745804,-0.01092507785215477,0.011757867507772132,0.047576498635467764,0.07612941374005265,0.060912085015099454,0.05116784713362629,-0.02422350375106494,-0.004513043258318392,0.07489096975064992,0.0009093475096979127,-0.009091346877012246,-0.08425910747225884,-0.10313458643384009,0.07946134728570493,0.055296254284820386,-0.09873832799007365,-0.015509397669600489,0.0592886718216703,-0.10272528474327251,-0.04737982489038034,-0.06874899444169386,-0.052729590504410416,0.06349402480068646,-0.03657460515986598,-0.013410092335462247,-0.008951420323394143,-0.06788106792519498,-0.06480383614948058,-0.08288684983807004,0.02495379128983433,-0.010353832289152053,0.06636034185724517,-0.0013863081371395733,0.006912503734977339,-0.01221213219069493,-0.013505720335392947,-0.11400786943409555,0.02842492181191188,-0.11210652138365278,-0.01563436268864736,0.010943329113608243,0.07399567077459245,0.06615116916785527,-0.04342738442751233,-0.039964756597158084,-0.12278431180130597,0.0672764048970533,0.05253608851245748,0.01757444851973213,-0.06444132831387009,-0.018750610798769038,0.05669754322145822,-0.018795331452981633,0.02585474830418331,0.0686458244943386,0.06719603314844626,-0.06476703144395157,0.0367261945708854,0.02892837366127956,-0.013959532694434831,0.07958075632958651,0.007385286861979543,-0.013626138088912238,-0.001635522554112926,-0.04253071778453604,-0.06257007576718839,-0.018959985949408936,-0.06421736609515327,0.08013285535606095,0.07133326789240942,-0.019700549258851337,0.01730061783073057,0.010000290951979523,0.08071964466135251,-0.11084490723461193,0.04304381010444816,-0.044722818035595115,-0.09505735921166904,-0.016193198190280384,0.07546062424070507,0.006544898742068192,0.005758162953599535,0.002601345425145248,0.03265142603952033,0.01834329610265084,0.020893466939232552,0.04924052630617485,0.008261936358212962,0.0555397551006365,0.03471747525301454,0.015099366497209553,0.01843977067374184,-0.0218937797838207,-0.07500485060861102,0.005266394275000661,0.022690410293861117,-0.034235184974541276,-0.04318605157141655,-0.0484107580349176,-0.016858944920279322,0.07653291950273781,0.0084993106894247,-0.05354461080356162,-0.0015125332242090178,0.046418679948246805,0.01797318498330846,-0.02872611569357779,-0.04581208320007424,0.09986388190168975,0.0064141658751399435,-0.057305524203256734,-0.022505759234894705,-0.0024679795727759945,0.0058793311453266845,-0.00842616657655176,-0.05163001302652792,-0.0126166225434796,-0.01896617641162465,0.09883322390003489,0.021826897634080165,0.09987612680363568,-0.031880009809595676,-0.040724847666794725,-0.0776296920445693,-0.021019321959393367,-0.004519319518977503,0.04233867006384506,0.027731282018613898,0.013216536642357998,-0.0007181767223856238,0.01818441075611146,-0.0444871149077715,0.0215832084421932,-0.027153172013064598,-0.003019896820057674,-0.03735142906080001,-0.05364852301727746,-0.007847140758256155,0.01691713764825401,-0.0008613039353460661,-0.09513992338741699,-0.03457082153454428,-0.014410761221460452,0.010225449914430194,-0.010510207541402939,-0.04082295178196242,-0.1113076419685697,-0.058512159665550026,-0.021011069602705094,-0.0052173574991251715,-0.029226610280047048,0.01368238169653585,-0.011574043162523645,0.014131133111586211,-0.05728285015180163,-0.04485625221035773,-0.05265042709575841,-0.03073637467152081,0.08670381214696085,-0.05961618062040464,-0.037431129555210184,0.006238440119427519,0.0016730975905974608,-0.020278983460083336,-0.002378873815462403,0.015329666421169775,0.006951459545244187,-0.059287832514628415,0.0009719430294245959,-0.05411933099745902,0.00893897835274143,-0.12114368645438367,-0.04331650531492422,-0.054033319876073065,-0.016885223889968323,-0.04908349011192477,0.01364200696085847,-0.04560949640944947,0.0019955372737702555,0.05527031305207627,-0.04796593551710817,-0.008109752202486028,-0.06554435484349867,0.014890739515945271,0.005185508696120145,0.0007208276808025613,-0.03671504314756168,0.016835942797727602,0.033328064917934705,-0.04249495634333552,-0.003912775655194251,-0.049499027120534514,0.005854398805377916,-0.048169798351605224,-0.03333192717599719,0.033147614302432585,-0.044226191119748244,0.02550211136536551,0.003830883154018176,-0.008485539518173506,-0.11944986366696213,-0.0014077864992723314,-0.022965316343555763,-0.014959657209720983,-0.008898411222185756,-0.02946817535106479,-0.023516103359860256,0.022725279147327904,-0.021606052556152517,0.037555563039199706,0.006830505451110646,0.027244742256045746,0.026346071305733923,-0.009809859523969252,-0.06250858446462924,-0.096443374388911,-0.033642989464382045,0.0279609627102468,0.030662608425938605,-0.08409382912955256,0.04695382707048384,-0.02384306606770593,0.005483316462755563,-0.010602343284879847,-0.009459191580939193,-0.08118448990194946,-0.019127496636671616,0.023196440388072066,0.02734270084584473,-0.057661718540201315,0.07552738302897988,-0.04976635338389259,0.03310040917126748,-0.019902068982438084,-0.07316880374767946,-0.04617631217893906,-0.04340363341558375,0.03779435891673229,0.035228922046824616,-0.07081280086647235,0.04899546992445113,-0.04454502260780352,0.0026821158056837915,0.0005342126992624073,0.027268368509846454,0.0034659342655196184,0.04330838794067639,-0.08944134084201952,0.01682846798734568,0.014805658400473038,0.03309537511934936,-0.04013493437181837,0.04517451725376576,-0.043460713565172164,0.06078754727293652,-0.05138575636994446,0.06257419573900976,0.09202693632616506,0.02291663446509042,0.02951386773972873,-0.036966818046745474,0.005786463156260799,0.008143261437497681,-0.1166794802324004,-0.12386138711700172,0.018926687217433253,-0.007376927449559117,-0.11847341922192732,0.0028581953759071787,-0.053959459806256306,-0.11910522677537383,-0.06053164397908728,0.007685418602409496,0.01103784331637666,0.018089248649331147,-0.020731348124341707,0.014015449558035816,0.03306496149939851,-0.07697904996854542,-0.08011972804125296,-0.0696709401708431,0.015167053263312429,-0.0045838717937469395,-0.03281368223234733,0.04398279816873046,0.0019359459342938087,0.0009726481635098672,0.026900387963964337,-0.052769520082965794,-0.035944491009801675,-0.06735813713592788,-0.0007578731001325865,-0.015424102261072655,-0.013925048672204806,-0.025923411344100554,-0.08290632518267342,0.02426549543879856,-0.05446040081934932,0.014449392758832162,-0.0026562355613299537,0.031789473914852345,-0.07523014763952157,0.01727296611178506,-0.012088671442098436,-0.023810934476841687,0.02530921681484399,-0.05479542314946085,0.04748289332913968,-0.08345614770686452,-0.029579020054980056,0.02909318049855329,-0.0185091964224755,-0.016448520632396144,0.019008055460270422,-0.04354596447463987,0.005015862477471699,-0.0016500235749810114,-0.0645134473871129,0.03587954250001031,-0.0682797054769643,-0.018284820341864346,0.006834300803519396,-0.012028011338998593,0.03544649447105077,0.0160828636095282,0.066072102502717,-0.08985699856352634,-0.054094082138608196,-0.11302957081633676,-0.10110876331772478,0.029470104814972028,-0.005209895576701561,0.034491820615678286,-0.004825841512815385,0.02533024149667935,-0.0533383766118695,-0.025408250276509045,0.025996524178120275,0.0427777503576964,0.02597799518375384,-0.031883435290885574,0.029961352480830324,-0.05217423514174406],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"q_2"},"scaleanchor":"x","scaleratio":1},"title":{"text":"8x8 Handwritten Digits"},"xaxis":{"title":{"text":"q_1"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('be9780d4-7b16-46e9-bc4a-9e115581190f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p><em>Now</em> we can start to see some definition! The 6’s are pretty much in one area, the 2’s are in another area, and the 0’s are in still another, and so on. There is some intermingling to be sure (particularly between the 5’s and 8’s), but you can see that this ‘kind of’ gets the job done, and instead of dealing with 64 dimensions, we’re down to 3!</p>
</section>
<section id="graphing-variance-vs.-components" class="level2">
<h2 class="anchored" data-anchor-id="graphing-variance-vs.-components">Graphing Variance vs.&nbsp;Components</h2>
<p>Earlier we asked the question of how many components one should keep. To answer this quantitatively, we note that the eigenvalues of the covariance matrix are themselves measures of the variance in the datset. So these eigenvalues encode the ‘significance’ that each feature-dimension has in the overall dataset. We can plot these eigenvalues in order and then look for a ‘kink’ or ‘elbow’ in the graph as a place to truncate our representation…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">plt.plot( np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(lambdas)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(lambdas) )</span>
<span id="cb35-2">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Number of components'</span>)</span>
<span id="cb35-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Significance'</span>) </span>
<span id="cb35-4">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-20-output-1.png" width="597" height="429"></p>
</div>
</div>
<p>…So, if we were wanting to represent this data in more than 3 dimensions but less than the full 64, we might choose around 10 principal compnents, as this looks like roughly where the ‘elbow’ in the graph lies.</p>
</section>
</section>
<section id="interpretability" class="level1">
<h1>Interpretability</h1>
<p>What is the meaning of the new coordinate axes or ‘features’ <img src="https://latex.codecogs.com/png.latex?q_1">, <img src="https://latex.codecogs.com/png.latex?q_2">, etc? Sometimes there exists a compelling physical intepretation of these features (e.g., as in the case of eigenmodes of coupled oscillators), but often…there may not be any. And yet we haven’t even done any ‘real machine learning’ at this point! ;-)</p>
<p>This is an important topic. Modern data regulations such as the European Union’s <a href="https://en.wikipedia.org/wiki/General_Data_Protection_Regulation">GDPR</a> require that models used in algorithmic decision-making be ‘explainable’. If the data being fed into such algorithmics is already abstracted via methods such as PCA, this could be an issue. Thankfully, the linearity of the components mean that one can describe each principal component as a linear combination of inputs.</p>
<section id="further-reading" class="level2">
<h2 class="anchored" data-anchor-id="further-reading">Further reading</h2>
<p>There are <a href="https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=book+pca+principal+component+analysis&amp;ie=utf-8&amp;oe=utf-8">many books</a> devoted entirely to the intricacies of PCA and its applications. Hopefully this post has helped you get a better feel for how to construct a PCA transformation and what it might be good for. To expand on this see the following…</p>
<section id="examples-links" class="level3">
<h3 class="anchored" data-anchor-id="examples-links">Examples &amp; links</h3>
<ul>
<li><a href="https://graceavery.com/principalcomponentanalysisandfashion/">“Eigenstyle: Principal Component Analysis and Fashion”</a> by Grace Avery. Uses PCA on Fashion-MNIST. It’s good!</li>
<li><a href="https://link.springer.com/article/10.1007/s10914-008-9099-1">Neat paper by my friend Dr.&nbsp;Ryan Bebej</a> from when he was a student and used PCA to classify locomotion types of prehistoric acquatic mammals based on skeletal measurements alone.</li>
<li><a href="https://www.coursera.org/lecture/machine-learning/principal-component-analysis-algorithm-ZYIPa">Andrew Ng’s Machine Learning Course, Lecture on PCA</a>. How I first learned about this stuff.</li>
<li><a href="https://towardsdatascience.com/pca-using-python-scikit-learn-e653f8989e60">PCA using Python</a> by Michael Galarnyk. Does similar things to what I’ve done here, although maybe better!</li>
<li><a href="https://plot.ly/python/v3/ipython-notebooks/principal-component-analysis/">Plot.ly PCA notebook examples</a></li>
</ul>
</section>
</section>
</section>
<section id="appendix-a-overkill-bigger-handwritten-digits" class="level1">
<h1>Appendix A: Overkill: Bigger Handwritten Digits</h1>
<p>Sure, 8x8 digit images are boring. What about 28x28 images, as in the <a href="http://yann.lecun.com/exdb/mnist/">MNIST dataset</a>? Let’s roll…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#from sklearn.datasets import fetch_mldata</span></span>
<span id="cb36-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> fetch_openml</span>
<span id="cb36-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> random <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sample </span>
<span id="cb36-4"></span>
<span id="cb36-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#mnist = fetch_mldata('MNIST original')</span></span>
<span id="cb36-6">mnist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fetch_openml(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mnist_784'</span>, version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, cache<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb36-7"></span>
<span id="cb36-8">X2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mnist.data.to_numpy() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># at some point they made MNSIT a pandas df</span></span>
<span id="cb36-9">Y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(mnist.target,dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.int32) </span>
<span id="cb36-10"></span>
<span id="cb36-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Let's grab some indices for random suffling </span></span>
<span id="cb36-12">indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(X2.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span>
<span id="cb36-13"></span>
<span id="cb36-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's look a a few examples</span></span>
<span id="cb36-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 8 is good</span></span>
<span id="cb36-16">    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample(indices,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb36-17">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"i = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: This is supposed to be a "</span>,Y2[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":"</span>,sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb36-18">    plt.imshow(X2[i].reshape([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>]))</span>
<span id="cb36-19">    plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/shawley/envs/blog/lib/python3.11/site-packages/sklearn/datasets/_openml.py:968: FutureWarning:

The default value of `parser` will change from `'liac-arff'` to `'auto'` in 1.4. You can set `parser='auto'` to silence this warning. Therefore, an `ImportError` will be raised from 1.4 if the dataset is dense and pandas is not installed. Note that the pandas parser may return different data types. See the Notes Section in fetch_openml's API doc for details.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>i = [14703]: This is supposed to be a 4:
i = [26349]: This is supposed to be a 9:
i = [48622]: This is supposed to be a 7:
i = [20164]: This is supposed to be a 9:
i = [20938]: This is supposed to be a 8:
i = [63509]: This is supposed to be a 8:
i = [42765]: This is supposed to be a 1:
i = [429]: This is supposed to be a 0:</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-3.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-4.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-5.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-6.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-7.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-8.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-9.png" width="415" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-12-21-PCA-From-Scratch_files/figure-html/cell-21-output-10.png" width="415" height="411"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Like we did before... Almost the whole PCA method is the next 3 lines! </span></span>
<span id="cb39-2">mnist_cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cov(X2.T)</span>
<span id="cb39-3">lambdas, vs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(np.array(mnist_cov))</span>
<span id="cb39-4">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vs[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grab the 3 most significant dimensions</span></span>
<span id="cb39-5"></span>
<span id="cb39-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting all 70,000 data points is going to be too dense too look at. </span></span>
<span id="cb39-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instead let's grab a random sample of 5,000 points</span></span>
<span id="cb39-8">n_plot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span></span>
<span id="cb39-9">indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(X2.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])), n_plot)</span>
<span id="cb39-10">proj_mnist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(X2[indices] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.float32)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Last step of PCA: project </span></span>
<span id="cb39-11"></span>
<span id="cb39-12">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> go.Figure(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[go.Scatter3d(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_mnist[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_mnist[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>proj_mnist[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb39-13">                mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'markers'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Y2[indices], </span>
<span id="cb39-14">                showscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>), text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'digit='</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(j) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> Y2[indices]] )])</span>
<span id="cb39-15">fig.show()</span></code></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="cc3f9298-86b1-42a2-846c-005d40a605b4" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cc3f9298-86b1-42a2-846c-005d40a605b4")) {                    Plotly.newPlot(                        "cc3f9298-86b1-42a2-846c-005d40a605b4",                        [{"marker":{"color":[6,2,4,9,5,7,8,1,6,2,6,4,4,9,8,2,8,5,1,8,3,4,2,8,0,9,6,1,1,9,3,2,8,6,5,0,8,4,4,1,2,7,7,3,5,9,8,2,6,3,2,0,6,6,3,7,8,9,4,1,7,0,5,4,8,4,6,8,0,6,5,0,1,9,5,3,3,2,0,6,4,2,5,4,5,4,1,3,1,9,9,2,8,7,1,1,2,7,6,2,4,6,0,8,1,7,2,1,1,5,5,8,5,6,2,8,4,6,0,6,1,9,6,2,7,3,9,8,4,7,0,0,2,2,6,7,8,9,1,8,8,4,2,6,6,2,3,0,3,7,5,3,6,2,9,4,3,6,6,8,1,8,6,1,4,3,1,3,8,0,9,5,7,2,3,5,4,1,1,4,8,6,3,1,7,4,8,1,9,0,8,0,6,0,3,9,7,0,2,8,3,8,4,3,1,3,0,5,4,8,4,8,8,2,1,7,1,0,2,1,1,8,6,7,6,8,5,5,5,1,6,1,1,4,1,1,5,0,4,7,0,9,0,4,0,5,7,4,2,2,6,2,5,1,9,9,4,6,8,0,7,2,0,9,3,5,9,0,2,0,3,7,9,1,1,0,2,1,8,4,3,4,3,3,6,1,4,3,6,0,6,8,5,9,2,7,7,7,8,2,4,4,8,7,2,5,1,4,1,4,3,5,2,8,0,7,0,4,9,1,3,8,3,2,1,4,8,5,6,6,9,7,5,1,3,9,4,2,8,7,1,8,0,3,8,5,9,6,3,0,3,6,3,3,0,1,1,7,2,2,6,4,9,4,7,8,3,7,3,5,0,3,1,2,0,5,8,4,0,3,9,0,9,0,4,7,6,3,9,5,6,2,3,9,1,7,1,0,6,6,6,9,7,0,9,2,1,2,3,6,8,7,8,4,4,3,8,4,0,1,4,8,1,2,9,9,9,9,2,8,3,3,9,2,8,9,6,9,8,0,4,5,1,0,2,3,2,8,8,2,7,7,1,4,8,5,2,3,0,9,7,0,2,4,0,9,7,5,4,3,4,5,9,7,5,5,2,8,1,6,5,6,2,9,0,2,8,5,8,2,2,3,4,8,8,8,1,2,5,1,1,9,7,0,7,9,1,4,0,9,5,1,6,7,8,8,0,0,7,7,8,6,3,3,1,4,2,3,9,5,8,0,4,3,1,9,5,2,9,2,5,3,5,6,1,8,4,6,5,0,4,9,9,0,9,2,6,9,8,9,1,5,0,3,7,0,6,5,8,3,7,7,8,3,3,2,7,1,5,9,7,4,0,2,9,6,0,4,2,7,7,6,1,9,9,3,3,1,7,8,4,0,4,8,3,3,9,5,1,1,6,9,5,3,7,1,0,5,6,0,1,0,4,0,2,2,6,7,3,9,0,1,1,8,5,9,8,7,3,4,6,9,3,1,3,8,6,9,3,3,1,3,4,2,3,6,2,7,3,0,0,3,1,7,4,6,1,6,3,1,6,5,0,5,9,2,1,9,8,7,9,2,7,6,6,7,9,6,8,6,3,6,9,6,7,0,6,0,3,9,0,0,1,0,5,6,2,8,7,7,4,7,9,5,3,8,0,0,0,4,0,9,3,9,3,9,2,6,8,1,9,1,3,7,4,7,4,1,1,8,5,2,0,1,3,3,3,5,2,8,8,1,9,9,2,0,4,7,8,6,3,8,4,9,3,7,1,2,3,7,2,7,6,2,6,5,1,4,7,4,8,7,7,1,6,4,5,0,6,8,4,7,1,7,6,3,2,8,5,9,6,8,2,9,1,0,9,6,4,5,6,2,1,2,2,5,9,5,1,0,2,7,2,7,2,0,6,0,2,6,6,6,2,6,8,7,2,2,7,9,1,5,0,7,2,5,8,2,7,5,9,6,7,2,7,7,2,4,8,6,2,5,5,5,0,8,6,4,5,3,4,1,6,5,8,4,2,3,2,9,3,2,4,0,3,9,1,3,3,0,8,2,9,6,8,4,7,2,0,8,2,8,7,0,9,7,6,4,0,0,3,1,9,1,8,4,8,6,1,3,0,7,3,8,4,9,5,3,6,8,9,0,8,0,9,7,9,5,6,9,9,6,6,2,1,4,3,3,5,2,8,2,9,3,0,9,5,9,5,0,6,8,9,4,4,0,7,0,6,0,0,9,2,3,6,0,0,6,0,1,6,2,7,2,3,8,3,5,1,9,4,1,8,1,4,5,6,9,5,2,1,4,3,2,1,5,5,2,6,9,8,7,2,9,6,6,8,1,2,8,8,4,6,3,6,0,9,6,1,1,1,0,7,2,4,7,2,5,5,9,8,5,3,5,9,9,0,8,3,4,3,8,8,1,4,9,0,6,5,1,6,9,6,3,0,8,6,0,6,1,8,1,1,5,3,2,2,4,6,6,8,9,2,8,0,4,5,7,2,1,6,2,4,9,7,6,1,6,7,6,9,4,0,5,2,4,8,2,2,0,4,6,2,6,5,3,1,2,4,7,6,2,4,8,9,4,8,3,6,7,1,6,5,5,3,5,7,8,0,6,5,9,3,0,1,6,1,1,5,5,4,1,0,9,0,8,7,7,7,4,4,2,4,9,3,6,3,9,9,3,1,0,0,3,8,4,3,3,0,6,4,7,7,3,6,4,5,9,6,1,3,1,9,8,7,2,5,1,5,3,0,7,9,6,5,7,9,8,4,1,7,6,3,3,5,1,0,7,4,8,5,4,8,8,9,9,8,2,1,6,3,1,8,3,5,9,5,4,7,1,1,0,4,6,2,6,4,7,5,5,0,5,7,4,3,1,8,3,1,7,2,1,6,9,7,6,8,7,2,6,9,0,6,8,6,0,6,1,9,0,9,2,5,5,7,5,7,8,3,0,0,4,1,7,7,2,5,1,6,1,7,1,5,7,4,2,1,6,0,7,4,0,7,6,2,5,6,0,3,8,0,1,8,7,8,3,1,4,9,9,5,3,7,1,6,3,0,1,1,8,4,3,0,8,9,7,9,3,6,3,7,8,7,5,5,1,6,7,1,1,1,4,3,0,4,0,1,7,9,3,4,7,9,8,8,3,7,3,8,1,7,5,5,3,1,2,3,0,9,4,8,5,7,2,7,5,8,3,0,0,9,6,6,9,2,5,0,2,9,1,2,8,7,5,0,2,5,7,6,8,9,5,1,7,6,7,4,8,1,8,9,8,2,3,8,2,7,1,0,5,7,1,2,3,2,4,7,9,0,2,6,8,2,9,3,2,5,5,3,9,5,4,7,2,7,3,7,1,9,8,4,9,6,5,8,3,4,0,7,0,9,6,1,3,1,6,3,3,9,9,8,4,6,1,3,0,9,0,6,6,0,3,1,2,1,0,7,5,6,3,9,5,6,1,0,8,1,0,4,2,6,3,5,7,7,0,9,3,9,1,7,7,6,6,9,6,9,4,5,7,4,2,6,7,0,6,2,1,8,5,5,2,3,8,3,7,3,7,6,3,8,4,4,1,2,3,9,7,3,5,9,8,2,3,1,3,3,8,4,0,0,2,3,9,4,0,3,3,4,8,3,5,4,7,6,7,8,5,9,4,1,7,3,1,3,0,8,8,6,4,3,9,7,0,8,7,5,2,9,7,6,0,5,4,7,5,2,5,6,6,4,4,4,9,4,0,1,0,6,0,8,0,1,4,6,4,7,1,4,7,9,4,1,5,9,4,4,0,0,4,4,7,0,7,3,2,7,8,3,1,1,5,9,8,2,0,1,6,0,9,5,4,1,1,6,2,3,4,0,8,4,4,6,3,3,6,2,6,8,2,6,4,7,8,4,2,0,0,8,2,6,8,4,9,1,0,7,3,9,9,9,1,8,0,0,1,8,3,4,3,9,0,6,0,8,3,9,6,1,4,6,1,5,2,2,3,5,1,4,9,5,5,4,7,0,9,1,0,7,9,0,2,7,9,4,4,1,6,8,0,6,8,1,3,7,1,1,0,8,3,5,0,6,3,5,4,9,4,1,3,0,8,8,7,8,7,2,2,5,6,6,9,5,4,9,8,1,7,6,5,8,1,4,6,1,3,4,4,3,2,4,7,6,9,6,3,9,4,7,1,2,2,8,7,8,6,2,0,2,6,2,3,6,6,7,2,4,7,5,2,7,2,1,6,1,2,8,5,0,1,7,8,8,7,0,5,3,9,5,3,0,6,2,4,1,0,3,3,4,4,8,3,3,2,5,1,9,4,8,0,1,4,6,2,9,0,6,7,3,1,8,8,8,6,8,5,3,3,0,8,1,9,3,0,6,6,0,7,1,8,0,7,2,0,0,3,5,9,0,2,8,0,4,0,6,5,0,6,8,6,0,1,0,5,0,8,3,8,7,0,8,8,3,5,0,0,1,4,0,7,9,3,8,7,9,5,7,4,0,0,4,0,0,4,6,9,4,8,1,1,3,1,1,3,8,1,2,1,0,5,2,3,8,2,9,7,7,3,9,4,0,3,5,5,5,1,1,8,6,9,6,8,6,1,8,8,6,4,2,7,9,1,3,0,7,1,3,7,1,6,0,1,7,8,0,6,1,9,5,6,7,1,0,4,3,8,7,0,8,5,2,7,6,0,7,9,3,7,5,3,9,8,2,0,5,7,1,8,1,2,9,4,9,6,4,6,1,2,1,9,8,0,9,9,2,1,8,9,2,2,4,0,8,5,0,3,9,8,1,7,1,2,9,7,0,4,3,6,3,4,8,7,6,5,1,3,4,5,8,5,7,1,8,5,0,9,5,6,9,8,1,2,7,4,3,1,3,7,2,0,9,4,2,0,9,5,4,6,1,9,9,1,5,5,4,1,5,8,0,9,9,4,2,4,5,5,2,5,2,6,7,8,4,2,7,8,7,0,6,0,1,3,7,5,1,0,5,4,3,9,8,1,8,8,3,0,3,4,9,4,7,3,7,8,3,7,9,1,3,4,5,5,7,6,5,9,3,1,8,7,8,5,3,5,6,3,1,6,2,8,3,0,7,9,3,6,6,8,1,6,3,4,8,9,5,1,7,4,9,8,6,5,8,1,5,5,8,4,8,3,9,1,9,2,9,5,7,5,0,7,4,1,6,2,1,8,1,2,1,6,4,5,2,6,3,3,0,1,1,4,6,6,4,2,6,4,6,9,6,6,7,2,8,6,0,9,2,3,2,4,8,7,9,6,6,7,8,2,7,4,0,0,0,6,9,6,7,1,9,8,7,7,8,7,6,3,7,1,3,1,8,7,7,3,9,2,2,0,9,1,1,9,1,8,8,3,2,8,9,7,0,0,6,1,8,6,1,9,2,0,7,8,0,6,7,2,8,3,4,9,6,8,9,0,4,4,5,9,5,5,2,3,4,7,0,7,2,2,2,1,3,3,7,3,4,7,9,5,5,8,5,2,0,0,9,5,4,7,8,3,3,8,6,8,5,6,9,1,4,0,0,3,8,7,5,5,8,3,8,4,6,4,8,8,6,1,5,0,4,6,5,5,7,7,1,0,6,8,3,0,8,7,9,9,7,2,1,6,5,9,6,2,9,0,3,0,7,3,7,8,5,1,2,2,9,0,4,1,0,9,3,7,1,1,2,1,3,3,3,7,5,0,5,1,9,3,9,6,3,7,7,9,1,2,0,8,8,3,0,4,0,3,5,9,8,2,8,0,3,5,6,7,8,7,8,3,7,6,5,0,1,5,5,2,7,2,9,3,9,2,9,1,0,8,5,5,5,3,4,0,9,0,9,1,1,0,3,7,5,6,7,0,2,8,2,7,7,8,4,8,2,1,2,7,6,3,3,5,2,8,2,3,2,8,2,5,7,0,9,7,1,7,1,6,5,4,9,8,2,9,7,2,5,1,5,4,2,6,1,9,9,7,0,5,9,5,0,4,8,6,9,5,4,3,5,7,1,8,8,9,7,6,8,5,8,1,5,7,1,9,0,4,2,0,2,3,9,2,9,9,8,8,5,2,1,6,4,2,6,7,2,4,1,7,7,1,2,2,1,3,6,4,6,8,5,1,4,0,5,6,9,3,1,0,6,9,4,8,6,1,1,1,8,5,2,3,8,3,0,7,3,6,7,4,1,3,4,3,3,6,0,1,9,6,8,9,1,1,5,1,3,4,4,4,6,8,4,3,4,6,6,6,0,5,6,5,1,7,2,8,1,9,2,1,8,8,0,4,6,8,9,6,5,0,2,4,9,2,4,4,2,7,8,9,3,3,7,7,0,9,6,9,8,3,3,7,9,7,7,2,1,0,7,8,1,6,2,3,9,7,2,8,3,1,8,5,9,6,1,8,2,7,8,0,9,4,0,9,9,3,5,5,4,9,2,9,4,6,1,7,2,7,8,1,4,0,5,5,0,2,7,4,4,0,7,1,0,7,7,1,8,7,6,7,4,4,0,4,4,0,8,5,8,2,0,8,7,9,7,8,6,1,2,0,5,5,4,5,0,4,9,1,2,9,8,9,3,5,1,6,5,4,7,9,0,4,3,9,0,7,0,5,1,7,8,6,7,0,6,8,1,8,1,1,7,7,3,5,1,0,0,6,6,4,1,8,8,2,6,5,3,1,7,9,1,2,1,5,8,0,9,7,3,2,1,6,6,6,3,9,9,4,2,4,8,7,2,7,0,7,8,1,1,7,0,9,2,0,5,4,6,1,4,7,9,8,1,1,3,8,1,9,8,5,1,4,9,2,3,2,4,4,7,1,4,9,2,2,1,8,2,3,2,5,5,4,6,4,8,9,6,9,7,8,7,1,2,6,9,3,6,7,9,2,6,5,7,7,7,6,9,6,8,3,4,7,4,8,9,5,3,8,1,9,1,6,3,6,2,8,8,6,2,4,6,3,0,3,7,2,5,9,2,7,1,1,4,2,4,8,9,4,1,6,4,7,1,3,6,8,4,3,4,8,7,9,4,3,9,3,1,1,1,1,8,4,6,7,4,5,7,8,7,4,8,0,5,8,7,2,0,3,8,5,0,4,1,7,5,9,0,7,3,8,2,1,4,4,8,6,3,9,0,4,2,6,1,6,6,0,9,3,4,4,4,8,7,0,6,0,1,7,2,9,7,0,9,9,5,3,3,7,6,7,2,3,8,3,8,5,5,0,3,2,7,6,7,3,2,1,1,9,5,9,4,2,9,2,6,7,4,5,4,0,4,8,8,9,0,4,2,4,6,6,0,9,9,3,5,1,5,4,6,2,4,9,8,2,7,0,3,4,8,2,0,7,5,5,9,7,6,9,3,4,4,4,0,9,1,7,2,8,1,3,0,4,5,2,9,8,4,4,5,3,7,1,2,6,7,4,9,7,0,8,4,2,0,3,5,4,9,2,9,7,4,1,0,9,9,1,5,4,3,1,5,1,7,2,2,1,0,5,1,4,2,0,0,1,3,0,2,7,5,8,9,6,6,4,8,6,6,9,3,6,1,9,2,8,7,4,6,3,1,3,3,4,3,7,8,7,9,7,8,2,5,0,3,9,3,9,2,5,8,8,3,0,0,0,2,6,2,0,3,2,4,0,3,2,2,9,2,2,2,5,1,6,0,8,2,8,7,2,8,5,9,9,6,9,2,0,2,1,2,2,0,9,0,0,1,9,9,1,6,1,4,1,0,8,4,6,7,8,2,6,0,6,0,1,6,7,7,6,3,4,3,4,2,2,8,4,6,8,0,2,1,9,0,0,5,4,6,7,2,2,8,7,7,2,1,1,4,2,3,7,0,0,9,5,5,7,5,2,8,7,5,6,3,0,7,0,6,6,0,6,9,1,4,3,9,0,8,1,7,8,3,9,4,7,6,5,0,6,4,1,5,6,0,0,1,1,1,3,0,5,2,1,4,2,2,1,6,2,9,6,8,1,1,6,8,8,6,6,4,9,4,5,4,8,4,2,8,5,9,0,2,9,3,7,1,3,6,6,2,5,4,9,7,6,0,6,3,7,7,0,6,8,1,8,3,2,8,8,4,7,2,8,3,5,5,5,4,5,2,6,7,2,1,5,4,9,8,8,0,7,5,9,6,2,1,3,7,8,1,5,1,5,8,2,6,9,4,2,8,7,0,2,5,9,2,4,2,4,3,9,9,4,3,2,0,1,9,3,7,0,0,9,9,3,3,0,2,3,8,5,9,8,7,8,4,7,3,8,7,7,7,3,7,3,2,2,7,4,7,3,6,0,6,0,3,3,6,7,5,8,1,8,5,6,0,2,8,7,8,2,9,9,6,8,6,2,0,5,2,8,3,6,1,7,6,4,3,1,0,8,6,8,9,2,2,7,0,6,4,6,4,4,1,9,8,1,9,0,5,1,6,6,2,7,8,3,9,6,2,4,6,1,9,5,6,7,0,6,4,3,3,7,9,0,3,9,7,7,7,1,4,4,6,8,4,1,8,7,1,9,4,7,1,1,1,6,3,4,9,2,3,8,6,4,5,4,2,9,1,6,8,9,8,4,2,6,4,9,4,6,7,2,1,5,4,5,9,7,0,9,9,0,5,1,0,0,0,6,5,9,2,2,8,7,6,3,9,9,1,6,2,8,4,8,6,2,1,2,2,0,9,1,3,0,7,8,0,0,9,9,6,2,3,4,2,8,7,9,1,6,4,3,6,9,6,8,5,5,5,5,6,6,3,5,6,3,0,7,6,1,3,8,4,2,6,0,8,6,2,7,7,2,2,3,8,5,3,7,6,9,7,8,0,7,9,7,0,7,1,0,7,9,0,3,2,9,9,0,4,7,3,0,1,8,0,8,0,8,1,4,2,1,1,1,7,5,3,2,0,7,1,0,6,0,4,8,8,5,1,3,7,6,0,5,0,1,0,8,9,4,7,0,3,2,6,5,1,4,9,1,0,0,6,1,7,4,9,7,2,6,9,1,1,8,4,2,9,9,0,4,6,1,2,2,3,0,3,6,2,5,3,6,9,9,0,1,8,5,6,5,2,0,0,2,6,4,7,2,9,1,6,3,7,3,4,0,0,1,4,6,6,0,1,5,1,5,5,0,9,7,7,1,6,4,7,9,1,1,0,3,5,2,9,6,6,4,4,3,1,3,3,5,6,4,9,7,1,2,0,2,1,6,0,3,9,0,4,0,1,6,0,7,9,1,4,0,2,3,0,8,4,8,4,7,2,2,1,1,6,7,6,6,6,8,8,0,5,9,1,3,8,0,8,2,6,8,9,8,0,5,9,3,5,8,5,2,4,1,2,8,0,7,8,4,6,4,6,7,4,1,8,1,1,5,2,3,7,0,0,1,2,2,9,4,2,0,0,1,8,7,7,0,8,9,3,8,8,8,5,6,3,7,1,3,9,9,2,2,8,0,3,4,7,1,2,0,8,6,7,1,1,0,5,2,8,2,0,2,6,0,2,4,1,0,3,4,0,8,8,7,1,2,4,0,0,7,9,1,2,8,4,9,8,6,7,5,3,0,9,2,9,4,1,8,7,7,1,1,2,3,4,7,4,2,8,2,3,8,9,0,9,0,9,8,6,9,5,1,5,8,9,9,9,8,2,2,2,2,9,3,5,3,7,0,5,7,5,0,7,3,4,6,6,5,3,3,8,3,0,2,6,4,4,0,6,1,3,6,1,7,3,5,0,8,8,1,4,2,3,3,1,5,8,6,9,7,7,3,7,1,1,4,6,7,0,7,2,2,1,3,1,1,7,4,6,9,3,4,1,0,2,2,7,8,6,4,6,2,9,7,7,1,2,7,2,1,6,5,5,2,1,9,1,5,2,3,2,2,8,7,5,8,8,8,7,3,7,1,9,8,7,1,9,9,9,1,8,0,7,7,2,7,1,4,1,4,6,2,7,2,8,2,7,9,8,7,2,4,1,8,2,1,5,2,7,4,0,4,4,2,2,6,3,2,7,9,6,8,2,9,6,8,2,2,3,4,9,1,0,6,9,3,2,0,7,2,0,0,0,0,2,5,5,5,4,1,9,9,2,6,4,8,0,9,2,4,1,8,7,8,7,9,1,0,8,6,6,6,3,4,0,8,0,6,6,1,1,3,9,4,1,5,7,2,1,2,9,9,7,5,4,4,1,2,1,0,3,1,4,2,3,0,4,4,0,6,4,5,6,0,4,7,4,3,3,1,5,1,1,0,8,4,9,1,4,0,1,7,9,3,1,4,4,7,7,6,9,4,7,2,5,9,4,7,9,0,9,5,7,6,1,0,4,8,6,7,7,6,4,7,5,8,7,8,9,8,2,9,2,2,3,8,3,6,9,6,9,7,9,5,4,1,5,4,3,5,3,6,2,1,4,7,0,7,4,0,5,2,3,6,4,2,5,1,5,3,7,8,3,6,2,9,0,3,3,2,9,3,9,5,1,4,7,2,6,1,3,8,9,9,8,6,6,7,4,8,4,2,7,8,0,4,1,4,9,9,0,5,4,4,0,6,2,2,2,2,3,3,2,1,4,2,8,9,7,4,7,4,3,9,1,6,8,8,4,7,9,3,1,1,8,8,9,9,4,6,9,7,6,8,9,2,4,4,2,3,5,5,3,8,8,5,4,2,6,3,0,7,3,7,3,3,1,8,3,4,3,6,6,4,8,8,7,2,8,7,8,4,7,7,5,1,6,5,5,6,7,1,9,2,9,9,4,3,0,3,9,3,3,9,9,8,2,4,9,0,4,1,6,8,6,6,3,1,7,0,2,1,4,4,7,1,2,9,1,0,7,5,5,8,5,4,2,6,3,3,4,7,2,3,5,1,0,1,9,0,7,7,7,8,7,5,2,1,7,2,6,0,3,7,9,5,2,3,7,4,5,7,1,6,7,5,9,3,2,6,8,5,1,5,2,6,8,1,7,2,1,4,3,8,2,4,0,8,5,6,7,3,6,6,8,0,8,8,1,0,6,5,3,5,4,3,7,4,9,4,8,2,3,3,6,4,4,3,1,0,8,0,6,9,8,8,1,3,8,7,1,3,3,6,4,9,6,4,5,9,6,6,8,3,9,8,2,9,2,7,9,2,2,0,4,1,4,9,3,9,2,7,1,9,3,8,4,6,3,8,8,9,6,4,2,7,7,6,0,7,7,7,9,7,7,2,9,6,0,9,5,6,3,5,0,4,1,6,8,9,3,1,5,3,5,6,8,5,2,1,0,9,6,9,9,8,0,3,8,4,9,7,0,9,0,3,9,1,0,8,9,9,0,0,6,8,4,5,7,3,0,2,9,0,5,4,9,7,2,4,7,6,5,1,2,5,5,7,6,0],"opacity":0.7,"showscale":true,"size":4},"mode":"markers","text":["digit=6","digit=2","digit=4","digit=9","digit=5","digit=7","digit=8","digit=1","digit=6","digit=2","digit=6","digit=4","digit=4","digit=9","digit=8","digit=2","digit=8","digit=5","digit=1","digit=8","digit=3","digit=4","digit=2","digit=8","digit=0","digit=9","digit=6","digit=1","digit=1","digit=9","digit=3","digit=2","digit=8","digit=6","digit=5","digit=0","digit=8","digit=4","digit=4","digit=1","digit=2","digit=7","digit=7","digit=3","digit=5","digit=9","digit=8","digit=2","digit=6","digit=3","digit=2","digit=0","digit=6","digit=6","digit=3","digit=7","digit=8","digit=9","digit=4","digit=1","digit=7","digit=0","digit=5","digit=4","digit=8","digit=4","digit=6","digit=8","digit=0","digit=6","digit=5","digit=0","digit=1","digit=9","digit=5","digit=3","digit=3","digit=2","digit=0","digit=6","digit=4","digit=2","digit=5","digit=4","digit=5","digit=4","digit=1","digit=3","digit=1","digit=9","digit=9","digit=2","digit=8","digit=7","digit=1","digit=1","digit=2","digit=7","digit=6","digit=2","digit=4","digit=6","digit=0","digit=8","digit=1","digit=7","digit=2","digit=1","digit=1","digit=5","digit=5","digit=8","digit=5","digit=6","digit=2","digit=8","digit=4","digit=6","digit=0","digit=6","digit=1","digit=9","digit=6","digit=2","digit=7","digit=3","digit=9","digit=8","digit=4","digit=7","digit=0","digit=0","digit=2","digit=2","digit=6","digit=7","digit=8","digit=9","digit=1","digit=8","digit=8","digit=4","digit=2","digit=6","digit=6","digit=2","digit=3","digit=0","digit=3","digit=7","digit=5","digit=3","digit=6","digit=2","digit=9","digit=4","digit=3","digit=6","digit=6","digit=8","digit=1","digit=8","digit=6","digit=1","digit=4","digit=3","digit=1","digit=3","digit=8","digit=0","digit=9","digit=5","digit=7","digit=2","digit=3","digit=5","digit=4","digit=1","digit=1","digit=4","digit=8","digit=6","digit=3","digit=1","digit=7","digit=4","digit=8","digit=1","digit=9","digit=0","digit=8","digit=0","digit=6","digit=0","digit=3","digit=9","digit=7","digit=0","digit=2","digit=8","digit=3","digit=8","digit=4","digit=3","digit=1","digit=3","digit=0","digit=5","digit=4","digit=8","digit=4","digit=8","digit=8","digit=2","digit=1","digit=7","digit=1","digit=0","digit=2","digit=1","digit=1","digit=8","digit=6","digit=7","digit=6","digit=8","digit=5","digit=5","digit=5","digit=1","digit=6","digit=1","digit=1","digit=4","digit=1","digit=1","digit=5","digit=0","digit=4","digit=7","digit=0","digit=9","digit=0","digit=4","digit=0","digit=5","digit=7","digit=4","digit=2","digit=2","digit=6","digit=2","digit=5","digit=1","digit=9","digit=9","digit=4","digit=6","digit=8","digit=0","digit=7","digit=2","digit=0","digit=9","digit=3","digit=5","digit=9","digit=0","digit=2","digit=0","digit=3","digit=7","digit=9","digit=1","digit=1","digit=0","digit=2","digit=1","digit=8","digit=4","digit=3","digit=4","digit=3","digit=3","digit=6","digit=1","digit=4","digit=3","digit=6","digit=0","digit=6","digit=8","digit=5","digit=9","digit=2","digit=7","digit=7","digit=7","digit=8","digit=2","digit=4","digit=4","digit=8","digit=7","digit=2","digit=5","digit=1","digit=4","digit=1","digit=4","digit=3","digit=5","digit=2","digit=8","digit=0","digit=7","digit=0","digit=4","digit=9","digit=1","digit=3","digit=8","digit=3","digit=2","digit=1","digit=4","digit=8","digit=5","digit=6","digit=6","digit=9","digit=7","digit=5","digit=1","digit=3","digit=9","digit=4","digit=2","digit=8","digit=7","digit=1","digit=8","digit=0","digit=3","digit=8","digit=5","digit=9","digit=6","digit=3","digit=0","digit=3","digit=6","digit=3","digit=3","digit=0","digit=1","digit=1","digit=7","digit=2","digit=2","digit=6","digit=4","digit=9","digit=4","digit=7","digit=8","digit=3","digit=7","digit=3","digit=5","digit=0","digit=3","digit=1","digit=2","digit=0","digit=5","digit=8","digit=4","digit=0","digit=3","digit=9","digit=0","digit=9","digit=0","digit=4","digit=7","digit=6","digit=3","digit=9","digit=5","digit=6","digit=2","digit=3","digit=9","digit=1","digit=7","digit=1","digit=0","digit=6","digit=6","digit=6","digit=9","digit=7","digit=0","digit=9","digit=2","digit=1","digit=2","digit=3","digit=6","digit=8","digit=7","digit=8","digit=4","digit=4","digit=3","digit=8","digit=4","digit=0","digit=1","digit=4","digit=8","digit=1","digit=2","digit=9","digit=9","digit=9","digit=9","digit=2","digit=8","digit=3","digit=3","digit=9","digit=2","digit=8","digit=9","digit=6","digit=9","digit=8","digit=0","digit=4","digit=5","digit=1","digit=0","digit=2","digit=3","digit=2","digit=8","digit=8","digit=2","digit=7","digit=7","digit=1","digit=4","digit=8","digit=5","digit=2","digit=3","digit=0","digit=9","digit=7","digit=0","digit=2","digit=4","digit=0","digit=9","digit=7","digit=5","digit=4","digit=3","digit=4","digit=5","digit=9","digit=7","digit=5","digit=5","digit=2","digit=8","digit=1","digit=6","digit=5","digit=6","digit=2","digit=9","digit=0","digit=2","digit=8","digit=5","digit=8","digit=2","digit=2","digit=3","digit=4","digit=8","digit=8","digit=8","digit=1","digit=2","digit=5","digit=1","digit=1","digit=9","digit=7","digit=0","digit=7","digit=9","digit=1","digit=4","digit=0","digit=9","digit=5","digit=1","digit=6","digit=7","digit=8","digit=8","digit=0","digit=0","digit=7","digit=7","digit=8","digit=6","digit=3","digit=3","digit=1","digit=4","digit=2","digit=3","digit=9","digit=5","digit=8","digit=0","digit=4","digit=3","digit=1","digit=9","digit=5","digit=2","digit=9","digit=2","digit=5","digit=3","digit=5","digit=6","digit=1","digit=8","digit=4","digit=6","digit=5","digit=0","digit=4","digit=9","digit=9","digit=0","digit=9","digit=2","digit=6","digit=9","digit=8","digit=9","digit=1","digit=5","digit=0","digit=3","digit=7","digit=0","digit=6","digit=5","digit=8","digit=3","digit=7","digit=7","digit=8","digit=3","digit=3","digit=2","digit=7","digit=1","digit=5","digit=9","digit=7","digit=4","digit=0","digit=2","digit=9","digit=6","digit=0","digit=4","digit=2","digit=7","digit=7","digit=6","digit=1","digit=9","digit=9","digit=3","digit=3","digit=1","digit=7","digit=8","digit=4","digit=0","digit=4","digit=8","digit=3","digit=3","digit=9","digit=5","digit=1","digit=1","digit=6","digit=9","digit=5","digit=3","digit=7","digit=1","digit=0","digit=5","digit=6","digit=0","digit=1","digit=0","digit=4","digit=0","digit=2","digit=2","digit=6","digit=7","digit=3","digit=9","digit=0","digit=1","digit=1","digit=8","digit=5","digit=9","digit=8","digit=7","digit=3","digit=4","digit=6","digit=9","digit=3","digit=1","digit=3","digit=8","digit=6","digit=9","digit=3","digit=3","digit=1","digit=3","digit=4","digit=2","digit=3","digit=6","digit=2","digit=7","digit=3","digit=0","digit=0","digit=3","digit=1","digit=7","digit=4","digit=6","digit=1","digit=6","digit=3","digit=1","digit=6","digit=5","digit=0","digit=5","digit=9","digit=2","digit=1","digit=9","digit=8","digit=7","digit=9","digit=2","digit=7","digit=6","digit=6","digit=7","digit=9","digit=6","digit=8","digit=6","digit=3","digit=6","digit=9","digit=6","digit=7","digit=0","digit=6","digit=0","digit=3","digit=9","digit=0","digit=0","digit=1","digit=0","digit=5","digit=6","digit=2","digit=8","digit=7","digit=7","digit=4","digit=7","digit=9","digit=5","digit=3","digit=8","digit=0","digit=0","digit=0","digit=4","digit=0","digit=9","digit=3","digit=9","digit=3","digit=9","digit=2","digit=6","digit=8","digit=1","digit=9","digit=1","digit=3","digit=7","digit=4","digit=7","digit=4","digit=1","digit=1","digit=8","digit=5","digit=2","digit=0","digit=1","digit=3","digit=3","digit=3","digit=5","digit=2","digit=8","digit=8","digit=1","digit=9","digit=9","digit=2","digit=0","digit=4","digit=7","digit=8","digit=6","digit=3","digit=8","digit=4","digit=9","digit=3","digit=7","digit=1","digit=2","digit=3","digit=7","digit=2","digit=7","digit=6","digit=2","digit=6","digit=5","digit=1","digit=4","digit=7","digit=4","digit=8","digit=7","digit=7","digit=1","digit=6","digit=4","digit=5","digit=0","digit=6","digit=8","digit=4","digit=7","digit=1","digit=7","digit=6","digit=3","digit=2","digit=8","digit=5","digit=9","digit=6","digit=8","digit=2","digit=9","digit=1","digit=0","digit=9","digit=6","digit=4","digit=5","digit=6","digit=2","digit=1","digit=2","digit=2","digit=5","digit=9","digit=5","digit=1","digit=0","digit=2","digit=7","digit=2","digit=7","digit=2","digit=0","digit=6","digit=0","digit=2","digit=6","digit=6","digit=6","digit=2","digit=6","digit=8","digit=7","digit=2","digit=2","digit=7","digit=9","digit=1","digit=5","digit=0","digit=7","digit=2","digit=5","digit=8","digit=2","digit=7","digit=5","digit=9","digit=6","digit=7","digit=2","digit=7","digit=7","digit=2","digit=4","digit=8","digit=6","digit=2","digit=5","digit=5","digit=5","digit=0","digit=8","digit=6","digit=4","digit=5","digit=3","digit=4","digit=1","digit=6","digit=5","digit=8","digit=4","digit=2","digit=3","digit=2","digit=9","digit=3","digit=2","digit=4","digit=0","digit=3","digit=9","digit=1","digit=3","digit=3","digit=0","digit=8","digit=2","digit=9","digit=6","digit=8","digit=4","digit=7","digit=2","digit=0","digit=8","digit=2","digit=8","digit=7","digit=0","digit=9","digit=7","digit=6","digit=4","digit=0","digit=0","digit=3","digit=1","digit=9","digit=1","digit=8","digit=4","digit=8","digit=6","digit=1","digit=3","digit=0","digit=7","digit=3","digit=8","digit=4","digit=9","digit=5","digit=3","digit=6","digit=8","digit=9","digit=0","digit=8","digit=0","digit=9","digit=7","digit=9","digit=5","digit=6","digit=9","digit=9","digit=6","digit=6","digit=2","digit=1","digit=4","digit=3","digit=3","digit=5","digit=2","digit=8","digit=2","digit=9","digit=3","digit=0","digit=9","digit=5","digit=9","digit=5","digit=0","digit=6","digit=8","digit=9","digit=4","digit=4","digit=0","digit=7","digit=0","digit=6","digit=0","digit=0","digit=9","digit=2","digit=3","digit=6","digit=0","digit=0","digit=6","digit=0","digit=1","digit=6","digit=2","digit=7","digit=2","digit=3","digit=8","digit=3","digit=5","digit=1","digit=9","digit=4","digit=1","digit=8","digit=1","digit=4","digit=5","digit=6","digit=9","digit=5","digit=2","digit=1","digit=4","digit=3","digit=2","digit=1","digit=5","digit=5","digit=2","digit=6","digit=9","digit=8","digit=7","digit=2","digit=9","digit=6","digit=6","digit=8","digit=1","digit=2","digit=8","digit=8","digit=4","digit=6","digit=3","digit=6","digit=0","digit=9","digit=6","digit=1","digit=1","digit=1","digit=0","digit=7","digit=2","digit=4","digit=7","digit=2","digit=5","digit=5","digit=9","digit=8","digit=5","digit=3","digit=5","digit=9","digit=9","digit=0","digit=8","digit=3","digit=4","digit=3","digit=8","digit=8","digit=1","digit=4","digit=9","digit=0","digit=6","digit=5","digit=1","digit=6","digit=9","digit=6","digit=3","digit=0","digit=8","digit=6","digit=0","digit=6","digit=1","digit=8","digit=1","digit=1","digit=5","digit=3","digit=2","digit=2","digit=4","digit=6","digit=6","digit=8","digit=9","digit=2","digit=8","digit=0","digit=4","digit=5","digit=7","digit=2","digit=1","digit=6","digit=2","digit=4","digit=9","digit=7","digit=6","digit=1","digit=6","digit=7","digit=6","digit=9","digit=4","digit=0","digit=5","digit=2","digit=4","digit=8","digit=2","digit=2","digit=0","digit=4","digit=6","digit=2","digit=6","digit=5","digit=3","digit=1","digit=2","digit=4","digit=7","digit=6","digit=2","digit=4","digit=8","digit=9","digit=4","digit=8","digit=3","digit=6","digit=7","digit=1","digit=6","digit=5","digit=5","digit=3","digit=5","digit=7","digit=8","digit=0","digit=6","digit=5","digit=9","digit=3","digit=0","digit=1","digit=6","digit=1","digit=1","digit=5","digit=5","digit=4","digit=1","digit=0","digit=9","digit=0","digit=8","digit=7","digit=7","digit=7","digit=4","digit=4","digit=2","digit=4","digit=9","digit=3","digit=6","digit=3","digit=9","digit=9","digit=3","digit=1","digit=0","digit=0","digit=3","digit=8","digit=4","digit=3","digit=3","digit=0","digit=6","digit=4","digit=7","digit=7","digit=3","digit=6","digit=4","digit=5","digit=9","digit=6","digit=1","digit=3","digit=1","digit=9","digit=8","digit=7","digit=2","digit=5","digit=1","digit=5","digit=3","digit=0","digit=7","digit=9","digit=6","digit=5","digit=7","digit=9","digit=8","digit=4","digit=1","digit=7","digit=6","digit=3","digit=3","digit=5","digit=1","digit=0","digit=7","digit=4","digit=8","digit=5","digit=4","digit=8","digit=8","digit=9","digit=9","digit=8","digit=2","digit=1","digit=6","digit=3","digit=1","digit=8","digit=3","digit=5","digit=9","digit=5","digit=4","digit=7","digit=1","digit=1","digit=0","digit=4","digit=6","digit=2","digit=6","digit=4","digit=7","digit=5","digit=5","digit=0","digit=5","digit=7","digit=4","digit=3","digit=1","digit=8","digit=3","digit=1","digit=7","digit=2","digit=1","digit=6","digit=9","digit=7","digit=6","digit=8","digit=7","digit=2","digit=6","digit=9","digit=0","digit=6","digit=8","digit=6","digit=0","digit=6","digit=1","digit=9","digit=0","digit=9","digit=2","digit=5","digit=5","digit=7","digit=5","digit=7","digit=8","digit=3","digit=0","digit=0","digit=4","digit=1","digit=7","digit=7","digit=2","digit=5","digit=1","digit=6","digit=1","digit=7","digit=1","digit=5","digit=7","digit=4","digit=2","digit=1","digit=6","digit=0","digit=7","digit=4","digit=0","digit=7","digit=6","digit=2","digit=5","digit=6","digit=0","digit=3","digit=8","digit=0","digit=1","digit=8","digit=7","digit=8","digit=3","digit=1","digit=4","digit=9","digit=9","digit=5","digit=3","digit=7","digit=1","digit=6","digit=3","digit=0","digit=1","digit=1","digit=8","digit=4","digit=3","digit=0","digit=8","digit=9","digit=7","digit=9","digit=3","digit=6","digit=3","digit=7","digit=8","digit=7","digit=5","digit=5","digit=1","digit=6","digit=7","digit=1","digit=1","digit=1","digit=4","digit=3","digit=0","digit=4","digit=0","digit=1","digit=7","digit=9","digit=3","digit=4","digit=7","digit=9","digit=8","digit=8","digit=3","digit=7","digit=3","digit=8","digit=1","digit=7","digit=5","digit=5","digit=3","digit=1","digit=2","digit=3","digit=0","digit=9","digit=4","digit=8","digit=5","digit=7","digit=2","digit=7","digit=5","digit=8","digit=3","digit=0","digit=0","digit=9","digit=6","digit=6","digit=9","digit=2","digit=5","digit=0","digit=2","digit=9","digit=1","digit=2","digit=8","digit=7","digit=5","digit=0","digit=2","digit=5","digit=7","digit=6","digit=8","digit=9","digit=5","digit=1","digit=7","digit=6","digit=7","digit=4","digit=8","digit=1","digit=8","digit=9","digit=8","digit=2","digit=3","digit=8","digit=2","digit=7","digit=1","digit=0","digit=5","digit=7","digit=1","digit=2","digit=3","digit=2","digit=4","digit=7","digit=9","digit=0","digit=2","digit=6","digit=8","digit=2","digit=9","digit=3","digit=2","digit=5","digit=5","digit=3","digit=9","digit=5","digit=4","digit=7","digit=2","digit=7","digit=3","digit=7","digit=1","digit=9","digit=8","digit=4","digit=9","digit=6","digit=5","digit=8","digit=3","digit=4","digit=0","digit=7","digit=0","digit=9","digit=6","digit=1","digit=3","digit=1","digit=6","digit=3","digit=3","digit=9","digit=9","digit=8","digit=4","digit=6","digit=1","digit=3","digit=0","digit=9","digit=0","digit=6","digit=6","digit=0","digit=3","digit=1","digit=2","digit=1","digit=0","digit=7","digit=5","digit=6","digit=3","digit=9","digit=5","digit=6","digit=1","digit=0","digit=8","digit=1","digit=0","digit=4","digit=2","digit=6","digit=3","digit=5","digit=7","digit=7","digit=0","digit=9","digit=3","digit=9","digit=1","digit=7","digit=7","digit=6","digit=6","digit=9","digit=6","digit=9","digit=4","digit=5","digit=7","digit=4","digit=2","digit=6","digit=7","digit=0","digit=6","digit=2","digit=1","digit=8","digit=5","digit=5","digit=2","digit=3","digit=8","digit=3","digit=7","digit=3","digit=7","digit=6","digit=3","digit=8","digit=4","digit=4","digit=1","digit=2","digit=3","digit=9","digit=7","digit=3","digit=5","digit=9","digit=8","digit=2","digit=3","digit=1","digit=3","digit=3","digit=8","digit=4","digit=0","digit=0","digit=2","digit=3","digit=9","digit=4","digit=0","digit=3","digit=3","digit=4","digit=8","digit=3","digit=5","digit=4","digit=7","digit=6","digit=7","digit=8","digit=5","digit=9","digit=4","digit=1","digit=7","digit=3","digit=1","digit=3","digit=0","digit=8","digit=8","digit=6","digit=4","digit=3","digit=9","digit=7","digit=0","digit=8","digit=7","digit=5","digit=2","digit=9","digit=7","digit=6","digit=0","digit=5","digit=4","digit=7","digit=5","digit=2","digit=5","digit=6","digit=6","digit=4","digit=4","digit=4","digit=9","digit=4","digit=0","digit=1","digit=0","digit=6","digit=0","digit=8","digit=0","digit=1","digit=4","digit=6","digit=4","digit=7","digit=1","digit=4","digit=7","digit=9","digit=4","digit=1","digit=5","digit=9","digit=4","digit=4","digit=0","digit=0","digit=4","digit=4","digit=7","digit=0","digit=7","digit=3","digit=2","digit=7","digit=8","digit=3","digit=1","digit=1","digit=5","digit=9","digit=8","digit=2","digit=0","digit=1","digit=6","digit=0","digit=9","digit=5","digit=4","digit=1","digit=1","digit=6","digit=2","digit=3","digit=4","digit=0","digit=8","digit=4","digit=4","digit=6","digit=3","digit=3","digit=6","digit=2","digit=6","digit=8","digit=2","digit=6","digit=4","digit=7","digit=8","digit=4","digit=2","digit=0","digit=0","digit=8","digit=2","digit=6","digit=8","digit=4","digit=9","digit=1","digit=0","digit=7","digit=3","digit=9","digit=9","digit=9","digit=1","digit=8","digit=0","digit=0","digit=1","digit=8","digit=3","digit=4","digit=3","digit=9","digit=0","digit=6","digit=0","digit=8","digit=3","digit=9","digit=6","digit=1","digit=4","digit=6","digit=1","digit=5","digit=2","digit=2","digit=3","digit=5","digit=1","digit=4","digit=9","digit=5","digit=5","digit=4","digit=7","digit=0","digit=9","digit=1","digit=0","digit=7","digit=9","digit=0","digit=2","digit=7","digit=9","digit=4","digit=4","digit=1","digit=6","digit=8","digit=0","digit=6","digit=8","digit=1","digit=3","digit=7","digit=1","digit=1","digit=0","digit=8","digit=3","digit=5","digit=0","digit=6","digit=3","digit=5","digit=4","digit=9","digit=4","digit=1","digit=3","digit=0","digit=8","digit=8","digit=7","digit=8","digit=7","digit=2","digit=2","digit=5","digit=6","digit=6","digit=9","digit=5","digit=4","digit=9","digit=8","digit=1","digit=7","digit=6","digit=5","digit=8","digit=1","digit=4","digit=6","digit=1","digit=3","digit=4","digit=4","digit=3","digit=2","digit=4","digit=7","digit=6","digit=9","digit=6","digit=3","digit=9","digit=4","digit=7","digit=1","digit=2","digit=2","digit=8","digit=7","digit=8","digit=6","digit=2","digit=0","digit=2","digit=6","digit=2","digit=3","digit=6","digit=6","digit=7","digit=2","digit=4","digit=7","digit=5","digit=2","digit=7","digit=2","digit=1","digit=6","digit=1","digit=2","digit=8","digit=5","digit=0","digit=1","digit=7","digit=8","digit=8","digit=7","digit=0","digit=5","digit=3","digit=9","digit=5","digit=3","digit=0","digit=6","digit=2","digit=4","digit=1","digit=0","digit=3","digit=3","digit=4","digit=4","digit=8","digit=3","digit=3","digit=2","digit=5","digit=1","digit=9","digit=4","digit=8","digit=0","digit=1","digit=4","digit=6","digit=2","digit=9","digit=0","digit=6","digit=7","digit=3","digit=1","digit=8","digit=8","digit=8","digit=6","digit=8","digit=5","digit=3","digit=3","digit=0","digit=8","digit=1","digit=9","digit=3","digit=0","digit=6","digit=6","digit=0","digit=7","digit=1","digit=8","digit=0","digit=7","digit=2","digit=0","digit=0","digit=3","digit=5","digit=9","digit=0","digit=2","digit=8","digit=0","digit=4","digit=0","digit=6","digit=5","digit=0","digit=6","digit=8","digit=6","digit=0","digit=1","digit=0","digit=5","digit=0","digit=8","digit=3","digit=8","digit=7","digit=0","digit=8","digit=8","digit=3","digit=5","digit=0","digit=0","digit=1","digit=4","digit=0","digit=7","digit=9","digit=3","digit=8","digit=7","digit=9","digit=5","digit=7","digit=4","digit=0","digit=0","digit=4","digit=0","digit=0","digit=4","digit=6","digit=9","digit=4","digit=8","digit=1","digit=1","digit=3","digit=1","digit=1","digit=3","digit=8","digit=1","digit=2","digit=1","digit=0","digit=5","digit=2","digit=3","digit=8","digit=2","digit=9","digit=7","digit=7","digit=3","digit=9","digit=4","digit=0","digit=3","digit=5","digit=5","digit=5","digit=1","digit=1","digit=8","digit=6","digit=9","digit=6","digit=8","digit=6","digit=1","digit=8","digit=8","digit=6","digit=4","digit=2","digit=7","digit=9","digit=1","digit=3","digit=0","digit=7","digit=1","digit=3","digit=7","digit=1","digit=6","digit=0","digit=1","digit=7","digit=8","digit=0","digit=6","digit=1","digit=9","digit=5","digit=6","digit=7","digit=1","digit=0","digit=4","digit=3","digit=8","digit=7","digit=0","digit=8","digit=5","digit=2","digit=7","digit=6","digit=0","digit=7","digit=9","digit=3","digit=7","digit=5","digit=3","digit=9","digit=8","digit=2","digit=0","digit=5","digit=7","digit=1","digit=8","digit=1","digit=2","digit=9","digit=4","digit=9","digit=6","digit=4","digit=6","digit=1","digit=2","digit=1","digit=9","digit=8","digit=0","digit=9","digit=9","digit=2","digit=1","digit=8","digit=9","digit=2","digit=2","digit=4","digit=0","digit=8","digit=5","digit=0","digit=3","digit=9","digit=8","digit=1","digit=7","digit=1","digit=2","digit=9","digit=7","digit=0","digit=4","digit=3","digit=6","digit=3","digit=4","digit=8","digit=7","digit=6","digit=5","digit=1","digit=3","digit=4","digit=5","digit=8","digit=5","digit=7","digit=1","digit=8","digit=5","digit=0","digit=9","digit=5","digit=6","digit=9","digit=8","digit=1","digit=2","digit=7","digit=4","digit=3","digit=1","digit=3","digit=7","digit=2","digit=0","digit=9","digit=4","digit=2","digit=0","digit=9","digit=5","digit=4","digit=6","digit=1","digit=9","digit=9","digit=1","digit=5","digit=5","digit=4","digit=1","digit=5","digit=8","digit=0","digit=9","digit=9","digit=4","digit=2","digit=4","digit=5","digit=5","digit=2","digit=5","digit=2","digit=6","digit=7","digit=8","digit=4","digit=2","digit=7","digit=8","digit=7","digit=0","digit=6","digit=0","digit=1","digit=3","digit=7","digit=5","digit=1","digit=0","digit=5","digit=4","digit=3","digit=9","digit=8","digit=1","digit=8","digit=8","digit=3","digit=0","digit=3","digit=4","digit=9","digit=4","digit=7","digit=3","digit=7","digit=8","digit=3","digit=7","digit=9","digit=1","digit=3","digit=4","digit=5","digit=5","digit=7","digit=6","digit=5","digit=9","digit=3","digit=1","digit=8","digit=7","digit=8","digit=5","digit=3","digit=5","digit=6","digit=3","digit=1","digit=6","digit=2","digit=8","digit=3","digit=0","digit=7","digit=9","digit=3","digit=6","digit=6","digit=8","digit=1","digit=6","digit=3","digit=4","digit=8","digit=9","digit=5","digit=1","digit=7","digit=4","digit=9","digit=8","digit=6","digit=5","digit=8","digit=1","digit=5","digit=5","digit=8","digit=4","digit=8","digit=3","digit=9","digit=1","digit=9","digit=2","digit=9","digit=5","digit=7","digit=5","digit=0","digit=7","digit=4","digit=1","digit=6","digit=2","digit=1","digit=8","digit=1","digit=2","digit=1","digit=6","digit=4","digit=5","digit=2","digit=6","digit=3","digit=3","digit=0","digit=1","digit=1","digit=4","digit=6","digit=6","digit=4","digit=2","digit=6","digit=4","digit=6","digit=9","digit=6","digit=6","digit=7","digit=2","digit=8","digit=6","digit=0","digit=9","digit=2","digit=3","digit=2","digit=4","digit=8","digit=7","digit=9","digit=6","digit=6","digit=7","digit=8","digit=2","digit=7","digit=4","digit=0","digit=0","digit=0","digit=6","digit=9","digit=6","digit=7","digit=1","digit=9","digit=8","digit=7","digit=7","digit=8","digit=7","digit=6","digit=3","digit=7","digit=1","digit=3","digit=1","digit=8","digit=7","digit=7","digit=3","digit=9","digit=2","digit=2","digit=0","digit=9","digit=1","digit=1","digit=9","digit=1","digit=8","digit=8","digit=3","digit=2","digit=8","digit=9","digit=7","digit=0","digit=0","digit=6","digit=1","digit=8","digit=6","digit=1","digit=9","digit=2","digit=0","digit=7","digit=8","digit=0","digit=6","digit=7","digit=2","digit=8","digit=3","digit=4","digit=9","digit=6","digit=8","digit=9","digit=0","digit=4","digit=4","digit=5","digit=9","digit=5","digit=5","digit=2","digit=3","digit=4","digit=7","digit=0","digit=7","digit=2","digit=2","digit=2","digit=1","digit=3","digit=3","digit=7","digit=3","digit=4","digit=7","digit=9","digit=5","digit=5","digit=8","digit=5","digit=2","digit=0","digit=0","digit=9","digit=5","digit=4","digit=7","digit=8","digit=3","digit=3","digit=8","digit=6","digit=8","digit=5","digit=6","digit=9","digit=1","digit=4","digit=0","digit=0","digit=3","digit=8","digit=7","digit=5","digit=5","digit=8","digit=3","digit=8","digit=4","digit=6","digit=4","digit=8","digit=8","digit=6","digit=1","digit=5","digit=0","digit=4","digit=6","digit=5","digit=5","digit=7","digit=7","digit=1","digit=0","digit=6","digit=8","digit=3","digit=0","digit=8","digit=7","digit=9","digit=9","digit=7","digit=2","digit=1","digit=6","digit=5","digit=9","digit=6","digit=2","digit=9","digit=0","digit=3","digit=0","digit=7","digit=3","digit=7","digit=8","digit=5","digit=1","digit=2","digit=2","digit=9","digit=0","digit=4","digit=1","digit=0","digit=9","digit=3","digit=7","digit=1","digit=1","digit=2","digit=1","digit=3","digit=3","digit=3","digit=7","digit=5","digit=0","digit=5","digit=1","digit=9","digit=3","digit=9","digit=6","digit=3","digit=7","digit=7","digit=9","digit=1","digit=2","digit=0","digit=8","digit=8","digit=3","digit=0","digit=4","digit=0","digit=3","digit=5","digit=9","digit=8","digit=2","digit=8","digit=0","digit=3","digit=5","digit=6","digit=7","digit=8","digit=7","digit=8","digit=3","digit=7","digit=6","digit=5","digit=0","digit=1","digit=5","digit=5","digit=2","digit=7","digit=2","digit=9","digit=3","digit=9","digit=2","digit=9","digit=1","digit=0","digit=8","digit=5","digit=5","digit=5","digit=3","digit=4","digit=0","digit=9","digit=0","digit=9","digit=1","digit=1","digit=0","digit=3","digit=7","digit=5","digit=6","digit=7","digit=0","digit=2","digit=8","digit=2","digit=7","digit=7","digit=8","digit=4","digit=8","digit=2","digit=1","digit=2","digit=7","digit=6","digit=3","digit=3","digit=5","digit=2","digit=8","digit=2","digit=3","digit=2","digit=8","digit=2","digit=5","digit=7","digit=0","digit=9","digit=7","digit=1","digit=7","digit=1","digit=6","digit=5","digit=4","digit=9","digit=8","digit=2","digit=9","digit=7","digit=2","digit=5","digit=1","digit=5","digit=4","digit=2","digit=6","digit=1","digit=9","digit=9","digit=7","digit=0","digit=5","digit=9","digit=5","digit=0","digit=4","digit=8","digit=6","digit=9","digit=5","digit=4","digit=3","digit=5","digit=7","digit=1","digit=8","digit=8","digit=9","digit=7","digit=6","digit=8","digit=5","digit=8","digit=1","digit=5","digit=7","digit=1","digit=9","digit=0","digit=4","digit=2","digit=0","digit=2","digit=3","digit=9","digit=2","digit=9","digit=9","digit=8","digit=8","digit=5","digit=2","digit=1","digit=6","digit=4","digit=2","digit=6","digit=7","digit=2","digit=4","digit=1","digit=7","digit=7","digit=1","digit=2","digit=2","digit=1","digit=3","digit=6","digit=4","digit=6","digit=8","digit=5","digit=1","digit=4","digit=0","digit=5","digit=6","digit=9","digit=3","digit=1","digit=0","digit=6","digit=9","digit=4","digit=8","digit=6","digit=1","digit=1","digit=1","digit=8","digit=5","digit=2","digit=3","digit=8","digit=3","digit=0","digit=7","digit=3","digit=6","digit=7","digit=4","digit=1","digit=3","digit=4","digit=3","digit=3","digit=6","digit=0","digit=1","digit=9","digit=6","digit=8","digit=9","digit=1","digit=1","digit=5","digit=1","digit=3","digit=4","digit=4","digit=4","digit=6","digit=8","digit=4","digit=3","digit=4","digit=6","digit=6","digit=6","digit=0","digit=5","digit=6","digit=5","digit=1","digit=7","digit=2","digit=8","digit=1","digit=9","digit=2","digit=1","digit=8","digit=8","digit=0","digit=4","digit=6","digit=8","digit=9","digit=6","digit=5","digit=0","digit=2","digit=4","digit=9","digit=2","digit=4","digit=4","digit=2","digit=7","digit=8","digit=9","digit=3","digit=3","digit=7","digit=7","digit=0","digit=9","digit=6","digit=9","digit=8","digit=3","digit=3","digit=7","digit=9","digit=7","digit=7","digit=2","digit=1","digit=0","digit=7","digit=8","digit=1","digit=6","digit=2","digit=3","digit=9","digit=7","digit=2","digit=8","digit=3","digit=1","digit=8","digit=5","digit=9","digit=6","digit=1","digit=8","digit=2","digit=7","digit=8","digit=0","digit=9","digit=4","digit=0","digit=9","digit=9","digit=3","digit=5","digit=5","digit=4","digit=9","digit=2","digit=9","digit=4","digit=6","digit=1","digit=7","digit=2","digit=7","digit=8","digit=1","digit=4","digit=0","digit=5","digit=5","digit=0","digit=2","digit=7","digit=4","digit=4","digit=0","digit=7","digit=1","digit=0","digit=7","digit=7","digit=1","digit=8","digit=7","digit=6","digit=7","digit=4","digit=4","digit=0","digit=4","digit=4","digit=0","digit=8","digit=5","digit=8","digit=2","digit=0","digit=8","digit=7","digit=9","digit=7","digit=8","digit=6","digit=1","digit=2","digit=0","digit=5","digit=5","digit=4","digit=5","digit=0","digit=4","digit=9","digit=1","digit=2","digit=9","digit=8","digit=9","digit=3","digit=5","digit=1","digit=6","digit=5","digit=4","digit=7","digit=9","digit=0","digit=4","digit=3","digit=9","digit=0","digit=7","digit=0","digit=5","digit=1","digit=7","digit=8","digit=6","digit=7","digit=0","digit=6","digit=8","digit=1","digit=8","digit=1","digit=1","digit=7","digit=7","digit=3","digit=5","digit=1","digit=0","digit=0","digit=6","digit=6","digit=4","digit=1","digit=8","digit=8","digit=2","digit=6","digit=5","digit=3","digit=1","digit=7","digit=9","digit=1","digit=2","digit=1","digit=5","digit=8","digit=0","digit=9","digit=7","digit=3","digit=2","digit=1","digit=6","digit=6","digit=6","digit=3","digit=9","digit=9","digit=4","digit=2","digit=4","digit=8","digit=7","digit=2","digit=7","digit=0","digit=7","digit=8","digit=1","digit=1","digit=7","digit=0","digit=9","digit=2","digit=0","digit=5","digit=4","digit=6","digit=1","digit=4","digit=7","digit=9","digit=8","digit=1","digit=1","digit=3","digit=8","digit=1","digit=9","digit=8","digit=5","digit=1","digit=4","digit=9","digit=2","digit=3","digit=2","digit=4","digit=4","digit=7","digit=1","digit=4","digit=9","digit=2","digit=2","digit=1","digit=8","digit=2","digit=3","digit=2","digit=5","digit=5","digit=4","digit=6","digit=4","digit=8","digit=9","digit=6","digit=9","digit=7","digit=8","digit=7","digit=1","digit=2","digit=6","digit=9","digit=3","digit=6","digit=7","digit=9","digit=2","digit=6","digit=5","digit=7","digit=7","digit=7","digit=6","digit=9","digit=6","digit=8","digit=3","digit=4","digit=7","digit=4","digit=8","digit=9","digit=5","digit=3","digit=8","digit=1","digit=9","digit=1","digit=6","digit=3","digit=6","digit=2","digit=8","digit=8","digit=6","digit=2","digit=4","digit=6","digit=3","digit=0","digit=3","digit=7","digit=2","digit=5","digit=9","digit=2","digit=7","digit=1","digit=1","digit=4","digit=2","digit=4","digit=8","digit=9","digit=4","digit=1","digit=6","digit=4","digit=7","digit=1","digit=3","digit=6","digit=8","digit=4","digit=3","digit=4","digit=8","digit=7","digit=9","digit=4","digit=3","digit=9","digit=3","digit=1","digit=1","digit=1","digit=1","digit=8","digit=4","digit=6","digit=7","digit=4","digit=5","digit=7","digit=8","digit=7","digit=4","digit=8","digit=0","digit=5","digit=8","digit=7","digit=2","digit=0","digit=3","digit=8","digit=5","digit=0","digit=4","digit=1","digit=7","digit=5","digit=9","digit=0","digit=7","digit=3","digit=8","digit=2","digit=1","digit=4","digit=4","digit=8","digit=6","digit=3","digit=9","digit=0","digit=4","digit=2","digit=6","digit=1","digit=6","digit=6","digit=0","digit=9","digit=3","digit=4","digit=4","digit=4","digit=8","digit=7","digit=0","digit=6","digit=0","digit=1","digit=7","digit=2","digit=9","digit=7","digit=0","digit=9","digit=9","digit=5","digit=3","digit=3","digit=7","digit=6","digit=7","digit=2","digit=3","digit=8","digit=3","digit=8","digit=5","digit=5","digit=0","digit=3","digit=2","digit=7","digit=6","digit=7","digit=3","digit=2","digit=1","digit=1","digit=9","digit=5","digit=9","digit=4","digit=2","digit=9","digit=2","digit=6","digit=7","digit=4","digit=5","digit=4","digit=0","digit=4","digit=8","digit=8","digit=9","digit=0","digit=4","digit=2","digit=4","digit=6","digit=6","digit=0","digit=9","digit=9","digit=3","digit=5","digit=1","digit=5","digit=4","digit=6","digit=2","digit=4","digit=9","digit=8","digit=2","digit=7","digit=0","digit=3","digit=4","digit=8","digit=2","digit=0","digit=7","digit=5","digit=5","digit=9","digit=7","digit=6","digit=9","digit=3","digit=4","digit=4","digit=4","digit=0","digit=9","digit=1","digit=7","digit=2","digit=8","digit=1","digit=3","digit=0","digit=4","digit=5","digit=2","digit=9","digit=8","digit=4","digit=4","digit=5","digit=3","digit=7","digit=1","digit=2","digit=6","digit=7","digit=4","digit=9","digit=7","digit=0","digit=8","digit=4","digit=2","digit=0","digit=3","digit=5","digit=4","digit=9","digit=2","digit=9","digit=7","digit=4","digit=1","digit=0","digit=9","digit=9","digit=1","digit=5","digit=4","digit=3","digit=1","digit=5","digit=1","digit=7","digit=2","digit=2","digit=1","digit=0","digit=5","digit=1","digit=4","digit=2","digit=0","digit=0","digit=1","digit=3","digit=0","digit=2","digit=7","digit=5","digit=8","digit=9","digit=6","digit=6","digit=4","digit=8","digit=6","digit=6","digit=9","digit=3","digit=6","digit=1","digit=9","digit=2","digit=8","digit=7","digit=4","digit=6","digit=3","digit=1","digit=3","digit=3","digit=4","digit=3","digit=7","digit=8","digit=7","digit=9","digit=7","digit=8","digit=2","digit=5","digit=0","digit=3","digit=9","digit=3","digit=9","digit=2","digit=5","digit=8","digit=8","digit=3","digit=0","digit=0","digit=0","digit=2","digit=6","digit=2","digit=0","digit=3","digit=2","digit=4","digit=0","digit=3","digit=2","digit=2","digit=9","digit=2","digit=2","digit=2","digit=5","digit=1","digit=6","digit=0","digit=8","digit=2","digit=8","digit=7","digit=2","digit=8","digit=5","digit=9","digit=9","digit=6","digit=9","digit=2","digit=0","digit=2","digit=1","digit=2","digit=2","digit=0","digit=9","digit=0","digit=0","digit=1","digit=9","digit=9","digit=1","digit=6","digit=1","digit=4","digit=1","digit=0","digit=8","digit=4","digit=6","digit=7","digit=8","digit=2","digit=6","digit=0","digit=6","digit=0","digit=1","digit=6","digit=7","digit=7","digit=6","digit=3","digit=4","digit=3","digit=4","digit=2","digit=2","digit=8","digit=4","digit=6","digit=8","digit=0","digit=2","digit=1","digit=9","digit=0","digit=0","digit=5","digit=4","digit=6","digit=7","digit=2","digit=2","digit=8","digit=7","digit=7","digit=2","digit=1","digit=1","digit=4","digit=2","digit=3","digit=7","digit=0","digit=0","digit=9","digit=5","digit=5","digit=7","digit=5","digit=2","digit=8","digit=7","digit=5","digit=6","digit=3","digit=0","digit=7","digit=0","digit=6","digit=6","digit=0","digit=6","digit=9","digit=1","digit=4","digit=3","digit=9","digit=0","digit=8","digit=1","digit=7","digit=8","digit=3","digit=9","digit=4","digit=7","digit=6","digit=5","digit=0","digit=6","digit=4","digit=1","digit=5","digit=6","digit=0","digit=0","digit=1","digit=1","digit=1","digit=3","digit=0","digit=5","digit=2","digit=1","digit=4","digit=2","digit=2","digit=1","digit=6","digit=2","digit=9","digit=6","digit=8","digit=1","digit=1","digit=6","digit=8","digit=8","digit=6","digit=6","digit=4","digit=9","digit=4","digit=5","digit=4","digit=8","digit=4","digit=2","digit=8","digit=5","digit=9","digit=0","digit=2","digit=9","digit=3","digit=7","digit=1","digit=3","digit=6","digit=6","digit=2","digit=5","digit=4","digit=9","digit=7","digit=6","digit=0","digit=6","digit=3","digit=7","digit=7","digit=0","digit=6","digit=8","digit=1","digit=8","digit=3","digit=2","digit=8","digit=8","digit=4","digit=7","digit=2","digit=8","digit=3","digit=5","digit=5","digit=5","digit=4","digit=5","digit=2","digit=6","digit=7","digit=2","digit=1","digit=5","digit=4","digit=9","digit=8","digit=8","digit=0","digit=7","digit=5","digit=9","digit=6","digit=2","digit=1","digit=3","digit=7","digit=8","digit=1","digit=5","digit=1","digit=5","digit=8","digit=2","digit=6","digit=9","digit=4","digit=2","digit=8","digit=7","digit=0","digit=2","digit=5","digit=9","digit=2","digit=4","digit=2","digit=4","digit=3","digit=9","digit=9","digit=4","digit=3","digit=2","digit=0","digit=1","digit=9","digit=3","digit=7","digit=0","digit=0","digit=9","digit=9","digit=3","digit=3","digit=0","digit=2","digit=3","digit=8","digit=5","digit=9","digit=8","digit=7","digit=8","digit=4","digit=7","digit=3","digit=8","digit=7","digit=7","digit=7","digit=3","digit=7","digit=3","digit=2","digit=2","digit=7","digit=4","digit=7","digit=3","digit=6","digit=0","digit=6","digit=0","digit=3","digit=3","digit=6","digit=7","digit=5","digit=8","digit=1","digit=8","digit=5","digit=6","digit=0","digit=2","digit=8","digit=7","digit=8","digit=2","digit=9","digit=9","digit=6","digit=8","digit=6","digit=2","digit=0","digit=5","digit=2","digit=8","digit=3","digit=6","digit=1","digit=7","digit=6","digit=4","digit=3","digit=1","digit=0","digit=8","digit=6","digit=8","digit=9","digit=2","digit=2","digit=7","digit=0","digit=6","digit=4","digit=6","digit=4","digit=4","digit=1","digit=9","digit=8","digit=1","digit=9","digit=0","digit=5","digit=1","digit=6","digit=6","digit=2","digit=7","digit=8","digit=3","digit=9","digit=6","digit=2","digit=4","digit=6","digit=1","digit=9","digit=5","digit=6","digit=7","digit=0","digit=6","digit=4","digit=3","digit=3","digit=7","digit=9","digit=0","digit=3","digit=9","digit=7","digit=7","digit=7","digit=1","digit=4","digit=4","digit=6","digit=8","digit=4","digit=1","digit=8","digit=7","digit=1","digit=9","digit=4","digit=7","digit=1","digit=1","digit=1","digit=6","digit=3","digit=4","digit=9","digit=2","digit=3","digit=8","digit=6","digit=4","digit=5","digit=4","digit=2","digit=9","digit=1","digit=6","digit=8","digit=9","digit=8","digit=4","digit=2","digit=6","digit=4","digit=9","digit=4","digit=6","digit=7","digit=2","digit=1","digit=5","digit=4","digit=5","digit=9","digit=7","digit=0","digit=9","digit=9","digit=0","digit=5","digit=1","digit=0","digit=0","digit=0","digit=6","digit=5","digit=9","digit=2","digit=2","digit=8","digit=7","digit=6","digit=3","digit=9","digit=9","digit=1","digit=6","digit=2","digit=8","digit=4","digit=8","digit=6","digit=2","digit=1","digit=2","digit=2","digit=0","digit=9","digit=1","digit=3","digit=0","digit=7","digit=8","digit=0","digit=0","digit=9","digit=9","digit=6","digit=2","digit=3","digit=4","digit=2","digit=8","digit=7","digit=9","digit=1","digit=6","digit=4","digit=3","digit=6","digit=9","digit=6","digit=8","digit=5","digit=5","digit=5","digit=5","digit=6","digit=6","digit=3","digit=5","digit=6","digit=3","digit=0","digit=7","digit=6","digit=1","digit=3","digit=8","digit=4","digit=2","digit=6","digit=0","digit=8","digit=6","digit=2","digit=7","digit=7","digit=2","digit=2","digit=3","digit=8","digit=5","digit=3","digit=7","digit=6","digit=9","digit=7","digit=8","digit=0","digit=7","digit=9","digit=7","digit=0","digit=7","digit=1","digit=0","digit=7","digit=9","digit=0","digit=3","digit=2","digit=9","digit=9","digit=0","digit=4","digit=7","digit=3","digit=0","digit=1","digit=8","digit=0","digit=8","digit=0","digit=8","digit=1","digit=4","digit=2","digit=1","digit=1","digit=1","digit=7","digit=5","digit=3","digit=2","digit=0","digit=7","digit=1","digit=0","digit=6","digit=0","digit=4","digit=8","digit=8","digit=5","digit=1","digit=3","digit=7","digit=6","digit=0","digit=5","digit=0","digit=1","digit=0","digit=8","digit=9","digit=4","digit=7","digit=0","digit=3","digit=2","digit=6","digit=5","digit=1","digit=4","digit=9","digit=1","digit=0","digit=0","digit=6","digit=1","digit=7","digit=4","digit=9","digit=7","digit=2","digit=6","digit=9","digit=1","digit=1","digit=8","digit=4","digit=2","digit=9","digit=9","digit=0","digit=4","digit=6","digit=1","digit=2","digit=2","digit=3","digit=0","digit=3","digit=6","digit=2","digit=5","digit=3","digit=6","digit=9","digit=9","digit=0","digit=1","digit=8","digit=5","digit=6","digit=5","digit=2","digit=0","digit=0","digit=2","digit=6","digit=4","digit=7","digit=2","digit=9","digit=1","digit=6","digit=3","digit=7","digit=3","digit=4","digit=0","digit=0","digit=1","digit=4","digit=6","digit=6","digit=0","digit=1","digit=5","digit=1","digit=5","digit=5","digit=0","digit=9","digit=7","digit=7","digit=1","digit=6","digit=4","digit=7","digit=9","digit=1","digit=1","digit=0","digit=3","digit=5","digit=2","digit=9","digit=6","digit=6","digit=4","digit=4","digit=3","digit=1","digit=3","digit=3","digit=5","digit=6","digit=4","digit=9","digit=7","digit=1","digit=2","digit=0","digit=2","digit=1","digit=6","digit=0","digit=3","digit=9","digit=0","digit=4","digit=0","digit=1","digit=6","digit=0","digit=7","digit=9","digit=1","digit=4","digit=0","digit=2","digit=3","digit=0","digit=8","digit=4","digit=8","digit=4","digit=7","digit=2","digit=2","digit=1","digit=1","digit=6","digit=7","digit=6","digit=6","digit=6","digit=8","digit=8","digit=0","digit=5","digit=9","digit=1","digit=3","digit=8","digit=0","digit=8","digit=2","digit=6","digit=8","digit=9","digit=8","digit=0","digit=5","digit=9","digit=3","digit=5","digit=8","digit=5","digit=2","digit=4","digit=1","digit=2","digit=8","digit=0","digit=7","digit=8","digit=4","digit=6","digit=4","digit=6","digit=7","digit=4","digit=1","digit=8","digit=1","digit=1","digit=5","digit=2","digit=3","digit=7","digit=0","digit=0","digit=1","digit=2","digit=2","digit=9","digit=4","digit=2","digit=0","digit=0","digit=1","digit=8","digit=7","digit=7","digit=0","digit=8","digit=9","digit=3","digit=8","digit=8","digit=8","digit=5","digit=6","digit=3","digit=7","digit=1","digit=3","digit=9","digit=9","digit=2","digit=2","digit=8","digit=0","digit=3","digit=4","digit=7","digit=1","digit=2","digit=0","digit=8","digit=6","digit=7","digit=1","digit=1","digit=0","digit=5","digit=2","digit=8","digit=2","digit=0","digit=2","digit=6","digit=0","digit=2","digit=4","digit=1","digit=0","digit=3","digit=4","digit=0","digit=8","digit=8","digit=7","digit=1","digit=2","digit=4","digit=0","digit=0","digit=7","digit=9","digit=1","digit=2","digit=8","digit=4","digit=9","digit=8","digit=6","digit=7","digit=5","digit=3","digit=0","digit=9","digit=2","digit=9","digit=4","digit=1","digit=8","digit=7","digit=7","digit=1","digit=1","digit=2","digit=3","digit=4","digit=7","digit=4","digit=2","digit=8","digit=2","digit=3","digit=8","digit=9","digit=0","digit=9","digit=0","digit=9","digit=8","digit=6","digit=9","digit=5","digit=1","digit=5","digit=8","digit=9","digit=9","digit=9","digit=8","digit=2","digit=2","digit=2","digit=2","digit=9","digit=3","digit=5","digit=3","digit=7","digit=0","digit=5","digit=7","digit=5","digit=0","digit=7","digit=3","digit=4","digit=6","digit=6","digit=5","digit=3","digit=3","digit=8","digit=3","digit=0","digit=2","digit=6","digit=4","digit=4","digit=0","digit=6","digit=1","digit=3","digit=6","digit=1","digit=7","digit=3","digit=5","digit=0","digit=8","digit=8","digit=1","digit=4","digit=2","digit=3","digit=3","digit=1","digit=5","digit=8","digit=6","digit=9","digit=7","digit=7","digit=3","digit=7","digit=1","digit=1","digit=4","digit=6","digit=7","digit=0","digit=7","digit=2","digit=2","digit=1","digit=3","digit=1","digit=1","digit=7","digit=4","digit=6","digit=9","digit=3","digit=4","digit=1","digit=0","digit=2","digit=2","digit=7","digit=8","digit=6","digit=4","digit=6","digit=2","digit=9","digit=7","digit=7","digit=1","digit=2","digit=7","digit=2","digit=1","digit=6","digit=5","digit=5","digit=2","digit=1","digit=9","digit=1","digit=5","digit=2","digit=3","digit=2","digit=2","digit=8","digit=7","digit=5","digit=8","digit=8","digit=8","digit=7","digit=3","digit=7","digit=1","digit=9","digit=8","digit=7","digit=1","digit=9","digit=9","digit=9","digit=1","digit=8","digit=0","digit=7","digit=7","digit=2","digit=7","digit=1","digit=4","digit=1","digit=4","digit=6","digit=2","digit=7","digit=2","digit=8","digit=2","digit=7","digit=9","digit=8","digit=7","digit=2","digit=4","digit=1","digit=8","digit=2","digit=1","digit=5","digit=2","digit=7","digit=4","digit=0","digit=4","digit=4","digit=2","digit=2","digit=6","digit=3","digit=2","digit=7","digit=9","digit=6","digit=8","digit=2","digit=9","digit=6","digit=8","digit=2","digit=2","digit=3","digit=4","digit=9","digit=1","digit=0","digit=6","digit=9","digit=3","digit=2","digit=0","digit=7","digit=2","digit=0","digit=0","digit=0","digit=0","digit=2","digit=5","digit=5","digit=5","digit=4","digit=1","digit=9","digit=9","digit=2","digit=6","digit=4","digit=8","digit=0","digit=9","digit=2","digit=4","digit=1","digit=8","digit=7","digit=8","digit=7","digit=9","digit=1","digit=0","digit=8","digit=6","digit=6","digit=6","digit=3","digit=4","digit=0","digit=8","digit=0","digit=6","digit=6","digit=1","digit=1","digit=3","digit=9","digit=4","digit=1","digit=5","digit=7","digit=2","digit=1","digit=2","digit=9","digit=9","digit=7","digit=5","digit=4","digit=4","digit=1","digit=2","digit=1","digit=0","digit=3","digit=1","digit=4","digit=2","digit=3","digit=0","digit=4","digit=4","digit=0","digit=6","digit=4","digit=5","digit=6","digit=0","digit=4","digit=7","digit=4","digit=3","digit=3","digit=1","digit=5","digit=1","digit=1","digit=0","digit=8","digit=4","digit=9","digit=1","digit=4","digit=0","digit=1","digit=7","digit=9","digit=3","digit=1","digit=4","digit=4","digit=7","digit=7","digit=6","digit=9","digit=4","digit=7","digit=2","digit=5","digit=9","digit=4","digit=7","digit=9","digit=0","digit=9","digit=5","digit=7","digit=6","digit=1","digit=0","digit=4","digit=8","digit=6","digit=7","digit=7","digit=6","digit=4","digit=7","digit=5","digit=8","digit=7","digit=8","digit=9","digit=8","digit=2","digit=9","digit=2","digit=2","digit=3","digit=8","digit=3","digit=6","digit=9","digit=6","digit=9","digit=7","digit=9","digit=5","digit=4","digit=1","digit=5","digit=4","digit=3","digit=5","digit=3","digit=6","digit=2","digit=1","digit=4","digit=7","digit=0","digit=7","digit=4","digit=0","digit=5","digit=2","digit=3","digit=6","digit=4","digit=2","digit=5","digit=1","digit=5","digit=3","digit=7","digit=8","digit=3","digit=6","digit=2","digit=9","digit=0","digit=3","digit=3","digit=2","digit=9","digit=3","digit=9","digit=5","digit=1","digit=4","digit=7","digit=2","digit=6","digit=1","digit=3","digit=8","digit=9","digit=9","digit=8","digit=6","digit=6","digit=7","digit=4","digit=8","digit=4","digit=2","digit=7","digit=8","digit=0","digit=4","digit=1","digit=4","digit=9","digit=9","digit=0","digit=5","digit=4","digit=4","digit=0","digit=6","digit=2","digit=2","digit=2","digit=2","digit=3","digit=3","digit=2","digit=1","digit=4","digit=2","digit=8","digit=9","digit=7","digit=4","digit=7","digit=4","digit=3","digit=9","digit=1","digit=6","digit=8","digit=8","digit=4","digit=7","digit=9","digit=3","digit=1","digit=1","digit=8","digit=8","digit=9","digit=9","digit=4","digit=6","digit=9","digit=7","digit=6","digit=8","digit=9","digit=2","digit=4","digit=4","digit=2","digit=3","digit=5","digit=5","digit=3","digit=8","digit=8","digit=5","digit=4","digit=2","digit=6","digit=3","digit=0","digit=7","digit=3","digit=7","digit=3","digit=3","digit=1","digit=8","digit=3","digit=4","digit=3","digit=6","digit=6","digit=4","digit=8","digit=8","digit=7","digit=2","digit=8","digit=7","digit=8","digit=4","digit=7","digit=7","digit=5","digit=1","digit=6","digit=5","digit=5","digit=6","digit=7","digit=1","digit=9","digit=2","digit=9","digit=9","digit=4","digit=3","digit=0","digit=3","digit=9","digit=3","digit=3","digit=9","digit=9","digit=8","digit=2","digit=4","digit=9","digit=0","digit=4","digit=1","digit=6","digit=8","digit=6","digit=6","digit=3","digit=1","digit=7","digit=0","digit=2","digit=1","digit=4","digit=4","digit=7","digit=1","digit=2","digit=9","digit=1","digit=0","digit=7","digit=5","digit=5","digit=8","digit=5","digit=4","digit=2","digit=6","digit=3","digit=3","digit=4","digit=7","digit=2","digit=3","digit=5","digit=1","digit=0","digit=1","digit=9","digit=0","digit=7","digit=7","digit=7","digit=8","digit=7","digit=5","digit=2","digit=1","digit=7","digit=2","digit=6","digit=0","digit=3","digit=7","digit=9","digit=5","digit=2","digit=3","digit=7","digit=4","digit=5","digit=7","digit=1","digit=6","digit=7","digit=5","digit=9","digit=3","digit=2","digit=6","digit=8","digit=5","digit=1","digit=5","digit=2","digit=6","digit=8","digit=1","digit=7","digit=2","digit=1","digit=4","digit=3","digit=8","digit=2","digit=4","digit=0","digit=8","digit=5","digit=6","digit=7","digit=3","digit=6","digit=6","digit=8","digit=0","digit=8","digit=8","digit=1","digit=0","digit=6","digit=5","digit=3","digit=5","digit=4","digit=3","digit=7","digit=4","digit=9","digit=4","digit=8","digit=2","digit=3","digit=3","digit=6","digit=4","digit=4","digit=3","digit=1","digit=0","digit=8","digit=0","digit=6","digit=9","digit=8","digit=8","digit=1","digit=3","digit=8","digit=7","digit=1","digit=3","digit=3","digit=6","digit=4","digit=9","digit=6","digit=4","digit=5","digit=9","digit=6","digit=6","digit=8","digit=3","digit=9","digit=8","digit=2","digit=9","digit=2","digit=7","digit=9","digit=2","digit=2","digit=0","digit=4","digit=1","digit=4","digit=9","digit=3","digit=9","digit=2","digit=7","digit=1","digit=9","digit=3","digit=8","digit=4","digit=6","digit=3","digit=8","digit=8","digit=9","digit=6","digit=4","digit=2","digit=7","digit=7","digit=6","digit=0","digit=7","digit=7","digit=7","digit=9","digit=7","digit=7","digit=2","digit=9","digit=6","digit=0","digit=9","digit=5","digit=6","digit=3","digit=5","digit=0","digit=4","digit=1","digit=6","digit=8","digit=9","digit=3","digit=1","digit=5","digit=3","digit=5","digit=6","digit=8","digit=5","digit=2","digit=1","digit=0","digit=9","digit=6","digit=9","digit=9","digit=8","digit=0","digit=3","digit=8","digit=4","digit=9","digit=7","digit=0","digit=9","digit=0","digit=3","digit=9","digit=1","digit=0","digit=8","digit=9","digit=9","digit=0","digit=0","digit=6","digit=8","digit=4","digit=5","digit=7","digit=3","digit=0","digit=2","digit=9","digit=0","digit=5","digit=4","digit=9","digit=7","digit=2","digit=4","digit=7","digit=6","digit=5","digit=1","digit=2","digit=5","digit=5","digit=7","digit=6","digit=0"],"x":[4.185496807098389,3.5257723331451416,4.539095401763916,4.024482250213623,1.9042863845825195,0.3495570719242096,1.6885180473327637,-0.8284304738044739,2.619547128677368,4.426419734954834,1.1959619522094727,4.154707431793213,3.0599398612976074,2.9622154235839844,1.342446208000183,6.274746894836426,3.9277946949005127,2.3226749897003174,-0.2425544708967209,2.3118467330932617,2.590155601501465,0.38145124912261963,5.507369518280029,2.9053664207458496,10.097611427307129,2.691701650619507,4.974223613739014,-0.7950170636177063,-0.9972132444381714,3.2994818687438965,3.2906508445739746,1.3313862085342407,2.3419487476348877,3.996612310409546,1.0327918529510498,7.548380374908447,2.3173716068267822,3.00313663482666,1.575096607208252,-0.908308207988739,3.5323472023010254,1.084589958190918,1.9523566961288452,4.518070220947266,2.578892469406128,2.5758934020996094,4.250445365905762,1.6099579334259033,2.949317455291748,4.555503845214844,4.004704475402832,8.404191017150879,1.0614601373672485,5.270586967468262,2.3685996532440186,2.1674728393554688,2.102351665496826,2.5065064430236816,3.5833017826080322,-0.32340630888938904,2.2373318672180176,9.042180061340332,2.7860841751098633,4.109806060791016,3.589668035507202,1.3013204336166382,5.213534355163574,1.9994364976882935,7.189579486846924,3.811777114868164,3.708756923675537,6.976654052734375,-0.43136709928512573,2.2132086753845215,1.170586109161377,2.3795852661132812,2.0604262351989746,3.2271595001220703,5.62232780456543,4.152184963226318,1.4919037818908691,3.0915355682373047,2.051832675933838,0.7820175886154175,4.843898296356201,1.033149242401123,0.5259256958961487,4.0529937744140625,-0.029177222400903702,3.105525016784668,3.0743143558502197,3.4073429107666016,1.1362859010696411,1.0893542766571045,-0.17069698870182037,-0.6006360054016113,1.706135869026184,0.4634566605091095,1.0405426025390625,4.023223876953125,4.011826038360596,3.310847520828247,6.408966541290283,4.787272930145264,-0.8226418495178223,0.9182928204536438,2.332737684249878,-0.6539502739906311,-0.8846698999404907,3.5424046516418457,2.9112460613250732,1.9871783256530762,1.332109808921814,0.6588886380195618,4.019392967224121,3.0276706218719482,5.084837913513184,3.104545831680298,7.273074626922607,3.1434271335601807,-0.26743102073669434,1.5438284873962402,1.1790605783462524,3.119356632232666,2.4914050102233887,6.291205406188965,1.9057320356369019,1.1766808032989502,2.8238606452941895,2.572357416152954,9.952681541442871,9.749216079711914,3.0244874954223633,2.5372793674468994,4.940457820892334,0.945839524269104,5.16730260848999,-0.380499005317688,0.3712742030620575,3.3299343585968018,3.4406938552856445,3.589341878890991,1.3575947284698486,2.628591299057007,3.0618021488189697,1.520036220550537,0.690886378288269,4.19816255569458,2.880073070526123,1.0395166873931885,2.6430904865264893,5.458520412445068,2.0088696479797363,-0.034990161657333374,1.1297742128372192,3.6069176197052,1.1143962144851685,1.0848150253295898,2.970888614654541,3.425977945327759,-0.760964572429657,3.892540454864502,2.257344961166382,0.3234955668449402,1.929853916168213,4.166682720184326,0.046938925981521606,3.4747719764709473,2.8634204864501953,7.571458339691162,0.9107258319854736,2.271775722503662,1.1268049478530884,4.293935298919678,1.5168371200561523,3.867286443710327,2.9181385040283203,-0.6105635166168213,-0.4145534336566925,3.8146562576293945,1.9066054821014404,3.2566094398498535,2.511887788772583,-0.5593940615653992,1.488361120223999,-0.20945954322814941,2.368199348449707,-0.24454253911972046,0.08256405591964722,5.919731140136719,2.648792028427124,6.851353645324707,4.539100646972656,7.590871334075928,0.0020731138065457344,1.154800295829773,0.5408092141151428,6.5587334632873535,5.450460433959961,2.254580020904541,6.132246017456055,2.200469732284546,3.7981338500976562,2.4882662296295166,-0.8059067726135254,1.2500842809677124,8.909964561462402,2.6838433742523193,3.4068968296051025,3.4510116577148438,5.503840446472168,1.238169550895691,3.0011518001556396,4.224228858947754,-0.26401573419570923,2.1822309494018555,-0.33852139115333557,6.5049028396606445,5.301125526428223,-0.8494975566864014,-0.6664236187934875,1.7465157508850098,5.20131254196167,4.896295547485352,0.8284741044044495,4.582862854003906,2.349071741104126,4.389591693878174,3.193369150161743,-0.4651092290878296,3.914078712463379,-0.7067399621009827,-0.4782068431377411,0.3111318349838257,-0.17595206201076508,-0.9744061231613159,3.5619771480560303,5.578951835632324,2.634479284286499,1.749714732170105,7.09174919128418,3.3946962356567383,7.1627326011657715,3.099648952484131,6.050872802734375,3.984356164932251,2.801196575164795,0.5359105467796326,3.7609846591949463,5.72530460357666,3.4874069690704346,2.310084342956543,0.26267364621162415,-0.1015121266245842,1.507228136062622,1.5485892295837402,1.2901984453201294,3.4798028469085693,2.8471529483795166,11.546079635620117,2.1085474491119385,3.6646132469177246,8.814484596252441,1.4740747213363647,2.9397473335266113,2.497089147567749,1.653787612915039,7.014793872833252,3.2626898288726807,8.573196411132812,1.9502532482147217,1.5645644664764404,0.5236363410949707,-0.6909645795822144,0.03771422430872917,2.520293712615967,4.58544397354126,0.08141819387674332,4.847935199737549,3.123502731323242,3.212970018386841,4.6038641929626465,2.705979585647583,3.1259243488311768,5.019150733947754,-0.8414857387542725,4.2577009201049805,5.661007881164551,4.156792640686035,8.146430015563965,5.250307559967041,4.768901824951172,1.6183075904846191,2.8399479389190674,2.128530979156494,2.3381872177124023,3.1743643283843994,1.4407609701156616,1.6207773685455322,3.8352091312408447,3.6613054275512695,1.9060018062591553,2.2695388793945312,0.5537703633308411,2.990999460220337,2.9086549282073975,-0.8316674828529358,2.1368374824523926,-0.7462158203125,2.5478246212005615,4.515899658203125,3.4620144367218018,6.18389368057251,2.2724976539611816,8.94803524017334,-0.40314340591430664,7.7519989013671875,3.1266098022460938,1.9377937316894531,-0.3314153254032135,2.49777889251709,2.9853475093841553,4.029342174530029,1.5692102909088135,-0.7606702446937561,2.457796335220337,4.054876327514648,0.7204511165618896,2.9928715229034424,4.059894561767578,2.0158779621124268,1.245901107788086,5.752560615539551,-0.7834689617156982,2.2073841094970703,2.624842405319214,1.1524343490600586,1.8450943231582642,3.075870990753174,0.8436007499694824,-0.4061228632926941,4.888716220855713,6.06964111328125,2.314713716506958,2.325624465942383,3.562013626098633,4.585832118988037,3.8454668521881104,1.9495065212249756,8.349851608276367,4.950174808502197,6.961996555328369,3.5192067623138428,2.289085626602173,7.091727256774902,-0.6634559631347656,-0.6661205291748047,1.1849864721298218,4.587648868560791,2.794525146484375,3.1918742656707764,5.534511089324951,0.17963817715644836,3.6411147117614746,2.7108101844787598,4.386199474334717,3.945131778717041,0.8331727981567383,1.5490374565124512,1.8663724660873413,4.0907182693481445,0.8671863675117493,-0.1981402039527893,5.624961853027344,4.665717601776123,4.83257532119751,1.8079389333724976,2.422006845474243,5.869863033294678,4.027769565582275,2.1963651180267334,6.431650638580322,1.2745639085769653,7.31889533996582,2.8195202350616455,0.07841379940509796,1.2326266765594482,0.7630504369735718,2.156972646713257,1.2265428304672241,4.736645698547363,4.1329450607299805,4.580386638641357,2.0970516204833984,-0.10757536441087723,0.8259899020195007,0.44186297059059143,4.559354305267334,5.473421096801758,4.940215110778809,4.922846794128418,1.112082600593567,2.064089775085449,7.472927570343018,5.473356246948242,4.411730766296387,-0.41004905104637146,1.154736876487732,2.169692277908325,4.376275539398193,2.8234403133392334,3.6989147663116455,5.315661907196045,5.682273864746094,-0.10853643715381622,2.7995004653930664,6.330076694488525,6.324780464172363,8.335854530334473,-0.7030444145202637,3.3173558712005615,3.0046887397766113,-0.7983439564704895,1.2708028554916382,2.607638120651245,5.763322830200195,6.190881729125977,2.7691810131073,1.8727375268936157,1.3562536239624023,5.718862533569336,7.0928215980529785,1.3129327297210693,4.910659313201904,3.8170812129974365,0.2033398300409317,6.196984767913818,1.7747876644134521,1.4229425191879272,8.390403747558594,2.526845932006836,2.0563082695007324,-0.7976968884468079,4.089280128479004,2.7121665477752686,1.2528642416000366,1.9197964668273926,1.6155301332473755,6.0785322189331055,4.251105308532715,2.1776578426361084,3.511021614074707,-0.7567449808120728,2.532205581665039,7.051905632019043,2.2619168758392334,0.3630705773830414,1.7343945503234863,8.954947471618652,3.1357688903808594,1.281579613685608,6.481790542602539,3.0220556259155273,2.516953706741333,2.2077929973602295,3.7288577556610107,0.3188874423503876,3.946389675140381,1.5272326469421387,2.9024477005004883,4.810213565826416,3.6988110542297363,1.0416295528411865,0.8617712259292603,6.876935958862305,3.660322427749634,3.8041880130767822,6.520570278167725,0.19844193756580353,4.748692512512207,3.905494451522827,1.6892199516296387,1.4709138870239258,1.8948383331298828,5.353107452392578,4.3900957107543945,5.054354667663574,5.508306503295898,1.976069450378418,2.1242477893829346,4.568602085113525,0.12823909521102905,6.099273681640625,0.9690943956375122,1.4263843297958374,2.356759548187256,0.1564304530620575,3.450552463531494,1.6735923290252686,0.25347331166267395,-0.551649272441864,1.7820942401885986,4.49777364730835,7.582096576690674,1.0499006509780884,1.707631230354309,-0.4627464711666107,4.220330715179443,6.056252479553223,3.036895990371704,3.851625919342041,-0.18779461085796356,1.3797258138656616,3.7718043327331543,4.198177814483643,2.478456974029541,9.395386695861816,6.087273597717285,3.709186315536499,0.5703359842300415,4.860293388366699,0.6386578679084778,1.9510087966918945,2.7895002365112305,-0.7054330706596375,4.206992149353027,1.6615469455718994,0.8987525105476379,1.7420984506607056,3.511348247528076,1.38615083694458,8.280430793762207,4.658801078796387,2.007091999053955,-0.21629568934440613,1.4978693723678589,5.524645805358887,5.418025493621826,2.542188882827759,1.3050001859664917,3.814495801925659,4.5763373374938965,4.747477054595947,2.6526684761047363,-0.8158122301101685,1.7131199836730957,2.161384344100952,0.6125808954238892,4.628256320953369,6.154385089874268,2.7830970287323,0.7597267031669617,3.103956460952759,4.612459659576416,1.0235216617584229,6.261486530303955,2.1709861755371094,2.7097153663635254,3.7110655307769775,1.1660828590393066,-0.6112880706787109,2.441593885421753,3.503324508666992,5.2662177085876465,1.0439815521240234,6.544642925262451,2.528489351272583,2.3514041900634766,3.580514907836914,2.5481691360473633,2.9635307788848877,1.496263027191162,1.040583848953247,2.2593443393707275,3.987800121307373,2.37367582321167,3.336500644683838,-1.0153415203094482,5.101935386657715,2.111870288848877,2.086120128631592,2.463888645172119,5.963381290435791,3.0494141578674316,1.7460858821868896,4.312749862670898,7.843402862548828,5.0780839920043945,1.8415906429290771,1.657577395439148,1.0543673038482666,6.709234714508057,-0.18650180101394653,2.813783645629883,2.8864028453826904,2.737882137298584,1.729588270187378,-0.5609152317047119,3.950664520263672,1.972654938697815,4.471571445465088,10.466924667358398,2.3503150939941406,1.7326321601867676,2.1565375328063965,7.475964069366455,0.5520503520965576,3.7945029735565186,0.0960264727473259,-0.4019433259963989,3.942692756652832,2.094543695449829,2.083526849746704,5.847743511199951,1.3968206644058228,-0.6574351787567139,8.44637680053711,3.4801461696624756,3.000044107437134,5.110044002532959,-0.42972317337989807,4.9677910804748535,2.7160329818725586,4.298781871795654,5.641793727874756,3.161203622817993,3.29046630859375,1.9883745908737183,3.7329623699188232,1.461130976676941,8.737088203430176,0.3923794627189636,-0.6851397156715393,2.4081554412841797,2.198554039001465,2.68515682220459,6.804619789123535,1.20827317237854,3.7196767330169678,0.4928126931190491,1.5160859823226929,1.1423633098602295,2.0142765045166016,-0.9597069025039673,4.082870960235596,3.2277138233184814,5.8323869705200195,5.041205406188965,4.325188159942627,1.0497263669967651,0.17397160828113556,3.3300259113311768,6.095506191253662,4.062386989593506,3.567589521408081,4.629077434539795,2.7571535110473633,0.8196156620979309,3.8128609657287598,7.366367340087891,5.123673915863037,1.2070084810256958,-0.10706420987844467,1.5423349142074585,3.1278979778289795,5.494920253753662,-0.8029855489730835,4.780824661254883,4.746135711669922,2.21490740776062,3.9219114780426025,2.3490891456604004,8.733344078063965,0.743427038192749,3.19356632232666,2.8967905044555664,-0.10251160711050034,2.7336363792419434,2.3337879180908203,2.974501371383667,3.3331243991851807,4.336087226867676,1.8749114274978638,1.5896388292312622,2.2310211658477783,1.5647722482681274,2.0369434356689453,3.269066333770752,3.4699642658233643,6.201448917388916,3.723249912261963,6.009416580200195,3.9449126720428467,1.0634409189224243,1.5267235040664673,9.011564254760742,7.699619293212891,3.6824567317962646,3.9709348678588867,4.0534987449646,4.987458229064941,8.80839729309082,-0.37643963098526,5.986017227172852,4.125107765197754,1.7693718671798706,1.0179989337921143,2.4780092239379883,0.00720358919352293,4.157562255859375,1.5233895778656006,3.090071678161621,3.1621034145355225,1.4640976190567017,2.780344009399414,1.7194346189498901,9.109463691711426,7.135664463043213,9.773538589477539,2.4230337142944336,4.964533805847168,-0.09419114142656326,4.196863651275635,2.621474504470825,3.0763816833496094,3.502876043319702,2.359584093093872,3.172985792160034,2.206115961074829,0.6463881134986877,1.7272453308105469,-0.7468562722206116,2.881629228591919,2.0976343154907227,5.459174633026123,-0.07685516774654388,1.4121750593185425,-0.36374786496162415,-0.7762919664382935,1.6708548069000244,1.6773638725280762,5.03240442276001,6.063594341278076,-0.6447046995162964,1.664656400680542,1.7159847021102905,3.6704792976379395,2.1834654808044434,9.663970947265625,1.8275315761566162,3.498020887374878,-0.7249669432640076,2.14766001701355,0.2505883276462555,5.089741230010986,4.485634803771973,1.8675121068954468,0.22176198661327362,4.521286964416504,4.520069122314453,4.53318977355957,2.9550938606262207,3.909658193588257,3.5003392696380615,2.7023863792419434,1.1762502193450928,-0.6818417310714722,4.360742568969727,4.296072483062744,2.286283493041992,1.4440739154815674,2.6373040676116943,6.217404842376709,1.6881814002990723,4.679324626922607,2.513108015060425,0.9727529287338257,1.9123705625534058,1.1353676319122314,2.143535852432251,2.062640905380249,0.19086386263370514,0.9580541849136353,-0.5924659371376038,3.1215600967407227,0.8472529053688049,1.5211749076843262,9.613414764404297,1.7756483554840088,1.6802681684494019,1.8961708545684814,3.397418260574341,-0.34102362394332886,0.003925289958715439,3.6278903484344482,2.1948704719543457,1.2775075435638428,2.63372802734375,5.17059850692749,0.984890878200531,3.1811788082122803,3.294367790222168,5.445948600769043,2.917248249053955,-0.684952437877655,5.046571254730225,0.3313170075416565,0.5090720653533936,1.1599076986312866,4.574770450592041,4.9914679527282715,3.9693949222564697,0.0075803822837769985,4.199219703674316,-0.11476308107376099,3.87960147857666,0.42087826132774353,4.178076267242432,-0.3456346392631531,3.4680395126342773,4.706650257110596,-0.12437602132558823,5.324127674102783,0.662540853023529,4.033639430999756,10.071395874023438,4.590361595153809,8.568866729736328,1.7768759727478027,1.0995607376098633,4.211747646331787,0.5183883309364319,3.2954323291778564,5.299011707305908,4.24098539352417,0.42865267395973206,2.232485771179199,6.099164009094238,5.9127516746521,3.570693016052246,-0.628237783908844,3.83544921875,6.40479040145874,0.9349969625473022,4.511528968811035,2.2944719791412354,0.6297755241394043,0.9746809005737305,2.3475282192230225,0.7408580780029297,1.4956247806549072,5.524820804595947,4.9652018547058105,4.968760967254639,0.7158095836639404,1.4459623098373413,5.038897514343262,5.79990816116333,3.2997899055480957,3.762472152709961,1.5805237293243408,2.5021162033081055,1.7928892374038696,5.543478012084961,6.053196907043457,3.210340976715088,1.029767394065857,4.265430450439453,3.322326898574829,2.9603230953216553,4.262223720550537,-0.6453543901443481,3.938217878341675,1.657291293144226,0.9862412214279175,2.4853508472442627,1.3697540760040283,5.788510799407959,1.9132555723190308,2.3640761375427246,4.811229228973389,5.297214031219482,2.936555862426758,6.999470233917236,5.800116062164307,0.41078707575798035,-0.3752361834049225,3.3549985885620117,2.437560796737671,9.681085586547852,4.090441703796387,4.583430290222168,1.8230955600738525,2.8077986240386963,2.29533314704895,0.9769928455352783,0.9535361528396606,1.9965635538101196,3.4298903942108154,3.2385141849517822,1.0023677349090576,3.307220697402954,5.21043062210083,6.6682047843933105,2.550579786300659,2.9168813228607178,4.283854007720947,3.2068655490875244,5.837075710296631,4.9654693603515625,2.968273401260376,-0.7739687561988831,1.7288702726364136,-0.6103154420852661,1.2456071376800537,1.620828628540039,5.516615390777588,4.807842254638672,-0.6293467283248901,1.3807156085968018,4.653604030609131,1.0290085077285767,3.6506199836730957,3.771070718765259,3.8876001834869385,2.6411566734313965,4.814371585845947,3.721792697906494,3.597191572189331,4.215425491333008,1.3833979368209839,7.493431091308594,1.800611138343811,10.2377347946167,2.4889347553253174,4.672460079193115,3.207535982131958,4.167941093444824,3.409414291381836,1.3904979228973389,3.6012990474700928,4.097636699676514,1.6005815267562866,3.615795373916626,-0.7407376170158386,2.3130156993865967,5.040290355682373,0.590717613697052,2.124458074569702,2.917018175125122,5.993022918701172,3.2537548542022705,2.5157694816589355,2.421018600463867,6.749592304229736,3.3771378993988037,4.550955772399902,2.289799451828003,3.9832968711853027,5.599610805511475,1.703526258468628,1.724774718284607,2.5285274982452393,0.08277768641710281,1.8041107654571533,4.973285675048828,2.450507402420044,8.493814468383789,3.4849767684936523,8.328495025634766,9.086101531982422,3.246976852416992,4.392017841339111,3.658719301223755,3.606792449951172,5.68545389175415,8.06432056427002,2.905482292175293,9.546672821044922,-0.48847082257270813,0.5830779075622559,3.001462936401367,3.6306042671203613,3.8441567420959473,4.5348381996154785,3.682155132293701,3.2865841388702393,3.6641483306884766,-0.34900400042533875,2.0112383365631104,3.4345791339874268,-0.1481897234916687,2.5962605476379395,-0.6819611191749573,4.40308141708374,2.0977439880371094,0.5772523880004883,1.246025562286377,4.334875106811523,0.8219004273414612,-0.368058979511261,0.8349073529243469,4.351341724395752,3.8399319648742676,-0.7052832841873169,2.6221745014190674,4.594937324523926,3.2115285396575928,5.372692108154297,3.240760564804077,2.2331976890563965,1.5970828533172607,5.759608268737793,4.032322883605957,2.13356351852417,8.636102676391602,1.085614800453186,-0.549961268901825,4.095758438110352,1.669214129447937,2.027945041656494,1.5121278762817383,2.8830459117889404,2.1707706451416016,2.1814749240875244,8.353464126586914,1.5505340099334717,3.692854404449463,0.8748484253883362,1.246027946472168,-0.24879196286201477,6.264623165130615,1.2731093168258667,3.631556987762451,1.2073779106140137,0.2607389986515045,3.7672908306121826,1.2330472469329834,4.238917827606201,2.694000005722046,3.111067295074463,1.7927494049072266,4.238796234130859,6.379453182220459,1.483829140663147,1.4989160299301147,4.157942295074463,3.1948130130767822,2.5392909049987793,1.8821439743041992,6.4686279296875,2.4166059494018555,4.238305568695068,0.1879003942012787,4.036183834075928,2.237942695617676,8.973427772521973,2.608166217803955,3.781982183456421,-0.45790430903434753,3.5374433994293213,5.373334884643555,6.18561315536499,4.79742431640625,5.23917293548584,4.129044532775879,3.3502328395843506,10.144503593444824,3.2156779766082764,-0.7120758891105652,5.8169074058532715,-0.6355435252189636,0.3690279722213745,3.7955758571624756,3.6704061031341553,6.180647373199463,1.3089830875396729,2.6307880878448486,5.543410301208496,1.6655091047286987,3.228297710418701,0.8089330196380615,1.646703839302063,5.095462322235107,7.225042819976807,3.5563786029815674,0.5440043210983276,0.6213186383247375,1.4566925764083862,-0.42891377210617065,5.217886924743652,2.2223851680755615,1.6174380779266357,1.1314877271652222,2.1609747409820557,1.72816801071167,-0.20311808586120605,4.792403221130371,1.143678903579712,1.796057939529419,3.2335519790649414,4.601699352264404,6.579653739929199,4.204165458679199,1.7477349042892456,2.5041086673736572,1.0229272842407227,4.260062217712402,3.712564468383789,4.238179683685303,6.475375652313232,4.380405902862549,3.001204013824463,2.9192636013031006,2.1944057941436768,3.090256690979004,0.456005722284317,4.3231940269470215,3.6794064044952393,0.7509058713912964,1.3333390951156616,6.547119140625,0.8098549842834473,1.0010699033737183,3.988696336746216,0.9953142404556274,2.880868673324585,2.3228228092193604,0.7488930225372314,0.3178001642227173,-0.2742328643798828,2.933035135269165,3.231513738632202,1.1584419012069702,2.2638614177703857,4.712291240692139,3.7936012744903564,1.9976892471313477,5.293400287628174,4.8846306800842285,3.953564405441284,6.402626037597656,4.438218116760254,8.016593933105469,-0.42808520793914795,5.0239715576171875,0.02045103721320629,-0.022022368386387825,1.9282126426696777,4.40131950378418,1.8943226337432861,-0.5983465909957886,9.906983375549316,1.1268796920776367,6.029173374176025,2.695282220840454,1.5231387615203857,1.1083232164382935,0.8884482383728027,4.3024210929870605,3.9285247325897217,4.125003814697266,0.8059043884277344,1.8970623016357422,2.931497097015381,4.546306133270264,6.125469207763672,2.003659725189209,3.440594434738159,4.418970108032227,-0.251895546913147,10.260684967041016,5.979100704193115,2.906071662902832,2.424622058868408,-0.11788667738437653,3.1181342601776123,1.9941492080688477,7.323380947113037,4.702473163604736,2.5803966522216797,1.5386813879013062,2.164907932281494,0.76016765832901,7.732516765594482,3.6201858520507812,4.593889236450195,3.9334797859191895,2.665994644165039,-0.8248251080513,1.2114936113357544,-0.5964334011077881,0.38324111700057983,6.278374195098877,3.9185333251953125,4.3916730880737305,2.9893059730529785,-0.7450869679450989,1.161807894706726,3.296806573867798,8.04150104522705,1.2261525392532349,6.932546615600586,1.4588314294815063,4.1119303703308105,3.168931722640991,0.857708752155304,3.29295015335083,2.042931318283081,-0.6627444624900818,1.5024479627609253,6.1761088371276855,4.361729621887207,1.4729490280151367,3.4380204677581787,-0.4676867127418518,9.33061695098877,0.5495778918266296,3.6211442947387695,1.8204526901245117,1.7826378345489502,1.576050043106079,2.384068012237549,2.784794569015503,2.411979913711548,1.027359962463379,1.3028723001480103,3.134187698364258,-0.728184163570404,4.876576900482178,3.711653709411621,-0.13029292225837708,2.2481493949890137,2.8555006980895996,6.998079776763916,4.018033981323242,6.834569931030273,4.260521411895752,4.0856523513793945,-0.7195053696632385,-0.9625648856163025,7.020953178405762,1.9766420125961304,3.0954971313476562,2.1817450523376465,5.391181945800781,1.9748085737228394,3.7177722454071045,1.012148380279541,1.8174926042556763,5.823428153991699,1.114878535270691,3.020951271057129,1.9387885332107544,5.716460704803467,0.3161443769931793,3.613096237182617,2.3451383113861084,0.9771487712860107,2.7272889614105225,3.854881525039673,-0.5271047949790955,1.9214653968811035,3.9259419441223145,1.1980006694793701,0.9713992476463318,5.153530120849609,1.7020564079284668,1.4733505249023438,3.5935282707214355,3.285806894302368,7.162671089172363,2.152621030807495,3.4707248210906982,3.761366605758667,7.633077621459961,2.1645219326019287,-0.6387109160423279,1.8162002563476562,5.6329731941223145,1.3202062845230103,1.0085296630859375,7.634677410125732,2.306826591491699,2.8074498176574707,1.3886414766311646,1.87186861038208,3.1684558391571045,2.790253162384033,10.169363021850586,6.918554782867432,3.3626596927642822,-0.14285880327224731,1.8570284843444824,1.2916185855865479,1.958342432975769,2.2194738388061523,-0.7027512192726135,4.586562633514404,-0.21460309624671936,3.2409000396728516,0.18377353250980377,0.8911149501800537,2.839872360229492,2.735182046890259,3.1196529865264893,-0.7935550808906555,5.271056652069092,4.244470596313477,2.5407230854034424,3.503044605255127,9.514876365661621,3.423038959503174,2.184823513031006,2.5680387020111084,3.055068254470825,2.9761385917663574,7.438658237457275,4.067699432373047,2.8154451847076416,6.545722484588623,-0.02166023850440979,2.4401025772094727,1.5719397068023682,1.1987608671188354,3.448306083679199,0.6129834055900574,1.6117846965789795,5.8897528648376465,6.053871154785156,3.8292829990386963,3.390028238296509,2.349004030227661,-0.3555467426776886,4.66187858581543,3.41947603225708,11.850410461425781,-0.581005871295929,-0.020851055160164833,2.7075395584106445,2.1461117267608643,1.152016282081604,5.793166637420654,0.052487440407276154,2.087541103363037,3.5266754627227783,0.7977572083473206,2.0336878299713135,5.700827121734619,2.6968092918395996,1.3925998210906982,2.799553871154785,2.3576269149780273,1.7367609739303589,2.748333692550659,-0.5630233287811279,1.792860507965088,3.495678663253784,-0.2930688261985779,1.3345311880111694,-0.6484600305557251,0.9325112104415894,4.99241828918457,5.375295639038086,3.0216188430786133,4.148316860198975,-0.1325230896472931,1.6567634344100952,3.1981444358825684,3.4730474948883057,-0.04251966252923012,1.1676805019378662,1.1709363460540771,2.038973331451416,1.332512378692627,2.3292229175567627,-0.21066881716251373,3.888120412826538,2.093493938446045,-0.5101489424705505,1.1031981706619263,2.2420237064361572,3.7173993587493896,5.760347366333008,-0.5450271368026733,2.3162503242492676,1.1078665256500244,9.736947059631348,2.1357483863830566,-0.45786336064338684,1.8304498195648193,2.757401704788208,3.8219501972198486,4.817158222198486,3.114443778991699,3.755173921585083,2.0032434463500977,5.427750110626221,5.797913551330566,6.710782051086426,3.2178843021392822,2.7655558586120605,2.0275659561157227,4.711659908294678,5.900674343109131,3.2253000736236572,10.869210243225098,0.9390503764152527,3.499831438064575,-0.06321077048778534,3.836831569671631,7.287607192993164,0.8332257866859436,4.06812858581543,4.524137020111084,2.4894375801086426,2.3875646591186523,-0.1085321232676506,2.567953109741211,3.047328472137451,2.1677067279815674,4.788059711456299,-0.6180681586265564,1.3861632347106934,5.290870189666748,2.8591222763061523,2.9588117599487305,2.8376598358154297,-0.14802010357379913,3.4585072994232178,3.745673418045044,4.799585342407227,4.363744258880615,1.7945574522018433,4.122242450714111,2.6949803829193115,-0.38736051321029663,-0.9428648352622986,8.536184310913086,1.413001537322998,2.2715094089508057,-0.9640375375747681,5.867995262145996,5.50153112411499,3.834707498550415,2.718578577041626,1.371869683265686,0.14592483639717102,5.026863098144531,1.2788347005844116,2.0591793060302734,4.650784969329834,3.563627243041992,1.4270801544189453,4.7951788902282715,2.7415246963500977,4.5660624504089355,3.0273687839508057,7.213788032531738,-0.2700442969799042,3.2468111515045166,3.044187307357788,1.4133422374725342,5.471804618835449,1.8262574672698975,2.145653486251831,1.1512140035629272,-0.6295706033706665,2.5173563957214355,2.190481424331665,2.3682374954223633,0.2824278473854065,5.541010856628418,4.44059944152832,6.81116247177124,2.527134418487549,2.814422130584717,5.491997718811035,2.282829999923706,4.697836875915527,2.015432596206665,3.7414846420288086,-0.4171605110168457,0.02152765356004238,-0.768907368183136,3.999598741531372,4.93496561050415,3.4234354496002197,0.9076491594314575,1.7195971012115479,2.4714255332946777,4.501218318939209,2.9513466358184814,-0.5472055077552795,1.2910817861557007,6.538905620574951,2.1682679653167725,7.067477226257324,4.721434116363525,6.681948661804199,4.733262538909912,2.973834276199341,0.2726825177669525,2.4965856075286865,0.03552669659256935,8.64314079284668,1.927117109298706,5.2843122482299805,2.1660091876983643,1.5894566774368286,0.706718385219574,1.4466724395751953,2.462468385696411,0.12165578454732895,6.061367034912109,3.1824638843536377,-0.7885687947273254,8.090906143188477,4.20807409286499,3.126690626144409,2.284839153289795,2.752291679382324,0.6420318484306335,4.808370113372803,2.2227447032928467,4.3087382316589355,2.7704274654388428,3.2634775638580322,3.665347099304199,-0.5074801445007324,0.15415643155574799,1.9646047353744507,3.740227699279785,4.30255651473999,2.32920503616333,5.8065056800842285,2.6273369789123535,1.8760910034179688,2.747211217880249,3.6923532485961914,0.5474637150764465,1.4022098779678345,4.860982894897461,1.5231586694717407,4.689013957977295,5.336781024932861,3.4975428581237793,0.2718832492828369,3.406006336212158,1.3131352663040161,0.925236165523529,1.975368618965149,2.2811312675476074,1.0220295190811157,2.3519093990325928,0.3151741027832031,1.8544048070907593,4.255177974700928,4.253057956695557,4.028807163238525,4.658503532409668,2.5401995182037354,3.0999345779418945,-0.6980797648429871,1.9670603275299072,1.2068246603012085,2.2221672534942627,2.0577075481414795,3.006497621536255,1.6424264907836914,3.121199131011963,2.3276078701019287,1.828346848487854,1.7760437726974487,-0.7544828057289124,3.3886094093322754,1.526951789855957,2.4843616485595703,0.3537566363811493,8.129508018493652,7.130419731140137,3.361363410949707,4.303518772125244,2.2282187938690186,2.365985870361328,10.225663185119629,2.9193806648254395,4.431600093841553,1.020229458808899,2.796292781829834,6.064006328582764,5.546934604644775,0.2603261470794678,0.4875577986240387,4.4996490478515625,1.5961768627166748,2.7670934200286865,3.930152654647827,3.133354425430298,2.200545072555542,-0.3106795847415924,2.2694106101989746,4.354857921600342,-0.4944094717502594,3.9054312705993652,8.641695976257324,4.534071922302246,2.362215757369995,5.213864803314209,3.6852567195892334,5.639946460723877,0.09872771799564362,1.802547574043274,6.892138957977295,1.4525246620178223,4.030202865600586,0.5470547676086426,4.678068161010742,4.0295233726501465,3.5197174549102783,5.190555095672607,9.595183372497559,2.8227334022521973,1.3663043975830078,4.526773452758789,4.0643229484558105,2.639857769012451,0.9400723576545715,2.8732800483703613,4.948942184448242,0.949224054813385,4.0137858390808105,0.7769490480422974,1.6174707412719727,4.218206882476807,7.88020658493042,-0.7122202515602112,4.947976589202881,5.352699279785156,6.67936372756958,1.4259474277496338,7.4943013191223145,-0.6384455561637878,1.196195363998413,3.5812675952911377,1.959383249282837,2.8163974285125732,0.43660277128219604,2.1122725009918213,5.319548606872559,4.380580902099609,1.4372801780700684,-0.16692553460597992,4.748288631439209,3.0232861042022705,2.275550603866577,6.78081750869751,7.943685054779053,8.965787887573242,1.7968982458114624,1.5567848682403564,1.3821040391921997,4.539906024932861,1.9557864665985107,2.3203766345977783,1.6970515251159668,2.083124876022339,3.392998695373535,3.6608893871307373,0.22468775510787964,-0.6634436249732971,0.057430919259786606,2.756333827972412,2.0069198608398438,3.5511128902435303,5.654386520385742,-0.4152182638645172,1.7192282676696777,5.045614242553711,5.703969478607178,2.5269622802734375,0.7960555553436279,-0.4328805208206177,-0.0905858650803566,3.057857036590576,2.841444969177246,1.4438637495040894,1.7067623138427734,7.635156631469727,2.8594038486480713,3.159066677093506,1.9882383346557617,3.792259693145752,2.488912582397461,4.0680131912231445,5.687453746795654,6.198617458343506,1.693490982055664,4.360559463500977,3.190626621246338,3.7984373569488525,3.1264705657958984,1.5965057611465454,0.534224271774292,2.5966455936431885,1.8791804313659668,7.146142482757568,3.573549509048462,0.32812562584877014,2.420328140258789,4.899700164794922,0.887220561504364,1.1835713386535645,2.591435194015503,-0.5933772921562195,4.15846586227417,1.0384737253189087,3.9238827228546143,0.9549909234046936,1.1775931119918823,5.040711402893066,-0.6425588130950928,0.7973860502243042,8.893109321594238,4.6529316902160645,0.17288215458393097,3.5481181144714355,3.954684257507324,2.2268407344818115,2.8572568893432617,1.7473326921463013,8.752049446105957,5.900573253631592,7.550865650177002,3.1515660285949707,5.469662666320801,2.0609474182128906,3.665316343307495,-0.6890222430229187,1.3419089317321777,3.602825880050659,-0.5915570855140686,5.383869647979736,2.567478895187378,5.2596917152404785,5.084560871124268,3.911938428878784,-0.7413181662559509,4.621110439300537,4.154886245727539,2.7214252948760986,2.127467155456543,3.8146421909332275,2.388094425201416,10.876713752746582,5.76658296585083,0.4989035427570343,5.900761604309082,0.9997037053108215,2.5858473777770996,7.821115970611572,0.7098133563995361,3.749756097793579,1.5760481357574463,2.4106078147888184,2.1239044666290283,0.40980246663093567,4.018857002258301,5.276097297668457,6.802458763122559,5.753407955169678,3.9731595516204834,0.009216168895363808,4.977930545806885,1.2765836715698242,-0.7413468956947327,-0.2902447581291199,4.53468656539917,3.084247589111328,3.208573579788208,1.962105631828308,8.885858535766602,4.463951587677002,3.009148120880127,3.8513712882995605,4.849161624908447,3.131969928741455,1.511470913887024,-0.8366922736167908,5.084838390350342,6.303058624267578,2.8010823726654053,4.512276649475098,3.705700635910034,3.062948226928711,0.28976768255233765,2.7737202644348145,4.3290324211120605,4.562453746795654,4.333276748657227,2.3737633228302,4.1313157081604,1.3747117519378662,2.915375232696533,1.887367606163025,2.9790542125701904,-0.7870752811431885,0.5780701637268066,2.4857795238494873,3.305453062057495,3.3725240230560303,-0.43830806016921997,4.215570449829102,4.379175186157227,-0.7858856916427612,3.613987922668457,1.644938588142395,2.2285778522491455,4.036905765533447,2.529623508453369,4.561403751373291,0.7102210521697998,6.240156650543213,3.11920428276062,6.705078125,2.1768417358398438,2.0660934448242188,2.5412139892578125,0.8127164840698242,-0.7592385411262512,3.176752805709839,3.46209979057312,0.6165220737457275,2.8415675163269043,1.413769245147705,3.464400291442871,1.1546051502227783,4.89202880859375,1.512439489364624,3.6427767276763916,4.218417167663574,4.467597484588623,4.279825210571289,2.9609220027923584,3.4578521251678467,2.0617873668670654,1.1208481788635254,0.7938121557235718,2.2829034328460693,4.045008182525635,2.06730055809021,3.1894917488098145,-0.6253311038017273,2.194139242172241,0.040682051330804825,6.1652445793151855,3.005446195602417,1.1804604530334473,6.62406587600708,-0.9988563060760498,2.194242000579834,2.147214889526367,7.3492960929870605,1.241197943687439,6.6491379737854,3.105318784713745,1.53769052028656,3.829216480255127,0.8808238506317139,1.2856396436691284,5.898334980010986,3.6391308307647705,5.251539707183838,3.986391544342041,-0.45070207118988037,7.733131408691406,0.8391907811164856,1.9848166704177856,4.627553939819336,0.0851421132683754,2.800194501876831,2.16729736328125,4.668759822845459,1.154589056968689,5.348191738128662,0.2664562165737152,2.798560619354248,3.0959339141845703,2.7210865020751953,8.590764999389648,-0.6125656366348267,1.3325226306915283,6.941086769104004,4.281155109405518,0.14394046366214752,4.605497360229492,4.828318119049072,2.8004844188690186,3.5206258296966553,-0.11784633994102478,2.2684473991394043,4.451992988586426,1.7483272552490234,2.2278318405151367,4.413778305053711,3.1462883949279785,1.7044422626495361,5.794546604156494,7.297555446624756,0.5964088439941406,-1.0539135932922363,3.3168954849243164,0.5843662023544312,9.457021713256836,1.595345139503479,3.908374071121216,7.894223690032959,1.2999532222747803,-0.5602625608444214,2.1848368644714355,3.5983972549438477,4.486933708190918,3.727534055709839,4.549198150634766,8.373040199279785,5.384211540222168,5.245013236999512,2.450882911682129,8.618189811706543,2.375216245651245,2.3562490940093994,9.612591743469238,4.7560553550720215,6.195436000823975,4.041754245758057,6.288507461547852,8.078790664672852,3.5638465881347656,1.03009033203125,2.987583637237549,5.156386852264404,-0.7297070026397705,7.3419270515441895,6.365181922912598,7.626964569091797,3.0137031078338623,4.422664642333984,2.144822835922241,4.56840181350708,7.402657508850098,3.8913774490356445,6.180729389190674,1.701826810836792,3.383598566055298,5.6106133460998535,5.086846351623535,-0.9041237235069275,2.2834110260009766,7.724588871002197,1.2469041347503662,0.15423421561717987,1.6912264823913574,2.7561068534851074,2.9235386848449707,3.6608657836914062,1.851151704788208,0.5829334855079651,1.939252495765686,7.653356075286865,6.454731464385986,5.380775451660156,5.862354755401611,1.9779784679412842,1.0736274719238281,1.8492050170898438,2.4728753566741943,1.5889124870300293,2.9893863201141357,-0.2464146614074707,-0.803447961807251,3.5970611572265625,-0.6092724204063416,0.09772488474845886,3.1139419078826904,2.2409300804138184,-1.0244430303573608,3.5019588470458984,0.9071212410926819,8.816627502441406,3.351632595062256,4.565698623657227,2.536436080932617,3.5680696964263916,6.111576080322266,3.9207763671875,1.6587682962417603,0.9925753474235535,1.3798342943191528,1.3681933879852295,2.8496248722076416,6.441512107849121,3.8919215202331543,2.734174966812134,4.536118507385254,4.366485118865967,-0.26427432894706726,-0.5556280612945557,2.4116339683532715,2.5867197513580322,-0.1505209058523178,4.351168155670166,2.7250378131866455,2.4743597507476807,-0.7421326041221619,2.4057881832122803,1.445328712463379,7.147191047668457,4.449214458465576,2.7098891735076904,2.097949743270874,0.7852408289909363,-0.8579496145248413,3.7083840370178223,4.014212131500244,0.48655441403388977,0.16829480230808258,3.3921263217926025,2.361518383026123,-0.34588056802749634,2.551783561706543,9.126457214355469,-0.766306459903717,2.940136432647705,4.239640235900879,4.621398448944092,5.6582350730896,0.8301748633384705,1.5873302221298218,1.878524899482727,5.666182041168213,2.2136240005493164,-0.0324835442006588,9.451210021972656,3.0287675857543945,4.13437032699585,2.266305923461914,3.027569055557251,9.129755020141602,3.9916114807128906,1.0919411182403564,1.4470492601394653,1.7155959606170654,1.3418166637420654,7.430666446685791,1.6719669103622437,0.4847349226474762,3.7636890411376953,2.469590187072754,5.7187957763671875,0.5461243987083435,2.4195895195007324,4.752768516540527,3.7571957111358643,7.836146354675293,7.173727035522461,0.9219409227371216,-0.7066724896430969,1.8992977142333984,-0.8883198499679565,2.8941292762756348,2.5436644554138184,0.7479532957077026,0.04640570282936096,4.864886283874512,4.910012245178223,1.4641517400741577,-0.3022476136684418,5.67344856262207,-0.18613578379154205,1.799676775932312,2.8152127265930176,8.782051086425781,2.385190486907959,3.542079210281372,3.570319652557373,-0.21189799904823303,2.0237183570861816,2.9569411277770996,4.27191162109375,1.1902961730957031,4.299892425537109,9.135444641113281,1.0395078659057617,5.6356964111328125,6.86729621887207,6.598814010620117,3.4308061599731445,2.7144389152526855,0.02375023439526558,1.130110502243042,-0.8745040893554688,2.9245448112487793,3.2362911701202393,2.0534796714782715,9.438212394714355,3.534987449645996,2.618988275527954,1.763481855392456,3.265084981918335,1.6024432182312012,1.2724677324295044,1.8824005126953125,5.784172058105469,3.2151989936828613,2.0612823963165283,3.6840407848358154,3.9320461750030518,4.301309108734131,2.223106622695923,2.0338613986968994,2.6455788612365723,-0.1499653458595276,5.256008625030518,3.127739191055298,5.6788010597229,2.4113762378692627,1.5852781534194946,6.192068099975586,1.4206700325012207,0.7463071346282959,-0.5446813702583313,2.282820701599121,2.714053153991699,0.7684063911437988,4.011997222900391,-0.9423567056655884,3.691904306411743,2.6066062450408936,2.0283799171447754,7.521413803100586,3.188690662384033,2.757736921310425,2.3433854579925537,5.478135108947754,1.2201871871948242,5.3904290199279785,5.388546466827393,0.8351761102676392,-0.2970772385597229,1.4881641864776611,2.3878774642944336,-0.7956389784812927,5.3047776222229,3.584582805633545,2.562732458114624,-0.36520883440971375,1.7074413299560547,2.2077741622924805,5.162514686584473,2.993556261062622,3.8203725814819336,2.138422966003418,1.7926329374313354,2.2696752548217773,3.792903423309326,0.929900050163269,5.614184379577637,6.15919303894043,5.103423118591309,4.427893161773682,3.510580062866211,2.6165075302124023,3.84397292137146,5.366064548492432,0.24199062585830688,4.497417449951172,0.2135981172323227,7.202143669128418,5.705542087554932,6.293893337249756,-0.9458639621734619,5.442407608032227,-0.15500396490097046,2.273930549621582,-0.6488036513328552,5.951335906982422,4.994128227233887,2.935748338699341,1.596470594406128,3.4963936805725098,2.442003011703491,-0.37230056524276733,2.9643208980560303,2.932184934616089,3.2316153049468994,10.256976127624512,1.3294683694839478,3.8849213123321533,4.035221099853516,3.8257853984832764,1.1808841228485107,3.6695899963378906,2.098403215408325,1.1662284135818481,1.7948811054229736,3.7385072708129883,4.324591636657715,0.12259545177221298,0.9793925881385803,2.349595546722412,2.1956546306610107,5.987788677215576,1.5519605875015259,3.3801043033599854,4.584357738494873,1.221295952796936,4.366801738739014,-0.13817238807678223,0.9143642783164978,0.8640791773796082,3.091235876083374,5.154731273651123,3.9692177772521973,1.9486486911773682,3.00720477104187,3.565728187561035,-1.0123672485351562,2.6025803089141846,0.6136834621429443,6.644171237945557,4.849646091461182,6.087960720062256,2.1093881130218506,0.677905261516571,1.8886741399765015,1.8581587076187134,4.7863311767578125,2.9035933017730713,-0.8596311211585999,4.3223066329956055,6.287693023681641,1.4878675937652588,2.8432729244232178,4.8025102615356445,1.4565335512161255,-0.5835199952125549,6.017803192138672,1.0637664794921875,3.0565314292907715,3.8283698558807373,4.883395671844482,5.264718532562256,1.3390610218048096,-0.8438497185707092,3.3236241340637207,3.7512917518615723,4.41547155380249,0.6625708937644958,0.853277325630188,2.587742567062378,1.4773805141448975,0.07479159533977509,5.860250949859619,2.4443392753601074,1.3219351768493652,4.730016708374023,1.7171080112457275,0.36391034722328186,8.383177757263184,1.6527245044708252,3.3951990604400635,0.3575691282749176,5.264629364013672,2.4637255668640137,1.2142196893692017,2.5299298763275146,-0.602602481842041,4.511463642120361,-0.3388030230998993,4.768235683441162,0.427617609500885,4.369909286499023,5.529415607452393,4.052955150604248,3.586313486099243,4.31243896484375,6.079283714294434,-0.3515876233577728,-0.902198314666748,2.9245941638946533,2.51678204536438,3.6824891567230225,2.592590093612671,4.350376129150391,1.8254231214523315,2.2385847568511963,3.2060728073120117,3.771559000015259,5.295022487640381,5.236995220184326,1.490319848060608,3.8298027515411377,3.549586296081543,2.751563787460327,4.623378753662109,4.4436354637146,4.492895603179932,0.6416345834732056,2.0277066230773926,2.4578347206115723,3.577648162841797,1.66744863986969,3.485034942626953,1.557503581047058,7.5050530433654785,1.7975108623504639,1.2439044713974,2.0689871311187744,1.5165455341339111,2.810238838195801,4.231072425842285,4.755451202392578,10.35434627532959,4.800139904022217,2.333690881729126,4.2894606590271,3.5820775032043457,0.38378164172172546,2.3935294151306152,2.4163897037506104,1.6823660135269165,2.572085380554199,1.2548094987869263,0.9228381514549255,2.6929357051849365,3.774610996246338,0.9579933285713196,-0.7693507671356201,4.431351184844971,-0.8763964772224426,3.2107748985290527,3.783151626586914,0.015975704416632652,1.631373643875122,2.9106905460357666,4.553783416748047,3.8824586868286133,7.381497383117676,1.3591406345367432,-0.9976162910461426,-0.2904512584209442,1.4821807146072388,-0.3886304497718811,4.885105133056641,2.4237868785858154,3.223355531692505,2.57552170753479,4.690719127655029,3.365788459777832,0.1033540666103363,8.086115837097168,5.015680313110352,3.739046335220337,0.4671253561973572,2.879931688308716,1.9530425071716309,-0.6210324168205261,1.744016170501709,3.485819101333618,8.779888153076172,1.019790768623352,0.9808434844017029,6.481545925140381,3.7168140411376953,4.414268493652344,5.589633941650391,1.7860018014907837,1.3726004362106323,2.635829210281372,3.6660168170928955,3.1835739612579346,2.3271288871765137,1.799115538597107,6.733602523803711,2.883086919784546,1.7229349613189697,2.771188259124756,4.245826721191406,2.2930660247802734,7.243001937866211,1.7873038053512573,5.098123073577881,1.5173628330230713,1.857724905014038,7.519717693328857,1.123802661895752,1.6139817237854004,0.8889759182929993,2.63378643989563,-0.9604962468147278,3.561131238937378,1.4281678199768066,1.4038957357406616,2.2287399768829346,3.064755439758301,0.9167608022689819,1.8932549953460693,3.3587520122528076,1.7044835090637207,3.9563605785369873,2.6934285163879395,1.654502511024475,8.585021018981934,7.619058609008789,0.8873738050460815,1.6607410907745361,1.9882962703704834,1.0292916297912598,3.489337921142578,5.586361408233643,3.104187488555908,5.9025139808654785,1.2217597961425781,3.5059070587158203,3.8182713985443115,1.7868188619613647,5.5866923332214355,-0.8435342311859131,2.1667308807373047,7.605174541473389,6.229907512664795,3.5019869804382324,2.7992970943450928,2.634575605392456,4.883307456970215,2.892714023590088,3.9744367599487305,2.6743218898773193,1.8819621801376343,4.141750335693359,5.985135555267334,2.7574596405029297,5.1084184646606445,2.9841980934143066,3.4263367652893066,0.00724016735330224,4.571207523345947,6.34198522567749,2.7600674629211426,7.331186771392822,2.224107265472412,2.887061595916748,1.5367944240570068,2.4660582542419434,-0.3174472451210022,8.8731689453125,4.206385135650635,1.6405935287475586,3.6689791679382324,6.288466453552246,4.367476463317871,0.4800112843513489,2.4936411380767822,1.8004063367843628,1.3196929693222046,3.1135730743408203,-0.5968727469444275,8.854541778564453,3.5612494945526123,1.3332675695419312,4.2568864822387695,2.052880048751831,2.2076504230499268,7.527622222900391,5.818010330200195,9.344452857971191,4.810767650604248,3.020644187927246,3.0541210174560547,1.651486873626709,3.4696550369262695,-0.4874534010887146,3.1156938076019287,0.5140048265457153,1.3700451850891113,7.910192966461182,1.7921539545059204,-0.5876401662826538,10.046097755432129,1.1240822076797485,3.635801315307617,3.9033708572387695,-0.46587902307510376,-0.09176667779684067,2.312001943588257,-0.5697428584098816,4.283549785614014,2.3250410556793213,3.9839026927948,1.532573938369751,5.778497219085693,5.30164098739624,4.455578327178955,-0.40310147404670715,2.0719664096832275,2.6597890853881836,3.1373114585876465,5.583898544311523,6.605612754821777,1.0076861381530762,2.0878124237060547,2.2678749561309814,0.5342230796813965,1.8422574996948242,5.954405784606934,3.2445876598358154,3.9849250316619873,3.746013641357422,5.120508670806885,4.525754451751709,5.5233073234558105,3.7498831748962402,3.4470789432525635,2.3529653549194336,1.7303745746612549,1.320292353630066,3.509167432785034,4.634149074554443,3.0354857444763184,5.395940780639648,5.691260814666748,0.42115259170532227,8.893449783325195,1.125034213066101,5.769315242767334,3.9196126461029053,1.9668914079666138,2.2059342861175537,3.1061789989471436,9.972817420959473,-0.5092450380325317,0.5891975164413452,1.547324538230896,6.285589694976807,0.9258611798286438,1.492136001586914,2.856210470199585,6.132959842681885,3.9504499435424805,2.252779245376587,2.6717050075531006,0.44080016016960144,7.185799598693848,1.0508859157562256,0.5595870018005371,3.5839054584503174,3.1251676082611084,5.733833312988281,1.569540023803711,7.325760841369629,0.2420954704284668,5.803719520568848,1.8619550466537476,-0.8798518180847168,-0.6890473961830139,8.126596450805664,4.877960681915283,2.2422971725463867,5.791864395141602,5.417860507965088,1.806954026222229,7.895705699920654,5.156023025512695,4.802478790283203,2.687944173812866,2.9325129985809326,0.3587894141674042,1.7239515781402588,2.2771480083465576,1.503063678741455,2.930284023284912,-0.560057520866394,5.146295547485352,1.7409508228302002,3.339045524597168,3.1641082763671875,4.332818984985352,6.385528087615967,3.6638362407684326,2.5762531757354736,1.3764351606369019,1.8100234270095825,3.256843090057373,1.8116024732589722,4.166529655456543,6.7155585289001465,2.3172223567962646,6.645058631896973,2.910099983215332,2.4219188690185547,0.9133643507957458,3.1837313175201416,0.410936564207077,3.6213154792785645,5.758540153503418,0.9390096664428711,2.9674038887023926,6.199146270751953,3.1557438373565674,-0.1450355350971222,0.6951828002929688,3.086883783340454,3.8395204544067383,-0.17352943122386932,5.550409317016602,0.8084733486175537,0.40084967017173767,1.5992704629898071,0.10551296174526215,1.4715750217437744,1.260254979133606,1.4434785842895508,6.93851900100708,1.7617650032043457,3.157790184020996,3.5887646675109863,5.88133430480957,2.571367025375366,4.143331050872803,4.669405937194824,0.8576692938804626,3.7380638122558594,0.7228026390075684,2.6750423908233643,2.4693777561187744,0.5586389303207397,-0.46117278933525085,3.002751588821411,2.736125946044922,3.4852311611175537,3.591958999633789,2.0521652698516846,5.750799179077148,3.50490403175354,1.465456247329712,-0.2644396424293518,4.051750183105469,1.7425459623336792,-0.5470119714736938,1.9009580612182617,7.033872604370117,1.851378321647644,4.72111701965332,1.3747860193252563,2.130328416824341,1.5738580226898193,1.3156344890594482,0.8882991075515747,3.8982203006744385,2.6209797859191895,1.4288334846496582,2.336045503616333,5.00261116027832,5.057595252990723,0.15638799965381622,6.503576755523682,3.020035743713379,0.5542941689491272,1.416367530822754,-0.07357903569936752,4.182814598083496,4.786647319793701,-0.7385289669036865,1.4364354610443115,1.976401925086975,-0.7309855222702026,1.5190242528915405,0.7804884910583496,-0.7173373699188232,3.8068041801452637,4.496349334716797,0.5530735850334167,4.507123947143555,1.1020729541778564,1.1812397241592407,-0.7128807306289673,2.9535531997680664,1.6363605260849,5.04696798324585,5.446965217590332,1.5260703563690186,2.426152229309082,-0.6973721385002136,4.7236199378967285,6.138890743255615,2.346468687057495,2.589066505432129,3.8370614051818848,1.9394317865371704,-0.5801278948783875,-0.2735103964805603,-0.7855348587036133,4.976535320281982,1.8664250373840332,2.816650867462158,2.617351770401001,1.4647657871246338,1.4688820838928223,6.942780017852783,3.4922075271606445,2.206343412399292,2.400495767593384,3.0098841190338135,2.841891050338745,-0.3276030719280243,2.4058187007904053,6.228207588195801,0.7005659341812134,5.224339962005615,5.7481689453125,9.399201393127441,-0.527815043926239,3.4467155933380127,6.803232669830322,2.2237138748168945,1.600813627243042,-0.6239888072013855,1.1636184453964233,5.106338977813721,-0.872671365737915,3.742816686630249,3.0736353397369385,3.3506431579589844,3.866436719894409,2.370689868927002,1.5495784282684326,1.3426073789596558,3.0535106658935547,1.9642256498336792,1.4615864753723145,4.789338111877441,5.114998817443848,7.789256572723389,1.4687665700912476,2.7153525352478027,1.4625734090805054,0.8227508068084717,0.4803270101547241,4.3783111572265625,2.127739429473877,-0.6243219971656799,3.3401451110839844,3.468744993209839,-0.29375579953193665,3.586092948913574,3.45788836479187,10.070840835571289,3.2302725315093994,4.532566070556641,4.027520656585693,2.586306571960449,6.834135055541992,0.5924158096313477,4.668190002441406,5.124925136566162,3.117902994155884,5.198777198791504,4.411006927490234,2.4985976219177246,0.9332538843154907,3.3066835403442383,1.861728310585022,2.3117926120758057,3.6279866695404053,3.960967540740967,3.446824789047241,1.7967147827148438,1.4154802560806274,4.06178092956543,3.0080199241638184,1.5166542530059814,3.2454755306243896,2.1436045169830322,1.3853569030761719,4.836696147918701,0.4702860414981842,-0.07186713069677353,1.1784992218017578,1.4792430400848389,2.6750497817993164,-0.8545241355895996,7.214530944824219,0.7832866311073303,2.4491372108459473,-0.32440704107284546,4.139312744140625,2.622260808944702,0.9022660851478577,2.1361348628997803,1.4444266557693481,2.535602331161499,3.967613935470581,3.882901191711426,-0.30032870173454285,4.29490852355957,4.573690891265869,2.1575777530670166,5.703354835510254,0.2991211712360382,2.8443877696990967,5.60352897644043,0.9001989960670471,1.448716640472412,7.696744441986084,5.466685771942139,3.7787699699401855,7.672499656677246,0.960870623588562,2.1567020416259766,4.43569803237915,0.7176915407180786,3.613339424133301,3.9926016330718994,2.984525680541992,3.541790723800659,4.4373250007629395,4.445836067199707,6.20302152633667,-0.5542901158332825,3.14660906791687,2.8461859226226807,1.4773390293121338,3.7634899616241455,-0.4911927282810211,0.9042606353759766,7.256561756134033,0.985670804977417,1.5417495965957642,5.875776767730713,5.219454288482666,0.3622090816497803,2.1537976264953613,1.3013440370559692,8.30241584777832,4.09741735458374,0.21020638942718506,5.413436412811279,3.0752010345458984,2.5094263553619385,-0.24225808680057526,6.980837345123291,2.675034761428833,3.5008442401885986,3.7578625679016113,2.376206398010254,1.7583314180374146,7.013671398162842,5.738492488861084,3.882082223892212,6.370395660400391,3.1246137619018555,3.4081220626831055,2.063633680343628,1.4930058717727661,5.518001079559326,2.9065332412719727,0.6388890743255615,1.9744619131088257,4.149022102355957,2.10720157623291,3.4486680030822754,-0.6503385901451111,4.278296947479248,9.869436264038086,2.700883626937866,0.5868025422096252,2.700793743133545,2.0713326930999756,10.578093528747559,4.872677326202393,1.8928732872009277,0.7636080980300903,5.863542079925537,4.738862991333008,3.3080801963806152,6.173954486846924,2.6600818634033203,3.217379093170166,0.053017228841781616,4.272884845733643,5.482606887817383,2.7074384689331055,0.2026173323392868,4.831497669219971,7.353179931640625,2.4722485542297363,4.75300407409668,2.696932554244995,7.259786605834961,2.0512290000915527,6.989910125732422,7.952306270599365,-0.8631353974342346,2.4592511653900146,3.3176488876342773,6.113620281219482,0.18399253487586975,7.746222496032715,2.4653611183166504,4.073048114776611,-0.6159899234771729,1.885946273803711,-0.1803322434425354,0.12523667514324188,2.966371774673462,0.2807372212409973,4.982975482940674,5.206063747406006,-0.08125139027833939,6.809606552124023,5.488216876983643,6.7337141036987305,2.3671669960021973,2.8888213634490967,0.2254435420036316,4.249342918395996,3.092924118041992,3.627375602722168,4.60921049118042,3.5036730766296387,0.9190864562988281,-0.9770269989967346,4.40502405166626,2.8776497840881348,-0.7372166514396667,6.384213447570801,-0.611788809299469,2.8677191734313965,2.111875057220459,8.832749366760254,0.20532569289207458,2.8604259490966797,5.086380481719971,7.177857875823975,0.4534396827220917,4.959763050079346,0.7895335555076599,4.427934646606445,2.2228775024414062,1.5052227973937988,1.7117335796356201,1.4716253280639648,1.8128666877746582,0.7790248394012451,4.587839603424072,0.7553371787071228,4.597320079803467,2.5820345878601074,7.372539043426514,0.6111142039299011,2.1627094745635986,-0.9840051531791687,0.40314602851867676,0.2942672669887543,7.0567522048950195,4.566939830780029,4.314742088317871,7.52444314956665,3.340278387069702,0.671899139881134,4.593179702758789,-0.563007116317749,3.591586112976074,1.140997290611267,2.0023839473724365,2.108553409576416,0.11337858438491821,0.06790880113840103,4.958119869232178,4.909473419189453,0.24570564925670624,1.2066947221755981,2.6919310092926025,2.987989664077759,-0.16631732881069183,2.166386127471924,0.24999648332595825,3.204655408859253,6.048676013946533,1.2148224115371704,1.7005021572113037,1.153459906578064,1.8998212814331055,-0.7634751796722412,0.91805100440979,0.09090264141559601,3.3685131072998047,2.6360697746276855,-0.07790184766054153,3.940680980682373,2.9527218341827393,3.287015199661255,4.274101257324219,2.6681432723999023,3.35941743850708,1.9103877544403076,3.4503939151763916,5.7990851402282715,2.2071986198425293,2.130948066711426,1.7115683555603027,0.29169851541519165,4.116763114929199,0.959450900554657,2.4486007690429688,-0.5657922029495239,4.78712272644043,-0.16671878099441528,5.095415115356445,2.6236658096313477,4.0928635597229,1.1846381425857544,2.6618967056274414,1.9306323528289795,5.694373607635498,3.110476493835449,3.4653282165527344,1.7794511318206787,1.1908525228500366,1.8302282094955444,3.56011700630188,3.1315221786499023,3.6995115280151367,3.850273370742798,1.899933099746704,-0.23308895528316498,2.2347209453582764,4.6692094802856445,2.333813428878784,3.9011147022247314,1.603497862815857,2.664935827255249,-1.1853294372558594,2.6083438396453857,-0.4455696642398834,4.617009162902832,0.9573035836219788,1.3520351648330688,3.384545087814331,3.9146807193756104,3.415066719055176,6.662715911865234,4.2061004638671875,2.772918462753296,8.057408332824707,4.085709095001221,4.0085930824279785,1.649796485900879,0.07341808825731277,6.183794021606445,4.276425838470459,2.5523200035095215,2.198145627975464,0.9111313223838806,-0.024430083110928535,0.36796754598617554,2.67484450340271,2.7042293548583984,4.209685802459717,3.879316568374634,2.8572256565093994,3.5467803478240967,-0.4853467345237732,5.538015842437744,0.8073328733444214,1.0902060270309448,-0.37989386916160583,1.0514802932739258,3.5951366424560547,1.6987128257751465,3.011094570159912,2.5014333724975586,3.224724769592285,3.0257294178009033,0.45352470874786377,1.8190332651138306,1.6941001415252686,3.3838117122650146,6.914291858673096,2.1690762042999268,-0.7271708250045776,-0.6440680623054504,-0.2168067842721939,0.767263650894165,3.8319013118743896,4.600273609161377,2.7951459884643555,4.507976055145264,2.9689791202545166,4.094625949859619,2.0774624347686768,1.8938989639282227,0.14996394515037537,3.0236754417419434,1.7746721506118774,3.940563201904297,4.0546698570251465,4.012828826904297,0.39445340633392334,2.1480965614318848,6.947786331176758,2.4615519046783447,4.574548244476318,2.699636697769165,7.896359443664551,3.932417869567871,0.6038170456886292,2.559020757675171,6.777612209320068,2.0267558097839355,5.925965785980225,1.3799190521240234,5.2066264152526855,1.1585034132003784,3.7559964656829834,-0.5100212693214417,1.7663519382476807,5.160709857940674,4.454092979431152,4.0761895179748535,0.5823183655738831,3.659144401550293,7.511575222015381,4.621591091156006,2.0686044692993164,5.0059356689453125,0.4713474214076996,3.759781837463379,3.4895942211151123,5.739146709442139,2.9082677364349365,1.982126235961914,1.5960791110992432,2.164123058319092,3.131965398788452,1.2670735120773315,0.5053597092628479,4.3881049156188965,5.158144950866699,8.595561981201172,0.4960518181324005,2.3993325233459473,0.530974268913269,1.2065248489379883,0.35872963070869446,11.034299850463867,4.195556640625,2.817769765853882,2.637871503829956,4.25081205368042,4.516117572784424,3.8473434448242188,3.5412404537200928,0.44166773557662964,4.465085029602051,1.740049958229065,2.78422474861145,2.942831516265869,1.7437690496444702,3.4836041927337646,3.0257444381713867,9.214556694030762,2.135862112045288,3.5826992988586426,2.5034759044647217,2.0952072143554688,1.4064483642578125,2.3488571643829346,2.726249933242798,0.5062652826309204,-0.5033236145973206,2.794341802597046,5.321787357330322,4.095362186431885,3.8415651321411133,0.94785076379776,1.9654721021652222,0.8263389468193054,2.6901798248291016,4.573729038238525,0.7166969180107117,5.5498433113098145,1.9277390241622925,8.063034057617188,1.4426255226135254,2.5661916732788086,1.5779733657836914,1.6613521575927734,5.7554826736450195,2.526127576828003,3.3382036685943604,1.409570336341858,4.621930122375488,3.7295031547546387,7.035321235656738,-0.15265963971614838,3.33050274848938,3.347029447555542,4.516104698181152,0.205070361495018,4.018343448638916,1.128791093826294,4.602315902709961,5.906102657318115,0.2965989410877228,2.4575583934783936,3.4720981121063232,4.0124406814575195,1.5511693954467773,7.019588947296143,3.47057843208313,0.8396119475364685,3.766653537750244,2.279451370239258,9.483072280883789,3.0543813705444336,4.158375263214111,2.955014228820801,5.717669486999512,0.9426082372665405,4.530148506164551,5.1489152908325195,3.253951072692871,2.486203193664551,2.6869008541107178,2.3069403171539307,7.962738037109375,0.9742481112480164,-0.5906070470809937,1.46439528465271,3.718557357788086,2.596424102783203,-0.7460038065910339,4.618261814117432,5.105271339416504,2.6808204650878906,2.6109237670898438,4.409828186035156,3.886115550994873,1.1629595756530762,2.1826303005218506,4.787308692932129,4.69584321975708,0.8842873573303223,3.8585145473480225,-0.4266953468322754,2.5898821353912354,7.557475566864014,2.6211349964141846,0.89732825756073,1.2178908586502075,1.1845669746398926,7.592108726501465,4.2224626541137695,1.5786409378051758,4.364048480987549,9.738259315490723,2.8862247467041016,4.127068996429443,2.661620855331421,0.6433517336845398,1.1263304948806763,2.129427671432495,2.1337409019470215,3.7708632946014404,-0.04455927759408951,6.947933197021484,0.6511683464050293,1.5793577432632446,-0.5948747992515564,2.817265033721924,0.7270142436027527,1.097191333770752,-0.7032579183578491,0.9778211712837219,-0.4350098967552185,0.7291330695152283,2.6792244911193848,7.4608259201049805,-0.6113768815994263,5.656822204589844,4.484218597412109,-0.869337797164917,2.0637781620025635,3.882587194442749,10.268305778503418,10.86512565612793,-0.3707135021686554,2.8049380779266357,5.827953815460205,3.3513972759246826,0.6655489206314087,2.95644211769104,4.39116096496582,2.3738296031951904,4.444960117340088,3.765298366546631,3.521855354309082,2.736285924911499,2.4678070545196533,3.4488229751586914,2.955608606338501,4.284824371337891,0.7668901681900024,-0.724856972694397,0.7464555501937866,2.7279505729675293,1.2332359552383423,1.0048084259033203,1.118908405303955,4.9456868171691895,2.544128894805908,-0.6752484440803528,1.048815131187439,0.9987367391586304,3.9663636684417725,5.785446643829346,0.8051114082336426,4.13081693649292,2.0289306640625,1.4077575206756592,3.5868377685546875,1.4273526668548584,2.7196574211120605,1.6809871196746826,7.786111354827881,5.808807849884033,3.776890993118286,3.192357301712036,2.9283347129821777,1.5879069566726685,3.9626784324645996,2.4476888179779053,4.8469462394714355,3.641817569732666,8.534157752990723,5.374980449676514,8.207839012145996,2.9523603916168213,6.554234981536865,5.622613906860352,6.712753772735596,2.1929287910461426,2.6226747035980225,2.2773778438568115,6.746795654296875,2.43802547454834,2.1205873489379883,5.505265712738037,3.4370646476745605,2.0258491039276123,4.011532783508301,5.641666889190674,1.9464023113250732,-0.6749259233474731,3.789106845855713,9.341383934020996,3.5145232677459717,4.301244258880615,3.7883059978485107,2.001152515411377,2.1518709659576416,1.4017891883850098,4.616525650024414,1.3897937536239624,0.9363692998886108,6.902141094207764,2.1798598766326904,5.124809265136719,6.077466011047363,3.8805267810821533,-0.1331939697265625,3.968736171722412,3.150853395462036,7.464416027069092,0.5632488131523132,8.242271423339844,6.259576797485352,-0.7123607397079468,5.247476100921631,1.120545506477356,-0.9762559533119202,3.9731245040893555,-0.7969054579734802,1.6572308540344238,-0.7956753373146057,7.96453857421875,3.1165945529937744,4.3594512939453125,5.131051063537598,2.901913642883301,2.593040943145752,2.345827579498291,2.10801362991333,7.0364089012146,5.399759769439697,3.5775680541992188,-0.6945337057113647,1.5799095630645752,3.6039764881134033,3.831050395965576,2.812256097793579,1.8289315700531006,4.354331016540527,1.4789061546325684,2.8406550884246826,4.327423572540283,5.424481391906738,2.980623483657837,4.075687408447266,6.210881233215332,2.3597590923309326,7.723470687866211,1.55499267578125,-0.6689364314079285,2.698223352432251,6.733920574188232,8.597132682800293,3.73618221282959,0.8915941119194031,4.581714630126953,2.305663585662842,2.81207275390625,4.199882984161377,4.7802348136901855,1.8890353441238403,3.4410176277160645,4.506741046905518,-0.40283703804016113,-0.6454491019248962,5.59395170211792,0.670401930809021,2.2407922744750977,1.2625242471694946,10.331620216369629,5.861813068389893,1.461201548576355,6.609270095825195,3.3940277099609375,2.388354778289795,1.6444052457809448,1.5455161333084106,1.0070769786834717,-0.052445899695158005,4.626251697540283,3.079874038696289,3.085583448410034,10.182313919067383,1.593163251876831,8.807841300964355,4.360552787780762,6.466526985168457,3.108799695968628,2.6494967937469482,0.7248431444168091,-0.12924706935882568,2.5121941566467285,2.2718281745910645,3.9079058170318604,6.917133331298828,2.9457569122314453,-0.3724515438079834,1.4554928541183472,5.269731521606445,2.3622777462005615,2.32537841796875,5.847891330718994,1.6878252029418945,4.552112579345703,1.9489598274230957,7.906780242919922,5.466380596160889,4.451379299163818,-0.02974848821759224,2.59504771232605,2.832634210586548,7.613358497619629,8.441680908203125,-1.0314478874206543,-0.2456229329109192,-0.20298747718334198,1.171270489692688,5.772576808929443,0.8774855136871338,3.827881097793579,1.8913474082946777,0.5241655111312866,3.914102077484131,1.8495943546295166,-1.0091429948806763,0.45426878333091736,2.911674976348877,-0.4971837103366852,4.369028568267822,3.329791784286499,-0.4877665340900421,-0.6877846717834473,5.0816216468811035,3.670717716217041,0.8679853677749634,2.108250379562378,4.3325982093811035,5.277379512786865,0.48704949021339417,3.8359198570251465,4.396304607391357,1.8678008317947388,5.133705139160156,2.3464455604553223,3.1650030612945557,3.175893783569336,5.465649127960205,3.216663122177124,9.569275856018066,4.710870742797852,3.3041882514953613,2.4325389862060547,4.032206058502197,-0.11541756242513657,4.052512168884277,2.5559887886047363,3.8928167819976807,6.045260906219482,4.290566921234131,3.2649550437927246,3.607656717300415,4.992931842803955,0.7470536828041077,6.929211139678955,4.945937156677246,2.324805974960327,4.64162540435791,1.0608984231948853,5.533356666564941,4.708938121795654,1.87655508518219,-0.014980113133788109,1.2658638954162598,1.7672624588012695,3.030111074447632,3.1734120845794678,5.609256267547607,3.9012293815612793,-0.18890994787216187,3.5353598594665527,5.764392852783203,7.065808296203613,2.0257065296173096,3.1070337295532227,2.085768938064575,2.353224277496338,5.094442844390869,3.0039618015289307,3.8709182739257812,2.0636277198791504,3.752315044403076,-0.850392758846283,1.4169825315475464,3.033202886581421,0.6501225233078003,3.424391508102417,2.578761577606201,8.26087474822998,0.8034561276435852,3.701000452041626,3.3690927028656006,3.109381675720215,4.276408672332764,-0.6952505111694336,4.9261932373046875,0.6708999872207642,1.4259984493255615,-0.015014022588729858,4.89450740814209,-0.44459035992622375,1.6159608364105225,2.423110246658325,1.2680782079696655,3.291038751602173,0.3775780200958252,4.014339447021484,3.3931477069854736,1.660064697265625,3.4905059337615967,3.3455047607421875,2.569563388824463,5.4286932945251465,6.998605728149414,3.8764915466308594,0.2282819300889969,4.11081600189209,4.188061714172363,3.574526309967041,2.2698910236358643,4.107705593109131,1.0475624799728394,3.0819637775421143,2.764906644821167,6.883384704589844,0.5972948670387268,1.1352813243865967,3.7362048625946045,2.2909839153289795,8.865693092346191,8.807782173156738,1.5101560354232788,2.3699839115142822,4.2039337158203125,1.372581958770752,8.310541152954102,3.946699857711792,4.096637725830078,2.8111021518707275,3.300837516784668,1.2349234819412231,2.306368827819824,1.3217490911483765,1.2504382133483887,2.6574790477752686,-0.7171738147735596,3.9358131885528564,3.7477965354919434,4.043389797210693,1.35641348361969,2.6769003868103027,3.3068485260009766,0.3519366681575775,2.89697003364563,3.395236015319824,5.962692737579346,1.7638680934906006,3.8166723251342773,4.387199878692627,2.9656357765197754,3.9990124702453613,8.239445686340332,7.5969929695129395,6.4229631423950195,3.527194023132324,2.985750198364258,2.8658359050750732,0.08268845081329346,2.4168319702148438,3.0794692039489746,-0.11091440171003342,-0.05830947309732437,1.5481438636779785,3.035019874572754,5.348978519439697,2.064663887023926,5.718880653381348,1.070570945739746,1.37870454788208,3.8974480628967285,0.9170960187911987,1.611206293106079,4.049801826477051,8.27437973022461,2.732433557510376,6.925940036773682,7.159427165985107,2.26942777633667,2.560426712036133,2.7272629737854004,5.679708957672119,4.279366493225098,-0.7096964716911316,1.871648907661438,4.472645282745361,1.204180359840393,1.170824646949768,-0.6488977074623108,8.136804580688477,2.553354263305664,2.209235191345215,4.00203800201416,4.8003740310668945,3.7835142612457275,3.752863645553589,0.49782902002334595,8.774005889892578,4.7513532638549805,4.68100118637085,4.67100715637207,2.3479888439178467,4.279264450073242,0.11636454612016678,1.1747839450836182,1.9707155227661133,-0.3892819583415985,2.0939395427703857,8.53156566619873,4.5321855545043945,-0.16965433955192566,4.127479553222656,1.4754763841629028,3.998506784439087,3.9744579792022705,6.449319839477539,5.580554962158203,1.303497552871704,5.677706718444824,3.909102201461792,0.903781533241272,4.5647077560424805,-0.41206857562065125,4.300944805145264,4.043494701385498,4.184562683105469,0.4044438302516937,8.327705383300781,4.192692279815674,2.251710891723633,4.734313488006592,5.69823694229126,0.8255990743637085,1.695601463317871,7.2025885581970215,1.1004703044891357,4.210206031799316,0.513115644454956,1.6884500980377197,1.4794435501098633,-0.31404909491539,1.493001937866211,1.9835227727890015,3.1065640449523926,2.355109930038452,1.6603034734725952,-0.735356330871582,4.6553826332092285,3.6326944828033447,0.9310818314552307,1.7846952676773071,5.0515265464782715,0.3986034095287323,-0.6454804539680481,-0.05450241267681122,0.8246822953224182,4.427660942077637,4.753372669219971,1.4051929712295532,0.9218285083770752,6.597762584686279,0.12909981608390808,2.991136074066162,3.531557083129883,2.313206434249878,2.862302541732788,6.1020989418029785,3.1390678882598877,1.7901171445846558,-0.759132444858551,5.874835014343262,1.8747161626815796,0.7834498286247253,4.2769927978515625,2.1895241737365723,2.0717105865478516,2.3022830486297607,2.829904317855835,3.395127058029175,1.1096386909484863,3.922785520553589,0.5360682010650635,2.249737024307251,-0.6300094723701477,3.9578237533569336,1.1638717651367188,3.9576334953308105,1.8345574140548706,2.2991275787353516,8.101534843444824,2.662182331085205,3.55830454826355,6.569450855255127,3.5837864875793457,-0.6100658774375916,6.647784233093262,6.295625686645508,2.23769474029541,4.196163654327393,5.24333381652832,2.5804569721221924,2.413530111312866,1.296183705329895,1.8582686185836792,2.756330728530884,5.520576477050781,4.1267266273498535,0.7690407037734985,1.5514870882034302,-0.7980453372001648,7.136536121368408,1.2423431873321533,2.237607479095459,2.275128126144409,3.0781733989715576,1.9325692653656006,3.6930487155914307,-0.18222951889038086,4.590083122253418,6.138991832733154,7.266497611999512,4.359681606292725,-0.7699505090713501,3.9491472244262695,7.540936470031738,1.3573336601257324,4.706806182861328,4.324046611785889,8.322875022888184,-0.017740465700626373,3.851498603820801,1.5563148260116577,1.571144938468933,1.552347183227539,0.2545093297958374,2.2722420692443848,0.9683417081832886,-0.1403428614139557,1.682916522026062,-0.629177451133728,0.8089821934700012,1.8364976644515991,5.988316059112549,5.856786727905273,1.485652208328247,6.330617904663086,6.34733247756958,4.880290985107422,4.159977912902832,4.243346691131592,6.219273567199707,2.470637559890747,1.6842923164367676,3.670616626739502,7.510283946990967,4.060518741607666,3.3163681030273438,10.100946426391602,3.6131906509399414,1.9976906776428223,-0.7509788274765015,3.6122426986694336,1.5629053115844727,3.4337823390960693,2.9081687927246094,0.8976231217384338,9.261452674865723,1.691892147064209,3.1426730155944824,0.23764295876026154,2.742149829864502,0.29732421040534973,4.662220478057861,5.283233165740967,1.049921989440918,5.40125036239624,4.474212169647217,4.120354175567627,1.9573240280151367,2.2011098861694336,1.0716116428375244,3.6404902935028076,1.1915993690490723,8.227603912353516,1.1201319694519043,0.4332520663738251,2.2951080799102783,6.745566368103027,3.00593638420105,-0.8457636833190918,5.653136730194092,0.12926214933395386,0.6584202647209167,5.5327534675598145,4.2120795249938965,5.687603950500488,4.036484241485596,2.9041836261749268,9.205851554870605,2.23724365234375,2.1655426025390625,4.587001323699951,6.204158306121826,-0.13541726768016815,1.1860899925231934,6.502118110656738,3.7420780658721924,5.649566650390625,3.495286464691162,-0.6990453004837036,0.840965747833252,3.57707142829895,-0.6261105537414551,-0.54712975025177,-0.7612928152084351,1.0802172422409058,3.0960257053375244,3.819719076156616,3.082106351852417,6.074935436248779,4.638345241546631,-0.1464329957962036,8.59597110748291,2.5003747940063477,7.243778228759766,5.601554870605469,4.183716297149658,2.405987024307251,2.014832019805908,-0.7364280819892883,1.8503526449203491,1.6444982290267944,2.979182720184326,4.896903038024902,5.528317928314209,7.393074035644531,-0.3624263405799866,6.977379322052002,1.543010950088501,1.0804523229599,3.2778000831604004,1.5479674339294434,6.769949436187744,2.041696310043335,3.616711139678955,1.3195295333862305,3.2084856033325195,-0.6566541194915771,3.9647979736328125,2.9417479038238525,-0.3998894989490509,6.08373498916626,6.218086242675781,1.9027228355407715,-0.1913662850856781,2.9127933979034424,2.3091721534729004,1.0873335599899292,3.1971940994262695,7.277425289154053,4.235090732574463,2.314162015914917,-1.0723775625228882,-0.3035471737384796,8.677338600158691,2.00803804397583,5.771777153015137,2.938544988632202,2.0941317081451416,4.6420793533325195,2.8503758907318115,5.077897548675537,-0.7733790874481201,2.435192584991455,1.9164077043533325,4.26615047454834,9.692410469055176,2.624980926513672,0.9178298711776733,3.6178035736083984,2.8430745601654053,5.042344570159912,0.12571421265602112,2.1024396419525146,2.466855764389038,5.852197647094727,-0.29669877886772156,1.6943132877349854,2.4518256187438965,1.8919802904129028,1.3133554458618164,5.439032077789307,5.713653087615967,5.319004058837891,3.3285696506500244,3.136552333831787,2.519742727279663,0.8010357022285461,2.429675817489624,4.17303991317749,-0.4880819618701935,1.0801280736923218,2.026226282119751,3.690931797027588,1.6747790575027466,3.4115965366363525,2.465636730194092,7.72295618057251,-0.7831850647926331,2.2817201614379883,1.7553125619888306,6.887665271759033,7.867945671081543,-0.9907727241516113,2.310415506362915,-0.6849634647369385,1.1132627725601196,0.5754818916320801,9.197575569152832,2.5300958156585693,2.1002705097198486,3.164797782897949,-0.7054043412208557,4.662232875823975,2.161586284637451,3.59247088432312,2.283189296722412,-0.5601373314857483,-0.3529503643512726,3.944167137145996,1.3618942499160767,4.616269588470459,4.356568336486816,5.717840671539307,3.386597156524658,6.318627834320068,3.152188539505005,1.3134618997573853,4.8778228759765625,-0.2868881821632385,2.3957457542419434,2.5987706184387207,6.554027080535889,2.745983362197876,2.9522545337677,1.0120569467544556,2.2096140384674072,0.6821564435958862,5.403076171875,8.923974990844727,0.9439383745193481,-0.2846420109272003,5.08506441116333,7.191354274749756,5.574116230010986,4.588286876678467,5.607443809509277,8.031242370605469,5.598404407501221,-0.8727640509605408,2.546304702758789,5.110196590423584,1.986275553703308,0.20651379227638245,0.0058992900885641575,1.0660228729248047,4.951008319854736,4.503580093383789,1.1391299962997437,5.215763092041016,3.4455013275146484,1.3559504747390747,2.424816846847534,1.930759072303772,1.7227458953857422,2.741537094116211,5.58262300491333,-0.6723374128341675,-0.7138897180557251,1.6315433979034424,0.9370802640914917,3.554603338241577,6.624489784240723,1.0588691234588623,3.8631362915039062,3.0407633781433105,4.180576801300049,7.004875183105469,3.102241039276123,-0.6893973350524902,3.67120099067688,2.2534029483795166,9.687376022338867,3.20774245262146,4.6561408042907715,2.3425397872924805,3.4067647457122803,0.0650891661643982,6.333431720733643,7.689611434936523,2.9168548583984375,2.7118189334869385,1.8813029527664185,4.656764984130859,3.803317070007324,1.359699010848999,4.561180114746094,2.6282413005828857,-0.41903209686279297,3.133300304412842,1.0244743824005127,7.8783440589904785,2.18213152885437,4.112585067749023,2.6792409420013428,1.7685586214065552,2.2787654399871826,2.745170831680298,3.28110671043396,5.162868976593018,-0.7297544479370117,2.4026131629943848,-0.9816713333129883,0.558456301689148,3.7504706382751465,1.5222762823104858,3.0807180404663086,3.103306770324707,6.626136779785156,10.133963584899902,-0.41804197430610657,3.332059860229492,3.383695602416992,4.497838973999023,1.4337143898010254,2.4627468585968018,7.852270126342773,4.817119121551514,-0.14850760996341705,1.8513191938400269,1.5923972129821777,1.7754813432693481,9.706408500671387,3.537158489227295,1.2192672491073608,1.8140528202056885,1.464179515838623,2.4632394313812256,3.5944020748138428,4.387659549713135,3.5849554538726807,1.6064176559448242,2.6056711673736572,-0.7256832122802734,0.4103619158267975,2.5485386848449707,2.7157487869262695,2.3770172595977783,4.068068981170654,2.7276079654693604,6.610649108886719,5.553786277770996,2.0944108963012695,1.5543336868286133,-0.8889379501342773,4.816647052764893,9.674036026000977,2.1013343334198,4.877260684967041,2.9526965618133545,-0.8518785834312439,-0.4149935841560364,8.18148136138916,3.80141544342041,2.978286027908325,2.281906843185425,3.9613003730773926,6.226322174072266,2.797025203704834,2.7904131412506104,5.755905628204346,6.687274932861328,2.198474645614624,-0.70557701587677,5.822320938110352,2.8150978088378906,0.4798632562160492,4.227422714233398,0.8152341246604919,2.682523250579834,1.5513628721237183,-0.1695389747619629,2.6472549438476562,1.7572070360183716,4.810085296630859,5.65004825592041,3.6173484325408936,2.8267877101898193,-0.4876992702484131,4.279818534851074,3.551255941390991,2.306159019470215,2.547633171081543,1.6659736633300781,1.5958812236785889,1.676126480102539,1.5552879571914673,1.409871220588684,6.888006210327148,1.340934157371521,3.9826979637145996,0.926603376865387,4.6464080810546875,-0.07871924340724945,1.4372762441635132,3.04744553565979,3.3561246395111084,-0.294746994972229,-0.20890574157238007,2.491025924682617,6.280293941497803,4.055972576141357,0.11571795493364334,4.896998882293701,1.9331086874008179,2.2619845867156982,6.117124557495117,3.29819393157959,5.070250511169434,3.4538540840148926,6.2954230308532715,3.6946868896484375,8.247178077697754,0.5025647878646851,0.7867311239242554,2.8310739994049072,2.607229471206665,6.902159214019775,0.7274076342582703,4.585236549377441,4.192458152770996,2.2149596214294434,1.5404927730560303,0.28427818417549133,0.430775910615921,5.41887092590332,2.7998549938201904,2.1554958820343018,0.9040364027023315,1.3023817539215088,2.6220057010650635,1.5378245115280151,5.0734333992004395,1.9289532899856567,7.0585761070251465,1.6465612649917603,0.01050634402781725,-0.11437113583087921,9.376041412353516,1.381217122077942,5.025528907775879,1.110828161239624,0.509891152381897,4.8864359855651855,5.684352397918701,4.28713321685791,5.490612030029297,3.290271282196045,2.084259271621704,6.938369274139404,5.434664726257324,4.780677318572998,3.4882519245147705,5.857602119445801,6.851551055908203,3.433229923248291,-0.697324275970459,4.761116027832031,5.7320332527160645,-0.4148915410041809,0.549830973148346,2.491734266281128,4.687472343444824,3.9519622325897217,2.424252510070801,1.2574571371078491,-0.2658631205558777,0.9922772645950317,3.529170036315918,3.316322088241577,2.9258971214294434,-0.3492036759853363,2.049079418182373,2.1818456649780273,2.8445181846618652,-0.2594982385635376,2.6441938877105713,0.3506741225719452,2.346775770187378,0.9794525504112244,-0.18122094869613647,0.4141271114349365,4.096591472625732,3.874809741973877,2.1306657791137695,3.879085063934326,-0.19399221241474152,1.854368805885315,1.9943792819976807,1.2904154062271118,2.091701030731201,0.22863684594631195,-0.550790548324585,3.5349814891815186,2.9521331787109375,4.159104347229004,4.867842197418213,3.715925931930542,2.6972997188568115,-0.6486670970916748,7.174931526184082,1.9850308895111084,0.5454262495040894,3.001187801361084,2.436511754989624,3.031271457672119,3.0099339485168457,5.547218322753906,3.366245985031128,0.8641188740730286,2.4732553958892822,1.6467751264572144,-0.5863639116287231,2.157984972000122,0.76667720079422,2.5141584873199463,1.4066689014434814,5.885398864746094,3.7900280952453613,3.0628488063812256,3.1749346256256104,-0.7790644764900208,2.42293643951416,-0.4508974850177765,3.1089227199554443,3.4334027767181396,3.0858685970306396,2.275223970413208,2.7670931816101074,-0.014846449717879295,3.194864273071289,4.392977714538574,3.617143392562866,0.43262359499931335,2.606332540512085,1.256735920906067,3.1271169185638428,2.080916404724121,-0.24080418050289154,0.8460106253623962,1.6419012546539307,-0.41700050234794617,0.0021966344211250544,5.9467010498046875,4.126404762268066,2.735463857650757,-0.4761652946472168,0.5621347427368164,8.222573280334473,5.636960029602051,3.2612032890319824,3.951953887939453,6.814006805419922,-0.5851262807846069,3.928748846054077,-0.444722443819046,4.496551036834717,3.3362936973571777,0.1346675157546997,1.3429967164993286,1.5351046323776245,4.701138496398926,5.21645450592041,3.8821306228637695,5.792693138122559,2.2791945934295654,3.284602642059326,5.643072605133057,1.4868495464324951,-0.7576379776000977,0.5508882999420166,3.4489386081695557,-0.1008654460310936,1.7327476739883423,1.4470500946044922,2.979027032852173,1.7020413875579834,6.127504348754883,2.6850502490997314,3.510195016860962,5.172904968261719,4.214114189147949,3.8309381008148193,5.630648612976074,5.591423511505127,1.9575501680374146,2.2222771644592285,5.523288249969482,1.3121182918548584,3.1298985481262207,1.9859378337860107,5.229220867156982,1.9850306510925293,2.415970802307129,1.7642792463302612,0.8835155963897705,4.7818098068237305,4.7284674644470215,-0.5205786824226379,6.08856201171875,2.3908588886260986,3.1351711750030518,2.4531636238098145,3.026695489883423,7.205760955810547,0.9331832528114319,0.4252455234527588,8.20848560333252,6.557864665985107,10.148520469665527,6.960323333740234,2.247270107269287,2.483491897583008,3.5728585720062256,2.191072940826416,1.8511929512023926,-0.9274517893791199,3.3123412132263184,2.7549424171447754,3.3517866134643555,3.908695697784424,0.4921078085899353,4.496066570281982,3.7410476207733154,3.040242910385132,0.8835341334342957,3.093937873840332,-0.7628989815711975,2.7316558361053467,2.2696571350097656,3.4740521907806396,2.4683151245117188,2.0933678150177,-0.5611281991004944,9.44307804107666,3.9298393726348877,4.029485702514648,5.038763046264648,6.409469127655029,4.31594181060791,2.7167606353759766,4.22630500793457,4.81479549407959,9.509461402893066,3.295248508453369,2.9184277057647705,0.018947558477520943,-0.7835429310798645,3.609635829925537,1.0191209316253662,1.3999340534210205,2.7410831451416016,4.270188331604004,2.774383068084717,2.1639633178710938,-0.5126113295555115,3.305424451828003,3.206308603286743,2.5218982696533203,-0.3581778109073639,6.455567836761475,3.142061948776245,1.3201876878738403,-0.7106675505638123,3.70470929145813,-0.6801403164863586,6.543298721313477,0.8176979422569275,-0.4579780697822571,1.1578645706176758,2.809270143508911,2.259780168533325,6.654009819030762,2.845787763595581,2.4020776748657227,8.665440559387207,2.649505853652954,2.0431594848632812,1.1461529731750488,4.999261379241943,10.790095329284668,3.497234344482422,6.0124077796936035,2.7141270637512207,5.081248760223389,1.7347743511199951,-0.29330432415008545,2.5720860958099365,-0.6317538619041443,-1.0733500719070435,5.297330856323242,3.405258893966675,2.053813934326172,2.9066171646118164,-0.701240599155426,3.9835875034332275,6.324169635772705,-0.21720360219478607,0.5159730315208435,0.5739434957504272,4.9764509201049805,-0.4684773087501526,1.5044893026351929,1.2369580268859863,-0.08959460258483887,2.107665777206421,3.5460190773010254,4.804166316986084,2.917085647583008,3.1495468616485596,4.050593852996826,2.5357441902160645,1.2847169637680054,3.562058925628662,2.2719740867614746,1.2382539510726929,7.582711696624756,2.561662435531616,5.3285932540893555,-0.06423325091600418,5.144815921783447,-0.5168576836585999,4.895424842834473,1.4056785106658936,3.2990236282348633,1.4649854898452759,0.23655866086483002,2.1093130111694336,3.6911771297454834,1.711564302444458,1.742671012878418,2.3590023517608643,2.1370861530303955,2.3125178813934326,3.1364328861236572,2.0330185890197754,3.3851752281188965,4.759312152862549,3.474966526031494,0.9765344858169556,3.177342414855957,3.366304874420166,4.4077677726745605,2.379960536956787,2.2074058055877686,2.703744649887085,5.885059356689453,2.1417529582977295,0.33643075823783875,2.1296157836914062,2.124053716659546,1.5195825099945068,-0.7651962637901306,4.286884307861328,4.770843029022217,4.3053154945373535,3.218874216079712,2.5731163024902344,4.211413860321045,4.845631122589111,-0.6054674983024597,1.3684906959533691,0.5917707681655884,5.1379547119140625,1.9939751625061035,2.5245871543884277,5.528827667236328,5.018157958984375,2.290579319000244,3.2789247035980225,3.2634289264678955,1.6061416864395142,1.704317331314087,3.9155449867248535,0.4886341989040375,2.859119176864624,1.150667428970337,4.357973575592041,1.3879141807556152,3.016855478286743,5.400867462158203,3.438671350479126,1.767899513244629,4.740850925445557,1.9433461427688599,3.15675950050354,4.363759517669678,2.019911289215088,2.294084310531616,3.447047472000122,3.603928804397583,-0.05842672288417816,2.358041524887085,0.7310470342636108,4.112913608551025,4.918242454528809,-0.6404012441635132,4.6228814125061035,2.1607511043548584,1.9742584228515625,2.2772300243377686,1.6661577224731445,3.9359006881713867,1.182357907295227,0.40020477771759033,0.6431456208229065,1.5864760875701904,5.555006504058838,4.7451910972595215,2.5751304626464844,3.2564210891723633,7.5486650466918945,5.116017818450928,-0.5008611679077148,3.038048267364502,2.6174957752227783,0.7476288676261902,8.0807523727417,4.187831878662109,1.7453685998916626,2.0919106006622314,7.480268955230713,3.304558515548706,3.180537700653076,0.8997377753257751,1.7750760316848755,5.635772228240967,3.9915828704833984,2.0548338890075684,3.4169416427612305,-0.45008838176727295,1.9717971086502075,1.1938589811325073,5.745707035064697,2.8597774505615234,1.3119912147521973,1.594801425933838,1.4389009475708008,3.1361725330352783,2.036329746246338,1.6745141744613647,-0.931057870388031,6.3167643547058105,1.1323285102844238,1.9814459085464478,1.227208137512207,3.3852829933166504,3.432659149169922,2.9232242107391357,-0.1393352597951889,0.10274843871593475,2.8857510089874268,2.5339620113372803,3.5525856018066406,1.4201560020446777,1.9762312173843384,2.0278713703155518,1.2442723512649536,2.12849760055542,5.107454299926758,2.139822483062744,2.1341607570648193,3.043966293334961,1.2411997318267822,1.8820476531982422,0.31497952342033386,4.581572532653809,4.682687759399414,4.381984710693359,2.8229780197143555,1.5288161039352417,1.7525421380996704,3.7423253059387207,2.028230905532837,1.9441725015640259,2.501119613647461,4.453708171844482,5.927759647369385,2.0344412326812744,1.4089715480804443,0.7985642552375793,2.852033853530884,4.9595866203308105,0.5998929738998413,2.4687907695770264,3.0285515785217285,3.28060245513916,3.1294515132904053,3.2926249504089355,4.690545082092285,2.506497383117676,2.0550990104675293,3.2717936038970947,2.294524669647217,2.449291706085205,1.1550164222717285,1.6829102039337158,2.1386961936950684,2.42874813079834,1.4072922468185425,1.7280874252319336,3.657829523086548,1.5314370393753052,1.349040150642395,4.6662116050720215,5.146623611450195,3.4381539821624756,1.7625569105148315,-0.09481093287467957,2.12890362739563,3.6917150020599365,3.281463623046875,3.214104413986206,4.966976165771484,3.8981597423553467,5.145144939422607,2.983297109603882,1.2492436170578003,3.663353443145752,7.752966403961182,1.278995156288147,1.5355080366134644,2.840747356414795,2.6716296672821045,2.0869767665863037,2.1746513843536377,7.3596906661987305,2.0574917793273926,-0.5935118198394775,4.369337558746338,2.6031911373138428,1.6391340494155884,5.034239768981934,3.2614619731903076,0.9179897308349609,3.3680453300476074,6.056491851806641,1.9526128768920898,-0.42874106764793396,0.908230185508728,1.7906321287155151,2.1348180770874023,-0.7423506379127502,2.080033540725708,0.5075753331184387,-0.8651211261749268,2.9914629459381104,2.5596883296966553,2.3339149951934814,0.8496078848838806,4.316155910491943,4.399328708648682,4.822131633758545,5.347513675689697,3.0366625785827637,1.2620129585266113,2.5015828609466553,3.3294293880462646,3.507413864135742,2.5036892890930176,3.0845398902893066,3.329390287399292,0.15845642983913422,5.638746738433838,-0.9897906184196472,1.1137109994888306,6.880943298339844,0.36923012137413025,2.0304789543151855,2.897155523300171,2.726207971572876,1.217093586921692,3.281679630279541,4.558522701263428,-0.24597345292568207,2.2840023040771484,3.2774343490600586,2.3251965045928955,8.979341506958008,3.0091054439544678,3.058615207672119,1.7119967937469482,3.597827911376953,2.7889456748962402,1.7005224227905273,1.626076579093933,3.725630521774292,2.1454360485076904,0.9846069812774658,0.3102670907974243,2.2912442684173584,2.547423839569092,3.1914162635803223,3.162680149078369,2.5269289016723633,3.512662887573242,5.509218215942383,2.34438419342041,5.003268718719482,-0.859886646270752,4.09927225112915,5.132739543914795,4.737894535064697,2.913491725921631,0.07771182805299759,1.9668160676956177,5.458420276641846,0.14753486216068268,1.3068182468414307,2.975698232650757,3.4632344245910645,1.4562695026397705,4.031392574310303,6.93568229675293,3.091346502304077,4.300180435180664,2.9438202381134033,2.788332223892212,4.324401378631592,6.041707515716553,3.4004292488098145,1.3900405168533325,6.486593723297119,1.6410257816314697,2.6473069190979004,-0.20871300995349884,4.915464878082275,2.2175862789154053,4.181419849395752,5.444207191467285,5.501378059387207,1.629418134689331,3.3799352645874023,2.057499408721924,2.2392098903656006,0.9312129616737366,2.2356457710266113,5.3524956703186035,2.541335105895996,3.0809266567230225,1.23099946975708,5.740902900695801,2.6391170024871826,0.10164015740156174,3.784698009490967,-0.3946470618247986,6.878121376037598,3.1570520401000977,2.901174545288086,3.648061990737915,4.271656036376953,4.305355548858643,2.5892064571380615,-0.6326379179954529,2.113736867904663,3.583928108215332,1.4909930229187012,-0.646437406539917,0.4874488115310669,4.477059364318848,4.332922458648682,2.791440963745117,4.375240802764893,1.306403636932373,0.8228186964988708,2.7374818325042725,3.045862913131714,5.426605701446533,4.657811164855957,3.6058576107025146,3.618522882461548,5.920583248138428,2.581857919692993,4.409670829772949,4.149757385253906,1.8381699323654175,2.083752393722534,4.228302955627441,2.1662299633026123,1.9625554084777832,8.683506965637207,1.845514178276062,-0.48606303334236145,-0.42576462030410767,0.7037720680236816,4.758606910705566,1.7151740789413452,3.1651594638824463,2.329672336578369,0.13600194454193115,2.6689040660858154,4.186290264129639,3.0464272499084473,0.7142456769943237,5.315274715423584,5.439260005950928,3.7464842796325684,2.835850954055786,3.441624402999878,2.0473225116729736,3.4591803550720215,4.653266906738281,2.0767040252685547,0.9469225406646729,3.786943197250366,4.1480536460876465,2.0194287300109863,1.1108187437057495,0.47393980622291565,1.5942373275756836,0.3176659047603607,3.790403366088867,2.723771095275879,1.4194281101226807,3.045070171356201,4.884429454803467,1.4430147409439087,7.640011787414551,2.0724923610687256,3.447449207305908,5.375932693481445,8.748147964477539,0.6126971244812012,-0.7703566551208496,5.031406879425049,4.663510799407959,1.3196213245391846,4.692344665527344,-0.33527466654777527,2.903183937072754,4.636514186859131,4.432740211486816,2.563962936401367,1.77519953250885,4.4670586585998535,2.781994104385376,0.415193110704422,7.664178371429443,1.878907561302185,2.4655163288116455,3.407301902770996,2.4537875652313232,0.574810266494751,8.355316162109375,2.794337749481201,2.983433723449707,2.8102211952209473,2.88862943649292,2.44297194480896,6.638998508453369,6.661590099334717,6.763479709625244,1.4747917652130127,3.7587497234344482,-0.06291982531547546,9.860672950744629,1.6640962362289429,2.118936061859131,2.901423215866089,6.93006706237793,5.7559990882873535,4.171246528625488,1.6943198442459106,1.8584448099136353,7.773507118225098,1.570264458656311,0.07163481414318085,8.325221061706543,4.796176433563232,2.232422351837158,6.4673051834106445,1.9163432121276855,3.1937203407287598,2.695770740509033,-0.029093420132994652,5.442978382110596,2.930899143218994,0.9870800971984863,4.944797515869141,0.9889089465141296,-0.9096977114677429,5.522445201873779,3.8742072582244873,3.257446527481079,1.2835839986801147,2.815391778945923,7.00549840927124],"y":[-0.4999166429042816,-0.9995648860931396,2.9526093006134033,2.96543550491333,0.3441499173641205,1.5738354921340942,-0.010994689539074898,-1.925187349319458,-0.628126859664917,-3.2088472843170166,-1.1915395259857178,1.9804949760437012,3.6576013565063477,3.1807515621185303,0.8717206120491028,-2.2235541343688965,-1.0890785455703735,-0.29913225769996643,-1.9937018156051636,-0.9605135321617126,0.8186238408088684,-0.912611186504364,-1.572332501411438,-0.5782598257064819,-0.5001614689826965,1.5112918615341187,2.296083927154541,-1.9940149784088135,-2.0930895805358887,3.258596420288086,-1.5259772539138794,-1.206661581993103,0.2881733477115631,1.2927967309951782,0.35453206300735474,0.6707078218460083,-0.9097683429718018,2.342705249786377,1.8471735715866089,-2.6831130981445312,-1.0192735195159912,0.8303160667419434,3.360485792160034,-3.9382224082946777,0.45247986912727356,1.758266806602478,-0.5813565850257874,-3.7044804096221924,-0.30048519372940063,-3.203430652618408,-3.2866780757904053,0.6016814112663269,-0.42031946778297424,0.10291938483715057,-2.925314426422119,2.416508913040161,-1.5842429399490356,2.787475109100342,2.3018767833709717,-2.06850266456604,2.843353271484375,-0.30091387033462524,0.2849205434322357,3.2642300128936768,-0.1783987581729889,1.0903903245925903,0.6726414561271667,-1.7661758661270142,-0.6007004380226135,-1.169256567955017,-1.378426432609558,-2.3420629501342773,-2.1908164024353027,-0.2733565866947174,0.3524336516857147,-1.7193645238876343,-1.548160433769226,0.6036509275436401,-1.1021065711975098,0.5337811708450317,1.3028197288513184,-3.8353140354156494,-0.35559985041618347,0.9108485579490662,0.3217433989048004,1.355023741722107,-2.5052738189697266,-2.189547061920166,-1.954661250114441,1.6009254455566406,3.350414514541626,1.2545888423919678,-1.6641077995300293,2.108065605163574,-2.1387112140655518,-0.4905029237270355,-2.6169419288635254,-0.4375017285346985,-0.9706820845603943,-1.724829077720642,2.735809087753296,-1.299800157546997,-0.7379482984542847,-0.25754013657569885,-2.596238136291504,1.6675413846969604,-0.8730536103248596,-2.8739960193634033,-1.7226141691207886,-1.4004483222961426,0.8570408225059509,-1.2156460285186768,-1.5004315376281738,0.9227291941642761,-0.41020798683166504,-3.294429063796997,2.730483293533325,0.4939305782318115,-0.26646023988723755,-0.026087703183293343,-0.26701033115386963,2.391633987426758,-0.4566006362438202,-0.8860872983932495,3.683472156524658,-4.962260723114014,3.381976366043091,-1.1297792196273804,0.8501618504524231,2.5329301357269287,-0.8753179907798767,-0.09611792862415314,0.2249263972043991,1.4662407636642456,1.6960402727127075,-0.8250957131385803,-0.6304759383201599,-0.3696855306625366,-3.937734603881836,-0.5216841697692871,-2.2677979469299316,2.812196731567383,0.43782296776771545,1.0417144298553467,-0.49623221158981323,-2.9863553047180176,-1.1480509042739868,-1.4894754886627197,-0.8099901676177979,0.9070239067077637,-0.8991022706031799,-0.6285950541496277,-0.8220548629760742,-2.5840537548065186,1.6700464487075806,2.393507242202759,-1.8226282596588135,1.0204064846038818,1.6525280475616455,-2.625401020050049,-2.7557084560394287,-1.2357717752456665,0.0575631782412529,-2.193094491958618,2.482053279876709,-3.334594488143921,-0.514790952205658,-2.1614487171173096,-0.8561035990715027,-1.0725488662719727,1.20437753200531,-1.0545116662979126,2.369199514389038,-0.5848670601844788,-2.4248273372650146,1.4198793172836304,2.813886880874634,-2.3563621044158936,-2.984661102294922,2.898621082305908,-1.3816109895706177,1.0435454845428467,-3.2519497871398926,-2.6020638942718506,2.8111414909362793,0.3148891031742096,0.4022388458251953,-0.623681366443634,0.35848432779312134,-1.4799184799194336,-0.905360221862793,-0.022089742124080658,-0.5537223219871521,-0.9786798357963562,0.14677581191062927,1.7854466438293457,2.0428287982940674,-0.7568234801292419,-1.1962844133377075,-2.428230047225952,-2.5597925186157227,-1.6014310121536255,2.595319986343384,-3.0946319103240967,-1.5225836038589478,1.8134175539016724,-0.9354662895202637,-1.4738773107528687,3.5762054920196533,-2.2114992141723633,4.758370399475098,-0.8825497627258301,-1.6282622814178467,-0.9150902032852173,-1.1567519903182983,3.5009899139404297,-1.0515750646591187,-0.27949294447898865,-0.35349562764167786,-2.227454662322998,-0.8293540477752686,-2.3374104499816895,-0.08700442314147949,4.613163948059082,0.5094059109687805,-1.8439782857894897,-1.379488229751587,-0.9441361427307129,1.7339892387390137,-2.4349143505096436,2.202857255935669,-2.4938457012176514,-1.2732442617416382,-0.02472691796720028,-1.2993112802505493,-2.1918978691101074,-0.7684042453765869,-0.8280614018440247,1.6516337394714355,3.476243019104004,0.5184178352355957,4.2862772941589355,-1.7728286981582642,2.688345193862915,0.5165436863899231,-2.3177428245544434,3.662611484527588,0.9978325366973877,-3.363476514816284,-1.6049401760101318,0.01842256635427475,1.4565919637680054,-0.23000630736351013,-0.4816649258136749,1.2140583992004395,1.804436445236206,2.1234381198883057,-0.3863289952278137,-1.1800628900527954,0.06485524028539658,0.34670698642730713,-0.9201310873031616,-1.3189094066619873,2.212533712387085,-3.009335517883301,0.24848130345344543,3.273169994354248,-0.07740584015846252,-1.994720697402954,-1.102020025253296,-1.919753074645996,2.5237538814544678,0.24807153642177582,-1.0870616436004639,-1.8270004987716675,-0.7942315340042114,-0.6058139204978943,-2.485985279083252,1.1952385902404785,2.7286341190338135,0.8143181204795837,4.163615703582764,-2.7300519943237305,-3.097884178161621,1.034566044807434,-2.3996074199676514,3.7234671115875244,-2.5764245986938477,0.5875794291496277,-1.102529525756836,-1.1941394805908203,-1.1015973091125488,-0.6057844758033752,2.744762420654297,-1.9648642539978027,2.685704231262207,3.501483917236328,2.689941167831421,-0.8932754397392273,-1.0228253602981567,1.8395557403564453,1.220335602760315,-1.089165210723877,2.032665967941284,-0.21683040261268616,0.004822185728698969,-1.8681100606918335,1.5773621797561646,-2.8832061290740967,3.3290014266967773,-0.9123578667640686,0.46114081144332886,-1.6053004264831543,-1.5372240543365479,-1.0800745487213135,0.3964190185070038,-1.985133409500122,-0.34696388244628906,2.786695718765259,-1.5518357753753662,-1.8383585214614868,-0.6929917335510254,-2.3343441486358643,-3.1725237369537354,-1.2512017488479614,1.9319734573364258,0.5079787373542786,-0.5671571493148804,-1.0034403800964355,0.9144561886787415,3.136564016342163,2.4724109172821045,-1.1759889125823975,-2.872871160507202,-2.4087679386138916,2.7544703483581543,1.900687575340271,-1.5874927043914795,0.6431804299354553,-0.15524771809577942,-0.4296777546405792,-1.6487846374511719,0.5565253496170044,-1.6556060314178467,-1.6405057907104492,-1.0871171951293945,2.246053457260132,0.6493816375732422,-2.9905505180358887,-1.2407665252685547,-2.9492342472076416,-1.382590413093567,-1.8950942754745483,-0.23607328534126282,-1.2108874320983887,-2.8564155101776123,-1.7403221130371094,2.746870994567871,-1.1174190044403076,-1.3029018640518188,-0.2370690256357193,4.2803850173950195,0.3137272298336029,2.7908284664154053,2.5853142738342285,-0.2767484188079834,-3.158107042312622,0.08969837427139282,-0.13005730509757996,-0.6053734421730042,-0.20506545901298523,1.1019744873046875,-1.0875988006591797,0.9881799817085266,0.09398351609706879,-0.49085748195648193,-0.9612508416175842,2.0669236183166504,0.1036176085472107,-2.126723051071167,1.9096620082855225,-0.3550659418106079,1.8209552764892578,-0.7984211444854736,2.6262784004211426,-1.0549732446670532,-0.2403886616230011,0.24906803667545319,2.3849849700927734,-0.6363025307655334,-0.6599435210227966,0.20455186069011688,-2.9691994190216064,2.7565712928771973,-2.1442954540252686,0.17649120092391968,-1.9255304336547852,0.5842394828796387,-1.9643502235412598,-0.054954759776592255,0.45656678080558777,0.2436787337064743,2.0268235206604004,-2.003603458404541,1.8793635368347168,-3.258305311203003,-2.1185812950134277,-1.2967063188552856,-2.296302318572998,-0.33540526032447815,-1.3707059621810913,2.5692546367645264,2.4013049602508545,4.020356178283691,0.5248599648475647,-1.7207897901535034,-0.58937007188797,3.657021999359131,-0.7695206999778748,-2.585512638092041,2.7770214080810547,-1.4503830671310425,-1.5080983638763428,-3.725588321685791,3.818690299987793,3.4964993000030518,2.5724010467529297,2.4062156677246094,-3.2660093307495117,-1.7368782758712769,-2.691499948501587,-5.146242618560791,2.0976040363311768,-0.6682503819465637,0.0005551822832785547,1.3045772314071655,1.0093239545822144,3.8470377922058105,-1.3083915710449219,-1.5278385877609253,1.782278299331665,-0.48694705963134766,-2.2345597743988037,0.9382337331771851,-0.6712337136268616,-1.7639816999435425,-3.4268739223480225,-1.0320615768432617,-1.8868602514266968,0.6207371950149536,3.0944740772247314,2.0407347679138184,-2.570934295654297,2.7831525802612305,-2.395840883255005,-2.0689585208892822,-2.267435312271118,-2.12688946723938,-0.9124305844306946,4.3386359214782715,3.064284086227417,-1.4455757141113281,0.5488772988319397,3.2389302253723145,-0.47203633189201355,1.8082419633865356,0.21981987357139587,-0.9548463225364685,2.6518828868865967,-2.0076584815979004,2.8437421321868896,-1.1448092460632324,1.7275316715240479,-0.5158990025520325,-0.9538446664810181,-1.5085796117782593,-0.8931000828742981,-1.267328143119812,-3.1491739749908447,-1.321166753768921,0.8539032340049744,-0.38097766041755676,1.1883659362792969,1.8672544956207275,-1.813637137413025,-0.4813635051250458,-1.9095066785812378,1.5107890367507935,-1.2647926807403564,0.8902689814567566,-0.14138953387737274,-1.2923555374145508,4.059517860412598,-1.2853095531463623,-2.578555107116699,-1.5513732433319092,-2.069467782974243,0.6564943194389343,-0.903069257736206,-2.5837113857269287,-2.882828712463379,1.4053974151611328,4.020778656005859,-0.8944393396377563,1.954156517982483,2.3331828117370605,-2.5311808586120605,1.7212883234024048,-2.547030448913574,2.8162267208099365,0.05007246881723404,-0.8908416628837585,-0.658982515335083,4.995702743530273,0.02632680907845497,-0.00027862400747835636,-1.2706116437911987,-2.985355854034424,4.014029502868652,1.7453341484069824,-0.14359150826931,-2.3905954360961914,-0.9408485889434814,-1.5202752351760864,-2.2725696563720703,3.938631296157837,0.6967381238937378,-0.47319495677948,2.5633134841918945,0.4756588339805603,-0.9265407919883728,-1.6904304027557373,-0.026231681928038597,-0.6951426267623901,-3.263864278793335,-0.671654462814331,-2.5183823108673096,-0.4422777593135834,2.995496988296509,-1.561482548713684,-0.4497705399990082,-2.215960741043091,0.23304206132888794,-0.7063043713569641,-1.6135356426239014,0.12246499210596085,2.9357683658599854,-0.7343543767929077,1.030344843864441,0.44697442650794983,1.3938536643981934,1.8418262004852295,4.367084980010986,0.7451035976409912,1.8065357208251953,-1.3020082712173462,0.4252311587333679,2.500231981277466,-2.677891969680786,2.6427958011627197,-2.538011074066162,-0.2721410095691681,-1.164934515953064,-4.023380279541016,1.336818814277649,-0.9528550505638123,0.8177126049995422,0.17043046653270721,-0.32421863079071045,-2.6960244178771973,2.652141809463501,1.9069620370864868,-2.1997621059417725,-2.2231578826904297,-1.7723510265350342,-4.2597737312316895,2.5467395782470703,-1.9940457344055176,0.2068789303302765,2.3081302642822266,2.511073350906372,2.3663344383239746,-0.08900877088308334,-0.4018172323703766,2.1163554191589355,-0.6772435307502747,0.9483248591423035,4.293705940246582,-2.860144853591919,3.477365016937256,2.4877164363861084,1.9133353233337402,-0.4442484378814697,2.8434946537017822,1.7821786403656006,-1.1322118043899536,-1.984304666519165,-0.9367099404335022,4.280971050262451,1.5115915536880493,4.333094120025635,-0.23149116337299347,3.9176599979400635,-1.2373324632644653,0.5942230224609375,-1.1554906368255615,1.221136212348938,-2.362673759460449,-2.793156623840332,-3.433147668838501,-0.7601767778396606,2.6329078674316406,-0.10289733856916428,-3.8511526584625244,1.615832805633545,-1.1722990274429321,-0.4866655766963959,0.5201659798622131,0.2606472969055176,-0.3763454854488373,-0.9401654005050659,1.305742621421814,1.510367512702942,-1.376381516456604,-0.3166051208972931,-0.34440839290618896,-1.252020239830017,3.3784396648406982,-2.593808650970459,2.581064462661743,-1.0306200981140137,-0.1050100177526474,-2.0957939624786377,-1.9300535917282104,0.7870054841041565,2.52236008644104,-2.272007465362549,2.7528748512268066,-4.019747257232666,1.0959478616714478,-0.48464804887771606,1.737605094909668,-1.9080184698104858,-1.9474422931671143,-2.904813528060913,-2.2238264083862305,0.774151086807251,2.8890938758850098,0.10403446853160858,-1.3371233940124512,-3.414323091506958,-3.688687324523926,5.0011305809021,-0.12943114340305328,-2.7527053356170654,1.0286242961883545,-0.873410165309906,2.2407758235931396,-2.613769054412842,0.9929900765419006,-0.270745187997818,-0.5915976762771606,-2.2830653190612793,1.546539068222046,1.4276009798049927,1.0434209108352661,-1.8599653244018555,1.8609262704849243,-1.6832396984100342,0.9896702170372009,-0.42068350315093994,-0.43924522399902344,-0.6888132691383362,-0.6480809450149536,3.2243854999542236,-0.012615119107067585,-1.621953010559082,2.375272750854492,-1.1593393087387085,3.6507318019866943,2.99955415725708,-2.2867772579193115,3.745068073272705,0.11553362011909485,-0.7078191637992859,-0.6834205389022827,2.790454864501953,1.9237643480300903,0.15130911767482758,1.1259897947311401,-3.742143154144287,0.31119027733802795,3.669121503829956,-1.3467754125595093,0.876679003238678,-0.3408825695514679,0.8167006373405457,0.6005198359489441,-1.8504408597946167,3.203645944595337,0.27541181445121765,-0.910683810710907,-1.384386420249939,0.5598803758621216,1.2833607196807861,-0.937029242515564,1.2847479581832886,-0.004491768777370453,1.0105172395706177,3.8628506660461426,1.8348170518875122,3.372795343399048,3.4498510360717773,-0.5924449563026428,-0.4087315797805786,-0.4959441125392914,-0.865475594997406,-1.699647068977356,0.9194536209106445,2.427487850189209,-0.2640490233898163,-0.3353789746761322,-3.6586196422576904,3.889127016067505,-2.0755109786987305,4.03864860534668,-0.5776345133781433,-0.33716335892677307,-1.9932527542114258,-0.9268237352371216,2.5810678005218506,-2.0080525875091553,-1.507414698600769,1.3520363569259644,3.361912727355957,1.4275447130203247,2.3962643146514893,-0.5909385085105896,-2.2934553623199463,-1.6335302591323853,1.2952605485916138,0.17452256381511688,-2.009807586669922,-0.8260323405265808,-2.0393564701080322,1.0285842418670654,-0.9603771567344666,1.0447895526885986,-3.2971677780151367,-2.0596468448638916,-1.3349744081497192,-2.7574288845062256,2.302384853363037,1.191330909729004,-0.7077513933181763,-0.5194718241691589,2.09257173538208,1.6157201528549194,-1.4952585697174072,0.5939007997512817,-1.3732640743255615,-1.5457805395126343,4.115506172180176,3.2639477252960205,-3.1789073944091797,0.11947590857744217,-0.5864772796630859,-1.051322340965271,-2.690167188644409,3.1499686241149902,-4.2352166175842285,3.611082077026367,0.2483370006084442,-0.6328547596931458,0.7158899307250977,1.483437418937683,-1.3121193647384644,1.0340901613235474,2.7720518112182617,2.3481051921844482,-1.4325215816497803,1.2957148551940918,1.6955674886703491,-2.5994644165039062,-0.8735038638114929,1.3183202743530273,-0.6559824347496033,0.2090832144021988,-1.1272660493850708,-2.0392284393310547,1.4787776470184326,3.1661605834960938,-1.0754766464233398,0.7893194556236267,0.43228572607040405,-1.6984195709228516,-1.9406203031539917,-1.6878403425216675,-2.6931169033050537,2.575570821762085,-0.49638867378234863,1.1826653480529785,-0.8880078792572021,2.5229432582855225,-2.3118276596069336,-0.23581448197364807,1.3191815614700317,0.36596396565437317,0.9832201600074768,-0.5639508962631226,1.946724534034729,-3.4243087768554688,-3.1317265033721924,-4.50132417678833,-1.9439036846160889,-0.08170947432518005,1.0665440559387207,0.8128482103347778,-2.7586917877197266,-1.1242114305496216,-3.2458088397979736,1.2066795825958252,-0.15344126522541046,1.3916168212890625,-0.6364612579345703,1.0268136262893677,1.0564765930175781,-0.9086875915527344,-2.6101415157318115,-0.8596712350845337,-0.009730223566293716,-0.6709616184234619,-0.14229150116443634,-0.8497338891029358,-0.3694581091403961,1.4086204767227173,-3.8176844120025635,-1.5129234790802002,3.38991641998291,2.5899484157562256,-1.2807042598724365,-2.5198302268981934,-1.1165072917938232,2.1179192066192627,0.06462196260690689,-0.2788315415382385,-1.223693609237671,-0.832686722278595,3.700634717941284,-0.25729241967201233,1.2838767766952515,1.2951993942260742,4.391486167907715,-1.2911920547485352,1.847605586051941,0.7166462540626526,0.6642729043960571,2.9359898567199707,-1.9858551025390625,-2.436108112335205,-0.17966517806053162,-1.526248812675476,-1.3556541204452515,-1.899590015411377,0.046706438064575195,0.0473686121404171,0.7095999121665955,2.8327951431274414,-0.44329866766929626,-2.81524395942688,2.9126694202423096,-1.2944934368133545,0.8802244067192078,-0.31619054079055786,0.16133727133274078,2.3270366191864014,-0.6288068890571594,-2.773153305053711,-0.9201298356056213,2.5960988998413086,-3.559751510620117,-3.887089729309082,3.403040647506714,-1.0165210962295532,-3.096824884414673,1.7916361093521118,-0.8505191206932068,-2.8147640228271484,-2.876591682434082,-1.1049137115478516,0.35523951053619385,-0.3809010684490204,1.615278720855713,-0.24752004444599152,-0.8520855903625488,2.020421266555786,0.7366855144500732,-4.020107269287109,-0.24575699865818024,-1.0501205921173096,0.608716607093811,-0.9260987639427185,3.160917282104492,-0.6149991154670715,2.4595048427581787,0.6576799750328064,2.0175528526306152,2.6509315967559814,-1.6876769065856934,0.15586863458156586,-2.7561826705932617,-0.9828624129295349,1.8304001092910767,-2.316464900970459,-1.290773868560791,1.0043115615844727,-1.6517829895019531,0.7603568434715271,-2.418264150619507,-1.8073753118515015,-1.1562074422836304,2.485645294189453,-2.546921730041504,0.33110836148262024,1.4342156648635864,2.5595929622650146,-0.34994491934776306,-0.2608957290649414,-0.14602063596248627,-1.3604727983474731,2.1142754554748535,-0.6608256697654724,-1.950492262840271,-0.6825324892997742,3.2355856895446777,3.6058287620544434,3.8124241828918457,-1.9828649759292603,-1.7546712160110474,1.2440186738967896,4.235235691070557,0.6124923229217529,-0.5007534623146057,-0.19757622480392456,-1.6684389114379883,2.330843687057495,-3.7305498123168945,0.3480972945690155,-0.7892158031463623,-2.2955801486968994,-2.0546226501464844,-0.8942037224769592,3.5806305408477783,-1.6269575357437134,-1.5392776727676392,3.5650343894958496,-0.07159189879894257,0.8030321598052979,-0.9441645741462708,-0.6212229132652283,-0.9848201870918274,0.17319081723690033,3.285722494125366,-0.35810595750808716,2.965155839920044,-1.6644353866577148,2.5086758136749268,-0.8808861970901489,1.4090968370437622,0.00801781751215458,-1.4522819519042969,3.570756435394287,0.7227106690406799,-3.8760616779327393,-0.11965632438659668,-0.16936199367046356,-0.953456461429596,0.3001929819583893,-0.38562849164009094,-1.0061382055282593,-0.4439075291156769,1.2989648580551147,2.446702003479004,-1.4514952898025513,-2.8670032024383545,-0.2861049175262451,0.13956940174102783,-2.0381054878234863,-2.0688538551330566,3.0232937335968018,2.2650625705718994,-0.9987683892250061,0.7170801162719727,-2.5026049613952637,2.9030113220214844,-0.9695411920547485,0.10187290608882904,2.5216028690338135,-0.8970892429351807,-1.383225679397583,-1.3325735330581665,0.5014504790306091,-0.38145211338996887,-1.0961729288101196,-1.8392726182937622,1.5220763683319092,-1.2764570713043213,-1.012331247329712,-0.32307732105255127,2.6125142574310303,-1.5531409978866577,2.711243152618408,1.4950894117355347,3.36257004737854,-1.4448238611221313,1.367590308189392,-2.226619005203247,-3.309736728668213,-3.987534284591675,-1.9534424543380737,0.9245615005493164,2.5758912563323975,-1.2928053140640259,-2.3462884426116943,-0.744493305683136,-1.3681526184082031,2.366006374359131,-0.7992313504219055,-3.2882063388824463,-0.14906708896160126,-2.5913400650024414,-0.9813430905342102,1.2778823375701904,-1.9361339807510376,1.4137216806411743,1.216079592704773,-0.383323609828949,-2.368986129760742,-2.436206579208374,3.951749086380005,-1.3310805559158325,0.3812897205352783,-1.6763228178024292,-3.4959824085235596,1.7265576124191284,3.38008451461792,-0.743593156337738,-0.9197047352790833,-1.2145997285842896,3.244655132293701,-3.226524829864502,-1.428525447845459,-0.4476970136165619,-2.7639126777648926,4.183582305908203,2.67226243019104,-1.6975599527359009,-0.8005856275558472,-1.6677238941192627,-2.828495502471924,-1.2148401737213135,2.2251954078674316,1.2905741930007935,-3.3163390159606934,-1.326906681060791,-0.902688205242157,1.0740305185317993,0.5565146803855896,1.5503863096237183,-2.7237491607666016,-1.1312040090560913,-2.2148187160491943,-2.5603344440460205,1.8183159828186035,-1.7966053485870361,-2.0684592723846436,0.5019998550415039,3.1448092460632324,-1.2577711343765259,-1.50795316696167,-0.5910125970840454,1.9732890129089355,-3.5471394062042236,-0.9132934212684631,-0.5581799149513245,3.7516887187957764,-0.9450141191482544,1.130035638809204,-0.5734385848045349,-1.0292713642120361,1.2822051048278809,-2.093082904815674,1.9315032958984375,2.2014269828796387,1.3214457035064697,-1.2092790603637695,-3.0748391151428223,1.8530104160308838,2.43312406539917,0.6601214408874512,3.8860116004943848,1.7339236736297607,0.010980434715747833,-0.7880135774612427,-3.1514816284179688,2.9881467819213867,0.16852882504463196,-0.5294999480247498,-2.7875866889953613,0.21713195741176605,2.3679914474487305,-0.1499393731355667,-2.538166046142578,-1.1093783378601074,0.19382263720035553,-2.1812925338745117,-1.060858964920044,0.058696530759334564,3.3313794136047363,1.5730773210525513,-0.7930281758308411,-1.653234839439392,0.2869279682636261,-1.1370267868041992,4.470583915710449,-0.3995169699192047,0.024571452289819717,-2.6977217197418213,-1.15622079372406,1.4549208879470825,-1.029215931892395,-1.1950955390930176,-0.996424674987793,-0.47279664874076843,-2.0014255046844482,0.007347374688833952,3.7561657428741455,-0.4086318016052246,-0.41552734375,2.1698899269104004,-1.1922637224197388,4.5600385665893555,-1.7306326627731323,-0.9351528882980347,-2.2948760986328125,0.1398831456899643,-0.45049870014190674,-2.7890796661376953,-0.5656946301460266,0.18749675154685974,2.763230800628662,-1.066024661064148,-0.10763929039239883,1.4586448669433594,-0.18048472702503204,-1.1853612661361694,2.955333709716797,2.63865327835083,1.1028385162353516,3.0907232761383057,3.6749162673950195,-3.1814498901367188,0.9183063507080078,3.7792532444000244,-3.393361806869507,-1.9067294597625732,-3.922786235809326,1.0674809217453003,3.7289223670959473,-3.969593048095703,-0.40868350863456726,-1.1380318403244019,-1.934471607208252,-0.877521276473999,-0.18553397059440613,-0.8778095841407776,0.14360861480236053,-1.368177890777588,-1.5716581344604492,-0.31027576327323914,3.5284154415130615,1.192869782447815,3.0066590309143066,-1.506507396697998,-0.034988708794116974,2.261935234069824,-1.4583089351654053,3.430818796157837,0.027757618576288223,-1.2302837371826172,-0.976207435131073,-2.94154953956604,0.6656013131141663,1.2238032817840576,2.018104076385498,-2.0887134075164795,-1.0599968433380127,-2.2026584148406982,-2.750366687774658,-0.37065550684928894,-2.527038335800171,3.069014310836792,3.6320595741271973,-1.3903309106826782,-1.4155815839767456,1.6402863264083862,1.6542364358901978,-0.42403268814086914,1.6997663974761963,-1.727730631828308,1.1094080209732056,1.4860725402832031,-3.474609375,-0.1611231118440628,-1.7523510456085205,-0.961591362953186,-1.5342419147491455,-0.14323380589485168,2.459027051925659,-1.1031992435455322,0.43654003739356995,2.1927261352539062,-2.2132253646850586,-1.5288687944412231,2.4771969318389893,1.320495367050171,0.19293047487735748,-1.0382192134857178,-1.956618070602417,-0.033711496740579605,-2.70819091796875,-1.7157446146011353,-0.9068832397460938,-0.4275990426540375,-2.088918447494507,1.5548003911972046,-0.8434582948684692,4.478388786315918,3.994513511657715,-1.9435157775878906,-1.007676124572754,-0.7092257142066956,2.329829216003418,0.9304431676864624,-0.8140900135040283,-1.3322004079818726,2.373314380645752,1.3779689073562622,0.8884598016738892,-0.9348209500312805,-2.1453890800476074,-0.661909818649292,2.7664895057678223,2.4894027709960938,-3.1002016067504883,-3.0061864852905273,-1.5111279487609863,-2.1393468379974365,-2.288763999938965,2.5463337898254395,-0.5015376210212708,-1.3128002882003784,-0.7750223278999329,1.88472580909729,3.0572028160095215,-1.4504444599151611,-0.5810955762863159,3.8289740085601807,-0.42308324575424194,0.26766127347946167,1.9462342262268066,-0.32969388365745544,-0.3886896073818207,-3.2486135959625244,0.7578741908073425,-0.5249766707420349,-1.8117691278457642,-2.6770598888397217,2.800060987472534,-0.08477822691202164,2.5744738578796387,-1.4072035551071167,0.0907614678144455,0.2973640561103821,1.9520214796066284,-2.1250550746917725,2.5730478763580322,-1.3024832010269165,-1.7371124029159546,-2.7898824214935303,-1.2162621021270752,3.0325608253479004,-0.7492194771766663,2.2810754776000977,0.4366079866886139,-3.5578975677490234,-0.6178605556488037,-0.9563187956809998,-0.2011619508266449,-2.337959051132202,3.3333938121795654,-3.1627917289733887,0.6189954876899719,3.947547435760498,3.3480639457702637,-3.753286838531494,-0.9962688684463501,1.9711207151412964,0.3146950900554657,2.361680030822754,1.5334410667419434,-2.2315306663513184,2.2080304622650146,-0.12295634299516678,-2.029221773147583,2.9379074573516846,-1.4054884910583496,-1.236992359161377,-2.018146276473999,-0.8087478280067444,-1.5823100805282593,-0.7014777064323425,-2.19295597076416,2.0798866748809814,-1.1073604822158813,-3.679234266281128,-1.2748993635177612,0.7369210720062256,2.0172719955444336,3.6481435298919678,1.8046501874923706,-3.2438783645629883,2.329314947128296,-2.1832969188690186,-1.5731940269470215,-0.9656360745429993,-0.9466082453727722,-2.893313407897949,-3.0267958641052246,-0.7259365916252136,3.512244701385498,-1.4295368194580078,-2.2354509830474854,-1.0371285676956177,3.609621286392212,3.6402175426483154,1.3089128732681274,-2.493316173553467,-0.788262128829956,-1.6591402292251587,2.8724379539489746,-1.680647850036621,3.3150558471679688,-0.4925394654273987,-1.1153818368911743,-0.6714902520179749,-1.1319373846054077,4.42883825302124,-0.3930191397666931,-2.1788272857666016,-1.6208693981170654,0.5457183718681335,-3.7869484424591064,-1.4775720834732056,2.4585862159729004,-0.12420721352100372,-0.4124617278575897,2.918729305267334,3.4875853061676025,-1.0015894174575806,-0.8327487707138062,1.943534016609192,1.3826566934585571,-1.385412335395813,-2.517387866973877,-1.321946144104004,-0.4886493980884552,-2.7325663566589355,-2.0672004222869873,-1.8686708211898804,2.637674331665039,0.9461100101470947,0.9203464388847351,-3.7983226776123047,-0.7069999575614929,-3.4104347229003906,-2.0854434967041016,-2.434091329574585,0.1878124326467514,-0.004966643173247576,-1.1766291856765747,0.6830537915229797,2.283101797103882,-1.527044415473938,4.02637243270874,-0.8390228748321533,-1.389707088470459,-1.765094518661499,-0.9605599641799927,-0.45646795630455017,2.2454490661621094,1.3386794328689575,-0.08614757657051086,3.541111707687378,0.5089017152786255,-0.839333713054657,-1.168631911277771,0.255676805973053,3.841327667236328,-1.7830312252044678,-0.6936329007148743,-1.5317001342773438,0.16711227595806122,-2.278550148010254,-0.4784155786037445,-2.867410659790039,-1.3359591960906982,0.3844960331916809,-2.3973660469055176,-1.4940999746322632,2.716517925262451,-0.7899717092514038,-1.9458328485488892,1.106647253036499,-0.07642730325460434,3.4487180709838867,3.0277352333068848,-2.163017511367798,-2.6267542839050293,-0.7088490724563599,2.5186359882354736,-0.3105514943599701,-0.784661054611206,-0.5379190444946289,-0.16867370903491974,1.897314190864563,-0.6415956616401672,-2.2144951820373535,-2.23405122756958,-0.06573016941547394,3.730990171432495,-1.7903721332550049,-1.5348436832427979,-1.9517676830291748,-4.249755859375,2.0546627044677734,1.966546654701233,1.112309455871582,-1.075331449508667,-2.982492446899414,0.5221689939498901,-1.1539720296859741,-2.004302501678467,2.26365327835083,-2.3052914142608643,0.15197812020778656,-1.395931363105774,-1.4698654413223267,-2.8886163234710693,-0.4658408463001251,-1.1162066459655762,2.9996910095214844,2.5570974349975586,-1.8572989702224731,2.3387627601623535,-1.1439710855484009,1.525835633277893,-0.6143056154251099,3.1024203300476074,-0.8824816346168518,3.3018288612365723,-0.12636500597000122,-0.08745434880256653,0.9159345030784607,-0.7317326664924622,-2.7938339710235596,2.512629270553589,-0.599044144153595,3.6048784255981445,-0.1665768325328827,2.0862815380096436,0.4237655997276306,-1.970350742340088,-1.0024663209915161,-2.5732035636901855,0.7310978770256042,-3.961864709854126,-1.2623965740203857,1.8070882558822632,2.3622963428497314,-1.4601473808288574,2.919478178024292,-0.8541820645332336,-2.238802194595337,-1.8120930194854736,0.37201687693595886,2.079197645187378,-1.793540596961975,0.5864255428314209,-1.037951946258545,0.05054914951324463,-1.7814112901687622,-0.2844123840332031,-0.022263532504439354,-2.491839647293091,-2.50447678565979,3.37467622756958,-3.550293445587158,-1.2700172662734985,-0.17121629416942596,-0.03507533296942711,-1.518974781036377,-1.037476658821106,-2.901963233947754,-0.8919852375984192,-1.069738507270813,-2.263460636138916,-1.1896145343780518,3.1851589679718018,-0.4911929965019226,-1.8628895282745361,-0.20890282094478607,-0.8494153022766113,4.934940814971924,3.7745065689086914,-0.7309228181838989,2.8799450397491455,-3.507765054702759,4.055958271026611,-3.0505661964416504,1.4802149534225464,0.8424555063247681,1.5765317678451538,-0.48823392391204834,3.6618034839630127,0.29161641001701355,3.227724552154541,1.996846079826355,-0.12026665359735489,2.0001063346862793,-0.29883667826652527,-1.177761435508728,-2.2292208671569824,2.695331335067749,-0.499137282371521,1.8936216831207275,-1.1759146451950073,-1.653069257736206,0.2695494592189789,0.9656310081481934,-1.0163275003433228,-1.9755600690841675,-1.6096080541610718,-1.3789293766021729,-2.336108446121216,0.6751996278762817,0.6941395401954651,2.1361184120178223,-0.20098040997982025,-3.158552646636963,-0.6888075470924377,2.675434112548828,3.409993886947632,-2.181772232055664,-3.3513991832733154,-0.10584025830030441,3.1884407997131348,3.603994131088257,-2.7147862911224365,-0.7164953947067261,3.233096122741699,-1.413631796836853,-1.3776330947875977,-1.2900924682617188,-1.0028107166290283,-2.289992570877075,0.7313668131828308,-1.747014045715332,0.4875994026660919,-1.3997819423675537,-1.0134254693984985,1.6607825756072998,-3.397087574005127,3.3450965881347656,1.994690179824829,-1.1966123580932617,-1.1346415281295776,-1.4818313121795654,1.3078689575195312,-2.6997299194335938,-2.6751201152801514,-2.8851613998413086,0.8304593563079834,2.2092411518096924,-0.27384862303733826,0.677423357963562,-0.8140667676925659,-1.7707934379577637,3.899909019470215,0.7629734873771667,-2.7084991931915283,3.164935827255249,-2.9495694637298584,-2.797502040863037,-3.8592514991760254,-1.2610912322998047,0.21052999794483185,-1.3338828086853027,-0.3893165588378906,2.8693413734436035,-1.2334842681884766,0.11840540915727615,2.94108247756958,0.30522042512893677,-0.28120332956314087,2.099179744720459,-1.7482073307037354,1.0756961107254028,3.006563901901245,1.950211524963379,1.0544164180755615,-1.7878316640853882,0.5411486625671387,1.2034788131713867,3.6234705448150635,-0.13591252267360687,-1.8205920457839966,0.3167230486869812,-2.3058059215545654,-1.3111997842788696,1.3938724994659424,3.7467868328094482,0.675003707408905,1.391312837600708,3.4084701538085938,-1.1825525760650635,-0.8579305410385132,-0.5400359630584717,-0.6519601345062256,0.2956446707248688,-1.472568392753601,-1.4107357263565063,-2.8472282886505127,0.11328746378421783,0.5267332196235657,1.9052629470825195,3.4512104988098145,-2.3913168907165527,1.498305320739746,1.5419092178344727,-1.6726213693618774,1.1187571287155151,-1.643654704093933,-1.240942120552063,2.8105876445770264,1.4441032409667969,3.1397829055786133,-0.22797837853431702,-0.09977017343044281,2.8320257663726807,1.3850504159927368,2.746988296508789,1.2531651258468628,2.9223544597625732,-0.8876886367797852,-1.544822096824646,3.529728889465332,-0.27694764733314514,-1.8493813276290894,-3.6985065937042236,-1.0104458332061768,-0.7797062993049622,3.7149806022644043,-0.5446966290473938,0.6410502791404724,-0.9532166123390198,-2.1316916942596436,0.654557466506958,0.5406128168106079,-0.326047420501709,-1.1256966590881348,1.2116109132766724,-1.045565128326416,-0.3245426416397095,-1.4632413387298584,-2.801485776901245,-1.6426092386245728,0.9501977562904358,-1.4161499738693237,2.1198179721832275,2.395817279815674,2.5930330753326416,-1.581552267074585,-2.0646722316741943,0.814263105392456,0.9344422221183777,-1.4584860801696777,-1.918534755706787,-1.7883597612380981,-2.122119426727295,-1.218747615814209,3.7492916584014893,2.7509539127349854,-0.07653433829545975,1.607303261756897,-2.4545469284057617,-1.657766580581665,-0.8481602072715759,-1.2302262783050537,-0.8834972977638245,0.9107388854026794,-1.0814567804336548,1.3070827722549438,2.428617000579834,-1.1597388982772827,-1.1812357902526855,2.457139730453491,-2.6583685874938965,-0.6069784164428711,0.8684249520301819,3.664764165878296,-2.7641122341156006,-2.245943546295166,-0.6246248483657837,-0.5666614174842834,-0.5744411945343018,-1.7311968803405762,-2.6225969791412354,1.4048666954040527,1.9472017288208008,2.6411664485931396,-1.231478214263916,1.0077072381973267,-1.3308571577072144,-1.3991615772247314,-3.386030673980713,3.0838236808776855,0.7616490125656128,-1.1142423152923584,1.0911160707473755,1.2536647319793701,-2.174825429916382,-2.895871639251709,-2.6339001655578613,-4.794294834136963,-2.1148500442504883,-0.6691490411758423,-1.5525380373001099,3.096369743347168,4.04816198348999,-0.7878483533859253,1.007126808166504,3.9027698040008545,3.305434226989746,-1.5212568044662476,2.732225179672241,-0.01768600009381771,-0.10128629952669144,2.0320050716400146,3.4054818153381348,-0.6359826326370239,-2.6595630645751953,3.8591065406799316,2.0814037322998047,1.7684930562973022,3.385024309158325,-0.4600776433944702,-1.1725281476974487,-1.1765294075012207,-2.0216493606567383,0.5305371880531311,0.09318248927593231,-0.7315199971199036,-4.11953592300415,2.710355043411255,-1.488074779510498,-2.2013893127441406,-0.2541625201702118,1.3682564496994019,-1.733935832977295,-0.31547611951828003,-1.235068440437317,1.5696427822113037,-3.028259754180908,-0.49784910678863525,2.319582223892212,3.5247302055358887,1.022055983543396,-1.390616536140442,-3.1042046546936035,-1.0964019298553467,0.6248159408569336,-0.5745737552642822,3.223026752471924,-0.1869145780801773,1.668089747428894,-3.165703535079956,-2.529639720916748,0.8341472148895264,-0.48591330647468567,-1.6970031261444092,3.3141345977783203,-0.2304893285036087,3.815255641937256,1.5091265439987183,-1.089194416999817,-1.5966676473617554,0.6811369061470032,0.133331298828125,-0.5543805956840515,-1.1833268404006958,-1.082636833190918,1.4513523578643799,1.5863746404647827,-2.137661933898926,-3.539032459259033,1.439093828201294,1.6260441541671753,-2.2759597301483154,0.2082560956478119,3.2157938480377197,0.6226021647453308,-0.22518281638622284,2.9352848529815674,-0.7137488722801208,-1.588548183441162,3.6015591621398926,2.044205904006958,1.8511909246444702,-1.9218714237213135,0.3138681650161743,-1.0854578018188477,-0.8866205811500549,1.8352841138839722,-2.248596429824829,2.16404390335083,-0.33612340688705444,-0.49726319313049316,-2.7170894145965576,-2.0728843212127686,-4.638208389282227,-1.6170783042907715,-0.20929217338562012,-0.46097332239151,1.5175888538360596,-1.5433744192123413,1.8713351488113403,1.8332688808441162,0.7030161023139954,0.46529605984687805,3.1553475856781006,-1.6810723543167114,-1.1949621438980103,-0.10473327338695526,-3.330986976623535,-1.1049672365188599,-1.6978861093521118,0.029438050463795662,-2.6963858604431152,-2.0555989742279053,2.465235948562622,-1.9112207889556885,-0.32064366340637207,2.620021104812622,-0.408607542514801,0.1245039850473404,-1.329822301864624,3.630690097808838,-1.4842967987060547,-2.298283815383911,-1.5621081590652466,-0.15686622262001038,-0.6459522843360901,3.902111768722534,-2.599571943283081,-1.144740343093872,0.17234019935131073,1.2059065103530884,1.084055781364441,0.2739514410495758,1.0172538757324219,-1.3774755001068115,-0.7652497887611389,0.8557133674621582,-1.6671339273452759,-2.6732192039489746,3.251204013824463,2.2805016040802,-0.48990797996520996,-3.5800464153289795,-2.401524305343628,2.2442638874053955,0.9074652791023254,-0.6741955876350403,0.41410043835639954,-0.9813151955604553,-0.7406838536262512,1.9927582740783691,-2.3684191703796387,-0.21138182282447815,-1.8707088232040405,0.5144356489181519,-0.0063685644418001175,0.4015691876411438,0.011485702358186245,-1.5187822580337524,-1.7080239057540894,-4.242672443389893,-0.9422172904014587,-1.9303990602493286,-1.7346992492675781,3.605759382247925,-0.5450956225395203,-1.6398658752441406,-0.8857237100601196,1.2693557739257812,-1.5677229166030884,2.7469584941864014,-3.0404348373413086,1.487524151802063,-0.624152660369873,4.019865036010742,-0.7880457043647766,-0.4305521249771118,-0.3459099233150482,-1.9315193891525269,0.6175927519798279,2.784783124923706,-1.4061082601547241,-4.057201385498047,-2.141192674636841,-1.3322064876556396,4.162173748016357,-1.0693849325180054,0.9694207310676575,-0.9467035531997681,-1.9424692392349243,-1.6984901428222656,-2.0469446182250977,-0.9432393312454224,0.4755238890647888,-1.8336162567138672,-1.29402494430542,-0.2897595763206482,-1.385109543800354,-1.1559252738952637,-2.5992493629455566,0.1389758139848709,2.9700381755828857,-0.4451182186603546,-0.6811957359313965,-1.9802380800247192,-1.1688662767410278,1.3190242052078247,-0.3789895176887512,-2.417238712310791,-1.7151457071304321,3.2830491065979004,-1.5266999006271362,3.3978381156921387,0.4191213548183441,-0.3550134003162384,-1.7907549142837524,3.783010721206665,3.9835102558135986,-1.3007440567016602,-0.0416359044611454,1.5018337965011597,0.16560854017734528,-2.069460153579712,3.0891036987304688,-0.713715136051178,1.9497184753417969,0.47551363706588745,-1.51016104221344,3.251927137374878,2.8783915042877197,-2.5159690380096436,-0.5440582633018494,-1.459760069847107,-3.5765457153320312,-0.7375274300575256,-0.1736634522676468,-2.0911107063293457,0.6025912761688232,-1.7321776151657104,-3.46622633934021,0.13439548015594482,-1.0749378204345703,-0.24663902819156647,-2.56632661819458,-1.0119014978408813,-0.898141622543335,-1.0809061527252197,2.4956443309783936,3.6976099014282227,-0.8135845065116882,-1.0633544921875,3.145613431930542,2.654017448425293,-1.4721659421920776,-1.474331259727478,-0.035289566963911057,-1.766198992729187,-2.0404298305511475,-0.794043242931366,-1.1964598894119263,1.2029223442077637,0.26800793409347534,0.5491646528244019,0.3310503363609314,-1.6278393268585205,0.394186794757843,-2.5849761962890625,0.22979119420051575,0.7060192227363586,-1.157907247543335,3.3114113807678223,-0.3348069190979004,1.5352379083633423,2.2955071926116943,-1.112860083580017,-2.5628323554992676,-0.20275148749351501,1.8919744491577148,-1.6599159240722656,-0.8344427347183228,2.060715913772583,-2.0854716300964355,-0.5532221794128418,-1.265429139137268,-1.8498557806015015,1.5311548709869385,-0.636384129524231,-0.8443379402160645,-0.33953773975372314,-0.007611680310219526,1.7102060317993164,1.3387291431427002,1.8436723947525024,4.243395805358887,-0.4230062663555145,-0.4651019275188446,1.8813493251800537,-2.137836217880249,-2.4045681953430176,4.029792308807373,-1.362536072731018,-1.1682320833206177,1.1746455430984497,0.9981936812400818,3.2793078422546387,-0.8562299013137817,-2.9972035884857178,1.2879087924957275,1.184909701347351,-2.6555113792419434,3.000466823577881,-1.7506930828094482,-0.028259258717298508,1.918036937713623,-1.6481432914733887,-0.7843692898750305,-2.0319509506225586,-3.6588780879974365,1.5615495443344116,-0.9714784026145935,-2.608454704284668,-0.8361160755157471,-4.38513708114624,2.952819347381592,1.6886014938354492,-0.0030200229957699776,-1.1390862464904785,3.2813963890075684,-1.802959680557251,-0.6405485272407532,-1.4560433626174927,-0.734310507774353,3.041466236114502,-0.25646427273750305,-1.4609088897705078,2.689103364944458,3.957014322280884,-3.0162954330444336,-0.6685510277748108,-1.2817472219467163,2.0711212158203125,0.20175397396087646,-1.534456729888916,1.9134819507598877,-0.5841663479804993,0.060848429799079895,-2.5831074714660645,-0.3680429458618164,-3.5476574897766113,1.3145289421081543,0.8099995851516724,-0.8152636289596558,2.6108391284942627,-2.538780927658081,-4.886683464050293,2.554750442504883,1.94782555103302,-2.1189942359924316,1.7292568683624268,-2.360422134399414,-1.0042973756790161,-3.5576817989349365,0.8108216524124146,-1.9314769506454468,2.99442982673645,1.9143368005752563,0.5660755038261414,0.5012418031692505,-2.7811837196350098,3.1410133838653564,-1.1737853288650513,-1.4692834615707397,0.1898687183856964,3.9986109733581543,-1.8274413347244263,-0.7477827072143555,1.0334123373031616,-1.1606355905532837,2.0651559829711914,-0.9877845048904419,0.3540860414505005,2.849874258041382,-0.6464581489562988,-1.16178297996521,0.673305869102478,0.8991155028343201,0.5338417887687683,-1.6257331371307373,-1.7517709732055664,1.5452580451965332,2.718111038208008,-1.4459271430969238,-1.121928334236145,2.1029984951019287,3.0501909255981445,-1.4149307012557983,-0.7492640614509583,1.9568049907684326,-1.540947675704956,2.897987127304077,-0.8404117226600647,-2.457258939743042,1.8136417865753174,3.1307780742645264,-1.4907023906707764,-2.4834213256835938,-2.049344301223755,1.8522158861160278,-0.624958872795105,-0.2926322817802429,-1.160441279411316,-1.1685404777526855,2.8607094287872314,2.3345799446105957,2.6020448207855225,0.33570948243141174,1.1180366277694702,-0.8035776615142822,-0.5401106476783752,-1.5762025117874146,-1.2756335735321045,1.433400273323059,0.23905950784683228,2.9586188793182373,0.24398596584796906,0.6617296934127808,-0.7557723522186279,0.4504343569278717,-1.3887234926223755,1.380202293395996,-0.20938190817832947,0.48644521832466125,0.020228659734129906,-1.5840622186660767,0.11628228425979614,1.016046166419983,0.37375912070274353,-1.500185489654541,-1.0907433032989502,-1.625711441040039,2.2934975624084473,-1.6103763580322266,3.5483577251434326,-0.6289568543434143,-2.7820394039154053,-2.0275325775146484,-1.2542740106582642,-2.4907515048980713,0.30580851435661316,0.39689943194389343,2.0988049507141113,3.1713197231292725,3.1555335521698,2.720364570617676,-2.459298610687256,2.8825783729553223,-0.4072178602218628,-2.531189203262329,2.7441184520721436,3.4907383918762207,-0.8706872463226318,1.2400065660476685,2.6170477867126465,-0.17368191480636597,-2.1362991333007812,2.8639562129974365,-0.6471652984619141,-0.8954769372940063,1.4052023887634277,-3.33317232131958,-0.4998374283313751,-1.9031574726104736,-0.5963838696479797,-0.17733681201934814,-2.1399848461151123,-1.8710362911224365,-0.3039163649082184,-1.6559010744094849,-3.0393760204315186,-2.451329469680786,-0.03018070198595524,-3.0726609230041504,-1.8261126279830933,-4.202496528625488,0.485818475484848,3.3529913425445557,1.510898470878601,-1.2362748384475708,1.1816507577896118,0.18213298916816711,-0.09882434457540512,-2.817734479904175,-0.16316044330596924,-1.8730664253234863,1.4150216579437256,-0.9792606234550476,2.903212070465088,0.8866519927978516,-2.943774938583374,3.927593469619751,1.7664695978164673,2.318578004837036,-1.5821062326431274,0.20580622553825378,0.8959404826164246,-0.9696003198623657,-1.593917727470398,-1.4599785804748535,0.3093854486942291,-1.8745882511138916,1.9821155071258545,-1.6185866594314575,0.26377466320991516,1.9661060571670532,0.0048545124009251595,2.308669328689575,-1.0761120319366455,2.2063920497894287,-1.2963684797286987,3.021232843399048,-1.2214916944503784,-0.764580249786377,0.7186273336410522,3.1556057929992676,-2.035759449005127,-0.5876497626304626,0.42918160557746887,0.08673151582479477,-2.2213973999023438,-1.4508838653564453,0.024473441764712334,-2.0027689933776855,-0.09666717797517776,0.1619771122932434,-0.12637141346931458,-2.1489224433898926,0.39055436849594116,-3.6089115142822266,-2.900480031967163,-0.9264907240867615,-3.0786068439483643,-0.9133347868919373,1.431021809577942,-0.43922317028045654,-1.0347975492477417,2.7665622234344482,-1.257452130317688,-0.07220815867185593,2.0350351333618164,-0.17227113246917725,2.217756748199463,1.4132527112960815,-1.4345506429672241,2.3773324489593506,-1.3481625318527222,-1.4657793045043945,-1.176387071609497,-0.16798563301563263,1.2852087020874023,-3.0565900802612305,-0.3217267394065857,-1.9946097135543823,2.741259813308716,-1.1715786457061768,1.920773983001709,3.483780860900879,-0.7923608422279358,-0.0012064574984833598,3.069589614868164,-0.46626850962638855,-3.5984625816345215,3.262866973876953,1.819901466369629,-1.2853389978408813,-0.22010605037212372,-0.49594810605049133,-1.00896155834198,1.9924293756484985,0.780907154083252,1.6950054168701172,-2.7648165225982666,2.11037540435791,-0.07058083266019821,2.870333433151245,0.680773913860321,-1.151537537574768,3.078524351119995,-0.8153250217437744,-2.2552263736724854,2.1399664878845215,-2.223655939102173,-1.538813591003418,-1.073455572128296,2.4650588035583496,2.1056172847747803,1.9216759204864502,-1.236465334892273,2.5925538539886475,-0.8352528214454651,-1.8474172353744507,-0.2826260030269623,1.0589063167572021,-1.7923251390457153,-2.274857759475708,2.2976489067077637,-0.9097136855125427,-1.7562918663024902,-1.6011906862258911,0.2996404469013214,-1.5666978359222412,-1.5617871284484863,2.1218836307525635,1.3170183897018433,1.4716273546218872,0.9955313801765442,-1.7088648080825806,-1.429945945739746,-0.7603112459182739,-0.0683039054274559,-2.795725107192993,2.5448763370513916,-2.084662914276123,-0.9001747965812683,2.3708794116973877,-1.3585543632507324,0.2489558309316635,0.30438217520713806,3.452157497406006,-0.7530708312988281,-1.143578052520752,-2.0229530334472656,1.9564000368118286,2.626322031021118,-0.1465270221233368,0.10145296156406403,1.9736120700836182,-0.24353055655956268,1.391829252243042,2.134007692337036,0.8490457534790039,3.3607003688812256,1.2660757303237915,-2.53790545463562,-1.8243627548217773,-3.7010529041290283,1.5434093475341797,3.1835360527038574,-1.5581939220428467,1.6591728925704956,-2.9712624549865723,-0.4120921194553375,-2.9110891819000244,-0.9789974689483643,-1.621083378791809,-1.367258906364441,1.507683277130127,-2.526430130004883,2.4064342975616455,2.9105515480041504,3.1868820190429688,-1.5575345754623413,0.5086972713470459,-0.47394824028015137,-1.0716365575790405,-2.7298951148986816,-1.1737887859344482,-0.7186974883079529,1.2684919834136963,-0.544420599937439,2.270475387573242,2.876209020614624,0.3057693839073181,-2.5625813007354736,-1.1545135974884033,0.43199577927589417,-1.3380929231643677,-0.4204670786857605,-1.8348599672317505,-1.1681981086730957,1.9336206912994385,-1.5805511474609375,-0.17781978845596313,0.2661283612251282,0.05084383115172386,-3.028705596923828,-1.2335500717163086,3.136423349380493,-1.651832103729248,-0.07456909120082855,-2.1468656063079834,-1.1298974752426147,-2.094762086868286,3.0636770725250244,1.320799708366394,3.749422311782837,0.35275161266326904,-0.5461410880088806,0.19515788555145264,-2.388641119003296,-1.889526605606079,0.2105267494916916,2.3385887145996094,0.1892682909965515,0.48727771639823914,1.1788370609283447,1.5366084575653076,2.548330068588257,-1.703904151916504,-1.5635713338851929,-0.4237581789493561,-2.2956531047821045,-2.8210291862487793,-1.0784014463424683,-1.4995476007461548,1.612040400505066,2.958583354949951,2.2590057849884033,1.5917344093322754,-0.7972256541252136,-2.946410894393921,0.3803207576274872,-1.5838441848754883,2.5890982151031494,0.8442592620849609,0.319130003452301,2.6727871894836426,-1.1425365209579468,-3.3137128353118896,0.8669509887695312,3.712031841278076,-2.3261590003967285,3.038511276245117,-0.12696190178394318,2.5987021923065186,-1.5477955341339111,-0.8069539070129395,-2.8527300357818604,1.9856349229812622,-0.4569428265094757,1.6494429111480713,-2.549685478210449,-1.167999029159546,0.4086816906929016,-2.0517995357513428,4.171459197998047,-1.8878973722457886,-3.204695463180542,0.36668217182159424,-2.5808298587799072,-2.9268856048583984,0.5591473579406738,-2.541266918182373,2.947554349899292,-1.8717433214187622,-1.1325407028198242,-0.4991954267024994,-2.709296703338623,1.3908610343933105,-0.022439107298851013,1.6511785984039307,-0.3843238055706024,-3.4811253547668457,1.5667206048965454,0.21783877909183502,2.6678433418273926,0.1778346300125122,1.1336733102798462,-1.1284319162368774,-1.7821099758148193,-0.8575137257575989,-2.8579964637756348,-1.1155049800872803,2.3322794437408447,0.31485116481781006,-2.3635025024414062,-0.9854603409767151,1.987745761871338,-0.5346599817276001,-3.035722255706787,-0.9079676270484924,-0.37549328804016113,-1.3000524044036865,-0.7573978304862976,1.2254114151000977,1.755332112312317,-1.997733235359192,2.9322803020477295,0.5483350157737732,-3.8483309745788574,0.12471804767847061,0.004035424906760454,-0.08226308971643448,-0.9590358138084412,-1.061206340789795,-2.341899871826172,1.0791351795196533,-0.902186393737793,0.3646126985549927,-1.1563283205032349,3.0741682052612305,-2.763404607772827,3.490607738494873,-0.9340545535087585,2.7959787845611572,-0.39382871985435486,-0.8970507383346558,-0.9080783128738403,0.3008239269256592,-2.0643413066864014,-0.5334157943725586,-0.8258000612258911,1.165440320968628,-0.9921197295188904,-0.3890365660190582,-0.749999463558197,2.5617992877960205,-1.5698268413543701,-2.0206406116485596,-0.5160516500473022,-1.951865792274475,3.1629209518432617,-3.304901123046875,1.0746384859085083,3.4029364585876465,-2.043121576309204,-0.3761971890926361,0.5014540553092957,-2.0406970977783203,2.4266443252563477,1.764251708984375,-1.1824702024459839,2.1683709621429443,0.8216303586959839,1.1668157577514648,-0.7457956075668335,-1.2839841842651367,1.7647196054458618,1.400261402130127,-3.107715368270874,-2.623457431793213,-0.005551460199058056,-0.2926905155181885,-1.6098512411117554,0.2816453278064728,-1.7380626201629639,-1.8814886808395386,-2.0397417545318604,0.0881914496421814,-2.0634405612945557,3.8451244831085205,-0.11788661777973175,3.1539371013641357,3.781670093536377,-2.29152774810791,3.286388635635376,-0.6677343845367432,-0.2775379717350006,-1.0676922798156738,1.121517539024353,2.643547534942627,-1.2125937938690186,-0.08910509198904037,-0.3111072778701782,1.7334436178207397,-2.5257949829101562,-0.46243125200271606,-0.20651404559612274,-2.7835280895233154,1.8638774156570435,0.2827836275100708,-0.8703055381774902,-0.2997181713581085,2.843735456466675,2.2749829292297363,2.9931540489196777,-1.1886399984359741,0.4951542019844055,3.253526449203491,-0.3918599784374237,-1.0273041725158691,1.1236544847488403,-0.4240933954715729,2.215177536010742,2.373932123184204,3.2859365940093994,1.2310274839401245,-1.9158750772476196,0.6325071454048157,0.6721009016036987,-1.3290467262268066,0.4609493017196655,-2.20919132232666,3.608642816543579,4.010130882263184,-0.6887336373329163,-1.1863250732421875,0.675536572933197,-2.286681890487671,-0.4367493987083435,-0.02265842631459236,1.6450563669204712,-1.4868491888046265,2.782620906829834,-0.26003557443618774,2.730844020843506,-0.9675811529159546,-1.1638643741607666,-3.7887840270996094,0.3780973255634308,1.8176019191741943,0.37911826372146606,4.367368221282959,1.9021930694580078,-1.5932179689407349,-1.5253520011901855,-0.002455485053360462,-1.4065812826156616,-2.8296566009521484,-0.7987380027770996,1.983280062675476,-0.28345027565956116,-0.7123892307281494,0.9829865097999573,-2.286323070526123,3.9558663368225098,-1.6198179721832275,1.0466958284378052,0.9461600184440613,-2.001986503601074,-0.08723796904087067,-0.35214167833328247,-1.2756086587905884,-2.377509117126465,-1.5687477588653564,-0.028445938602089882,0.3406451940536499,-1.1076420545578003,-0.18792785704135895,-1.8591911792755127,2.597219944000244,-0.3428005576133728,-2.1507129669189453,0.7194458246231079,1.6847457885742188,-1.2877610921859741,-1.7913676500320435,-0.5644801259040833,0.054193124175071716,3.596587657928467,3.4853017330169678,-2.242497682571411,-0.3501870632171631,-2.7563223838806152,-0.8818327784538269,-2.34541916847229,-1.059950828552246,-0.35740014910697937,0.18353280425071716,-2.6133980751037598,-1.5753076076507568,-1.029784083366394,-1.1727734804153442,2.312148094177246,-1.5971664190292358,-0.5422598719596863,3.8221607208251953,2.5744035243988037,-0.46142148971557617,-1.8641866445541382,0.2629261612892151,-1.1144334077835083,-2.590660810470581,0.2077123373746872,0.45896902680397034,-1.8560467958450317,2.216710329055786,-1.5751804113388062,1.0220723152160645,1.346640944480896,-1.4977961778640747,-1.8546497821807861,-0.10310997813940048,-1.569757342338562,-3.4541399478912354,2.139373540878296,3.47412371635437,3.5728507041931152,-0.08907664567232132,1.1176631450653076,1.5230191946029663,-1.7636594772338867,2.9262192249298096,0.9050352573394775,0.38327673077583313,-2.7313499450683594,-1.658072590827942,0.5412981510162354,-1.9191582202911377,-0.9431267380714417,-0.4692811071872711,1.3009750843048096,0.35239318013191223,-1.5106314420700073,-3.225855588912964,3.3133585453033447,-2.5265326499938965,-1.7112127542495728,-0.8210354447364807,1.4031096696853638,-1.7440755367279053,3.1914238929748535,-1.120970606803894,-0.7890939712524414,3.04384183883667,0.9506229758262634,-0.9326565265655518,0.5380505323410034,-2.0022542476654053,3.216313600540161,1.1792365312576294,-0.1545870155096054,1.7533619403839111,1.2845542430877686,-4.735218524932861,2.438941717147827,-0.6604816913604736,1.6072880029678345,-2.3342487812042236,-0.2507370412349701,0.891586184501648,2.528898239135742,-2.0210177898406982,3.4394233226776123,-0.32061633467674255,1.273072361946106,0.20860770344734192,-0.6747035384178162,-2.468953847885132,1.7690640687942505,-0.43500739336013794,1.6313633918762207,3.453928232192993,-0.4470609426498413,-2.6396048069000244,-0.47574567794799805,0.4921708106994629,-0.8238633871078491,-1.32001531124115,-0.34607523679733276,-4.381186485290527,-0.7133820652961731,0.6721486449241638,2.8493807315826416,-1.2627198696136475,-1.9509460926055908,-2.3046557903289795,-1.0158804655075073,1.7023441791534424,-1.230151653289795,2.2370803356170654,0.8261670470237732,-1.276822805404663,-1.4278315305709839,-0.7183060050010681,1.5566123723983765,-1.1339408159255981,-2.9288828372955322,2.771916151046753,3.3080029487609863,-0.6460763216018677,2.352628469467163,2.338240146636963,-2.336923360824585,-1.2872451543807983,1.0214701890945435,3.955780506134033,2.2385847568511963,-1.4037795066833496,4.744129180908203,1.7843698263168335,-1.3898504972457886,-0.8141213655471802,3.0817787647247314,-1.6498897075653076,2.2775657176971436,-1.5676639080047607,-0.796843409538269,0.7911635041236877,-1.93552565574646,-1.927593469619751,-0.1423671692609787,-2.1701323986053467,-0.8316676020622253,1.7561243772506714,2.9949491024017334,2.5923702716827393,-2.2250101566314697,2.419905185699463,-0.22423763573169708,-2.084412097930908,2.205538272857666,3.3309900760650635,-1.111020803451538,-1.8077784776687622,3.72393798828125,0.41497430205345154,3.623619318008423,1.7278108596801758,0.6725074052810669,-1.3078044652938843,1.2141294479370117,0.5968689322471619,1.462180256843567,-1.2199708223342896,-0.34246689081192017,1.2567591667175293,-3.196558952331543,-1.2187711000442505,-2.4846603870391846,1.7628034353256226,1.6612765789031982,4.45243501663208,-0.9133063554763794,-1.8727742433547974,-1.7670412063598633,-4.1478047370910645,-0.23471206426620483,0.16503994166851044,-0.6169037818908691,1.6664159297943115,0.10322389751672745,-0.844556450843811,4.045906066894531,1.2930104732513428,0.13657449185848236,-1.1067192554473877,3.6538808345794678,1.3626773357391357,4.025424003601074,-1.6804485321044922,1.239074468612671,-2.580641269683838,-1.1332836151123047,-2.735729455947876,2.896737575531006,0.12374753504991531,3.5458016395568848,0.24380508065223694,2.629383087158203,-3.208404541015625,1.123340368270874,-1.5397580862045288,3.483691692352295,-0.36135610938072205,-3.7110862731933594,-2.1353745460510254,2.6705076694488525,-1.6186919212341309,0.6096498370170593,-0.2616088092327118,-0.4485713243484497,-0.32687222957611084,-0.356671541929245,-1.0358151197433472,-1.884299397468567,-2.5463905334472656,-1.7144912481307983,4.604419708251953,0.1997801959514618,-3.2774059772491455,-2.2802250385284424,-2.3570406436920166,-2.0557823181152344,-1.375681757926941,1.5156992673873901,0.005845459643751383,2.7892823219299316,-2.550149917602539,-1.340691089630127,-1.1896791458129883,-0.7782454490661621,0.6303879022598267,1.6011687517166138,-1.4617483615875244,-1.6895219087600708,3.951101541519165,3.935730457305908,-0.5415573716163635,-0.22995209693908691,-1.5974986553192139,3.1272194385528564,-0.9367156624794006,-1.2220979928970337,0.6931435465812683,0.6250455379486084,-3.2163264751434326,0.6243202686309814,-0.3092125654220581,-0.8361631035804749,-0.7270533442497253,1.0567988157272339,-2.223942518234253,0.4051739275455475,1.555176019668579,1.16926908493042,-2.3607728481292725,0.29833441972732544,0.2958355247974396,1.8770614862442017,0.5427344441413879,3.428724527359009,-0.5013337731361389,0.22428792715072632,-2.497662305831909,-1.497464895248413,-1.726440668106079,1.152235984802246,-0.6513069272041321,1.854205846786499,0.2901667654514313,-1.8756152391433716,0.5453590750694275,1.4578840732574463,-2.1052463054656982,-1.8135895729064941,3.1885085105895996,2.3969664573669434,1.9961283206939697,-0.19274790585041046,-1.0342402458190918,-0.8927062749862671,-2.2783303260803223,-0.8335270881652832,-2.3585212230682373,2.0553700923919678,-1.554019570350647,-0.8861497640609741,-3.00227689743042,2.2489960193634033,0.39535513520240784,-3.849867820739746,-2.1844494342803955,-2.0346949100494385,0.5147690773010254,0.3865438401699066,1.7196229696273804,-1.5579144954681396,1.1422321796417236,1.1619600057601929,-2.3549845218658447,-2.0749053955078125,-0.2257966548204422,-2.295896530151367,-2.8401267528533936,-2.632659673690796,-1.0322775840759277,-0.8260121941566467,0.22886763513088226,1.8142478466033936,-0.2120124250650406,2.547736644744873,-0.8031067848205566,2.847958564758301,-1.4577528238296509,1.185253381729126,3.3045082092285156,-0.8596621751785278,3.3248398303985596,-3.016035795211792,-2.3293142318725586,-0.5612491965293884,1.738010287284851,-1.857014775276184,0.3522111773490906,1.715013861656189,1.7054526805877686,-1.9366662502288818,-0.5233083367347717,-0.4511398375034332,1.898438811302185,2.924729108810425,1.3379732370376587,-1.5027793645858765,3.656191825866699,-0.6244774460792542,-0.9881186485290527,-2.050412178039551,1.5144230127334595,-0.7240459322929382,3.3059823513031006,-2.0301685333251953,2.8275680541992188,-1.0093052387237549,-2.269918918609619,-1.5333324670791626,-1.6074870824813843,2.237152099609375,-3.460644006729126,0.3651212751865387,-0.6909299492835999,-0.7877782583236694,-2.486570358276367,-1.6915345191955566,-1.0861876010894775,1.258124828338623,-0.1454726904630661,1.8852548599243164,2.7057840824127197,-2.689232349395752,-0.5065785050392151,-2.1023800373077393,1.3219783306121826,-1.2964295148849487,0.13633275032043457,1.6825963258743286,-1.691077470779419,2.5307633876800537,-2.4017512798309326,-0.15814276039600372,2.72173810005188,-0.5156732797622681,1.5818527936935425,-0.2658272683620453,2.6046080589294434,1.6159515380859375,-1.8459367752075195,1.097860336303711,1.139311671257019,1.5605523586273193,-0.6870323419570923,2.0191118717193604,1.1357945203781128,-0.05960303172469139,2.886836290359497,-2.291182279586792,1.922645092010498,-0.050417736172676086,1.9825570583343506,1.5554524660110474,1.991816520690918,-2.1287059783935547,0.2051488608121872,1.0253417491912842,-1.0728514194488525,-1.1877174377441406,-1.8787815570831299,-1.327561378479004,0.2232806533575058,2.2139387130737305,-1.9651026725769043,3.867331027984619,3.193185806274414,-1.534369707107544,2.176358461380005,-0.6863454580307007,-0.05018678307533264,2.432162046432495,-0.9753296375274658,-1.287184238433838,-1.9025921821594238,-0.2667393684387207,1.016323447227478,0.2617575526237488,-0.41560444235801697,-2.3806052207946777,1.8078866004943848,-0.6579450368881226,-0.3983372747898102,2.5839967727661133,-1.97933030128479,3.982299327850342,-1.3926756381988525,2.8771584033966064,-2.0797505378723145,2.077324151992798,-2.2814152240753174,0.20010872185230255,-1.4667218923568726,-1.0025612115859985,1.6409019231796265,4.247314929962158,1.091020941734314,-0.871699333190918,0.15595845878124237,0.21423202753067017,-1.4147595167160034,3.916760206222534,-4.093352794647217,-1.3199560642242432,-1.294525384902954,1.0605332851409912,-0.44992560148239136,-0.6702976822853088,2.5587639808654785,-2.1404097080230713,1.3451348543167114,0.9187245965003967,3.170416831970215,-1.0416679382324219,-0.02305697090923786,0.9004185199737549,0.8172447085380554,0.5493320822715759,-1.23512864112854,2.6280922889709473,-0.14795954525470734,2.875194787979126,1.5230071544647217,-1.7819604873657227,-1.1729193925857544,2.0003271102905273,-0.32561245560646057,-2.653494358062744,-1.3732349872589111,3.728239059448242,0.7541455626487732,1.9238998889923096,-0.729708194732666,-2.511878728866577,-0.5000008940696716,-0.8534930944442749,0.12427335977554321,-1.4072355031967163,-0.9782488346099854,-1.4681167602539062,-3.0635228157043457,-4.737936973571777,-2.2224342823028564,-0.7278485894203186,0.4796999990940094,-1.2955436706542969,-1.1634520292282104,-0.904166042804718,-2.4427402019500732,2.3675148487091064,-2.831010103225708,3.6881468296051025,2.3889846801757812,0.944114089012146,0.4550708532333374,-0.2430306375026703,0.5259416699409485,4.976294040679932,1.361397385597229,0.23911331593990326,0.9303286075592041,-1.3684759140014648,2.226515531539917,-2.0106256008148193,-2.0105390548706055,3.1399412155151367,-1.1496943235397339,2.649080991744995,0.14397673308849335,1.883436679840088,0.5566297173500061,1.2946394681930542,-0.7046022415161133,-0.46679970622062683,3.048800230026245,-2.7264626026153564,-1.5701026916503906,-1.3554056882858276,-2.47928524017334,1.736443281173706,-0.3308582305908203,-1.9075087308883667,0.331518292427063,2.24688458442688,-1.8202123641967773,-3.11665678024292,3.071871280670166,-0.44536226987838745,-2.8357558250427246,0.5297002196311951,-1.1284195184707642,-4.431305885314941,-0.07250932604074478,2.186678886413574,-1.8538634777069092,0.4131477475166321,4.36790657043457,1.805374264717102,-0.4060506522655487,2.7648301124572754,-2.627321720123291,1.3333404064178467,2.2562122344970703,3.1701724529266357,-0.35229021310806274,1.7764027118682861,-0.5701479911804199,3.450129508972168,-0.25357329845428467,-1.4965646266937256,-1.7648420333862305,-3.408356189727783,0.36378392577171326,1.8222882747650146,-1.2591986656188965,-0.520563542842865,2.29069185256958,-0.11291100084781647,2.7030293941497803,3.802335739135742,0.04216998443007469,-1.9375807046890259,2.583144426345825,-2.504460573196411,-2.53847599029541,0.5316646695137024,0.41664257645606995,1.5500471591949463,1.7008206844329834,2.1030094623565674,-1.24582839012146,-0.655752956867218,0.6516611576080322,-1.4745224714279175,-2.5104596614837646,-1.1146554946899414,-0.32098808884620667,2.7594780921936035,1.7176223993301392,-0.9809885621070862,1.8406301736831665,3.990072250366211,4.227428436279297,-2.502113103866577,-0.5020877122879028,0.429826021194458,1.952351689338684,-2.066220998764038,0.7812591791152954,1.087206244468689,-0.5976855158805847,-2.7694895267486572,-0.20918871462345123,-2.3798844814300537,-0.08195985853672028,-2.69221568107605,-1.4322152137756348,-0.5801608562469482,-0.4027445912361145,1.019793152809143,-2.619279384613037,1.9927226305007935,-1.7429468631744385,-0.9567574262619019,-1.0623135566711426,-2.9635226726531982,-2.3578946590423584,-0.627524197101593,0.1262543797492981,-0.11865558475255966,-0.9198349714279175,-1.8593419790267944,2.7106773853302,0.7785360813140869,-1.6905815601348877,2.156674861907959,0.7447212338447571,-0.338561087846756,2.036561965942383,4.496967315673828,-3.667890787124634,-0.8672451376914978,-2.2453091144561768,1.354225516319275,0.2695292532444,0.21352995932102203,-0.16265180706977844,2.2846758365631104,1.5550130605697632,-1.3087000846862793,-0.9574870467185974,-0.26919078826904297,0.09196742624044418,3.259822130203247,-3.1525166034698486,1.8361525535583496,-2.066976308822632,-0.9691182971000671,1.288761019706726,4.276564121246338,-1.2152072191238403,-0.599331259727478,0.5601779818534851,-0.28781527280807495,-3.6115198135375977,3.715332269668579,-2.4169156551361084,2.6448514461517334,-4.430443286895752,0.7336122989654541,-1.569625973701477,1.4360109567642212,-2.4797072410583496,-0.5298454165458679,-0.6201249957084656,-0.564073920249939,0.34640297293663025,1.6451971530914307,-1.5757825374603271,-1.2451986074447632,-1.2392247915267944,-0.37426403164863586,1.8083568811416626,-0.27705201506614685,-2.137863874435425,-1.693640112876892,-0.697254478931427,3.9448742866516113,-2.7799623012542725,-1.226913571357727,-2.1641056537628174,0.36678841710090637,-1.9516726732254028,0.4642779529094696,-1.08030104637146,0.9879739284515381,-0.34854137897491455,-0.21992194652557373,3.544261932373047,-1.9855870008468628,0.8537329435348511,-0.8685550689697266,0.7347137928009033,1.3885029554367065,1.4911295175552368,1.5575777292251587,-0.21686284244060516,-1.0364171266555786,0.2615337371826172,-2.3962621688842773,-1.8106991052627563,-0.9403395652770996,-1.3673622608184814,2.185352325439453,-1.8184338808059692,-1.9351272583007812,-2.440117120742798,-1.6677300930023193,0.6610477566719055,-1.745104193687439,-0.029737727716565132,-2.2441751956939697,2.141080617904663,-2.5314998626708984,-0.9011258482933044,0.3819235563278198,2.086122512817383,-1.1760379076004028,1.9121028184890747,-0.4704369902610779,-2.4356696605682373,-1.1896421909332275,-1.4672943353652954,1.027963638305664,0.9581897258758545,-2.9281272888183594,0.19945383071899414,1.8031235933303833,3.1245059967041016,-1.259253740310669,-1.1028428077697754,3.7961506843566895,0.11765225976705551,3.0867302417755127,-0.5988787412643433,-1.2276334762573242,-1.0358867645263672,3.281231641769409,0.20209412276744843,-0.5567004680633545,0.2365749627351761,-2.972494602203369,-1.5568568706512451,2.747422456741333,-1.4126107692718506,0.4012705981731415,-1.2017714977264404,1.5677356719970703,2.5151114463806152,2.6706528663635254,-1.6846733093261719,-4.536562442779541,-0.9944462180137634,2.0255870819091797,3.9132721424102783,-1.0996793508529663,-0.7687416076660156,-1.238613486289978,1.4283844232559204,-0.5214158296585083,-1.8455508947372437,2.643115282058716,-0.5640100836753845,-1.0815958976745605,2.3787994384765625,0.1714116334915161,0.002319586928933859,1.2502233982086182,-0.08066139370203018,-1.5928094387054443,-1.6481815576553345,1.4610868692398071,2.1344902515411377,0.38230785727500916,0.03493756428360939,-0.007915889844298363,1.9756959676742554,-1.5037853717803955,0.8455179333686829,-0.2062968909740448,-0.8681092858314514,-1.3286751508712769,0.4729298949241638,-1.879957914352417,1.6604084968566895,-1.7529133558273315,4.2177629470825195,-1.9717508554458618,-1.4453709125518799,-2.6645848751068115,3.653454303741455,-1.5406028032302856,0.1874106526374817,2.270000457763672,4.91849946975708,0.8344231843948364,-1.8923697471618652,-0.7080792784690857,-0.25113800168037415,-0.4400658905506134,3.7269349098205566,-0.44712284207344055,-0.01629294455051422,-0.030157970264554024,-0.5921887755393982,-1.4089206457138062,-2.0574986934661865,-0.5759211182594299,-2.155470132827759,-2.5253818035125732,-0.8229602575302124,-2.0451135635375977,-1.0708798170089722,-1.8419002294540405,1.5814934968948364,0.09427324682474136,-2.4933295249938965,-1.214764952659607,-1.0408496856689453,-0.6249185800552368,-0.5046200752258301,1.4944665431976318,-1.6426632404327393,-0.47291362285614014,-1.0498467683792114,0.6096233129501343,-1.1433055400848389,-2.0888493061065674,0.532207190990448,0.5457475781440735,1.9716938734054565,1.3611911535263062,0.8835276365280151,0.0570196770131588,2.6073925495147705,1.5103759765625,1.8781821727752686,-1.517859697341919,-2.1038804054260254,-0.36846956610679626,4.069490432739258,-0.914747953414917,0.6060736179351807,0.9027737379074097,-2.2319161891937256,3.371110439300537,-0.971447765827179,-0.3375467360019684,-1.4437283277511597,-1.8005098104476929,-2.1087465286254883,-0.8584489822387695,3.6422977447509766,3.8838982582092285,4.178226470947266,-1.2480807304382324,-0.9318966269493103,0.47366249561309814,1.5154720544815063,4.142712593078613,2.1969058513641357,1.1273434162139893,1.2168231010437012,-2.029841184616089,-2.9348573684692383,-1.6957303285598755,0.20245347917079926,0.5765015482902527,-1.3519694805145264,0.41845324635505676,1.3520702123641968,1.4785871505737305,-0.11451252549886703,-0.7361651659011841,-3.9446146488189697,-1.696552038192749,-0.3983348608016968,-0.6140309572219849,3.2747550010681152,-1.6195436716079712,0.007053048815578222,1.734918475151062,3.421625852584839,-0.057015784084796906,-1.9903556108474731,0.30030927062034607,0.7970352172851562,1.7241759300231934,0.30615752935409546,0.1727372258901596,-0.4606000781059265,1.8427722454071045,-0.2768220901489258,2.0904428958892822,-1.4328309297561646,-1.4077186584472656,-1.0925281047821045,-2.9178783893585205,0.46708154678344727,1.1814321279525757,-3.3974528312683105,-3.1406822204589844,-0.6326143145561218,0.07816366106271744,-0.1832481473684311,-1.952221393585205,0.035471610724925995,1.0003801584243774,2.7867329120635986,-2.1693999767303467,-2.2236123085021973,4.776128768920898,0.35006389021873474,-0.17421112954616547,-0.8456131815910339,2.452388286590576,-0.8695175647735596,0.26788419485092163,-1.7302883863449097,2.9536166191101074,-0.5752238035202026,0.3847942650318146,4.1741766929626465,1.9814701080322266,-2.892289876937866,-3.4000933170318604,-1.0756478309631348,-1.155741572380066,2.158663034439087,0.8407389521598816,1.4187554121017456,-1.320250153541565,-1.6544928550720215,1.2395367622375488,2.084115505218506,-0.8684352040290833,-1.5206718444824219,-3.2085564136505127,-2.538785934448242,-2.1530771255493164,-2.0509936809539795,-0.2615819275379181,1.7573256492614746,-0.3307972550392151,2.981961488723755,-1.4783964157104492,1.8901039361953735,-1.9206788539886475,-1.074410080909729,-0.863227367401123,3.180056095123291,3.1643269062042236,3.439305067062378,-2.6312358379364014,0.966261088848114,-2.6016366481781006,-2.4245917797088623,-0.8644785284996033,1.986690878868103,2.405210018157959,2.826228618621826,-2.658546209335327,1.0599111318588257,-0.2275090217590332,1.5263535976409912,-0.33948400616645813,-0.11147212237119675,-2.717618703842163,-0.619853675365448,-2.2165729999542236,0.5572751760482788,-0.34319570660591125,-3.12491512298584,-2.320219039916992,-0.7543099522590637,1.1809977293014526,-1.0595065355300903,-0.3308781683444977,-0.2531384825706482,2.5102133750915527,-1.8407890796661377,-1.093380331993103,2.314793348312378,2.085695505142212,-0.11849821358919144,-1.067886471748352,0.5081003308296204,1.2992310523986816,-1.2885974645614624,-0.3640919327735901,-0.6898996233940125,-0.3789864182472229,-3.3627328872680664,1.143985629081726,-2.187685966491699,1.7268966436386108,-0.4204097092151642,2.573374032974243,-1.6969178915023804,-2.6232693195343018,-0.2595655918121338,-1.7946261167526245,-1.563987135887146,-1.1581075191497803,2.5496878623962402,-1.548609972000122,-2.3079452514648438,-0.2920238971710205,-0.47108322381973267,1.605918288230896,2.397930145263672,-0.09622996300458908,2.9960381984710693,4.063385486602783,-0.9998491406440735,2.280050754547119,-1.4467698335647583,-2.0081841945648193,0.007600382436066866,-1.8662259578704834,2.079857110977173,-2.6837170124053955,1.6612948179244995,-0.8407964110374451,0.036175135523080826,3.3422036170959473,-1.2076622247695923,-3.129973888397217,1.6585123538970947,-0.6444282531738281,-0.9298101663589478,0.3899840712547302,2.3359286785125732,-1.5044724941253662,2.577303647994995,-2.3940589427948,2.7578012943267822,1.7934150695800781,-0.045981265604496,0.448703795671463,1.9125871658325195,-2.0014467239379883,-2.081632137298584,1.908286690711975,2.252073287963867,-2.435152292251587,0.3275875747203827,1.6644243001937866,2.23789119720459,3.2280211448669434,1.9127321243286133,-2.173013210296631,1.800289273262024,0.9427393674850464,-0.7994983196258545,-0.5152419209480286,1.632056713104248,-1.0597699880599976,-0.3158542811870575,3.0964982509613037,-0.3169412314891815,3.3123583793640137,1.8278110027313232,-0.25000596046447754,-1.8491259813308716,-0.1980036050081253,-0.5767297148704529,-2.8426105976104736,-3.393249750137329,1.7321877479553223,2.7293789386749268,0.02761763706803322,-0.14945581555366516,-1.3624398708343506,1.9330118894577026,2.568978786468506,-0.1538795679807663,2.2264294624328613,-1.0607378482818604,2.0974788665771484,-2.336721658706665,0.2751546800136566,-1.8976229429244995,1.9439294338226318,-0.7526193857192993,2.178206443786621,2.11680006980896,-0.5614702701568604,2.3598318099975586,2.1113600730895996,0.6855295300483704,-0.4526679813861847,1.593124270439148,-0.8571810722351074,-0.7191428542137146,-1.2899497747421265,2.543652296066284,-0.6945077776908875,1.4028476476669312,3.9938621520996094,1.1461966037750244,0.12298351526260376,3.900458812713623,-0.41985267400741577,-1.4552655220031738,-2.4467766284942627,-0.2116287499666214,0.6596400737762451,-0.8813332319259644,-0.6535669565200806,-1.5423213243484497,2.898371458053589,-0.36289992928504944,1.0119295120239258,-1.5579520463943481,3.8748459815979004,0.7428308129310608,-1.9986575841903687,1.8755873441696167,1.6668996810913086,-1.4571099281311035,0.2236040085554123,-3.6013457775115967,-1.3674381971359253,1.4948067665100098,0.5791864395141602,-1.274724006652832,0.000312829070026055,-1.2471771240234375,-5.238569259643555,-0.9446959495544434,-1.8981190919876099,1.7767040729522705,-1.9374394416809082,-2.6269636154174805,0.05180548131465912,3.111910581588745,-0.9095942378044128,0.16066564619541168,-0.673463761806488,-0.5885980129241943,2.5143134593963623,-0.9794023036956787,-1.4651405811309814,-0.18346121907234192,-0.10962492972612381,-3.343465566635132,-0.5003546476364136,1.3023335933685303,3.002272605895996,-3.0275707244873047,-0.964245617389679,1.4712289571762085,-4.190346717834473,0.2192455679178238,1.9167979955673218,-1.4088823795318604,-2.327338695526123,0.4708108901977539,-0.7749777436256409,-1.685505986213684,-2.167935848236084,-1.0288658142089844,-0.7262160778045654,-2.6511452198028564,-2.5648393630981445,-0.7054684162139893,-4.105072021484375,-1.252151608467102,2.626394033432007,-2.03387451171875,-2.518772840499878,-3.316833019256592,-2.101627826690674,2.323096990585327,-2.221618413925171,-0.6103391051292419,-1.8082270622253418,-2.1130945682525635,-0.6301826238632202,-2.202103614807129,1.2438026666641235,1.7359529733657837,-0.25186410546302795,-0.8704461455345154,-0.4929170310497284,-0.7302863001823425,-1.814268708229065,-1.5941071510314941,1.764957070350647,-0.5051249265670776,1.0932393074035645,3.3227362632751465,-1.4538724422454834,-1.4785330295562744,1.2933903932571411,0.5046981573104858,3.203521966934204,0.4501422643661499,1.5595808029174805,-2.6466894149780273,-0.11242005974054337,0.4400210380554199,1.4436348676681519,-0.3345121145248413,-2.089397668838501,-4.145908832550049,4.276828289031982,3.7582645416259766,-0.36524519324302673,2.502112627029419,1.7311028242111206,-2.311560869216919,1.1082322597503662,-3.009225845336914,-0.9195494055747986,-0.7344300746917725,-0.7767780423164368,-0.1837887167930603,-0.42420440912246704,-1.8844374418258667,1.0455904006958008,-1.8379547595977783,-1.3657000064849854,-1.035170316696167,-1.7520016431808472,0.538796603679657,-0.603374183177948,-2.2098162174224854,-1.4524391889572144,-1.2169932126998901,2.5355606079101562,-0.43343889713287354,-1.5164462327957153,0.2972138226032257,0.8134060502052307,4.10812520980835,-1.3308079242706299,-0.6441059708595276,0.008708315901458263,-2.5977442264556885,-1.3701896667480469,3.643418788909912,1.1326911449432373,-0.5424438714981079,-1.796844482421875,-1.2298158407211304,-2.4998886585235596,0.14835338294506073,-0.9018133282661438,1.870586633682251,2.3732166290283203,3.276639699935913,-0.8259058594703674,-0.07192551344633102,-1.7748682498931885,-1.1614837646484375,-2.557464122772217,-2.5166008472442627,4.230009078979492,2.8614437580108643,-1.934690237045288,-0.7596086859703064,-2.274266481399536,-1.7497444152832031,-0.8585996031761169,1.9122012853622437,1.4241968393325806,1.1375788450241089,0.36619871854782104,0.5051463842391968,0.007915446534752846,3.8621747493743896,-1.8877023458480835,-0.4646683633327484,-0.3257850408554077,2.2971861362457275,-4.421513080596924,3.2360613346099854,3.6660237312316895,0.2768832743167877,2.824354887008667,0.09100283682346344,-1.363892912864685,-3.4225053787231445,-1.7961671352386475,-1.4070372581481934,0.26031923294067383,-1.0427695512771606,-1.0200341939926147,-1.003051519393921,0.10014201700687408,-1.083910346031189,-0.8036546111106873,1.510529637336731,1.470410943031311,-0.21593108773231506,-0.518354594707489,-1.38462495803833,0.5911172032356262,-0.6603328585624695,-0.6545646786689758,-2.876763105392456,-1.765805959701538,-0.7803412079811096,-4.293926239013672,-0.5865119099617004,1.662277340888977,1.942001223564148,-1.1538290977478027,3.066396951675415,-1.8342857360839844,-0.900976300239563,-2.0739128589630127,2.707923173904419,-0.958284318447113,4.250051975250244,-1.197701096534729,-0.24627356231212616,-2.2237799167633057,1.8760648965835571,-0.21759246289730072,0.05547938495874405,-1.4748808145523071,-1.9243358373641968,1.3208469152450562,-2.8396260738372803,0.741294264793396,-0.9370713233947754,-0.5736992359161377,3.134773015975952,2.7314846515655518,4.418294906616211,-2.0944247245788574,-0.2828522026538849,2.0913989543914795,3.725083112716675,4.033855438232422,-2.84543776512146,-0.4895680844783783,0.024225473403930664,-0.9671097993850708,-1.460922122001648,-0.3643007278442383,2.864157199859619,-0.9567323923110962,-0.029230307787656784,3.743922710418701,1.784452199935913,-1.659483790397644,-0.4416770935058594,-2.4318695068359375,-0.46582692861557007,-0.16708305478096008,0.5481386780738831,2.8015801906585693,1.3374143838882446,2.5979080200195312,-0.7200721502304077,-4.067359447479248,-0.9231836795806885,-0.08045951277017593,-2.7376465797424316,-1.7796164751052856,-0.2878594398498535,-3.1000068187713623,2.682363986968994,-1.5569396018981934,3.6537511348724365,0.3020951747894287,-1.1798194646835327,-0.6034483909606934,0.35245925188064575,1.652807354927063,1.2594618797302246,-0.48578161001205444,0.8096434473991394,-1.214065432548523,-0.2537814974784851,-1.5884267091751099,-0.7293865084648132,2.7705557346343994,2.1737489700317383,-1.545000433921814,2.239480972290039,2.976431369781494,-2.961815595626831,-1.5741535425186157,-1.1285480260849,-1.2132387161254883,-0.2740614712238312,1.1721079349517822,-0.9371119141578674,1.6158419847488403,0.5260539650917053,-1.804707407951355,0.6102533936500549,-1.0920350551605225,-3.5908985137939453,1.2020829916000366,-1.96169912815094,-2.210002899169922,-1.3500316143035889,-0.5183250904083252,2.5091774463653564,-0.5936805009841919,1.2221812009811401,1.3393206596374512,0.14783558249473572,-1.770684838294983,-1.7532469034194946,-1.3311671018600464,1.7050174474716187,-2.776010513305664,-1.9264582395553589,-0.610098659992218,-0.19738629460334778,-1.4167988300323486,2.353973388671875,-2.8157742023468018,-0.6728140115737915,-1.0159229040145874,0.00017195852706208825,2.916058301925659,1.9189271926879883,2.817812442779541,-1.1639732122421265,0.8541309833526611,1.7435438632965088,-0.4474489390850067,-0.2650807499885559,-0.7985460758209229,-1.9667468070983887,-1.8899073600769043,0.3436994254589081,0.5832425355911255,2.2515363693237305,-3.2853434085845947,3.6196517944335938,-1.7213956117630005,-0.7441256046295166,-2.2981441020965576,-1.6653860807418823,-1.6330057382583618,1.4074461460113525,0.652660071849823,-0.10589905083179474,-0.7086849212646484,-0.37724411487579346,-2.8499393463134766,-0.9665825366973877,2.966472625732422,0.42374086380004883,0.36792802810668945,1.3494418859481812,1.3694043159484863,-2.301185131072998,-1.2948243618011475,-1.6737836599349976,0.8499120473861694,-2.5946788787841797,-0.5202416181564331,-1.8512142896652222,3.4417564868927,-0.7944623827934265,-2.897076368331909,2.9725892543792725,1.1224591732025146,2.1708128452301025,-2.239058256149292,-2.4112768173217773,-1.2347184419631958,-2.524972438812256,0.5749539136886597,2.5112857818603516,-2.7291719913482666,-0.610990047454834,0.9061734676361084,-0.15739616751670837,-0.13853906095027924,1.8892369270324707,-2.4032413959503174,-0.8967989087104797,-0.8398435115814209,-1.809013843536377,-0.6105373501777649,-1.6361520290374756,0.11857914179563522,-0.632821798324585,-3.1152753829956055,-0.5788589119911194,-0.5624176859855652,-2.4801857471466064,1.4155009984970093,-1.3273968696594238,-0.05241736024618149,-2.6614229679107666,0.6518933176994324,0.028572965413331985,-1.9260385036468506,-1.150124430656433,3.0037612915039062,-1.8111443519592285,-1.0703125,1.1628146171569824,-0.067131407558918,0.168854221701622,1.3923096656799316,2.0348238945007324,-1.1682466268539429,-3.8572661876678467,-0.5285784006118774,2.7704880237579346,3.2592930793762207,-1.4903564453125,0.010588478296995163,1.6086335182189941,-1.0021584033966064,-0.08901698887348175,0.023314910009503365,1.8028457164764404,-1.2932511568069458,1.9122822284698486,4.25877571105957,-0.4058675467967987,-0.9086732268333435,3.8466601371765137,2.2715635299682617,-0.8453699946403503,-0.9354141354560852,-1.7058168649673462,-3.9051406383514404,2.966581106185913,-0.03448972478508949,1.5395759344100952,-1.389501690864563,-2.2554969787597656,-0.9686404466629028,-1.2384793758392334,-0.6280556321144104,2.160766124725342,-0.6732116341590881,3.5376482009887695,-0.8181065320968628,0.19724272191524506,0.734980583190918,-0.586810290813446,2.948298692703247,-1.8934745788574219,-1.6767207384109497,-0.68771892786026,-2.2954649925231934,1.7829521894454956,0.2728360891342163,1.1566686630249023,-2.082282304763794,0.6699081659317017,0.11014511436223984,-3.717947006225586,-0.5735945105552673,1.251136302947998,-2.172698736190796,-0.8310842514038086,-3.0714876651763916,2.3732941150665283,-0.3160000145435333,-0.7353576421737671,0.9137659668922424,-1.568977952003479,-1.7414367198944092,2.400672197341919,-2.632113456726074,1.2782288789749146,-1.6705248355865479,-1.553751826286316,-1.7350103855133057,-2.5613112449645996,-4.375079154968262,0.6319859623908997,-1.9561759233474731,-0.8474287986755371,-1.07542085647583,-1.0636132955551147,2.6444954872131348,4.069056987762451,0.8708494305610657,0.1915103942155838,-1.952509880065918,-3.6787123680114746,-0.3243357837200165,-3.501523971557617,1.0280016660690308,-1.4633523225784302,-0.9187629818916321,-2.0412230491638184,-1.2228569984436035,-0.5643966794013977,-1.6058077812194824,0.3986543118953705,-2.118119955062866,-2.9816839694976807,-3.0011775493621826,-0.5887609124183655,-1.927045464515686,-1.3919881582260132,-0.12357552349567413,0.43474042415618896,3.3017091751098633,1.2062656879425049,-2.8183794021606445,2.457885980606079,-0.9862747192382812,-3.1853787899017334,2.9487929344177246,0.739349901676178,3.7184560298919678,-0.4921416938304901,0.44100505113601685,-3.6293249130249023,-1.1362563371658325,-2.851557970046997,-1.2215913534164429,-0.5644674897193909,-1.0844438076019287,4.212871074676514,1.3178555965423584,0.8869034051895142,2.4462730884552,-2.178043842315674,3.767075538635254,-2.608224630355835,1.6503511667251587,-2.1705737113952637,0.5855221152305603,1.3986382484436035,-1.2682898044586182,-1.932576298713684,2.2040677070617676,0.4049866497516632,0.21763376891613007,0.9622752070426941,4.1820831298828125,-0.47246989607810974,-2.668773889541626,-2.6206631660461426,1.3811355829238892,-1.83577299118042,-0.08176639676094055,0.1344006210565567,-1.4379643201828003,0.20802836120128632,-0.2683901786804199,-1.932355284690857,3.0500736236572266,-1.2155348062515259,-0.5683797597885132,-0.5067238807678223,-1.122353434562683,-0.740943968296051,-0.6299587488174438,-1.0235683917999268,3.5828075408935547,-0.9047887921333313,-0.2632142901420593,-2.240758180618286,-1.7551085948944092,2.8539750576019287,-2.073496103286743,3.3388054370880127,-2.5692381858825684,0.30284908413887024,1.4179631471633911,-0.9227554202079773,-2.33573579788208,0.4620841145515442,3.541350841522217,2.1726300716400146,-3.176109552383423,-0.4472547769546509,-1.3409323692321777,2.2898945808410645,3.357038736343384,-2.539214611053467,4.566402912139893,-2.81950044631958,1.7405506372451782,-1.015020728111267,2.3419032096862793,-0.734963059425354,-1.2500032186508179,2.6647253036499023,0.06339729577302933,0.7271475791931152,-1.8679245710372925,3.1358182430267334,2.991392135620117,-2.381157398223877,4.172631740570068,-2.4717538356781006,0.5551862120628357,-1.231052041053772,-1.517129898071289,2.6232049465179443,-1.9278429746627808,-0.9837830662727356,-1.5935642719268799,3.15598201751709,-0.5566974878311157,-0.662604808807373,2.9481194019317627,1.744490385055542,-1.3093281984329224,-0.6086612343788147,-0.120724156498909,-4.026289463043213,-0.82309490442276,3.637485980987549,3.2919692993164062,1.8392785787582397,-0.0023314370773732662,-4.509636878967285,1.4705381393432617,2.0627875328063965,1.5282492637634277,-3.0164554119110107,-3.317673683166504,-1.2806109189987183,3.4791719913482666,3.0392003059387207,-2.735367774963379,-0.054377444088459015,0.09765805304050446,1.8213775157928467,-1.3275066614151,-0.833922803401947,-1.0496556758880615,2.1813790798187256,-2.8729989528656006,-1.9629616737365723,-0.5960696935653687,-0.6303632855415344,-0.4970003068447113,-0.8741809129714966,0.19634690880775452,-2.424666404724121,-0.35377100110054016,2.59794020652771,-1.1660337448120117,2.5003621578216553,3.8083510398864746,0.13240687549114227,0.11097931861877441,1.3796466588974,-1.39301335811615,-0.7354674935340881,3.6608314514160156,-3.419389247894287,3.0262138843536377,-1.8690991401672363,-0.2502637207508087,3.784477949142456,-1.8400989770889282,0.34686923027038574,1.4851895570755005,-1.8804692029953003,-1.6259385347366333,-2.011291265487671,-0.3166659474372864,-1.4634287357330322,1.7049516439437866,-4.086521148681641,2.566784143447876,1.4959629774093628,-0.02179371379315853,-1.1292110681533813,-0.21734796464443207,-1.380327582359314,-3.592796802520752,-2.1070241928100586,-2.8843777179718018,1.6027098894119263,1.7153443098068237,-2.9399921894073486,-0.6984544396400452,1.6433987617492676,0.9105101823806763,-1.0035840272903442,-1.6661627292633057,2.766814947128296,-0.1331721991300583,1.0823079347610474,-2.9724059104919434,2.5851266384124756,2.5068554878234863,-2.4988510608673096,-4.089851379394531,-2.754880905151367,-2.158160924911499,-0.5722290277481079,-1.720751166343689,2.071031093597412,-1.1246068477630615,-1.3850985765457153,-1.205857515335083,2.485779285430908,1.8707844018936157,-1.0817769765853882,-1.642853021621704,2.5499765872955322,-0.8403877019882202,0.6706753373146057,-1.067945957183838,3.0007505416870117,2.383013963699341,2.8409793376922607,-1.9173508882522583,-2.3929264545440674,-2.4069385528564453,-0.6664226055145264,-1.4087469577789307,-1.9001874923706055,-0.7526893019676208,0.12172035872936249,1.9789142608642578,2.6935482025146484,-0.873913049697876,2.5432097911834717,-0.011510930024087429,-2.305952787399292,0.7658208012580872,-0.9749380946159363,-1.5126047134399414,-2.1185014247894287,2.3858349323272705,0.15192429721355438,1.2972406148910522,3.6285431385040283,0.03777722641825676,3.863215208053589,3.594731092453003,2.060169219970703,0.27067992091178894,1.2839329242706299,2.7029287815093994,1.6805939674377441,2.3586528301239014,1.8192182779312134,-1.434022307395935,2.619218349456787,-3.178966522216797,-1.266601324081421,0.5915572047233582,-1.1193495988845825,-1.2979384660720825,1.7101796865463257,-0.8718167543411255,-0.37904366850852966,1.2597070932388306,3.491154909133911,1.3115041255950928,2.1355581283569336,2.297729730606079,-0.06637841463088989,-0.9531096816062927,3.5753347873687744,0.617449939250946,2.4542906284332275,-0.5881240963935852,-0.828074038028717,3.891754388809204,-2.9251346588134766,-0.8137988448143005,-1.3768529891967773,-2.3151803016662598,-1.0354974269866943,0.8875036835670471,3.1668522357940674,-0.19096380472183228,2.82655668258667,-0.621069610118866,1.6548608541488647,-0.9814919233322144,2.38387131690979,-2.919085741043091,-1.5615078210830688,3.259617805480957,-0.04073765128850937,-0.5529199242591858,-3.3381407260894775,1.2867680788040161,-1.8251832723617554,-2.2802796363830566,2.4930620193481445,1.365936040878296,-0.39686399698257446,2.368154525756836,2.9667577743530273,-0.7674957513809204,-0.6684150695800781,-2.6360833644866943,-0.8839110136032104,-0.06547781825065613,1.799607515335083,0.6236405372619629,-1.0464292764663696,-1.2522125244140625,1.9078725576400757,-0.7454156875610352,1.9839352369308472,-0.9676558375358582,-1.7338383197784424,0.8708102703094482,1.5558040142059326,1.9997626543045044,-1.1687839031219482,1.4556692838668823,-0.045079272240400314,-1.3335604667663574,3.4503190517425537,0.0345478318631649,1.6734932661056519,-0.8359022736549377,-0.7157953381538391,2.9606056213378906,1.9045424461364746,-1.155875325202942,0.49770739674568176,-0.7264258861541748,-2.824921131134033,-1.1975406408309937,2.5754387378692627,2.4966259002685547,1.4967494010925293,-1.3243303298950195,-1.872257113456726,1.487310767173767,1.8993747234344482,0.253993421792984,1.038617730140686,-1.069542407989502,2.7414863109588623,-1.6852542161941528,-1.0906559228897095,4.062530040740967,-2.807983160018921,3.15830397605896,3.509708881378174,0.9266560077667236,-0.08982399106025696,-0.32838860154151917,1.9725663661956787,2.212775945663452,0.288176566362381,1.3361262083053589,0.22028008103370667,-3.191060781478882,-1.549669623374939,-0.3557700514793396,-1.7422831058502197,-1.0482196807861328,-4.435993194580078,-0.7337853908538818,1.4764324426651,-1.0705400705337524,1.4820051193237305,2.6963884830474854,-0.5536906719207764,1.8789681196212769,2.885684013366699,3.238955020904541,-1.462095022201538,2.110596179962158,-2.0830748081207275,1.8828457593917847,-1.2833348512649536,-1.2581496238708496,1.892533302307129,2.4442803859710693,2.9998011589050293,-1.667533040046692,-1.9890145063400269,-0.20185981690883636,-2.6562705039978027,-0.8602169752120972,3.7788732051849365,-0.44957610964775085,1.0905566215515137,-0.17576497793197632,2.527146577835083,3.597850799560547,-1.4173805713653564,0.1455163061618805,3.387254476547241,-5.0179057121276855,1.2672810554504395,1.9074121713638306,-1.254186749458313,-1.885338544845581,-1.755651593208313,0.6403577327728271,-2.524829626083374,0.7146185040473938,-0.33901461958885193,2.8061180114746094,1.0130939483642578,0.4032679796218872,1.2972532510757446,-2.714710235595703,-1.4797271490097046,1.9102325439453125,0.5265258550643921,1.5770554542541504,-2.802940845489502,-2.2612857818603516,-2.1012747287750244,-1.185293197631836,-1.5289016962051392,0.5537010431289673,-2.858015775680542,1.155994176864624,-1.4095118045806885,1.867455244064331,-0.9838578701019287,0.7415041327476501,3.5843491554260254,-0.3868180513381958,-1.979846477508545,1.5551246404647827,-2.544645309448242,3.127572536468506,2.7050845623016357,2.9182844161987305,-1.240228295326233,-2.749152898788452,0.3999503552913666,0.3701936602592468,-0.4525309205055237,1.2436901330947876,3.378713369369507,-0.5541020631790161,3.5240066051483154,-1.0316200256347656,1.777773380279541,2.9324560165405273,3.951627492904663,-3.438772201538086,-0.30504122376441956,-1.5723581314086914,1.8052226305007935,-1.723254680633545,-2.3626232147216797,-0.41093409061431885,0.422881543636322,-0.6775844097137451,-1.926882028579712,1.8229379653930664,3.1192827224731445,-0.5853820443153381,2.417325735092163,-1.1134049892425537,-0.08675523847341537,-2.3651909828186035,-1.4276100397109985,0.7995324730873108,-1.9431482553482056,-0.548565149307251,3.1809396743774414,-1.8686357736587524,-3.584160566329956,-3.1308188438415527,-0.6574491262435913,0.8965455293655396,3.644838333129883,-2.041358470916748,-2.7926440238952637,-0.28332746028900146,-2.2997817993164062,0.023430734872817993,2.5645592212677,1.2471219301223755,-0.600458562374115,-1.5168675184249878,0.3229692578315735,2.244406223297119,-2.2098746299743652,-0.11189274489879608,-0.7697131037712097,-2.1509530544281006,1.4971494674682617,3.337265729904175,-2.689789295196533,-3.254906177520752,-1.8407127857208252,-1.8691859245300293,-0.2515905201435089,-2.274106740951538,1.9366635084152222,-1.761297345161438,1.1041549444198608,2.774942636489868,3.5556914806365967,1.806292176246643,2.5215353965759277,-1.578300952911377,-0.38650715351104736,-1.2735787630081177,2.861259698867798,-1.0693165063858032,-0.11211782693862915,-1.4761550426483154,-1.0007219314575195,2.2213943004608154,1.6579716205596924,-1.1783512830734253,-2.032618284225464,-1.0729193687438965,3.294553756713867,3.7233121395111084,0.7083590626716614,0.7932084202766418,-0.43725067377090454,-1.7151542901992798,3.297287702560425,1.088718056678772,2.552849054336548,-2.491953134536743,-3.707303285598755,-1.3112413883209229,0.5832326412200928,2.345587968826294,-1.8441919088363647,-1.8939448595046997,-2.379528045654297,1.3638938665390015,0.29719167947769165,-2.2308876514434814,1.2402269840240479,0.1948060542345047,-0.6884768605232239,1.040779709815979,-0.7635748982429504,-0.9827272295951843,0.04568619281053543,3.152057647705078,-0.7109458446502686,-1.4198905229568481,-2.062127113342285,-0.6980205774307251,2.390899181365967,-0.14485296607017517,-0.507155179977417,-0.865737795829773,-0.783266544342041,-2.9054834842681885,0.05621286481618881,0.19385358691215515,-0.8095817565917969,0.7065800428390503,1.1688458919525146,0.7602044939994812,-2.490936756134033,-0.3771384656429291,2.3707714080810547,-2.87514591217041,1.2755694389343262,1.3946422338485718,2.8948512077331543,2.300690174102783,-1.4990642070770264,-1.7032219171524048,-2.4819562435150146,0.8592680096626282,0.5287596583366394,3.070683479309082,-0.07424070686101913,-2.6849751472473145,-0.9841897487640381,-0.8873916864395142,0.14451853930950165,-0.8953091502189636,-0.20618940889835358,1.1910686492919922,-2.059617280960083,-0.2353956699371338,-2.7485568523406982,-1.7374039888381958,-0.8919137120246887,1.2847477197647095,-1.2103877067565918,-1.5427420139312744,-2.772198438644409,2.16715931892395,1.8627444505691528,4.2049713134765625,-1.341832160949707,0.8309377431869507,-0.5109269618988037,2.931008815765381,-0.24773426353931427,1.9985027313232422,1.0009181499481201,-2.3028063774108887,2.233266830444336,-1.0638824701309204,-0.7883734703063965,2.579846143722534,-1.6825462579727173,2.299380302429199,3.296314239501953,-0.7825500965118408,-0.41640833020210266,-1.65859055519104,1.4521403312683105,-2.6328864097595215,1.2312533855438232,2.152269124984741,-2.2142961025238037,2.0341875553131104,-0.5263852477073669,3.6813647747039795,-0.42547696828842163,3.37414813041687,-1.3151264190673828,-0.8062939643859863,0.7265641689300537,-0.2404121458530426,-2.176621437072754,0.03230583295226097,-1.3253920078277588,3.494447946548462,1.0639619827270508,1.787824273109436,0.050500184297561646,3.716409683227539,0.25963088870048523,1.0988845825195312,-0.4646734297275543,3.55344295501709,1.2250230312347412,2.1403863430023193,2.07906174659729,1.5530295372009277,3.05310320854187,-1.3330919742584229,1.2662924528121948,0.18241852521896362,0.39110952615737915,1.3382478952407837,-0.14840883016586304,-0.32395634055137634,-2.1916093826293945,-1.5043474435806274,-0.9067896604537964,0.10164570808410645,-2.5284321308135986,1.7116392850875854,0.9765229821205139,2.561572551727295,-0.47150060534477234,-3.5273377895355225,-0.05992374196648598,-2.716296911239624,-0.6567090749740601,0.2617853283882141,-1.2170459032058716,-1.7295621633529663,-1.6891889572143555,-1.855468511581421,-1.2918357849121094,3.3632802963256836,-0.417523592710495,2.7256977558135986,1.3094606399536133,-2.0831727981567383,0.5764222741127014,-2.6846532821655273,-1.934765338897705,3.5549821853637695,3.183077096939087,2.8318326473236084,-0.5019675493240356,2.6396002769470215,-0.4373525381088257,1.148910641670227,3.1515495777130127,-3.5129969120025635,-1.209418535232544,-1.325087547302246,1.3699558973312378,3.310256004333496,-0.7138935923576355,-2.4226627349853516,-0.2310829907655716,-1.7014051675796509,1.6769866943359375,-1.042091965675354,2.9362072944641113,-0.6970486044883728,-1.0532034635543823,-0.28638556599617004,2.8260886669158936,-0.2928106188774109,0.2368701696395874,2.842555522918701,2.9600889682769775,1.4229625463485718,0.007821065373718739,1.8150074481964111,0.029032062739133835,0.3928903043270111,-1.5069302320480347,-1.2597379684448242,-0.5202205181121826,-1.0869724750518799,-0.08788490295410156,1.369070291519165,0.38096168637275696,-0.5114955306053162],"z":[-0.030828116461634636,1.581101894378662,-0.6864810585975647,2.43387770652771,0.7264134287834167,0.5759034752845764,1.5192867517471313,1.0929338932037354,1.554980754852295,-0.6370713114738464,1.254409670829773,-1.9800639152526855,0.8774979114532471,1.9180908203125,-1.3742469549179077,4.2942118644714355,2.6385304927825928,3.273918628692627,1.3240715265274048,2.1845357418060303,0.0534546822309494,1.4465664625167847,4.525548458099365,0.9524871706962585,-1.0496307611465454,3.656444549560547,0.309916615486145,0.9846665859222412,1.290549635887146,-1.2113003730773926,1.239290475845337,0.05827353149652481,3.1329498291015625,2.348295211791992,2.8777804374694824,-0.5592895746231079,0.9319401979446411,-0.41814619302749634,0.17833051085472107,1.4289973974227905,1.530227541923523,0.35078752040863037,0.4447488784790039,-2.20595121383667,2.764061689376831,-1.1307728290557861,0.5241900086402893,0.0861104279756546,1.1428970098495483,-2.567286729812622,2.3389651775360107,0.2572041451931,1.5836849212646484,0.19428470730781555,-2.9082491397857666,1.980566382408142,1.1669515371322632,-0.5497859120368958,-0.44791993498802185,1.498526692390442,-0.9813021421432495,-0.7611442804336548,2.9501142501831055,-0.29630210995674133,1.1909632682800293,0.9476433396339417,4.57632303237915,1.665715217590332,0.949249267578125,3.8314270973205566,-0.9952399730682373,6.060637950897217,1.0301398038864136,-2.5456132888793945,2.3981759548187256,-2.9687139987945557,-3.137836456298828,1.6469166278839111,-1.8007094860076904,1.3806933164596558,0.9011886119842529,0.17998038232326508,2.8580939769744873,-0.04271391034126282,-0.7149657011032104,0.12031383812427521,1.698912501335144,-2.4393043518066406,1.0090948343276978,-2.24908185005188,-0.7091772556304932,2.944004535675049,2.0771663188934326,-1.3205559253692627,1.7385532855987549,0.40626245737075806,1.358414649963379,1.183243989944458,2.6436686515808105,2.3669047355651855,-0.0786416307091713,3.478884220123291,-1.1796743869781494,1.163101315498352,1.7208846807479858,-0.6629829406738281,1.1449662446975708,1.4889235496520996,1.4830262660980225,0.22381646931171417,-0.5234079360961914,4.4862446784973145,2.9251925945281982,1.0740565061569214,2.797372579574585,-1.8014070987701416,2.7500035762786865,-0.5612857341766357,4.973811149597168,0.9032628536224365,0.22399786114692688,-0.37923941016197205,1.2949048280715942,2.1034653186798096,0.856349527835846,-0.15562915802001953,-0.5335763096809387,1.6150654554367065,3.817800760269165,2.3659629821777344,-0.25737547874450684,3.182343006134033,3.3244142532348633,-0.5414284467697144,2.2173757553100586,2.290030002593994,-0.07833883166313171,0.05909724161028862,2.7057929039001465,3.2558257579803467,-0.013490729033946991,0.8282093405723572,2.8754067420959473,1.6228673458099365,3.000187873840332,-1.3312498331069946,-0.4618888199329376,-1.352683186531067,-0.2420896738767624,1.3953537940979004,-2.5701231956481934,-3.6196203231811523,0.6610205769538879,-0.04583409056067467,1.1838194131851196,0.24228990077972412,-3.013329029083252,1.0660582780838013,1.7376725673675537,0.042092666029930115,1.5989978313446045,-1.2216020822525024,-0.540186882019043,1.1212841272354126,1.8300381898880005,-1.6351356506347656,0.053811028599739075,-0.4261995851993561,-0.2653217911720276,1.2751448154449463,-0.979393482208252,-1.1980998516082764,0.07680699974298477,2.199584722518921,1.6008810997009277,-0.5669555068016052,-0.19094251096248627,1.2880492210388184,1.5432240962982178,-2.0718953609466553,-2.1190762519836426,0.8962582945823669,-3.0919268131256104,1.2841607332229614,1.1250771284103394,1.0881267786026,-1.3343650102615356,0.35277116298675537,-0.008905586786568165,6.143791198730469,3.599503993988037,4.99864387512207,0.42749476432800293,4.547820568084717,-0.015857085585594177,-1.3061048984527588,-0.2344365119934082,-0.5810925364494324,2.711686849594116,1.705782175064087,1.7100387811660767,0.9590581059455872,-1.2030291557312012,-0.7512521743774414,0.862343430519104,1.0348578691482544,3.7585203647613525,-0.5892730355262756,-0.7227986454963684,0.5452612042427063,0.45036739110946655,0.6025564074516296,-1.1351306438446045,4.498234272003174,0.4955059587955475,-0.7844979166984558,0.13361521065235138,-0.8392184376716614,3.7907307147979736,1.3911206722259521,0.34978601336479187,4.214706897735596,1.2133088111877441,0.3109659254550934,2.7223708629608154,-1.2221921682357788,3.522852659225464,-2.22240948677063,-0.6449444890022278,1.4400079250335693,2.6209237575531006,1.1344691514968872,0.6982840895652771,0.5498756170272827,0.9933984279632568,1.1952741146087646,0.25571373105049133,4.089095592498779,-0.6971291899681091,0.5019975304603577,-1.4346016645431519,-1.399472951889038,-0.25821784138679504,-0.1345239132642746,3.236168146133423,-1.5469447374343872,1.4280991554260254,0.250037282705307,1.869739294052124,3.781724452972412,2.316115140914917,3.251326084136963,1.5338938236236572,0.2822481095790863,0.7231894135475159,-0.7114395499229431,-0.18917065858840942,0.7719674110412598,4.026001930236816,-1.07466721534729,3.4583308696746826,0.7435760498046875,0.7880932092666626,-0.16055501997470856,-2.277186155319214,1.0573257207870483,0.856582522392273,2.2163007259368896,0.8812940120697021,-1.5065873861312866,-3.513798236846924,-1.9784278869628906,1.8819282054901123,0.47249338030815125,1.0968663692474365,-1.0790839195251465,4.247348308563232,3.1640732288360596,3.5370290279388428,-0.6464682817459106,-0.48834145069122314,-0.02812064066529274,-0.25257429480552673,-1.7677487134933472,1.3726356029510498,1.4930787086486816,1.2183116674423218,-0.03922354802489281,0.5068379044532776,4.537313938140869,-0.7052920460700989,0.8563953042030334,3.8008501529693604,-0.9392870664596558,0.8524412512779236,3.2014808654785156,2.4788694381713867,0.4484681189060211,3.17451548576355,2.950406551361084,-1.036755919456482,0.7491724491119385,2.531926155090332,-0.9877395629882812,0.7058337926864624,-1.3578951358795166,1.271185040473938,1.7371611595153809,1.6532196998596191,2.3569068908691406,1.9510830640792847,0.33758172392845154,3.302241802215576,1.702905535697937,-0.16283316910266876,0.8113914132118225,2.3288230895996094,2.960505485534668,1.0811412334442139,0.7391443252563477,-2.712556838989258,2.8906350135803223,-3.7892658710479736,0.6187862753868103,0.8621968626976013,4.309269428253174,2.667538642883301,2.7806692123413086,3.3927576541900635,3.818324089050293,-1.0291763544082642,1.1646491289138794,-3.3043971061706543,2.0349531173706055,-2.1528444290161133,0.6435756087303162,-0.3168780207633972,1.114046335220337,0.14474424719810486,1.6685280799865723,-0.1093531921505928,-2.628572702407837,-0.650376558303833,0.11810039728879929,-1.097816824913025,2.977147102355957,0.14801524579524994,1.20368230342865,-2.128770112991333,1.5991219282150269,-1.4480798244476318,-0.7057396769523621,-1.5329627990722656,-0.33514347672462463,5.532978534698486,1.9111605882644653,0.9601809978485107,0.35014739632606506,2.297917127609253,-0.08786305040121078,2.2324416637420654,2.296052932739258,0.20185548067092896,0.031633976846933365,0.06460007280111313,-1.8124839067459106,0.2293137013912201,0.2958466708660126,-2.423583507537842,2.8295865058898926,4.58801794052124,-1.7646476030349731,0.5712116360664368,1.7889604568481445,-1.4212721586227417,-1.7781435251235962,0.4769698977470398,-0.590863049030304,3.825727701187134,-3.268389940261841,-2.8502140045166016,4.032351970672607,-1.589273452758789,-1.7076146602630615,3.8286519050598145,0.6037353277206421,2.6498849391937256,2.278144359588623,-2.6433181762695312,3.0031893253326416,-0.22555920481681824,2.7276992797851562,1.5064606666564941,-0.45457252860069275,2.2080657482147217,0.7071974873542786,1.9973355531692505,1.900809645652771,-0.039580345153808594,3.686452865600586,1.5841470956802368,2.5067710876464844,-1.345846176147461,1.7101858854293823,-1.3395098447799683,2.2508792877197266,1.4158130884170532,0.37234780192375183,-1.7348546981811523,2.4474165439605713,1.73515784740448,1.0017929077148438,-1.453976035118103,-0.5324872136116028,0.06441539525985718,-3.5275232791900635,2.972106456756592,-0.31977954506874084,3.4445784091949463,1.3611027002334595,3.1610348224639893,1.9539929628372192,1.0519787073135376,-0.703992486000061,-0.8797515034675598,-2.185511589050293,-1.351326584815979,-1.4272830486297607,1.7301321029663086,1.1459920406341553,-0.6728426814079285,-0.5156694650650024,0.548848032951355,1.2776598930358887,3.431555986404419,0.08535472303628922,3.1616201400756836,0.07791181653738022,0.5241985321044922,0.4552122950553894,-1.8642092943191528,-1.6556446552276611,1.1440752744674683,3.6904053688049316,-0.3439270555973053,-1.561318278312683,0.41546860337257385,2.9001176357269287,-2.694314956665039,2.275408983230591,1.0314011573791504,1.2609111070632935,1.2658326625823975,-1.5021381378173828,-1.88726007938385,2.0272960662841797,-1.3148350715637207,-1.5536508560180664,-1.8559656143188477,-0.4586399495601654,-0.7288060784339905,-1.5881181955337524,1.7809996604919434,0.655559778213501,0.798651397228241,0.8050134181976318,0.4011456072330475,2.0105602741241455,0.6317573189735413,1.3252445459365845,-1.600656270980835,1.6712980270385742,-1.0816938877105713,1.8850363492965698,-2.0369155406951904,-0.5122162699699402,1.2305923700332642,1.3993444442749023,2.503376007080078,1.8651313781738281,3.18900728225708,2.7935545444488525,0.2586207091808319,-1.67266047000885,-1.8635995388031006,2.311378002166748,-2.291395902633667,0.17068932950496674,0.6382448077201843,1.8738257884979248,4.808135032653809,-0.7341814637184143,-0.1481422483921051,-1.5216752290725708,3.9562675952911377,1.5104176998138428,1.8248893022537231,2.552131414413452,0.8850747346878052,2.3970789909362793,1.2539364099502563,-1.0338557958602905,-2.089804172515869,0.02327796444296837,-2.1004092693328857,0.7561217546463013,1.1737098693847656,0.9460274577140808,-1.59382963180542,0.051068760454654694,0.8161536455154419,0.4550168514251709,0.5670058131217957,0.7334762215614319,-1.1416383981704712,3.586601734161377,1.7510074377059937,2.6738905906677246,-0.6941989660263062,0.2910102307796478,-0.9485250115394592,2.1449198722839355,3.0314834117889404,-2.4227118492126465,1.519360065460205,1.21957528591156,0.17170532047748566,-2.608567953109741,-0.5348822474479675,-1.4419732093811035,1.2768490314483643,-0.08516661077737808,1.0637617111206055,0.3030019700527191,2.1928493976593018,2.959953784942627,-2.4481725692749023,3.36501145362854,-0.81143718957901,0.5261929035186768,-3.1220827102661133,2.9618403911590576,0.13345925509929657,0.9506732821464539,1.3716100454330444,-2.3612048625946045,1.002234935760498,3.060532331466675,-1.186170220375061,3.8309926986694336,-0.6314961910247803,-0.24417871236801147,1.0069398880004883,3.8062450885772705,2.259108066558838,4.180576324462891,1.1699281930923462,3.226909875869751,-2.2824110984802246,-1.2422075271606445,1.5899784564971924,1.0698597431182861,-1.853949785232544,-1.7906363010406494,1.1894723176956177,-0.06112708896398544,-0.2708089351654053,3.5907275676727295,-1.8726011514663696,-0.814117968082428,3.094998836517334,2.6737184524536133,1.33267080783844,-2.3014321327209473,-3.5378668308258057,0.5490500926971436,-1.666616439819336,1.117738127708435,-1.1085662841796875,-2.3199405670166016,2.5902621746063232,-1.0516548156738281,4.0746073722839355,2.552614212036133,0.9531474709510803,1.2224795818328857,5.769648551940918,0.38328227400779724,0.9576156139373779,-1.7421969175338745,0.8852335214614868,0.814916729927063,0.6682794690132141,1.2559531927108765,-2.9208171367645264,-0.8196550011634827,-2.3663763999938965,0.44701066613197327,1.1544245481491089,-1.0276591777801514,0.5595459938049316,4.126126766204834,0.5861281156539917,-1.6897364854812622,-2.279937744140625,-1.0731171369552612,2.359409809112549,-0.5274304151535034,1.1597521305084229,1.8588467836380005,1.2779350280761719,1.2432150840759277,3.058980941772461,-0.8024048805236816,0.885587215423584,0.9383792281150818,4.175074577331543,-1.0078141689300537,3.820366621017456,4.873221397399902,0.46356311440467834,0.7921082377433777,-0.5875235795974731,3.562985420227051,3.329268455505371,-0.4955703318119049,2.890310764312744,0.5557155609130859,1.1138254404067993,-1.3143010139465332,4.063508987426758,0.5872936844825745,1.2350656986236572,0.12464441359043121,0.5371294021606445,-1.389208436012268,-2.827953815460205,0.5693460702896118,-1.0825449228286743,0.2629450261592865,2.483217239379883,1.4980064630508423,-0.9718677997589111,1.3158732652664185,-3.900421142578125,-1.9278308153152466,-0.5346943736076355,0.5288306474685669,-1.5106661319732666,-1.2577300071716309,2.1242167949676514,-1.372994303703308,1.2650986909866333,1.6067315340042114,-1.5082217454910278,3.4215009212493896,3.528934955596924,1.8330504894256592,-3.507307529449463,4.504946708679199,3.507295846939087,-1.9958250522613525,1.8992911577224731,2.6760475635528564,1.0951659679412842,1.6888587474822998,0.8731018304824829,0.14838752150535583,1.2901338338851929,-2.060795545578003,3.3247547149658203,1.3825809955596924,-1.7029078006744385,2.516071081161499,1.7360166311264038,1.3470475673675537,1.7186968326568604,-0.5185068845748901,3.344165086746216,-0.01884136162698269,3.2820470333099365,0.516612708568573,0.2532026469707489,0.7680230736732483,3.572232961654663,2.132054328918457,0.307706356048584,0.9209558367729187,-1.3312040567398071,0.5212871432304382,-1.4378529787063599,4.145707607269287,0.5658100247383118,1.7676727771759033,2.4400644302368164,1.7328473329544067,3.023164749145508,2.4540624618530273,-3.1345720291137695,0.040819697082042694,-0.6208995580673218,1.2593530416488647,0.6025471091270447,2.010928153991699,-2.5241827964782715,1.0861960649490356,1.643887996673584,2.5397231578826904,0.11970628052949905,-1.1614254713058472,0.522943377494812,0.8572744727134705,2.506963014602661,2.9913883209228516,-0.15655425190925598,1.8429269790649414,-0.7324219942092896,-0.2293493151664734,2.8306427001953125,-0.09336388111114502,2.6670806407928467,1.4279195070266724,-2.06014084815979,2.9436726570129395,-1.689882516860962,0.3457475006580353,0.588196873664856,0.4389911890029907,2.3770363330841064,2.164828062057495,-0.7662357687950134,1.3277736902236938,-0.7822649478912354,2.1686697006225586,1.211767315864563,-0.7346571683883667,1.972403883934021,0.13530279695987701,1.2527498006820679,-0.550273060798645,2.552053213119507,4.594223976135254,2.2285590171813965,0.06334614753723145,-2.5743885040283203,-0.524529218673706,0.6072210073471069,2.326782464981079,2.407029628753662,2.7576491832733154,-1.7518802881240845,1.654837965965271,-0.228646919131279,1.087758183479309,2.5833568572998047,3.657853364944458,1.5817053318023682,0.7388205528259277,-0.22265496850013733,3.30596661567688,-1.6988096237182617,4.46056604385376,0.7308464646339417,0.6672072410583496,-1.245530605316162,0.7953318953514099,0.14366237819194794,1.8210198879241943,-1.912534236907959,2.065808057785034,-2.0929598808288574,1.383666753768921,3.192748785018921,2.9078192710876465,1.368923544883728,3.1921658515930176,2.5029520988464355,-0.45987579226493835,0.4385041892528534,2.9512593746185303,1.4335505962371826,-0.4957255721092224,0.8820198774337769,1.9606925249099731,4.424708366394043,-0.5689161419868469,2.394568681716919,3.1164653301239014,2.759338140487671,2.725646495819092,1.538450002670288,2.1041693687438965,0.5685791969299316,-0.04933203011751175,3.835106611251831,-1.4989264011383057,1.2418166399002075,-1.7554330825805664,0.1451096385717392,1.7052090167999268,0.5249821543693542,-0.2627776861190796,3.350499153137207,0.5716859698295593,1.2035009860992432,2.4681074619293213,1.293805480003357,1.7277404069900513,1.6730636358261108,-3.2559189796447754,-0.04792316257953644,0.9003086090087891,2.908212184906006,2.333550453186035,-0.18822872638702393,-2.753943681716919,0.06415348500013351,-0.9730724692344666,2.076321840286255,-0.7443801164627075,0.9522189497947693,0.21186138689517975,1.6632484197616577,0.009018662385642529,-1.1667449474334717,-0.023186519742012024,0.17520977556705475,2.445613384246826,0.4034118950366974,1.6346102952957153,-0.6683452129364014,1.0821740627288818,3.2608981132507324,2.565563440322876,1.3695052862167358,1.3867617845535278,1.1348366737365723,3.334789276123047,-0.5775997042655945,-1.5434753894805908,1.0602693557739258,1.1435441970825195,5.04638147354126,0.37646356225013733,-1.4753836393356323,3.9541075229644775,2.060044765472412,-1.0249457359313965,-0.020187780261039734,1.7432957887649536,-1.865152359008789,-0.5470557808876038,-1.5009757280349731,2.7758712768554688,1.3508130311965942,2.857715368270874,3.411808967590332,0.573417603969574,1.1218388080596924,1.0305249691009521,1.8112068176269531,2.5772252082824707,3.3410580158233643,-2.9373254776000977,3.857497215270996,1.8604973554611206,2.46096134185791,0.729873538017273,-4.035524845123291,1.5240463018417358,-1.2740540504455566,0.5339546799659729,0.9769660830497742,2.850486993789673,3.625694990158081,-0.8100848197937012,0.4977136254310608,0.12041390687227249,-0.3194701373577118,-1.649766445159912,0.5575140118598938,0.3991135358810425,0.16918207705020905,0.06430404633283615,-2.7855892181396484,2.1435539722442627,0.3810036778450012,-1.0979952812194824,-1.413114309310913,0.7795201539993286,-0.5028271675109863,5.3683762550354,3.246941566467285,2.6224238872528076,0.762287974357605,1.2914620637893677,2.4182426929473877,-0.6824743747711182,4.340985298156738,4.037481307983398,0.6773881316184998,2.276780128479004,-1.3592740297317505,0.3871798515319824,-1.0632976293563843,-1.365096926689148,0.3395236134529114,-0.5847935676574707,-1.8865597248077393,-1.9073492288589478,-1.366269588470459,0.47866684198379517,0.3389814496040344,1.7461621761322021,3.965900182723999,2.802330255508423,3.07057523727417,0.9915852546691895,1.0771980285644531,0.20134316384792328,2.105809450149536,0.3462733328342438,0.44594335556030273,-1.4395707845687866,-0.06376156955957413,-2.23909854888916,0.022515594959259033,-3.320970296859741,3.1464223861694336,-2.479703664779663,-1.569668173789978,-1.8058209419250488,2.6568849086761475,0.6540048122406006,-0.2800883948802948,-0.6199584603309631,-1.2984966039657593,-3.481917381286621,1.6284931898117065,-0.5972263813018799,-0.3780073821544647,3.1080336570739746,1.8179833889007568,4.586646556854248,1.0569945573806763,3.051708698272705,-0.28303879499435425,0.5545771718025208,-1.6128959655761719,-0.42727044224739075,-0.40279316902160645,1.9417792558670044,-0.6735154390335083,-2.4351959228515625,0.7294265627861023,-0.9739808440208435,0.3216792941093445,2.054509162902832,-1.5233508348464966,-0.4560477137565613,1.9830201864242554,-0.9496288299560547,1.814518928527832,1.5501025915145874,0.07351122051477432,3.095965623855591,-0.3797999918460846,1.6353344917297363,2.0106613636016846,2.147268772125244,4.365578651428223,0.9006254076957703,2.1866021156311035,-0.21611392498016357,4.4495768547058105,1.7753198146820068,0.2944851219654083,2.892206907272339,0.20728106796741486,0.45750612020492554,2.1224076747894287,1.6646828651428223,-2.1313469409942627,2.5669307708740234,-1.9004576206207275,0.8788651823997498,1.171088695526123,-2.733534812927246,1.5919617414474487,1.1103332042694092,1.6000345945358276,0.41024649143218994,1.3781707286834717,1.7057055234909058,-0.6643661260604858,3.3891561031341553,2.343726634979248,-0.20590639114379883,-1.722281813621521,0.8828120827674866,0.795509397983551,-0.17266735434532166,-0.49112531542778015,2.4050838947296143,0.8307752013206482,0.29889267683029175,-0.6790122985839844,2.794879913330078,1.2403212785720825,1.4521313905715942,0.19060838222503662,-0.9938645362854004,1.768624186515808,2.531900405883789,1.795906901359558,1.8872888088226318,3.239020824432373,1.9210652112960815,0.36862438917160034,-0.07618696242570877,0.5242317914962769,2.7726898193359375,1.457736849784851,1.2424284219741821,2.8770062923431396,0.29426413774490356,0.39313480257987976,2.303464651107788,3.349900722503662,-1.0139756202697754,2.178499698638916,1.3245501518249512,2.2490363121032715,1.1845228672027588,1.8033723831176758,-0.17269600927829742,2.800382137298584,2.1953673362731934,-1.276723027229309,0.0706259235739708,-1.164212703704834,0.19603559374809265,-1.7531261444091797,-0.976262629032135,1.0391589403152466,-0.353506863117218,2.837465524673462,1.4555482864379883,0.2672523260116577,0.3045268654823303,-1.4870671033859253,1.6519079208374023,1.1413744688034058,1.8673465251922607,0.36408230662345886,-0.17020882666110992,2.9231483936309814,2.5509560108184814,0.058652132749557495,1.2017000913619995,2.8371403217315674,0.9171642661094666,0.9422311782836914,-3.3511428833007812,-1.044206142425537,-1.047203779220581,1.79729163646698,2.79645037651062,1.380141258239746,1.9128636121749878,-1.9012869596481323,2.0668416023254395,2.1392831802368164,-1.462552785873413,0.11678223311901093,2.2281157970428467,0.4687558114528656,0.07104647904634476,1.4276586771011353,2.245959520339966,-1.24382483959198,1.7646582126617432,0.6341745853424072,1.969022274017334,-0.3979281783103943,2.035356044769287,1.8184757232666016,-0.6103100180625916,2.420583963394165,0.35255861282348633,2.4814345836639404,0.9898602962493896,0.3147560954093933,0.16260850429534912,1.9148123264312744,0.17898593842983246,1.2940526008605957,2.182790517807007,-1.2584508657455444,2.045710802078247,1.096876859664917,-1.7235287427902222,-1.8265528678894043,-3.6443467140197754,0.3853066563606262,0.8262606263160706,-0.9677765965461731,1.9969203472137451,0.5589849948883057,-0.1788925975561142,1.3766807317733765,3.786996841430664,2.8906397819519043,3.061293363571167,0.23501178622245789,-1.160658597946167,1.3659225702285767,5.099056720733643,0.3491133749485016,-0.508630633354187,2.943493604660034,3.897270441055298,2.378364086151123,0.8927735686302185,-1.2385544776916504,2.610569715499878,0.8938827514648438,-2.312472343444824,1.1539671421051025,1.4476677179336548,0.45041999220848083,2.1937479972839355,0.7720629572868347,2.2419214248657227,-1.1641461849212646,-1.816957712173462,-1.2016409635543823,3.4319381713867188,-2.086775064468384,1.1130532026290894,1.3883177042007446,-0.141951784491539,-2.7298429012298584,1.5423460006713867,0.6976221203804016,3.4396474361419678,-0.06118854880332947,1.2905972003936768,3.3114795684814453,1.1541032791137695,-0.2504296898841858,0.24203243851661682,-0.17954011261463165,0.23669646680355072,2.492033004760742,-2.6000077724456787,1.7157655954360962,-1.1981984376907349,2.5304014682769775,-2.0610830783843994,-0.6391079425811768,2.3485443592071533,0.9202829003334045,1.9174195528030396,-2.0851247310638428,2.0010111331939697,-0.3829883933067322,-2.4771156311035156,-1.3447750806808472,-0.8726227283477783,0.15715260803699493,-0.46035757660865784,0.11116287112236023,-2.2855727672576904,0.37188395857810974,1.0984394550323486,-0.5974168181419373,-2.0205130577087402,0.34222400188446045,2.4123575687408447,0.8171196579933167,0.8833873867988586,2.526460886001587,-0.4115256071090698,3.8790299892425537,-1.1306759119033813,0.13174410164356232,-0.5415021181106567,2.738467216491699,1.0529758930206299,-1.1751405000686646,1.6688522100448608,1.8315473794937134,3.009075880050659,-1.57401442527771,2.1605868339538574,1.1291460990905762,1.4165881872177124,2.908661127090454,-4.8878703117370605,-1.2375853061676025,-0.19641341269016266,0.7039437294006348,2.120687484741211,0.8071942329406738,-2.1252832412719727,-1.5054140090942383,0.00045187168871052563,2.4465222358703613,1.1323283910751343,2.4154410362243652,2.1639811992645264,1.655951976776123,0.35016608238220215,-1.3704830408096313,0.28604447841644287,3.5959224700927734,-1.5146636962890625,-0.3180197477340698,2.245288610458374,-0.7984020113945007,1.223249912261963,-1.5293089151382446,1.9298075437545776,1.6401965618133545,-1.2898969650268555,-0.6719531416893005,2.0837106704711914,0.8739396929740906,0.7118946313858032,-1.38539457321167,2.180802583694458,-1.1119240522384644,-0.5144904255867004,-1.9768030643463135,-3.077396869659424,1.1518226861953735,1.5002421140670776,-0.689914882183075,1.529418706893921,0.6581291556358337,-0.06453607231378555,1.671383261680603,3.4759907722473145,1.7927639484405518,3.214986562728882,-0.1616155505180359,0.46237727999687195,0.609344482421875,0.6555101871490479,1.832802176475525,3.0919082164764404,-2.4570658206939697,1.4679014682769775,-0.4494566023349762,1.6822855472564697,3.7578940391540527,-3.198795795440674,2.5100369453430176,-1.8138664960861206,0.43244126439094543,1.224912166595459,2.8679099082946777,-1.813918948173523,1.3903241157531738,0.6898432374000549,1.7626965045928955,-0.24124345183372498,-0.10890351235866547,0.180199533700943,-0.3283351957798004,1.5993255376815796,3.823206663131714,-2.0363850593566895,0.517558217048645,-0.7429609298706055,2.7700159549713135,1.3139950037002563,-0.1015184223651886,4.780825614929199,0.28427520394325256,1.6171634197235107,-3.979361057281494,3.4930500984191895,-0.8573887944221497,3.8215956687927246,0.32607781887054443,-1.7206981182098389,-2.9124302864074707,-1.679802656173706,1.1150051355361938,-0.355386883020401,0.2678427994251251,-1.3388097286224365,2.2094151973724365,1.0927777290344238,0.5733646750450134,0.5783101916313171,3.0771684646606445,1.2147506475448608,2.9154181480407715,2.518599271774292,0.815551221370697,0.2202577292919159,1.1568440198898315,1.5653855800628662,0.7442651391029358,2.8459091186523438,0.4814465045928955,-1.9730297327041626,3.9254708290100098,4.594875812530518,0.024713361635804176,1.306441068649292,1.1199547052383423,-0.7788962125778198,3.222310781478882,0.6658514142036438,0.3600805103778839,-0.9080392718315125,1.853907585144043,-0.3303673267364502,-1.050584077835083,0.39305394887924194,-1.639622449874878,-1.3658761978149414,2.3419430255889893,0.8434931635856628,0.41085994243621826,0.8524433374404907,-0.2857998013496399,0.6191203594207764,1.6713902950286865,1.155530333518982,2.2546205520629883,4.652883052825928,1.4720462560653687,1.4819660186767578,1.7674809694290161,3.480755090713501,-1.5690189599990845,-2.1167948246002197,1.3501588106155396,-0.13091887533664703,1.8163803815841675,2.5254690647125244,0.6634626984596252,0.007118848618119955,1.476317286491394,-2.2159883975982666,0.560259997844696,2.2179834842681885,0.7390375733375549,-0.8180046677589417,2.0331993103027344,0.11312723159790039,1.5469589233398438,0.25590261816978455,0.2325492948293686,2.1300408840179443,1.256166934967041,2.1283318996429443,-2.4201676845550537,-1.612259864807129,0.7218719124794006,3.854207992553711,0.1008012443780899,-1.2172383069992065,0.5792980194091797,-0.7114052772521973,1.369685173034668,0.7109901905059814,0.04684767872095108,0.04758613929152489,2.6434943675994873,0.16429206728935242,-0.036969225853681564,-1.602248191833496,-0.8665401339530945,1.1194897890090942,-1.1815950870513916,0.8507528305053711,1.780854344367981,-2.8670971393585205,0.027409231290221214,1.6739637851715088,-0.9201382398605347,-1.6148436069488525,-0.8085960149765015,1.0566123723983765,-1.3155864477157593,0.5235517621040344,-1.4420238733291626,4.457378387451172,-0.9146153926849365,-2.3758785724639893,-0.11001096665859222,-0.9740868806838989,4.222947120666504,0.4653342068195343,-2.5521140098571777,0.9822491407394409,3.4751787185668945,2.767634868621826,4.961499214172363,2.1681978702545166,2.080965995788574,-0.9874671697616577,-1.8472001552581787,1.334130048751831,2.369216203689575,-1.861289620399475,-0.09111888706684113,-2.8042261600494385,-0.5881417989730835,0.4476085901260376,3.134711265563965,-1.1210336685180664,2.355750799179077,2.113550901412964,1.8225197792053223,-2.478820323944092,0.30184993147850037,2.247281551361084,3.150925636291504,-2.4219517707824707,0.06019018590450287,-1.9545544385910034,1.6235673427581787,0.5107788443565369,-0.09046217054128647,4.138875961303711,5.301206111907959,-0.48153194785118103,2.885258436203003,1.188578724861145,0.011067491956055164,0.9524372220039368,2.0841195583343506,2.917642116546631,-1.4912153482437134,0.791090726852417,1.153008222579956,0.4951125979423523,0.5972877144813538,1.4798943996429443,-0.8982747197151184,0.44137105345726013,-1.2107436656951904,0.7717741131782532,1.1721309423446655,0.11600533127784729,0.9526956677436829,0.17772388458251953,0.8073372840881348,1.1985998153686523,0.3962138891220093,2.919419527053833,-1.8145407438278198,0.5474490523338318,0.9399647116661072,-0.023909425362944603,-1.975277304649353,2.010084629058838,2.299542188644409,0.3957682251930237,0.530540943145752,0.5777997970581055,0.34379953145980835,0.8654860854148865,1.979409098625183,2.4263370037078857,0.09294622391462326,-1.0480778217315674,0.8336916565895081,-1.9185924530029297,1.9723740816116333,4.45116662979126,0.32335591316223145,3.912618637084961,1.9007940292358398,0.27705755829811096,0.8739660382270813,-0.9836130738258362,1.4824135303497314,1.4616308212280273,-0.8583223819732666,-3.216409683227539,-0.2612759470939636,2.28818941116333,2.899867534637451,0.34926143288612366,3.5384974479675293,1.453141689300537,0.474052369594574,1.8857866525650024,2.271247625350952,2.0582330226898193,0.8358064293861389,0.8450908660888672,-1.4018290042877197,-3.7434847354888916,-0.32591062784194946,1.6878644227981567,1.2475841045379639,-0.8801510334014893,-0.8050125241279602,-1.845177173614502,1.9635143280029297,-0.15542368590831757,0.709222137928009,3.384786605834961,2.5481674671173096,1.3982046842575073,-0.9327826499938965,4.219557285308838,1.6181410551071167,4.1768693923950195,1.6379872560501099,0.2795027196407318,3.179368019104004,-1.2888870239257812,2.2263662815093994,0.3300049901008606,1.6218429803848267,0.21431805193424225,-1.3979263305664062,-0.31906870007514954,0.14174427092075348,1.9668025970458984,-0.041118230670690536,-1.9230767488479614,2.341484785079956,2.200822114944458,-0.7751657962799072,0.6184029579162598,3.4523849487304688,-1.1928142309188843,0.09770455956459045,-1.1445202827453613,2.1766762733459473,0.12167023122310638,2.9295973777770996,-1.1231064796447754,3.2933523654937744,1.6330170631408691,2.2154412269592285,0.358545184135437,2.9627063274383545,1.8158692121505737,2.006899118423462,0.8524379134178162,0.31169387698173523,1.1249778270721436,1.0726163387298584,2.1063570976257324,-2.3212220668792725,0.46218621730804443,2.7032408714294434,-2.1523032188415527,2.088498830795288,-1.117064118385315,1.3755114078521729,1.9015181064605713,1.0249313116073608,-1.0471267700195312,-1.2935575246810913,-0.126798614859581,-3.337104558944702,2.3298444747924805,-0.029107460752129555,2.6889781951904297,1.594089150428772,-1.392848014831543,0.6693752408027649,-1.6374235153198242,-1.8585721254348755,3.5235719680786133,1.1940659284591675,1.0483344793319702,0.34847038984298706,3.0944254398345947,-1.358572006225586,-0.7726808190345764,-2.519247055053711,-1.4804490804672241,-1.8922983407974243,0.4138251841068268,-1.104483723640442,3.3908886909484863,-2.0522031784057617,-2.743014097213745,0.6638434529304504,-0.029075074940919876,2.910547971725464,1.984810709953308,0.8115940690040588,1.4830293655395508,-1.027055263519287,0.7402259707450867,1.9728708267211914,2.5410585403442383,0.8222379684448242,1.79226815700531,-1.5135616064071655,0.13702012598514557,-0.09060195833444595,-0.5167163610458374,1.9948067665100098,1.6714985370635986,-0.5506750345230103,1.1341519355773926,-1.3701785802841187,1.9850355386734009,-2.072812795639038,-2.1411385536193848,2.120481252670288,1.5392541885375977,-0.9086939692497253,-1.3930764198303223,2.4980106353759766,2.3851966857910156,2.9838504791259766,2.437507152557373,0.3137285113334656,-0.9360049962997437,1.046080470085144,0.7393542528152466,1.6920579671859741,4.438598155975342,2.832503080368042,-0.056678012013435364,-0.17733973264694214,0.11586211621761322,-1.2742499113082886,0.7481376528739929,0.710748016834259,2.289470911026001,0.749867856502533,0.12516161799430847,1.8402081727981567,3.238417625427246,1.649592399597168,2.2675087451934814,0.6942486763000488,1.716681718826294,-2.2237062454223633,2.038994312286377,2.672800302505493,1.8439069986343384,-3.157571792602539,0.8706011772155762,1.6033360958099365,-4.606374263763428,-1.110082983970642,-0.816363513469696,0.9835107326507568,-2.536271333694458,0.9482877850532532,1.5755126476287842,-0.6521345973014832,0.6539603471755981,2.000530958175659,2.717853546142578,-2.5512208938598633,2.7346720695495605,-0.5071315765380859,1.8989464044570923,-2.5607738494873047,2.3284873962402344,0.4539482593536377,1.7579615116119385,1.3297781944274902,-1.6249736547470093,1.763662338256836,-0.37521639466285706,1.8647112846374512,0.90864497423172,1.8294109106063843,-1.8897958993911743,-1.5206184387207031,2.361239433288574,0.8459847569465637,0.13877452909946442,3.987851142883301,0.9378381967544556,-2.0070343017578125,-0.26614975929260254,3.20915150642395,-0.5635421872138977,-1.357554316520691,-1.1586967706680298,1.8723095655441284,-2.229609966278076,-3.5285189151763916,4.018404006958008,-1.2794355154037476,2.653738021850586,0.16117870807647705,1.4800193309783936,-0.35542866587638855,2.6109871864318848,-0.9161306619644165,2.024329662322998,1.1423393487930298,1.9299798011779785,1.010841965675354,-1.0357822179794312,0.26767346262931824,1.9229556322097778,0.899849534034729,0.858088493347168,-1.1406641006469727,-1.4072407484054565,0.5670448541641235,2.021864652633667,-0.1324070543050766,-3.5182905197143555,3.3298184871673584,3.1930837631225586,2.1505753993988037,1.6527068614959717,2.8419902324676514,3.678044319152832,0.6553658246994019,-0.14876627922058105,-0.7534092664718628,-2.6371662616729736,1.7492769956588745,1.2467832565307617,1.552099347114563,0.9905121922492981,2.1631574630737305,2.223289966583252,2.7823996543884277,0.239143505692482,1.444022536277771,4.085823059082031,0.6735856533050537,0.5054659247398376,2.4220001697540283,1.4017715454101562,0.03581620007753372,-0.12491855025291443,1.727831482887268,0.979487955570221,-1.9470161199569702,1.069342851638794,0.11236171424388885,-2.6598522663116455,3.52400541305542,-0.20309486985206604,2.518256664276123,1.9457428455352783,2.742140531539917,2.4921348094940186,-0.6842394471168518,0.05782784894108772,-1.804635763168335,0.48595795035362244,2.700606346130371,0.7583520412445068,-0.3143056035041809,-1.1798832416534424,2.8173933029174805,0.5978673100471497,-0.4270135462284088,1.422339916229248,1.7796249389648438,-1.4331551790237427,-0.82110196352005,1.9634045362472534,-0.08178012818098068,-1.8300952911376953,-0.2722790539264679,0.5733094811439514,2.545095682144165,-0.37902402877807617,0.7133786678314209,2.828731060028076,0.809016764163971,2.0965542793273926,1.3487221002578735,-1.4452006816864014,-0.5160815119743347,-0.7479361891746521,2.5096778869628906,-2.233226776123047,0.7479268312454224,-1.7853267192840576,0.5864279270172119,-1.3487478494644165,-0.2890430688858032,1.65640127658844,2.4126298427581787,0.8221361637115479,-0.7099103331565857,0.2230878621339798,-3.214576482772827,0.30210283398628235,3.1168839931488037,2.807004690170288,0.8093467950820923,0.8558099269866943,2.4172627925872803,2.66898512840271,1.334401249885559,0.5272864699363708,0.28164908289909363,-0.1313394457101822,3.696341037750244,0.7251119017601013,0.9935925006866455,1.869218111038208,1.1923226118087769,-0.5646535754203796,0.2253975123167038,2.436964511871338,-0.16619446873664856,1.807097315788269,0.151736319065094,-0.9533354640007019,2.806180000305176,-0.1427966207265854,2.157196283340454,0.6155052781105042,0.9144386053085327,-0.6932955980300903,-1.1149097681045532,1.1533359289169312,2.2348744869232178,-0.9101610779762268,-1.1141120195388794,3.4657323360443115,3.2331933975219727,-0.15191368758678436,0.8980849385261536,1.230534315109253,-1.1698826551437378,1.6156362295150757,2.5016698837280273,-3.6631410121917725,3.974885940551758,1.7704715728759766,-3.028193235397339,0.5700024962425232,0.08763071149587631,0.2942359745502472,2.5488555431365967,1.6280326843261719,-0.9526039361953735,0.5905520915985107,0.5955166816711426,0.4626472294330597,1.7447723150253296,2.283952474594116,0.514832079410553,3.180327892303467,2.848099708557129,1.8062182664871216,-0.8125710487365723,1.1561065912246704,-0.1788855791091919,-0.5391119718551636,3.116157293319702,-2.2011797428131104,-0.37060192227363586,-1.2942572832107544,2.083876848220825,-1.7242083549499512,3.461930990219116,3.2032322883605957,5.6310014724731445,1.3089543581008911,1.1397230625152588,2.40289306640625,-0.8279814124107361,0.05389159172773361,1.0719751119613647,-0.7345011234283447,-0.5515890717506409,3.6143317222595215,-1.2991533279418945,0.6469358801841736,-3.3990092277526855,1.7791248559951782,2.226050853729248,0.3534334599971771,-0.8761347532272339,-1.2258719205856323,1.1358551979064941,0.8121667504310608,-0.5329638719558716,2.0224978923797607,1.5920673608779907,1.2411749362945557,1.1099882125854492,1.547011375427246,1.4050450325012207,0.15077602863311768,3.000667095184326,2.1841037273406982,0.10237797349691391,0.5709757208824158,-0.7330033183097839,-0.6313586831092834,-1.8722903728485107,-1.2361552715301514,1.636314034461975,1.4016770124435425,1.2432788610458374,-1.191861867904663,-0.7862476706504822,1.0086379051208496,2.7597711086273193,4.12794828414917,1.089242696762085,1.1977620124816895,2.0460445880889893,2.455282211303711,0.5847520232200623,1.8707784414291382,4.548864841461182,5.211312294006348,0.15888294577598572,-3.4515230655670166,-2.864642381668091,3.518078327178955,2.3994059562683105,0.4834614098072052,4.489904880523682,-0.4775093197822571,0.9181666374206543,2.076258659362793,0.9645828604698181,-1.4172096252441406,1.992177963256836,2.916961908340454,2.2692747116088867,1.4360504150390625,-1.214573860168457,1.1376762390136719,0.937879741191864,-1.9091473817825317,-1.8280683755874634,2.1676535606384277,-0.5125985145568848,-0.8039225935935974,2.563995361328125,3.6449286937713623,1.3840854167938232,0.6653327345848083,-1.5309537649154663,-1.3411767482757568,-1.677964687347412,1.8013836145401,1.544866681098938,0.59946209192276,1.733307957649231,-0.574684202671051,0.569537878036499,-2.6501352787017822,0.6231947541236877,1.1731427907943726,-1.9086215496063232,0.42797577381134033,1.187295913696289,2.3306961059570312,4.051886558532715,-1.786831021308899,-1.0738115310668945,-0.46690383553504944,3.2234835624694824,0.896186888217926,1.19308602809906,-0.9212962985038757,-1.1675891876220703,1.2700049877166748,-0.028283357620239258,1.0763815641403198,-2.2044951915740967,0.2917034327983856,0.19851817190647125,-0.8347015976905823,2.9235548973083496,1.4442269802093506,0.5460628271102905,0.0658256933093071,0.9731948971748352,-0.7827612161636353,2.355008125305176,-2.250317096710205,-1.6607609987258911,4.102764129638672,-1.0662386417388916,0.444629967212677,1.401155710220337,-3.105609178543091,0.5922490358352661,0.6258518695831299,-1.6311708688735962,-3.436617374420166,2.461864948272705,-3.1575777530670166,-1.1800556182861328,0.06187817081809044,0.5890387892723083,-0.6991793513298035,0.7002651691436768,0.27857905626296997,3.232342004776001,-0.9657942652702332,1.820460319519043,1.7391424179077148,2.739368438720703,2.082381010055542,3.890547037124634,-1.4081746339797974,3.7880120277404785,-0.8188437819480896,1.046467900276184,0.587073028087616,-3.8659815788269043,0.502285361289978,1.1826770305633545,2.4064202308654785,0.9695305228233337,-0.9987277984619141,0.9375920295715332,0.8086696267127991,-1.0371270179748535,1.2964054346084595,1.587768316268921,0.27588045597076416,0.7298149466514587,1.3468899726867676,-0.8886533379554749,-2.4064414501190186,3.2983334064483643,0.5536945462226868,0.19552944600582123,0.11291158944368362,1.7636016607284546,0.1398138850927353,2.388766050338745,3.9499876499176025,-0.8698829412460327,-0.1710222065448761,1.6304823160171509,1.4489059448242188,1.2178518772125244,1.8685940504074097,2.326014280319214,2.9609737396240234,-0.982174277305603,-0.1041111871600151,2.339207887649536,-0.0794978141784668,-0.8428493142127991,0.2623882591724396,1.237663745880127,-1.9517754316329956,2.8203632831573486,1.092071533203125,-0.4229085147380829,-1.7185251712799072,0.7307317852973938,2.8096628189086914,0.43829864263534546,1.3523943424224854,2.6139519214630127,-0.7409323453903198,1.5310735702514648,2.8335061073303223,-0.31348907947540283,0.8026565909385681,-0.0006421065190806985,3.202242851257324,0.15342676639556885,0.6690136194229126,4.083747863769531,-0.2588263750076294,-1.8813902139663696,-1.3942958116531372,1.3572871685028076,0.3306897282600403,-0.2900216281414032,1.7466152906417847,1.1401795148849487,1.3728359937667847,-0.20499049127101898,2.0075016021728516,-0.7502725124359131,-3.1349077224731445,5.380187034606934,0.33427873253822327,-2.2066121101379395,0.7411143183708191,0.058519717305898666,0.07254305481910706,1.7347407341003418,0.9693485498428345,-1.3761321306228638,2.4508626461029053,-1.4906977415084839,1.0361692905426025,2.1661391258239746,3.3956198692321777,-0.7130459547042847,2.950805425643921,3.1877622604370117,1.9126677513122559,1.5725535154342651,0.04969991371035576,-2.070234775543213,1.2673434019088745,0.9951244592666626,-0.5293546915054321,2.594139575958252,-1.1940044164657593,0.9841134548187256,0.9384721517562866,-0.7056090235710144,0.15990974009037018,3.354170322418213,-0.4760252833366394,3.0436477661132812,-1.1035197973251343,0.05191890895366669,-0.5076644420623779,0.3583196699619293,1.3683011531829834,1.7322436571121216,2.5598349571228027,-3.0551841259002686,1.2000389099121094,-2.1007699966430664,1.364130973815918,2.2860488891601562,1.1463236808776855,-1.1784924268722534,2.410956382751465,0.9791262745857239,3.219682455062866,0.20738975703716278,2.632326126098633,0.31228694319725037,1.171065092086792,1.2805440425872803,0.4237293004989624,-0.36760443449020386,1.091153860092163,-2.4442570209503174,-2.120073080062866,2.434190273284912,0.2725480794906616,1.8715364933013916,0.42411008477211,1.523488998413086,4.420470237731934,-1.8400821685791016,-1.1079564094543457,1.1072463989257812,3.547971725463867,1.3556394577026367,1.949379563331604,3.477867364883423,0.01703510619699955,3.5834975242614746,0.6660467982292175,0.5890483856201172,-1.6818262338638306,1.5132778882980347,4.150378704071045,0.7267519235610962,-1.9045593738555908,0.938560426235199,2.8974342346191406,4.092768669128418,4.158133029937744,0.8641784191131592,0.5806418061256409,0.6970498561859131,-0.7262210845947266,0.7398094534873962,-0.74705570936203,-0.15014511346817017,-1.281574010848999,-1.7212281227111816,2.1468725204467773,2.2022905349731445,1.5815192461013794,0.969560980796814,2.6447441577911377,-3.4797770977020264,2.4560370445251465,-2.7019996643066406,-0.3503119647502899,-2.1288106441497803,-0.8472644090652466,1.0698490142822266,-3.6713476181030273,-0.24701151251792908,1.2569241523742676,-1.209980845451355,-1.4837000370025635,0.11297975480556488,0.6223162412643433,-1.9512412548065186,1.5731548070907593,2.6565163135528564,-1.9864630699157715,1.6340525150299072,4.095187187194824,2.5807223320007324,-0.36637941002845764,-2.511380195617676,0.4641609489917755,2.670102119445801,0.8212493658065796,-2.058002233505249,2.0901119709014893,-4.7433762550354,2.417292356491089,-0.06942645460367203,-0.6324365139007568,1.57130765914917,1.653628945350647,-0.09710066765546799,-0.1449660360813141,-1.312217116355896,3.1251754760742188,1.6598434448242188,-0.6056890487670898,-0.3403479754924774,1.3741368055343628,2.124850034713745,1.3183578252792358,1.8268733024597168,3.5226986408233643,2.8238017559051514,1.1132184267044067,0.5311345458030701,-2.7650625705718994,1.3825256824493408,1.6504040956497192,-1.3301432132720947,-1.3776589632034302,-1.5298888683319092,0.25816723704338074,3.525057077407837,-2.6939051151275635,-1.5571874380111694,0.5935946702957153,-0.8770114183425903,-2.019869804382324,-3.077068567276001,0.9382280111312866,-0.23628884553909302,2.770486831665039,0.11104346811771393,-0.401842325925827,-0.13625487685203552,1.5645661354064941,0.8124673962593079,-3.3761653900146484,-0.8441259860992432,2.312371015548706,2.4896438121795654,-1.0558322668075562,2.165405035018921,1.089221477508545,2.492500066757202,3.1628363132476807,-0.4277960956096649,3.048154830932617,0.7949624061584473,2.8924756050109863,0.9253896474838257,2.465611219406128,1.8527066707611084,-3.2623066902160645,0.47297403216362,1.5530588626861572,0.5788584351539612,1.3014566898345947,0.9527084231376648,1.3952083587646484,0.5944340825080872,1.8857207298278809,1.6276557445526123,1.7605688571929932,0.2691977918148041,2.285339832305908,1.621895670890808,-0.4787176549434662,3.7819881439208984,-1.3417202234268188,2.1669042110443115,2.0261337757110596,-0.7623506188392639,0.30786967277526855,1.4570817947387695,0.05279473215341568,0.38743969798088074,-1.5924005508422852,2.193312168121338,-1.806918740272522,1.4619009494781494,-0.6065857410430908,-1.0636786222457886,0.7920113801956177,1.1306027173995972,2.8719711303710938,0.1396087110042572,-0.9341447949409485,3.3545167446136475,0.24158184230327606,0.1964985728263855,-2.2063419818878174,3.244152069091797,-0.7975749969482422,-0.28393855690956116,-0.003648039884865284,-1.6353344917297363,1.1509411334991455,-1.5733736753463745,1.786217212677002,0.5919604897499084,2.72865891456604,-1.0985980033874512,-0.38269591331481934,2.6200294494628906,-0.39025256037712097,0.9832697510719299,-2.4167139530181885,-0.13633041083812714,1.4358431100845337,0.5598644614219666,0.8340282440185547,2.7900054454803467,3.505505084991455,0.3515879511833191,-3.0273592472076416,-0.9472132921218872,0.5685840249061584,2.233302593231201,2.5306684970855713,-0.3993307948112488,1.1202327013015747,0.9529155492782593,-0.8047407269477844,0.8939488530158997,3.4241411685943604,-1.9722203016281128,-2.80277419090271,2.4241976737976074,-2.604963541030884,-2.6276566982269287,-0.35559162497520447,-1.5625336170196533,2.335172653198242,2.6513631343841553,0.772676944732666,1.5614358186721802,0.6738559603691101,1.2927454710006714,-1.931679368019104,2.7169687747955322,-0.9600286483764648,-1.7965246438980103,2.969444513320923,5.303358554840088,2.541820526123047,-0.796869695186615,0.7156014442443848,2.173736810684204,1.5679945945739746,-0.028727717697620392,-0.21446940302848816,1.495229959487915,1.9984831809997559,-0.37515729665756226,-1.237446665763855,3.830289840698242,0.3671208918094635,-1.6340512037277222,-0.7815612554550171,0.581108033657074,-1.2333788871765137,0.528934895992279,0.09555831551551819,-0.8855666518211365,1.7415014505386353,5.44668436050415,2.3474345207214355,-0.20932124555110931,0.5490328669548035,1.403247356414795,0.5474316477775574,-2.3848519325256348,-0.7337687611579895,2.1776633262634277,-3.5419883728027344,-0.9626433253288269,0.0062752231024205685,-1.0407295227050781,1.6629397869110107,1.7934991121292114,-2.564552068710327,1.8573602437973022,-0.5706318616867065,-0.6714587211608887,-0.2239137589931488,0.18605352938175201,1.286197304725647,-0.061081286519765854,-0.633995771408081,-1.273398995399475,-3.131336212158203,-1.1986582279205322,2.3887717723846436,1.7929308414459229,0.6296008825302124,-0.8664761185646057,2.1091089248657227,-0.20428594946861267,0.8324199318885803,2.4918887615203857,5.918821811676025,1.9904347658157349,-0.9062175750732422,-0.7785965800285339,-0.22306431829929352,-1.088518738746643,1.4365756511688232,-1.6566122770309448,3.1816470623016357,1.1316323280334473,3.723789930343628,2.9907665252685547,1.3895970582962036,-1.2222322225570679,1.2443625926971436,2.892561435699463,2.1441848278045654,1.2136778831481934,3.4317233562469482,0.34770137071609497,0.46025386452674866,3.326627731323242,-1.6631183624267578,2.782073497772217,2.1764373779296875,0.6823322176933289,2.1747045516967773,0.6645579934120178,2.814423084259033,-1.4974876642227173,2.3688976764678955,0.3417230248451233,0.14947468042373657,-1.1712394952774048,1.1251572370529175,0.473854660987854,1.5162060260772705,2.3202714920043945,3.350165605545044,0.45149317383766174,0.6956499814987183,2.82767653465271,0.12937819957733154,-0.4808116853237152,-0.3087887465953827,-2.371601104736328,4.442577838897705,-0.683827817440033,-0.29374921321868896,3.585984468460083,1.8339844942092896,0.2966662645339966,0.7222985029220581,3.4888222217559814,-0.5649692416191101,1.1433202028274536,-0.5794826745986938,2.0363993644714355,1.1613377332687378,3.025721549987793,-0.6549690961837769,-0.141084223985672,-1.0207545757293701,1.6035269498825073,1.631564736366272,3.1618247032165527,1.5732871294021606,-1.8083033561706543,-2.659217357635498,-1.7155038118362427,0.013416306115686893,1.587942123413086,-1.8414983749389648,-0.4151679575443268,1.2762151956558228,-0.814839243888855,0.8649099469184875,-1.1697039604187012,1.1317020654678345,-0.23099207878112793,1.181315541267395,3.9467012882232666,2.070925712585449,-1.02606999874115,1.8536759614944458,0.19181902706623077,4.792631149291992,-0.41815388202667236,-0.13193345069885254,-1.7790788412094116,0.3306901156902313,1.7566605806350708,-2.366300106048584,3.116177797317505,0.9455022811889648,-0.9495192766189575,-1.687006950378418,0.49352121353149414,0.8863468170166016,-1.2865147590637207,-3.5785508155822754,1.5088351964950562,-0.4567188322544098,2.1506028175354004,-0.51102614402771,-0.121939517557621,-2.5522422790527344,-0.7676032781600952,2.669034719467163,2.095121383666992,0.46526744961738586,-0.3392089009284973,2.7783725261688232,2.1145360469818115,2.6924333572387695,-0.02216605842113495,1.155301809310913,3.6004638671875,-0.5532811284065247,1.7793670892715454,0.9972444176673889,-0.41039609909057617,-0.1982157677412033,1.43504798412323,1.619135856628418,1.1329901218414307,2.4595656394958496,-0.0879131406545639,-1.3522475957870483,2.414461135864258,3.0401113033294678,1.720059871673584,1.12676203250885,-0.7369584441184998,1.3141427040100098,1.3402830362319946,3.839181661605835,-2.792994737625122,0.26391276717185974,-2.5991692543029785,0.6820493340492249,-0.3938581645488739,-0.09799519926309586,0.2827828824520111,-1.7492096424102783,1.8199462890625,-2.04616117477417,-0.8503618240356445,3.189140558242798,-0.4934793710708618,2.352341651916504,2.125243663787842,0.4152436852455139,3.70076847076416,2.2065343856811523,0.6761447787284851,0.2639518976211548,-2.3162574768066406,0.0366915687918663,1.2952501773834229,2.197066068649292,1.5760918855667114,-0.003959784749895334,1.555069088935852,1.605111837387085,3.9796526432037354,0.25109872221946716,-1.390153408050537,1.0286835432052612,-0.7599887251853943,-0.02141723595559597,3.4646759033203125,-0.8294525742530823,1.906679630279541,4.270103454589844,-2.407094955444336,2.2951700687408447,-1.013060450553894,0.11748529970645905,2.473806142807007,0.10529882460832596,1.1067038774490356,1.4088168144226074,-1.8400323390960693,0.3516228199005127,-2.8172271251678467,1.4154664278030396,0.25157666206359863,1.3369983434677124,0.12261095643043518,-0.2028694450855255,0.9388173818588257,-0.4149850904941559,-1.8664361238479614,1.1248751878738403,1.6743841171264648,2.6435298919677734,-0.4755290448665619,-1.017314076423645,-1.3977338075637817,1.402225375175476,1.0317003726959229,0.1382014900445938,0.1890413910150528,-1.999022364616394,2.796394109725952,1.132834792137146,0.457975298166275,1.4314594268798828,0.7105299830436707,-0.0932232216000557,-2.543825149536133,2.3376426696777344,-1.086534857749939,1.0363045930862427,2.1537351608276367,-0.1561601459980011,-0.16308008134365082,-0.06511319428682327,0.5525294542312622,-0.24581009149551392,3.443704843521118,-0.8830086588859558,1.4242138862609863,0.5769200921058655,-0.355013906955719,-1.2298897504806519,1.9481693506240845,0.19926276803016663,0.43316033482551575,-2.9468424320220947,1.473490834236145,2.5726044178009033,-0.9886205792427063,3.734215259552002,1.7851744890213013,1.284273624420166,0.7153990268707275,0.26969626545906067,2.535228967666626,1.3432714939117432,-0.601391613483429,0.07284525781869888,1.3129252195358276,-0.5616707801818848,3.9359261989593506,1.0250415802001953,1.2195359468460083,0.7207756042480469,0.7788843512535095,-1.2471988201141357,4.124179840087891,2.0691874027252197,-0.10942880809307098,-1.3382421731948853,2.1147892475128174,0.9080466032028198,0.30288463830947876,0.5820468068122864,-2.3129122257232666,1.7648887634277344,0.011178134009242058,2.639958620071411,1.3863881826400757,-0.21234816312789917,4.5166215896606445,0.3227703869342804,-0.8627999424934387,2.232499837875366,3.8044729232788086,1.51299250125885,0.9483416080474854,1.6169575452804565,3.6365764141082764,0.5820080637931824,1.733404278755188,-1.2339942455291748,-1.3381887674331665,-2.819504737854004,2.6650850772857666,-0.24760206043720245,-2.243276596069336,3.215153217315674,-0.6403767466545105,-1.4505524635314941,0.6612306833267212,-1.8859184980392456,4.041909694671631,-1.6496028900146484,3.0023975372314453,1.0008950233459473,0.5337739586830139,1.1273399591445923,-1.4893221855163574,0.11551285535097122,1.3830758333206177,3.915210485458374,0.7274734973907471,0.33775565028190613,-0.9293545484542847,0.9808284640312195,-1.9979069232940674,4.209457874298096,0.07764989882707596,2.754239797592163,2.602159023284912,-1.0595368146896362,-0.16908597946166992,-3.4569461345672607,1.0957711935043335,0.21654945611953735,3.6714107990264893,2.2677786350250244,-0.04064399003982544,0.07513163238763809,2.4768691062927246,2.3354451656341553,2.7752063274383545,0.5802145004272461,4.358725070953369,-1.282788872718811,1.6884852647781372,1.3721057176589966,2.010312557220459,0.8963154554367065,4.419685363769531,1.390015721321106,0.4488971531391144,2.6012818813323975,0.4620862603187561,3.9959933757781982,-1.6939091682434082,1.9539331197738647,2.53587007522583,-0.9143714308738708,3.0760092735290527,-1.8711512088775635,0.3537250757217407,-0.4340585470199585,1.9432746171951294,-1.3582948446273804,1.0510613918304443,2.0847394466400146,3.256265878677368,0.3581148087978363,-2.5847554206848145,2.347595691680908,3.3644189834594727,2.131174325942993,2.636258840560913,-0.9529106616973877,0.5857205986976624,-0.26397696137428284,0.5197318196296692,0.6359332799911499,1.076433777809143,1.551348090171814,0.6037154793739319,2.0094947814941406,-0.7549964785575867,1.430919885635376,1.4218617677688599,2.2264702320098877,2.272042751312256,2.4321863651275635,1.0007973909378052,2.1648240089416504,-0.5925821661949158,-0.5713045001029968,-1.8975170850753784,-1.3286972045898438,0.8770807981491089,4.0243730545043945,-1.6744301319122314,0.4279615879058838,-1.1411148309707642,-3.6012320518493652,1.9869056940078735,2.375788688659668,2.558583974838257,2.1431477069854736,2.8000264167785645,-1.3162336349487305,0.3824312388896942,-0.5915815234184265,-0.7047286033630371,2.1007680892944336,3.588792085647583,1.3953325748443604,-0.3476324677467346,1.6001238822937012,2.077134132385254,-0.8704588413238525,3.119809627532959,-1.8301628828048706,3.1870269775390625,-0.32592347264289856,-0.7575640678405762,4.767356872558594,0.7642472982406616,-0.9979864358901978,2.1276562213897705,1.8706748485565186,3.684344530105591,0.42066678404808044,-1.8292680978775024,-0.9542088508605957,2.393573760986328,2.6402344703674316,3.0289430618286133,0.4581930935382843,-0.7651199698448181,2.2808966636657715,1.266834020614624,2.4580118656158447,-1.3666653633117676,0.04687877371907234,2.588271379470825,-1.0757572650909424,1.9149683713912964,0.7431547045707703,-1.4637736082077026,1.24252450466156,1.4071860313415527,-1.181352138519287,1.5268276929855347,2.076343297958374,1.2644762992858887,1.5339757204055786,-0.8713887333869934,3.4212944507598877,-0.4141235649585724,-0.7214927673339844,0.37664225697517395,1.9620211124420166,-2.02331280708313,-1.4967377185821533,0.3159785866737366,-0.980501115322113,-1.3555912971496582,-0.6887054443359375,3.2600440979003906,0.963859498500824,-0.21817860007286072,5.334721565246582,0.6732051968574524,2.7394795417785645,2.9591174125671387,2.086928129196167,2.547214984893799,2.681610107421875,1.1701264381408691,1.8140019178390503,-1.3696438074111938,2.4219367504119873,-1.7917894124984741,1.5228265523910522,-1.6642637252807617,2.936411142349243,2.40964412689209,0.9937829971313477,0.5534150004386902,3.5502469539642334,1.2794275283813477,2.094390869140625,5.624259948730469,1.664337158203125,0.5840438604354858,0.5309601426124573,2.142150640487671,1.042718768119812,1.9278271198272705,-2.7475764751434326,1.1261440515518188,2.470072031021118,2.938997983932495,3.1691112518310547,2.6707823276519775,-0.09747357666492462,1.8735220432281494,1.2494057416915894,0.23406535387039185,-1.013223648071289,1.618285059928894,1.828246831893921,-1.0405181646347046,1.1269288063049316,-4.0334601402282715,-0.980630099773407,1.0642192363739014,-1.0473017692565918,-2.789997100830078,1.062595009803772,3.4534366130828857,2.266890287399292,1.9664943218231201,-0.7543685436248779,-1.8729248046875,2.8327090740203857,1.6748485565185547,1.8942819833755493,0.33921295404434204,0.7058066129684448,-0.7384607195854187,0.6622000932693481,0.3479582667350769,3.013347625732422,0.9806347489356995,0.6866210103034973,-1.1340084075927734,1.6571449041366577,0.3579776883125305,-0.7554982304573059,-2.222546100616455,3.0431723594665527,-0.5950864553451538,2.1702959537506104,2.9709742069244385,0.22162170708179474,-0.28654682636260986,1.7789655923843384,2.3897624015808105,0.9830822944641113,0.18301047384738922,2.648359537124634,-0.36909571290016174,1.6394898891448975,4.216783046722412,-1.470343828201294,-1.087852954864502,1.5522210597991943,-0.7734530568122864,0.6599382162094116,1.8696973323822021,1.4340630769729614,1.832847237586975,-0.5426265597343445,3.021913528442383,-0.6182195544242859,1.2369824647903442,1.574297547340393,0.682030439376831,1.0957685708999634,1.8891370296478271,-1.5449258089065552,-0.4489787518978119,0.43423721194267273,0.4484046697616577,0.28535404801368713,2.135979413986206,4.350929260253906,0.9825094938278198,-0.6264440417289734,3.9282283782958984,2.4245972633361816,1.686635971069336,-2.4625613689422607,-0.09360189735889435,-0.4785960912704468,1.0216377973556519,1.2171307802200317,2.1270744800567627,1.6141682863235474,2.2466671466827393,1.1537995338439941,1.6747595071792603,-0.19405345618724823,0.4571129381656647,0.42656877636909485,-0.27277642488479614,1.6922870874404907,-0.15180151164531708,-1.7214527130126953,0.5294871926307678,0.24125899374485016,1.837541937828064,2.5027694702148438,4.1400370597839355,-1.5298770666122437,-1.191874623298645,1.3373790979385376,1.295799970626831,1.4840794801712036,1.7385674715042114,0.7269936203956604,1.8872706890106201,1.8954346179962158,2.109262466430664,1.9247846603393555,1.1519891023635864,-0.2378791719675064,0.2238011509180069,-0.2072143703699112,-1.9636754989624023,3.163506269454956,-0.0539003349840641,1.316916823387146,-1.941085934638977,1.5215246677398682,1.7478538751602173,2.0004236698150635,1.6325879096984863,0.628237247467041,-2.2046520709991455,-2.454627513885498,1.2047147750854492,0.09351292252540588,2.2096307277679443,3.612001419067383,-0.6730689406394958,0.08949360251426697,-1.6604101657867432,0.021740172058343887,1.0881619453430176,-0.5874590277671814,1.837321400642395,-0.697998583316803,-0.6269444823265076,1.959975004196167,0.6062815189361572,2.095372438430786,-0.5066983699798584,0.8372094631195068,-1.145112156867981,3.537123203277588,1.1360846757888794,-1.5718579292297363,0.6100088357925415,-1.0852043628692627,1.1201938390731812,2.6590781211853027,-0.735683262348175,3.1127185821533203,0.17170408368110657,0.3508089482784271,1.1796140670776367,-0.38921794295310974,-1.3444786071777344,0.35517725348472595,0.5113915205001831,3.6300413608551025,-1.7277625799179077,0.32124099135398865,1.7224043607711792,1.8831837177276611,0.7336910367012024,-0.6664031147956848,0.3844115436077118,0.4838894307613373,2.1110641956329346,2.3839969635009766,0.02430877275764942,-2.2329089641571045,-1.3608934879302979,-1.2953187227249146,0.08663398772478104,2.6422858238220215,-1.7194507122039795,-2.678280830383301,-3.0776829719543457,-2.5926268100738525,0.5842293500900269,0.7580517530441284,0.9307510852813721,0.6570973992347717,-0.6703203320503235,-1.7987769842147827,3.911160707473755,0.9241753816604614,3.292531728744507,-1.2083384990692139,-1.6705378293991089,-2.6376099586486816,0.9271305799484253,3.530074119567871,-1.2753480672836304,4.6247076988220215,-1.794295072555542,5.039228916168213,1.4208316802978516,4.1360955238342285,-0.16412721574306488,2.5094106197357178,0.5134997963905334,1.2107757329940796,-1.2056279182434082,-0.990516185760498,1.60810124874115,1.2869880199432373,-1.6054669618606567,-1.9992265701293945,3.755690336227417,0.3322007954120636,-0.29833489656448364,-0.9784275889396667,0.8968151807785034,0.3820536434650421,-2.1264171600341797,0.8844269514083862,0.700293779373169,1.2373496294021606,-2.5130600929260254,-2.62768292427063,3.1865150928497314,0.6273727416992188,2.1215710639953613,2.1202261447906494,0.3524148762226105,2.7382118701934814,-0.2896381914615631,4.381478786468506,0.4814015030860901,-2.8702871799468994,1.570625901222229,1.4649344682693481,-1.4150598049163818,1.3475441932678223,0.8578590750694275,3.5292181968688965,-0.17296794056892395,5.55568265914917,1.5626493692398071,-0.7083701491355896,0.09945027530193329,0.8773834109306335,-1.5018861293792725,1.729695200920105,-2.7929487228393555,-2.124699831008911,-1.6202291250228882,0.30908408761024475,0.1337703913450241,0.5037992596626282,0.89789879322052,0.9079927206039429,1.6095340251922607,1.2977383136749268,-0.32702189683914185,-1.1012786626815796,-1.6426845788955688,-1.7333253622055054,-2.1403884887695312,3.376180648803711,1.1471706628799438,0.1132168173789978,-0.8509476184844971,3.4906904697418213,-0.004099308047443628,3.150326728820801,2.160844087600708,0.9514375925064087,2.114771604537964,1.1304398775100708,-2.0486652851104736,0.7960690855979919,-0.009967746213078499,0.7027660012245178,3.499630928039551,0.6461882591247559,-0.612754762172699,0.5843473672866821,-1.2306461334228516,1.778546929359436,0.3122949004173279,-1.4846234321594238,-0.24640032649040222,1.7734230756759644,2.945315361022949,0.05852723866701126,0.8705453872680664,0.7181032299995422,3.791081666946411,1.5639785528182983,1.6181422472000122,2.5596604347229004,3.00144100189209,0.21173135936260223,-1.5666913986206055,-1.898633599281311,1.4612183570861816,1.0130760669708252,-2.2517974376678467,0.8208438754081726,1.0751219987869263,2.2536208629608154,1.8256086111068726,1.398650884628296,1.805434226989746,0.6628658771514893,1.2774163484573364,0.9972057938575745,-2.8695733547210693,0.707470178604126,2.9206244945526123,-0.948386549949646,3.2049081325531006,2.335439443588257,-2.957979917526245,0.5550931692123413,1.305172085762024,1.222764492034912,4.197913646697998,0.779663622379303,-2.1295995712280273,-0.0056183175183832645,3.439445972442627,-1.1679185628890991,4.081548690795898,0.3599999248981476,0.4240722060203552,-0.8581966161727905,3.878962278366089,0.4195025563240051,0.965633749961853,-2.664135456085205,3.477051019668579,4.607822418212891,-0.9556781053543091,3.2943713665008545,2.275087594985962,-1.8029261827468872,-0.25134605169296265,-0.49033915996551514,-3.351963758468628,-1.1820664405822754,2.6945765018463135,1.0239945650100708,-0.43381550908088684,4.180220603942871,-1.1768460273742676,1.7111669778823853,-1.1620118618011475,-1.5752599239349365,1.6720913648605347,0.45622721314430237,1.2628207206726074,0.9661010503768921,2.9626171588897705,-0.36683371663093567,0.5678367018699646,-2.063415050506592,0.45185357332229614,0.11542641371488571,-0.7951819896697998,0.06055307015776634,2.699270486831665,1.1617813110351562,-0.008895323611795902,1.1983174085617065,-0.9924716949462891,1.074310302734375,0.8195120692253113,0.33417439460754395,-2.9011549949645996,1.6001614332199097,-0.10789782553911209,2.2455241680145264,-0.5262317657470703,1.595050573348999,3.333008050918579,0.31510475277900696,0.7011577486991882,-1.4767980575561523,1.4884709119796753,2.132539749145508,1.4424852132797241,1.7243280410766602,-0.029561547562479973,1.3932101726531982,-1.4794423580169678,0.5663995742797852,3.167569637298584,1.2597047090530396,-0.5034239888191223,-0.5113151669502258,3.6370797157287598,2.1747384071350098,2.830106258392334,0.8354073166847229,-1.2348763942718506,4.091405868530273,1.1702960729599,1.957939863204956,-2.0455093383789062,0.9158629775047302,1.0821616649627686,0.339922159910202,1.0887424945831299,1.903204083442688,1.3226450681686401,0.3666508197784424,1.187445044517517,-1.8992458581924438,0.47252267599105835,-1.7308199405670166,1.576826810836792,0.3604748547077179,0.8749938607215881,0.5358177423477173,4.274606227874756,1.952566146850586,3.341510772705078,0.7921761870384216,-0.4940381348133087,3.4621245861053467,1.8040099143981934,5.080488204956055,2.9359278678894043,0.7202340364456177,-1.0904443264007568,0.1884554624557495,0.5689229369163513,-1.0012868642807007,-1.9501432180404663,1.6109380722045898,1.6619843244552612,-1.6918562650680542,-1.9770103693008423,3.9977612495422363,1.2673994302749634,2.0768942832946777,1.6823408603668213,-0.7438286542892456,2.589587450027466,-1.218798279762268,-0.8030598163604736,0.08634275943040848,-4.317724227905273,0.7340611815452576,1.5145838260650635,-0.7524034976959229,-2.773120641708374,2.991570234298706,3.6927006244659424,-0.3521862030029297,0.7887290716171265,3.0023560523986816,0.8190701603889465,-1.2057485580444336,2.8958661556243896,-1.9899003505706787,2.1083672046661377,-0.031409136950969696,-0.006623769644647837,-2.486865758895874,-0.18189701437950134,1.0154714584350586,0.47173699736595154,-1.5289099216461182,3.0895488262176514,2.0681259632110596,4.5879387855529785,2.439535140991211,2.3373708724975586,0.9407740831375122,3.055192232131958,1.1555088758468628,0.6190385818481445,3.98579740524292,1.451844334602356,-3.3551292419433594,-1.5471607446670532,0.9799730777740479,0.12734924256801605,1.4918158054351807,-0.4860014021396637,2.1196868419647217,-0.7081831693649292,3.1460907459259033,4.05791711807251,2.262284994125366,4.059341907501221,2.5750327110290527,1.9357326030731201,1.051398515701294,1.2230591773986816,1.0733561515808105,1.5610642433166504,1.8528416156768799,2.518585681915283,-1.735303521156311,3.857872724533081,0.16037045419216156,1.1916649341583252,2.884390354156494,-1.6026808023452759,-0.3369377851486206,0.25892364978790283,3.808015823364258,-2.4373867511749268,0.7513678669929504,2.522408962249756,2.4599196910858154,0.8982464671134949,-0.47268614172935486,0.795638918876648,-1.5742759704589844,1.220912218093872,-1.248691439628601,-1.7195851802825928,0.2671233117580414,0.7063098549842834,-0.20239302515983582,1.6798888444900513,1.4173492193222046,-2.2779994010925293,2.1499505043029785,0.7800193428993225,3.143893241882324,0.4632837176322937,0.9557929039001465,0.4324793815612793,0.89792400598526,-1.2842612266540527,0.3057537078857422,0.6815822720527649,-1.402010202407837,2.474116802215576,-3.6960535049438477,0.6702579855918884,0.3525373637676239,2.8329834938049316,1.1883699893951416,-0.42060086131095886,1.5116969347000122,-0.26140743494033813,3.7590644359588623,2.343672275543213,3.2480545043945312,-0.8188463449478149,1.864074468612671,0.8340016603469849,3.6477255821228027,2.6535985469818115,2.467649459838867,1.5223069190979004,0.8326919674873352,1.7157241106033325,-3.0016324520111084,1.8416647911071777,0.16286781430244446,0.08095106482505798,2.130570888519287,0.30542540550231934,1.6167961359024048,-3.2126166820526123,1.9449474811553955,0.6193539500236511,2.2828149795532227,2.0065157413482666,2.1604299545288086,4.262330055236816,0.9208984375,2.5010557174682617,0.05470503121614456,2.594275712966919,3.7469260692596436,-0.7565172910690308,-1.9682046175003052,1.330990195274353,0.3296887278556824,1.9235483407974243,-0.7462534308433533,5.367277145385742,2.2445411682128906,1.202328085899353,1.283198595046997,0.04072203114628792,0.7977368235588074,1.852806568145752,0.5552677512168884,1.277540922164917,2.022078514099121,0.49383002519607544,2.360487699508667,-0.9826751947402954,0.6237335205078125,0.465371310710907,2.8920395374298096,2.2747628688812256,1.9348777532577515,0.32630622386932373,1.7557872533798218,-0.010799096897244453,0.9023870825767517,-0.07494929432868958,-3.15073823928833,-0.02365759015083313,-2.3128724098205566,-0.542328417301178,3.7637524604797363,-2.2226531505584717,-2.7555313110351562,0.9354330897331238,2.8596432209014893,3.657031297683716,0.6641714572906494,-0.5955103039741516,-1.7133710384368896,-0.015523861162364483,-2.3293838500976562,0.928138256072998,4.316661357879639,4.388624668121338,2.9202654361724854,-0.9300591349601746,1.6309643983840942,-0.7439901232719421,1.4665886163711548,-0.22384530305862427,2.3067829608917236,-2.3104801177978516,-0.8494131565093994,1.8514184951782227,1.544240951538086,0.5626757144927979,0.5313408374786377,2.2047982215881348,2.6004114151000977,-3.5854320526123047,2.4841630458831787,1.134289026260376,-0.3519180715084076,1.1925565004348755,0.8794428706169128,3.5424447059631348,-0.021377358585596085,-1.3838906288146973,0.39555275440216064,-0.16270019114017487,-0.8532130718231201,-0.023769602179527283,-2.0882818698883057,4.782785892486572,0.3174270689487457,0.4907592236995697,0.43601176142692566,1.3018532991409302,1.758844256401062,3.7706849575042725,1.3230979442596436,-0.7142859101295471,3.075758695602417,3.5393474102020264,-0.776746392250061,1.2923182249069214,-2.467160940170288,1.1002367734909058,1.3754756450653076,1.0150889158248901,1.7365330457687378,1.1891849040985107,0.8816298246383667,2.6337313652038574,-1.4289038181304932,0.42421671748161316,2.724356174468994,-1.2320809364318848,1.0249266624450684,3.2377395629882812,-0.3883359432220459,-0.9603205323219299,2.2046501636505127,2.0749926567077637,-1.106484055519104,2.8705251216888428,3.220486879348755,-3.1925761699676514,0.041842978447675705,3.7785770893096924,0.5671921372413635,0.6849804520606995,2.1419589519500732,-2.285548686981201,1.8620333671569824,-2.261686086654663,-0.7593379020690918,-1.5552417039871216,-1.2244151830673218,1.668554425239563,0.3699004650115967,0.22125151753425598,1.8713610172271729,-0.6047816872596741,2.8912742137908936,3.962597131729126,3.0232582092285156,-1.355108618736267,-1.0957447290420532,2.7030625343322754,-0.5073016285896301,2.5445971488952637,-2.1021974086761475,-1.1240592002868652,-2.5350611209869385,0.8408988118171692,2.4208078384399414,-1.5512900352478027,0.9128296375274658,3.081307888031006,0.24740362167358398,-2.906975269317627,0.34113624691963196,-0.6048938632011414,0.5768054723739624,0.4789312183856964,1.175356149673462,0.13761574029922485,-3.4128146171569824,-1.4240659475326538,4.193783760070801,-0.4377284646034241,-1.655929684638977,-1.6821955442428589,-2.4565505981445312,2.4367213249206543,4.868746757507324,1.4452651739120483,-2.0181801319122314,0.9403893947601318,-1.3061511516571045,3.812988042831421,0.960039496421814,0.2831107974052429,3.633664846420288,1.9486792087554932,1.459200382232666,2.4775307178497314,0.5356929302215576,-0.14055752754211426,-1.3638852834701538,1.9661799669265747,-1.6000618934631348,2.282036304473877,2.881200075149536,2.271763801574707,1.6058545112609863,0.9736626744270325,-0.0680653378367424,-0.07267717272043228,3.946808338165283,-0.9731734395027161,0.785688042640686,0.5305809378623962,1.2308036088943481,-2.995523452758789,2.24029278755188,1.228643536567688,2.1560661792755127,0.130313903093338,0.061417654156684875,0.5955747961997986,2.0281643867492676,3.584308624267578,2.863476514816284,2.2208054065704346,-1.7813047170639038,0.04683728888630867,2.315232753753662,1.625184416770935,1.744757056236267,1.6155986785888672,0.6068474054336548,-0.373382568359375,1.0098018646240234,1.883968472480774,1.5848926305770874,2.84537672996521,0.8182034492492676,3.6093544960021973,1.5221374034881592,-0.35011354088783264,-0.1632639616727829,-2.2102363109588623,1.479754090309143,1.8606318235397339,3.1745800971984863,2.394735097885132,-0.8597010374069214,0.9329485893249512,1.5079619884490967,-0.3275589048862457,0.2626993954181671,2.9567577838897705,1.544806718826294,1.7038261890411377,1.472652792930603,-0.9887833595275879,1.5744439363479614,0.7386519908905029,0.6136173605918884,0.5558038353919983,1.6809748411178589,3.3966264724731445,-1.110840916633606,-1.5954670906066895,-0.059490226209163666,3.410494804382324,4.440821170806885,-0.4828890860080719,-0.9525396823883057,-0.5920767784118652,1.8811241388320923,0.6430185437202454,2.269244432449341,2.4922778606414795,1.5458519458770752,4.489433765411377,1.7487238645553589,1.588018774986267,0.7311046123504639,1.9217545986175537,-0.07513385266065598,-0.8923692107200623,-0.4352705776691437,-0.6361121535301208,1.0261204242706299,1.1518454551696777,-0.21698856353759766,-0.3044716715812683,2.444697380065918,-0.41674304008483887,-1.3953235149383545,1.419171690940857,2.2428176403045654,-0.4980190694332123,4.821360111236572,2.5148887634277344,1.5958346128463745,3.3154656887054443,0.22274811565876007,0.3616969883441925,-1.4369395971298218,1.3163806200027466,1.6278735399246216,-1.011414647102356,-0.5587025880813599,-0.4548841416835785,-0.8530584573745728,1.2450180053710938,3.0614523887634277,1.4639828205108643,-1.0478997230529785,0.6013363003730774,-0.058105599135160446,1.6308300495147705,1.007819414138794,0.03618539124727249,-3.011796236038208,1.170047640800476,-2.511593818664551,1.103227972984314,1.1293317079544067,-0.9308366775512695,-2.904583215713501,1.40631902217865,0.5950651168823242,-1.0451788902282715,1.3645236492156982,2.8615639209747314,-0.8719725608825684,2.2079951763153076,4.591281890869141,1.4143781661987305,-1.039519190788269,0.5233508944511414,0.937353253364563,2.2139782905578613,1.5183277130126953,2.2340915203094482,-0.84112548828125,0.15078851580619812,-1.505210041999817,1.1143921613693237,2.135749340057373,0.07880665361881256,-1.1998577117919922,3.4036054611206055,-1.9191240072250366,2.8081166744232178,3.880964517593384,1.3033584356307983,-0.8857925534248352,3.260448694229126,-2.0245766639709473,1.1225835084915161,1.700368046760559,-1.8343279361724854,0.13910098373889923,1.265839695930481,-1.5794053077697754,1.1905347108840942,0.44732218980789185,2.2932183742523193,-0.9270491600036621,1.610966444015503,-0.9318523406982422,-2.7005410194396973,1.5681887865066528,1.3445996046066284,-0.0575108602643013,1.1166480779647827,0.529415488243103,1.8695250749588013,2.0266835689544678,3.646334648132324,-1.4158084392547607,4.498226642608643,-1.268206238746643,2.563107967376709,-0.9365942478179932,-2.694019079208374,-1.2871564626693726,1.611714243888855,-1.2505438327789307,0.44888392090797424,3.0100276470184326,-2.3120977878570557,-2.8627731800079346,0.0269796010106802,-0.5462154150009155,3.074005603790283,-0.4562797546386719,1.7805534601211548,1.322448968887329,-1.9218449592590332,3.9504292011260986,1.669110655784607,2.2013955116271973,2.6396825313568115,4.838756561279297,-1.2760889530181885,3.1972696781158447,-1.0135908126831055,-1.005297064781189,0.3533536493778229,3.7415993213653564,4.674347877502441,-2.2416372299194336,2.588489055633545,-2.696723461151123,0.5558040142059326,-1.6613987684249878,3.092559576034546,2.9441652297973633,2.322444200515747,1.3380534648895264,-1.4375609159469604,0.9326613545417786,2.3095061779022217,-2.2638232707977295,-1.159894585609436,2.083554744720459,1.8101013898849487,3.5149118900299072,1.218913197517395,0.9215418696403503,-2.0712945461273193,-2.870993137359619,0.8916818499565125,-0.6184006333351135,3.341919422149658,-2.4127285480499268,0.1331900805234909,3.252065658569336,-2.483625888824463,3.69929838180542,1.6920127868652344,-0.6652247905731201,0.17546799778938293,-1.193308711051941,2.331127643585205,-0.8440070152282715,1.45662522315979,-0.015981171280145645,3.8018064498901367,1.0501683950424194,0.42515066266059875,1.1100448369979858,2.437520980834961,-0.4454604685306549,-2.5932860374450684,1.0414412021636963,2.0417115688323975,-2.4320638179779053,-0.02524300292134285,-2.2090985774993896,2.5310254096984863,-1.4131944179534912,-0.9062168002128601,-0.32089635729789734,1.8600248098373413,3.0166642665863037,1.8161358833312988,-2.280029296875,-0.11688826233148575,1.7809642553329468,0.9574111104011536,0.357511043548584,0.9259339570999146,1.2020758390426636,4.6656389236450195,1.0908836126327515,-0.14858640730381012,2.2093610763549805,0.0016718043480068445,-0.11591080576181412,2.0620055198669434,1.0816001892089844,1.5508272647857666,2.21646785736084,1.4870549440383911,2.644804000854492,-1.9111310243606567,1.5306891202926636,3.05359148979187,-0.10355778783559799,3.029850482940674,0.6592518091201782,-1.3087278604507446,2.094620704650879,-0.6772753596305847,-1.1602284908294678,0.02802409790456295,1.4453967809677124,-0.42202702164649963,1.2796072959899902,-0.163275346159935,0.7408598065376282,2.1139705181121826,0.12161394208669662,-0.9444670677185059,0.8555673956871033,-1.602830171585083,-0.1531248241662979,4.513919353485107,0.8366722464561462,0.8879544138908386,2.326882839202881,-1.498814344406128,3.680055856704712,-3.190664768218994,3.5756211280822754,2.5864007472991943,-0.08364105224609375,0.010975595563650131,2.328242301940918,2.662714958190918,1.7873884439468384,2.702186107635498,0.3624821603298187,3.09041166305542,2.30773663520813,0.6870790123939514,-0.13445301353931427,2.028775930404663,-0.9061444401741028,3.5981903076171875,-0.3726732134819031,3.2152130603790283,1.4697601795196533,0.2974603772163391,1.0095689296722412,-1.5391525030136108,1.3114348649978638,1.4316486120224,0.7178629040718079,-2.688856363296509,-0.5473235249519348,-0.35140568017959595,-0.26479825377464294,-1.3249412775039673,1.1741511821746826,-0.8218011856079102,1.4469380378723145,3.992460012435913,-1.3003120422363281,1.8393489122390747,0.23462991416454315,1.6005793809890747,3.048569440841675,0.8503488302230835,1.5539195537567139,-0.575442373752594,-1.0733882188796997,-0.7027040123939514,2.135470390319824,2.4802961349487305,3.2347896099090576,0.52049320936203,0.591810405254364,2.1804792881011963,0.11347590386867523,-1.3603850603103638,-1.5072723627090454,2.6212711334228516,4.690843105316162,0.09019386768341064,2.023724317550659,2.9627230167388916,0.684732973575592,2.5062055587768555,-3.052821159362793,0.6302242279052734,-3.061408519744873,-1.8623219728469849,0.11081885546445847,2.404644012451172,2.363224506378174,0.1105177029967308,0.12218066304922104,0.057889439165592194,1.5540868043899536,1.1430376768112183,0.7771007418632507,2.2738287448883057,0.5675552487373352,-0.9392860531806946,-2.74763822555542,-2.513218641281128,-1.146132230758667,0.7438173294067383,5.046504974365234,0.7121348977088928,2.0818324089050293,-1.1848278045654297,-1.0906248092651367,1.4062163829803467,0.26572224497795105,1.2960805892944336,1.5486499071121216,5.094493389129639,0.16683563590049744,2.724693775177002,-0.47569039463996887,0.8017680048942566,2.802626609802246,-0.46348628401756287,0.8536040186882019,1.4287033081054688,2.1749818325042725,0.45640915632247925,0.74008709192276,2.5055549144744873,-0.07328195869922638,-0.051003649830818176,0.7461261749267578,1.0144476890563965,-2.135430097579956,0.21890126168727875,-0.6438414454460144,-2.227858066558838,-2.7343668937683105,0.8879267573356628,-0.4240330755710602,2.855210065841675,0.9535874724388123,-0.27903375029563904,4.164844989776611,2.120736837387085,-0.330928236246109,2.2119598388671875,5.754533290863037,-1.3641741275787354,-1.5693148374557495,-2.645045757293701,-2.042964458465576,-1.555069088935852,4.868854522705078,-0.8737740516662598,2.9365234375,0.062347061932086945,1.8004140853881836,1.890381932258606,0.33473214507102966,5.939961910247803,2.526273250579834,2.0553879737854004,0.16725537180900574,2.9886581897735596,2.312469720840454,-0.1083444207906723,2.2330901622772217,2.780045509338379,0.34660598635673523,0.2676781117916107,1.699479103088379,-0.07400687038898468,1.3197877407073975,-0.1000051200389862,-1.5029923915863037,1.2060025930404663,3.4179041385650635,-1.05229651927948,1.4896693229675293,2.351821184158325,3.38946533203125,0.20151837170124054,3.316190719604492,1.4727647304534912,-1.9550139904022217,0.14090165495872498,1.7219271659851074,-1.5469751358032227,-1.1397749185562134,0.8250295519828796,2.5697684288024902,-1.4551787376403809,-0.5538280010223389,-1.2787970304489136,2.339913845062256,0.841475784778595,3.8303256034851074,-0.46693354845046997,0.9343092441558838,-3.173896312713623,-0.9664604067802429,0.2607281506061554,1.0414960384368896,0.6015316843986511,-1.8219633102416992,2.024789810180664,2.5448760986328125,4.942723274230957,-2.2132153511047363,4.620242118835449,2.210014820098877,-1.1957052946090698,1.5394573211669922,2.2385056018829346,4.170085906982422,3.3504323959350586,-0.10584340989589691,2.88509464263916,2.0195391178131104,0.1598738580942154,-1.6039748191833496,2.599057674407959,1.189736008644104,2.456839084625244,4.155747413635254,1.5517555475234985,0.07284175604581833,2.2502903938293457,0.7023066878318787,4.08140230178833,2.753054618835449,0.7220585346221924,3.659942150115967,-1.5186601877212524,-0.1870385855436325,2.078989267349243,2.3285300731658936,-1.6250261068344116,0.7833619713783264,1.3020234107971191,1.827670931816101,1.9284857511520386,-0.6835479140281677,5.282635688781738,0.10877268016338348,0.29046007990837097,1.1145976781845093,2.2530465126037598,2.2645957469940186,0.36982277035713196,0.31243783235549927,0.6696709990501404,0.12459924072027206,3.223771810531616,1.883436679840088,-1.4209755659103394,0.23732568323612213,-0.6500006318092346,1.937951683998108,0.3556607961654663,0.08755132555961609,0.15666620433330536,3.310068368911743,-2.332746744155884,-1.3624186515808105,0.3864150941371918,0.5554273724555969,-1.117549180984497,-1.123837947845459,-1.9678623676300049,1.1226967573165894,-1.3754522800445557,2.1486260890960693,2.170145273208618,4.136119842529297,0.9924481511116028,3.0140397548675537,-1.4854319095611572,0.5306937098503113,-1.2730541229248047,2.584373712539673,2.1889054775238037,0.18988054990768433,1.3114309310913086,0.3248043358325958,-3.18117618560791,1.9925943613052368,0.7047006487846375,3.38045597076416,-2.684791088104248,-1.8652441501617432,0.41885247826576233,1.3201946020126343,1.514212965965271,1.2293217182159424,1.251739501953125,1.3454291820526123,-1.4677108526229858,0.6054500937461853,-0.08997625857591629,-0.12101574242115021,-0.5653173327445984,-1.686597466468811,2.878237009048462,0.6449772119522095,2.1757397651672363,3.660074234008789,1.9871163368225098,-2.3563802242279053,1.0228477716445923,2.2446460723876953,2.4149672985076904,1.547105312347412,-1.4215823411941528,-1.906074047088623,1.1966959238052368,-2.758126735687256,2.6203205585479736,1.330377221107483,1.07820463180542,0.06232624873518944,0.544563353061676,6.499744892120361,2.2337775230407715,0.8961591720581055,0.5343400835990906,0.3288190960884094,1.861158847808838,1.527131199836731,-0.3129480481147766,-2.245260715484619,3.079103469848633,0.7072070240974426,2.0491249561309814,0.9531801342964172,1.9838180541992188,1.7001339197158813,-0.9642745852470398,-2.2314693927764893,0.19529537856578827,0.41108009219169617,1.6106823682785034,0.6152530312538147,0.43473705649375916,-0.817113995552063,-0.8227682709693909,-0.5803495645523071,0.12531182169914246,0.7395290732383728,2.2223150730133057,-0.4996557831764221,1.1430844068527222,-1.2386246919631958,-0.467331200838089,0.8974687457084656,-0.27485162019729614,0.4959125220775604,1.8631601333618164,-2.800436496734619,0.5637587308883667,0.32200655341148376,1.0108380317687988,0.3267194330692291,4.468442440032959,-0.6630979180335999,-2.6257922649383545,0.1584867238998413,1.3155405521392822,4.867247104644775,1.6163419485092163,-0.017682235687971115,-0.38401275873184204,2.834420680999756,2.5992236137390137,-0.16616275906562805,1.7036008834838867,1.5542793273925781,-1.0643576383590698,-0.07671145349740982,2.6217198371887207,1.5639150142669678,1.6120167970657349,0.7716773152351379,0.8662800192832947,-0.7772244215011597,-1.6746070384979248,0.9672821164131165,0.2585449814796448,3.925288200378418,1.1551543474197388,-1.7046152353286743,0.8171415328979492,2.9767467975616455,0.5848791599273682,-1.529778003692627,-0.6033158898353577,0.5284486413002014,1.4427651166915894,0.6187320351600647,-1.5096625089645386,2.7590689659118652,1.066414475440979,3.3054733276367188,1.198326587677002,-4.054455757141113,1.7979754209518433,2.527379035949707,2.768075466156006,-0.9620395302772522,-0.016923917457461357,1.32364821434021,-2.9365220069885254,2.2605183124542236,-1.3074778318405151,2.0601229667663574,1.5723867416381836,-0.1800183206796646,-1.233236312866211,2.2126970291137695,0.9242566227912903,0.2995859980583191,1.5479381084442139,-1.0551316738128662,0.6486835479736328,0.30316925048828125,3.0319504737854004,-1.3587368726730347,1.1033806800842285,1.7248075008392334,-0.34366148710250854,5.348228931427002,2.335291624069214,1.166449785232544,-0.7135992050170898,-0.18557918071746826,2.4927475452423096,1.445939064025879,0.5677188634872437,-0.08128385245800018,2.459540843963623,0.9593394994735718,2.437211751937866,0.12031885236501694,0.79169100522995,3.129471778869629,2.328960418701172,3.3373053073883057,2.6914868354797363,4.170868396759033,2.4615793228149414,0.17166495323181152,-0.191146582365036,0.8647292852401733,1.032102346420288,-1.9044686555862427,3.01145601272583,-1.0252935886383057,-0.5382063984870911,-2.0888733863830566,-0.06111704558134079,-1.9465328454971313,-0.3956736922264099,-0.9009191393852234,0.09219235181808472,0.5509818196296692,0.19836336374282837,1.1527460813522339,-1.2122743129730225,3.6065673828125,2.7417330741882324,-3.632911205291748,3.5713984966278076,-1.278442144393921,1.2510303258895874,-0.6022480130195618,-0.02021033875644207,-0.33820217847824097,1.4009450674057007,0.9935911893844604,-0.03471744433045387,1.8054944276809692,2.6511826515197754,-0.6801989078521729,-0.9898796677589417,0.6184614300727844,0.2209489941596985,1.143186092376709,1.4496454000473022,3.678459405899048,0.6690647006034851,0.20938067138195038,3.4676096439361572,-0.05478724092245102,-0.15363937616348267,0.25121936202049255,1.075478434562683,2.4264442920684814,-1.2683264017105103,2.811189651489258,-2.7334179878234863,0.18314647674560547,1.0180742740631104,-0.27093005180358887,2.7387545108795166,3.0319314002990723,2.005192756652832,1.4730327129364014,-1.6516512632369995,2.6625194549560547,1.7743091583251953,2.730745553970337,-0.42790234088897705,3.624389410018921,1.3364121913909912,2.319730281829834,1.6789515018463135,-2.390077590942383,-1.0794997215270996,0.17561838030815125,1.4697855710983276,-1.5567950010299683,1.978963851928711,1.1488591432571411,0.5037176609039307,1.0252976417541504,2.5505847930908203,-1.9792627096176147,1.0559555292129517,-2.6011242866516113,2.875925302505493,0.14667798578739166,1.577983021736145,1.1890430450439453,1.5251376628875732,-1.278321385383606,-2.1407084465026855,0.8368054032325745,1.5569111108779907,-0.12916183471679688,-2.368577241897583,2.08719539642334,0.9951145648956299,1.3114229440689087,-0.33069169521331787,2.3563380241394043,0.7075456380844116,3.0608530044555664,2.4628348350524902,2.254241466522217,1.8199985027313232,-1.0187578201293945,-1.114693284034729,-0.6651045083999634,2.4052417278289795,1.7028334140777588,2.037914991378784,0.73665452003479,1.0943515300750732,-1.7218503952026367,2.9498653411865234,-0.6793299913406372,0.3816829323768616,0.5333818197250366,-1.4721757173538208,0.7182068824768066,1.9220168590545654,1.6770209074020386,3.080786943435669,2.7890830039978027,0.7373740673065186,0.09655684232711792,2.2075815200805664,-0.3408207297325134,0.9147993922233582,3.750077962875366,-0.8103134632110596,0.27425113320350647,-1.5101431608200073,1.4084197282791138,-0.762076735496521,1.1516586542129517,-2.1559555530548096,-1.8847452402114868,0.9561371207237244,-0.6362348198890686,0.9730292558670044,1.0578374862670898,0.8679867386817932,3.314655065536499,0.6057732701301575,-1.3032426834106445,-0.5805888175964355,3.6080074310302734,0.34662482142448425,-0.3214782476425171,1.492206335067749,1.1574472188949585,-1.7733044624328613,-0.3935495913028717,2.1285789012908936,2.162620782852173,-1.5644547939300537,-2.0996973514556885,-1.9746676683425903,0.2998009920120239,4.51527738571167,-0.11254742741584778,1.2219548225402832,0.09270971268415451,-0.982984721660614,-2.3560240268707275,-1.4349993467330933,2.068483591079712,-1.1152304410934448,3.1982128620147705,0.6450169682502747,0.9899327754974365,3.3643064498901367,2.2606353759765625,-1.7850747108459473,2.129798412322998,-2.7701566219329834,-1.1334036588668823,2.9067165851593018,2.718161106109619,1.5017558336257935,2.0209462642669678,1.7935012578964233,1.6409677267074585,0.6864508986473083,0.07153940945863724,-0.15382152795791626,-1.7198041677474976,1.2180900573730469,4.066718101501465,-2.910311698913574,-1.0308924913406372,-2.946866035461426,-0.2531273365020752,0.8690429925918579,2.849091053009033,-0.68234783411026,0.9654139280319214,-1.927206039428711,-3.0833911895751953,1.320888638496399,-2.0432820320129395,-1.8227627277374268,4.37148380279541,2.2558388710021973,0.7364029288291931,4.956240177154541,-0.6989902853965759,1.6779180765151978,2.2419309616088867,1.9009195566177368,-1.9690243005752563,2.7588210105895996,-1.252616047859192,-0.06172264367341995,0.1909911036491394,0.7579366564750671,2.387343406677246,1.4363210201263428,0.46499401330947876,-0.9751809239387512,-1.4172444343566895,2.903153657913208,2.4613568782806396,-2.396885633468628,4.182307720184326,1.2500256299972534,0.50553297996521,0.45761215686798096,-1.1304600238800049,1.0447399616241455,1.6169333457946777,0.06411946564912796,-0.08513516932725906,2.351857900619507,-0.0564374104142189,2.142383575439453,1.1930731534957886,-0.06894058734178543,-0.520220160484314,4.189024925231934,0.4394720196723938,2.2565758228302,-0.19710533320903778,2.8497416973114014,1.4844624996185303,1.2522969245910645,0.9456321597099304,0.6318159699440002,-0.8717905282974243,-3.491297483444214,-2.793246269226074,0.8306399583816528,0.2596700191497803,1.1835294961929321,2.159531831741333,3.637968063354492,3.8135881423950195,1.7350313663482666,2.4249162673950195,-0.6464495062828064,2.0757479667663574,-1.8204615116119385,0.15627504885196686,0.7207165956497192,3.3129031658172607,1.1516863107681274,3.3293540477752686,0.2755427062511444,1.6820130348205566,-2.0074710845947266,-0.6322324275970459,2.333589553833008,-0.3046506643295288,-0.6787452101707458,1.770039439201355,0.279680997133255,0.41375792026519775,2.1634790897369385,3.1592063903808594,0.6399988532066345,1.4947422742843628,-0.5603985786437988,1.2953554391860962,0.7953753471374512,-0.13158127665519714,2.719754457473755,2.2538394927978516,1.6975232362747192,-0.7277392745018005,-1.0607948303222656,1.0294888019561768,2.0359816551208496,0.7937187552452087,2.528778553009033,-0.49148938059806824,2.7656006813049316,0.43461111187934875,1.1085577011108398,-2.1800737380981445,-1.224212884902954,0.24914765357971191,-1.7442841529846191,-0.2025965005159378,-0.06606318056583405,-3.2915563583374023,1.972968339920044,1.1710031032562256,1.9580848217010498,1.4838366508483887,-1.1832730770111084,1.7399489879608154,2.2319529056549072,1.818481206893921,1.8697344064712524,1.165810227394104,1.1951059103012085,1.1602842807769775,0.7257531881332397,1.9417459964752197,-1.6141618490219116,-0.8507089614868164,0.2331421822309494,1.6290876865386963,-1.510479211807251,4.132931709289551,2.04034423828125,-2.1856584548950195,0.1892218440771103,1.361101746559143,1.1777280569076538,-0.11482255905866623,-0.4924273192882538,1.0127366781234741,-0.9128004312515259,0.9995613694190979,-1.4051438570022583,-3.051353693008423,3.2833845615386963,-2.171800374984741,-1.6924530267715454,-2.9805545806884766,0.3555462956428528,2.252192974090576,3.57965087890625,2.463127851486206,1.5175995826721191,0.9835301041603088,1.2351652383804321,-1.697383999824524,1.5082299709320068,0.5375702977180481,-0.2629172205924988,-2.450927972793579,0.9813945889472961,1.3612223863601685,-2.590268135070801,-0.23279894888401031,-2.6005606651306152,3.1603119373321533,0.6619908809661865,1.9540404081344604,1.9869321584701538,-1.981502890586853,0.20881278812885284,1.1882506608963013,1.9797358512878418,2.2417285442352295,1.7666524648666382,3.4635679721832275,-1.0373867750167847,0.9751828908920288,1.9309971332550049,4.53212833404541,-0.04379013925790787,-1.4059091806411743,0.26059436798095703,-0.4391748011112213,-0.11995338648557663,-2.0371925830841064,0.7843565344810486,1.5172733068466187,1.3458682298660278,-2.8496453762054443,3.0342485904693604,0.8601021766662598,5.109180927276611,1.0332794189453125,0.7840896844863892,0.19531404972076416,-0.08199122548103333,-0.20850998163223267,0.6122393608093262,0.5576928853988647,-0.7300878763198853,0.459323525428772,4.7447357177734375,0.43350908160209656,-1.108652114868164,0.1285104751586914,2.6355350017547607,-1.2609503269195557,-2.725339889526367,3.1122734546661377,-2.750974416732788,2.0744712352752686,0.43032506108283997,-1.7131972312927246,1.448778510093689,-0.892571210861206,-1.2808152437210083,0.546220600605011,0.06428056210279465,1.7541121244430542,-0.7597324252128601,1.0975635051727295,-1.5905293226242065,1.3065805435180664,0.7005549073219299,2.911027669906616,-1.946338176727295,-2.9523379802703857,0.8563600778579712,-2.1059415340423584,2.1494197845458984,1.5777804851531982,2.6582250595092773,1.4943469762802124,-0.010207373648881912,3.943944215774536,-0.3835814297199249,2.965106248855591,-3.8562469482421875,1.63644540309906,1.5410194396972656,-0.9842543601989746,-1.9265645742416382,4.757625579833984,-2.3995890617370605,-0.1945042610168457,-0.7777194976806641,-0.8659784197807312,0.04111628234386444,3.2131903171539307,0.11986654251813889,-1.7740099430084229,-0.7435380816459656,1.0251903533935547,0.4821331799030304,-0.19448165595531464,0.8129627704620361,0.8631656765937805,-3.091991662979126,-1.8394649028778076,-1.0363049507141113,-3.71994686126709,1.037312388420105,-1.0121830701828003,0.704700231552124,-1.8174721002578735,-0.47586169838905334,0.6588394641876221,-2.35843825340271,-0.6654564738273621,3.7562949657440186,-0.7301842570304871,1.518619179725647,-0.863667905330658,0.9300817251205444,1.979801893234253,1.8785055875778198,3.5565593242645264,0.3025684654712677,0.8926160335540771,0.45258399844169617,-0.4574783742427826,1.2804110050201416,2.3153185844421387,-2.0556185245513916,-0.4712289571762085,0.4931635856628418,-0.9375521540641785,-2.065939426422119,0.7489786148071289,-0.6339230537414551,-0.3335011303424835,1.1624606847763062,-1.1089363098144531,1.1238588094711304,1.296223759651184,1.7491611242294312,0.5263345837593079,-0.7925735712051392,-2.518040418624878,0.41244515776634216,4.098822593688965,2.6399168968200684,1.9590016603469849,-0.5124738812446594,-1.2087578773498535,-0.798814594745636,2.295917272567749,1.4140359163284302,0.05795777589082718,-0.5486836433410645,1.057084560394287,-0.1442970335483551,0.9588393568992615,1.2869832515716553,-1.022527813911438,-1.4763389825820923,-0.43747517466545105,-0.13276924192905426,-0.009982990100979805,-0.4109153151512146,0.9398314356803894,-1.2249133586883545,4.580055236816406,-1.5249584913253784,0.8928736448287964,2.170649766921997,-0.2597207725048065,1.6371989250183105,0.45153120160102844,3.8102447986602783,0.8017690181732178,1.7259713411331177,0.966027557849884,0.08704044669866562,-0.23347529768943787,1.6367336511611938,0.500794529914856,1.9680835008621216,-0.9934763312339783,1.5927419662475586,2.5040102005004883,-0.7820788025856018,1.7881757020950317,3.667185068130493,-1.9235703945159912,-3.067074775695801,1.937021255493164,-3.117595911026001,-0.5171099901199341,2.7446422576904297,2.1205148696899414,1.7106645107269287,2.0619277954101562,0.5295467972755432,0.15910284221172333,4.877195358276367,1.9847737550735474,-1.132170557975769,-3.465214490890503,-2.2551193237304688,1.5221492052078247,2.752257823944092,-0.6104364991188049,1.7678403854370117,1.8664904832839966,2.1400914192199707,-0.0018976092105731368,1.2878663539886475,-1.7053823471069336,-0.682977020740509,2.1087968349456787,2.0419304370880127,-1.52183198928833,-0.11435744911432266,0.5053806900978088,-2.229910135269165,0.5005456209182739,1.0975807905197144,-0.37080734968185425,3.0513386726379395,0.2664267420768738,-0.5751709938049316,2.6387081146240234,1.4019140005111694,3.4845359325408936,-0.9187943339347839,-1.7076753377914429,0.6199360489845276,-1.0012391805648804,3.414543390274048,-1.2990285158157349,2.3705835342407227,-0.7583752274513245,-1.3513017892837524,-1.3297213315963745,1.9076083898544312,3.0453336238861084,2.5390632152557373,3.928858518600464,4.4036760330200195,1.7708581686019897,2.9440605640411377,0.14295180141925812,1.596468448638916,-0.3813878297805786,2.037886381149292,0.7094334363937378,1.5140531063079834,0.7817776203155518,4.240850925445557,0.26391488313674927,2.7688426971435547,2.6057896614074707,0.7930375933647156,0.4923859238624573],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cc3f9298-86b1-42a2-846c-005d40a605b4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>…bit of a mess. Not as cleanly separated as the 8x8 image examples. You can see that the 0’s are well separated from the 1’s and the 3’s, but everything else is pretty mixed together. (I suspect the 1’s are clustered strongly because they involve the most dark pixels.)</p>
<p>If you wanted to push this further then either keeping more dimensions (thereby making it un-visualizable) or just using a different method entirely (e.g.&nbsp;t-SNE or even better: <a href="https://pair-code.github.io/understanding-umap/">UMAP</a>) would be the way to go. Still, it’s neat to see that you can get somewhat intelligible results in 3D even on this ‘much harder’ problem.</p>
</section>
<section id="appendix-b-because-we-can-turning-it-into-a-classifier" class="level1">
<h1>Appendix B: Because We Can: Turning it into a Classifier</h1>
<p>…But let’s not do a neural network because all I ever do are neural networks, and because I don’t want to have take the time &amp; space to explain how they work or load in external libraries. Let’s do k-nearest-neighbors instead, because it’s intuitively easy to grasp and it’s not hard to code up:</p>
<blockquote class="blockquote">
<p>For any new point we want to evaluate, we take a ‘vote’ of whatever some number (called <img src="https://latex.codecogs.com/png.latex?k">) of its nearest neighbor points are already assigned as, and we set the class of the new point according to that vote.</p>
</blockquote>
<p><small>Making a efficient classifier is all about finding the <em>boundaries</em> between regions (and usually subject to some user-adjustable parameter like <img src="https://latex.codecogs.com/png.latex?k"> or some numerical threshold). Finding these boundaries can be about finding the ‘edge cases’ that cause the system to ‘flip’ (discontinuously) from one result to another. However, we are <em>not</em> going to make an efficient classifier today. ;-) </small></p>
<p>Let’s go back to the 8x8 digits example, and split it into a training set and a testing set (so we can check ourselves):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random shuffled ordering of the whole thing</span></span>
<span id="cb40-2">indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])), X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb40-3">X_shuf, Y_shuf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[indices,:], Y[indices]</span>
<span id="cb40-4"></span>
<span id="cb40-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 80-20 train-test split</span></span>
<span id="cb40-6">max_train_ind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])    </span>
<span id="cb40-7">X_train, Y_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_shuf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:max_train_ind,:], Y_shuf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:max_train_ind]</span>
<span id="cb40-8">X_test, Y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_shuf[max_train_ind:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,:], Y_shuf[max_train_ind:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] </span>
<span id="cb40-9"></span>
<span id="cb40-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do PCA on training set </span></span>
<span id="cb40-11">train_cov <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cov(X_train.T)</span>
<span id="cb40-12">ell, v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sorted_eig(np.array(train_cov))</span>
<span id="cb40-13">pca_dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of top 'dimensions' to take</span></span>
<span id="cb40-14">W_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:pca_dims]   </span>
<span id="cb40-15">proj_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W_train</span>
<span id="cb40-16"></span>
<span id="cb40-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># also project the testing set while we're at it</span></span>
<span id="cb40-18">proj_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> W_train   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># yes, same W_train </span></span></code></pre></div>
</div>
<p>Now let’s make a little k-nearest neighbors routine…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Counter</span>
<span id="cb41-2"></span>
<span id="cb41-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> knn_predict(xnew, proj_train, Y_train, k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb41-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb41-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    xnew is a new data point that has the same shape as one row of proj_train.</span></span>
<span id="cb41-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Given xnew, calculate the (squared) distance to all the points in X_train</span></span>
<span id="cb41-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    to find out which ones are nearest.</span></span>
<span id="cb41-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb41-9">    distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((proj_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xnew)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  </span>
<span id="cb41-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stick on an extra column of indexing 'hash' for later use after we sort</span></span>
<span id="cb41-11">    dists_i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.stack( (distances, np.array(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(Y_train.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) )),axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> )</span>
<span id="cb41-12">    dists_i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dists_i[dists_i[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].argsort()]    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sort in ascending order of distance</span></span>
<span id="cb41-13">    knn_inds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (dists_i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:k,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).astype(np.int32)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grab the indexes for k nearest neighbors</span></span>
<span id="cb41-14"> </span>
<span id="cb41-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># take 'votes':</span></span>
<span id="cb41-16">    knn_targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(Y_train[knn_inds])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># which classes the nn's belong to</span></span>
<span id="cb41-17">    votes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Counter(knn_targets)         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  count up how many of each class are represented</span></span>
<span id="cb41-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> votes.most_common(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pick the winner, or the first member of a tie</span></span>
<span id="cb41-19"></span>
<span id="cb41-20"></span>
<span id="cb41-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's test it on the first element of the testing set</span></span>
<span id="cb41-22">x, y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> proj_test[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], Y_test[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb41-23">guess <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> knn_predict(x, proj_train, Y_train)</span>
<span id="cb41-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"guess = "</span>,guess,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", true = "</span>,y_true)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>guess =  8 , true =  8</code></pre>
</div>
</div>
<p>Now let’s try it for the ‘unseen’ data in the testing set, and see how we do…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">mistakes, n_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, Y_test.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb43-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_test):</span>
<span id="cb43-3">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> proj_test[i]</span>
<span id="cb43-4">    y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> knn_predict(x, proj_train, Y_train, k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb43-5">    y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Y_test[i]</span>
<span id="cb43-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> y_pred:</span>
<span id="cb43-7">        mistakes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> </span>
<span id="cb43-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>:   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show some examples</span></span>
<span id="cb43-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x, y_pred, y_true ="</span>,x, y_pred, y_true, </span>
<span id="cb43-10">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YAY!"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> y_pred<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>y_true <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"     BOO. :-("</span>)</span>
<span id="cb43-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"...skipping a lot..."</span>)</span>
<span id="cb43-12"></span>
<span id="cb43-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Accuracy ="</span>, (n_test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>mistakes)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n_test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x, y_pred, y_true = [-0.01242698  0.00547996  0.02020715] 8 8 YAY!
x, y_pred, y_true = [-0.04788666  0.03369412  0.00761786] 5 9      BOO. :-(
x, y_pred, y_true = [ 0.0394503  -0.11012404  0.04138117] 1 1 YAY!
x, y_pred, y_true = [-0.01624803  0.0017128   0.00093119] 8 2      BOO. :-(
x, y_pred, y_true = [-0.02510674 -0.02747576 -0.02851513] 8 9      BOO. :-(
x, y_pred, y_true = [ 0.04391237 -0.10986729  0.01005749] 1 1 YAY!
x, y_pred, y_true = [ 0.02785789 -0.02758998  0.03546457] 7 6      BOO. :-(
x, y_pred, y_true = [ 0.028658   -0.07597674  0.01924342] 7 1      BOO. :-(
x, y_pred, y_true = [-0.02178398  0.03732549  0.01712057] 5 5 YAY!
x, y_pred, y_true = [ 0.06365388 -0.05558701  0.07012057] 1 1 YAY!
x, y_pred, y_true = [-0.03698522 -0.00566659  0.01859906] 8 3      BOO. :-(
x, y_pred, y_true = [ 0.07903279 -0.02894052 -0.03747521] 4 4 YAY!
x, y_pred, y_true = [ 0.00711305  0.08348257 -0.03428523] 0 0 YAY!
x, y_pred, y_true = [ 0.00023215 -0.07071015 -0.0528109 ] 7 1      BOO. :-(
x, y_pred, y_true = [-0.01383398 -0.03721692  0.04507276] 5 8      BOO. :-(
x, y_pred, y_true = [-0.02679815  0.00975806 -0.00682696] 8 8 YAY!
x, y_pred, y_true = [-0.08406223 -0.0140606   0.04496365] 3 3 YAY!
x, y_pred, y_true = [-0.00516822 -0.07477563 -0.04794298] 7 7 YAY!
x, y_pred, y_true = [-0.02602277 -0.04128368  0.10058385] 2 2 YAY!
x, y_pred, y_true = [-0.07057815 -0.00856962  0.04424423] 3 3 YAY!
...skipping a lot...
Total Accuracy = 74.3732590529248 %</code></pre>
</div>
</div>
<p>…eh! Not bad, not amazing. You can improve the accuracy if you go back up and increase the number of PCA dimensions beyond 3, and/or increase the value of <img src="https://latex.codecogs.com/png.latex?k">. Go ahead and try it!</p>
<p><small>(For 10 dimensions and <img src="https://latex.codecogs.com/png.latex?k=7">, I got 97.7% accuracy. The highest I ever got it was 99%, but that was really working overtime, computationally speaking; the point of PCA is to let you dramatically reduce your workload while retaining reasonably high accuracy.)</small></p>
<p>Just to reiterate: This is NOT supposed to be a state of the art classifier! It’s just a toy that does pretty well and helps illustrate PCA without being hard to understand or code.</p>
</section>
<section id="the-end" class="level1">
<h1>The End</h1>
<p>Thanks for sticking around! Hope this was interesting. PCA is pretty simple, and yet really useful!<br>
…and writing this really helped <em>me</em> to better understand it. ;-)</p>


</section>

 ]]></description>
  <category>math</category>
  <category>foundations</category>
  <guid>https://drscotthawley.github.io/blog/posts/2019-12-21-pca-from-scratch.html</guid>
  <pubDate>Sat, 21 Dec 2019 06:00:00 GMT</pubDate>
  <media:content url="https://i.imgur.com/vKiH8As.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Getting Started in ML+Audio</title>
  <link>https://drscotthawley.github.io/blog/posts/2019-12-06-Getting-Started-In-ML-Audio.html</link>
  <description><![CDATA[ 




<p>Recently, after co-chairing the session on Machine Learning for Musical Acoustics along with the wonderful <a href="http://audioakustyka.org/head-of-laboratory/">Bozena Kostek</a> at the <a href="https://acousticalsociety.org/program-of-178th-meeting-of-the-acoustical-society-of-america/">Acoustical Society of America Meeting in San Diego</a>, a student came up to me to ask for advice or resources on how to start learning machine learning for audio applications.</p>
<p>And I didn’t have a good answer. Because, while there’s plenty of tips out there for learning image classification or NLP, not a ton of it relates to audio. Students have asked me this before…and so I was frustrated by my own lack of an answer, apart from “read whatever you find, try out demos, take whatever courses you can, etc.”</p>
<p>SO! Now, with graduate student <a href="https://www.linkedin.com/in/ryan-miller-1aa8355a/">Ryan Miller</a> (EDIT 6/1/2020: who is now gainfully employed at Creative Labs!), we compiled a list and posted it to GitHub:</p>
<section id="ml-audio-start-page" class="level2">
<h2 class="anchored" data-anchor-id="ml-audio-start-page"><a href="https://github.com/drscotthawley/ml-audio-start">ml-audio-start Page</a></h2>
<p>… and soliciting contributions from the community.</p>
<p>EDIT 02/01/2020: We now have contributions from accomplished researchers at Google, Adobe, and others!</p>


</section>

 ]]></description>
  <category>foundations</category>
  <guid>https://drscotthawley.github.io/blog/posts/2019-12-06-Getting-Started-In-ML-Audio.html</guid>
  <pubDate>Fri, 06 Dec 2019 06:00:00 GMT</pubDate>
  <media:content url="https://drscotthawley.github.io/blog/posts/images/class_chairs.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>My First NN Part 3. Multi-Layer Networks and Backpropagation</title>
  <link>https://drscotthawley.github.io/blog/posts/2019-02-08-my-1st-nn-part-3-multi-layer-and-backprop.html</link>
  <description><![CDATA[ 




<p>Links to lessons: <a href="https://drscotthawley.github.io/blog/2017/02/23/Following-Gravity-Colab.html">Part 0</a>, <a href="https://drscotthawley.github.io/blog/2019/01/30/My-First-Neural-Network.html">Part 1</a>, <a href="https://drscotthawley.github.io/blog/2019/02/04/My-First-NN-Part-2.html">Part 2</a>, <a href="https://drscotthawley.github.io/blog/2019/02/08/My-1st-NN-Part-3-Multi-Layer-and-Backprop.html">Part 3</a></p>
<section id="what-is-backpropagation" class="level2">
<h2 class="anchored" data-anchor-id="what-is-backpropagation">What is Backpropagation?</h2>
<p>First watch this <a href="https://www.youtube.com/watch?v=q555kfIFUCM">5-minute video on backprop by Siraj Raval</a>.</p>
<p><strong>EDIT 2/20/2020:</strong> ^Ravel was later revealed to be plagiarizing content. I will look for an alternative link. The format in <a href="https://hedges.belmont.edu/~shawley/PHY2895/">my (“flipped”) ML course last year</a> involved reading things, watching <em>brief</em> videos, and modifying code. Siraj’s video fit the bill last year as being <em>brief</em> &amp; <em>good</em>.</p>
</section>
<section id="a-multi-layer-network" class="level2">
<h2 class="anchored" data-anchor-id="a-multi-layer-network">A Multi-Layer Network</h2>
<p>Between the input <img src="https://latex.codecogs.com/png.latex?X"> and output <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> of the network we encountered earlier, we now interpose a “hidden layer,” connected by two sets of weights <img src="https://latex.codecogs.com/png.latex?w%5E%7B(0)%7D"> and <img src="https://latex.codecogs.com/png.latex?w%5E%7B(1)%7D"> as shown in the figure below. This image is a bit more complicated than diagrams one might typically encounter; I wanted to be able to show and label all the different “parts.” We will explain what the various symbols mean as we continue after the figure. <img src="https://drscotthawley.github.io/blog/posts/https:/i.imgur.com/WjaQDnW.png" class="img-fluid" alt="image of multi-layer network"></p>
<p>As before, the combined operation of weighted sum and nonlinear activation is referred to as a(n artificial) neuron; in the diagram above there are 4 “hidden neurons” — or equivalently “4 neurons in the hidden layer” — as well as one neuron for output. (The activations <img src="https://latex.codecogs.com/png.latex?f%5E%7B(0)%7D"> and <img src="https://latex.codecogs.com/png.latex?f%5E%7B(1)%7D"> may be the same, or they may be different.)</p>
</section>
<section id="semantics-what-is-a-layer" class="level2">
<h2 class="anchored" data-anchor-id="semantics-what-is-a-layer">Semantics: What is a Layer?</h2>
<p>The term “layer” in regards to neural network is not always used consistently. You may find it used in different senses by different authors.</p>
<ol type="1">
<li>Some users of the term will only use it with repect to <em>weight matrices</em>, (since these are the parts of the network which are adjusted in learning).</li>
<li>Others will refer to the input and (predicted) output as layers, and may or may not include the weights as layers..</li>
<li>Others will only count additional “hidden layers” between the inputs and outputs, and these “layers” are <em>connected by</em> multiple weight matrices.<br>
</li>
<li>Some will speak of “activation layers.” In software libraries like Keras, many different types of operations and storage are referred to as layers.</li>
</ol>
<p>For the work we’ve done so far, we’ve had inputs and outputs connected by one weight matrix, subject to a nonlinear activation function. Is this a two-layer network made of input and output “layers,”” or is it a single-layer network, because there is only one weight matrix? What about the activation layer? This is to some degree a semantic issue which one does not need to get hung up on.</p>
<p><strong>For our purposes</strong> it is convenient to refer to the inputs <img src="https://latex.codecogs.com/png.latex?X">, the ‘activated’ hidden states <img src="https://latex.codecogs.com/png.latex?H">, and the output <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> as “layers”, numbering them 0, 1, and 2 respectively, and using the script notation <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D%5El"> to denote each layer, where the layer index <img src="https://latex.codecogs.com/png.latex?l=0..2">, so that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BL%7D%5E%7B(0)%7D%20=%20X,%20%5C%20%5C%20%5C%20%5C%20%5Cmathcal%7BL%7D%5E%7B(1)%7D%20=%20H,%5C%20%5C%20%5C%20%5C%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%20=%20%5Ctilde%7BY%7D%0A"></p>
<p>This makes it easy to write the value of higher-numbered layers in terms of lower-numbed layers, i.e., <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BL%7D%5E%7B(l+1)%7D%20=%20f%5E%7B(l)%7D%5Cleft(%20%7B%5Cmathcal%7BL%7D%5E%7B(l)%7D%7D%5ET%20%5Ccdot%20w%5E%7B(l)%7D%20%5Cright),%0A"> where the dot <img src="https://latex.codecogs.com/png.latex?%5Ccdot"> denotes a matrix product. This is often referred to as a <strong>“feed foward”</strong> operation because values are fed from left to right in the above diagram, “forward” through the network. (Backpropagation will involve feeding values from right to left.)</p>
<p><strong><em>Response to student question(s): </em></strong> <em>“What <em>are</em> neurons? Like, what does this mean in terms of matrices?”</em></p>
<p>This will serve as a review of the <a href="https://drscotthawley.github.io/blog/2019/01/30/My-First-Neural-Network.html">Part 1</a> lesson. Using the above notation, the operations from the input to the hidden layer look like this in matrix form:</p>
<p><img src="https://drscotthawley.github.io/blog/posts/https:/i.imgur.com/hgtEpVH.png" class="img-fluid" alt="matrix form of first calcs"> …where the lines in dark red and cyan are simply to indicate sample calculations which are part of the matrix multiplication.</p>
</section>
<section id="figuring-out-dimensions-of-the-weights" class="level2">
<h2 class="anchored" data-anchor-id="figuring-out-dimensions-of-the-weights">Figuring out dimensions of the weights</h2>
<p>When we learned about matrix multipliation, we remarked that most of the time in machine learning, “the trick is to get the inner dimensions to match.”</p>
<p>Let’s say there are <img src="https://latex.codecogs.com/png.latex?N"> different input data “points” consisting of <img src="https://latex.codecogs.com/png.latex?M"> values each. So the input <img src="https://latex.codecogs.com/png.latex?X"> is an <img src="https://latex.codecogs.com/png.latex?N%5Ctimes%20M"> matrix. And let the output <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> be a <img src="https://latex.codecogs.com/png.latex?NxP"> matrix (in our example, <img src="https://latex.codecogs.com/png.latex?P=1">). If we were just connecting <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> with no hidden layer, the single weights matrix would be a <img src="https://latex.codecogs.com/png.latex?M%5Ctimes%20P"> matrix:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bred%7DM)%5Ccdot(%5Ccolor%7Bred%7DM%5Ctimes%20%5Ccolor%7Bgreen%7DP)%20=%20(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bgreen%7DP)%0A"> (The nonlinear activation doesn’t change the dimensions of the matrices.)</p>
<p>Adding a hidden layer with <img src="https://latex.codecogs.com/png.latex?Q"> number of neurons means we will still have <img src="https://latex.codecogs.com/png.latex?N"> different activations for each neuron (i.e.&nbsp;for each datapoint), so that <img src="https://latex.codecogs.com/png.latex?H"> is a <img src="https://latex.codecogs.com/png.latex?N%5Ctimes%20Q"> matrix. Thus the dimensions of <img src="https://latex.codecogs.com/png.latex?w%5E0"> must “match” between these two matrices, and so <img src="https://latex.codecogs.com/png.latex?w%5E0"> must be a <img src="https://latex.codecogs.com/png.latex?M%5Ctimes%20Q"> matrix:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bred%7DM)%5Ccdot(%5Ccolor%7Bred%7DM%5Ctimes%20%5Ccolor%7Bpurple%7DQ)%20=%20(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bpurple%7DQ)%0A"> Similarly <img src="https://latex.codecogs.com/png.latex?w%5E1"> must be a <img src="https://latex.codecogs.com/png.latex?Q%5Ctimes%20P"> matrix, and the full operation in terms of matrix dimensions is</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bred%7DM)%5Ccdot(%5Ccolor%7Bred%7DM%5Ctimes%20%5Ccolor%7Bpurple%7DQ)%5Ccdot(%5Ccolor%7Bpurple%7DQ%5Ctimes%20%5Ccolor%7Bgreen%7DP)%20=%20(%5Ccolor%7Bblue%7DN%5Ctimes%20%5Ccolor%7Bgreen%7DP).%0A"> Compare this to the diagram above for <img src="https://latex.codecogs.com/png.latex?P=1">, <img src="https://latex.codecogs.com/png.latex?Q=4">.</p>
<p><em>Note: If you add bias terms to your model, you may need to remember that the number of columns in both the input <img src="https://latex.codecogs.com/png.latex?X"> and hidden layer <img src="https://latex.codecogs.com/png.latex?H"> are greater by one, i.e.&nbsp;<img src="https://latex.codecogs.com/png.latex?%5Ccolor%7Bred%7D%7BM%7D%5Crightarrow%20%5Ccolor%7Bred%7D%7BM+1%7D">, etc.</em></p>
<p>##..a bit of code</p>
<p>The layers <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D%5El"> can be represented in Python a list called <code>layers</code> which has a of length 3. Similarly, our weights can be items in a list called <code>weights</code>. Returning to our first sample problem from Part 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Training data: input and target </span></span>
<span id="cb1-6">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([  [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-7">                [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-8">                [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-9">                [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] ])</span>
<span id="cb1-10">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]).T</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define auxiliary variables</span></span>
<span id="cb1-13">N, M, P  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], Y.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># infer matrix shape variables from training data</span></span>
<span id="cb1-14">Y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,P))                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setup storage for network output </span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hidden layers</span></span>
<span id="cb1-17">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of hidden neurons, i.e. "size of hidden layer"</span></span>
<span id="cb1-18">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,Q))</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># weight matrices</span></span>
<span id="cb1-21">w0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.random((M,Q)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-22">w1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.random((Q,P)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make lists for layers and weights</span></span>
<span id="cb1-25">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X, H, Y_tilde]</span>
<span id="cb1-26">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [w0, w1]</span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Just try a sample calculation with random intialization to see how this works </span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feed-forward (with linear activation):</span></span>
<span id="cb1-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb1-31">  layers[l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(layers[l], weights[l])</span>
<span id="cb1-32">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"layers ["</span>,l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"] =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, layers[l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sep="" just omits spaces</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>layers [1] =
[[-0.58431094  0.24256333  0.85640655  0.25641678]
 [-0.45815989  0.80598459  1.63132867 -0.10938617]
 [-0.38151492  0.81129189  0.8919347   0.03921142]
 [-0.25536386  1.37471315  1.66685682 -0.32659153]]
layers [2] =
[[-0.97388449]
 [-2.37430685]
 [-1.56570389]
 [-2.96612624]]</code></pre>
</div>
</div>
<p>Generalizing this so it will do the full feed-forward will take a bit more code. We’ll leave a placeholder routine for backpropagation for now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Activation choices</span></span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sigmoid(x, deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>): </span>
<span id="cb3-3">  f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x))</span>
<span id="cb3-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>f) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> deriv <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> f</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> relu(x, deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):   </span>
<span id="cb3-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> deriv <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Placeholder routine to perform backprop.  Will fill in later</span></span>
<span id="cb3-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> update_weights(weights, layers, Y, alpha, activ):</span>
<span id="cb3-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> weights                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for now, it's a no-op</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> fit(layers, Y, activ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[sigmoid]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, use_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>):</span>
<span id="cb3-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  Routine for training using a multi-layer network</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    layers:    list of layer values, i.e. layers =  [X, H, Y_tilde]</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Y:         target output</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    activ:     list of activation functions. default = list of 2 sigmoids</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    use_bias:  Whether to include a constant offset in weighted sums</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    alpha:     learning rate</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    maxiter:   number of iterations to run</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  """</span></span>
<span id="cb3-24">  lmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(layers)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># max index of layers, also = # of weights</span></span>
<span id="cb3-25">  </span>
<span id="cb3-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> use_bias:           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a column of 1's to every layer except the last</span></span>
<span id="cb3-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):</span>
<span id="cb3-28">        new_col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones((layers[el].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) </span>
<span id="cb3-29">        layers[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.hstack((new_col, layers[el])) </span>
<span id="cb3-30">  </span>
<span id="cb3-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define weights</span></span>
<span id="cb3-32">  np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility</span></span>
<span id="cb3-33">  weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lmax            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># allocate slots in a blank list</span></span>
<span id="cb3-34">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "el" because "l" and "1" may look similar</span></span>
<span id="cb3-35">    weights[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.random((layers[el].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], layers[el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-36">        </span>
<span id="cb3-37">  loss_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start with an empty list</span></span>
<span id="cb3-38">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(maxiter):</span>
<span id="cb3-39"></span>
<span id="cb3-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feed-forward pass</span></span>
<span id="cb3-41">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):</span>
<span id="cb3-42">      layers[el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activ[el](np.dot(layers[el], weights[el]))</span>
<span id="cb3-43">      </span>
<span id="cb3-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loss monitoring</span></span>
<span id="cb3-45">    diff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> layers[lmax] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Y</span>
<span id="cb3-46">    loss_hist.append( (diff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).mean()  )    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use MSE loss for monitoring</span></span>
<span id="cb3-47">          </span>
<span id="cb3-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backprop code will go here</span></span>
<span id="cb3-49">    weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_weights(weights, layers, Y, alpha, activ)</span>
<span id="cb3-50"></span>
<span id="cb3-51">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> weights, layers[lmax], loss_hist        </span>
<span id="cb3-52"></span>
<span id="cb3-53"></span>
<span id="cb3-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test this just to make sure it runs</span></span>
<span id="cb3-55">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X,H,Y_tilde]</span>
<span id="cb3-56">weights, Y_tilde, loss_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-57"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(weights)):</span>
<span id="cb3-58">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weights["</span>,el,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"] = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,weights[el], sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>weights[0] = 
[[-0.16595599  0.44064899 -0.99977125 -0.39533485 -0.70648822]
 [-0.81532281 -0.62747958 -0.30887855 -0.20646505  0.07763347]
 [-0.16161097  0.370439   -0.5910955   0.75623487 -0.94522481]
 [ 0.34093502 -0.1653904   0.11737966 -0.71922612 -0.60379702]]
weights[1] = 
[[ 0.60148914]
 [ 0.93652315]
 [-0.37315164]
 [ 0.38464523]
 [ 0.7527783 ]]</code></pre>
</div>
</div>
<p>…Now that we’ve achieved feed-foward operation of the network, in order to make it ‘learn’ or ‘train’, we need to compare the output value <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> (which is the same as <code>layers[2]</code> by the way) to the target value, compute the gradients of the loss function, and then backpropagate in order to update all the weights!</p>
</section>
<section id="backpropagating-theory" class="level2">
<h2 class="anchored" data-anchor-id="backpropagating-theory">Backpropagating: Theory</h2>
<p><strong>TL/DR: You can skip down to the last boxed equation of this section if math scares you. You will not be required to reproduce this. I <em>do</em> want to show you “where this stuff comes from”, but if you find the derivation too intimidating, you can still progress in the course just fine.</strong></p>
<p>Let’s review how we got the gradients for <img src="https://latex.codecogs.com/png.latex?w%5E%7B(1)%7D"> in Part 2, denoting weighted sums by “<img src="https://latex.codecogs.com/png.latex?S">”, e.g.&nbsp;<img src="https://latex.codecogs.com/png.latex?S%5El%20=%20%5Cmathcal%7BL%7D%5El%5Ccdot%20w%5El">, we just used the Chain Rule: <img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(1)%7D%7D%20=%0A%5Ccolor%7Bblue%7D%0A%7B%5Cpartial%20L%20%5Cover%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%7D%0A%5Ccolor%7Bgreen%7D%0A%7B%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%20%5Cover%5Cpartial%20S%5E%7B(1)%7D%7D%0A%5Ccolor%7Bred%7D%0A%7B%5Cpartial%20S%5E%7B(1)%7D%20%5Cover%5Cpartial%20w%5E%7B(1)%7D%7D%0A"> We’ll define the first partial derivative to be <img src="https://latex.codecogs.com/png.latex?%5Cdelta%5E%7B(2)%7D">, which works out (given our choice of <img src="https://latex.codecogs.com/png.latex?L"> from Part 2) to be <img src="https://latex.codecogs.com/png.latex?%5Ccolor%7Bblue%7D%7B%0A%7B%5Cpartial%20L%20%5Cover%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%7D%0A=%5Cdelta%5E%7B(2)%7D%20=%20%5Ctilde%7BY%7D-Y%7D,"> i.e., it is the error in the final ouput. The next partial derivative (in green) is just the derivative of the activation function <img src="https://latex.codecogs.com/png.latex?f">, and the last partial derivative is just <img src="https://latex.codecogs.com/png.latex?%5Ccolor%7Bred%7D%7B%5Cmathcal%7BL%7D%5E%7B(1)%7D%7D">, so as we saw in the previous lesson, we can write this ‘schematically’ (i.e.&nbsp;not quite as a properly-set-up matix equation yet) as <img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(1)%7D%7D%20=%0A%5Ccolor%7Bblue%7D%7B%5Cdelta%5E%7B(2)%7D%7D%0A%5Ccolor%7Bgreen%7D%20%7Bf%5E%7B(1)%5Cprime%7D%20%7D%0A%5Ccolor%7Bred%7D%7B%5Cmathcal%7BL%7D%5E%7B(1)%7D%7D%0A"> whereas in proper form it will take on this ordering as a matrix equation: <img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(1)%7D%7D%20=%0A%7B%5Cmathcal%7BL%7D%5E%7B(1)%7D%7D%5ET%20%5Ccdot%0A%7B%5Cdelta%5E%7B(2)%7D%7D%0A%7Bf%5E%7B(1)%5Cprime%7D%7D%0A%7D.%0A"></p>
<p>To get the gradients for <img src="https://latex.codecogs.com/png.latex?w%5E%7B(0)%7D">, we can make use of a similar “<img src="https://latex.codecogs.com/png.latex?%5Cdelta">” notation if we’re careful in how we define a new <img src="https://latex.codecogs.com/png.latex?%5Cdelta%5E%7B(1)%7D">. Let’s write out the chain rule, and put parentheses around a particular group of terms for later:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(0)%7D%7D%20=%0A%5Ccolor%7Bblue%7D%7B%0A%5Cleft(%0A%7B%5Cpartial%20L%20%5Cover%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%7D%0A%7B%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(2)%7D%20%5Cover%5Cpartial%20S%5E%7B(1)%7D%7D%0A%7B%5Cpartial%20S%5E%7B(1)%7D%20%5Cover%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(1)%7D%7D%0A%5Cright)%7D%0A%5Ccolor%7Bgreen%7D%0A%7B%5Cpartial%20%5Cmathcal%7BL%7D%5E%7B(1)%7D%20%5Cover%5Cpartial%20S%5E%7B(0)%7D%7D%0A%5Ccolor%7Bred%7D%0A%7B%5Cpartial%20S%5E%7B(0)%7D%20%5Cover%5Cpartial%20w%5E%7B(0)%7D%7D%0A"> In a manner similar to what we did above, this can be written as <img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(0)%7D%7D%20=%0A%5Ccolor%7Bblue%7D%7B%0A%5Cleft(%5Cdelta%5E%7B(2)%7Df%5E%7B(1)%5Cprime%7Dw%5E%7B(1)%7D%5Cright)%7D%0A%5Ccolor%7Bgreen%7D%7Bf%5E%7B(0)%5Cprime%7D%7D%0A%5Ccolor%7Bred%7D%7B%5Cmathcal%7BL%5E%7B(0)%7D%7D%7D%0A"> We now <em>define</em> the terms in parentheses as <img src="https://latex.codecogs.com/png.latex?%5Cdelta%5E%7B(1)%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccolor%7Bblue%7D%7B%0A%5Cdelta%5E%7B(1)%7D%20=%20%20%5Cdelta%5E%7B(2)%7Df%5E%7B(1)%5Cprime%7Dw%5E%7B(1)%7D%0A%7D,%0A"> …which is <em>kind of</em> like “the error in the hidden layer,” or like the final solution error projected backward into the hidden layers via our (momentarily fixed) weights <img src="https://latex.codecogs.com/png.latex?w%5E%7B(1)%7D">.</p>
<p>Then our gradients for <img src="https://latex.codecogs.com/png.latex?w%5E%7B(0)%7D"> take on a similar form as the gradients for <img src="https://latex.codecogs.com/png.latex?w%5E%7B(1)%7D">. ‘Schematically’ this looks like <img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(0)%7D%7D%20=%0A%5Ccolor%7Bblue%7D%7B%5Cdelta%5E%7B(1)%7D%7D%0A%5Ccolor%7Bgreen%7D%7Bf%5E%7B(0)%5Cprime%7D%7D%0A%5Ccolor%7Bred%7D%7B%5Cmathcal%7BL%5E%7B(0)%7D%7D%7D%0A"> and in proper matrix form this is <img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B%0A%7B%5Cpartial%20L%5Cover%5Cpartial%20w%5E%7B(0)%7D%7D%20=%0A%7B%5Cmathcal%7BL%7D%5E%7B(0)%7D%7D%5ET%20%5Ccdot%0A%7B%5Cdelta%5E%7B(1)%7D%7D%0A%7Bf%5E%7B(0)%5Cprime%7D%7D%0A%7D,%0A"> i.e., the <em>same form</em> as the preceding layer, just “back” one layer. We are backpropagating the errors <img src="https://latex.codecogs.com/png.latex?%5Cdelta%5E%7B(l)%7D"> from one layer to another in order to update the weights.</p>
<p>The weights are then updated as before, except now we will write this ‘generically’ for all weights and layers using the index <img src="https://latex.codecogs.com/png.latex?l">: <img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B%0Aw%5E%7B(l)%7D%20:=%20w%5E%7B(l)%7D%20-%20%5Calpha%20%7B%5Cmathcal%7BL%7D%5E%7B(l)%7D%7D%5ET%20%5Ccdot%0A%7B%5Cdelta%5E%7B(l+1)%7D%7D%0A%7Bf%5E%7B(l)%5Cprime%7D%7D%0A%7D,%0A"> where <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta%5E%7B(l+1)%7D%20=%20%5Cleft%5C%7B%20%5Cbegin%7Barray%7D%7Bl%7D%0A%5Ctilde%7BY%7D-Y,%5C%20%5C%20%5C%20%20&amp;%5C%20&amp;l+1=l_%7Bmax%7D%20%5C%20%5C%20%5C%20%5C%20(%7B%5Crm%20e.g.%7D%20%5C%20l_%7Bmax%7D=2)%5C%5C%0A%5Cdelta%5E%7B(l+2)%7Df%5E%7B(l+1)%5Cprime%7D%5Ccdot%20%7Bw%5E%7B(l+1)%7D%7D%5ET,%20&amp;%5C%20&amp;l+1%20%3C%20l_%7Bmax%7D%0A%5Cend%7Barray%7D%5Cright.%0A"></p>
</section>
<section id="writing-the-backprop-code" class="level2">
<h2 class="anchored" data-anchor-id="writing-the-backprop-code">Writing the Backprop Code</h2>
<p>Now we’ll use the above analysis to replace the <code>update_weights()</code> function from earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> update_weights(weights, layers, Y, alpha, activ):</span>
<span id="cb5-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  Backprop routine, for arbitrary numbers of layers, assuming weights &amp; </span></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  activations are defined</span></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  Inputs:</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    weights: list of arrays of weights between each layer</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    layers:  list of arrays of layer values (post-activation function)</span></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Y:       target output</span></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    alpha:   learning rate</span></span>
<span id="cb5-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    activ:   list of activation functions for each (non-input) layer</span></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  Outputs:</span></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    weights (updated)</span></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  """</span></span>
<span id="cb5-15">  lmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(layers) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a useful variable</span></span>
<span id="cb5-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(weights)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>lmax                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure number of weights match up</span></span>
<span id="cb5-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(activ) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> lmax                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure we defined enough activations for the layers</span></span>
<span id="cb5-18">    </span>
<span id="cb5-19">  delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> layers[lmax] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Y                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># error between output and target</span></span>
<span id="cb5-20">  </span>
<span id="cb5-21">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count backwards to layer zero</span></span>
<span id="cb5-22">    fprime <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activ[el](np.dot(layers[el], weights[el]), deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># deriv of activation</span></span>
<span id="cb5-23">    weights[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.dot( layers[el].T, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>fprime )       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gradient descent step</span></span>
<span id="cb5-24">    delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>fprime, weights[el].T) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setup delta for next pass in loop</span></span>
<span id="cb5-25"></span>
<span id="cb5-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> weights           </span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's run it!</span></span>
<span id="cb5-29">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X, H, Y_tilde]</span>
<span id="cb5-30">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb5-31">maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span></span>
<span id="cb5-32">weights, Y_tilde, loss_hist_2weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>maxiter)</span>
<span id="cb5-33"></span>
<span id="cb5-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compare against a 1-weight (no hidden layer) network:</span></span>
<span id="cb5-35">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X, Y_tilde]</span>
<span id="cb5-36">weights, Y_tilde, loss_hist_1weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>maxiter)</span>
<span id="cb5-37"></span>
<span id="cb5-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the loss history</span></span>
<span id="cb5-39">plt.semilogy(loss_hist_1weight, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No hidden layers"</span>)</span>
<span id="cb5-40">plt.semilogy(loss_hist_2weights, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hidden layer"</span>)</span>
<span id="cb5-41">plt.legend()</span>
<span id="cb5-42">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>)</span>
<span id="cb5-43">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loss"</span>)</span>
<span id="cb5-44">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-02-08-My-1st-NN-Part-3-Multi-Layer-and-Backprop_files/figure-html/cell-4-output-1.png" width="599" height="429"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's add more hidden neurons</span></span>
<span id="cb6-2">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of hidden neurons, i.e. "size of hidden layer"</span></span>
<span id="cb6-3">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,Q))</span>
<span id="cb6-4"></span>
<span id="cb6-5">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X, H, Y_tilde]</span>
<span id="cb6-6">weights, Y_tilde, loss_hist_many <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>maxiter)</span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># try a relu activation for the hidden layer (leave output activ as sigmoid!)</span></span>
<span id="cb6-9">weights, Y_tilde, lhm_relu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha, activ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[relu,sigmoid], maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>maxiter)</span>
<span id="cb6-10"></span>
<span id="cb6-11">plt.semilogy(loss_hist_1weight, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 hidden neurons"</span>)</span>
<span id="cb6-12">plt.semilogy(loss_hist_2weights, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4 hidden neurons"</span>)</span>
<span id="cb6-13">plt.semilogy(loss_hist_many, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"many hidden neurons"</span>)</span>
<span id="cb6-14">plt.semilogy(lhm_relu, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"many, relu on hidden"</span>)</span>
<span id="cb6-15"></span>
<span id="cb6-16">plt.legend()</span>
<span id="cb6-17">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>)</span>
<span id="cb6-18">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loss"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'Loss')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-02-08-My-1st-NN-Part-3-Multi-Layer-and-Backprop_files/figure-html/cell-5-output-2.png" width="599" height="429"></p>
</div>
</div>
</section>
<section id="solving-xor" class="level2">
<h2 class="anchored" data-anchor-id="solving-xor">Solving XOR</h2>
<p>Now let’s revisit the “XOR” problem that a single neuron couldn’t handle.</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Coverbrace%7B%0A%5Cleft%5B%20%7B%5Cbegin%7Barray%7D%7Bcc%7D%0A%20%20%20%200%20&amp;%200%20%5C%5C%0A%20%20%20%200%20&amp;%201%20%5C%5C%0A%20%20%20%201%20&amp;%200%20%5C%5C%0A%20%20%20%201%20&amp;%201%20%5C%5C%0A%20%20%5Cend%7Barray%7D%20%7D%20%5Cright%5D%0A%7D%5E%7BX%7D%20%5Crightarrow%0A%5Coverbrace%7B%0A%5Cleft%5B%20%7B%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%200%20%20%20%5C%5C%0A%20%20%201%20%20%5C%5C%0A%20%20%201%20%20%5C%5C%0A%20%20%200%20%5C%5C%0A%20%20%5Cend%7Barray%7D%20%7D%20%5Cright%5D%0A%20%20%7D%5EY.%0A"> With our multi-layer network, we can solve this. Note that while an exact solution to the XOR problem exists using only 2 hidden neurons and linear activations, a program can still have a hard time <em>finding</em> a good approximation via gradient descent, and we use 20 hidden neurons to assist, as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]])</span>
<span id="cb8-2">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]).T</span>
<span id="cb8-3">Y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Y                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Just allocate some storage</span></span>
<span id="cb8-4">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))                  </span>
<span id="cb8-5"></span>
<span id="cb8-6">weights, Y_tilde, loss_hist_xor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit([X,H,Y_tilde], Y, activ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[relu,sigmoid], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb8-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prediction Y_tilde ="</span>,Y_tilde.T)</span>
<span id="cb8-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Target Y (correct answer)  ="</span>,Y.T)</span>
<span id="cb8-9">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>)</span>
<span id="cb8-10">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loss"</span>)</span>
<span id="cb8-11">plt.loglog(loss_hist_xor)</span>
<span id="cb8-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print("weights = ",weights)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Prediction Y_tilde = [[0.00480128 0.9962425  0.9963109  0.00374649]]
Target Y (correct answer)  = [[0 1 1 0]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-02-08-My-1st-NN-Part-3-Multi-Layer-and-Backprop_files/figure-html/cell-6-output-2.png" width="599" height="431"></p>
</div>
</div>
</section>
<section id="same-thing-using-neural-network-libraries-keras-pytorch." class="level1">
<h1>Same thing using neural network libraries Keras &amp; PyTorch.</h1>
<p>Since most of the time we won’t be writing neural network systems “from scratch, by hand” in numpy, let’s take a look at similar operations using libraries such as Keras or PyTorch.</p>
<section id="keras-version" class="level2">
<h2 class="anchored" data-anchor-id="keras-version">Keras version</h2>
<p><a href="https://keras.io/">Keras</a> is so simple to set up, it’s easy to get started. This is what the previous example for XOR looks like “in Keras”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> keras</span>
<span id="cb10-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> keras.models <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Sequential</span>
<span id="cb10-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> keras.layers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Dense, Activation</span>
<span id="cb10-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> keras.optimizers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Adam</span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training data</span></span>
<span id="cb10-7">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]])</span>
<span id="cb10-8">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]).T</span>
<span id="cb10-9"></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># specify model</span></span>
<span id="cb10-11">n_hidden <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb10-12">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Sequential([</span>
<span id="cb10-13">    Dense(n_hidden, input_shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],), activation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'relu'</span>),</span>
<span id="cb10-14">    Dense(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, activation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sigmoid'</span>)])</span>
<span id="cb10-15"></span>
<span id="cb10-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># choices for loss and optimization method</span></span>
<span id="cb10-17">opt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Adam(lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We'll talk about optimizer choices later</span></span>
<span id="cb10-18">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(optimizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>opt, loss<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'binary_crossentropy'</span>,metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'binary_accuracy'</span>])</span>
<span id="cb10-19"></span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training iterations</span></span>
<span id="cb10-21">model.fit(X, Y, epochs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>maxiter, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-22"></span>
<span id="cb10-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Y_tilde = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, model.predict(X) )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:`lr` is deprecated in Keras optimizer, please use `learning_rate` or use the legacy optimizer, e.g.,tf.keras.optimizers.legacy.Adam.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 28ms/step

Y_tilde = 
 [[2.1021294e-03]
 [9.9999869e-01]
 [9.9999863e-01]
 [2.0069590e-06]]</code></pre>
</div>
</div>
<p>Keras can get a better appoximation than we did because of the choice of optimizer algorithm. We’ll talk about optimization algorithms (refinements to gradient descent) another time.</p>
</section>
<section id="pytorch-version" class="level2">
<h2 class="anchored" data-anchor-id="pytorch-version">PyTorch version</h2>
<p>Unlike Keras, <a href="https://pytorch.org/">PyTorch</a> does not have any “training wheels.” You have to specify a number of the operations yourself. It’s helpful to have a template to start from, such as the following example for our XOR problem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># it's 'PyTorch' but the package is 'torch'</span></span>
<span id="cb13-2">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.device(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handy for changing to 'cuda' in GPU runtimes later!</span></span>
<span id="cb13-3"></span>
<span id="cb13-4">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility</span></span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training data</span></span>
<span id="cb13-7">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]],dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.float32)</span>
<span id="cb13-8">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]],dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.float32).T</span>
<span id="cb13-9"></span>
<span id="cb13-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-cast data as PyTorch variables, on the device (CPU or GPU) were calc's are performed</span></span>
<span id="cb13-11">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor(X).to(device), torch.tensor(Y).to(device)   </span>
<span id="cb13-12"></span>
<span id="cb13-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># specify model (similar to Keras but not quite)</span></span>
<span id="cb13-14">n_hidden <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of hidden neurons</span></span>
<span id="cb13-15">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.Sequential(</span>
<span id="cb13-16">          torch.nn.Linear(X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], n_hidden),</span>
<span id="cb13-17">          torch.nn.ReLU(),</span>
<span id="cb13-18">          torch.nn.Linear(n_hidden, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb13-19">          torch.nn.Sigmoid()</span>
<span id="cb13-20">        ).to(device)</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># choices for loss and optimization method</span></span>
<span id="cb13-23">loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.BCELoss()      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># binary cross-entropy loss</span></span>
<span id="cb13-24">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam([{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'params'</span>: model.parameters()}], lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha)</span>
<span id="cb13-25"></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training iterations</span></span>
<span id="cb13-27">loss_hist_pytorch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb13-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(maxiter):</span>
<span id="cb13-29">  optimizer.zero_grad()                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set gradients=0 before calculating more</span></span>
<span id="cb13-30">  y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x)                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># feed-forward step</span></span>
<span id="cb13-31">  loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(y_tilde, y)             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute the loss</span></span>
<span id="cb13-32">  loss_hist_pytorch.append(loss.item())  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save loss for plotting later</span></span>
<span id="cb13-33">  loss.backward()                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute gradients via backprop</span></span>
<span id="cb13-34">  optimizer.step()                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># actually update the weights</span></span>
<span id="cb13-35"></span>
<span id="cb13-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print and plot our results</span></span>
<span id="cb13-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Y_tilde = </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, y_tilde.cpu().data.numpy() )</span>
<span id="cb13-38">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>)</span>
<span id="cb13-39">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loss"</span>)</span>
<span id="cb13-40">plt.loglog(loss_hist_pytorch)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Y_tilde = 
 [[2.9900986e-07]
 [9.9999976e-01]
 [9.9999964e-01]
 [3.4445571e-07]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-02-08-My-1st-NN-Part-3-Multi-Layer-and-Backprop_files/figure-html/cell-8-output-2.png" width="599" height="431"></p>
</div>
</div>
</section>
</section>
<section id="exercise-exploring-hidden-layers." class="level1">
<h1>Exercise: Exploring Hidden Layers.</h1>
<section id="more-with-the-7-segment-display" class="level2">
<h2 class="anchored" data-anchor-id="more-with-the-7-segment-display">More with the 7-segment display</h2>
<p>Using the <img src="https://latex.codecogs.com/png.latex?X"> and <img src="https://latex.codecogs.com/png.latex?Y"> arrays for from previous exercices with the 7-segment display, we’ll explore the effects of adding hidden neurons and different activation functions. Using the code template that follows below,…</p>
<section id="a.-explore-hidden-layer-sizes-activations" class="level3">
<h3 class="anchored" data-anchor-id="a.-explore-hidden-layer-sizes-activations">A. Explore hidden layer sizes &amp; activations</h3>
<ol type="1">
<li>Write code for a <em>new</em> activation function: <img src="https://latex.codecogs.com/png.latex?%5Ctanh(x)"> and its derivative. <strong>Note: there is already placeholder code for this in the template below</strong></li>
<li>Set training data to be that of the 7-segment display.</li>
<li>Choose (for yourself) a single learning rate (e.g.&nbsp;$=$0.5), and a standard number of iterations (e.g.&nbsp;10000).</li>
</ol>
<p>Then compare results for multiple networks (all with <del>softmax</del>sigmoid activation on the end): 1. A single hidden layer with 20 neurons and (for the hidden layer)… - sigmoid activation - relu activation - tanh activation</p>
<ol start="2" type="1">
<li>A single hidden layer with 100 neurons and (for the hidden layer)…</li>
</ol>
<ul>
<li>sigmoid activation</li>
<li>relu activation</li>
<li>tanh activation</li>
</ul>
</section>
<section id="b.-explore-multiple-hidden-layers" class="level3">
<h3 class="anchored" data-anchor-id="b.-explore-multiple-hidden-layers">B. Explore multiple hidden layers</h3>
<ol start="3" type="1">
<li>Now use two hidden layers, H and H2 with 10 neurons each, and experiment to <em>find the best combination</em> of activations, and best choice of learning rate that gives you the lowest loss at the end of your chosen number of iterations. Check that your predicted output is as you expect.</li>
</ol>
</section>
<section id="assignment" class="level3">
<h3 class="anchored" data-anchor-id="assignment">Assignment:</h3>
<p>Upload a text file of the code for your “winning” entry for #3 to Blackboard. Use the code below as a template.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## TEMPLATE CODE. Scroll down to "MAKE YOUR CHANGES BELOW", below</span></span>
<span id="cb15-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb15-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### LEAVE THIS UNCHANGED</span></span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First, let's repeat the sigmoid(), relu(), update_weights() and fit() routines</span></span>
<span id="cb15-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># already defined, so we have a'standalone' code and can easily make changes</span></span>
<span id="cb15-8"></span>
<span id="cb15-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Activation choices</span></span>
<span id="cb15-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sigmoid(x, deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>): </span>
<span id="cb15-11">  f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x))</span>
<span id="cb15-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>f) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> deriv <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> f</span>
<span id="cb15-13"></span>
<span id="cb15-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> relu(x, deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):   </span>
<span id="cb15-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> deriv <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb15-16"></span>
<span id="cb15-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backpropagation routine</span></span>
<span id="cb15-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> update_weights(weights, layers, Y, alpha, activ):</span>
<span id="cb15-19">  lmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(layers) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a useful variable</span></span>
<span id="cb15-20">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(weights)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>lmax                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure number of weights match up</span></span>
<span id="cb15-21">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(activ) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> lmax                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure we defined enough activations for the layers</span></span>
<span id="cb15-22">    </span>
<span id="cb15-23">  delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> layers[lmax] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Y                      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># error between output and target</span></span>
<span id="cb15-24">  </span>
<span id="cb15-25">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count backwards to layer zero</span></span>
<span id="cb15-26">    fprime <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activ[el](np.dot(layers[el], weights[el]), deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># deriv of activation</span></span>
<span id="cb15-27">    weights[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.dot( layers[el].T, delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>fprime )       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gradient descent step</span></span>
<span id="cb15-28">    delta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(delta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>fprime, weights[el].T) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setup delta for next pass in loop</span></span>
<span id="cb15-29"></span>
<span id="cb15-30">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> weights           </span>
<span id="cb15-31"></span>
<span id="cb15-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Routine for training via gradient descent</span></span>
<span id="cb15-33"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> fit(layers, Y, activ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[sigmoid]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, use_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, maxiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>):</span>
<span id="cb15-34">  lmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(layers)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># max index of layers, also = # of weights</span></span>
<span id="cb15-35">  </span>
<span id="cb15-36">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> use_bias:           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a column of 1's to every layer except the last</span></span>
<span id="cb15-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):</span>
<span id="cb15-38">        new_col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones((layers[el].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) </span>
<span id="cb15-39">        layers[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.hstack((new_col, layers[el])) </span>
<span id="cb15-40">  </span>
<span id="cb15-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define weights</span></span>
<span id="cb15-42">  np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for reproducibility</span></span>
<span id="cb15-43">  weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lmax            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># allocate slots in a blank list</span></span>
<span id="cb15-44">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "el" because "l" and "1" may look similar</span></span>
<span id="cb15-45">    weights[el] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.random.random((layers[el].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], layers[el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> </span>
<span id="cb15-46">            </span>
<span id="cb15-47">  loss_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start with an empty list</span></span>
<span id="cb15-48">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(maxiter):</span>
<span id="cb15-49"></span>
<span id="cb15-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feed-forward pass</span></span>
<span id="cb15-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> el <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(lmax):</span>
<span id="cb15-52">      layers[el<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> activ[el](np.dot(layers[el], weights[el]))</span>
<span id="cb15-53">    Y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> layers[lmax]</span>
<span id="cb15-54">      </span>
<span id="cb15-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loss monitoring</span></span>
<span id="cb15-56">    diff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Y</span>
<span id="cb15-57">    loss_hist.append( (diff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).mean()  )    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use MSE loss for monitoring</span></span>
<span id="cb15-58">          </span>
<span id="cb15-59">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backprop code will go here</span></span>
<span id="cb15-60">    weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_weights(weights, layers, Y, alpha, activ)</span>
<span id="cb15-61"></span>
<span id="cb15-62">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> weights, Y_tilde, loss_hist </span>
<span id="cb15-63"></span>
<span id="cb15-64"></span>
<span id="cb15-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##### </span><span class="re">END</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> OF PART TO LEAVE UNCHANGED</span></span>
<span id="cb15-66"></span>
<span id="cb15-67"></span>
<span id="cb15-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#####---------------  MAKE YOUR CHANGES BELOW ------------##############</span></span>
<span id="cb15-69"></span>
<span id="cb15-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define the tanh activation function</span></span>
<span id="cb15-71"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> tanh(x, deriv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb15-72">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> deriv:</span>
<span id="cb15-73">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># *** Students: replace 'pass' with what the derivative should be</span></span>
<span id="cb15-74">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> np.tanh(x)</span>
<span id="cb15-75"></span>
<span id="cb15-76"></span>
<span id="cb15-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Students: replace X, Y with 7-segment data instead</span></span>
<span id="cb15-78">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]],dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.float32)</span>
<span id="cb15-79">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]],dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.float32).T</span>
<span id="cb15-80"></span>
<span id="cb15-81"></span>
<span id="cb15-82">Y_tilde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.copy(Y)                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Just allocates some storage for Y_tilde</span></span>
<span id="cb15-83"></span>
<span id="cb15-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##  Hidden layers: Students: Change Q, the number of hidden neurons, as needed</span></span>
<span id="cb15-85">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb15-86">N <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this just grabs the number of rows in X</span></span>
<span id="cb15-87">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,Q))                  </span>
<span id="cb15-88">H2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((N,Q))                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># extra hidden layer, might not be used</span></span>
<span id="cb15-89"></span>
<span id="cb15-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Students: change this as instructed</span></span>
<span id="cb15-91">layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [X, H, Y_tilde]              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># later, add another layer H2 when instructed</span></span>
<span id="cb15-92">activ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sigmoid, sigmoid, sigmoid]   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the first (2) activation(s) as instructed</span></span>
<span id="cb15-93">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># play around with this</span></span>
<span id="cb15-94"></span>
<span id="cb15-95"></span>
<span id="cb15-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## LEAVE THIS PART UNCHANGED</span></span>
<span id="cb15-97">weights, Y_tilde, loss_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fit(layers, Y, activ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>activ, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>alpha)</span>
<span id="cb15-98">np.set_printoptions(formatter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'float'</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span> x: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0:0.2f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(x)}) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2 sig figs</span></span>
<span id="cb15-99"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prediction Y_tilde =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,Y_tilde.T)</span>
<span id="cb15-100"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Target Y (correct answer)  =</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,Y.T)</span>
<span id="cb15-101">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iteration"</span>)</span>
<span id="cb15-102">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loss"</span>)</span>
<span id="cb15-103">plt.loglog(loss_hist)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Prediction Y_tilde =
 [[0.01 0.99 0.99 0.01]]
Target Y (correct answer)  =
 [[0.00 1.00 1.00 0.00]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://drscotthawley.github.io/blog/posts/2019-02-08-My-1st-NN-Part-3-Multi-Layer-and-Backprop_files/figure-html/cell-9-output-2.png" width="599" height="431"></p>
</div>
</div>
</section>
</section>
<section id="preview-of-next-lesson-mnist" class="level2">
<h2 class="anchored" data-anchor-id="preview-of-next-lesson-mnist">Preview of next lesson: MNIST</h2>
<p>Now that you’ve built up some experience with reading digits, let’s move to handwritten digits! This is a problem usually solved with an architecture called a Convolutional Neural Network, but our ordinary feed-forward network can do it too.</p>
<p>The <a href="http://yann.lecun.com/exdb/mnist/">MNIST database of handwritten digits</a> is a classic dataset that every ML student works on. It consists of a large number images of handwritten digits only 28x28 pixels in size. We will “flatten” these into a row of 784 columns, and output a <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BY%7D"> of one-hot-encoded vectore just like we did for the output of the 7-segment display (same digits, 0 to 9!).</p>


</section>
</section>

 ]]></description>
  <category>foundations</category>
  <guid>https://drscotthawley.github.io/blog/posts/2019-02-08-my-1st-nn-part-3-multi-layer-and-backprop.html</guid>
  <pubDate>Fri, 08 Feb 2019 06:00:00 GMT</pubDate>
  <media:content url="https://i.imgur.com/WjaQDnW.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
