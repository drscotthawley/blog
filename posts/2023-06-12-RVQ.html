<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Scott H. Hawley">
<meta name="dcterms.date" content="2023-06-12">
<meta name="description" content="An exploration of the heart of neural audio codecs">

<title>blog - Residual Vector Quantization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.16.1.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<meta name="twitter:title" content="blog - Residual Vector Quantization">
<meta name="twitter:description" content="An exploration of the heart of neural audio codecs">
<meta name="twitter:image" content="https://drscotthawley.github.io/blog/posts/images/rvq_image.png">
<meta name="twitter:image-height" content="255">
<meta name="twitter:image-width" content="255">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/drscotthawley" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/drscotthawley" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Residual Vector Quantization</h1>
                  <div>
        <div class="description">
          An exploration of the heart of neural audio codecs
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">compression</div>
                <div class="quarto-category">ssl</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Scott H. Hawley </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 12, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#vector-quantization-partitioning-space" id="toc-vector-quantization-partitioning-space" class="nav-link" data-scroll-target="#vector-quantization-partitioning-space">Vector Quantization = Partitioning Space</a>
  <ul class="collapse">
  <li><a href="#reconstruction-error" id="toc-reconstruction-error" class="nav-link" data-scroll-target="#reconstruction-error">Reconstruction Error</a></li>
  <li><a href="#k-means-partitioning-scheme" id="toc-k-means-partitioning-scheme" class="nav-link" data-scroll-target="#k-means-partitioning-scheme">k-Means (Partitioning Scheme)</a></li>
  </ul></li>
  <li><a href="#residual-vector-quantization-rvq" id="toc-residual-vector-quantization-rvq" class="nav-link" data-scroll-target="#residual-vector-quantization-rvq">Residual Vector Quantization (RVQ)</a>
  <ul class="collapse">
  <li><a href="#basic-idea-codebooks-in-codebooks" id="toc-basic-idea-codebooks-in-codebooks" class="nav-link" data-scroll-target="#basic-idea-codebooks-in-codebooks">Basic Idea: “Codebooks in Codebooks”</a></li>
  <li><a href="#quantizer-algorithm" id="toc-quantizer-algorithm" class="nav-link" data-scroll-target="#quantizer-algorithm">Quantizer algorithm</a></li>
  <li><a href="#error-analysis-exponential-convergence" id="toc-error-analysis-exponential-convergence" class="nav-link" data-scroll-target="#error-analysis-exponential-convergence">Error Analysis: Exponential Convergence</a></li>
  </ul></li>
  <li><a href="#addendum-difficulty-at-very-high-dimensions" id="toc-addendum-difficulty-at-very-high-dimensions" class="nav-link" data-scroll-target="#addendum-difficulty-at-very-high-dimensions">Addendum: Difficulty at Very High Dimensions</a></li>
  <li><a href="#acknowledgement" id="toc-acknowledgement" class="nav-link" data-scroll-target="#acknowledgement">Acknowledgement</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>“Vector Quantization.” Sounds intimidating. “Residual Vector Quantization” sounds even more intimidating, even near-meaningless to most people. Turns out, these are easy to understand given a few pictures, even to the point a child could understand them – uh… if the child <em>wanted</em> to. Certainly, there can be sophisticated ways to implement these algorithms, and we’ll cover a bit of that later on, but the basics are very simple.</p>
<p>Residual Vector Quantization (RVQ) is a <a href="https://www.instagram.com/p/CteX0esglU-/">data compression</a> technique found in state-of-the-art neural audio codecs such as Google’s <a href="https://ai.googleblog.com/2021/08/soundstream-end-to-end-neural-audio.html">SoundStream</a>, and Facebook/Meta AI’s <a href="https://github.com/facebookresearch/encodec">Encodec</a>, which in turn form the backbone of generative audio models such as <a href="https://google-research.github.io/seanet/audiolm/examples/">AudioLM</a> (Google) and <a href="https://ai.honu.io/papers/musicgen/">MusicGen</a> (Facebook). It’s also the subject of Lucidrain’s library <a href="https://github.com/lucidrains/vector-quantize-pytorch"><code>vector-quantize-pytorch</code></a>, which we’ll use toward the end because it’s <em>so fast</em> and <em>so good</em>.</p>
<p>What is RVQ and how does it work?</p>
<p>First we should consider regular vector quantization (VQ). VQ has been around for decades, and it shows up in many areas of signal processing when compression is involved.</p>
<blockquote class="blockquote">
<p>Note: Whenever I say something that applies to both VQ and RVQ, I’ll use the abbreviation “(R)VQ.”</p>
</blockquote>
</section>
<section id="vector-quantization-partitioning-space" class="level2">
<h2 class="anchored" data-anchor-id="vector-quantization-partitioning-space">Vector Quantization = Partitioning Space</h2>
<p>“Vector Quantization” is really about dividing up the space of your data points into a discrete set of regions. Put differently, we “partition” the space.</p>
<p>Let’s say we have a bunch of points in space:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make some data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>n_points <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>DATA_MIN, DATA_MAX <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span> <span class="co"># we'll let these be globals</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">9</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> DATA_MIN <span class="op">+</span> (DATA_MAX<span class="op">-</span>DATA_MIN)<span class="op">*</span>np.random.rand(n_points, <span class="dv">2</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.set_xticks([])  # hide axis ticks</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.set_yticks([])</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-dots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-dots-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;1<strong>.</strong> A set of data points, aka ‘vectors’.</figcaption>
</figure>
</div>
</div>
</div>
<p>To computer scientists, the <span class="math inline">\((x,y)\)</span> coordinates of each point define a “vector”. (To mathematicians and physicists, the “vector” points from the origin to each point, but that distinction isn’t going to matter to us.)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Clarification
</div>
</div>
<div class="callout-body-container callout-body">
<p>For neural audio codecs, the vectors could be vertical slices (columns) from an audio spectrogram, i.e., a list of amplitudes for a set of frequencies that were found over a short time interval called a “frame.” More often, however, the vectors are <em>themselves</em> the outputs of some other audio encoder (e.g.&nbsp;a Convolutional Neural Network), and the (R)VQ is done to compress <em>those</em> encoded vectors even more in order to do things like <a href="https://github.com/CompVis/latent-diffusion">Latent Diffusion</a>.</p>
</div>
</div>
<p>Now divide up the space into a bunch of regions. How we do that can take many forms. For now, just consider the two examples of my hand drawing with colors, and a set of tiled squares. There are “fancier” algorithms to partition the space in a way that best “fits” the data (e.g., see “k-Means”, below). We can cover schemes like the third image later.</p>
<!--- ::: {layout-ncol=2 label="fig-region-options" fig-cap="Two ways of partitioning space"} -->
<div id="fig-regions2" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hand" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/dots_square_handregions.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(a) By hand</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-lilsquares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/dots_squares_basic.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(b) Squares</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-lilsquares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/vq_aalto_sm.png" class="img-fluid figure-img" data-ref-parent="fig-regions2"></p>
<figcaption class="figure-caption">(c) Fancy (credit: Aalto University, Finland)</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;2<strong>.</strong> Examples of ways to divide up or “quantize” space, aka “Partitioning schemes.”</figcaption><p></p>
</figure>
</div>
<p>Moving forward, I can do a bit more code-wise with the squares, so let’s start there. ;-)</p>
<p>Let me just formalize that a bit: We’ll let the number of squares be controlled by the variable “<code>n_grid</code>”. So for our two-dimensional examples, there will be <code>n_grid</code><span class="math inline">\(^2\)</span> square regions.</p>
<p>With vector quantization, we give an index value to every region (e.g.&nbsp;0 to 24 for a 5x5 square grid), and then we <strong><em>replace each vector’s value with the index of the region</em></strong>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_data_grid(data, n_grid<span class="op">=</span><span class="dv">5</span>, hide_tick_labels<span class="op">=</span><span class="va">True</span>, show_indices<span class="op">=</span><span class="va">False</span>, show_centroids<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                   show_next_level_grid<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"big ol' workhorse plotting routine that we'll progressively make use of as the lesson proceeds"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> n_grid</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        ax.axhline(DATA_MIN <span class="op">+</span> i<span class="op">*</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        ax.axvline(DATA_MIN <span class="op">+</span> i<span class="op">*</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_indices:</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> DATA_MIN <span class="op">+</span> (i <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">/</span> n_grid</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> DATA_MIN <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> (j <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">/</span> n_grid</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                ax.text(x, y, <span class="bu">str</span>(index), ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_centroids: </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> DATA_MIN <span class="op">+</span> (i <span class="op">+</span> <span class="fl">0.5</span>)<span class="op">*</span>h</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> DATA_MIN <span class="op">+</span> (j <span class="op">+</span> <span class="fl">0.5</span>)<span class="op">*</span>h</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                ax.plot(x, y, <span class="st">'ro'</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hide_tick_labels:</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks([])</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks([])</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        plt.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>n_grid<span class="op">=</span><span class="dv">5</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_data_grid(data, n_grid=n_grid)</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>plot_data_grid(data, n_grid<span class="op">=</span>n_grid, show_indices<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-indices" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-indices-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;3<strong>.</strong> (Integer) Indices for each region.</figcaption>
</figure>
</div>
</div>
</div>
<p>For each of the “vectors” represented by the data points, we no longer use the (<span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span>) coordinate pairs, but rather the (integer) index of the region it’s in.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ve gone from needing two floating point numbers per point to just one integer value. In two dimensions, the “savings” or data-compression amount that we get from that may not be readily apparent, but stick around: As we go to large numbers of dimensions later, this scheme will save us a <em>ton</em> of data.</p>
</div>
</div>
<p>If we want the coordinates that go with the indices, we’ll use the centroid of each region. In this sense, the vectors are “quantized” so that they can only take on values given by the centroids of the regions. In the following example, the centroids are shown in red:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plot_data_grid(data, n_grid<span class="op">=</span>n_grid, show_indices<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               show_centroids<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-centroids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-centroids-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;4<strong>.</strong> Centroid locations</figcaption>
</figure>
</div>
</div>
</div>
<p>So each blue point will effectively be replaced by the nearest red point. In this sense we have “quantized” the vectors (because we’ve quantized the space itself).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology
</div>
</div>
<div class="callout-body-container callout-body">
<p>The set of locations of centroids is called the “<strong>codebook</strong>”. When we want to use an actual vector value (in space), we convert the codebook index into a (centroid) location by looking up the codebook.</p>
</div>
</div>
<!--
For reasons of simplicity (/laziness) that will become clear later, for this blog post we'll choose coordinates where our space is centered on (0,0), and has a span of (1,1) across it. So that means the space will go from (-0.5,-0.5) to (0.5,0.5).  This choice of coordinates doesn't change the basic mechanics of (R)VQ, it just means less work to do later. -->
<p>So a full (albeit unweidly) picture showing the data points, the region indices, and the centroids, looks like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot_data_grid(data, n_grid<span class="op">=</span>n_grid, show_indices<span class="op">=</span><span class="va">True</span>, show_centroids<span class="op">=</span><span class="va">True</span>, hide_tick_labels<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-detailed-squares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-detailed-squares-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;5<strong>.</strong> Detailed figure showing data points, region indices, and centroid locations.</figcaption>
</figure>
</div>
</div>
</div>
<p>For our choice of coordinates, the codebook (i.e.&nbsp;the mapping of indices to centroid locations) looks like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_codebook(n_grid, n_dim<span class="op">=</span><span class="dv">2</span>, debug<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    n_gridpoints <span class="op">=</span> n_grid <span class="op">**</span> n_dim</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> debug: <span class="bu">print</span>(<span class="ss">f"generate_codebook: n_grid = </span><span class="sc">{</span>n_grid<span class="sc">}</span><span class="ss">, n_dim = </span><span class="sc">{</span>n_dim<span class="sc">}</span><span class="ss">, n_gridpoints = </span><span class="sc">{</span>n_gridpoints<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    centroids <span class="op">=</span> np.empty((n_gridpoints, n_dim))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (DATA_MAX <span class="op">-</span> DATA_MIN)<span class="op">/</span>n_grid</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_dim):</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        coords <span class="op">=</span> np.linspace(DATA_MIN <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, DATA_MAX <span class="op">-</span> h<span class="op">/</span><span class="dv">2</span>, n_grid)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        coords <span class="op">=</span> np.tile(coords, <span class="bu">int</span>(n_gridpoints <span class="op">/</span> n_grid <span class="op">**</span> (i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        coords <span class="op">=</span> np.repeat(coords, n_grid <span class="op">**</span> i)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        centroids[:, i] <span class="op">=</span> coords</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> centroids</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>codebook <span class="op">=</span> generate_codebook(n_grid)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># print it nicely</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>cb_str <span class="op">=</span> <span class="ss">f"| index      | vector |</span><span class="ch">\n</span><span class="ss">| ----------- | ----------- |"</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(codebook.shape[<span class="dv">0</span>]):</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    cb_str <span class="op">+=</span> <span class="ss">f"</span><span class="ch">\n</span><span class="ss">| </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> | (</span><span class="sc">{</span>codebook[i,<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss">, </span><span class="sc">{</span>codebook[i,<span class="dv">1</span>]<span class="sc">:.1f}</span><span class="ss">) |"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>display(Markdown(cb_str))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th>index</th>
<th>vector</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>(-0.4, -0.4)</td>
</tr>
<tr class="even">
<td>1</td>
<td>(-0.2, -0.4)</td>
</tr>
<tr class="odd">
<td>2</td>
<td>(0.0, -0.4)</td>
</tr>
<tr class="even">
<td>3</td>
<td>(0.2, -0.4)</td>
</tr>
<tr class="odd">
<td>4</td>
<td>(0.4, -0.4)</td>
</tr>
<tr class="even">
<td>5</td>
<td>(-0.4, -0.2)</td>
</tr>
<tr class="odd">
<td>6</td>
<td>(-0.2, -0.2)</td>
</tr>
<tr class="even">
<td>7</td>
<td>(0.0, -0.2)</td>
</tr>
<tr class="odd">
<td>8</td>
<td>(0.2, -0.2)</td>
</tr>
<tr class="even">
<td>9</td>
<td>(0.4, -0.2)</td>
</tr>
<tr class="odd">
<td>10</td>
<td>(-0.4, 0.0)</td>
</tr>
<tr class="even">
<td>11</td>
<td>(-0.2, 0.0)</td>
</tr>
<tr class="odd">
<td>12</td>
<td>(0.0, 0.0)</td>
</tr>
<tr class="even">
<td>13</td>
<td>(0.2, 0.0)</td>
</tr>
<tr class="odd">
<td>14</td>
<td>(0.4, 0.0)</td>
</tr>
<tr class="even">
<td>15</td>
<td>(-0.4, 0.2)</td>
</tr>
<tr class="odd">
<td>16</td>
<td>(-0.2, 0.2)</td>
</tr>
<tr class="even">
<td>17</td>
<td>(0.0, 0.2)</td>
</tr>
<tr class="odd">
<td>18</td>
<td>(0.2, 0.2)</td>
</tr>
<tr class="even">
<td>19</td>
<td>(0.4, 0.2)</td>
</tr>
<tr class="odd">
<td>20</td>
<td>(-0.4, 0.4)</td>
</tr>
<tr class="even">
<td>21</td>
<td>(-0.2, 0.4)</td>
</tr>
<tr class="odd">
<td>22</td>
<td>(0.0, 0.4)</td>
</tr>
<tr class="even">
<td>23</td>
<td>(0.2, 0.4)</td>
</tr>
<tr class="odd">
<td>24</td>
<td>(0.4, 0.4)</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="reconstruction-error" class="level3">
<h3 class="anchored" data-anchor-id="reconstruction-error">Reconstruction Error</h3>
<p>When we do this quantization (i.e.&nbsp;replacing vectors by their nearest centroid), the centroid locations will naturally be a bit “off” compared to the original data vectors themselves. The finer the grid you make, the smaller the regions, and the less error. For a 2D grid, the error will be on the order of <span class="math inline">\(h^2\)</span> where <span class="math inline">\(h\)</span> is the grid spacing (<span class="math inline">\(h\)</span> = 1/5 = 0.2 in our example). Let’s check how the error changes as we vary the grid spacing, i.e., as we vary <code>n_grid</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_centroids(data, codebook):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> np.<span class="bu">sum</span>((data[:, np.newaxis] <span class="op">-</span> codebook) <span class="op">**</span> <span class="dv">2</span>, axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    closest_centroids <span class="op">=</span> np.argmin(distances, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> closest_centroids <span class="co"># indices not coordinates</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_error(data, codebook):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    n_grid <span class="op">=</span> <span class="bu">int</span>(np.sqrt(codebook.shape[<span class="dv">0</span>]))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>n_grid <span class="op">*</span> (DATA_MAX <span class="op">-</span> DATA_MIN) </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    quantized_ind <span class="op">=</span> find_closest_centroids(data, codebook)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    quantized_xy <span class="op">=</span> codebook[quantized_ind]       </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    error <span class="op">=</span> np.sqrt( np.<span class="bu">sum</span>( (data <span class="op">-</span> quantized_xy)<span class="op">**</span><span class="dv">2</span> ) )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> error </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>n_points2 <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> DATA_MIN <span class="op">+</span> (DATA_MAX <span class="op">-</span> DATA_MIN)<span class="op">*</span>np.random.rand(n_points2, <span class="dv">2</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> []</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>grids <span class="op">=</span> np.array([<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">200</span>])</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_grid2 <span class="kw">in</span> grids:</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    codebook <span class="op">=</span> generate_codebook(n_grid2)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    error <span class="op">=</span> compute_error(data2, codebook)               </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    errors.append(error)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))    </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(grids, errors, <span class="st">'o-'</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].loglog(grids, errors, <span class="st">'o-'</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    ax[i].set_ylabel(<span class="st">'Error'</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    ax[i].set_xlabel(<span class="st">'n_grid'</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"lowest error (for n_grid=</span><span class="sc">{</span>grids[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">) = "</span>,errors[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-error" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-error-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;6<strong>.</strong> Plots of error vs.&nbsp;resolution with linear (left) and logarithmic (right) axes. Note that the computational cost will scale like the number of regions, which is <code>n_grid</code><span class="math inline">\(^2\)</span>.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lowest error (for n_grid=200) =  0.019903707672610238</code></pre>
</div>
</div>
<p>So, the more “gridlines” you use, the lower the error, but at what cost? To get an error of 0.02 we need <span class="math inline">\(200^2 = 400\)</span> regions. And in higher dimensions than 2, the “cost” of higher resolution / lower error goes up <em>immensely</em>: to double the resolution in <span class="math inline">\(d\)</span> dimensions, the computational cost goes up by a factor of <span class="math inline">\(2^d\)</span>. (Imagine <span class="math inline">\(d\)</span>=32, 64, 128,…)</p>
<p>But we don’t need to cover the entire space uniformly! That’s where Residual Vector Quantization comes in. Feel free to skip ahead to the section on RVQ. For the next bit we’ll take an optional aside to learn about an alternate way to partition space, known as a the “k-Means” algorithm.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Another key point: By replacing all the coordinate values for a vector (i.e.&nbsp;<span class="math inline">\(d\)</span> floating point numbers) with a <em>single integer</em>, VQ achieves data compression by a factor of <span class="math inline">\(d\)</span> (times however many bit floats take up compared to integers). For large numbers of dimensions – regardless of the partitioning scheme – this compression can be <em>significant</em>.</p>
</div>
</div>
</section>
<section id="k-means-partitioning-scheme" class="level3">
<h3 class="anchored" data-anchor-id="k-means-partitioning-scheme">k-Means (Partitioning Scheme)</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional
</div>
</div>
<div class="callout-body-container callout-body">
<p>This discussion on k-Means is actually not crucial to understanding (R)VQ. At all. It’s quite skippable, to be honest. So…only read if you’re really curious. Otherwise skip down to the section on <a href="#residual-vector-quantization-rvq">Residual Vector Quantization</a>.</p>
</div>
</div>
<p>The k-Means algorithm is another method to partition space, a method that instead of static squares, will allow our regions and centroids to “follow the data”. Often k-Means is used to <em>initialize</em> an RVQ codebook for neural codecs (e.g.&nbsp;in SoundStream, Encodec, etc), after which the rest of the neural network’s training algorithm may refine the codebooks more.</p>
<p>We’ll start with a bunch of data points shown as small dark circles below, and a set of <span class="math inline">\(k\)</span> “centroids” shown by the large colored circles. (They’re not actually “centroids” yet but we’ll get there).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lots of imports to try to get the plotly plots and animations to show!</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pio.renderers.default<span class="op">=</span><span class="st">'notebook'</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>init_notebook_mode(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ndim <span class="op">=</span> <span class="dv">2</span>  <span class="co"># easier to do in 2d at first</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>npoints <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>datak <span class="op">=</span> DATA_MIN <span class="op">+</span> (DATA_MAX<span class="op">-</span>DATA_MIN)<span class="op">*</span>np.random.rand(npoints, ndim)   <span class="co"># make up some random data points</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">5</span>        <span class="co"># k-Means parameter: number of clusters</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># start with random centroids</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> DATA_MIN <span class="op">+</span> <span class="fl">0.2</span><span class="op">+</span><span class="fl">0.6</span><span class="op">*</span>(DATA_MAX<span class="op">-</span>DATA_MIN)<span class="op">*</span>np.random.rand(k, ndim) <span class="co"># don't let the starting centroids be on the far edges of the plot</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>orig_centroids <span class="op">=</span> centroids.copy() <span class="co"># save these for later when we'll make a movie</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_kmeans(data, centroids, cluster_memb<span class="op">=</span><span class="va">None</span>): <span class="co"># we'll leave a way to color the data points</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    all_data <span class="op">=</span> np.concatenate((data,centroids))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    is_centroid <span class="op">=</span> np.array( [<span class="dv">1</span> <span class="cf">if</span> i <span class="op">&gt;=</span> npoints <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(all_data.shape[<span class="dv">0</span>])] , np.newaxis)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    sizes <span class="op">=</span> is_centroid<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    cs <span class="op">=</span> cluster_memb <span class="cf">if</span> cluster_memb <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span><span class="op">+</span>np.zeros( (data.shape[<span class="dv">0</span>],<span class="dv">1</span>) ,dtype<span class="op">=</span><span class="bu">int</span>) </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    cs <span class="op">=</span> np.append(cs, <span class="bu">range</span>(k)) <span class="co"># add the centroids</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    plot_data <span class="op">=</span> np.column_stack( (all_data, sizes, cs) )</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [<span class="st">'x'</span>,<span class="st">'y'</span>,<span class="st">'sizes'</span>,<span class="st">'cluster'</span>]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame( plot_data,  columns<span class="op">=</span>columns)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.scatter(df, x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>, color<span class="op">=</span><span class="st">'cluster'</span>, size<span class="op">=</span><span class="st">'sizes'</span>,  range_color<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>,k),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            width<span class="op">=</span><span class="dv">420</span>, height<span class="op">=</span><span class="dv">360</span>, color_continuous_scale<span class="op">=</span><span class="st">'Turbo'</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">20</span>, r<span class="op">=</span><span class="dv">20</span>, t<span class="op">=</span><span class="dv">20</span>, b<span class="op">=</span><span class="dv">20</span>),)<span class="co">#template='plotly_dark',)</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>plot_kmeans(datak, centroids)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-kmeans-init" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="50a709ff-d48c-4533-aff9-2a37a8ad8d0f" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("50a709ff-d48c-4533-aff9-2a37a8ad8d0f")) {                    Plotly.newPlot(                        "50a709ff-d48c-4533-aff9-2a37a8ad8d0f",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('50a709ff-d48c-4533-aff9-2a37a8ad8d0f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;7<strong>.</strong> Initial state of k-Means, showing data without any ‘membership’ (dark dots) and random centroid locations (large colored dots)</figcaption>
</figure>
</div>
</div>
<p>That’s our starting points. Then what we’ll do is, we’ll color each point according to which centroid it’s closest to.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yes, this can be <em>very slow</em> for lots of points in many dimensions. There is a whole field of study of how to speed up “nearest neighbors” types of algorithms. We’re going to keep it simple for this demo. Further down, the library we’ll use will actually do an “approximate k-Means” for speed.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance(p1, p2):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"euclidean distance squared. we don't need the square root b/c we're only interested in ordering by distance"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>((p1<span class="op">-</span>p2)<span class="op">**</span><span class="dv">2</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_cluster_membership(data, centroids):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    npoints <span class="op">=</span> data.shape[<span class="dv">0</span>]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    min_ds <span class="op">=</span> <span class="dv">9999</span><span class="op">*</span>np.ones(npoints)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    cluster_memb <span class="op">=</span> np.zeros(npoints, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(centroids): <span class="co"># compute distances for all points</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        ds <span class="op">=</span> distance(data, c)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        inds <span class="op">=</span> np.argwhere(ds <span class="op">&lt;</span> min_ds)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> inds.size <span class="op">&gt;</span> <span class="dv">0</span>: </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>            min_ds[inds] <span class="op">=</span> ds[inds]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>            cluster_memb[inds] <span class="op">=</span> i</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="bu">len</span>(cluster_memb)<span class="op">==</span>npoints <span class="co"># we're not including the centroids themselves here</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cluster_memb</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>cluster_memb <span class="op">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plot_kmeans(datak, centroids, cluster_memb<span class="op">=</span>cluster_memb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-kmeans-first" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="f7a4fa35-0d4e-486c-83d6-ea4df59f951e" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7a4fa35-0d4e-486c-83d6-ea4df59f951e")) {                    Plotly.newPlot(                        "f7a4fa35-0d4e-486c-83d6-ea4df59f951e",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f7a4fa35-0d4e-486c-83d6-ea4df59f951e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;8<strong>.</strong> First step in k-Means: Assign ‘membership’ of datapoints to different clusters based on which centroids (large dots) are nearest. Note that the ‘centroids’ in this graph aren’t true centroids yet. We’ll fix them in the next step after this.</figcaption>
</figure>
</div>
</div>
<p>The next step is to recalculate the centroid locations using the points that were assigned to each centroid. And these centroids are just the mean value of the points.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> move_centroids(centroids, data, cluster_memb):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ki <span class="kw">in</span> <span class="bu">range</span>(centroids.shape[<span class="dv">0</span>]):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        inds <span class="op">=</span> np.argwhere( cluster_memb <span class="op">==</span> ki)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> inds.size <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> dim <span class="kw">in</span> <span class="bu">range</span>(data.shape[<span class="op">-</span><span class="dv">1</span>]):</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                centroids[ki,dim] <span class="op">=</span> np.mean(data[inds,dim], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> centroids</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> move_centroids(centroids, datak, cluster_memb)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#print("These centroids should be fairly 'centered' in their respective groups of data.")</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plot_kmeans(datak, centroids, cluster_memb<span class="op">=</span>cluster_memb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-kmeans-centroids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="93a25cec-e82e-4ccd-b00c-4937148864f2" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("93a25cec-e82e-4ccd-b00c-4937148864f2")) {                    Plotly.newPlot(                        "93a25cec-e82e-4ccd-b00c-4937148864f2",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('93a25cec-e82e-4ccd-b00c-4937148864f2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;9<strong>.</strong> Next step in k-Means: move centroids so they are in the middle of each cluster</figcaption>
</figure>
</div>
</div>
<p>…But now, having moved the centroids, the nearest-neighbor membership of some of the points may have changed. So we recalculate those:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cluster_memb <span class="op">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plot_kmeans(datak, centroids, cluster_memb<span class="op">=</span>cluster_memb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-kmeans-re-member" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="8264910e-1bd2-4635-ac42-66651ce00780" class="plotly-graph-div" style="height:360px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8264910e-1bd2-4635-ac42-66651ce00780")) {                    Plotly.newPlot(                        "8264910e-1bd2-4635-ac42-66651ce00780",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>cluster=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,4.0,4.0,4.0,4.0,4.0],"sizemode":"area","sizeref":0.01,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":20,"l":20,"r":20,"b":20},"height":360,"width":420},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8264910e-1bd2-4635-ac42-66651ce00780');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;10<strong>.</strong> Next step in k-Means: re-assign cluster membership of point based on new cluster locations</figcaption>
</figure>
</div>
</div>
<p>…And we repeat the process until some stopping criterion is met. For example we may just set a maximum iteration number, or we may stop when the centroids stop moving, or the cluster membership stops changing, etc. For this demo, we’ll just use a maximum number of iterations.</p>
<p>So, a movie of the whole process can look like this:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> orig_centroids.copy() <span class="co"># start over</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cluster_memb <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">+</span>np.zeros( (datak.shape[<span class="dv">0</span>],<span class="dv">1</span>) ,dtype<span class="op">=</span><span class="bu">int</span>) </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>maxiter <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plot_kmeans(datak, centroids, cluster_memb<span class="op">=</span>cluster_memb)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> np.arange(<span class="dv">2</span><span class="op">*</span>maxiter,dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">'t'</span>,<span class="st">'x'</span>,<span class="st">'y'</span>,<span class="st">'sizes'</span>,<span class="st">'cluster'</span>,<span class="st">'point_number'</span>]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>total_points <span class="op">=</span> npoints <span class="op">+</span> k  <span class="co"># points + clusters</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>movie_data <span class="op">=</span> np.zeros( (<span class="bu">len</span>(ts)<span class="op">*</span>total_points, <span class="bu">len</span>(columns)) )  <span class="co"># giant data array for all data points at all times</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">0</span>] <span class="op">=</span> np.repeat(ts, total_points)          <span class="co"># t</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.concatenate( ( datak[:,<span class="dv">0</span>], centroids[:,<span class="dv">0</span>] ) ) <span class="co"># initial xs</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.concatenate( ( datak[:,<span class="dv">1</span>], centroids[:,<span class="dv">1</span>] ) ) <span class="co"># initial ys</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">1</span>] <span class="op">=</span> np.tile(xs, <span class="bu">len</span>(ts))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">2</span>] <span class="op">=</span> np.tile(ys, <span class="bu">len</span>(ts))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>sizes <span class="op">=</span> np.ones(total_points,dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>sizes[<span class="op">-</span>k:] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">3</span>] <span class="op">=</span> np.tile(sizes, <span class="bu">len</span>(ts)) <span class="co"># sizes is repeated for all times</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">+</span> np.ones(total_points,dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>cs[<span class="op">-</span>k:] <span class="op">=</span> np.arange(k, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">4</span>] <span class="op">=</span> np.tile(cs, <span class="bu">len</span>(ts))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>movie_data[:,<span class="dv">5</span>] <span class="op">=</span> np.tile(np.arange(total_points), <span class="bu">len</span>(ts))  <span class="co"># point_number is repeated for all time</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> ts:</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t<span class="op">==</span><span class="dv">0</span>: </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span> <span class="co"># leave initial data as step 0</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> t <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        cluster_memb <span class="op">=</span> calc_cluster_membership(datak, centroids)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        centroids <span class="op">=</span> move_centroids(centroids, datak, cluster_memb)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    start, end <span class="op">=</span> t<span class="op">*</span>total_points, (t<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>total_points  </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    movie_data[start:end, <span class="dv">1</span>] <span class="op">=</span> np.concatenate( (datak[:,<span class="dv">0</span>], centroids[:,<span class="dv">0</span>]) )    <span class="co"># xs</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    movie_data[start:end, <span class="dv">2</span>] <span class="op">=</span> np.concatenate( (datak[:,<span class="dv">1</span>], centroids[:,<span class="dv">1</span>]) )    <span class="co"># ys</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    movie_data[start:end, <span class="dv">4</span>] <span class="op">=</span> np.concatenate( (cluster_memb, np.arange(k, dtype<span class="op">=</span><span class="bu">int</span>)) )  <span class="co"># cluster membership</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(movie_data, columns<span class="op">=</span>columns)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co">#df['cluster'] = df['cluster'].astype(int).astype(str) # use discrete colormap</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co">#display(df)</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(df, x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>, animation_frame<span class="op">=</span><span class="st">"t"</span>, animation_group<span class="op">=</span><span class="st">"point_number"</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">"cluster"</span>, hover_name<span class="op">=</span><span class="st">"cluster"</span>, hover_data<span class="op">=</span>[<span class="st">'point_number'</span>],</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>           size<span class="op">=</span><span class="st">'sizes'</span>, width<span class="op">=</span><span class="dv">420</span>, height<span class="op">=</span><span class="dv">460</span>, range_color<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>,k), color_continuous_scale<span class="op">=</span><span class="st">'Turbo'</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>fig.update_layout( margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">20</span>, r<span class="op">=</span><span class="dv">20</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">10</span>),)<span class="co"># template='plotly_dark',)</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>fig.layout.updatemenus[<span class="dv">0</span>].buttons[<span class="dv">0</span>].args[<span class="dv">1</span>][<span class="st">"transition"</span>][<span class="st">"duration"</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># don't interpolate frames</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>display(fig)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co">#print( "Caption: In this movie, each step will either be the 'membership' step or \nthe 'centroid moving' step.")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-kmeans-movie" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="9bde66d9-76f7-4f42-9fb5-905a05044377" class="plotly-graph-div" style="height:460px; width:420px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9bde66d9-76f7-4f42-9fb5-905a05044377")) {                    Plotly.newPlot(                        "9bde66d9-76f7-4f42-9fb5-905a05044377",                        [{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=0.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"coloraxis":{"colorbar":{"title":{"text":"cluster"}},"colorscale":[[0.0,"#30123b"],[0.07142857142857142,"#4145ab"],[0.14285714285714285,"#4675ed"],[0.21428571428571427,"#39a2fc"],[0.2857142857142857,"#1bcfd4"],[0.35714285714285715,"#24eca6"],[0.42857142857142855,"#61fc6c"],[0.5,"#a4fc3b"],[0.5714285714285714,"#d1e834"],[0.6428571428571429,"#f3c63a"],[0.7142857142857143,"#fe9b2d"],[0.7857142857142857,"#f36315"],[0.8571428571428571,"#d93806"],[0.9285714285714286,"#b11901"],[1.0,"#7a0402"]],"cmin":-1,"cmax":5},"legend":{"tracegroupgap":0,"itemsizing":"constant"},"margin":{"t":30,"l":20,"r":20,"b":10},"height":460,"width":420,"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":500,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"&#9654;","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"&#9724;","method":"animate"}],"direction":"left","pad":{"r":10,"t":70},"showactive":false,"type":"buttons","x":0.1,"xanchor":"right","y":0,"yanchor":"top"}],"sliders":[{"active":0,"currentvalue":{"prefix":"t="},"len":0.9,"pad":{"b":10,"t":60},"steps":[{"args":[["0.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"0.0","method":"animate"},{"args":[["1.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"1.0","method":"animate"},{"args":[["2.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"2.0","method":"animate"},{"args":[["3.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"3.0","method":"animate"},{"args":[["4.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"4.0","method":"animate"},{"args":[["5.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"5.0","method":"animate"},{"args":[["6.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"6.0","method":"animate"},{"args":[["7.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"7.0","method":"animate"},{"args":[["8.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"8.0","method":"animate"},{"args":[["9.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"9.0","method":"animate"},{"args":[["10.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"10.0","method":"animate"},{"args":[["11.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"11.0","method":"animate"},{"args":[["12.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"12.0","method":"animate"},{"args":[["13.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"13.0","method":"animate"},{"args":[["14.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"14.0","method":"animate"},{"args":[["15.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"15.0","method":"animate"},{"args":[["16.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"16.0","method":"animate"},{"args":[["17.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"17.0","method":"animate"},{"args":[["18.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"18.0","method":"animate"},{"args":[["19.0"],{"frame":{"duration":0,"redraw":false},"mode":"immediate","fromcurrent":true,"transition":{"duration":0,"easing":"linear"}}],"label":"19.0","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}]},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('9bde66d9-76f7-4f42-9fb5-905a05044377', [{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=0.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],"name":"0.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=1.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.27010567154824777,0.24936380985976475,-0.06599537151525225,0.06258628975198394,0.2557088560238722],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,0.03399191291709386,0.08493972536780253,-0.008405599741854175,0.029728752905137545,0.2512400613801637],"yaxis":"y","type":"scatter"}],"name":"1.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=2.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,0.0,0.0,4.0,2.0,4.0,2.0,2.0,0.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,0.0,2.0,3.0,0.0,0.0,2.0,2.0,0.0,4.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,2.0,0.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,4.0,2.0,4.0,0.0,2.0,2.0,0.0,4.0,2.0,4.0,2.0,0.0,0.0,4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],"name":"2.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=3.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.33337184932309877,0.31842757998135235,-0.28471960216232106,0.12302087724949157,0.20767537610566272],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.1494272698333899,0.12290934768551114,-0.051744581118816156,-0.06021105843884659,0.36500730525449193],"yaxis":"y","type":"scatter"}],"name":"3.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=4.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,2.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,3.0,1.0,0.0,2.0,2.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,3.0,2.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,3.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,2.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.37790772772452336,-0.33812634921340606,0.09255627098174209,0.1259974971497314],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.1380965785002598,-0.024751908905440143,-0.22727838184694918,0.37884272277850634],"yaxis":"y","type":"scatter"}],"name":"4.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=5.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.37790772772452336,-0.33812634921340606,0.09255627098174209,0.1259974971497314],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.1380965785002598,-0.024751908905440143,-0.22727838184694918,0.37884272277850634],"yaxis":"y","type":"scatter"}],"name":"5.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=6.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,2.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,4.0,2.0,2.0,2.0,1.0,3.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,3.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,2.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,2.0,2.0,1.0,4.0,3.0,4.0,3.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,4.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.3497949357807991,-0.3539094544831096,0.02884248681410691,0.09700668269262519],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.13925940815269164,0.0030571989598238095,-0.3163771112817965,0.3703369700893865],"yaxis":"y","type":"scatter"}],"name":"6.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=7.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.32760096808686734,0.3497949357807991,-0.3539094544831096,0.02884248681410691,0.09700668269262519],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24481498050252914,0.13925940815269164,0.0030571989598238095,-0.3163771112817965,0.3703369700893865],"yaxis":"y","type":"scatter"}],"name":"7.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=8.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,2.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,2.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,2.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,2.0,2.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,3.0,4.0,0.0,2.0,3.0,0.0,2.0,2.0,4.0,3.0,4.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.29199323982610076,0.35508338160817193,-0.35330868071671834,-0.09762130360884347,0.06228952743295979],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22572669719391558,0.17351315292739797,0.047291133986268115,-0.37207286235092224,0.36528374699986227],"yaxis":"y","type":"scatter"}],"name":"8.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=9.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.29199323982610076,0.35508338160817193,-0.35330868071671834,-0.09762130360884347,0.06228952743295979],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22572669719391558,0.17351315292739797,0.047291133986268115,-0.37207286235092224,0.36528374699986227],"yaxis":"y","type":"scatter"}],"name":"9.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=10.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,2.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,3.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,2.0,1.0,4.0,2.0,4.0,3.0,0.0,0.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,3.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,2.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.26524154315575504,0.3480235334717306,-0.3457471560130612,-0.19973888565877868,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22274322741347125,0.17931696919891849,0.10663698544949418,-0.38551496105113114,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"10.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=11.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.26524154315575504,0.3480235334717306,-0.3457471560130612,-0.19973888565877868,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.22274322741347125,0.17931696919891849,0.10663698544949418,-0.38551496105113114,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"11.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=12.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,2.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,4.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,3.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,3.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,2.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.2301082297401732,0.3480235334717306,-0.33693649639793505,-0.2820402770712598,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24305459697418308,0.17931696919891849,0.15067799818347158,-0.3602971867710162,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"12.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=13.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.2301082297401732,0.3480235334717306,-0.33693649639793505,-0.2820402770712598,0.05149100019197794],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.24305459697418308,0.17931696919891849,0.15067799818347158,-0.3602971867710162,0.3711028543409008],"yaxis":"y","type":"scatter"}],"name":"13.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=14.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,2.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,3.0,0.0,4.0,2.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.21224142667856824,0.3480235334717306,-0.3242971106696142,-0.3347551766744631,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2684592041594238,0.17931696919891849,0.18082101355704377,-0.3282365117203218,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"14.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=15.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.21224142667856824,0.3480235334717306,-0.3242971106696142,-0.3347551766744631,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2684592041594238,0.17931696919891849,0.18082101355704377,-0.3282365117203218,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"15.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=16.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,2.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.31871472118813665,-0.35647597286232025,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.20032021408628328,-0.2991871031761379,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"16.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=17.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.31871472118813665,-0.35647597286232025,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.20032021408628328,-0.2991871031761379,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"17.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=18.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,4.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.3157124414868205,-0.3583077010695947,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.21002893285206703,-0.28795616547831776,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"18.0"},{"data":[{"customdata":[[0.0],[1.0],[2.0],[3.0],[4.0],[5.0],[6.0],[7.0],[8.0],[9.0],[10.0],[11.0],[12.0],[13.0],[14.0],[15.0],[16.0],[17.0],[18.0],[19.0],[20.0],[21.0],[22.0],[23.0],[24.0],[25.0],[26.0],[27.0],[28.0],[29.0],[30.0],[31.0],[32.0],[33.0],[34.0],[35.0],[36.0],[37.0],[38.0],[39.0],[40.0],[41.0],[42.0],[43.0],[44.0],[45.0],[46.0],[47.0],[48.0],[49.0],[50.0],[51.0],[52.0],[53.0],[54.0],[55.0],[56.0],[57.0],[58.0],[59.0],[60.0],[61.0],[62.0],[63.0],[64.0],[65.0],[66.0],[67.0],[68.0],[69.0],[70.0],[71.0],[72.0],[73.0],[74.0],[75.0],[76.0],[77.0],[78.0],[79.0],[80.0],[81.0],[82.0],[83.0],[84.0],[85.0],[86.0],[87.0],[88.0],[89.0],[90.0],[91.0],[92.0],[93.0],[94.0],[95.0],[96.0],[97.0],[98.0],[99.0],[100.0],[101.0],[102.0],[103.0],[104.0]],"hovertemplate":"<b>%{hovertext}</b><br><br>t=19.0<br>x=%{x}<br>y=%{y}<br>sizes=%{marker.size}<br>point_number=%{customdata[0]}<br>cluster=%{marker.color}<extra></extra>","hovertext":[4.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"ids":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,21.0,22.0,23.0,24.0,25.0,26.0,27.0,28.0,29.0,30.0,31.0,32.0,33.0,34.0,35.0,36.0,37.0,38.0,39.0,40.0,41.0,42.0,43.0,44.0,45.0,46.0,47.0,48.0,49.0,50.0,51.0,52.0,53.0,54.0,55.0,56.0,57.0,58.0,59.0,60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,68.0,69.0,70.0,71.0,72.0,73.0,74.0,75.0,76.0,77.0,78.0,79.0,80.0,81.0,82.0,83.0,84.0,85.0,86.0,87.0,88.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,100.0,101.0,102.0,103.0,104.0],"legendgroup":"","marker":{"color":[4.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,3.0,4.0,2.0,1.0,3.0,2.0,3.0,1.0,0.0,4.0,2.0,1.0,2.0,3.0,0.0,3.0,2.0,3.0,0.0,0.0,4.0,3.0,0.0,2.0,1.0,1.0,0.0,2.0,3.0,0.0,1.0,1.0,0.0,2.0,4.0,1.0,2.0,2.0,3.0,1.0,2.0,2.0,0.0,1.0,2.0,4.0,3.0,1.0,2.0,4.0,0.0,3.0,3.0,1.0,4.0,3.0,4.0,0.0,0.0,0.0,1.0,0.0,3.0,3.0,2.0,0.0,2.0,0.0,2.0,2.0,1.0,2.0,4.0,3.0,2.0,1.0,4.0,0.0,4.0,0.0,3.0,0.0,0.0,2.0,2.0,4.0,3.0,1.0,1.0,3.0,4.0,0.0,1.0,2.0,3.0,4.0],"coloraxis":"coloraxis","size":[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0],"sizemode":"area","sizeref":0.0075,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-0.082977995297426,-0.4998856251826551,-0.35324410918288696,-0.3137397886223291,-0.10323252576933006,-0.0808054855967052,-0.29554775026848257,-0.47261240680207384,-0.08269519763287303,-0.35961306140476623,0.30074456867553667,-0.18657582184075716,0.3763891522960383,-0.4149557886302221,-0.3301695804354311,-0.4016531661669499,0.45788953015050193,0.19187711395047335,0.18650092768158366,-0.4817117226558082,0.4888610889064947,-0.21955600793559482,-0.396773993422358,0.40859550309309556,-0.21222466141365126,-0.4806330421297029,-0.28837188399994096,-0.00842684071966171,0.07411760549201307,0.08930553690328424,-0.39766557117217416,0.1944001577277451,-0.45004654105391284,0.16379464521978881,0.44459475599081333,0.4034019152878835,-0.36072365274924145,-0.10232316301446642,0.4275085803960339,0.25081210313615554,0.38330609120580983,0.2509424340273372,-0.23007210823497393,-0.07190881012870509,0.16344149781844808,-0.3852540270466248,-0.050087866520059476,-0.09186319723871883,0.4033795205622538,-0.49712967296884103,-0.17335509822790385,0.3859420993107745,0.4085351509197992,-0.4841787571534437,0.19089691751692395,-0.32765949165467145,0.43259546303716356,-0.4339998272779375,0.2538761884612464,0.21152475862847175,-0.4801198661602044,-0.4716935119792054,0.360027948682888,0.05282197868576588,-0.37582668488008886,0.08575927145828788,0.06103021925570995,0.30063267268061633,0.30710519561877914,0.36354185455942867,0.056240233990418886,-0.44008231048778834,-0.4554481214552383,-0.2742906613921453,0.05971698205414244,-0.4280257203105132,0.06810046191994212,-0.24767425542967658,-0.3045705188906812,0.47001998908831233,-0.26015224085241384,0.11995571838137975,-0.34320860535391573,-0.42997785628077767,0.10632946165333035,-0.18263759067783925,0.07974521924579692,0.05094821911789682,0.1692328934531846,-0.43366516557155843,0.12971750702156448,0.25275555373881387,-0.23968490142145904,-0.30656571737667226,0.02467030912373369,-0.23670322951288902,0.23506596328866947,0.40781585250352403,-0.486048427024403,0.11677835700165762,0.20120801330865676,0.3480235334717306,-0.3157124414868205,-0.3583077010695947,0.07026187408710806],"xaxis":"x","y":[0.2203244934421581,-0.19766742736816023,-0.4076614052312022,-0.15443927295695226,0.038816734003356945,0.1852195003967595,0.3781174363909454,0.17046751017840223,0.05868982844575166,-0.3018985109151212,0.4682615757193975,0.19232261566931408,0.3946066635038473,-0.46094521676711764,0.37814250342941313,-0.07889237499494783,0.03316528497301707,-0.18448436899393705,0.3346256718973729,0.25014431494496747,0.2481656543798394,0.2892793284514885,-0.052106473824094834,-0.2063858516263205,-0.3699714278817223,0.17883553293989096,-0.2344533406277738,-0.4466374548829196,-0.35327142509418985,0.19975836002093117,-0.08594401218043168,-0.08582073047309735,0.035896405915511576,0.014889112058308562,0.08655504050199292,-0.3625252958537625,0.3073912887095238,-0.3346458028830672,-0.15223414025449344,0.22599798535045146,0.12367220705560888,-0.15110165802215747,0.39588621819606684,0.46484004714838556,0.12169572020912178,0.44948925870707124,0.07838961438713177,-0.2629730197569723,0.07367948667228585,0.11714491362072388,0.027058102257609296,-0.14273023999750023,0.12336011579180273,0.4294372337437613,0.4973228504514805,-0.36286425037112224,0.19681816148990017,0.2554630526024664,0.42302453554648334,-0.3757290380278353,-0.4737890131222807,-0.2537889323969541,0.03883106434165284,0.3420308923596057,-0.2208163209888605,0.46959574831967454,-0.481352710627057,-0.26702572615897957,-0.11213935593582824,0.24712164273718462,-0.363544774339315,-0.37865654425926265,-0.3925058708939071,0.21298898038267666,-0.48744401984088415,0.467276330000272,-0.2967067653390095,0.24382585407509294,0.08135892727325778,0.34682880149003525,-0.006230285731270047,0.32898089955017873,-0.4814237978225905,-0.01365488906296819,0.06885143708648134,0.4886161544124489,-0.1198588273764496,0.2453344309065021,-0.2350804423371906,-0.1299158020858937,-0.2898259900851604,-0.43346351864588506,0.3047545637433454,0.13946088087994013,0.4248079703993507,-0.4340389093159762,0.27217802954324677,0.4319720691968373,-0.2656379138785795,0.44901632068761643,-0.2773681166955987,0.17931696919891849,0.21002893285206703,-0.28795616547831776,0.3694506300838897],"yaxis":"y","type":"scatter"}],"name":"19.0"}]);
                        }).then(function(){
                            
var gd = document.getElementById('9bde66d9-76f7-4f42-9fb5-905a05044377');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;11<strong>.</strong> (Interactive) In this movie, each time step is either the ‘cluster membership’ step or the ‘centroid moving’ step.</figcaption>
</figure>
</div>
</div>
<p>For those who are interested, I’ll put the code for a working k-Means algorithm below – it’s short!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kmeans(data, k<span class="op">=</span><span class="dv">5</span>, n_iter<span class="op">=</span><span class="dv">8</span>):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    n_dim, data_min, data_max <span class="op">=</span> data.shape[<span class="op">-</span><span class="dv">1</span>], np.<span class="bu">min</span>(data), np.<span class="bu">max</span>(data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    centroids <span class="op">=</span> data_min <span class="op">+</span> <span class="fl">0.2</span><span class="op">+</span><span class="fl">0.6</span><span class="op">*</span>(data_max<span class="op">-</span>data_min)<span class="op">*</span>np.random.rand(k, n_dim) <span class="co"># random init</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> it <span class="kw">in</span> <span class="bu">range</span>(n_iter):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        cluster_memb <span class="op">=</span> calc_cluster_membership(data, centroids)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        centroids <span class="op">=</span> move_centroids(centroids, data, cluster_memb)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> centroids, cluster_memb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The end result of k-Means, since it is a kind of “nearest neighbors” algorithm, is set of vectors grouped according to a “<a href="https://mathworld.wolfram.com/VoronoiDiagram.html">Vornonoi diagram</a>” like the one shown near the beginning of this post, which we’ll show again for good measure:</p>
<div id="fig-regions-kmeans" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/vq_aalto_sm.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;12<strong>.</strong> Space partitioning that can result from k-Means. (Credit: <a href="https://speechprocessingbook.aalto.fi/Modelling/Vector_quantization_VQ.html">Aalto University, Finland</a>)</figcaption>
</figure>
</div>
</section>
</section>
<section id="residual-vector-quantization-rvq" class="level2">
<h2 class="anchored" data-anchor-id="residual-vector-quantization-rvq">Residual Vector Quantization (RVQ)</h2>
<div class="{callout-note}">
<p>By the way, RVQ has been around for <a href="https://ieeexplore.ieee.org/abstract/document/480761">quite a while</a>.</p>
</div>
<section id="basic-idea-codebooks-in-codebooks" class="level3">
<h3 class="anchored" data-anchor-id="basic-idea-codebooks-in-codebooks">Basic Idea: “Codebooks in Codebooks”</h3>
<p>The trick with RVQ is, rather than having a single high-resolution codebook, to instead have “codebooks inside of codebooks”, or, if you like, “stacking codebooks”. Let’s say we want to quintuple the resolution of our initial 5x5 grid. Instead of using a 25x25 grid (which would be 25x the computational cost of the original), what if we put a little 5x5 grid “inside” the region to which a vector was quantized?</p>
<p>For example, in the “middle” region (region 12), we can do…</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> collections  <span class="im">as</span> mc</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_region_membership(data:np.array, h<span class="op">=</span><span class="fl">0.2</span>, codebook<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Tells which region each point is in. </span><span class="al">TBD</span><span class="co">: this is slow but it works! ;-) "</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    memb <span class="op">=</span> np.zeros(data.shape[<span class="dv">0</span>], dtype<span class="op">=</span>np.int32)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> codebook <span class="kw">is</span> <span class="va">None</span>:  <span class="co"># just assume basic squares</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> di, p <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>            i <span class="op">=</span> (p[<span class="dv">0</span>]<span class="op">-</span>DATA_MIN) <span class="op">//</span> h</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> (p[<span class="dv">1</span>]<span class="op">-</span>DATA_MIN) <span class="op">//</span> h</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>            ind <span class="op">=</span> i <span class="op">+</span> j<span class="op">*</span>n_grid</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>            memb[di] <span class="op">=</span> ind</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        memb <span class="op">=</span> calc_cluster_membership(data, codebook)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> memb</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_data_grid_with_resids(data, n_grid<span class="op">=</span><span class="dv">5</span>, hide_tick_labels<span class="op">=</span><span class="va">True</span>, show_indices<span class="op">=</span><span class="va">False</span>, show_centroids<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                   show_next_level_grid<span class="op">=</span><span class="va">False</span>, show_resids<span class="op">=</span><span class="va">True</span>, codebook<span class="op">=</span><span class="va">None</span>, show_grid<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"big ol' workhorse plotting routine that we'll progressively make use of as the lesson proceeds"</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> n_grid</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(DATA_MIN, DATA_MAX)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(DATA_MIN, DATA_MAX)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_grid:</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid <span class="op">+</span> <span class="dv">1</span>):  </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>            ax.axhline(DATA_MIN <span class="op">+</span> i<span class="op">*</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>            ax.axvline(DATA_MIN <span class="op">+</span> i<span class="op">*</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_next_level_grid: <span class="co"># draws lines in the middle</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        x_start <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>h</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        y_start <span class="op">=</span> <span class="op">-</span>h<span class="op">/</span><span class="dv">2</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid): <span class="co"># horizontal lines</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> y_start <span class="op">+</span> i<span class="op">*</span>h<span class="op">/</span>n_grid</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>            ax.axhline(y, xmin<span class="op">=</span>x_start, xmax<span class="op">=</span>x_start<span class="op">+</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        y_start, x_start <span class="op">=</span> x_start, y_start</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_grid): <span class="co"># horizontal lines</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> x_start <span class="op">+</span> j<span class="op">*</span>h<span class="op">/</span>n_grid</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>            ax.axvline(x, ymin<span class="op">=</span>y_start, ymax<span class="op">=</span>y_start<span class="op">+</span>h, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_indices:</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> DATA_MIN <span class="op">+</span> (i <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">/</span> n_grid</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> DATA_MIN <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> (j <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">/</span> n_grid</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>                ax.text(x, y, <span class="bu">str</span>(index), ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>                index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_centroids: </span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_grid):</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> DATA_MIN <span class="op">+</span> (i <span class="op">+</span> <span class="fl">0.5</span>)<span class="op">*</span>h</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> DATA_MIN <span class="op">+</span> (j <span class="op">+</span> <span class="fl">0.5</span>)<span class="op">*</span>h</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>                ax.plot(x, y, <span class="st">'ro'</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_resids <span class="kw">and</span> codebook <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>        memb <span class="op">=</span> get_region_membership(data, codebook<span class="op">=</span>codebook)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>        resids <span class="op">=</span> data<span class="op">*</span><span class="dv">0</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> []</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, p <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>            <span class="co">#resids[i] = p - codebook[memb[i]] # don't actually need to compute resids for this</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>            lines.append([p, codebook[memb[i]] ] )</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>        lc <span class="op">=</span> mc.LineCollection(lines, colors<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>        ax.add_collection(lc)</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hide_tick_labels:</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks([])</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks([])</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>        plt.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>n_grid<span class="op">=</span><span class="dv">5</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>codebook <span class="op">=</span> generate_codebook(n_grid)</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>plot_data_grid_with_resids(data, n_grid<span class="op">=</span>n_grid, show_next_level_grid<span class="op">=</span><span class="va">True</span>, show_centroids<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>                           hide_tick_labels<span class="op">=</span><span class="va">False</span>, codebook<span class="op">=</span>codebook, show_resids<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-basic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-rvq-basic-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;13<strong>.</strong> Illustration of ‘codebook within a codebook’, with a smaller 5x5 codebook which will be relative to the middle region’s codebook.</figcaption>
</figure>
</div>
</div>
</div>
<p>The difference between that blue point in the middle “main” square and its corresponding red centroid will be the “residual”. We will also quantize that within the “little” 5x5 grid. This will serve as a codebook to use “after” the original codebook. And we’ll get the same resolution as if we had a 25x25 grid, except our computational cost will instead be 2*(5*5)=50 instead of 25*25=625! So our cost will be 12.5 smaller than the full-grid approach.</p>
<p>And interestingly, if we only consider the <em>residual</em>, i.e.&nbsp;the difference between the main centroid and the vector in question, then we can use the same “next level” codebook for <em>all</em> points in the space! In the following figure, we show the residuals as purple line segments that run from each point to its corresponding nearest centroid:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plot_data_grid_with_resids(data, n_grid<span class="op">=</span>n_grid, show_next_level_grid<span class="op">=</span><span class="va">True</span>, show_centroids<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                           hide_tick_labels<span class="op">=</span><span class="va">True</span>, codebook<span class="op">=</span>codebook, show_resids<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-resids" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-rvq-resids-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;14<strong>.</strong> Illustration of redisuals, shown as purple line segments connecting vectors (blue points) with their nearest centroids (red points).</figcaption>
</figure>
</div>
</div>
</div>
<p>Also, because we cleverly set up our data to be centered around the origin <span class="math inline">\((0,0)\)</span>, we can treat the original data points as “residuals” relative to the “centroid” of the whole domain, namely the origin!</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot_data_grid_with_resids(data, n_grid<span class="op">=</span>n_grid, show_next_level_grid<span class="op">=</span><span class="va">False</span>, show_centroids<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                           hide_tick_labels<span class="op">=</span><span class="va">False</span>, codebook<span class="op">=</span>np.zeros((data.shape[<span class="dv">0</span>],<span class="dv">2</span>)), show_resids<span class="op">=</span><span class="va">True</span>, show_grid<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-zero" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-rvq-zero-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;15<strong>.</strong> How we can treat the data points themselves as residuals relative to the origin, for a ‘level 0’ codebook</figcaption>
</figure>
</div>
</div>
</div>
<p>Also because of our clever choice of coordinates, for the next “level” of quantization, we can take the codebook at the next level to be just the previous codebook divided by <code>n_grid</code>! This won’t always be the case; I’m just feeling clever and lazy.</p>
</section>
<section id="quantizer-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="quantizer-algorithm">Quantizer algorithm</h3>
<p>Up til now, we’ve hidden the code by default. But to really get the RVQ method, I’m going to show the code.</p>
<p>Let’s write a general quantizer multiple “levels” of nested codebooks. It will take our data points and return the various levels of codebook indices.</p>
<p>Will be following “Algorithm 1” from page 4 of Google’s 2021 paper “<a href="https://arxiv.org/abs/2107.03312">SoundStream: An End-to-End Neural Audio Codec</a>”:</p>
<div id="fig-soundstream-alg1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/soundstream_alg1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;16<strong>.</strong> SoundStream’s RVQ Algorithm</figcaption>
</figure>
</div>
<p>But I like the way I write it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quantizer(data, codebooks, n_grid<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"this will spit out indices for residuals in a series of 'nested' codebooks"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    resids <span class="op">=</span> data </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> []</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cb <span class="kw">in</span> codebooks:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        indices_l <span class="op">=</span> get_region_membership(resids, codebook<span class="op">=</span>cb)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        resids <span class="op">=</span> resids <span class="op">-</span> cb[indices_l]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        indices.append(indices_l)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(indices)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the nested codebooks</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>n_codebooks <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>codebook <span class="op">=</span> generate_codebook(n_grid)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>codebooks <span class="op">=</span> [codebook<span class="op">/</span>n_grid<span class="op">**</span>level <span class="cf">for</span> level <span class="kw">in</span> <span class="bu">range</span>(n_codebooks)]</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> quantizer(data, codebooks)   <span class="co"># call the quantizer</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>display(indices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[10,  2,  5,  7,  5, 20,  4, 13, 19, 17, 16, 14, 24,  4, 22, 23,
         4, 21, 19, 11, 13, 12,  4, 18,  4],
       [10, 17,  3,  5, 17,  9,  3, 22,  7, 13, 14,  5,  3, 24, 18,  6,
        24,  6, 17,  8, 10,  1, 21, 12,  3],
       [11,  6, 12,  7, 15, 20, 23,  7, 17, 13,  8, 18,  2,  7, 15, 11,
        16, 20, 23, 13, 11, 24, 18, 10, 20]])</code></pre>
</div>
</div>
<p>Let’s test this by trying to reconstruct our original data using each level of codebook. In the following, the original data will be in blue, and the other colors will show the results of quantization using an increasing number of codebooks:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> n_codebooks</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fig, ax_all <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span>K, figsize<span class="op">=</span>(<span class="dv">10</span><span class="op">+</span>(K<span class="op">-</span><span class="dv">3</span>),<span class="dv">3</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>recon <span class="op">=</span> data<span class="op">*</span><span class="dv">0</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> axi <span class="kw">in</span> <span class="bu">range</span>(K):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> ax_all[axi]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ax.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    recon <span class="op">+=</span> codebooks[axi][indices[axi]]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    ax.scatter(recon[:, <span class="dv">0</span>], recon[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    hpos <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>K<span class="op">*</span><span class="fl">0.85</span> <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>K<span class="op">*</span><span class="fl">0.81</span><span class="op">*</span>axi <span class="cf">if</span> K<span class="op">==</span><span class="dv">4</span> <span class="cf">else</span> <span class="fl">.25</span> <span class="op">+</span> <span class="fl">.27</span><span class="op">*</span>axi</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    fig.text(hpos, <span class="fl">.05</span>, <span class="ss">f"</span><span class="sc">{</span>axi<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> codebook</span><span class="sc">{</span><span class="st">'s'</span> <span class="cf">if</span> axi<span class="op">&gt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="st">''</span><span class="sc">}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    error <span class="op">=</span> ((recon <span class="op">-</span> data)<span class="op">**</span><span class="dv">2</span>).mean()</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    fig.text(hpos, <span class="fl">.0001</span>, <span class="ss">f"Error = </span><span class="sc">{</span>error<span class="sc">:.2e}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rvq-recon" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-rvq-recon-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;17<strong>.</strong> Reconstructing data (blue points) using multiple levels of RVQ codebooks (orange dots)</figcaption>
</figure>
</div>
</div>
</div>
<p>We see that the more (levels of) codebooks we use, the better we can approximate the original data. The rightmost image has an effective resolution of <span class="math inline">\(5^3 = 125\)</span> little squares, but instead uses only <span class="math inline">\(5x5x3 = 75\)</span>. In two dimensions, this is not a huge savings, but let’s see how important this is for higher numbers of dimensions.</p>
<p>Let <span class="math inline">\(d\)</span> be the number of dimensions and <span class="math inline">\(K\)</span> be the number of codebooks (no relation to the k from k-Means, I’m afraid). We’ll populate a d-dimensional hypercube with a lot of data, and subdivide it into nested groups of little hypercubes using RVQ, and compute the error – as well as the compuational cost “savings” from if we had used regular VQ instead of RVQ.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using uniform square/(hyper)cube regions is a <em>really dumb</em> idea for this. Because the number of regions will scale like <code>n_grid</code><span class="math inline">\(^d\)</span>, which can actually be <em>much</em> larger than the number of data vectors we have! We’ll try a more sophisticated partitioning scheme further below.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### label: fig-rvq-recon-highdim2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#### fig-cap: "Error for high-dimensional datasets using various levels of RVQ. 'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution) vs RVQ"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>d_choices <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>]  <span class="co"># we can't go much higher with 5x5 uniform grids!</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>K_choices <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]     <span class="co"># variable numbers of codebooks</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>npoints_hd <span class="op">=</span> <span class="dv">1000</span>  <span class="co"># points in high-dim spaces</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Here we show the error for high-dimensional datasets using various levels of RVQ."</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution)</span><span class="ch">\n</span><span class="st">vs RVQ."</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> d_choices:</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">d = </span><span class="sc">{</span>d<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">1</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    data_hd <span class="op">=</span> DATA_MIN <span class="op">+</span> (DATA_MAX<span class="op">-</span>DATA_MIN)<span class="op">*</span>np.random.rand(npoints_hd, d)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    codebook0 <span class="op">=</span> generate_codebook(n_grid, n_dim<span class="op">=</span>d)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    codebooks <span class="op">=</span> [codebook0<span class="op">/</span>n_grid<span class="op">**</span>level <span class="cf">for</span> level <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">max</span>(K_choices))] <span class="co"># lets get this over with rather than in the loop</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> K <span class="kw">in</span> K_choices: </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        indices <span class="op">=</span> quantizer(data_hd, codebooks)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        recon <span class="op">=</span> data_hd<span class="op">*</span><span class="dv">0</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> lil_k <span class="kw">in</span> <span class="bu">range</span>(K):   <span class="co"># reconstruct using all codebooks</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>            recon <span class="op">+=</span> codebooks[lil_k][indices[lil_k]]</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> ((recon <span class="op">-</span> data_hd)<span class="op">**</span><span class="dv">2</span>).mean()</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        grid_0_points <span class="op">=</span> n_grid<span class="op">**</span>(d)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        rvq_points <span class="op">=</span> grid_0_points<span class="op">*</span>K </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        uni_res <span class="op">=</span> grid_0_points<span class="op">**</span>K <span class="co"># comparable uniform resolution</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        savings <span class="op">=</span> uni_res<span class="op">/</span>rvq_points</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  K = </span><span class="sc">{</span>K<span class="sc">}</span><span class="ss">, error = </span><span class="sc">{</span>error<span class="sc">:.2e}</span><span class="ss">, cost savings factor = </span><span class="sc">{</span>savings<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Here we show the error for high-dimensional datasets using various levels of RVQ.
'cost savings factor' refers to the ratio of using regular VQ (at uniform resolution)
vs RVQ.

d = 2:
  K = 1, error = 3.41e-03, cost savings factor = 1.0
  K = 2, error = 1.29e-04, cost savings factor = 12.5
  K = 3, error = 5.26e-06, cost savings factor = 208.3
  K = 4, error = 2.16e-07, cost savings factor = 3906.2

d = 3:
  K = 1, error = 3.37e-03, cost savings factor = 1.0
  K = 2, error = 1.29e-04, cost savings factor = 62.5
  K = 3, error = 5.31e-06, cost savings factor = 5208.3
  K = 4, error = 2.18e-07, cost savings factor = 488281.2

d = 4:
  K = 1, error = 3.36e-03, cost savings factor = 1.0
  K = 2, error = 1.32e-04, cost savings factor = 312.5
  K = 3, error = 5.34e-06, cost savings factor = 130208.3
  K = 4, error = 2.16e-07, cost savings factor = 61035156.2

d = 6:
  K = 1, error = 3.37e-03, cost savings factor = 1.0
  K = 2, error = 1.33e-04, cost savings factor = 7812.5
  K = 3, error = 5.35e-06, cost savings factor = 81380208.3
  K = 4, error = 2.16e-07, cost savings factor = 953674316406.2</code></pre>
</div>
</div>
<p>Those “cost savings factors” were artifically high though, because we’re still using squares/hypercubes for our regions, and we don’t need to shape them that way and we don’t need <em>that many</em> of them. The great thing about (R)VQ is that you can specify how many centroids you want – i.e.&nbsp;how “long” you want your codebook to be – and you can keep that to some manageable number even as the number of dimensions skyrockets.</p>
<p>So, to tackle higher dimensions, we need to stop using uniform squares so we can have a codebook “length” of less than a few thousand centroids (instead of what just had, which was going into the hundreds of thousands, e.g.&nbsp;<span class="math inline">\(5^8 = 390625\)</span>). To get our non-uniform regions that follow the data, we’ll use the k-Means method described above.</p>
<p>Let’s look at how the reconstruction error behaves in high dimensions.</p>
</section>
<section id="error-analysis-exponential-convergence" class="level3">
<h3 class="anchored" data-anchor-id="error-analysis-exponential-convergence">Error Analysis: Exponential Convergence</h3>
<p>We can try a given number of (initially) random centroids, and try to match them to the data via k-Means.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The residuals at different levels of our RVQ calculations will likely have different data distributions. Which means that instead of “sharing (scaled) codebooks” like we did before, we’ll need to re-calculate a new codebook at each “level”. Otherwise we won’t see any advantage from RVQ (trust me I tried).</p>
</div>
</div>
<p>In the following calculation, we’ll vary the number of dimensions, the length of the codebooks, and the number of codebooks, and see how these all affect the reconstruction error.</p>
<p>But rather than using our code, use let’s use the wonderful repository by lucidrains: <a href="https://github.com/lucidrains/vector-quantize-pytorch">lucidrains/vector-quantize-pytorch</a></p>
<p>The following set of error values is a “wall of numbers” which may not interest you. Feel free to scroll past it and skip down to the graphical representation of (some of) the numbers.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vector_quantize_pytorch <span class="im">import</span> ResidualVQ</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_pretty(d,styler):</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    styler.set_caption(<span class="ss">f"d = </span><span class="sc">{</span>d<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    styler.<span class="bu">format</span>(<span class="kw">lambda</span> e: <span class="ss">f'</span><span class="sc">{</span><span class="dv">10</span><span class="op">**</span>e<span class="sc">:0.1e}</span><span class="ss">'</span>)   <span class="co"># undo the log op</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    styler.background_gradient(axis<span class="op">=</span><span class="va">None</span>, vmin<span class="op">=-</span><span class="dv">12</span>, vmax<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span><span class="st">"plasma"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> styler</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_colored_data(results_d, d, cb_lengths, K_choices):</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"displays a dataframe table but colors the background according to log10 of the numbers"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    rdf <span class="op">=</span> pd.DataFrame(np.log10(results_d.numpy()), </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                       columns<span class="op">=</span>[<span class="ss">f'K = </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> k <span class="kw">in</span> K_choices], </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                       index<span class="op">=</span>[<span class="ss">f'cb_len = </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> c <span class="kw">in</span> cb_lengths])</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    ourfunc <span class="op">=</span> partial(make_pretty,d)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    display(rdf.style.pipe(ourfunc))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>n_dim <span class="op">=</span> <span class="dv">256</span>  <span class="co"># number of dimensions</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>cb_len <span class="op">=</span> <span class="dv">256</span> <span class="co"># codebook length</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="dv">4</span>        <span class="co"># number of codebooks</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>npoints_hd <span class="op">=</span> <span class="dv">4096</span>  <span class="co"># number of data points in high-dim space</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>d_choices <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>]  <span class="co"># dimensions to try</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>cb_lengths <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">64</span>, <span class="dv">256</span>, <span class="dv">1024</span>, <span class="dv">2048</span>]                 <span class="co"># codebook lengths</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>K_choices <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>]<span class="co">#,16]                           # variable numbers of codebooks</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> torch.empty( ( <span class="bu">len</span>(d_choices), <span class="bu">len</span>(cb_lengths), <span class="bu">len</span>(K_choices) )).cpu()</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q1, n_dim <span class="kw">in</span> <span class="bu">enumerate</span>(d_choices):</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(f"\nd={n_dim:4}:       {' '.join([f'      K={i}' for i in K_choices])}")</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q2, cb_len <span class="kw">in</span> <span class="bu">enumerate</span>(cb_lengths):</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(f"   cb_len={cb_len:4}: ",end="")</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> q3, K <span class="kw">in</span> <span class="bu">enumerate</span>(K_choices):</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>            residual_vq <span class="op">=</span> ResidualVQ(</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>                dim <span class="op">=</span> n_dim,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>                codebook_size <span class="op">=</span> cb_len,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>                num_quantizers <span class="op">=</span> K,</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>                kmeans_init <span class="op">=</span> <span class="va">True</span>,   <span class="co"># set to True</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>                kmeans_iters <span class="op">=</span> <span class="dv">10</span>     <span class="co"># number of kmeans iterations to calculate the centroids for the codebook on init</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>            torch.manual_seed(<span class="dv">0</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> torch.randn(<span class="dv">1</span>, npoints_hd, n_dim)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>            quantized, indices, commit_loss <span class="op">=</span> residual_vq(x)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>            error <span class="op">=</span> ((quantized <span class="op">-</span> x)<span class="op">**</span><span class="dv">2</span>).mean()</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(f"  {error:.1e} ", end="")</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>            results[q1,q2,q3] <span class="op">=</span> error</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print()</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    show_colored_data(results[q1], n_dim, cb_lengths, K_choices)     </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_09467_row0_col0 {
  background-color: #fdb52e;
  color: #000000;
}
#T_09467_row0_col1 {
  background-color: #f9973f;
  color: #000000;
}
#T_09467_row0_col2 {
  background-color: #f0804e;
  color: #f1f1f1;
}
#T_09467_row0_col3, #T_09467_row1_col2 {
  background-color: #e56b5d;
  color: #f1f1f1;
}
#T_09467_row0_col4 {
  background-color: #ce4b75;
  color: #f1f1f1;
}
#T_09467_row0_col5 {
  background-color: #ad2793;
  color: #f1f1f1;
}
#T_09467_row0_col6 {
  background-color: #8305a7;
  color: #f1f1f1;
}
#T_09467_row1_col0 {
  background-color: #fca934;
  color: #000000;
}
#T_09467_row1_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_09467_row1_col3 {
  background-color: #d6556d;
  color: #f1f1f1;
}
#T_09467_row1_col4 {
  background-color: #b32c8e;
  color: #f1f1f1;
}
#T_09467_row1_col5 {
  background-color: #8606a6;
  color: #f1f1f1;
}
#T_09467_row1_col6 {
  background-color: #5302a3;
  color: #f1f1f1;
}
#T_09467_row2_col0 {
  background-color: #f99a3e;
  color: #000000;
}
#T_09467_row2_col1 {
  background-color: #e76f5a;
  color: #f1f1f1;
}
#T_09467_row2_col2 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_09467_row2_col3 {
  background-color: #bb3488;
  color: #f1f1f1;
}
#T_09467_row2_col4 {
  background-color: #8405a7;
  color: #f1f1f1;
}
#T_09467_row2_col5 {
  background-color: #3f049c;
  color: #f1f1f1;
}
#T_09467_row2_col6, #T_09467_row3_col5, #T_09467_row3_col6, #T_09467_row4_col5, #T_09467_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
#T_09467_row3_col0 {
  background-color: #f48948;
  color: #f1f1f1;
}
#T_09467_row3_col1 {
  background-color: #da5b69;
  color: #f1f1f1;
}
#T_09467_row3_col2 {
  background-color: #c13b82;
  color: #f1f1f1;
}
#T_09467_row3_col3 {
  background-color: #a72197;
  color: #f1f1f1;
}
#T_09467_row3_col4 {
  background-color: #5601a4;
  color: #f1f1f1;
}
#T_09467_row4_col0 {
  background-color: #ee7b51;
  color: #f1f1f1;
}
#T_09467_row4_col1 {
  background-color: #c7427c;
  color: #f1f1f1;
}
#T_09467_row4_col2 {
  background-color: #a21d9a;
  color: #f1f1f1;
}
#T_09467_row4_col3 {
  background-color: #7201a8;
  color: #f1f1f1;
}
#T_09467_row4_col4 {
  background-color: #16078a;
  color: #f1f1f1;
}
</style>

<table id="T_09467" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 2:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_09467_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_09467_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_09467_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_09467_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_09467_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_09467_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_09467_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_09467_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_09467_row0_col0" class="data row0 col0">7.5e-02</td>
<td id="T_09467_row0_col1" class="data row0 col1">6.8e-03</td>
<td id="T_09467_row0_col2" class="data row0 col2">8.9e-04</td>
<td id="T_09467_row0_col3" class="data row0 col3">1.2e-04</td>
<td id="T_09467_row0_col4" class="data row0 col4">4.8e-06</td>
<td id="T_09467_row0_col5" class="data row0 col5">1.1e-07</td>
<td id="T_09467_row0_col6" class="data row0 col6">2.6e-09</td>
</tr>
<tr class="even">
<td id="T_09467_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_09467_row1_col0" class="data row1 col0">3.1e-02</td>
<td id="T_09467_row1_col1" class="data row1 col1">1.7e-03</td>
<td id="T_09467_row1_col2" class="data row1 col2">1.3e-04</td>
<td id="T_09467_row1_col3" class="data row1 col3">1.3e-05</td>
<td id="T_09467_row1_col4" class="data row1 col4">2.1e-07</td>
<td id="T_09467_row1_col5" class="data row1 col5">3.5e-09</td>
<td id="T_09467_row1_col6" class="data row1 col6">6.9e-11</td>
</tr>
<tr class="odd">
<td id="T_09467_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_09467_row2_col0" class="data row2 col0">8.5e-03</td>
<td id="T_09467_row2_col1" class="data row2 col1">1.9e-04</td>
<td id="T_09467_row2_col2" class="data row2 col2">7.4e-06</td>
<td id="T_09467_row2_col3" class="data row2 col3">4.5e-07</td>
<td id="T_09467_row2_col4" class="data row2 col4">3.1e-09</td>
<td id="T_09467_row2_col5" class="data row2 col5">1.8e-11</td>
<td id="T_09467_row2_col6" class="data row2 col6">1.5e-13</td>
</tr>
<tr class="even">
<td id="T_09467_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_09467_row3_col0" class="data row3 col0">2.0e-03</td>
<td id="T_09467_row3_col1" class="data row3 col1">2.4e-05</td>
<td id="T_09467_row3_col2" class="data row3 col2">9.6e-07</td>
<td id="T_09467_row3_col3" class="data row3 col3">6.1e-08</td>
<td id="T_09467_row3_col4" class="data row3 col4">9.4e-11</td>
<td id="T_09467_row3_col5" class="data row3 col5">4.8e-14</td>
<td id="T_09467_row3_col6" class="data row3 col6">3.5e-15</td>
</tr>
<tr class="odd">
<td id="T_09467_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_09467_row4_col0" class="data row4 col0">6.0e-04</td>
<td id="T_09467_row4_col1" class="data row4 col1">1.8e-06</td>
<td id="T_09467_row4_col2" class="data row4 col2">3.9e-08</td>
<td id="T_09467_row4_col3" class="data row4 col3">7.8e-10</td>
<td id="T_09467_row4_col4" class="data row4 col4">1.4e-12</td>
<td id="T_09467_row4_col5" class="data row4 col5">3.8e-15</td>
<td id="T_09467_row4_col6" class="data row4 col6">1.4e-15</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_bc096_row0_col0 {
  background-color: #fec029;
  color: #000000;
}
#T_bc096_row0_col1, #T_bc096_row2_col0 {
  background-color: #fdab33;
  color: #000000;
}
#T_bc096_row0_col2 {
  background-color: #f9983e;
  color: #000000;
}
#T_bc096_row0_col3 {
  background-color: #f48849;
  color: #f1f1f1;
}
#T_bc096_row0_col4 {
  background-color: #e56b5d;
  color: #f1f1f1;
}
#T_bc096_row0_col5, #T_bc096_row2_col3 {
  background-color: #d45270;
  color: #f1f1f1;
}
#T_bc096_row0_col6, #T_bc096_row4_col2 {
  background-color: #c13b82;
  color: #f1f1f1;
}
#T_bc096_row1_col0 {
  background-color: #feb82c;
  color: #000000;
}
#T_bc096_row1_col1 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_bc096_row1_col2 {
  background-color: #f3854b;
  color: #f1f1f1;
}
#T_bc096_row1_col3 {
  background-color: #e97158;
  color: #f1f1f1;
}
#T_bc096_row1_col4 {
  background-color: #cf4c74;
  color: #f1f1f1;
}
#T_bc096_row1_col5 {
  background-color: #b6308b;
  color: #f1f1f1;
}
#T_bc096_row1_col6 {
  background-color: #8d0ba5;
  color: #f1f1f1;
}
#T_bc096_row2_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_bc096_row2_col2 {
  background-color: #e4695e;
  color: #f1f1f1;
}
#T_bc096_row2_col4 {
  background-color: #ac2694;
  color: #f1f1f1;
}
#T_bc096_row2_col5 {
  background-color: #7e03a8;
  color: #f1f1f1;
}
#T_bc096_row2_col6 {
  background-color: #4b03a1;
  color: #f1f1f1;
}
#T_bc096_row3_col0 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_bc096_row3_col1 {
  background-color: #e97257;
  color: #f1f1f1;
}
#T_bc096_row3_col2 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_bc096_row3_col3 {
  background-color: #bb3488;
  color: #f1f1f1;
}
#T_bc096_row3_col4 {
  background-color: #7b02a8;
  color: #f1f1f1;
}
#T_bc096_row3_col5 {
  background-color: #2a0593;
  color: #f1f1f1;
}
#T_bc096_row3_col6, #T_bc096_row4_col5, #T_bc096_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
#T_bc096_row4_col0 {
  background-color: #f79143;
  color: #f1f1f1;
}
#T_bc096_row4_col1 {
  background-color: #df6263;
  color: #f1f1f1;
}
#T_bc096_row4_col3 {
  background-color: #9d189d;
  color: #f1f1f1;
}
#T_bc096_row4_col4 {
  background-color: #330597;
  color: #f1f1f1;
}
</style>

<table id="T_bc096" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 3:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_bc096_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_bc096_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_bc096_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_bc096_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_bc096_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_bc096_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_bc096_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_bc096_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_bc096_row0_col0" class="data row0 col0">1.8e-01</td>
<td id="T_bc096_row0_col1" class="data row0 col1">3.5e-02</td>
<td id="T_bc096_row0_col2" class="data row0 col2">7.7e-03</td>
<td id="T_bc096_row0_col3" class="data row0 col3">1.8e-03</td>
<td id="T_bc096_row0_col4" class="data row0 col4">1.3e-04</td>
<td id="T_bc096_row0_col5" class="data row0 col5">1.0e-05</td>
<td id="T_bc096_row0_col6" class="data row0 col6">9.1e-07</td>
</tr>
<tr class="even">
<td id="T_bc096_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_bc096_row1_col0" class="data row1 col0">9.8e-02</td>
<td id="T_bc096_row1_col1" class="data row1 col1">1.1e-02</td>
<td id="T_bc096_row1_col2" class="data row1 col2">1.4e-03</td>
<td id="T_bc096_row1_col3" class="data row1 col3">2.2e-04</td>
<td id="T_bc096_row1_col4" class="data row1 col4">5.7e-06</td>
<td id="T_bc096_row1_col5" class="data row1 col5">2.7e-07</td>
<td id="T_bc096_row1_col6" class="data row1 col6">5.8e-09</td>
</tr>
<tr class="odd">
<td id="T_bc096_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_bc096_row2_col0" class="data row2 col0">3.6e-02</td>
<td id="T_bc096_row2_col1" class="data row2 col1">1.7e-03</td>
<td id="T_bc096_row2_col2" class="data row2 col2">9.8e-05</td>
<td id="T_bc096_row2_col3" class="data row2 col3">9.6e-06</td>
<td id="T_bc096_row2_col4" class="data row2 col4">1.1e-07</td>
<td id="T_bc096_row2_col5" class="data row2 col5">1.8e-09</td>
<td id="T_bc096_row2_col6" class="data row2 col6">4.2e-11</td>
</tr>
<tr class="even">
<td id="T_bc096_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_bc096_row3_col0" class="data row3 col0">1.2e-02</td>
<td id="T_bc096_row3_col1" class="data row3 col1">2.7e-04</td>
<td id="T_bc096_row3_col2" class="data row3 col2">8.0e-06</td>
<td id="T_bc096_row3_col3" class="data row3 col3">4.5e-07</td>
<td id="T_bc096_row3_col4" class="data row3 col4">1.5e-09</td>
<td id="T_bc096_row3_col5" class="data row3 col5">4.2e-12</td>
<td id="T_bc096_row3_col6" class="data row3 col6">2.4e-14</td>
</tr>
<tr class="odd">
<td id="T_bc096_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_bc096_row4_col0" class="data row4 col0">4.4e-03</td>
<td id="T_bc096_row4_col1" class="data row4 col1">4.7e-05</td>
<td id="T_bc096_row4_col2" class="data row4 col2">9.3e-07</td>
<td id="T_bc096_row4_col3" class="data row4 col3">2.5e-08</td>
<td id="T_bc096_row4_col4" class="data row4 col4">7.5e-12</td>
<td id="T_bc096_row4_col5" class="data row4 col5">3.8e-15</td>
<td id="T_bc096_row4_col6" class="data row4 col6">1.8e-15</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_8b7bc_row0_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_8b7bc_row0_col1, #T_8b7bc_row2_col0 {
  background-color: #fec029;
  color: #000000;
}
#T_8b7bc_row0_col2, #T_8b7bc_row3_col0 {
  background-color: #fdb52e;
  color: #000000;
}
#T_8b7bc_row0_col3, #T_8b7bc_row4_col0 {
  background-color: #fdac33;
  color: #000000;
}
#T_8b7bc_row0_col4 {
  background-color: #f99a3e;
  color: #000000;
}
#T_8b7bc_row0_col5 {
  background-color: #f48948;
  color: #f1f1f1;
}
#T_8b7bc_row0_col6, #T_8b7bc_row3_col2 {
  background-color: #ee7b51;
  color: #f1f1f1;
}
#T_8b7bc_row1_col0 {
  background-color: #fdc827;
  color: #000000;
}
#T_8b7bc_row1_col1 {
  background-color: #feb82c;
  color: #000000;
}
#T_8b7bc_row1_col2 {
  background-color: #fdab33;
  color: #000000;
}
#T_8b7bc_row1_col3 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_8b7bc_row1_col4 {
  background-color: #f2844b;
  color: #f1f1f1;
}
#T_8b7bc_row1_col5 {
  background-color: #e76e5b;
  color: #f1f1f1;
}
#T_8b7bc_row1_col6 {
  background-color: #da5a6a;
  color: #f1f1f1;
}
#T_8b7bc_row2_col1 {
  background-color: #fca934;
  color: #000000;
}
#T_8b7bc_row2_col2 {
  background-color: #f89540;
  color: #000000;
}
#T_8b7bc_row2_col3 {
  background-color: #f1834c;
  color: #f1f1f1;
}
#T_8b7bc_row2_col4 {
  background-color: #de5f65;
  color: #f1f1f1;
}
#T_8b7bc_row2_col5 {
  background-color: #c5407e;
  color: #f1f1f1;
}
#T_8b7bc_row2_col6 {
  background-color: #a62098;
  color: #f1f1f1;
}
#T_8b7bc_row3_col1 {
  background-color: #f9973f;
  color: #000000;
}
#T_8b7bc_row3_col3 {
  background-color: #df6263;
  color: #f1f1f1;
}
#T_8b7bc_row3_col4 {
  background-color: #ba3388;
  color: #f1f1f1;
}
#T_8b7bc_row3_col5 {
  background-color: #8707a6;
  color: #f1f1f1;
}
#T_8b7bc_row3_col6 {
  background-color: #46039f;
  color: #f1f1f1;
}
#T_8b7bc_row4_col1 {
  background-color: #f3874a;
  color: #f1f1f1;
}
#T_8b7bc_row4_col2 {
  background-color: #e26660;
  color: #f1f1f1;
}
#T_8b7bc_row4_col3 {
  background-color: #cc4977;
  color: #f1f1f1;
}
#T_8b7bc_row4_col4 {
  background-color: #9410a2;
  color: #f1f1f1;
}
#T_8b7bc_row4_col5 {
  background-color: #4c02a1;
  color: #f1f1f1;
}
#T_8b7bc_row4_col6 {
  background-color: #0d0887;
  color: #f1f1f1;
}
</style>

<table id="T_8b7bc" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 6:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_8b7bc_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_8b7bc_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_8b7bc_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_8b7bc_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_8b7bc_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_8b7bc_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_8b7bc_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_8b7bc_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_8b7bc_row0_col0" class="data row0 col0">4.3e-01</td>
<td id="T_8b7bc_row0_col1" class="data row0 col1">1.9e-01</td>
<td id="T_8b7bc_row0_col2" class="data row0 col2">8.2e-02</td>
<td id="T_8b7bc_row0_col3" class="data row0 col3">3.7e-02</td>
<td id="T_8b7bc_row0_col4" class="data row0 col4">8.6e-03</td>
<td id="T_8b7bc_row0_col5" class="data row0 col5">2.1e-03</td>
<td id="T_8b7bc_row0_col6" class="data row0 col6">5.5e-04</td>
</tr>
<tr class="even">
<td id="T_8b7bc_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_8b7bc_row1_col0" class="data row1 col0">3.2e-01</td>
<td id="T_8b7bc_row1_col1" class="data row1 col1">1.0e-01</td>
<td id="T_8b7bc_row1_col2" class="data row1 col2">3.3e-02</td>
<td id="T_8b7bc_row1_col3" class="data row1 col3">1.1e-02</td>
<td id="T_8b7bc_row1_col4" class="data row1 col4">1.3e-03</td>
<td id="T_8b7bc_row1_col5" class="data row1 col5">1.7e-04</td>
<td id="T_8b7bc_row1_col6" class="data row1 col6">2.2e-05</td>
</tr>
<tr class="odd">
<td id="T_8b7bc_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_8b7bc_row2_col0" class="data row2 col0">1.8e-01</td>
<td id="T_8b7bc_row2_col1" class="data row2 col1">3.2e-02</td>
<td id="T_8b7bc_row2_col2" class="data row2 col2">6.0e-03</td>
<td id="T_8b7bc_row2_col3" class="data row2 col3">1.1e-03</td>
<td id="T_8b7bc_row2_col4" class="data row2 col4">4.0e-05</td>
<td id="T_8b7bc_row2_col5" class="data row2 col5">1.5e-06</td>
<td id="T_8b7bc_row2_col6" class="data row2 col6">5.6e-08</td>
</tr>
<tr class="even">
<td id="T_8b7bc_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_8b7bc_row3_col0" class="data row3 col0">8.0e-02</td>
<td id="T_8b7bc_row3_col1" class="data row3 col1">6.7e-03</td>
<td id="T_8b7bc_row3_col2" class="data row3 col2">5.8e-04</td>
<td id="T_8b7bc_row3_col3" class="data row3 col3">5.0e-05</td>
<td id="T_8b7bc_row3_col4" class="data row3 col4">4.0e-07</td>
<td id="T_8b7bc_row3_col5" class="data row3 col5">3.6e-09</td>
<td id="T_8b7bc_row3_col6" class="data row3 col6">3.0e-11</td>
</tr>
<tr class="odd">
<td id="T_8b7bc_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_8b7bc_row4_col0" class="data row4 col0">3.8e-02</td>
<td id="T_8b7bc_row4_col1" class="data row4 col1">1.6e-03</td>
<td id="T_8b7bc_row4_col2" class="data row4 col2">7.9e-05</td>
<td id="T_8b7bc_row4_col3" class="data row4 col3">3.6e-06</td>
<td id="T_8b7bc_row4_col4" class="data row4 col4">1.1e-08</td>
<td id="T_8b7bc_row4_col5" class="data row4 col5">4.5e-11</td>
<td id="T_8b7bc_row4_col6" class="data row4 col6">2.5e-13</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_196f2_row0_col0 {
  background-color: #fcce25;
  color: #000000;
}
#T_196f2_row0_col1 {
  background-color: #fdc627;
  color: #000000;
}
#T_196f2_row0_col2 {
  background-color: #febe2a;
  color: #000000;
}
#T_196f2_row0_col3, #T_196f2_row1_col2 {
  background-color: #fdb52e;
  color: #000000;
}
#T_196f2_row0_col4 {
  background-color: #fca636;
  color: #000000;
}
#T_196f2_row0_col5 {
  background-color: #f9983e;
  color: #000000;
}
#T_196f2_row0_col6 {
  background-color: #f58c46;
  color: #f1f1f1;
}
#T_196f2_row1_col0 {
  background-color: #fdcb26;
  color: #000000;
}
#T_196f2_row1_col1 {
  background-color: #fec029;
  color: #000000;
}
#T_196f2_row1_col3 {
  background-color: #fca934;
  color: #000000;
}
#T_196f2_row1_col4 {
  background-color: #f89540;
  color: #000000;
}
#T_196f2_row1_col5 {
  background-color: #f2844b;
  color: #f1f1f1;
}
#T_196f2_row1_col6 {
  background-color: #e97257;
  color: #f1f1f1;
}
#T_196f2_row2_col0 {
  background-color: #fdc527;
  color: #000000;
}
#T_196f2_row2_col1, #T_196f2_row4_col0 {
  background-color: #fdb42f;
  color: #000000;
}
#T_196f2_row2_col2 {
  background-color: #fca338;
  color: #000000;
}
#T_196f2_row2_col3 {
  background-color: #f89441;
  color: #000000;
}
#T_196f2_row2_col4 {
  background-color: #ec7754;
  color: #f1f1f1;
}
#T_196f2_row2_col5 {
  background-color: #dc5d67;
  color: #f1f1f1;
}
#T_196f2_row2_col6 {
  background-color: #c9447a;
  color: #f1f1f1;
}
#T_196f2_row3_col0 {
  background-color: #febd2a;
  color: #000000;
}
#T_196f2_row3_col1 {
  background-color: #fba238;
  color: #000000;
}
#T_196f2_row3_col2 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_196f2_row3_col3, #T_196f2_row4_col2 {
  background-color: #eb7655;
  color: #f1f1f1;
}
#T_196f2_row3_col4 {
  background-color: #d14e72;
  color: #f1f1f1;
}
#T_196f2_row3_col5 {
  background-color: #ae2892;
  color: #f1f1f1;
}
#T_196f2_row3_col6 {
  background-color: #8305a7;
  color: #f1f1f1;
}
#T_196f2_row4_col1 {
  background-color: #f79342;
  color: #000000;
}
#T_196f2_row4_col3 {
  background-color: #db5c68;
  color: #f1f1f1;
}
#T_196f2_row4_col4 {
  background-color: #b22b8f;
  color: #f1f1f1;
}
#T_196f2_row4_col5 {
  background-color: #7d03a8;
  color: #f1f1f1;
}
#T_196f2_row4_col6 {
  background-color: #3e049c;
  color: #f1f1f1;
}
</style>

<table id="T_196f2" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 8:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_196f2_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_196f2_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_196f2_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_196f2_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_196f2_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_196f2_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_196f2_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_196f2_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_196f2_row0_col0" class="data row0 col0">5.3e-01</td>
<td id="T_196f2_row0_col1" class="data row0 col1">2.8e-01</td>
<td id="T_196f2_row0_col2" class="data row0 col2">1.5e-01</td>
<td id="T_196f2_row0_col3" class="data row0 col3">8.2e-02</td>
<td id="T_196f2_row0_col4" class="data row0 col4">2.4e-02</td>
<td id="T_196f2_row0_col5" class="data row0 col5">7.7e-03</td>
<td id="T_196f2_row0_col6" class="data row0 col6">2.6e-03</td>
</tr>
<tr class="even">
<td id="T_196f2_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_196f2_row1_col0" class="data row1 col0">4.2e-01</td>
<td id="T_196f2_row1_col1" class="data row1 col1">1.7e-01</td>
<td id="T_196f2_row1_col2" class="data row1 col2">7.4e-02</td>
<td id="T_196f2_row1_col3" class="data row1 col3">3.2e-02</td>
<td id="T_196f2_row1_col4" class="data row1 col4">6.2e-03</td>
<td id="T_196f2_row1_col5" class="data row1 col5">1.2e-03</td>
<td id="T_196f2_row1_col6" class="data row1 col6">2.6e-04</td>
</tr>
<tr class="odd">
<td id="T_196f2_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_196f2_row2_col0" class="data row2 col0">2.7e-01</td>
<td id="T_196f2_row2_col1" class="data row2 col1">7.1e-02</td>
<td id="T_196f2_row2_col2" class="data row2 col2">1.9e-02</td>
<td id="T_196f2_row2_col3" class="data row2 col3">5.2e-03</td>
<td id="T_196f2_row2_col4" class="data row2 col4">3.9e-04</td>
<td id="T_196f2_row2_col5" class="data row2 col5">3.0e-05</td>
<td id="T_196f2_row2_col6" class="data row2 col6">2.2e-06</td>
</tr>
<tr class="even">
<td id="T_196f2_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_196f2_row3_col0" class="data row3 col0">1.3e-01</td>
<td id="T_196f2_row3_col1" class="data row3 col1">1.8e-02</td>
<td id="T_196f2_row3_col2" class="data row3 col2">2.5e-03</td>
<td id="T_196f2_row3_col3" class="data row3 col3">3.5e-04</td>
<td id="T_196f2_row3_col4" class="data row3 col4">6.6e-06</td>
<td id="T_196f2_row3_col5" class="data row3 col5">1.3e-07</td>
<td id="T_196f2_row3_col6" class="data row3 col6">2.7e-09</td>
</tr>
<tr class="odd">
<td id="T_196f2_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_196f2_row4_col0" class="data row4 col0">6.6e-02</td>
<td id="T_196f2_row4_col1" class="data row4 col1">4.7e-03</td>
<td id="T_196f2_row4_col2" class="data row4 col2">3.4e-04</td>
<td id="T_196f2_row4_col3" class="data row4 col3">2.8e-05</td>
<td id="T_196f2_row4_col4" class="data row4 col4">1.8e-07</td>
<td id="T_196f2_row4_col5" class="data row4 col5">1.6e-09</td>
<td id="T_196f2_row4_col6" class="data row4 col6">1.5e-11</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_5f713_row0_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_5f713_row0_col1, #T_5f713_row2_col0 {
  background-color: #fcce25;
  color: #000000;
}
#T_5f713_row0_col2, #T_5f713_row1_col1 {
  background-color: #fdcb26;
  color: #000000;
}
#T_5f713_row0_col3, #T_5f713_row3_col0 {
  background-color: #fdc627;
  color: #000000;
}
#T_5f713_row0_col4, #T_5f713_row1_col3, #T_5f713_row4_col0 {
  background-color: #febe2a;
  color: #000000;
}
#T_5f713_row0_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_5f713_row0_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_5f713_row1_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_5f713_row1_col2 {
  background-color: #fdc527;
  color: #000000;
}
#T_5f713_row1_col4 {
  background-color: #fdb42f;
  color: #000000;
}
#T_5f713_row1_col5, #T_5f713_row3_col2, #T_5f713_row4_col1 {
  background-color: #fca835;
  color: #000000;
}
#T_5f713_row1_col6 {
  background-color: #fa9c3c;
  color: #000000;
}
#T_5f713_row2_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_5f713_row2_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_5f713_row2_col3 {
  background-color: #fdb130;
  color: #000000;
}
#T_5f713_row2_col4 {
  background-color: #fb9f3a;
  color: #000000;
}
#T_5f713_row2_col5 {
  background-color: #f68f44;
  color: #f1f1f1;
}
#T_5f713_row2_col6, #T_5f713_row3_col4 {
  background-color: #f07f4f;
  color: #f1f1f1;
}
#T_5f713_row3_col1 {
  background-color: #feb72d;
  color: #000000;
}
#T_5f713_row3_col3 {
  background-color: #f99a3e;
  color: #000000;
}
#T_5f713_row3_col5 {
  background-color: #e26660;
  color: #f1f1f1;
}
#T_5f713_row3_col6 {
  background-color: #d24f71;
  color: #f1f1f1;
}
#T_5f713_row4_col2 {
  background-color: #f79342;
  color: #000000;
}
#T_5f713_row4_col3 {
  background-color: #ef7e50;
  color: #f1f1f1;
}
#T_5f713_row4_col4 {
  background-color: #db5c68;
  color: #f1f1f1;
}
#T_5f713_row4_col5 {
  background-color: #c23c81;
  color: #f1f1f1;
}
#T_5f713_row4_col6 {
  background-color: #a21d9a;
  color: #f1f1f1;
}
</style>

<table id="T_5f713" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 16:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_5f713_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_5f713_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_5f713_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_5f713_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_5f713_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_5f713_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_5f713_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5f713_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_5f713_row0_col0" class="data row0 col0">7.3e-01</td>
<td id="T_5f713_row0_col1" class="data row0 col1">5.3e-01</td>
<td id="T_5f713_row0_col2" class="data row0 col2">3.9e-01</td>
<td id="T_5f713_row0_col3" class="data row0 col3">2.8e-01</td>
<td id="T_5f713_row0_col4" class="data row0 col4">1.5e-01</td>
<td id="T_5f713_row0_col5" class="data row0 col5">7.9e-02</td>
<td id="T_5f713_row0_col6" class="data row0 col6">4.2e-02</td>
</tr>
<tr class="even">
<td id="T_5f713_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_5f713_row1_col0" class="data row1 col0">6.4e-01</td>
<td id="T_5f713_row1_col1" class="data row1 col1">4.0e-01</td>
<td id="T_5f713_row1_col2" class="data row1 col2">2.6e-01</td>
<td id="T_5f713_row1_col3" class="data row1 col3">1.6e-01</td>
<td id="T_5f713_row1_col4" class="data row1 col4">6.6e-02</td>
<td id="T_5f713_row1_col5" class="data row1 col5">2.7e-02</td>
<td id="T_5f713_row1_col6" class="data row1 col6">1.1e-02</td>
</tr>
<tr class="odd">
<td id="T_5f713_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_5f713_row2_col0" class="data row2 col0">4.9e-01</td>
<td id="T_5f713_row2_col1" class="data row2 col1">2.4e-01</td>
<td id="T_5f713_row2_col2" class="data row2 col2">1.2e-01</td>
<td id="T_5f713_row2_col3" class="data row2 col3">5.6e-02</td>
<td id="T_5f713_row2_col4" class="data row2 col4">1.3e-02</td>
<td id="T_5f713_row2_col5" class="data row2 col5">3.2e-03</td>
<td id="T_5f713_row2_col6" class="data row2 col6">7.8e-04</td>
</tr>
<tr class="even">
<td id="T_5f713_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_5f713_row3_col0" class="data row3 col0">3.0e-01</td>
<td id="T_5f713_row3_col1" class="data row3 col1">9.0e-02</td>
<td id="T_5f713_row3_col2" class="data row3 col2">2.7e-02</td>
<td id="T_5f713_row3_col3" class="data row3 col3">8.1e-03</td>
<td id="T_5f713_row3_col4" class="data row3 col4">7.7e-04</td>
<td id="T_5f713_row3_col5" class="data row3 col5">7.6e-05</td>
<td id="T_5f713_row3_col6" class="data row3 col6">7.4e-06</td>
</tr>
<tr class="odd">
<td id="T_5f713_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_5f713_row4_col0" class="data row4 col0">1.6e-01</td>
<td id="T_5f713_row4_col1" class="data row4 col1">2.8e-02</td>
<td id="T_5f713_row4_col2" class="data row4 col2">4.7e-03</td>
<td id="T_5f713_row4_col3" class="data row4 col3">7.6e-04</td>
<td id="T_5f713_row4_col4" class="data row4 col4">2.7e-05</td>
<td id="T_5f713_row4_col5" class="data row4 col5">1.0e-06</td>
<td id="T_5f713_row4_col6" class="data row4 col6">3.8e-08</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_1a973_row0_col0, #T_1a973_row1_col0 {
  background-color: #fbd524;
  color: #000000;
}
#T_1a973_row0_col1 {
  background-color: #fbd324;
  color: #000000;
}
#T_1a973_row0_col2, #T_1a973_row1_col1, #T_1a973_row2_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_1a973_row0_col3, #T_1a973_row1_col2 {
  background-color: #fcce25;
  color: #000000;
}
#T_1a973_row0_col4, #T_1a973_row1_col3 {
  background-color: #fdca26;
  color: #000000;
}
#T_1a973_row0_col5 {
  background-color: #fdc527;
  color: #000000;
}
#T_1a973_row0_col6, #T_1a973_row2_col3 {
  background-color: #fdc229;
  color: #000000;
}
#T_1a973_row1_col4, #T_1a973_row3_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_1a973_row1_col5 {
  background-color: #febd2a;
  color: #000000;
}
#T_1a973_row1_col6, #T_1a973_row2_col4 {
  background-color: #feb72d;
  color: #000000;
}
#T_1a973_row2_col1, #T_1a973_row3_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_1a973_row2_col2, #T_1a973_row4_col0 {
  background-color: #fdc627;
  color: #000000;
}
#T_1a973_row2_col5 {
  background-color: #fdac33;
  color: #000000;
}
#T_1a973_row2_col6, #T_1a973_row4_col2 {
  background-color: #fca338;
  color: #000000;
}
#T_1a973_row3_col2 {
  background-color: #feb82c;
  color: #000000;
}
#T_1a973_row3_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_1a973_row3_col4 {
  background-color: #fa9b3d;
  color: #000000;
}
#T_1a973_row3_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_1a973_row3_col6 {
  background-color: #ed7a52;
  color: #f1f1f1;
}
#T_1a973_row4_col1 {
  background-color: #fdb42f;
  color: #000000;
}
#T_1a973_row4_col3 {
  background-color: #f89441;
  color: #000000;
}
#T_1a973_row4_col4 {
  background-color: #ec7754;
  color: #f1f1f1;
}
#T_1a973_row4_col5 {
  background-color: #dd5e66;
  color: #f1f1f1;
}
#T_1a973_row4_col6 {
  background-color: #ca457a;
  color: #f1f1f1;
}
</style>

<table id="T_1a973" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 32:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_1a973_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_1a973_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_1a973_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_1a973_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_1a973_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_1a973_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_1a973_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_1a973_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_1a973_row0_col0" class="data row0 col0">8.5e-01</td>
<td id="T_1a973_row0_col1" class="data row0 col1">7.2e-01</td>
<td id="T_1a973_row0_col2" class="data row0 col2">6.1e-01</td>
<td id="T_1a973_row0_col3" class="data row0 col3">5.1e-01</td>
<td id="T_1a973_row0_col4" class="data row0 col4">3.7e-01</td>
<td id="T_1a973_row0_col5" class="data row0 col5">2.6e-01</td>
<td id="T_1a973_row0_col6" class="data row0 col6">1.9e-01</td>
</tr>
<tr class="even">
<td id="T_1a973_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_1a973_row1_col0" class="data row1 col0">7.8e-01</td>
<td id="T_1a973_row1_col1" class="data row1 col1">6.1e-01</td>
<td id="T_1a973_row1_col2" class="data row1 col2">4.8e-01</td>
<td id="T_1a973_row1_col3" class="data row1 col3">3.8e-01</td>
<td id="T_1a973_row1_col4" class="data row1 col4">2.3e-01</td>
<td id="T_1a973_row1_col5" class="data row1 col5">1.4e-01</td>
<td id="T_1a973_row1_col6" class="data row1 col6">8.7e-02</td>
</tr>
<tr class="odd">
<td id="T_1a973_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_1a973_row2_col0" class="data row2 col0">6.7e-01</td>
<td id="T_1a973_row2_col1" class="data row2 col1">4.4e-01</td>
<td id="T_1a973_row2_col2" class="data row2 col2">3.0e-01</td>
<td id="T_1a973_row2_col3" class="data row2 col3">2.0e-01</td>
<td id="T_1a973_row2_col4" class="data row2 col4">9.0e-02</td>
<td id="T_1a973_row2_col5" class="data row2 col5">4.1e-02</td>
<td id="T_1a973_row2_col6" class="data row2 col6">1.8e-02</td>
</tr>
<tr class="even">
<td id="T_1a973_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_1a973_row3_col0" class="data row3 col0">4.6e-01</td>
<td id="T_1a973_row3_col1" class="data row3 col1">2.2e-01</td>
<td id="T_1a973_row3_col2" class="data row3 col2">1.0e-01</td>
<td id="T_1a973_row3_col3" class="data row3 col3">4.7e-02</td>
<td id="T_1a973_row3_col4" class="data row3 col4">9.9e-03</td>
<td id="T_1a973_row3_col5" class="data row3 col5">2.3e-03</td>
<td id="T_1a973_row3_col6" class="data row3 col6">5.1e-04</td>
</tr>
<tr class="odd">
<td id="T_1a973_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_1a973_row4_col0" class="data row4 col0">2.7e-01</td>
<td id="T_1a973_row4_col1" class="data row4 col1">7.1e-02</td>
<td id="T_1a973_row4_col2" class="data row4 col2">1.9e-02</td>
<td id="T_1a973_row4_col3" class="data row4 col3">5.1e-03</td>
<td id="T_1a973_row4_col4" class="data row4 col4">4.2e-04</td>
<td id="T_1a973_row4_col5" class="data row4 col5">3.6e-05</td>
<td id="T_1a973_row4_col6" class="data row4 col6">2.6e-06</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_b6f69_row0_col0, #T_b6f69_row1_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_b6f69_row0_col1, #T_b6f69_row0_col2, #T_b6f69_row1_col1, #T_b6f69_row2_col0 {
  background-color: #fbd524;
  color: #000000;
}
#T_b6f69_row0_col3 {
  background-color: #fbd324;
  color: #000000;
}
#T_b6f69_row0_col4, #T_b6f69_row1_col3, #T_b6f69_row2_col2, #T_b6f69_row3_col0 {
  background-color: #fcd025;
  color: #000000;
}
#T_b6f69_row0_col5 {
  background-color: #fcce25;
  color: #000000;
}
#T_b6f69_row0_col6 {
  background-color: #fdcb26;
  color: #000000;
}
#T_b6f69_row1_col2, #T_b6f69_row2_col1 {
  background-color: #fcd225;
  color: #000000;
}
#T_b6f69_row1_col4, #T_b6f69_row2_col3 {
  background-color: #fccd25;
  color: #000000;
}
#T_b6f69_row1_col5, #T_b6f69_row3_col1, #T_b6f69_row4_col0 {
  background-color: #fdca26;
  color: #000000;
}
#T_b6f69_row1_col6 {
  background-color: #fdc527;
  color: #000000;
}
#T_b6f69_row2_col4 {
  background-color: #fdc827;
  color: #000000;
}
#T_b6f69_row2_col5 {
  background-color: #fdc328;
  color: #000000;
}
#T_b6f69_row2_col6 {
  background-color: #febe2a;
  color: #000000;
}
#T_b6f69_row3_col2 {
  background-color: #fdc229;
  color: #000000;
}
#T_b6f69_row3_col3, #T_b6f69_row4_col1 {
  background-color: #febb2b;
  color: #000000;
}
#T_b6f69_row3_col4, #T_b6f69_row4_col2 {
  background-color: #fdae32;
  color: #000000;
}
#T_b6f69_row3_col5, #T_b6f69_row4_col3 {
  background-color: #fba139;
  color: #000000;
}
#T_b6f69_row3_col6 {
  background-color: #f89540;
  color: #000000;
}
#T_b6f69_row4_col4 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_b6f69_row4_col5 {
  background-color: #eb7655;
  color: #f1f1f1;
}
#T_b6f69_row4_col6 {
  background-color: #e06363;
  color: #f1f1f1;
}
</style>

<table id="T_b6f69" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 64:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_b6f69_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_b6f69_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_b6f69_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_b6f69_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_b6f69_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_b6f69_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_b6f69_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b6f69_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_b6f69_row0_col0" class="data row0 col0">9.1e-01</td>
<td id="T_b6f69_row0_col1" class="data row0 col1">8.4e-01</td>
<td id="T_b6f69_row0_col2" class="data row0 col2">7.6e-01</td>
<td id="T_b6f69_row0_col3" class="data row0 col3">7.0e-01</td>
<td id="T_b6f69_row0_col4" class="data row0 col4">5.8e-01</td>
<td id="T_b6f69_row0_col5" class="data row0 col5">4.8e-01</td>
<td id="T_b6f69_row0_col6" class="data row0 col6">4.0e-01</td>
</tr>
<tr class="even">
<td id="T_b6f69_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_b6f69_row1_col0" class="data row1 col0">8.7e-01</td>
<td id="T_b6f69_row1_col1" class="data row1 col1">7.6e-01</td>
<td id="T_b6f69_row1_col2" class="data row1 col2">6.7e-01</td>
<td id="T_b6f69_row1_col3" class="data row1 col3">5.8e-01</td>
<td id="T_b6f69_row1_col4" class="data row1 col4">4.5e-01</td>
<td id="T_b6f69_row1_col5" class="data row1 col5">3.5e-01</td>
<td id="T_b6f69_row1_col6" class="data row1 col6">2.7e-01</td>
</tr>
<tr class="odd">
<td id="T_b6f69_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_b6f69_row2_col0" class="data row2 col0">7.9e-01</td>
<td id="T_b6f69_row2_col1" class="data row2 col1">6.6e-01</td>
<td id="T_b6f69_row2_col2" class="data row2 col2">5.5e-01</td>
<td id="T_b6f69_row2_col3" class="data row2 col3">4.5e-01</td>
<td id="T_b6f69_row2_col4" class="data row2 col4">3.2e-01</td>
<td id="T_b6f69_row2_col5" class="data row2 col5">2.2e-01</td>
<td id="T_b6f69_row2_col6" class="data row2 col6">1.5e-01</td>
</tr>
<tr class="even">
<td id="T_b6f69_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_b6f69_row3_col0" class="data row3 col0">5.8e-01</td>
<td id="T_b6f69_row3_col1" class="data row3 col1">3.4e-01</td>
<td id="T_b6f69_row3_col2" class="data row3 col2">2.0e-01</td>
<td id="T_b6f69_row3_col3" class="data row3 col3">1.2e-01</td>
<td id="T_b6f69_row3_col4" class="data row3 col4">4.2e-02</td>
<td id="T_b6f69_row3_col5" class="data row3 col5">1.5e-02</td>
<td id="T_b6f69_row3_col6" class="data row3 col6">5.6e-03</td>
</tr>
<tr class="odd">
<td id="T_b6f69_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_b6f69_row4_col0" class="data row4 col0">3.5e-01</td>
<td id="T_b6f69_row4_col1" class="data row4 col1">1.2e-01</td>
<td id="T_b6f69_row4_col2" class="data row4 col2">4.3e-02</td>
<td id="T_b6f69_row4_col3" class="data row4 col3">1.5e-02</td>
<td id="T_b6f69_row4_col4" class="data row4 col4">2.4e-03</td>
<td id="T_b6f69_row4_col5" class="data row4 col5">3.6e-04</td>
<td id="T_b6f69_row4_col6" class="data row4 col6">5.2e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_9f3b7_row0_col0, #T_9f3b7_row0_col1, #T_9f3b7_row0_col2, #T_9f3b7_row1_col0, #T_9f3b7_row1_col1 {
  background-color: #fbd724;
  color: #000000;
}
#T_9f3b7_row0_col3, #T_9f3b7_row1_col2, #T_9f3b7_row2_col0, #T_9f3b7_row2_col1 {
  background-color: #fbd524;
  color: #000000;
}
#T_9f3b7_row0_col4, #T_9f3b7_row1_col3, #T_9f3b7_row2_col2 {
  background-color: #fbd324;
  color: #000000;
}
#T_9f3b7_row0_col5, #T_9f3b7_row1_col4, #T_9f3b7_row2_col3, #T_9f3b7_row3_col0 {
  background-color: #fcd225;
  color: #000000;
}
#T_9f3b7_row0_col6, #T_9f3b7_row1_col5, #T_9f3b7_row2_col4 {
  background-color: #fcd025;
  color: #000000;
}
#T_9f3b7_row1_col6 {
  background-color: #fcce25;
  color: #000000;
}
#T_9f3b7_row2_col5, #T_9f3b7_row3_col1 {
  background-color: #fccd25;
  color: #000000;
}
#T_9f3b7_row2_col6, #T_9f3b7_row3_col2 {
  background-color: #fdca26;
  color: #000000;
}
#T_9f3b7_row3_col3 {
  background-color: #fdc527;
  color: #000000;
}
#T_9f3b7_row3_col4 {
  background-color: #febb2b;
  color: #000000;
}
#T_9f3b7_row3_col5 {
  background-color: #fdb22f;
  color: #000000;
}
#T_9f3b7_row3_col6 {
  background-color: #fca835;
  color: #000000;
}
#T_9f3b7_row4_col0 {
  background-color: #fdcb26;
  color: #000000;
}
#T_9f3b7_row4_col1 {
  background-color: #fdc229;
  color: #000000;
}
#T_9f3b7_row4_col2 {
  background-color: #feb82c;
  color: #000000;
}
#T_9f3b7_row4_col3 {
  background-color: #fdae32;
  color: #000000;
}
#T_9f3b7_row4_col4 {
  background-color: #f99a3e;
  color: #000000;
}
#T_9f3b7_row4_col5 {
  background-color: #f48849;
  color: #f1f1f1;
}
#T_9f3b7_row4_col6 {
  background-color: #e3685f;
  color: #f1f1f1;
}
</style>

<table id="T_9f3b7" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 128:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_9f3b7_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_9f3b7_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_9f3b7_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_9f3b7_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_9f3b7_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_9f3b7_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_9f3b7_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9f3b7_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_9f3b7_row0_col0" class="data row0 col0">9.5e-01</td>
<td id="T_9f3b7_row0_col1" class="data row0 col1">9.1e-01</td>
<td id="T_9f3b7_row0_col2" class="data row0 col2">8.6e-01</td>
<td id="T_9f3b7_row0_col3" class="data row0 col3">8.2e-01</td>
<td id="T_9f3b7_row0_col4" class="data row0 col4">7.4e-01</td>
<td id="T_9f3b7_row0_col5" class="data row0 col5">6.7e-01</td>
<td id="T_9f3b7_row0_col6" class="data row0 col6">6.0e-01</td>
</tr>
<tr class="even">
<td id="T_9f3b7_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_9f3b7_row1_col0" class="data row1 col0">9.3e-01</td>
<td id="T_9f3b7_row1_col1" class="data row1 col1">8.6e-01</td>
<td id="T_9f3b7_row1_col2" class="data row1 col2">8.0e-01</td>
<td id="T_9f3b7_row1_col3" class="data row1 col3">7.4e-01</td>
<td id="T_9f3b7_row1_col4" class="data row1 col4">6.4e-01</td>
<td id="T_9f3b7_row1_col5" class="data row1 col5">5.6e-01</td>
<td id="T_9f3b7_row1_col6" class="data row1 col6">5.1e-01</td>
</tr>
<tr class="odd">
<td id="T_9f3b7_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_9f3b7_row2_col0" class="data row2 col0">8.6e-01</td>
<td id="T_9f3b7_row2_col1" class="data row2 col1">7.9e-01</td>
<td id="T_9f3b7_row2_col2" class="data row2 col2">7.2e-01</td>
<td id="T_9f3b7_row2_col3" class="data row2 col3">6.5e-01</td>
<td id="T_9f3b7_row2_col4" class="data row2 col4">5.4e-01</td>
<td id="T_9f3b7_row2_col5" class="data row2 col5">4.4e-01</td>
<td id="T_9f3b7_row2_col6" class="data row2 col6">3.6e-01</td>
</tr>
<tr class="even">
<td id="T_9f3b7_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_9f3b7_row3_col0" class="data row3 col0">6.5e-01</td>
<td id="T_9f3b7_row3_col1" class="data row3 col1">4.7e-01</td>
<td id="T_9f3b7_row3_col2" class="data row3 col2">3.4e-01</td>
<td id="T_9f3b7_row3_col3" class="data row3 col3">2.5e-01</td>
<td id="T_9f3b7_row3_col4" class="data row3 col4">1.3e-01</td>
<td id="T_9f3b7_row3_col5" class="data row3 col5">6.0e-02</td>
<td id="T_9f3b7_row3_col6" class="data row3 col6">2.6e-02</td>
</tr>
<tr class="odd">
<td id="T_9f3b7_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_9f3b7_row4_col0" class="data row4 col0">4.1e-01</td>
<td id="T_9f3b7_row4_col1" class="data row4 col1">2.0e-01</td>
<td id="T_9f3b7_row4_col2" class="data row4 col2">9.3e-02</td>
<td id="T_9f3b7_row4_col3" class="data row4 col3">4.4e-02</td>
<td id="T_9f3b7_row4_col4" class="data row4 col4">8.3e-03</td>
<td id="T_9f3b7_row4_col5" class="data row4 col5">1.8e-03</td>
<td id="T_9f3b7_row4_col6" class="data row4 col6">8.4e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_da518_row0_col0 {
  background-color: #fad824;
  color: #000000;
}
#T_da518_row0_col1, #T_da518_row0_col2, #T_da518_row0_col3, #T_da518_row1_col0, #T_da518_row1_col1, #T_da518_row1_col2, #T_da518_row2_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_da518_row0_col4, #T_da518_row0_col5, #T_da518_row1_col3, #T_da518_row1_col4, #T_da518_row2_col1 {
  background-color: #fbd524;
  color: #000000;
}
#T_da518_row0_col6, #T_da518_row1_col5, #T_da518_row1_col6, #T_da518_row2_col2, #T_da518_row2_col3, #T_da518_row3_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_da518_row2_col4 {
  background-color: #fcd025;
  color: #000000;
}
#T_da518_row2_col5, #T_da518_row3_col1 {
  background-color: #fcce25;
  color: #000000;
}
#T_da518_row2_col6, #T_da518_row3_col2 {
  background-color: #fdcb26;
  color: #000000;
}
#T_da518_row3_col3 {
  background-color: #fdc627;
  color: #000000;
}
#T_da518_row3_col4 {
  background-color: #febd2a;
  color: #000000;
}
#T_da518_row3_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_da518_row3_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_da518_row4_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_da518_row4_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_da518_row4_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_da518_row4_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_da518_row4_col4 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_da518_row4_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_da518_row4_col6 {
  background-color: #e97257;
  color: #f1f1f1;
}
</style>

<table id="T_da518" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 256:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_da518_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_da518_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_da518_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_da518_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_da518_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_da518_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_da518_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_da518_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_da518_row0_col0" class="data row0 col0">9.7e-01</td>
<td id="T_da518_row0_col1" class="data row0 col1">9.4e-01</td>
<td id="T_da518_row0_col2" class="data row0 col2">9.2e-01</td>
<td id="T_da518_row0_col3" class="data row0 col3">8.9e-01</td>
<td id="T_da518_row0_col4" class="data row0 col4">8.4e-01</td>
<td id="T_da518_row0_col5" class="data row0 col5">8.0e-01</td>
<td id="T_da518_row0_col6" class="data row0 col6">7.5e-01</td>
</tr>
<tr class="even">
<td id="T_da518_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_da518_row1_col0" class="data row1 col0">9.5e-01</td>
<td id="T_da518_row1_col1" class="data row1 col1">9.1e-01</td>
<td id="T_da518_row1_col2" class="data row1 col2">8.7e-01</td>
<td id="T_da518_row1_col3" class="data row1 col3">8.4e-01</td>
<td id="T_da518_row1_col4" class="data row1 col4">7.8e-01</td>
<td id="T_da518_row1_col5" class="data row1 col5">7.4e-01</td>
<td id="T_da518_row1_col6" class="data row1 col6">7.1e-01</td>
</tr>
<tr class="odd">
<td id="T_da518_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_da518_row2_col0" class="data row2 col0">8.9e-01</td>
<td id="T_da518_row2_col1" class="data row2 col1">8.3e-01</td>
<td id="T_da518_row2_col2" class="data row2 col2">7.6e-01</td>
<td id="T_da518_row2_col3" class="data row2 col3">7.0e-01</td>
<td id="T_da518_row2_col4" class="data row2 col4">5.9e-01</td>
<td id="T_da518_row2_col5" class="data row2 col5">5.0e-01</td>
<td id="T_da518_row2_col6" class="data row2 col6">4.2e-01</td>
</tr>
<tr class="even">
<td id="T_da518_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_da518_row3_col0" class="data row3 col0">6.9e-01</td>
<td id="T_da518_row3_col1" class="data row3 col1">5.2e-01</td>
<td id="T_da518_row3_col2" class="data row3 col2">3.8e-01</td>
<td id="T_da518_row3_col3" class="data row3 col3">2.8e-01</td>
<td id="T_da518_row3_col4" class="data row3 col4">1.5e-01</td>
<td id="T_da518_row3_col5" class="data row3 col5">7.8e-02</td>
<td id="T_da518_row3_col6" class="data row3 col6">4.4e-02</td>
</tr>
<tr class="odd">
<td id="T_da518_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_da518_row4_col0" class="data row4 col0">4.4e-01</td>
<td id="T_da518_row4_col1" class="data row4 col1">2.2e-01</td>
<td id="T_da518_row4_col2" class="data row4 col2">1.1e-01</td>
<td id="T_da518_row4_col3" class="data row4 col3">5.2e-02</td>
<td id="T_da518_row4_col4" class="data row4 col4">1.2e-02</td>
<td id="T_da518_row4_col5" class="data row4 col5">2.3e-03</td>
<td id="T_da518_row4_col6" class="data row4 col6">2.6e-04</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_abe1d_row0_col0, #T_abe1d_row0_col1, #T_abe1d_row1_col0 {
  background-color: #fad824;
  color: #000000;
}
#T_abe1d_row0_col2, #T_abe1d_row0_col3, #T_abe1d_row0_col4, #T_abe1d_row0_col5, #T_abe1d_row1_col1, #T_abe1d_row1_col2, #T_abe1d_row1_col3, #T_abe1d_row1_col4, #T_abe1d_row2_col0 {
  background-color: #fbd724;
  color: #000000;
}
#T_abe1d_row0_col6, #T_abe1d_row1_col5, #T_abe1d_row1_col6, #T_abe1d_row2_col1, #T_abe1d_row2_col2 {
  background-color: #fbd524;
  color: #000000;
}
#T_abe1d_row2_col3, #T_abe1d_row3_col0 {
  background-color: #fbd324;
  color: #000000;
}
#T_abe1d_row2_col4 {
  background-color: #fcd225;
  color: #000000;
}
#T_abe1d_row2_col5, #T_abe1d_row3_col1 {
  background-color: #fcce25;
  color: #000000;
}
#T_abe1d_row2_col6, #T_abe1d_row4_col0 {
  background-color: #fccd25;
  color: #000000;
}
#T_abe1d_row3_col2 {
  background-color: #fdcb26;
  color: #000000;
}
#T_abe1d_row3_col3 {
  background-color: #fdc627;
  color: #000000;
}
#T_abe1d_row3_col4 {
  background-color: #febe2a;
  color: #000000;
}
#T_abe1d_row3_col5 {
  background-color: #fdb52e;
  color: #000000;
}
#T_abe1d_row3_col6 {
  background-color: #fdae32;
  color: #000000;
}
#T_abe1d_row4_col1 {
  background-color: #fdc328;
  color: #000000;
}
#T_abe1d_row4_col2 {
  background-color: #feba2c;
  color: #000000;
}
#T_abe1d_row4_col3 {
  background-color: #fdaf31;
  color: #000000;
}
#T_abe1d_row4_col4 {
  background-color: #fa9e3b;
  color: #000000;
}
#T_abe1d_row4_col5 {
  background-color: #f58b47;
  color: #f1f1f1;
}
#T_abe1d_row4_col6 {
  background-color: #ef7c51;
  color: #f1f1f1;
}
</style>

<table id="T_abe1d" data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>d = 512:</caption>
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_abe1d_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">K = 1</th>
<th id="T_abe1d_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">K = 2</th>
<th id="T_abe1d_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">K = 3</th>
<th id="T_abe1d_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">K = 4</th>
<th id="T_abe1d_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">K = 6</th>
<th id="T_abe1d_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">K = 8</th>
<th id="T_abe1d_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">K = 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_abe1d_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">cb_len = 25</td>
<td id="T_abe1d_row0_col0" class="data row0 col0">9.8e-01</td>
<td id="T_abe1d_row0_col1" class="data row0 col1">9.7e-01</td>
<td id="T_abe1d_row0_col2" class="data row0 col2">9.5e-01</td>
<td id="T_abe1d_row0_col3" class="data row0 col3">9.3e-01</td>
<td id="T_abe1d_row0_col4" class="data row0 col4">9.0e-01</td>
<td id="T_abe1d_row0_col5" class="data row0 col5">8.7e-01</td>
<td id="T_abe1d_row0_col6" class="data row0 col6">8.4e-01</td>
</tr>
<tr class="even">
<td id="T_abe1d_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">cb_len = 64</td>
<td id="T_abe1d_row1_col0" class="data row1 col0">9.7e-01</td>
<td id="T_abe1d_row1_col1" class="data row1 col1">9.4e-01</td>
<td id="T_abe1d_row1_col2" class="data row1 col2">9.3e-01</td>
<td id="T_abe1d_row1_col3" class="data row1 col3">9.1e-01</td>
<td id="T_abe1d_row1_col4" class="data row1 col4">8.8e-01</td>
<td id="T_abe1d_row1_col5" class="data row1 col5">8.4e-01</td>
<td id="T_abe1d_row1_col6" class="data row1 col6">8.0e-01</td>
</tr>
<tr class="odd">
<td id="T_abe1d_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">cb_len = 256</td>
<td id="T_abe1d_row2_col0" class="data row2 col0">9.1e-01</td>
<td id="T_abe1d_row2_col1" class="data row2 col1">8.6e-01</td>
<td id="T_abe1d_row2_col2" class="data row2 col2">7.9e-01</td>
<td id="T_abe1d_row2_col3" class="data row2 col3">7.3e-01</td>
<td id="T_abe1d_row2_col4" class="data row2 col4">6.3e-01</td>
<td id="T_abe1d_row2_col5" class="data row2 col5">5.4e-01</td>
<td id="T_abe1d_row2_col6" class="data row2 col6">4.6e-01</td>
</tr>
<tr class="even">
<td id="T_abe1d_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">cb_len = 1024</td>
<td id="T_abe1d_row3_col0" class="data row3 col0">7.1e-01</td>
<td id="T_abe1d_row3_col1" class="data row3 col1">5.3e-01</td>
<td id="T_abe1d_row3_col2" class="data row3 col2">3.9e-01</td>
<td id="T_abe1d_row3_col3" class="data row3 col3">2.9e-01</td>
<td id="T_abe1d_row3_col4" class="data row3 col4">1.5e-01</td>
<td id="T_abe1d_row3_col5" class="data row3 col5">8.2e-02</td>
<td id="T_abe1d_row3_col6" class="data row3 col6">4.5e-02</td>
</tr>
<tr class="odd">
<td id="T_abe1d_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">cb_len = 2048</td>
<td id="T_abe1d_row4_col0" class="data row4 col0">4.6e-01</td>
<td id="T_abe1d_row4_col1" class="data row4 col1">2.2e-01</td>
<td id="T_abe1d_row4_col2" class="data row4 col2">1.1e-01</td>
<td id="T_abe1d_row4_col3" class="data row4 col3">5.0e-02</td>
<td id="T_abe1d_row4_col4" class="data row4 col4">1.2e-02</td>
<td id="T_abe1d_row4_col5" class="data row4 col5">2.3e-03</td>
<td id="T_abe1d_row4_col6" class="data row4 col6">6.1e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p>Clarification: RVQ with K=1 is the same thing a regular VQ.</p>
</blockquote>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>pio.renderers.default<span class="op">=</span><span class="st">'notebook'</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> plot, iplot, init_notebook_mode</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>init_notebook_mode(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op">=</span><span class="va">True</span>, log_z<span class="op">=</span><span class="va">False</span>, vary_K<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                camera<span class="op">=</span><span class="bu">dict</span>( up<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=</span><span class="dv">1</span>), center<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=-</span><span class="fl">0.2</span>), eye<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="fl">1.3</span>, y<span class="op">=</span><span class="fl">1.3</span>, z<span class="op">=</span><span class="fl">1.25</span>)),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=</span><span class="dv">750</span>,):</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    y, ylabel <span class="op">=</span> np.array(d_choices), <span class="st">'d'</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> vary_K:</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        x, xlabel <span class="op">=</span> np.array(K_choices), <span class="st">'K'</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> results[:,<span class="op">-</span><span class="dv">1</span>,:] </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        x, xlabel <span class="op">=</span> np.array(cb_lengths), <span class="st">'cb_len'</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> results[:,:,<span class="dv">3</span>] </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    z, zlabel <span class="op">=</span> z.numpy(), <span class="st">'error'</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log_xy:</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> vary_K: </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            x, xlabel <span class="op">=</span> np.log10(x), <span class="ss">f"log10( </span><span class="sc">{</span>xlabel<span class="sc">}</span><span class="ss"> )"</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        y, ylabel <span class="op">=</span> np.log10(y), <span class="ss">f"log10( </span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss"> )"</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log_z:</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>        z, zlabel <span class="op">=</span> np.log10(z), <span class="ss">f"log10( </span><span class="sc">{</span>zlabel<span class="sc">}</span><span class="ss"> )"</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[go.Surface(x<span class="op">=</span>X, y<span class="op">=</span>Y, z<span class="op">=</span>z, )], )</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(scene <span class="op">=</span> <span class="bu">dict</span>(xaxis_title<span class="op">=</span>xlabel,yaxis_title<span class="op">=</span>ylabel,zaxis_title<span class="op">=</span>zlabel))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(template<span class="op">=</span><span class="st">'plotly_dark'</span>,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        autosize<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span>width,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">400</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">20</span>,r<span class="op">=</span><span class="dv">20</span>,b<span class="op">=</span><span class="dv">10</span>,t<span class="op">=</span><span class="dv">20</span>,pad<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">#paper_bgcolor="LightSteelBlue",</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>        scene_camera <span class="op">=</span> camera,</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op">=</span><span class="va">True</span>, log_z<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-rvq-error-surfacea" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="377d756b-b5b8-44dd-b8a5-eacbb127866e" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("377d756b-b5b8-44dd-b8a5-eacbb127866e")) {                    Plotly.newPlot(                        "377d756b-b5b8-44dd-b8a5-eacbb127866e",                        [{"x":[[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[0.0001194791,0.000013041611,4.5001212e-7,6.08875e-8,7.8245804e-10],[0.001829724,0.00021511987,0.000009550631,4.545183e-7,2.4666173e-8],[0.03747351,0.011077854,0.0011352181,0.000050426737,0.0000036374568],[0.081909396,0.032012165,0.0052097593,0.00034891343,0.000028127608],[0.28064567,0.16229738,0.055833414,0.008146616,0.0007630689],[0.51241994,0.37574497,0.20006032,0.046573743,0.005081785],[0.69774455,0.5829518,0.4546781,0.12038385,0.015401484],[0.8201094,0.7430855,0.6539526,0.24878451,0.043749306],[0.8906704,0.8390631,0.69743395,0.2768929,0.051854175],[0.93333817,0.9102819,0.73448575,0.2887212,0.050273906]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"log10( cb_len )"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"error"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":0,"y":0,"z":-0.2},"eye":{"x":1.3,"y":1.3,"z":1.25}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('377d756b-b5b8-44dd-b8a5-eacbb127866e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;18<strong>.</strong> (Interactive) Surface plot of reconstruction error for 4 codebooks with various data dimensions and codebook lengths.</figcaption>
</figure>
</div>
</div>
<p>So as we expect, longer codebooks help, and at higher dimensions, error tends to be larger.</p>
<p>Here’s the same thing but with a logarithm axis for the error:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>camera<span class="op">=</span><span class="bu">dict</span>( up<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=</span><span class="dv">1</span>), center<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=-</span><span class="fl">0.15</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=-</span><span class="fl">0.2</span>), eye<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="fl">1.2</span>, y<span class="op">=-</span><span class="fl">1.4</span>, z<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_results(results, d_choices, cb_lengths, K_choices, log_xy<span class="op">=</span><span class="va">True</span>, log_z<span class="op">=</span><span class="va">True</span>, camera<span class="op">=</span>camera)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-rvq-error-surfacea-logz" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="9ccad324-61e5-4cd6-99ab-9ab6a065efef" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9ccad324-61e5-4cd6-99ab-9ab6a065efef")) {                    Plotly.newPlot(                        "9ccad324-61e5-4cd6-99ab-9ab6a065efef",                        [{"x":[[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933],[1.3979400086720377,1.806179973983887,2.4082399653118496,3.010299956639812,3.3113299523037933]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[-3.922708,-4.884669,-6.346776,-7.2154717,-9.106539],[-2.7376144,-3.6673195,-5.019968,-6.3424487,-7.607898],[-1.4262756,-1.9555444,-2.9449208,-4.297339,-5.4392023],[-1.0866662,-1.4946849,-2.2831824,-3.4572823,-4.550867],[-0.5518417,-0.78968847,-1.2531058,-2.0890229,-3.1174362],[-0.29037398,-0.42510682,-0.698839,-1.3318589,-2.2939837],[-0.15630355,-0.23436737,-0.34229597,-0.91943175,-1.8124374],[-0.0861282,-0.1289612,-0.18445373,-0.60417664,-1.3590288],[-0.05028297,-0.07620537,-0.15649691,-0.5576882,-1.2852163],[-0.029960975,-0.040824093,-0.13401663,-0.53952134,-1.2986574]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"log10( cb_len )"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"log10( error )"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":-0.15,"y":0,"z":-0.2},"eye":{"x":1.2,"y":-1.4,"z":1}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9ccad324-61e5-4cd6-99ab-9ab6a065efef');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption"><strong>Figure</strong>&nbsp;19<strong>.</strong> (Interactive) Surface plot of reconstruction error for 4 codebooks with various data dimensions and codebook lengths. (Logarithmic z-axis)</figcaption>
</figure>
</div>
</div>
<p>And now let’s look at the error for a codebook length of 2048, where we vary the number of codebooks:</p>
<div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>camera<span class="op">=</span><span class="bu">dict</span>( up<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=</span><span class="dv">1</span>), center<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=-</span><span class="fl">0.1</span>, y<span class="op">=</span><span class="dv">0</span>, z<span class="op">=-</span><span class="fl">0.22</span>), eye<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="fl">0.3</span>, y<span class="op">=-</span><span class="fl">1.8</span>, z<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_results(results, d_choices, cb_lengths, K_choices, vary_K<span class="op">=</span><span class="va">True</span>, log_xy<span class="op">=</span><span class="va">True</span>, log_z<span class="op">=</span><span class="va">True</span>, camera<span class="op">=</span>camera)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="fl">6.5</span>,<span class="dv">4</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ourdata <span class="op">=</span> results[:,<span class="op">-</span><span class="dv">1</span>,:] <span class="co"># max cb_len</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q1, d <span class="kw">in</span> <span class="bu">enumerate</span>(d_choices):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array(K_choices)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> ourdata[q1]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    ax.semilogy(x,y,<span class="st">'o-'</span>,label<span class="op">=</span><span class="ss">f"d = </span><span class="sc">{</span>d<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>box <span class="op">=</span> ax.get_position()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>ax.set_position([box.x0, box.y0, box.width <span class="op">*</span> <span class="fl">0.8</span>, box.height])</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'center left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"K"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"error"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-rvq-error-logz-varyk" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="fig-rvq-error-logz-varyk-1" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">

<div>                            <div id="702b742b-0d1b-4e99-bd34-d4c61c32601a" class="plotly-graph-div" style="height:400px; width:750px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("702b742b-0d1b-4e99-bd34-d4c61c32601a")) {                    Plotly.newPlot(                        "702b742b-0d1b-4e99-bd34-d4c61c32601a",                        [{"x":[[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10],[1,2,3,4,6,8,10]],"y":[[0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812,0.3010299956639812],[0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244,0.47712125471966244],[0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436,0.7781512503836436],[0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435,0.9030899869919435],[1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248,1.2041199826559248],[1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906,1.505149978319906],[1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887,1.806179973983887],[2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683,2.1072099696478683],[2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496,2.4082399653118496],[2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831,2.709269960975831]],"z":[[-3.224405,-5.73846,-7.4118648,-9.106539,-11.846527,-14.425459,-14.848204],[-2.3546593,-4.3316574,-6.0297394,-7.607898,-11.1222725,-14.419368,-14.740961],[-1.4203463,-2.7881258,-4.1049337,-5.4392023,-7.9532456,-10.347302,-12.598212],[-1.1800427,-2.330022,-3.4667091,-4.550867,-6.73431,-8.7964945,-10.812202],[-0.78516006,-1.550504,-2.3245468,-3.1174362,-4.573653,-5.985911,-7.417034],[-0.5713669,-1.1497808,-1.7276982,-2.2939837,-3.380397,-4.442157,-5.582937],[-0.4546547,-0.9143086,-1.3624536,-1.8124374,-2.6217163,-3.4454503,-4.280762],[-0.3907326,-0.7049824,-1.0309411,-1.3590288,-2.0810802,-2.7485373,-4.0779834],[-0.35315803,-0.6559364,-0.96061885,-1.2852163,-1.9224304,-2.6384947,-3.5889297],[-0.33344215,-0.65092665,-0.96849597,-1.2986574,-1.923794,-2.6294942,-3.2139428]],"type":"surface"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"scene":{"xaxis":{"title":{"text":"K"}},"yaxis":{"title":{"text":"log10( d )"}},"zaxis":{"title":{"text":"log10( error )"}},"camera":{"up":{"x":0,"y":0,"z":1},"center":{"x":-0.1,"y":0,"z":-0.22},"eye":{"x":0.3,"y":-1.8,"z":1}}},"margin":{"l":20,"r":20,"b":10,"t":20,"pad":4},"autosize":false,"width":750,"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('702b742b-0d1b-4e99-bd34-d4c61c32601a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<figcaption class="figure-caption">(a) (Interactive) 3D Surface Plot</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-rvq-error-logz-varyk-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2023-06-12-RVQ_files/figure-html/fig-rvq-error-logz-varyk-output-2.png" class="img-fluid figure-img" data-ref-parent="fig-rvq-error-logz-varyk"></p>
<figcaption class="figure-caption">(b) Line plot</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;20<strong>.</strong> Reconstruction error for codebook length of 2048 with various data dimensions and number of codebooks (K). (Logarithmic z-axis)</figcaption><p></p>
</figure>
</div>
</div>
<p>Note that in the last figure, we see <strong>straight lines</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> across as we vary K, and the K-axis is linear and the error axis is logarithmic.<span class="math inline">\(^*\)</span> What this means is – and this is a major takeway:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>As we add codebooks to the RVQ algorithm, the error decreases <em>exponentially</em>!</strong></p>
</div>
</div>
<p>This is a big “selling point” for the RVQ method: you get an <em>exponential</em> payoff in error reduction for a <em>linear</em> increase in computational cost.</p>
</section>
</section>
<section id="addendum-difficulty-at-very-high-dimensions" class="level1">
<h1>Addendum: Difficulty at Very High Dimensions</h1>
<p>However, the above results also indicate that, for very high dimensions (say, <span class="math inline">\(d \geq 128\)</span>), (R)VQ doesn’t offer nearly as big of a payoff as is does for lower dimensions – adding more and larger codebooks doesn’t have <em>that much</em> of an effect on the errors.</p>
<p>For this reason, in their <em>brand new</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> paper “<a href="https://arxiv.org/abs/2306.06546">High-Fidelity Audio Compression with Improved RVQGAN</a>”, the <a href="https://www.descript.com/">Descript</a> team choose to project down to a lower-dimensional space (<span class="math inline">\(d=8\)</span>) first, using <a href="https://pytorch.org/docs/stable/generated/torch.nn.Linear.html">Linear</a> layers, and <em>then</em> perform RVQ, and then project back up using another set of Linear Layers.</p>
<hr>
<p>…Pausing here for now. There’s more that we could say and do – for example, “How do you do backpropagation with RVQ?” – but this seems like a good place to pause this discussion.</p>
</section>
<section id="acknowledgement" class="level1">
<h1>Acknowledgement</h1>
<p>Thanks to <a href="https://twitter.com/zqevans">Zach Evans</a> of <a href="https://www.harmonai.org/">Harmonai</a> for the impetus to look into this topic, and for helpful discussions and corrections while I was writing.</p>
<hr>
<p>(c) 2023 Scott H. Hawley</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Yes, the lines flatten out when we reach machine precision of <span class="math inline">\(10^{-15}\)</span>; don’t worry about that.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Brand new” as in “came out while I was finishing this post”!<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>